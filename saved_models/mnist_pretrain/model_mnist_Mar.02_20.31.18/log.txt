current path: saved_models/mnist_pretrain/model_mnist_Mar.02_20.31.18
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 10, 20, 30, 40, 50, 60, 70, 80, 90]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
___Train Local_Simple,  epoch   1, local model 23, internal_epoch   1,  Average loss: 0.0386, Accuracy: 96/588 (16.3265%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1475, Accuracy: 1809/10000 (18.0900%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch   1, local model 72, internal_epoch   1,  Average loss: 0.0385, Accuracy: 78/529 (14.7448%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.2003, Accuracy: 1627/10000 (16.2700%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   1, local model 61, internal_epoch   1,  Average loss: 0.0380, Accuracy: 87/537 (16.2011%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.2124, Accuracy: 2054/10000 (20.5400%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0373, Accuracy: 160/644 (24.8447%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.2547, Accuracy: 1810/10000 (18.1000%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   1, local model 71, internal_epoch   1,  Average loss: 0.0351, Accuracy: 137/638 (21.4734%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1319, Accuracy: 3056/10000 (30.5600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   1, local model 42, internal_epoch   1,  Average loss: 0.0367, Accuracy: 141/665 (21.2030%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.0149, Accuracy: 4489/10000 (44.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 45, internal_epoch   1,  Average loss: 0.0349, Accuracy: 189/750 (25.2000%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.9001, Accuracy: 4287/10000 (42.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 37, internal_epoch   1,  Average loss: 0.0385, Accuracy: 123/641 (19.1888%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.6556, Accuracy: 982/10000 (9.8200%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   1, local model 21, internal_epoch   1,  Average loss: 0.0358, Accuracy: 98/625 (15.6800%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.2057, Accuracy: 3547/10000 (35.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 35, internal_epoch   1,  Average loss: 0.0364, Accuracy: 69/493 (13.9959%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.3624, Accuracy: 974/10000 (9.7400%), Attack Success Rate:14/10000(0.140)
time spent on training: 54.65026092529297
[foolsgold agg] training data poison_ratio: 0.0  data num: [588, 529, 537, 644, 638, 665, 750, 641, 625, 493]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.21437744 1.         0.50052603 1.         0.         0.
 0.33074919 1.         0.21437744 1.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2872, Accuracy: 1903/10000 (19.0300%), Attack Success Rate:8/10000(0.080)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2962, Accuracy: 691/8991 (7.6855%)
Done in 95.74319386482239 sec.
Server Epoch:2 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0357, Accuracy: 179/644 (27.7950%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.5050, Accuracy: 1606/10000 (16.0600%), Attack Success Rate:22/10000(0.220)
___Train Local_Simple,  epoch   2, local model 59, internal_epoch   1,  Average loss: 0.0356, Accuracy: 157/652 (24.0798%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.0217, Accuracy: 1946/10000 (19.4600%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch   2, local model 62, internal_epoch   1,  Average loss: 0.0357, Accuracy: 115/617 (18.6386%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.1272, Accuracy: 993/10000 (9.9300%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch   2, local model 28, internal_epoch   1,  Average loss: 0.0358, Accuracy: 156/665 (23.4586%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9377, Accuracy: 3090/10000 (30.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 65, internal_epoch   1,  Average loss: 0.0353, Accuracy: 77/573 (13.4380%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.0443, Accuracy: 4127/10000 (41.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 22, internal_epoch   1,  Average loss: 0.0375, Accuracy: 134/531 (25.2354%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.0615, Accuracy: 3013/10000 (30.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 78, internal_epoch   1,  Average loss: 0.0356, Accuracy: 137/624 (21.9551%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9291, Accuracy: 3419/10000 (34.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 58, internal_epoch   1,  Average loss: 0.0352, Accuracy: 104/510 (20.3922%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.0785, Accuracy: 4579/10000 (45.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 41, internal_epoch   1,  Average loss: 0.0361, Accuracy: 196/652 (30.0613%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8175, Accuracy: 2879/10000 (28.7900%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   2, local model 81, internal_epoch   1,  Average loss: 0.0375, Accuracy: 189/586 (32.2526%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.0086, Accuracy: 3130/10000 (31.3000%), Attack Success Rate:0/10000(0.000)
time spent on training: 38.13524293899536
[foolsgold agg] training data poison_ratio: 0.0  data num: [644, 652, 617, 665, 573, 531, 624, 510, 652, 586]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         0.         0.         0.         0.9087597
 0.91641673 0.         1.         0.85989424]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2535, Accuracy: 2420/10000 (24.2000%), Attack Success Rate:4/10000(0.040)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2644, Accuracy: 1207/8991 (13.4245%)
Done in 73.99177980422974 sec.
Server Epoch:3 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
___Train Local_Simple,  epoch   3, local model 54, internal_epoch   1,  Average loss: 0.0357, Accuracy: 126/523 (24.0918%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 5.3955, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch   3, local model 55, internal_epoch   1,  Average loss: 0.0344, Accuracy: 191/592 (32.2635%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 5.6526, Accuracy: 980/10000 (9.8000%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch   3, local model 61, internal_epoch   1,  Average loss: 0.0339, Accuracy: 183/537 (34.0782%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.2113, Accuracy: 3064/10000 (30.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 73, internal_epoch   1,  Average loss: 0.0314, Accuracy: 253/626 (40.4153%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.6121, Accuracy: 4562/10000 (45.6200%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   3, local model 18, internal_epoch   1,  Average loss: 0.0358, Accuracy: 132/516 (25.5814%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 3.4808, Accuracy: 2376/10000 (23.7600%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch   3, local model 42, internal_epoch   1,  Average loss: 0.0344, Accuracy: 238/665 (35.7895%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.8767, Accuracy: 4613/10000 (46.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 87, internal_epoch   1,  Average loss: 0.0307, Accuracy: 205/575 (35.6522%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.6871, Accuracy: 4463/10000 (44.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 41, internal_epoch   1,  Average loss: 0.0318, Accuracy: 313/652 (48.0061%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.8223, Accuracy: 2344/10000 (23.4400%), Attack Success Rate:2/10000(0.020)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   1,  Average loss: 0.0363, Accuracy: 141/474 (29.7468%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   2,  Average loss: 0.0251, Accuracy: 246/474 (51.8987%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   3,  Average loss: 0.0171, Accuracy: 309/474 (65.1899%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   4,  Average loss: 0.0128, Accuracy: 355/474 (74.8945%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   5,  Average loss: 0.0095, Accuracy: 400/474 (84.3882%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   6,  Average loss: 0.0074, Accuracy: 412/474 (86.9198%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   7,  Average loss: 0.0061, Accuracy: 422/474 (89.0295%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   8,  Average loss: 0.0054, Accuracy: 431/474 (90.9283%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   9,  Average loss: 0.0049, Accuracy: 436/474 (91.9831%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch  10,  Average loss: 0.0046, Accuracy: 436/474 (91.9831%), train_poison_data_count: 474
Global model norm: 13.910547856745422.
Norm before scaling: 14.380918130439866. Distance: 2.9116181049398757
Total norm for 1 adversaries is: 14.380918130439866. distance: 2.9116181049398757
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.3871, Accuracy: 7951/8991 (88.4329%)
___Train Local_Simple,  epoch   3, local model 28, internal_epoch   1,  Average loss: 0.0355, Accuracy: 217/665 (32.6316%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.9534, Accuracy: 2479/10000 (24.7900%), Attack Success Rate:3/10000(0.030)
time spent on training: 47.65552592277527
[foolsgold agg] training data poison_ratio: 0.08137339055793992  data num: [523, 592, 537, 626, 516, 665, 575, 652, 474, 665]
[foolsgold agg] considering poison per batch poison_fraction: 0.08137339055793992
[foolsgold agg] wv: [1.         1.         0.18133668 0.18133668 1.         1.
 0.56458827 0.56458827 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.1391, Accuracy: 5638/10000 (56.3800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.1415, Accuracy: 4352/8991 (48.4040%)
Done in 83.95467376708984 sec.
Server Epoch:4 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
___Train Local_Simple,  epoch   4, local model 37, internal_epoch   1,  Average loss: 0.0292, Accuracy: 296/641 (46.1778%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 6.5083, Accuracy: 1455/10000 (14.5500%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch   4, local model 92, internal_epoch   1,  Average loss: 0.0288, Accuracy: 280/571 (49.0368%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.1037, Accuracy: 5679/10000 (56.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 95, internal_epoch   1,  Average loss: 0.0382, Accuracy: 259/532 (48.6842%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.1947, Accuracy: 2122/10000 (21.2200%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   4, local model 76, internal_epoch   1,  Average loss: 0.0315, Accuracy: 259/518 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.5716, Accuracy: 5347/10000 (53.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0304, Accuracy: 257/521 (49.3282%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.4002, Accuracy: 4973/10000 (49.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 99, internal_epoch   1,  Average loss: 0.0350, Accuracy: 217/410 (52.9268%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.7754, Accuracy: 1389/10000 (13.8900%), Attack Success Rate:25/10000(0.250)
___Train Local_Simple,  epoch   4, local model 94, internal_epoch   1,  Average loss: 0.0297, Accuracy: 273/555 (49.1892%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.6833, Accuracy: 4355/10000 (43.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 74, internal_epoch   1,  Average loss: 0.0343, Accuracy: 293/626 (46.8051%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.1184, Accuracy: 2816/10000 (28.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 45, internal_epoch   1,  Average loss: 0.0320, Accuracy: 366/750 (48.8000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.8544, Accuracy: 4160/10000 (41.6000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   4, local model 44, internal_epoch   1,  Average loss: 0.0333, Accuracy: 252/518 (48.6486%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.8688, Accuracy: 4246/10000 (42.4600%), Attack Success Rate:0/10000(0.000)
time spent on training: 37.36942100524902
[foolsgold agg] training data poison_ratio: 0.0  data num: [641, 571, 532, 518, 521, 410, 555, 626, 750, 518]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 2.2313, Accuracy: 4362/10000 (43.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 2.2351, Accuracy: 3518/8991 (39.1280%)
Done in 73.75051188468933 sec.
Server Epoch:5 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   1,  Average loss: 0.0316, Accuracy: 368/644 (57.1429%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   2,  Average loss: 0.0158, Accuracy: 436/644 (67.7019%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   3,  Average loss: 0.0080, Accuracy: 544/644 (84.4720%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   4,  Average loss: 0.0058, Accuracy: 572/644 (88.8199%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   5,  Average loss: 0.0047, Accuracy: 582/644 (90.3727%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   6,  Average loss: 0.0045, Accuracy: 590/644 (91.6149%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   7,  Average loss: 0.0039, Accuracy: 595/644 (92.3913%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   8,  Average loss: 0.0035, Accuracy: 607/644 (94.2547%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   9,  Average loss: 0.0029, Accuracy: 606/644 (94.0994%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch  10,  Average loss: 0.0029, Accuracy: 608/644 (94.4099%), train_poison_data_count: 644
Global model norm: 14.012204436452722.
Norm before scaling: 15.009205854274121. Distance: 4.336692730539175
Total norm for 1 adversaries is: 15.009205854274121. distance: 4.336692730539175
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.3132, Accuracy: 8184/8991 (91.0244%)
___Train Local_Simple,  epoch   5, local model 49, internal_epoch   1,  Average loss: 0.0338, Accuracy: 300/516 (58.1395%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 17.2477, Accuracy: 1149/10000 (11.4900%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   5, local model 65, internal_epoch   1,  Average loss: 0.0302, Accuracy: 286/573 (49.9127%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.0436, Accuracy: 5447/10000 (54.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0313, Accuracy: 293/535 (54.7664%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 3.0913, Accuracy: 3841/10000 (38.4100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   5, local model 36, internal_epoch   1,  Average loss: 0.0299, Accuracy: 295/520 (56.7308%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 4.6768, Accuracy: 2502/10000 (25.0200%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch   5, local model 24, internal_epoch   1,  Average loss: 0.0338, Accuracy: 303/578 (52.4221%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 11.0187, Accuracy: 1023/10000 (10.2300%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0298, Accuracy: 288/550 (52.3636%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.4926, Accuracy: 4613/10000 (46.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0305, Accuracy: 300/587 (51.1073%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.6443, Accuracy: 5156/10000 (51.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 76, internal_epoch   1,  Average loss: 0.0322, Accuracy: 264/518 (50.9653%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 5.6935, Accuracy: 1786/10000 (17.8600%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch   5, local model 39, internal_epoch   1,  Average loss: 0.0305, Accuracy: 277/503 (55.0696%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.9698, Accuracy: 4200/10000 (42.0000%), Attack Success Rate:0/10000(0.000)
time spent on training: 47.57868695259094
[foolsgold agg] training data poison_ratio: 0.1165821868211441  data num: [644, 516, 573, 535, 520, 578, 550, 587, 518, 503]
[foolsgold agg] considering poison per batch poison_fraction: 0.1165821868211441
[foolsgold agg] wv: [1.         1.         0.57245233 1.         1.         1.
 0.82501875 1.         0.57245233 0.82501875]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.0805, Accuracy: 4018/10000 (40.1800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 2.0848, Accuracy: 3982/8991 (44.2887%)
Done in 82.97845506668091 sec.
Server Epoch:6 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
___Train Local_Simple,  epoch   6, local model 26, internal_epoch   1,  Average loss: 0.0286, Accuracy: 298/526 (56.6540%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.2710, Accuracy: 5842/10000 (58.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 29, internal_epoch   1,  Average loss: 0.0307, Accuracy: 328/605 (54.2149%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.7141, Accuracy: 4307/10000 (43.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0307, Accuracy: 322/587 (54.8552%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.5618, Accuracy: 6080/10000 (60.8000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   6, local model 41, internal_epoch   1,  Average loss: 0.0294, Accuracy: 340/652 (52.1472%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.8196, Accuracy: 5126/10000 (51.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 99, internal_epoch   1,  Average loss: 0.0265, Accuracy: 272/410 (66.3415%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 4.7101, Accuracy: 3089/10000 (30.8900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   6, local model 67, internal_epoch   1,  Average loss: 0.0279, Accuracy: 344/643 (53.4992%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.8755, Accuracy: 2813/10000 (28.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 91, internal_epoch   1,  Average loss: 0.0252, Accuracy: 342/627 (54.5455%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.1730, Accuracy: 5990/10000 (59.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 76, internal_epoch   1,  Average loss: 0.0273, Accuracy: 286/518 (55.2124%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 9.6048, Accuracy: 1465/10000 (14.6500%), Attack Success Rate:24/10000(0.240)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0236, Accuracy: 396/683 (57.9795%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.0717, Accuracy: 7137/10000 (71.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 25, internal_epoch   1,  Average loss: 0.0373, Accuracy: 319/582 (54.8110%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.7365, Accuracy: 4168/10000 (41.6800%), Attack Success Rate:0/10000(0.000)
time spent on training: 38.260722160339355
[foolsgold agg] training data poison_ratio: 0.0  data num: [526, 605, 587, 652, 410, 643, 627, 518, 683, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 2.2025, Accuracy: 4760/10000 (47.6000%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 2.2061, Accuracy: 4082/8991 (45.4010%)
Done in 73.98992824554443 sec.
Server Epoch:7 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
___Train Local_Simple,  epoch   7, local model 66, internal_epoch   1,  Average loss: 0.0266, Accuracy: 339/629 (53.8951%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.1119, Accuracy: 3830/10000 (38.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 68, internal_epoch   1,  Average loss: 0.0267, Accuracy: 346/632 (54.7468%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.0709, Accuracy: 7150/10000 (71.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 59, internal_epoch   1,  Average loss: 0.0271, Accuracy: 402/652 (61.6564%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 3.8575, Accuracy: 3766/10000 (37.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 62, internal_epoch   1,  Average loss: 0.0281, Accuracy: 305/617 (49.4327%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.0480, Accuracy: 6798/10000 (67.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 31, internal_epoch   1,  Average loss: 0.0295, Accuracy: 274/511 (53.6204%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.9074, Accuracy: 6762/10000 (67.6200%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0309, Accuracy: 298/572 (52.0979%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   2,  Average loss: 0.0123, Accuracy: 425/572 (74.3007%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   3,  Average loss: 0.0078, Accuracy: 487/572 (85.1399%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   4,  Average loss: 0.0052, Accuracy: 517/572 (90.3846%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   5,  Average loss: 0.0040, Accuracy: 538/572 (94.0559%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   6,  Average loss: 0.0033, Accuracy: 546/572 (95.4545%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   7,  Average loss: 0.0029, Accuracy: 543/572 (94.9301%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   8,  Average loss: 0.0024, Accuracy: 551/572 (96.3287%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   9,  Average loss: 0.0023, Accuracy: 556/572 (97.2028%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch  10,  Average loss: 0.0022, Accuracy: 556/572 (97.2028%), train_poison_data_count: 572
Global model norm: 14.172180778123474.
Norm before scaling: 14.71842914077689. Distance: 2.9966472328356444
Total norm for 1 adversaries is: 14.71842914077689. distance: 2.9966472328356444
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.2871, Accuracy: 8198/8991 (91.1801%)
___Train Local_Simple,  epoch   7, local model 23, internal_epoch   1,  Average loss: 0.0281, Accuracy: 301/588 (51.1905%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.3656, Accuracy: 5885/10000 (58.8500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0279, Accuracy: 303/550 (55.0909%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.2570, Accuracy: 6226/10000 (62.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 99, internal_epoch   1,  Average loss: 0.0288, Accuracy: 273/410 (66.5854%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.0447, Accuracy: 6118/10000 (61.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 45, internal_epoch   1,  Average loss: 0.0247, Accuracy: 420/750 (56.0000%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.2153, Accuracy: 5467/10000 (54.6700%), Attack Success Rate:0/10000(0.000)
time spent on training: 48.14813017845154
[foolsgold agg] training data poison_ratio: 0.09676873625444088  data num: [629, 632, 652, 617, 511, 572, 588, 550, 410, 750]
[foolsgold agg] considering poison per batch poison_fraction: 0.09676873625444088
[foolsgold agg] wv: [0.0277573  0.18281306 0.18281306 0.84998575 0.40876948 1.
 0.47703153 0.0277573  1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 2.0922, Accuracy: 6000/10000 (60.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 2.0956, Accuracy: 5640/8991 (62.7294%)
Done in 83.11855602264404 sec.
Server Epoch:8 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
___Train Local_Simple,  epoch   8, local model 63, internal_epoch   1,  Average loss: 0.0295, Accuracy: 372/616 (60.3896%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.0260, Accuracy: 6856/10000 (68.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 55, internal_epoch   1,  Average loss: 0.0261, Accuracy: 393/592 (66.3851%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.4411, Accuracy: 5577/10000 (55.7700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   8, local model 79, internal_epoch   1,  Average loss: 0.0275, Accuracy: 426/635 (67.0866%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.2634, Accuracy: 6098/10000 (60.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0219, Accuracy: 364/548 (66.4234%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.9982, Accuracy: 5767/10000 (57.6700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   8, local model 62, internal_epoch   1,  Average loss: 0.0261, Accuracy: 383/617 (62.0746%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.9411, Accuracy: 6062/10000 (60.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 56, internal_epoch   1,  Average loss: 0.0274, Accuracy: 407/626 (65.0160%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.3971, Accuracy: 5669/10000 (56.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 96, internal_epoch   1,  Average loss: 0.0268, Accuracy: 407/608 (66.9408%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.4533, Accuracy: 6256/10000 (62.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0253, Accuracy: 373/597 (62.4791%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.7057, Accuracy: 5657/10000 (56.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 92, internal_epoch   1,  Average loss: 0.0217, Accuracy: 394/571 (69.0018%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.4054, Accuracy: 6596/10000 (65.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 86, internal_epoch   1,  Average loss: 0.0251, Accuracy: 385/587 (65.5877%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.9901, Accuracy: 6080/10000 (60.8000%), Attack Success Rate:0/10000(0.000)
time spent on training: 38.05035185813904
[foolsgold agg] training data poison_ratio: 0.0  data num: [616, 592, 635, 548, 617, 626, 608, 597, 571, 587]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 2.0494, Accuracy: 7387/10000 (73.8700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 2.0439, Accuracy: 6212/8991 (69.0913%)
Done in 72.92967510223389 sec.
Server Epoch:9 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
___Train Local_Simple,  epoch   9, local model 28, internal_epoch   1,  Average loss: 0.0230, Accuracy: 470/665 (70.6767%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.2693, Accuracy: 6626/10000 (66.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 63, internal_epoch   1,  Average loss: 0.0233, Accuracy: 420/616 (68.1818%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.8205, Accuracy: 6585/10000 (65.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 33, internal_epoch   1,  Average loss: 0.0221, Accuracy: 457/638 (71.6301%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.8831, Accuracy: 5873/10000 (58.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 71, internal_epoch   1,  Average loss: 0.0229, Accuracy: 432/638 (67.7116%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.4157, Accuracy: 7051/10000 (70.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0212, Accuracy: 377/521 (72.3608%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2055, Accuracy: 5002/10000 (50.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 32, internal_epoch   1,  Average loss: 0.0240, Accuracy: 426/609 (69.9507%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.7051, Accuracy: 6481/10000 (64.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 76, internal_epoch   1,  Average loss: 0.0237, Accuracy: 363/518 (70.0772%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 11.8538, Accuracy: 1648/10000 (16.4800%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   9, local model 97, internal_epoch   1,  Average loss: 0.0243, Accuracy: 423/588 (71.9388%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 4.3614, Accuracy: 4933/10000 (49.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 23, internal_epoch   1,  Average loss: 0.0235, Accuracy: 403/588 (68.5374%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.5074, Accuracy: 4464/10000 (44.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 25, internal_epoch   1,  Average loss: 0.0253, Accuracy: 398/582 (68.3849%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 11.6845, Accuracy: 1464/10000 (14.6400%), Attack Success Rate:20/10000(0.200)
time spent on training: 187.22357392311096
[foolsgold agg] training data poison_ratio: 0.0  data num: [665, 616, 638, 638, 521, 609, 518, 588, 588, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.16095173 1.         1.
 1.         0.16095173 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 1.8773, Accuracy: 7296/10000 (72.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 1.8783, Accuracy: 5795/8991 (64.4533%)
Done in 224.62797594070435 sec.
Server Epoch:10 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
___Train Local_Simple,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0230, Accuracy: 387/597 (64.8241%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.6755, Accuracy: 7699/10000 (76.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 56, internal_epoch   1,  Average loss: 0.0200, Accuracy: 431/626 (68.8498%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.6566, Accuracy: 7790/10000 (77.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 19, internal_epoch   1,  Average loss: 0.0195, Accuracy: 405/552 (73.3696%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.9749, Accuracy: 7374/10000 (73.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0173, Accuracy: 484/644 (75.1553%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.8354, Accuracy: 7163/10000 (71.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0190, Accuracy: 392/521 (75.2399%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.4868, Accuracy: 7064/10000 (70.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 78, internal_epoch   1,  Average loss: 0.0214, Accuracy: 401/624 (64.2628%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.2765, Accuracy: 6623/10000 (66.2300%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  10, local model 49, internal_epoch   1,  Average loss: 0.0187, Accuracy: 389/516 (75.3876%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 3.4386, Accuracy: 4812/10000 (48.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 34, internal_epoch   1,  Average loss: 0.0200, Accuracy: 378/528 (71.5909%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.2437, Accuracy: 4136/10000 (41.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0203, Accuracy: 383/535 (71.5888%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.2930, Accuracy: 6388/10000 (63.8800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  10, local model 99, internal_epoch   1,  Average loss: 0.0159, Accuracy: 361/410 (88.0488%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 7.3701, Accuracy: 4637/10000 (46.3700%), Attack Success Rate:0/10000(0.000)
time spent on training: 39.105977058410645
[foolsgold agg] training data poison_ratio: 0.0  data num: [597, 626, 552, 644, 521, 624, 516, 528, 535, 410]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         0.         1.         0.66147289 1.
 1.         0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 1.6989, Accuracy: 7490/10000 (74.9000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 1.7021, Accuracy: 5985/8991 (66.5666%)
Done in 75.06046795845032 sec.
Server Epoch:11 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
___Train Local_Simple,  epoch  11, local model 53, internal_epoch   1,  Average loss: 0.0170, Accuracy: 446/617 (72.2853%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.6140, Accuracy: 8124/10000 (81.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 56, internal_epoch   1,  Average loss: 0.0174, Accuracy: 436/626 (69.6486%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.7027, Accuracy: 7869/10000 (78.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0178, Accuracy: 471/647 (72.7975%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 3.5735, Accuracy: 4686/10000 (46.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0172, Accuracy: 393/535 (73.4579%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.8447, Accuracy: 7771/10000 (77.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 36, internal_epoch   1,  Average loss: 0.0170, Accuracy: 412/520 (79.2308%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.1849, Accuracy: 6982/10000 (69.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0198, Accuracy: 498/708 (70.3390%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.7660, Accuracy: 7844/10000 (78.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0189, Accuracy: 362/478 (75.7322%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.8732, Accuracy: 6577/10000 (65.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 99, internal_epoch   1,  Average loss: 0.0120, Accuracy: 377/410 (91.9512%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 6.4801, Accuracy: 6345/10000 (63.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 88, internal_epoch   1,  Average loss: 0.0208, Accuracy: 477/679 (70.2504%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0453, Accuracy: 6325/10000 (63.2500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0174, Accuracy: 449/641 (70.0468%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.8754, Accuracy: 5336/10000 (53.3600%), Attack Success Rate:0/10000(0.000)
time spent on training: 39.25875520706177
[foolsgold agg] training data poison_ratio: 0.0  data num: [617, 626, 647, 535, 520, 708, 478, 410, 679, 641]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.97059644 1.         1.
 1.         1.         0.97059644 1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 1.5253, Accuracy: 7204/10000 (72.0400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 1.5082, Accuracy: 6716/8991 (74.6969%)
Done in 74.94772291183472 sec.
Server Epoch:12 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0160, Accuracy: 474/665 (71.2782%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9222, Accuracy: 7261/10000 (72.6100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  12, local model 17, internal_epoch   1,  Average loss: 0.0144, Accuracy: 512/648 (79.0123%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.6069, Accuracy: 5243/10000 (52.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0170, Accuracy: 440/580 (75.8621%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.8895, Accuracy: 4457/10000 (44.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0144, Accuracy: 414/566 (73.1449%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6511, Accuracy: 7727/10000 (77.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0144, Accuracy: 533/708 (75.2825%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.4637, Accuracy: 4991/10000 (49.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 38, internal_epoch   1,  Average loss: 0.0143, Accuracy: 584/774 (75.4522%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.4115, Accuracy: 5919/10000 (59.1900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0164, Accuracy: 448/641 (69.8908%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 5.5127, Accuracy: 2644/10000 (26.4400%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  12, local model 44, internal_epoch   1,  Average loss: 0.0171, Accuracy: 370/518 (71.4286%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0949, Accuracy: 6942/10000 (69.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0169, Accuracy: 375/519 (72.2543%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 3.8818, Accuracy: 5113/10000 (51.1300%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0148, Accuracy: 452/587 (77.0017%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.6711, Accuracy: 6062/10000 (60.6200%), Attack Success Rate:0/10000(0.000)
time spent on training: 39.66029500961304
[foolsgold agg] training data poison_ratio: 0.0  data num: [665, 648, 580, 566, 708, 774, 641, 518, 519, 587]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.94743713 1.         1.
 1.         1.         1.         0.94743713]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.3447, Accuracy: 7853/10000 (78.5300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 1.3296, Accuracy: 6682/8991 (74.3188%)
Done in 75.60832476615906 sec.
Server Epoch:13 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
___Train Local_Simple,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0116, Accuracy: 470/578 (81.3149%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.9666, Accuracy: 7671/10000 (76.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 38, internal_epoch   1,  Average loss: 0.0139, Accuracy: 609/774 (78.6822%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7021, Accuracy: 7819/10000 (78.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0146, Accuracy: 460/618 (74.4337%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.8315, Accuracy: 7586/10000 (75.8600%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0153, Accuracy: 434/572 (75.8741%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   2,  Average loss: 0.0061, Accuracy: 510/572 (89.1608%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   3,  Average loss: 0.0029, Accuracy: 540/572 (94.4056%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   4,  Average loss: 0.0021, Accuracy: 553/572 (96.6783%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   5,  Average loss: 0.0019, Accuracy: 558/572 (97.5524%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   6,  Average loss: 0.0016, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   7,  Average loss: 0.0014, Accuracy: 563/572 (98.4266%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   8,  Average loss: 0.0012, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   9,  Average loss: 0.0011, Accuracy: 566/572 (98.9510%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch  10,  Average loss: 0.0011, Accuracy: 566/572 (98.9510%), train_poison_data_count: 572
Global model norm: 14.541435757236489.
Norm before scaling: 15.034462567623281. Distance: 2.442567009216521
Total norm for 2 adversaries is: 15.034462567623281. distance: 2.442567009216521
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.2382, Accuracy: 8368/8991 (93.0708%)
___Train Local_Simple,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0123, Accuracy: 531/644 (82.4534%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 8.1905, Accuracy: 2772/10000 (27.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 76, internal_epoch   1,  Average loss: 0.0152, Accuracy: 397/518 (76.6409%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.0799, Accuracy: 6836/10000 (68.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 97, internal_epoch   1,  Average loss: 0.0149, Accuracy: 458/588 (77.8912%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.8603, Accuracy: 7686/10000 (76.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0140, Accuracy: 421/550 (76.5455%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6160, Accuracy: 7884/10000 (78.8400%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   1,  Average loss: 0.0140, Accuracy: 447/549 (81.4208%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   2,  Average loss: 0.0070, Accuracy: 478/549 (87.0674%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   3,  Average loss: 0.0042, Accuracy: 509/549 (92.7140%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   4,  Average loss: 0.0032, Accuracy: 522/549 (95.0820%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   5,  Average loss: 0.0028, Accuracy: 523/549 (95.2641%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   6,  Average loss: 0.0024, Accuracy: 526/549 (95.8106%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   7,  Average loss: 0.0021, Accuracy: 530/549 (96.5392%), train_poison_data_count: 549
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   8,  Average loss: 0.0019, Accuracy: 533/549 (97.0856%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   9,  Average loss: 0.0018, Accuracy: 536/549 (97.6321%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch  10,  Average loss: 0.0020, Accuracy: 536/549 (97.6321%), train_poison_data_count: 549
Global model norm: 14.541435757236489.
Norm before scaling: 14.977571631527558. Distance: 2.2945054475907085
Total norm for 2 adversaries is: 14.977571631527558. distance: 2.2945054475907085
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.2460, Accuracy: 8368/8991 (93.0708%)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0127, Accuracy: 424/535 (79.2523%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6304, Accuracy: 8272/10000 (82.7200%), Attack Success Rate:0/10000(0.000)
time spent on training: 56.59714984893799
[foolsgold agg] training data poison_ratio: 0.18916638542018224  data num: [578, 774, 618, 572, 644, 518, 588, 550, 549, 535]
[foolsgold agg] considering poison per batch poison_fraction: 0.18916638542018224
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.0225, Accuracy: 8067/10000 (80.6700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 1.0140, Accuracy: 6908/8991 (76.8324%)
Done in 91.73470783233643 sec.
Server Epoch:14 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0100, Accuracy: 455/532 (85.5263%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9740, Accuracy: 7813/10000 (78.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 97, internal_epoch   1,  Average loss: 0.0105, Accuracy: 485/588 (82.4830%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1240, Accuracy: 7511/10000 (75.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0117, Accuracy: 479/597 (80.2345%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9346, Accuracy: 7710/10000 (77.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 89, internal_epoch   1,  Average loss: 0.0103, Accuracy: 548/664 (82.5301%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.5893, Accuracy: 8324/10000 (83.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0114, Accuracy: 463/582 (79.5533%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.4364, Accuracy: 6332/10000 (63.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 34, internal_epoch   1,  Average loss: 0.0112, Accuracy: 429/528 (81.2500%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1748, Accuracy: 7390/10000 (73.9000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  14, local model 55, internal_epoch   1,  Average loss: 0.0096, Accuracy: 491/592 (82.9392%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1638, Accuracy: 7515/10000 (75.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 67, internal_epoch   1,  Average loss: 0.0109, Accuracy: 547/643 (85.0700%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 7.7380, Accuracy: 2684/10000 (26.8400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0098, Accuracy: 510/626 (81.4696%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.7370, Accuracy: 8042/10000 (80.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0104, Accuracy: 483/580 (83.2759%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.4913, Accuracy: 7380/10000 (73.8000%), Attack Success Rate:0/10000(0.000)
time spent on training: 38.42451000213623
[foolsgold agg] training data poison_ratio: 0.0  data num: [532, 588, 597, 664, 582, 528, 592, 643, 626, 580]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.48382391 1.         1.
 1.         1.         0.48382391 1.        ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.8552, Accuracy: 7986/10000 (79.8600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.8672, Accuracy: 6797/8991 (75.5978%)
Done in 73.57409620285034 sec.
Server Epoch:15 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
___Train Local_Simple,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0086, Accuracy: 504/587 (85.8603%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5268, Accuracy: 8622/10000 (86.2200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0112, Accuracy: 493/606 (81.3531%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   2,  Average loss: 0.0056, Accuracy: 554/606 (91.4191%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   3,  Average loss: 0.0027, Accuracy: 579/606 (95.5446%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   4,  Average loss: 0.0019, Accuracy: 584/606 (96.3696%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   5,  Average loss: 0.0017, Accuracy: 587/606 (96.8647%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   6,  Average loss: 0.0015, Accuracy: 593/606 (97.8548%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   7,  Average loss: 0.0014, Accuracy: 593/606 (97.8548%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   8,  Average loss: 0.0012, Accuracy: 597/606 (98.5149%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   9,  Average loss: 0.0011, Accuracy: 597/606 (98.5149%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch  10,  Average loss: 0.0011, Accuracy: 597/606 (98.5149%), train_poison_data_count: 606
Global model norm: 14.68329082804722.
Norm before scaling: 15.084043426378326. Distance: 2.264330579683668
Total norm for 2 adversaries is: 15.084043426378326. distance: 2.264330579683668
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.2085, Accuracy: 8406/8991 (93.4935%)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   1,  Average loss: 0.0115, Accuracy: 446/553 (80.6510%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   2,  Average loss: 0.0056, Accuracy: 491/553 (88.7884%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   3,  Average loss: 0.0024, Accuracy: 527/553 (95.2984%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   4,  Average loss: 0.0020, Accuracy: 538/553 (97.2875%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   5,  Average loss: 0.0018, Accuracy: 534/553 (96.5642%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   6,  Average loss: 0.0016, Accuracy: 537/553 (97.1067%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   7,  Average loss: 0.0015, Accuracy: 537/553 (97.1067%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   8,  Average loss: 0.0013, Accuracy: 541/553 (97.8300%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   9,  Average loss: 0.0013, Accuracy: 543/553 (98.1917%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch  10,  Average loss: 0.0012, Accuracy: 543/553 (98.1917%), train_poison_data_count: 553
Global model norm: 14.68329082804722.
Norm before scaling: 15.068642784316314. Distance: 2.0924439413384635
Total norm for 2 adversaries is: 15.068642784316314. distance: 2.0924439413384635
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1889, Accuracy: 8513/8991 (94.6836%)
___Train Local_Simple,  epoch  15, local model 48, internal_epoch   1,  Average loss: 0.0098, Accuracy: 492/589 (83.5314%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5355, Accuracy: 8301/10000 (83.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0115, Accuracy: 495/592 (83.6149%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8497, Accuracy: 8060/10000 (80.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 98, internal_epoch   1,  Average loss: 0.0043, Accuracy: 531/568 (93.4859%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.5613, Accuracy: 7325/10000 (73.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 27, internal_epoch   1,  Average loss: 0.0120, Accuracy: 523/650 (80.4615%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.2816, Accuracy: 6524/10000 (65.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0092, Accuracy: 554/665 (83.3083%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8191, Accuracy: 7944/10000 (79.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0088, Accuracy: 511/609 (83.9080%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.2825, Accuracy: 7367/10000 (73.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 44, internal_epoch   1,  Average loss: 0.0088, Accuracy: 440/518 (84.9421%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.9632, Accuracy: 7565/10000 (75.6500%), Attack Success Rate:0/10000(0.000)
time spent on training: 56.863096714019775
[foolsgold agg] training data poison_ratio: 0.19521643927909718  data num: [587, 606, 553, 589, 592, 568, 650, 665, 609, 518]
[foolsgold agg] considering poison per batch poison_fraction: 0.19521643927909718
[foolsgold agg] wv: [1.         1.         1.         0.81563145 1.         1.
 1.         1.         0.81563145 1.        ]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.7393, Accuracy: 7400/10000 (74.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.6944, Accuracy: 7242/8991 (80.5472%)
Done in 91.91253209114075 sec.
Server Epoch:16 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
___Train Local_Simple,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0096, Accuracy: 493/582 (84.7079%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 13.3502, Accuracy: 1176/10000 (11.7600%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0075, Accuracy: 584/683 (85.5051%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4447, Accuracy: 8758/10000 (87.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0091, Accuracy: 483/597 (80.9045%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4237, Accuracy: 8842/10000 (88.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0033, Accuracy: 399/410 (97.3171%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.3812, Accuracy: 6822/10000 (68.2200%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0083, Accuracy: 515/617 (83.4684%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3976, Accuracy: 8815/10000 (88.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0079, Accuracy: 448/526 (85.1711%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5155, Accuracy: 8606/10000 (86.0600%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   1,  Average loss: 0.0069, Accuracy: 566/644 (87.8882%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   2,  Average loss: 0.0039, Accuracy: 600/644 (93.1677%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   3,  Average loss: 0.0035, Accuracy: 603/644 (93.6335%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   4,  Average loss: 0.0019, Accuracy: 624/644 (96.8944%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   5,  Average loss: 0.0013, Accuracy: 633/644 (98.2919%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   6,  Average loss: 0.0024, Accuracy: 632/644 (98.1366%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   7,  Average loss: 0.0021, Accuracy: 618/644 (95.9627%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   8,  Average loss: 0.0013, Accuracy: 634/644 (98.4472%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   9,  Average loss: 0.0009, Accuracy: 634/644 (98.4472%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch  10,  Average loss: 0.0009, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Global model norm: 14.757088719678714.
Norm before scaling: 15.11366894210673. Distance: 1.9184565341450743
Total norm for 2 adversaries is: 15.11366894210673. distance: 1.9184565341450743
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1886, Accuracy: 8499/8991 (94.5279%)
___Train Local_Simple,  epoch  16, local model 63, internal_epoch   1,  Average loss: 0.0096, Accuracy: 506/616 (82.1429%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4912, Accuracy: 8601/10000 (86.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 52, internal_epoch   1,  Average loss: 0.0090, Accuracy: 516/618 (83.4951%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3923, Accuracy: 8895/10000 (88.9500%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   1,  Average loss: 0.0094, Accuracy: 500/577 (86.6551%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   2,  Average loss: 0.0142, Accuracy: 455/577 (78.8562%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   3,  Average loss: 0.0067, Accuracy: 505/577 (87.5217%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   4,  Average loss: 0.0041, Accuracy: 546/577 (94.6274%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   5,  Average loss: 0.0035, Accuracy: 550/577 (95.3206%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   6,  Average loss: 0.0033, Accuracy: 550/577 (95.3206%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   7,  Average loss: 0.0028, Accuracy: 547/577 (94.8007%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   8,  Average loss: 0.0023, Accuracy: 550/577 (95.3206%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   9,  Average loss: 0.0020, Accuracy: 555/577 (96.1872%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch  10,  Average loss: 0.0022, Accuracy: 557/577 (96.5338%), train_poison_data_count: 577
Global model norm: 14.757088719678714.
Norm before scaling: 16.09027097560384. Distance: 5.26294547254644
Total norm for 2 adversaries is: 16.09027097560384. distance: 5.26294547254644
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.2862, Accuracy: 8216/8991 (91.3803%)
time spent on training: 57.542540073394775
[foolsgold agg] training data poison_ratio: 0.2080068143100511  data num: [582, 683, 597, 410, 617, 526, 644, 616, 618, 577]
[foolsgold agg] considering poison per batch poison_fraction: 0.2080068143100511
[foolsgold agg] wv: [1.         1.         1.         1.         0.93170771 1.
 1.         1.         0.93170771 1.        ]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.6223, Accuracy: 7586/10000 (75.8600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.5588, Accuracy: 7418/8991 (82.5047%)
Done in 92.9141480922699 sec.
Server Epoch:17 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0073, Accuracy: 532/629 (84.5787%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2785, Accuracy: 9202/10000 (92.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 33, internal_epoch   1,  Average loss: 0.0060, Accuracy: 556/638 (87.1473%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3395, Accuracy: 8944/10000 (89.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 56, internal_epoch   1,  Average loss: 0.0079, Accuracy: 533/626 (85.1438%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2872, Accuracy: 9118/10000 (91.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 97, internal_epoch   1,  Average loss: 0.0067, Accuracy: 514/588 (87.4150%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.0477, Accuracy: 7323/10000 (73.2300%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0066, Accuracy: 507/572 (88.6364%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0036, Accuracy: 534/572 (93.3566%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   3,  Average loss: 0.0025, Accuracy: 543/572 (94.9301%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   4,  Average loss: 0.0014, Accuracy: 559/572 (97.7273%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   5,  Average loss: 0.0010, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   6,  Average loss: 0.0008, Accuracy: 565/572 (98.7762%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   7,  Average loss: 0.0007, Accuracy: 566/572 (98.9510%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   8,  Average loss: 0.0006, Accuracy: 568/572 (99.3007%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   9,  Average loss: 0.0006, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch  10,  Average loss: 0.0005, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Global model norm: 14.851653426372106.
Norm before scaling: 15.147654315913538. Distance: 1.7730508122271222
Total norm for 2 adversaries is: 15.147654315913538. distance: 1.7730508122271222
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1938, Accuracy: 8474/8991 (94.2498%)
___Train Local_Simple,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0060, Accuracy: 473/521 (90.7869%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3884, Accuracy: 8703/10000 (87.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 77, internal_epoch   1,  Average loss: 0.0082, Accuracy: 436/519 (84.0077%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.1128, Accuracy: 7101/10000 (71.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0060, Accuracy: 558/641 (87.0515%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9113, Accuracy: 7897/10000 (78.9700%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   1,  Average loss: 0.0079, Accuracy: 507/577 (87.8683%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   2,  Average loss: 0.0071, Accuracy: 513/577 (88.9081%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   3,  Average loss: 0.0031, Accuracy: 548/577 (94.9740%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   4,  Average loss: 0.0022, Accuracy: 560/577 (97.0537%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   5,  Average loss: 0.0019, Accuracy: 561/577 (97.2270%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   6,  Average loss: 0.0016, Accuracy: 564/577 (97.7470%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   7,  Average loss: 0.0014, Accuracy: 567/577 (98.2669%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   8,  Average loss: 0.0013, Accuracy: 565/577 (97.9203%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   9,  Average loss: 0.0013, Accuracy: 566/577 (98.0936%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch  10,  Average loss: 0.0011, Accuracy: 566/577 (98.0936%), train_poison_data_count: 577
Global model norm: 14.851653426372106.
Norm before scaling: 15.389963699307923. Distance: 2.901560619971961
Total norm for 2 adversaries is: 15.389963699307923. distance: 2.901560619971961
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.2515, Accuracy: 8313/8991 (92.4591%)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0068, Accuracy: 570/652 (87.4233%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3077, Accuracy: 9126/10000 (91.2600%), Attack Success Rate:0/10000(0.000)
time spent on training: 774.3423030376434
[foolsgold agg] training data poison_ratio: 0.19268824417239644  data num: [629, 638, 626, 588, 572, 521, 519, 641, 577, 652]
[foolsgold agg] considering poison per batch poison_fraction: 0.19268824417239644
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.5625, Accuracy: 7754/10000 (77.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.4908, Accuracy: 7514/8991 (83.5725%)
Done in 820.4621269702911 sec.
Server Epoch:18 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0063, Accuracy: 518/592 (87.5000%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3369, Accuracy: 8967/10000 (89.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 449/510 (88.0392%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3176, Accuracy: 8988/10000 (89.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 88, internal_epoch   1,  Average loss: 0.0059, Accuracy: 606/679 (89.2489%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5519, Accuracy: 8434/10000 (84.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0069, Accuracy: 513/588 (87.2449%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6509, Accuracy: 8121/10000 (81.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 39, internal_epoch   1,  Average loss: 0.0066, Accuracy: 431/503 (85.6859%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2355, Accuracy: 9268/10000 (92.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 75, internal_epoch   1,  Average loss: 0.0062, Accuracy: 486/554 (87.7256%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3832, Accuracy: 8710/10000 (87.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 82, internal_epoch   1,  Average loss: 0.0077, Accuracy: 517/621 (83.2528%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3112, Accuracy: 9035/10000 (90.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0060, Accuracy: 467/537 (86.9646%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2946, Accuracy: 9032/10000 (90.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 468/532 (87.9699%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4724, Accuracy: 8430/10000 (84.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0060, Accuracy: 455/529 (86.0113%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5153, Accuracy: 8283/10000 (82.8300%), Attack Success Rate:0/10000(0.000)
time spent on training: 40.28671908378601
[foolsgold agg] training data poison_ratio: 0.0  data num: [592, 510, 679, 588, 503, 554, 621, 537, 532, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         0.7399287  1.         0.47937058 0.7399287  1.
 1.         0.47937058 1.         0.7450457 ]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.4785, Accuracy: 8248/10000 (82.4800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.5382, Accuracy: 7062/8991 (78.5452%)
Done in 78.60649490356445 sec.
Server Epoch:19 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
___Train Local_Simple,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0049, Accuracy: 577/641 (90.0156%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.5136, Accuracy: 8536/10000 (85.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.0071, Accuracy: 461/518 (88.9961%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.2575, Accuracy: 7227/10000 (72.2700%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   1,  Average loss: 0.0059, Accuracy: 425/474 (89.6624%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   2,  Average loss: 0.0024, Accuracy: 455/474 (95.9916%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   3,  Average loss: 0.0024, Accuracy: 450/474 (94.9367%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   4,  Average loss: 0.0016, Accuracy: 463/474 (97.6793%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   5,  Average loss: 0.0010, Accuracy: 466/474 (98.3122%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   6,  Average loss: 0.0009, Accuracy: 469/474 (98.9451%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   7,  Average loss: 0.0008, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   8,  Average loss: 0.0007, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   9,  Average loss: 0.0006, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch  10,  Average loss: 0.0006, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Global model norm: 14.955639156456169.
Norm before scaling: 15.153466541282672. Distance: 1.5590775200324258
Total norm for 1 adversaries is: 15.153466541282672. distance: 1.5590775200324258
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1697, Accuracy: 8544/8991 (95.0284%)
___Train Local_Simple,  epoch  19, local model 84, internal_epoch   1,  Average loss: 0.0052, Accuracy: 510/560 (91.0714%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2323, Accuracy: 9285/10000 (92.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0063, Accuracy: 516/582 (88.6598%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2719, Accuracy: 9156/10000 (91.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0075, Accuracy: 564/665 (84.8120%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3541, Accuracy: 8968/10000 (89.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 611/683 (89.4583%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.5547, Accuracy: 8332/10000 (83.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 511/581 (87.9518%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6489, Accuracy: 8088/10000 (80.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 635/708 (89.6893%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4794, Accuracy: 8608/10000 (86.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0065, Accuracy: 435/505 (86.1386%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.5856, Accuracy: 8304/10000 (83.0400%), Attack Success Rate:0/10000(0.000)
time spent on training: 49.425519704818726
[foolsgold agg] training data poison_ratio: 0.08010816292039885  data num: [641, 518, 474, 560, 582, 665, 683, 581, 708, 505]
[foolsgold agg] considering poison per batch poison_fraction: 0.08010816292039885
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.4615, Accuracy: 8279/10000 (82.7900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.5051, Accuracy: 7240/8991 (80.5250%)
Done in 88.04971289634705 sec.
Server Epoch:20 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
___Train Local_Simple,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0069, Accuracy: 503/588 (85.5442%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3396, Accuracy: 8941/10000 (89.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0056, Accuracy: 459/518 (88.6100%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2193, Accuracy: 9323/10000 (93.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 27, internal_epoch   1,  Average loss: 0.0068, Accuracy: 571/650 (87.8462%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.5501, Accuracy: 8174/10000 (81.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 82, internal_epoch   1,  Average loss: 0.0049, Accuracy: 561/621 (90.3382%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2738, Accuracy: 9146/10000 (91.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0045, Accuracy: 581/641 (90.6396%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.4226, Accuracy: 8769/10000 (87.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0051, Accuracy: 441/493 (89.4523%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3045, Accuracy: 8995/10000 (89.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 29, internal_epoch   1,  Average loss: 0.0061, Accuracy: 538/605 (88.9256%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2830, Accuracy: 9080/10000 (90.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 47, internal_epoch   1,  Average loss: 0.0050, Accuracy: 539/602 (89.5349%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3939, Accuracy: 8742/10000 (87.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0054, Accuracy: 576/644 (89.4410%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.4871, Accuracy: 7628/10000 (76.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0059, Accuracy: 588/665 (88.4211%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3002, Accuracy: 9019/10000 (90.1900%), Attack Success Rate:0/10000(0.000)
time spent on training: 40.51459717750549
[foolsgold agg] training data poison_ratio: 0.0  data num: [588, 518, 650, 621, 641, 493, 605, 602, 644, 665]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.95115411 1.         1.         1.         0.79520747 0.79520747
 1.         1.         1.         0.95115411]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.4267, Accuracy: 8475/10000 (84.7500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.4985, Accuracy: 7272/8991 (80.8809%)
Done in 78.7348039150238 sec.
Server Epoch:21 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
___Train Local_Simple,  epoch  21, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 582/638 (91.2226%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2976, Accuracy: 9035/10000 (90.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0063, Accuracy: 517/597 (86.5997%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2713, Accuracy: 9120/10000 (91.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 485/529 (91.6824%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3713, Accuracy: 8755/10000 (87.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 512/572 (89.5105%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3758, Accuracy: 8867/10000 (88.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0052, Accuracy: 588/652 (90.1840%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3162, Accuracy: 8996/10000 (89.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0055, Accuracy: 529/588 (89.9660%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4538, Accuracy: 8491/10000 (84.9100%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   1,  Average loss: 0.0061, Accuracy: 483/553 (87.3418%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   2,  Average loss: 0.0034, Accuracy: 517/553 (93.4901%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   3,  Average loss: 0.0019, Accuracy: 529/553 (95.6600%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   4,  Average loss: 0.0015, Accuracy: 537/553 (97.1067%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   5,  Average loss: 0.0012, Accuracy: 541/553 (97.8300%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   6,  Average loss: 0.0011, Accuracy: 543/553 (98.1917%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   7,  Average loss: 0.0010, Accuracy: 545/553 (98.5533%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   8,  Average loss: 0.0009, Accuracy: 547/553 (98.9150%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   9,  Average loss: 0.0009, Accuracy: 547/553 (98.9150%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch  10,  Average loss: 0.0008, Accuracy: 547/553 (98.9150%), train_poison_data_count: 553
Global model norm: 15.037871807572259.
Norm before scaling: 15.264221564198337. Distance: 1.6714802926716406
Total norm for 1 adversaries is: 15.264221564198337. distance: 1.6714802926716406
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1443, Accuracy: 8600/8991 (95.6512%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0052, Accuracy: 522/587 (88.9267%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4712, Accuracy: 8426/10000 (84.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 469/523 (89.6750%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2907, Accuracy: 9086/10000 (90.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 541/618 (87.5405%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3088, Accuracy: 9014/10000 (90.1400%), Attack Success Rate:0/10000(0.000)
time spent on training: 50.18592882156372
[foolsgold agg] training data poison_ratio: 0.09441693699846337  data num: [638, 597, 529, 572, 652, 588, 553, 587, 523, 618]
[foolsgold agg] considering poison per batch poison_fraction: 0.09441693699846337
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.4224, Accuracy: 8492/10000 (84.9200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.4682, Accuracy: 7424/8991 (82.5715%)
Done in 88.50799107551575 sec.
Server Epoch:22 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
___Train Local_Simple,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.0042, Accuracy: 529/578 (91.5225%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2621, Accuracy: 9146/10000 (91.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0063, Accuracy: 698/774 (90.1809%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.9102, Accuracy: 7768/10000 (77.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0062, Accuracy: 589/665 (88.5714%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6466, Accuracy: 7755/10000 (77.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0055, Accuracy: 550/609 (90.3120%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3097, Accuracy: 9059/10000 (90.5900%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   1,  Average loss: 0.0045, Accuracy: 580/644 (90.0621%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   2,  Average loss: 0.0023, Accuracy: 614/644 (95.3416%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   3,  Average loss: 0.0011, Accuracy: 631/644 (97.9814%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   4,  Average loss: 0.0009, Accuracy: 633/644 (98.2919%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   5,  Average loss: 0.0008, Accuracy: 635/644 (98.6025%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   6,  Average loss: 0.0007, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   7,  Average loss: 0.0006, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   8,  Average loss: 0.0006, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   9,  Average loss: 0.0005, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch  10,  Average loss: 0.0006, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Global model norm: 15.084345887201293.
Norm before scaling: 15.293588349517329. Distance: 1.720764644012367
Total norm for 1 adversaries is: 15.293588349517329. distance: 1.720764644012367
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1776, Accuracy: 8540/8991 (94.9839%)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0048, Accuracy: 618/683 (90.4832%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2701, Accuracy: 9130/10000 (91.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0058, Accuracy: 437/493 (88.6410%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3574, Accuracy: 8812/10000 (88.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 507/571 (88.7916%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3065, Accuracy: 9042/10000 (90.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 27, internal_epoch   1,  Average loss: 0.0064, Accuracy: 566/650 (87.0769%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5182, Accuracy: 8223/10000 (82.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 96, internal_epoch   1,  Average loss: 0.0033, Accuracy: 568/608 (93.4211%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3144, Accuracy: 8975/10000 (89.7500%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.35912203788757
[foolsgold agg] training data poison_ratio: 0.10262948207171314  data num: [578, 774, 665, 609, 644, 683, 493, 571, 650, 608]
[foolsgold agg] considering poison per batch poison_fraction: 0.10262948207171314
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.4058, Accuracy: 8502/10000 (85.0200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.4033, Accuracy: 7684/8991 (85.4632%)
Done in 89.73045301437378 sec.
Server Epoch:23 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 555/626 (88.6581%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3220, Accuracy: 9010/10000 (90.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 548/621 (88.2448%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2835, Accuracy: 9166/10000 (91.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 85, internal_epoch   1,  Average loss: 0.0040, Accuracy: 521/570 (91.4035%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2592, Accuracy: 9162/10000 (91.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 594/648 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2234, Accuracy: 9296/10000 (92.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 453/518 (87.4517%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3839, Accuracy: 8768/10000 (87.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 61, internal_epoch   1,  Average loss: 0.0046, Accuracy: 490/537 (91.2477%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4036, Accuracy: 8652/10000 (86.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 482/526 (91.6350%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2313, Accuracy: 9288/10000 (92.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0057, Accuracy: 520/587 (88.5860%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3078, Accuracy: 9139/10000 (91.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 605/664 (91.1145%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4083, Accuracy: 8741/10000 (87.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 75, internal_epoch   1,  Average loss: 0.0053, Accuracy: 495/554 (89.3502%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4028, Accuracy: 8645/10000 (86.4500%), Attack Success Rate:0/10000(0.000)
time spent on training: 40.766924142837524
[foolsgold agg] training data poison_ratio: 0.0  data num: [626, 621, 570, 648, 518, 537, 526, 587, 664, 554]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.32322942 1.         1.         1.         1.         1.
 1.         1.         0.32322942 1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.3767, Accuracy: 8725/10000 (87.2500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.4767, Accuracy: 7422/8991 (82.5492%)
Done in 79.24602699279785 sec.
Server Epoch:24 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
___Train Local_Simple,  epoch  24, local model 36, internal_epoch   1,  Average loss: 0.0050, Accuracy: 471/520 (90.5769%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2435, Accuracy: 9198/10000 (91.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0052, Accuracy: 513/573 (89.5288%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3346, Accuracy: 9011/10000 (90.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 96, internal_epoch   1,  Average loss: 0.0030, Accuracy: 568/608 (93.4211%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3891, Accuracy: 8706/10000 (87.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 83, internal_epoch   1,  Average loss: 0.0053, Accuracy: 494/555 (89.0090%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2311, Accuracy: 9306/10000 (93.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 63, internal_epoch   1,  Average loss: 0.0059, Accuracy: 546/616 (88.6364%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2906, Accuracy: 9088/10000 (90.8800%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 609/668 (91.1677%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   2,  Average loss: 0.0023, Accuracy: 643/668 (96.2575%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   3,  Average loss: 0.0010, Accuracy: 656/668 (98.2036%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   4,  Average loss: 0.0008, Accuracy: 659/668 (98.6527%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   5,  Average loss: 0.0007, Accuracy: 663/668 (99.2515%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   6,  Average loss: 0.0007, Accuracy: 663/668 (99.2515%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   7,  Average loss: 0.0005, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   8,  Average loss: 0.0004, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   9,  Average loss: 0.0004, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch  10,  Average loss: 0.0004, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Global model norm: 15.149636121352057.
Norm before scaling: 15.327932871820874. Distance: 1.6637713396980913
Total norm for 2 adversaries is: 15.327932871820874. distance: 1.6637713396980913
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1332, Accuracy: 8640/8991 (96.0961%)
___Train Local_Simple,  epoch  24, local model 94, internal_epoch   1,  Average loss: 0.0040, Accuracy: 510/555 (91.8919%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3045, Accuracy: 8972/10000 (89.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0068, Accuracy: 513/582 (88.1443%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5598, Accuracy: 8355/10000 (83.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0058, Accuracy: 554/618 (89.6440%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3778, Accuracy: 8890/10000 (88.9000%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   1,  Average loss: 0.0050, Accuracy: 430/474 (90.7173%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   2,  Average loss: 0.0029, Accuracy: 448/474 (94.5148%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   3,  Average loss: 0.0027, Accuracy: 453/474 (95.5696%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   4,  Average loss: 0.0014, Accuracy: 463/474 (97.6793%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   5,  Average loss: 0.0010, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   6,  Average loss: 0.0009, Accuracy: 467/474 (98.5232%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   7,  Average loss: 0.0008, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   8,  Average loss: 0.0007, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   9,  Average loss: 0.0007, Accuracy: 469/474 (98.9451%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch  10,  Average loss: 0.0006, Accuracy: 469/474 (98.9451%), train_poison_data_count: 474
Global model norm: 15.149636121352057.
Norm before scaling: 15.304294178043166. Distance: 1.6528522980432125
Total norm for 2 adversaries is: 15.304294178043166. distance: 1.6528522980432125
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1524, Accuracy: 8566/8991 (95.2731%)
time spent on training: 62.409546852111816
[foolsgold agg] training data poison_ratio: 0.19795458485006068  data num: [520, 573, 608, 555, 616, 668, 555, 582, 618, 474]
[foolsgold agg] considering poison per batch poison_fraction: 0.19795458485006068
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.3515, Accuracy: 8776/10000 (87.7600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.3976, Accuracy: 7673/8991 (85.3409%)
Done in 100.93746519088745 sec.
Server Epoch:25 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
___Train Local_Simple,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0057, Accuracy: 659/750 (87.8667%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2625, Accuracy: 9146/10000 (91.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0043, Accuracy: 653/708 (92.2316%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2537, Accuracy: 9147/10000 (91.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 452/493 (91.6836%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2258, Accuracy: 9323/10000 (93.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0051, Accuracy: 578/648 (89.1975%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2442, Accuracy: 9284/10000 (92.8400%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0051, Accuracy: 495/553 (89.5118%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0027, Accuracy: 521/553 (94.2134%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   3,  Average loss: 0.0015, Accuracy: 537/553 (97.1067%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   4,  Average loss: 0.0012, Accuracy: 541/553 (97.8300%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   5,  Average loss: 0.0010, Accuracy: 544/553 (98.3725%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   6,  Average loss: 0.0010, Accuracy: 546/553 (98.7342%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   7,  Average loss: 0.0009, Accuracy: 547/553 (98.9150%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   8,  Average loss: 0.0008, Accuracy: 549/553 (99.2767%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   9,  Average loss: 0.0007, Accuracy: 550/553 (99.4575%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch  10,  Average loss: 0.0007, Accuracy: 550/553 (99.4575%), train_poison_data_count: 553
Global model norm: 15.193686147702367.
Norm before scaling: 15.367638290922422. Distance: 1.7449935416727869
Total norm for 1 adversaries is: 15.367638290922422. distance: 1.7449935416727869
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1428, Accuracy: 8598/8991 (95.6290%)
___Train Local_Simple,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0066, Accuracy: 542/626 (86.5815%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3310, Accuracy: 9044/10000 (90.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0049, Accuracy: 471/518 (90.9266%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3264, Accuracy: 8902/10000 (89.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 634/683 (92.8258%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2806, Accuracy: 9149/10000 (91.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 566/626 (90.4153%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2312, Accuracy: 9277/10000 (92.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0046, Accuracy: 460/505 (91.0891%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2123, Accuracy: 9356/10000 (93.5600%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.644535779953
[foolsgold agg] training data poison_ratio: 0.09050736497545009  data num: [750, 708, 493, 648, 553, 626, 518, 683, 626, 505]
[foolsgold agg] considering poison per batch poison_fraction: 0.09050736497545009
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.3521, Accuracy: 8789/10000 (87.8900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.4057, Accuracy: 7679/8991 (85.4076%)
Done in 99.34613990783691 sec.
Server Epoch:26 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
___Train Local_Simple,  epoch  26, local model 39, internal_epoch   1,  Average loss: 0.0068, Accuracy: 437/503 (86.8787%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3483, Accuracy: 8938/10000 (89.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0047, Accuracy: 492/535 (91.9626%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3564, Accuracy: 8914/10000 (89.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 32, internal_epoch   1,  Average loss: 0.0034, Accuracy: 560/609 (91.9540%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3184, Accuracy: 9074/10000 (90.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 528/587 (89.9489%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2699, Accuracy: 9116/10000 (91.1600%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   1,  Average loss: 0.0034, Accuracy: 626/668 (93.7126%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   2,  Average loss: 0.0019, Accuracy: 645/668 (96.5569%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   3,  Average loss: 0.0013, Accuracy: 646/668 (96.7066%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   4,  Average loss: 0.0007, Accuracy: 660/668 (98.8024%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   5,  Average loss: 0.0006, Accuracy: 662/668 (99.1018%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   6,  Average loss: 0.0005, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   7,  Average loss: 0.0004, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   8,  Average loss: 0.0004, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   9,  Average loss: 0.0004, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch  10,  Average loss: 0.0004, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Global model norm: 15.23217281759622.
Norm before scaling: 15.376397790405562. Distance: 1.5583898272278274
Total norm for 1 adversaries is: 15.376397790405562. distance: 1.5583898272278274
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1282, Accuracy: 8643/8991 (96.1295%)
___Train Local_Simple,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0060, Accuracy: 547/616 (88.7987%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2346, Accuracy: 9309/10000 (93.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0057, Accuracy: 530/588 (90.1361%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3110, Accuracy: 9020/10000 (90.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 454/505 (89.9010%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2487, Accuracy: 9172/10000 (91.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0050, Accuracy: 499/555 (89.9099%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3429, Accuracy: 8841/10000 (88.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 84, internal_epoch   1,  Average loss: 0.0038, Accuracy: 515/560 (91.9643%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2506, Accuracy: 9140/10000 (91.4000%), Attack Success Rate:0/10000(0.000)
time spent on training: 49.748971939086914
[foolsgold agg] training data poison_ratio: 0.11666084526720223  data num: [503, 535, 609, 587, 668, 616, 588, 505, 555, 560]
[foolsgold agg] considering poison per batch poison_fraction: 0.11666084526720223
[foolsgold agg] wv: [0.88575418 1.         1.         0.88575418 1.         1.
 1.         0.90125117 1.         0.90125117]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.3103, Accuracy: 8996/10000 (89.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.4757, Accuracy: 7532/8991 (83.7727%)
Done in 87.34709787368774 sec.
Server Epoch:27 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
___Train Local_Simple,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.0040, Accuracy: 597/646 (92.4149%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4707, Accuracy: 8476/10000 (84.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0062, Accuracy: 523/580 (90.1724%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.4871, Accuracy: 5689/10000 (56.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 42, internal_epoch   1,  Average loss: 0.0043, Accuracy: 606/665 (91.1278%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3603, Accuracy: 8834/10000 (88.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0053, Accuracy: 529/582 (90.8935%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4489, Accuracy: 8441/10000 (84.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 604/648 (93.2099%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4018, Accuracy: 8576/10000 (85.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0038, Accuracy: 599/641 (93.4477%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2312, Accuracy: 9239/10000 (92.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 45, internal_epoch   1,  Average loss: 0.0041, Accuracy: 697/750 (92.9333%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3276, Accuracy: 8924/10000 (89.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 54, internal_epoch   1,  Average loss: 0.0035, Accuracy: 487/523 (93.1166%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2607, Accuracy: 9234/10000 (92.3400%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   1,  Average loss: 0.0044, Accuracy: 605/668 (90.5689%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   2,  Average loss: 0.0022, Accuracy: 643/668 (96.2575%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   3,  Average loss: 0.0011, Accuracy: 654/668 (97.9042%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   4,  Average loss: 0.0008, Accuracy: 661/668 (98.9521%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   5,  Average loss: 0.0007, Accuracy: 662/668 (99.1018%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   6,  Average loss: 0.0006, Accuracy: 663/668 (99.2515%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   7,  Average loss: 0.0005, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   8,  Average loss: 0.0005, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   9,  Average loss: 0.0004, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch  10,  Average loss: 0.0004, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Global model norm: 15.26656405041008.
Norm before scaling: 15.450754506474302. Distance: 1.9293334265438462
Total norm for 1 adversaries is: 15.450754506474302. distance: 1.9293334265438462
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1259, Accuracy: 8644/8991 (96.1406%)
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 555/609 (91.1330%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2435, Accuracy: 9236/10000 (92.3600%), Attack Success Rate:0/10000(0.000)
time spent on training: 55.73350191116333
[foolsgold agg] training data poison_ratio: 0.10583016476552598  data num: [646, 580, 665, 582, 648, 641, 750, 523, 668, 609]
[foolsgold agg] considering poison per batch poison_fraction: 0.10583016476552598
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.2948, Accuracy: 9051/10000 (90.5100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.4904, Accuracy: 7490/8991 (83.3055%)
Done in 92.81048703193665 sec.
Server Epoch:28 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
___Train Local_Simple,  epoch  28, local model 33, internal_epoch   1,  Average loss: 0.0036, Accuracy: 593/638 (92.9467%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2525, Accuracy: 9197/10000 (91.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0053, Accuracy: 599/647 (92.5811%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2770, Accuracy: 9084/10000 (90.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0037, Accuracy: 604/648 (93.2099%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2476, Accuracy: 9227/10000 (92.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 553/616 (89.7727%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3297, Accuracy: 9094/10000 (90.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 653/708 (92.2316%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2522, Accuracy: 9198/10000 (91.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.0036, Accuracy: 541/578 (93.5986%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2748, Accuracy: 9072/10000 (90.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 574/621 (92.4316%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2362, Accuracy: 9288/10000 (92.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 35, internal_epoch   1,  Average loss: 0.0044, Accuracy: 448/493 (90.8722%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2050, Accuracy: 9402/10000 (94.0200%), Attack Success Rate:0/10000(0.000)
poison local model 80 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   1,  Average loss: 0.0028, Accuracy: 559/593 (94.2664%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   2,  Average loss: 0.0017, Accuracy: 574/593 (96.7960%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   3,  Average loss: 0.0010, Accuracy: 580/593 (97.8078%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   4,  Average loss: 0.0004, Accuracy: 591/593 (99.6627%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   5,  Average loss: 0.0003, Accuracy: 592/593 (99.8314%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   6,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   7,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   8,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   9,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch  10,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Global model norm: 15.300500519986572.
Norm before scaling: 15.429197480351831. Distance: 1.658184361435911
Total norm for 1 adversaries is: 15.429197480351831. distance: 1.658184361435911
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1342, Accuracy: 8635/8991 (96.0405%)
___Train Local_Simple,  epoch  28, local model 81, internal_epoch   1,  Average loss: 0.0035, Accuracy: 540/586 (92.1502%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2632, Accuracy: 9144/10000 (91.4400%), Attack Success Rate:0/10000(0.000)
time spent on training: 49.98813199996948
[foolsgold agg] training data poison_ratio: 0.09676892950391645  data num: [638, 647, 648, 616, 708, 578, 621, 493, 593, 586]
[foolsgold agg] considering poison per batch poison_fraction: 0.09676892950391645
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.2692, Accuracy: 9159/10000 (91.5900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.5113, Accuracy: 7520/8991 (83.6392%)
Done in 86.72530269622803 sec.
Server Epoch:29 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
___Train Local_Simple,  epoch  29, local model 58, internal_epoch   1,  Average loss: 0.0041, Accuracy: 470/510 (92.1569%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2833, Accuracy: 9133/10000 (91.3300%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   1,  Average loss: 0.0032, Accuracy: 544/577 (94.2808%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   2,  Average loss: 0.0025, Accuracy: 543/577 (94.1075%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   3,  Average loss: 0.0013, Accuracy: 564/577 (97.7470%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   4,  Average loss: 0.0010, Accuracy: 568/577 (98.4402%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   5,  Average loss: 0.0008, Accuracy: 570/577 (98.7868%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   6,  Average loss: 0.0007, Accuracy: 572/577 (99.1334%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   7,  Average loss: 0.0006, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   8,  Average loss: 0.0005, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   9,  Average loss: 0.0005, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch  10,  Average loss: 0.0005, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Global model norm: 15.328476399195816.
Norm before scaling: 15.424376063657323. Distance: 1.7044374501083304
Total norm for 3 adversaries is: 15.424376063657323. distance: 1.7044374501083304
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1657, Accuracy: 8531/8991 (94.8838%)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0034, Accuracy: 621/668 (92.9641%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   2,  Average loss: 0.0023, Accuracy: 644/668 (96.4072%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   3,  Average loss: 0.0009, Accuracy: 660/668 (98.8024%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   4,  Average loss: 0.0006, Accuracy: 664/668 (99.4012%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   5,  Average loss: 0.0005, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   6,  Average loss: 0.0004, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   7,  Average loss: 0.0004, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   8,  Average loss: 0.0003, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   9,  Average loss: 0.0003, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch  10,  Average loss: 0.0003, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Global model norm: 15.328476399195816.
Norm before scaling: 15.50839203104796. Distance: 1.837431085033813
Total norm for 3 adversaries is: 15.50839203104796. distance: 1.837431085033813
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1332, Accuracy: 8629/8991 (95.9738%)
___Train Local_Simple,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.0032, Accuracy: 496/529 (93.7618%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2462, Accuracy: 9193/10000 (91.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0045, Accuracy: 599/652 (91.8712%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2000, Accuracy: 9404/10000 (94.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 529/582 (90.8935%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2514, Accuracy: 9299/10000 (92.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0053, Accuracy: 523/581 (90.0172%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2986, Accuracy: 8979/10000 (89.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 91, internal_epoch   1,  Average loss: 0.0040, Accuracy: 574/627 (91.5470%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2745, Accuracy: 9148/10000 (91.4800%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0041, Accuracy: 437/474 (92.1941%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0020, Accuracy: 460/474 (97.0464%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   3,  Average loss: 0.0011, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   4,  Average loss: 0.0009, Accuracy: 466/474 (98.3122%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   5,  Average loss: 0.0006, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   6,  Average loss: 0.0005, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   7,  Average loss: 0.0005, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   8,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   9,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch  10,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Global model norm: 15.328476399195816.
Norm before scaling: 15.46693289516683. Distance: 1.9427477003375266
Total norm for 3 adversaries is: 15.46693289516683. distance: 1.9427477003375266
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1363, Accuracy: 8626/8991 (95.9404%)
___Train Local_Simple,  epoch  29, local model 57, internal_epoch   1,  Average loss: 0.0035, Accuracy: 530/568 (93.3099%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2199, Accuracy: 9307/10000 (93.0700%), Attack Success Rate:0/10000(0.000)
time spent on training: 68.87253785133362
[foolsgold agg] training data poison_ratio: 0.29802357836338417  data num: [510, 577, 668, 529, 652, 582, 581, 627, 474, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.29802357836338417
[foolsgold agg] wv: [1.         0.99954693 0.99954693 1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.2663, Accuracy: 9118/10000 (91.1800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.3584, Accuracy: 7823/8991 (87.0092%)
Done in 105.85159087181091 sec.
Server Epoch:30 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   1,  Average loss: 0.0029, Accuracy: 448/474 (94.5148%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   2,  Average loss: 0.0017, Accuracy: 454/474 (95.7806%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   3,  Average loss: 0.0008, Accuracy: 468/474 (98.7342%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   4,  Average loss: 0.0006, Accuracy: 469/474 (98.9451%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   5,  Average loss: 0.0006, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   6,  Average loss: 0.0004, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   7,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   8,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   9,  Average loss: 0.0003, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch  10,  Average loss: 0.0003, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 15.374948392952007.
Norm before scaling: 15.417942028732861. Distance: 1.3422378193101347
Total norm for 4 adversaries is: 15.417942028732861. distance: 1.3422378193101347
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1277, Accuracy: 8648/8991 (96.1851%)
___Train Local_Simple,  epoch  30, local model 77, internal_epoch   1,  Average loss: 0.0040, Accuracy: 476/519 (91.7148%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2664, Accuracy: 9163/10000 (91.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0051, Accuracy: 567/626 (90.5751%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4174, Accuracy: 8634/10000 (86.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 21, internal_epoch   1,  Average loss: 0.0047, Accuracy: 563/625 (90.0800%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2576, Accuracy: 9265/10000 (92.6500%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 538/572 (94.0559%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   2,  Average loss: 0.0022, Accuracy: 546/572 (95.4545%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   3,  Average loss: 0.0012, Accuracy: 562/572 (98.2517%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   4,  Average loss: 0.0007, Accuracy: 566/572 (98.9510%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   5,  Average loss: 0.0006, Accuracy: 568/572 (99.3007%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   6,  Average loss: 0.0005, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   7,  Average loss: 0.0004, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   8,  Average loss: 0.0003, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   9,  Average loss: 0.0003, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch  10,  Average loss: 0.0003, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Global model norm: 15.374948392952007.
Norm before scaling: 15.459121944468428. Distance: 1.650608675846034
Total norm for 4 adversaries is: 15.459121944468428. distance: 1.650608675846034
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1419, Accuracy: 8579/8991 (95.4176%)
___Train Local_Simple,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 633/683 (92.6794%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3169, Accuracy: 9012/10000 (90.1200%), Attack Success Rate:0/10000(0.000)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0029, Accuracy: 526/563 (93.4281%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   2,  Average loss: 0.0018, Accuracy: 540/563 (95.9147%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   3,  Average loss: 0.0009, Accuracy: 555/563 (98.5790%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   4,  Average loss: 0.0006, Accuracy: 560/563 (99.4671%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   5,  Average loss: 0.0005, Accuracy: 560/563 (99.4671%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   6,  Average loss: 0.0005, Accuracy: 561/563 (99.6448%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   7,  Average loss: 0.0004, Accuracy: 561/563 (99.6448%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   8,  Average loss: 0.0004, Accuracy: 561/563 (99.6448%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   9,  Average loss: 0.0003, Accuracy: 561/563 (99.6448%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch  10,  Average loss: 0.0003, Accuracy: 562/563 (99.8224%), train_poison_data_count: 563
Global model norm: 15.374948392952007.
Norm before scaling: 15.425568081427848. Distance: 1.3948854055473767
Total norm for 4 adversaries is: 15.425568081427848. distance: 1.3948854055473767
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1242, Accuracy: 8639/8991 (96.0850%)
___Train Local_Simple,  epoch  30, local model 52, internal_epoch   1,  Average loss: 0.0043, Accuracy: 564/618 (91.2621%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2920, Accuracy: 9123/10000 (91.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 45, internal_epoch   1,  Average loss: 0.0043, Accuracy: 687/750 (91.6000%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2139, Accuracy: 9428/10000 (94.2800%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   1,  Average loss: 0.0027, Accuracy: 629/668 (94.1617%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   2,  Average loss: 0.0016, Accuracy: 650/668 (97.3054%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   3,  Average loss: 0.0009, Accuracy: 658/668 (98.5030%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   4,  Average loss: 0.0005, Accuracy: 663/668 (99.2515%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   5,  Average loss: 0.0004, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   6,  Average loss: 0.0004, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   7,  Average loss: 0.0003, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   8,  Average loss: 0.0003, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   9,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch  10,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 15.374948392952007.
Norm before scaling: 15.486889124069137. Distance: 1.4943460560113166
Total norm for 4 adversaries is: 15.486889124069137. distance: 1.4943460560113166
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1225, Accuracy: 8658/8991 (96.2963%)
time spent on training: 78.45908403396606
[foolsgold agg] training data poison_ratio: 0.37340111511971136  data num: [474, 519, 626, 625, 572, 683, 563, 618, 750, 668]
[foolsgold agg] considering poison per batch poison_fraction: 0.37340111511971136
[foolsgold agg] wv: [0.61388863 1.         1.         1.         1.         1.
 0.61388863 1.         1.         0.61922021]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.3066, Accuracy: 8975/10000 (89.7500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.3266, Accuracy: 7965/8991 (88.5886%)
Done in 115.5505530834198 sec.
Server Epoch:31 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
___Train Local_Simple,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 567/626 (90.5751%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2751, Accuracy: 9210/10000 (92.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 494/548 (90.1460%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2185, Accuracy: 9381/10000 (93.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0013, Accuracy: 398/410 (97.0732%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.9343, Accuracy: 7943/10000 (79.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 85, internal_epoch   1,  Average loss: 0.0033, Accuracy: 536/570 (94.0351%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2495, Accuracy: 9210/10000 (92.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 543/587 (92.5043%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2326, Accuracy: 9248/10000 (92.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0044, Accuracy: 597/644 (92.7019%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2122, Accuracy: 9373/10000 (93.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 24, internal_epoch   1,  Average loss: 0.0036, Accuracy: 535/578 (92.5606%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3219, Accuracy: 8989/10000 (89.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0036, Accuracy: 623/665 (93.6842%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1854, Accuracy: 9406/10000 (94.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0052, Accuracy: 537/588 (91.3265%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2769, Accuracy: 9141/10000 (91.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 25, internal_epoch   1,  Average loss: 0.0039, Accuracy: 533/582 (91.5808%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3617, Accuracy: 8911/10000 (89.1100%), Attack Success Rate:0/10000(0.000)
time spent on training: 39.38181495666504
[foolsgold agg] training data poison_ratio: 0.0  data num: [626, 548, 410, 570, 587, 644, 578, 665, 588, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.2931, Accuracy: 9086/10000 (90.8600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.3863, Accuracy: 7779/8991 (86.5199%)
Done in 76.43890929222107 sec.
Server Epoch:32 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 482/529 (91.1153%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2812, Accuracy: 9173/10000 (91.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.0035, Accuracy: 531/575 (92.3478%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3215, Accuracy: 9052/10000 (90.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 559/592 (94.4257%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2414, Accuracy: 9231/10000 (92.3100%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 508/549 (92.5319%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   2,  Average loss: 0.0022, Accuracy: 525/549 (95.6284%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   3,  Average loss: 0.0014, Accuracy: 534/549 (97.2678%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   4,  Average loss: 0.0011, Accuracy: 540/549 (98.3607%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/549 (98.7250%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   6,  Average loss: 0.0008, Accuracy: 543/549 (98.9071%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   7,  Average loss: 0.0007, Accuracy: 545/549 (99.2714%), train_poison_data_count: 549
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   8,  Average loss: 0.0006, Accuracy: 545/549 (99.2714%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   9,  Average loss: 0.0006, Accuracy: 545/549 (99.2714%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch  10,  Average loss: 0.0006, Accuracy: 546/549 (99.4536%), train_poison_data_count: 549
Global model norm: 15.42771545942156.
Norm before scaling: 15.477818029430003. Distance: 1.472621765542451
Total norm for 3 adversaries is: 15.477818029430003. distance: 1.472621765542451
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.1302, Accuracy: 8633/8991 (96.0182%)
___Train Local_Simple,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0039, Accuracy: 527/572 (92.1329%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2137, Accuracy: 9313/10000 (93.1300%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 541/577 (93.7608%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   2,  Average loss: 0.0022, Accuracy: 553/577 (95.8406%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   3,  Average loss: 0.0015, Accuracy: 559/577 (96.8804%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   4,  Average loss: 0.0009, Accuracy: 569/577 (98.6135%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   5,  Average loss: 0.0006, Accuracy: 572/577 (99.1334%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   6,  Average loss: 0.0005, Accuracy: 571/577 (98.9601%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   7,  Average loss: 0.0005, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   8,  Average loss: 0.0004, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   9,  Average loss: 0.0004, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch  10,  Average loss: 0.0004, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Global model norm: 15.42771545942156.
Norm before scaling: 15.516302088228498. Distance: 1.6207261001823021
Total norm for 3 adversaries is: 15.516302088228498. distance: 1.6207261001823021
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.1422, Accuracy: 8611/8991 (95.7736%)
___Train Local_Simple,  epoch  32, local model 91, internal_epoch   1,  Average loss: 0.0033, Accuracy: 586/627 (93.4609%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1992, Accuracy: 9377/10000 (93.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 86, internal_epoch   1,  Average loss: 0.0031, Accuracy: 551/587 (93.8671%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5086, Accuracy: 8363/10000 (83.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 67, internal_epoch   1,  Average loss: 0.0043, Accuracy: 593/643 (92.2240%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2117, Accuracy: 9358/10000 (93.5800%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0035, Accuracy: 511/553 (92.4051%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 514/553 (92.9476%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   3,  Average loss: 0.0016, Accuracy: 536/553 (96.9259%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   4,  Average loss: 0.0012, Accuracy: 545/553 (98.5533%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   5,  Average loss: 0.0009, Accuracy: 547/553 (98.9150%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   6,  Average loss: 0.0008, Accuracy: 549/553 (99.2767%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   7,  Average loss: 0.0007, Accuracy: 550/553 (99.4575%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   8,  Average loss: 0.0006, Accuracy: 550/553 (99.4575%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   9,  Average loss: 0.0006, Accuracy: 551/553 (99.6383%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch  10,  Average loss: 0.0006, Accuracy: 551/553 (99.6383%), train_poison_data_count: 553
Global model norm: 15.42771545942156.
Norm before scaling: 15.556027947170964. Distance: 1.7568883204218104
Total norm for 3 adversaries is: 15.556027947170964. distance: 1.7568883204218104
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.1158, Accuracy: 8676/8991 (96.4965%)
time spent on training: 70.28414225578308
[foolsgold agg] training data poison_ratio: 0.28928325292901447  data num: [529, 575, 592, 549, 572, 577, 627, 587, 643, 553]
[foolsgold agg] considering poison per batch poison_fraction: 0.28928325292901447
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.84007067
 1.         1.         1.         0.84007067]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.3374, Accuracy: 8917/10000 (89.1700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.3606, Accuracy: 7897/8991 (87.8323%)
Done in 107.94286394119263 sec.
Server Epoch:33 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
___Train Local_Simple,  epoch  33, local model 77, internal_epoch   1,  Average loss: 0.0055, Accuracy: 471/519 (90.7514%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2929, Accuracy: 9015/10000 (90.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0038, Accuracy: 528/568 (92.9577%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2906, Accuracy: 9063/10000 (90.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 21, internal_epoch   1,  Average loss: 0.0053, Accuracy: 566/625 (90.5600%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3140, Accuracy: 9075/10000 (90.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.0050, Accuracy: 579/643 (90.0467%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4173, Accuracy: 8735/10000 (87.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0045, Accuracy: 496/535 (92.7103%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3953, Accuracy: 8688/10000 (86.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 514/588 (87.4150%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5113, Accuracy: 8410/10000 (84.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0053, Accuracy: 602/665 (90.5263%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3146, Accuracy: 8994/10000 (89.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 22, internal_epoch   1,  Average loss: 0.0042, Accuracy: 483/531 (90.9605%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1901, Accuracy: 9427/10000 (94.2700%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 510/549 (92.8962%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   2,  Average loss: 0.0024, Accuracy: 522/549 (95.0820%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   3,  Average loss: 0.0012, Accuracy: 536/549 (97.6321%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   4,  Average loss: 0.0009, Accuracy: 541/549 (98.5428%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   5,  Average loss: 0.0007, Accuracy: 543/549 (98.9071%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   6,  Average loss: 0.0006, Accuracy: 545/549 (99.2714%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   7,  Average loss: 0.0006, Accuracy: 546/549 (99.4536%), train_poison_data_count: 549
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   8,  Average loss: 0.0005, Accuracy: 546/549 (99.4536%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   9,  Average loss: 0.0005, Accuracy: 547/549 (99.6357%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch  10,  Average loss: 0.0005, Accuracy: 547/549 (99.6357%), train_poison_data_count: 549
Global model norm: 15.472057628536103.
Norm before scaling: 15.544807396275603. Distance: 1.6131920593582734
Total norm for 1 adversaries is: 15.544807396275603. distance: 1.6131920593582734
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.1232, Accuracy: 8652/8991 (96.2296%)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 487/529 (92.0605%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4130, Accuracy: 8854/10000 (88.5400%), Attack Success Rate:0/10000(0.000)
time spent on training: 49.909318923950195
[foolsgold agg] training data poison_ratio: 0.09544506258692628  data num: [519, 568, 625, 643, 535, 588, 665, 531, 549, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.09544506258692628
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.3406, Accuracy: 8927/10000 (89.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.3988, Accuracy: 7771/8991 (86.4309%)
Done in 87.2620370388031 sec.
Server Epoch:34 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
___Train Local_Simple,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 584/641 (91.1076%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3392, Accuracy: 8941/10000 (89.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0047, Accuracy: 469/516 (90.8915%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2127, Accuracy: 9355/10000 (93.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0040, Accuracy: 605/652 (92.7914%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2444, Accuracy: 9206/10000 (92.0600%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 443/474 (93.4599%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0020, Accuracy: 455/474 (95.9916%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   3,  Average loss: 0.0016, Accuracy: 459/474 (96.8354%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   4,  Average loss: 0.0008, Accuracy: 467/474 (98.5232%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   5,  Average loss: 0.0005, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   6,  Average loss: 0.0005, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   7,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   8,  Average loss: 0.0003, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   9,  Average loss: 0.0003, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch  10,  Average loss: 0.0003, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 15.497119266702642.
Norm before scaling: 15.572649116726907. Distance: 1.4507606714419206
Total norm for 2 adversaries is: 15.572649116726907. distance: 1.4507606714419206
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1321, Accuracy: 8641/8991 (96.1072%)
___Train Local_Simple,  epoch  34, local model 71, internal_epoch   1,  Average loss: 0.0042, Accuracy: 586/638 (91.8495%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2268, Accuracy: 9358/10000 (93.5800%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   1,  Average loss: 0.0061, Accuracy: 599/644 (93.0124%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   2,  Average loss: 0.0046, Accuracy: 581/644 (90.2174%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   3,  Average loss: 0.0027, Accuracy: 610/644 (94.7205%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   4,  Average loss: 0.0014, Accuracy: 628/644 (97.5155%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   5,  Average loss: 0.0012, Accuracy: 630/644 (97.8261%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   6,  Average loss: 0.0009, Accuracy: 634/644 (98.4472%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   7,  Average loss: 0.0008, Accuracy: 637/644 (98.9130%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   8,  Average loss: 0.0007, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   9,  Average loss: 0.0006, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch  10,  Average loss: 0.0006, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Global model norm: 15.497119266702642.
Norm before scaling: 15.883383632285394. Distance: 3.0462692832414713
Total norm for 2 adversaries is: 15.883383632285394. distance: 3.0462692832414713
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1635, Accuracy: 8578/8991 (95.4065%)
___Train Local_Simple,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0044, Accuracy: 616/665 (92.6316%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1989, Accuracy: 9417/10000 (94.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0038, Accuracy: 518/555 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2125, Accuracy: 9345/10000 (93.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.0030, Accuracy: 492/526 (93.5361%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3732, Accuracy: 8756/10000 (87.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 537/589 (91.1715%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3411, Accuracy: 9009/10000 (90.0900%), Attack Success Rate:0/10000(0.000)
time spent on training: 58.94922494888306
[foolsgold agg] training data poison_ratio: 0.18949152542372882  data num: [641, 516, 652, 474, 638, 644, 665, 555, 526, 589]
[foolsgold agg] considering poison per batch poison_fraction: 0.18949152542372882
[foolsgold agg] wv: [1.         1.         1.         0.81464992 1.         0.81464992
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.3477, Accuracy: 8905/10000 (89.0500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.3842, Accuracy: 7826/8991 (87.0426%)
Done in 99.77467894554138 sec.
Server Epoch:35 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   1,  Average loss: 0.0028, Accuracy: 448/474 (94.5148%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   2,  Average loss: 0.0015, Accuracy: 458/474 (96.6245%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   3,  Average loss: 0.0009, Accuracy: 466/474 (98.3122%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   4,  Average loss: 0.0006, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   5,  Average loss: 0.0004, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   6,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   7,  Average loss: 0.0003, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   8,  Average loss: 0.0003, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   9,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch  10,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 15.540690018935724.
Norm before scaling: 15.599838138620923. Distance: 1.394945398376438
Total norm for 2 adversaries is: 15.599838138620923. distance: 1.394945398376438
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1227, Accuracy: 8665/8991 (96.3742%)
___Train Local_Simple,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0045, Accuracy: 479/520 (92.1154%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3577, Accuracy: 8864/10000 (88.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 572/617 (92.7066%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2455, Accuracy: 9211/10000 (92.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 589/635 (92.7559%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2152, Accuracy: 9355/10000 (93.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 594/638 (93.1034%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2175, Accuracy: 9319/10000 (93.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 25, internal_epoch   1,  Average loss: 0.0048, Accuracy: 519/582 (89.1753%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2855, Accuracy: 9157/10000 (91.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0044, Accuracy: 523/572 (91.4336%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2761, Accuracy: 9162/10000 (91.6200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0051, Accuracy: 558/606 (92.0792%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   2,  Average loss: 0.0024, Accuracy: 585/606 (96.5347%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   3,  Average loss: 0.0014, Accuracy: 597/606 (98.5149%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   4,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   5,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   6,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   7,  Average loss: 0.0006, Accuracy: 600/606 (99.0099%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   8,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   9,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch  10,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Global model norm: 15.540690018935724.
Norm before scaling: 15.659021554831819. Distance: 1.9277752501880054
Total norm for 2 adversaries is: 15.659021554831819. distance: 1.9277752501880054
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1284, Accuracy: 8609/8991 (95.7513%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0037, Accuracy: 530/573 (92.4956%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2422, Accuracy: 9216/10000 (92.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 98, internal_epoch   1,  Average loss: 0.0016, Accuracy: 549/568 (96.6549%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4015, Accuracy: 8841/10000 (88.4100%), Attack Success Rate:0/10000(0.000)
time spent on training: 59.52697277069092
[foolsgold agg] training data poison_ratio: 0.18668971477960242  data num: [474, 520, 617, 635, 638, 582, 572, 606, 573, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.18668971477960242
[foolsgold agg] wv: [0.84080883 0.92434417 1.         1.         0.92434417 1.
 1.         0.84080883 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.3569, Accuracy: 8844/10000 (88.4400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.3467, Accuracy: 7965/8991 (88.5886%)
Done in 96.77902698516846 sec.
Server Epoch:36 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  36, local model 82, internal_epoch   1,  Average loss: 0.0045, Accuracy: 565/621 (90.9823%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2257, Accuracy: 9287/10000 (92.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 551/587 (93.8671%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2134, Accuracy: 9335/10000 (93.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 79, internal_epoch   1,  Average loss: 0.0028, Accuracy: 601/635 (94.6457%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2169, Accuracy: 9301/10000 (93.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0039, Accuracy: 559/609 (91.7898%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2483, Accuracy: 9236/10000 (92.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 47, internal_epoch   1,  Average loss: 0.0042, Accuracy: 559/602 (92.8571%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2951, Accuracy: 9136/10000 (91.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 471/518 (90.9266%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2392, Accuracy: 9249/10000 (92.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 89, internal_epoch   1,  Average loss: 0.0038, Accuracy: 619/664 (93.2229%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2015, Accuracy: 9462/10000 (94.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 546/589 (92.6995%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3026, Accuracy: 9064/10000 (90.6400%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   1,  Average loss: 0.0040, Accuracy: 506/549 (92.1676%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   2,  Average loss: 0.0021, Accuracy: 522/549 (95.0820%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   3,  Average loss: 0.0011, Accuracy: 536/549 (97.6321%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   4,  Average loss: 0.0008, Accuracy: 541/549 (98.5428%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   5,  Average loss: 0.0007, Accuracy: 542/549 (98.7250%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   6,  Average loss: 0.0006, Accuracy: 545/549 (99.2714%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   7,  Average loss: 0.0005, Accuracy: 546/549 (99.4536%), train_poison_data_count: 549
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   8,  Average loss: 0.0005, Accuracy: 547/549 (99.6357%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   9,  Average loss: 0.0004, Accuracy: 548/549 (99.8179%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch  10,  Average loss: 0.0004, Accuracy: 548/549 (99.8179%), train_poison_data_count: 549
Global model norm: 15.567744217907093.
Norm before scaling: 15.63820194221035. Distance: 1.512905394395617
Total norm for 1 adversaries is: 15.63820194221035. distance: 1.512905394395617
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1307, Accuracy: 8632/8991 (96.0071%)
___Train Local_Simple,  epoch  36, local model 77, internal_epoch   1,  Average loss: 0.0044, Accuracy: 472/519 (90.9441%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3064, Accuracy: 9003/10000 (90.0300%), Attack Success Rate:0/10000(0.000)
time spent on training: 47.57998991012573
[foolsgold agg] training data poison_ratio: 0.09316137790599016  data num: [621, 587, 635, 609, 602, 518, 664, 589, 549, 519]
[foolsgold agg] considering poison per batch poison_fraction: 0.09316137790599016
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.3374, Accuracy: 8956/10000 (89.5600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.4053, Accuracy: 7763/8991 (86.3419%)
Done in 87.3377993106842 sec.
Server Epoch:37 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
___Train Local_Simple,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0038, Accuracy: 608/650 (93.5385%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1575, Accuracy: 9549/10000 (95.4900%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 618/668 (92.5150%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0018, Accuracy: 644/668 (96.4072%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   3,  Average loss: 0.0011, Accuracy: 657/668 (98.3533%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   4,  Average loss: 0.0007, Accuracy: 664/668 (99.4012%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   5,  Average loss: 0.0005, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   6,  Average loss: 0.0004, Accuracy: 664/668 (99.4012%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   7,  Average loss: 0.0004, Accuracy: 664/668 (99.4012%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   8,  Average loss: 0.0003, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   9,  Average loss: 0.0003, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch  10,  Average loss: 0.0003, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Global model norm: 15.592169121550699.
Norm before scaling: 15.707742830033. Distance: 1.6889347758598507
Total norm for 1 adversaries is: 15.707742830033. distance: 1.6889347758598507
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1101, Accuracy: 8699/8991 (96.7523%)
___Train Local_Simple,  epoch  37, local model 33, internal_epoch   1,  Average loss: 0.0038, Accuracy: 588/638 (92.1630%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1879, Accuracy: 9430/10000 (94.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 598/652 (91.7178%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2287, Accuracy: 9310/10000 (93.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 484/512 (94.5312%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3536, Accuracy: 8917/10000 (89.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 568/618 (91.9094%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2482, Accuracy: 9194/10000 (91.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 519/560 (92.6786%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2257, Accuracy: 9260/10000 (92.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0064, Accuracy: 459/518 (88.6100%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5402, Accuracy: 7861/10000 (78.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 62, internal_epoch   1,  Average loss: 0.0061, Accuracy: 549/617 (88.9789%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3388, Accuracy: 8979/10000 (89.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0041, Accuracy: 467/516 (90.5039%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3658, Accuracy: 8721/10000 (87.2100%), Attack Success Rate:0/10000(0.000)
time spent on training: 54.42054891586304
[foolsgold agg] training data poison_ratio: 0.11228777945873256  data num: [650, 668, 638, 652, 512, 618, 560, 518, 617, 516]
[foolsgold agg] considering poison per batch poison_fraction: 0.11228777945873256
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.3070, Accuracy: 9090/10000 (90.9000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.4428, Accuracy: 7668/8991 (85.2853%)
Done in 97.92876482009888 sec.
Server Epoch:38 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
___Train Local_Simple,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0037, Accuracy: 461/503 (91.6501%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2527, Accuracy: 9180/10000 (91.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 29, internal_epoch   1,  Average loss: 0.0042, Accuracy: 557/605 (92.0661%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1720, Accuracy: 9504/10000 (95.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0030, Accuracy: 539/575 (93.7391%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3131, Accuracy: 9083/10000 (90.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 564/624 (90.3846%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3249, Accuracy: 8977/10000 (89.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 565/617 (91.5721%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3413, Accuracy: 8785/10000 (87.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 83, internal_epoch   1,  Average loss: 0.0041, Accuracy: 506/555 (91.1712%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2156, Accuracy: 9315/10000 (93.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0040, Accuracy: 506/552 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2383, Accuracy: 9300/10000 (93.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 45, internal_epoch   1,  Average loss: 0.0040, Accuracy: 693/750 (92.4000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2682, Accuracy: 9232/10000 (92.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 52, internal_epoch   1,  Average loss: 0.0040, Accuracy: 577/618 (93.3657%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2316, Accuracy: 9274/10000 (92.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0028, Accuracy: 612/648 (94.4444%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2204, Accuracy: 9297/10000 (92.9700%), Attack Success Rate:0/10000(0.000)
time spent on training: 43.02150201797485
[foolsgold agg] training data poison_ratio: 0.0  data num: [503, 605, 575, 624, 617, 555, 552, 750, 618, 648]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.2778, Accuracy: 9155/10000 (91.5500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.4164, Accuracy: 7727/8991 (85.9415%)
Done in 100.13338804244995 sec.
Server Epoch:39 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
___Train Local_Simple,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 470/505 (93.0693%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1866, Accuracy: 9397/10000 (93.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 34, internal_epoch   1,  Average loss: 0.0045, Accuracy: 482/528 (91.2879%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2925, Accuracy: 9031/10000 (90.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 32, internal_epoch   1,  Average loss: 0.0027, Accuracy: 572/609 (93.9245%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2988, Accuracy: 9060/10000 (90.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 487/512 (95.1172%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2116, Accuracy: 9374/10000 (93.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 579/626 (92.4920%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2192, Accuracy: 9253/10000 (92.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 501/535 (93.6449%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2663, Accuracy: 9098/10000 (90.9800%), Attack Success Rate:0/10000(0.000)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   1,  Average loss: 0.0032, Accuracy: 524/563 (93.0728%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   2,  Average loss: 0.0020, Accuracy: 541/563 (96.0924%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   3,  Average loss: 0.0011, Accuracy: 553/563 (98.2238%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   4,  Average loss: 0.0007, Accuracy: 558/563 (99.1119%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   5,  Average loss: 0.0005, Accuracy: 560/563 (99.4671%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   6,  Average loss: 0.0004, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   7,  Average loss: 0.0004, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   8,  Average loss: 0.0003, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   9,  Average loss: 0.0003, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch  10,  Average loss: 0.0003, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 15.62250663699801.
Norm before scaling: 15.694664037437912. Distance: 1.7786912442205494
Total norm for 1 adversaries is: 15.694664037437912. distance: 1.7786912442205494
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1169, Accuracy: 8665/8991 (96.3742%)
___Train Local_Simple,  epoch  39, local model 88, internal_epoch   1,  Average loss: 0.0033, Accuracy: 632/679 (93.0781%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2169, Accuracy: 9257/10000 (92.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0029, Accuracy: 499/529 (94.3289%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3107, Accuracy: 8966/10000 (89.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 489/521 (93.8580%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2044, Accuracy: 9385/10000 (93.8500%), Attack Success Rate:0/10000(0.000)
time spent on training: 66.44779181480408
[foolsgold agg] training data poison_ratio: 0.10041020153379704  data num: [505, 528, 609, 512, 626, 535, 563, 679, 529, 521]
[foolsgold agg] considering poison per batch poison_fraction: 0.10041020153379704
[foolsgold agg] wv: [1.         0.96302913 1.         1.         1.         0.96302913
 1.         1.         0.95952702 0.95952702]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.2664, Accuracy: 9200/10000 (92.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.4172, Accuracy: 7743/8991 (86.1195%)
Done in 110.76139616966248 sec.
Server Epoch:40 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
___Train Local_Simple,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 552/597 (92.4623%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2186, Accuracy: 9264/10000 (92.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 23, internal_epoch   1,  Average loss: 0.0048, Accuracy: 547/588 (93.0272%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4580, Accuracy: 8469/10000 (84.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 87, internal_epoch   1,  Average loss: 0.0021, Accuracy: 545/575 (94.7826%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1886, Accuracy: 9421/10000 (94.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 98, internal_epoch   1,  Average loss: 0.0016, Accuracy: 549/568 (96.6549%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2485, Accuracy: 9230/10000 (92.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 606/647 (93.6631%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2448, Accuracy: 9245/10000 (92.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 83, internal_epoch   1,  Average loss: 0.0032, Accuracy: 524/555 (94.4144%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2378, Accuracy: 9211/10000 (92.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 569/618 (92.0712%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2082, Accuracy: 9388/10000 (93.8800%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   1,  Average loss: 0.0027, Accuracy: 546/577 (94.6274%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   2,  Average loss: 0.0009, Accuracy: 568/577 (98.4402%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   3,  Average loss: 0.0009, Accuracy: 569/577 (98.6135%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   4,  Average loss: 0.0005, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   5,  Average loss: 0.0004, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   6,  Average loss: 0.0003, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   7,  Average loss: 0.0012, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   8,  Average loss: 0.0018, Accuracy: 562/577 (97.4003%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   9,  Average loss: 0.0025, Accuracy: 554/577 (96.0139%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch  10,  Average loss: 0.0019, Accuracy: 562/577 (97.4003%), train_poison_data_count: 577
Global model norm: 15.643047682465793.
Norm before scaling: 15.71057377360542. Distance: 1.5443646647448273
Total norm for 1 adversaries is: 15.71057377360542. distance: 1.5443646647448273
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.2377, Accuracy: 8400/8991 (93.4268%)
___Train Local_Simple,  epoch  40, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 588/638 (92.1630%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1576, Accuracy: 9526/10000 (95.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0036, Accuracy: 595/644 (92.3913%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2360, Accuracy: 9284/10000 (92.8400%), Attack Success Rate:0/10000(0.000)
time spent on training: 56.7913281917572
[foolsgold agg] training data poison_ratio: 0.09605460296320958  data num: [597, 588, 575, 568, 647, 555, 618, 577, 638, 644]
[foolsgold agg] considering poison per batch poison_fraction: 0.09605460296320958
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.2872, Accuracy: 9096/10000 (90.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.4197, Accuracy: 7729/8991 (85.9637%)
Done in 99.86126804351807 sec.
Server Epoch:41 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
___Train Local_Simple,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0049, Accuracy: 591/647 (91.3447%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2709, Accuracy: 9137/10000 (91.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 28, internal_epoch   1,  Average loss: 0.0047, Accuracy: 604/665 (90.8271%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2002, Accuracy: 9420/10000 (94.2000%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   1,  Average loss: 0.0042, Accuracy: 508/553 (91.8626%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   2,  Average loss: 0.0018, Accuracy: 532/553 (96.2025%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   3,  Average loss: 0.0013, Accuracy: 541/553 (97.8300%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   4,  Average loss: 0.0010, Accuracy: 545/553 (98.5533%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   5,  Average loss: 0.0008, Accuracy: 548/553 (99.0958%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   6,  Average loss: 0.0007, Accuracy: 549/553 (99.2767%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   7,  Average loss: 0.0006, Accuracy: 550/553 (99.4575%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   8,  Average loss: 0.0005, Accuracy: 551/553 (99.6383%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   9,  Average loss: 0.0005, Accuracy: 551/553 (99.6383%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch  10,  Average loss: 0.0005, Accuracy: 551/553 (99.6383%), train_poison_data_count: 553
Global model norm: 15.659820575879852.
Norm before scaling: 15.766033428183315. Distance: 1.8351137951275678
Total norm for 1 adversaries is: 15.766033428183315. distance: 1.8351137951275678
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1032, Accuracy: 8692/8991 (96.6745%)
___Train Local_Simple,  epoch  41, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 484/532 (90.9774%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2575, Accuracy: 9273/10000 (92.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 83, internal_epoch   1,  Average loss: 0.0030, Accuracy: 518/555 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1969, Accuracy: 9353/10000 (93.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0025, Accuracy: 489/516 (94.7674%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2822, Accuracy: 9078/10000 (90.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 565/592 (95.4392%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1749, Accuracy: 9439/10000 (94.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0041, Accuracy: 616/665 (92.6316%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1745, Accuracy: 9462/10000 (94.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 548/605 (90.5785%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1900, Accuracy: 9424/10000 (94.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 46, internal_epoch   1,  Average loss: 0.0026, Accuracy: 459/478 (96.0251%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1741, Accuracy: 9443/10000 (94.4300%), Attack Success Rate:0/10000(0.000)
time spent on training: 50.99490690231323
[foolsgold agg] training data poison_ratio: 0.09521349862258953  data num: [647, 665, 553, 532, 555, 516, 592, 665, 605, 478]
[foolsgold agg] considering poison per batch poison_fraction: 0.09521349862258953
[foolsgold agg] wv: [1.         0.80959858 1.         1.         1.         1.
 1.         0.80959858 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.2641, Accuracy: 9150/10000 (91.5000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.3872, Accuracy: 7785/8991 (86.5866%)
Done in 89.30038404464722 sec.
Server Epoch:42 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0030, Accuracy: 538/575 (93.5652%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2231, Accuracy: 9320/10000 (93.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 567/626 (90.5751%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2307, Accuracy: 9317/10000 (93.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 89, internal_epoch   1,  Average loss: 0.0025, Accuracy: 624/664 (93.9759%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2576, Accuracy: 9262/10000 (92.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 536/589 (91.0017%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2355, Accuracy: 9286/10000 (92.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0026, Accuracy: 560/586 (95.5631%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1564, Accuracy: 9485/10000 (94.8500%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 531/572 (92.8322%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   2,  Average loss: 0.0017, Accuracy: 553/572 (96.6783%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   3,  Average loss: 0.0012, Accuracy: 560/572 (97.9021%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   4,  Average loss: 0.0007, Accuracy: 566/572 (98.9510%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   5,  Average loss: 0.0005, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   6,  Average loss: 0.0004, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   7,  Average loss: 0.0003, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   8,  Average loss: 0.0003, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   9,  Average loss: 0.0003, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch  10,  Average loss: 0.0003, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Global model norm: 15.679016494268353.
Norm before scaling: 15.767506875574497. Distance: 1.7901191755932169
Total norm for 1 adversaries is: 15.767506875574497. distance: 1.7901191755932169
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1204, Accuracy: 8647/8991 (96.1740%)
___Train Local_Simple,  epoch  42, local model 92, internal_epoch   1,  Average loss: 0.0035, Accuracy: 531/571 (92.9947%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2438, Accuracy: 9232/10000 (92.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 62, internal_epoch   1,  Average loss: 0.0037, Accuracy: 576/617 (93.3549%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1787, Accuracy: 9422/10000 (94.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 26, internal_epoch   1,  Average loss: 0.0032, Accuracy: 495/526 (94.1065%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2083, Accuracy: 9364/10000 (93.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 563/605 (93.0579%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1855, Accuracy: 9386/10000 (93.8600%), Attack Success Rate:0/10000(0.000)
time spent on training: 50.71806001663208
[foolsgold agg] training data poison_ratio: 0.09644242117686731  data num: [575, 626, 664, 589, 586, 572, 571, 617, 526, 605]
[foolsgold agg] considering poison per batch poison_fraction: 0.09644242117686731
[foolsgold agg] wv: [0.9738356  0.70505875 1.         1.         1.         1.
 0.70505875 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.2542, Accuracy: 9194/10000 (91.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.3730, Accuracy: 7807/8991 (86.8313%)
Done in 87.73236870765686 sec.
Server Epoch:43 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
___Train Local_Simple,  epoch  43, local model 38, internal_epoch   1,  Average loss: 0.0033, Accuracy: 719/774 (92.8941%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2382, Accuracy: 9203/10000 (92.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 584/624 (93.5897%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2449, Accuracy: 9228/10000 (92.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 26, internal_epoch   1,  Average loss: 0.0027, Accuracy: 495/526 (94.1065%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2308, Accuracy: 9215/10000 (92.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0026, Accuracy: 486/516 (94.1860%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2052, Accuracy: 9334/10000 (93.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0035, Accuracy: 500/529 (94.5180%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1707, Accuracy: 9459/10000 (94.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 75, internal_epoch   1,  Average loss: 0.0036, Accuracy: 510/554 (92.0578%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1883, Accuracy: 9409/10000 (94.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0030, Accuracy: 496/529 (93.7618%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2054, Accuracy: 9337/10000 (93.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 39, internal_epoch   1,  Average loss: 0.0050, Accuracy: 450/503 (89.4632%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2894, Accuracy: 9057/10000 (90.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 484/518 (93.4363%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3036, Accuracy: 9025/10000 (90.2500%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 541/577 (93.7608%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   2,  Average loss: 0.0011, Accuracy: 565/577 (97.9203%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   3,  Average loss: 0.0011, Accuracy: 565/577 (97.9203%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   4,  Average loss: 0.0005, Accuracy: 573/577 (99.3068%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   5,  Average loss: 0.0004, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   6,  Average loss: 0.0003, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   7,  Average loss: 0.0003, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   8,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   9,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch  10,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Global model norm: 15.698046539653678.
Norm before scaling: 15.783892782273474. Distance: 1.7518194141204542
Total norm for 1 adversaries is: 15.783892782273474. distance: 1.7518194141204542
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1332, Accuracy: 8628/8991 (95.9626%)
time spent on training: 48.61918091773987
[foolsgold agg] training data poison_ratio: 0.10212389380530973  data num: [774, 624, 526, 516, 529, 554, 529, 503, 518, 577]
[foolsgold agg] considering poison per batch poison_fraction: 0.10212389380530973
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.2416, Accuracy: 9208/10000 (92.0800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.3268, Accuracy: 7909/8991 (87.9657%)
Done in 85.31366109848022 sec.
Server Epoch:44 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
___Train Local_Simple,  epoch  44, local model 31, internal_epoch   1,  Average loss: 0.0044, Accuracy: 465/511 (90.9980%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2314, Accuracy: 9261/10000 (92.6100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 569/606 (93.8944%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   2,  Average loss: 0.0020, Accuracy: 584/606 (96.3696%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   3,  Average loss: 0.0014, Accuracy: 593/606 (97.8548%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   4,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   5,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   6,  Average loss: 0.0006, Accuracy: 599/606 (98.8449%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   7,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   8,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   9,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch  10,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Global model norm: 15.718103960537283.
Norm before scaling: 15.78844446542139. Distance: 1.7028807718693975
Total norm for 1 adversaries is: 15.78844446542139. distance: 1.7028807718693975
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1162, Accuracy: 8643/8991 (96.1295%)
___Train Local_Simple,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0034, Accuracy: 716/774 (92.5065%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2316, Accuracy: 9298/10000 (92.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0030, Accuracy: 515/548 (93.9781%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1798, Accuracy: 9435/10000 (94.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0027, Accuracy: 667/708 (94.2090%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1476, Accuracy: 9514/10000 (95.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0036, Accuracy: 509/552 (92.2101%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1510, Accuracy: 9558/10000 (95.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 65, internal_epoch   1,  Average loss: 0.0033, Accuracy: 544/573 (94.9389%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1649, Accuracy: 9463/10000 (94.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 66, internal_epoch   1,  Average loss: 0.0029, Accuracy: 592/629 (94.1176%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2202, Accuracy: 9275/10000 (92.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0036, Accuracy: 581/626 (92.8115%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1671, Accuracy: 9510/10000 (95.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0035, Accuracy: 539/572 (94.2308%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1384, Accuracy: 9596/10000 (95.9600%), Attack Success Rate:0/10000(0.000)
time spent on training: 49.309081077575684
[foolsgold agg] training data poison_ratio: 0.09936055090998525  data num: [511, 606, 774, 548, 708, 552, 573, 629, 626, 572]
[foolsgold agg] considering poison per batch poison_fraction: 0.09936055090998525
[foolsgold agg] wv: [1.        1.        1.        1.        1.        0.7873719 1.
 0.7873719 1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.2245, Accuracy: 9243/10000 (92.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.3066, Accuracy: 7959/8991 (88.5219%)
Done in 86.31098484992981 sec.
Server Epoch:45 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0032, Accuracy: 587/617 (95.1378%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1638, Accuracy: 9555/10000 (95.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 75, internal_epoch   1,  Average loss: 0.0043, Accuracy: 507/554 (91.5162%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1907, Accuracy: 9398/10000 (93.9800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 574/606 (94.7195%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0015, Accuracy: 591/606 (97.5248%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   3,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   4,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   5,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   6,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   7,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   8,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   9,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch  10,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Global model norm: 15.734002117447295.
Norm before scaling: 15.791650347671867. Distance: 1.668788806592647
Total norm for 2 adversaries is: 15.791650347671867. distance: 1.668788806592647
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1096, Accuracy: 8673/8991 (96.4631%)
___Train Local_Simple,  epoch  45, local model 37, internal_epoch   1,  Average loss: 0.0027, Accuracy: 603/641 (94.0718%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2398, Accuracy: 9209/10000 (92.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 94, internal_epoch   1,  Average loss: 0.0024, Accuracy: 527/555 (94.9550%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2276, Accuracy: 9229/10000 (92.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0032, Accuracy: 609/647 (94.1267%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2264, Accuracy: 9243/10000 (92.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 29, internal_epoch   1,  Average loss: 0.0034, Accuracy: 565/605 (93.3884%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1481, Accuracy: 9536/10000 (95.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0029, Accuracy: 469/503 (93.2406%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1649, Accuracy: 9476/10000 (94.7600%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   1,  Average loss: 0.0026, Accuracy: 615/644 (95.4969%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   2,  Average loss: 0.0027, Accuracy: 618/644 (95.9627%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   3,  Average loss: 0.0013, Accuracy: 633/644 (98.2919%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   4,  Average loss: 0.0008, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   5,  Average loss: 0.0006, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   6,  Average loss: 0.0007, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   7,  Average loss: 0.0004, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   8,  Average loss: 0.0004, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   9,  Average loss: 0.0004, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch  10,  Average loss: 0.0004, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Global model norm: 15.734002117447295.
Norm before scaling: 15.842406928866733. Distance: 1.8455288597874457
Total norm for 2 adversaries is: 15.842406928866733. distance: 1.8455288597874457
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1293, Accuracy: 8627/8991 (95.9515%)
___Train Local_Simple,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 488/512 (95.3125%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2524, Accuracy: 9208/10000 (92.0800%), Attack Success Rate:0/10000(0.000)
time spent on training: 59.85490822792053
[foolsgold agg] training data poison_ratio: 0.2124405166553365  data num: [617, 554, 606, 641, 555, 647, 605, 503, 644, 512]
[foolsgold agg] considering poison per batch poison_fraction: 0.2124405166553365
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.2369, Accuracy: 9189/10000 (91.8900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.2896, Accuracy: 8015/8991 (89.1447%)
Done in 100.68377590179443 sec.
Server Epoch:46 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
___Train Local_Simple,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0028, Accuracy: 523/554 (94.4043%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2595, Accuracy: 9190/10000 (91.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 78, internal_epoch   1,  Average loss: 0.0031, Accuracy: 585/624 (93.7500%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2186, Accuracy: 9295/10000 (92.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 507/535 (94.7664%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2118, Accuracy: 9339/10000 (93.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 39, internal_epoch   1,  Average loss: 0.0030, Accuracy: 466/503 (92.6441%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1514, Accuracy: 9493/10000 (94.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 500/550 (90.9091%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2277, Accuracy: 9279/10000 (92.7900%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 543/572 (94.9301%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   2,  Average loss: 0.0011, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   3,  Average loss: 0.0008, Accuracy: 563/572 (98.4266%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   4,  Average loss: 0.0005, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   5,  Average loss: 0.0003, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   6,  Average loss: 0.0003, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   7,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   8,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   9,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch  10,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Global model norm: 15.764872961188805.
Norm before scaling: 15.818879178897678. Distance: 1.592310461026311
Total norm for 2 adversaries is: 15.818879178897678. distance: 1.592310461026311
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1141, Accuracy: 8684/8991 (96.5855%)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   1,  Average loss: 0.0024, Accuracy: 533/563 (94.6714%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   2,  Average loss: 0.0012, Accuracy: 546/563 (96.9805%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   3,  Average loss: 0.0005, Accuracy: 559/563 (99.2895%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   4,  Average loss: 0.0004, Accuracy: 562/563 (99.8224%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   5,  Average loss: 0.0003, Accuracy: 562/563 (99.8224%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   6,  Average loss: 0.0003, Accuracy: 562/563 (99.8224%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   7,  Average loss: 0.0002, Accuracy: 562/563 (99.8224%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   8,  Average loss: 0.0002, Accuracy: 562/563 (99.8224%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   9,  Average loss: 0.0002, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch  10,  Average loss: 0.0002, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 15.764872961188805.
Norm before scaling: 15.814349763656603. Distance: 1.5013771093523787
Total norm for 2 adversaries is: 15.814349763656603. distance: 1.5013771093523787
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1077, Accuracy: 8680/8991 (96.5410%)
___Train Local_Simple,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0025, Accuracy: 550/580 (94.8276%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1719, Accuracy: 9468/10000 (94.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 604/632 (95.5696%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1740, Accuracy: 9427/10000 (94.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 54, internal_epoch   1,  Average loss: 0.0037, Accuracy: 481/523 (91.9694%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1772, Accuracy: 9404/10000 (94.0400%), Attack Success Rate:0/10000(0.000)
time spent on training: 68.75414562225342
[foolsgold agg] training data poison_ratio: 0.20138396025550034  data num: [554, 624, 535, 503, 550, 572, 563, 580, 632, 523]
[foolsgold agg] considering poison per batch poison_fraction: 0.20138396025550034
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.78114194
 0.78114194 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.2571, Accuracy: 9091/10000 (90.9100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.2516, Accuracy: 8135/8991 (90.4794%)
Done in 107.72295618057251 sec.
Server Epoch:47 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  47, local model 94, internal_epoch   1,  Average loss: 0.0031, Accuracy: 519/555 (93.5135%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1764, Accuracy: 9439/10000 (94.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 48, internal_epoch   1,  Average loss: 0.0044, Accuracy: 537/589 (91.1715%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2186, Accuracy: 9370/10000 (93.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 571/621 (91.9485%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2405, Accuracy: 9194/10000 (91.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 536/582 (92.0962%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3298, Accuracy: 8847/10000 (88.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0027, Accuracy: 508/526 (96.5779%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2379, Accuracy: 9266/10000 (92.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0039, Accuracy: 548/581 (94.3201%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2072, Accuracy: 9361/10000 (93.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0035, Accuracy: 511/550 (92.9091%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2158, Accuracy: 9311/10000 (93.1100%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0018, Accuracy: 553/577 (95.8406%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   2,  Average loss: 0.0010, Accuracy: 566/577 (98.0936%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   3,  Average loss: 0.0004, Accuracy: 572/577 (99.1334%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   4,  Average loss: 0.0003, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   5,  Average loss: 0.0005, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   6,  Average loss: 0.0002, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   7,  Average loss: 0.0002, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   8,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   9,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch  10,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Global model norm: 15.784746383258398.
Norm before scaling: 15.82040846807312. Distance: 1.2510495547962552
Total norm for 1 adversaries is: 15.82040846807312. distance: 1.2510495547962552
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1177, Accuracy: 8663/8991 (96.3519%)
___Train Local_Simple,  epoch  47, local model 68, internal_epoch   1,  Average loss: 0.0021, Accuracy: 605/632 (95.7278%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1292, Accuracy: 9600/10000 (96.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0048, Accuracy: 476/518 (91.8919%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3346, Accuracy: 8866/10000 (88.6600%), Attack Success Rate:0/10000(0.000)
time spent on training: 49.06220602989197
[foolsgold agg] training data poison_ratio: 0.10068050950968417  data num: [555, 589, 621, 582, 526, 581, 550, 577, 632, 518]
[foolsgold agg] considering poison per batch poison_fraction: 0.10068050950968417
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.2311, Accuracy: 9221/10000 (92.2100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.2902, Accuracy: 8014/8991 (89.1336%)
Done in 85.8156750202179 sec.
Server Epoch:48 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
___Train Local_Simple,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 589/626 (94.0895%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2588, Accuracy: 9195/10000 (91.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 27, internal_epoch   1,  Average loss: 0.0027, Accuracy: 612/650 (94.1538%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2477, Accuracy: 9172/10000 (91.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 75, internal_epoch   1,  Average loss: 0.0036, Accuracy: 512/554 (92.4188%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2183, Accuracy: 9309/10000 (93.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0029, Accuracy: 516/552 (93.4783%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1582, Accuracy: 9493/10000 (94.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 483/510 (94.7059%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1484, Accuracy: 9527/10000 (95.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0025, Accuracy: 529/555 (95.3153%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1166, Accuracy: 9619/10000 (96.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0030, Accuracy: 592/627 (94.4179%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1761, Accuracy: 9415/10000 (94.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 96, internal_epoch   1,  Average loss: 0.0022, Accuracy: 584/608 (96.0526%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2495, Accuracy: 9197/10000 (91.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0023, Accuracy: 618/648 (95.3704%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2581, Accuracy: 9172/10000 (91.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 57, internal_epoch   1,  Average loss: 0.0029, Accuracy: 536/568 (94.3662%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1758, Accuracy: 9411/10000 (94.1100%), Attack Success Rate:0/10000(0.000)
time spent on training: 39.11744523048401
[foolsgold agg] training data poison_ratio: 0.0  data num: [626, 650, 554, 552, 510, 555, 627, 608, 648, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.2047, Accuracy: 9328/10000 (93.2800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.3169, Accuracy: 7942/8991 (88.3328%)
Done in 76.19466805458069 sec.
Server Epoch:49 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
___Train Local_Simple,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0033, Accuracy: 493/519 (94.9904%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2277, Accuracy: 9253/10000 (92.5300%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 538/572 (94.0559%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   2,  Average loss: 0.0011, Accuracy: 562/572 (98.2517%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   3,  Average loss: 0.0005, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   4,  Average loss: 0.0004, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   5,  Average loss: 0.0003, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   6,  Average loss: 0.0002, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   7,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   8,  Average loss: 0.0002, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   9,  Average loss: 0.0002, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch  10,  Average loss: 0.0002, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 15.809296415382123.
Norm before scaling: 15.862927750155096. Distance: 1.6301003888582253
Total norm for 1 adversaries is: 15.862927750155096. distance: 1.6301003888582253
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.1026, Accuracy: 8699/8991 (96.7523%)
___Train Local_Simple,  epoch  49, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 582/624 (93.2692%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1702, Accuracy: 9444/10000 (94.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0029, Accuracy: 501/529 (94.7070%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2434, Accuracy: 9188/10000 (91.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 91, internal_epoch   1,  Average loss: 0.0025, Accuracy: 601/627 (95.8533%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1654, Accuracy: 9443/10000 (94.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 498/521 (95.5854%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4436, Accuracy: 8620/10000 (86.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0012, Accuracy: 551/568 (97.0070%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1920, Accuracy: 9395/10000 (93.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 21, internal_epoch   1,  Average loss: 0.0031, Accuracy: 592/625 (94.7200%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2036, Accuracy: 9342/10000 (93.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 82, internal_epoch   1,  Average loss: 0.0025, Accuracy: 593/621 (95.4911%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1422, Accuracy: 9542/10000 (95.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0029, Accuracy: 588/626 (93.9297%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1773, Accuracy: 9426/10000 (94.2600%), Attack Success Rate:0/10000(0.000)
time spent on training: 49.1470890045166
[foolsgold agg] training data poison_ratio: 0.09807956104252401  data num: [519, 572, 624, 529, 627, 521, 568, 625, 621, 626]
[foolsgold agg] considering poison per batch poison_fraction: 0.09807956104252401
[foolsgold agg] wv: [1.         1.         0.87357861 1.         1.         0.99878512
 0.87357861 1.         0.99878512 1.        ]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.2160, Accuracy: 9241/10000 (92.4100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.2591, Accuracy: 8091/8991 (89.9900%)
Done in 85.99123191833496 sec.
Server Epoch:50 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
___Train Local_Simple,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 520/554 (93.8628%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3207, Accuracy: 9007/10000 (90.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 86, internal_epoch   1,  Average loss: 0.0029, Accuracy: 550/587 (93.6968%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1422, Accuracy: 9569/10000 (95.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0030, Accuracy: 604/647 (93.3539%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2227, Accuracy: 9258/10000 (92.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0033, Accuracy: 571/609 (93.7603%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1604, Accuracy: 9510/10000 (95.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 31, internal_epoch   1,  Average loss: 0.0034, Accuracy: 474/511 (92.7593%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2287, Accuracy: 9332/10000 (93.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 32, internal_epoch   1,  Average loss: 0.0022, Accuracy: 590/609 (96.8801%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1403, Accuracy: 9543/10000 (95.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 67, internal_epoch   1,  Average loss: 0.0040, Accuracy: 595/643 (92.5350%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6998, Accuracy: 8160/10000 (81.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0021, Accuracy: 622/648 (95.9877%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2196, Accuracy: 9312/10000 (93.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 567/605 (93.7190%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1508, Accuracy: 9545/10000 (95.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0031, Accuracy: 515/550 (93.6364%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1840, Accuracy: 9350/10000 (93.5000%), Attack Success Rate:0/10000(0.000)
time spent on training: 39.14374923706055
[foolsgold agg] training data poison_ratio: 0.0  data num: [554, 587, 647, 609, 511, 609, 643, 648, 605, 550]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.2043, Accuracy: 9305/10000 (93.0500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.3066, Accuracy: 7953/8991 (88.4551%)
Done in 76.06901001930237 sec.
Saving all the graphs.
This run has a label: Mar.02_20.31.18. Visdom environment: mnist_DBA
