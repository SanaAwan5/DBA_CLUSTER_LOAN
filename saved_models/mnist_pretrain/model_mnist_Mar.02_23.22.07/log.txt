current path: saved_models/mnist_pretrain/model_mnist_Mar.02_23.22.07
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 10, 20, 30, 40, 50, 60, 70, 80, 90]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
___Train Local_Simple,  epoch   1, local model 23, internal_epoch   1,  Average loss: 0.0382, Accuracy: 100/595 (16.8067%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1233, Accuracy: 2207/10000 (22.0700%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   1, local model 72, internal_epoch   1,  Average loss: 0.0382, Accuracy: 87/596 (14.5973%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1278, Accuracy: 4055/10000 (40.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 61, internal_epoch   1,  Average loss: 0.0384, Accuracy: 76/589 (12.9032%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1331, Accuracy: 3347/10000 (33.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0386, Accuracy: 105/589 (17.8268%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1399, Accuracy: 1974/10000 (19.7400%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   1, local model 71, internal_epoch   1,  Average loss: 0.0372, Accuracy: 100/608 (16.4474%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.0879, Accuracy: 3414/10000 (34.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 42, internal_epoch   1,  Average loss: 0.0372, Accuracy: 123/609 (20.1970%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.0930, Accuracy: 5649/10000 (56.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 45, internal_epoch   1,  Average loss: 0.0384, Accuracy: 88/587 (14.9915%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1068, Accuracy: 2342/10000 (23.4200%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch   1, local model 37, internal_epoch   1,  Average loss: 0.0381, Accuracy: 118/594 (19.8653%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1187, Accuracy: 2116/10000 (21.1600%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   1, local model 21, internal_epoch   1,  Average loss: 0.0383, Accuracy: 103/592 (17.3986%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1415, Accuracy: 1914/10000 (19.1400%), Attack Success Rate:20/10000(0.200)
___Train Local_Simple,  epoch   1, local model 35, internal_epoch   1,  Average loss: 0.0385, Accuracy: 82/589 (13.9219%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1234, Accuracy: 3071/10000 (30.7100%), Attack Success Rate:0/10000(0.000)
time spent on training: 45.91742515563965
[foolsgold agg] training data poison_ratio: 0.0  data num: [595, 596, 589, 589, 608, 609, 587, 594, 592, 589]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.77380254 1.         0.31721045 0.31721045 0.25198949 0.25198949
 0.53253253 1.         0.44810046 1.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2831, Accuracy: 1123/10000 (11.2300%), Attack Success Rate:23/10000(0.230)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2845, Accuracy: 1096/8991 (12.1900%)
Done in 91.69892716407776 sec.
Server Epoch:2 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0377, Accuracy: 174/589 (29.5416%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8509, Accuracy: 4353/10000 (43.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 59, internal_epoch   1,  Average loss: 0.0368, Accuracy: 121/598 (20.2341%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.7684, Accuracy: 5067/10000 (50.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 62, internal_epoch   1,  Average loss: 0.0374, Accuracy: 118/589 (20.0340%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9007, Accuracy: 3420/10000 (34.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 28, internal_epoch   1,  Average loss: 0.0380, Accuracy: 170/584 (29.1096%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9860, Accuracy: 2359/10000 (23.5900%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch   2, local model 65, internal_epoch   1,  Average loss: 0.0376, Accuracy: 117/586 (19.9659%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8481, Accuracy: 3160/10000 (31.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 22, internal_epoch   1,  Average loss: 0.0373, Accuracy: 120/591 (20.3046%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8518, Accuracy: 3762/10000 (37.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 78, internal_epoch   1,  Average loss: 0.0366, Accuracy: 128/600 (21.3333%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.7326, Accuracy: 5309/10000 (53.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 58, internal_epoch   1,  Average loss: 0.0373, Accuracy: 126/586 (21.5017%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.1818, Accuracy: 2629/10000 (26.2900%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch   2, local model 41, internal_epoch   1,  Average loss: 0.0357, Accuracy: 149/607 (24.5470%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.7639, Accuracy: 3861/10000 (38.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 81, internal_epoch   1,  Average loss: 0.0369, Accuracy: 163/591 (27.5804%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.3267, Accuracy: 1883/10000 (18.8300%), Attack Success Rate:17/10000(0.170)
time spent on training: 42.1473650932312
[foolsgold agg] training data poison_ratio: 0.0  data num: [589, 598, 589, 584, 586, 591, 600, 586, 607, 591]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.21680603 0.85438089 1.         1.         0.18819178 0.03520711
 0.03520711 1.         0.18819178 1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2456, Accuracy: 3372/10000 (33.7200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2481, Accuracy: 3194/8991 (35.5244%)
Done in 81.74901914596558 sec.
Server Epoch:3 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
___Train Local_Simple,  epoch   3, local model 54, internal_epoch   1,  Average loss: 0.0364, Accuracy: 181/577 (31.3692%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 9.7700, Accuracy: 980/10000 (9.8000%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch   3, local model 55, internal_epoch   1,  Average loss: 0.0342, Accuracy: 232/592 (39.1892%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.9982, Accuracy: 4183/10000 (41.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 61, internal_epoch   1,  Average loss: 0.0349, Accuracy: 210/589 (35.6537%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.0897, Accuracy: 3529/10000 (35.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 73, internal_epoch   1,  Average loss: 0.0337, Accuracy: 195/600 (32.5000%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.0181, Accuracy: 3736/10000 (37.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 18, internal_epoch   1,  Average loss: 0.0349, Accuracy: 196/583 (33.6192%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.8801, Accuracy: 1543/10000 (15.4300%), Attack Success Rate:26/10000(0.260)
___Train Local_Simple,  epoch   3, local model 42, internal_epoch   1,  Average loss: 0.0334, Accuracy: 233/609 (38.2594%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.7383, Accuracy: 2064/10000 (20.6400%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch   3, local model 87, internal_epoch   1,  Average loss: 0.0360, Accuracy: 205/591 (34.6870%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.9761, Accuracy: 2432/10000 (24.3200%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch   3, local model 41, internal_epoch   1,  Average loss: 0.0327, Accuracy: 170/607 (28.0066%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.9428, Accuracy: 3423/10000 (34.2300%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   1,  Average loss: 0.0357, Accuracy: 157/582 (26.9759%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   2,  Average loss: 0.0217, Accuracy: 321/582 (55.1546%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   3,  Average loss: 0.0108, Accuracy: 469/582 (80.5842%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   4,  Average loss: 0.0086, Accuracy: 483/582 (82.9897%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   5,  Average loss: 0.0071, Accuracy: 492/582 (84.5361%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   6,  Average loss: 0.0066, Accuracy: 517/582 (88.8316%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   7,  Average loss: 0.0052, Accuracy: 523/582 (89.8625%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   8,  Average loss: 0.0050, Accuracy: 520/582 (89.3471%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   9,  Average loss: 0.0042, Accuracy: 539/582 (92.6117%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch  10,  Average loss: 0.0039, Accuracy: 542/582 (93.1271%), train_poison_data_count: 582
Global model norm: 13.913134158917014.
Norm before scaling: 14.51921281934922. Distance: 3.4870785202143266
Total norm for 1 adversaries is: 14.51921281934922. distance: 3.4870785202143266
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.3243, Accuracy: 8087/8991 (89.9455%)
___Train Local_Simple,  epoch   3, local model 28, internal_epoch   1,  Average loss: 0.0334, Accuracy: 190/584 (32.5342%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 3.4837, Accuracy: 2517/10000 (25.1700%), Attack Success Rate:4/10000(0.040)
time spent on training: 52.38709115982056
[foolsgold agg] training data poison_ratio: 0.09841055123435914  data num: [577, 592, 589, 600, 583, 609, 591, 607, 582, 584]
[foolsgold agg] considering poison per batch poison_fraction: 0.09841055123435914
[foolsgold agg] wv: [0.77830142 0.71743101 1.         0.65566882 1.         1.
 1.         0.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.1625, Accuracy: 5200/10000 (52.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.1532, Accuracy: 5022/8991 (55.8559%)
Done in 91.19443988800049 sec.
Server Epoch:4 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
___Train Local_Simple,  epoch   4, local model 37, internal_epoch   1,  Average loss: 0.0367, Accuracy: 267/594 (44.9495%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.1255, Accuracy: 4771/10000 (47.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 92, internal_epoch   1,  Average loss: 0.0387, Accuracy: 276/535 (51.5888%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.1760, Accuracy: 2269/10000 (22.6900%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   4, local model 95, internal_epoch   1,  Average loss: 0.0420, Accuracy: 249/540 (46.1111%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.2955, Accuracy: 2781/10000 (27.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 76, internal_epoch   1,  Average loss: 0.0341, Accuracy: 275/593 (46.3744%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.8128, Accuracy: 5730/10000 (57.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0345, Accuracy: 322/602 (53.4884%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.9939, Accuracy: 4980/10000 (49.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 99, internal_epoch   1,  Average loss: 0.0376, Accuracy: 173/407 (42.5061%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.2176, Accuracy: 2417/10000 (24.1700%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   4, local model 94, internal_epoch   1,  Average loss: 0.0384, Accuracy: 263/536 (49.0672%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.1673, Accuracy: 3989/10000 (39.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 74, internal_epoch   1,  Average loss: 0.0316, Accuracy: 295/592 (49.8311%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.3341, Accuracy: 6195/10000 (61.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 45, internal_epoch   1,  Average loss: 0.0379, Accuracy: 247/587 (42.0784%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.2263, Accuracy: 4128/10000 (41.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 44, internal_epoch   1,  Average loss: 0.0363, Accuracy: 269/598 (44.9833%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.0508, Accuracy: 3948/10000 (39.4800%), Attack Success Rate:0/10000(0.000)
time spent on training: 43.94467115402222
[foolsgold agg] training data poison_ratio: 0.0  data num: [594, 535, 540, 593, 602, 407, 536, 592, 587, 598]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.69957061 1.         1.         0.69957061 1.         0.51908172
 1.         0.93633144 0.51908172 0.52733776]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 2.2713, Accuracy: 3091/10000 (30.9100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 2.2706, Accuracy: 3045/8991 (33.8672%)
Done in 92.08546614646912 sec.
Server Epoch:5 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   1,  Average loss: 0.0367, Accuracy: 216/595 (36.3025%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   2,  Average loss: 0.0196, Accuracy: 357/595 (60.0000%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   3,  Average loss: 0.0133, Accuracy: 468/595 (78.6555%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   4,  Average loss: 0.0084, Accuracy: 496/595 (83.3613%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   5,  Average loss: 0.0067, Accuracy: 525/595 (88.2353%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   6,  Average loss: 0.0052, Accuracy: 538/595 (90.4202%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   7,  Average loss: 0.0045, Accuracy: 550/595 (92.4370%), train_poison_data_count: 595
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   8,  Average loss: 0.0039, Accuracy: 558/595 (93.7815%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   9,  Average loss: 0.0033, Accuracy: 564/595 (94.7899%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch  10,  Average loss: 0.0034, Accuracy: 566/595 (95.1261%), train_poison_data_count: 595
Global model norm: 13.99900105863445.
Norm before scaling: 14.565003535973814. Distance: 3.1659656217133967
Total norm for 1 adversaries is: 14.565003535973814. distance: 3.1659656217133967
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2972, Accuracy: 8210/8991 (91.3135%)
___Train Local_Simple,  epoch   5, local model 49, internal_epoch   1,  Average loss: 0.0343, Accuracy: 231/609 (37.9310%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.3475, Accuracy: 5911/10000 (59.1100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   5, local model 65, internal_epoch   1,  Average loss: 0.0357, Accuracy: 206/586 (35.1536%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.4058, Accuracy: 5442/10000 (54.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0347, Accuracy: 222/593 (37.4368%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.5175, Accuracy: 4338/10000 (43.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 36, internal_epoch   1,  Average loss: 0.0351, Accuracy: 219/596 (36.7450%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.4980, Accuracy: 3885/10000 (38.8500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   5, local model 24, internal_epoch   1,  Average loss: 0.0348, Accuracy: 215/596 (36.0738%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.3035, Accuracy: 5167/10000 (51.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0357, Accuracy: 209/586 (35.6655%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.5608, Accuracy: 4015/10000 (40.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0344, Accuracy: 235/602 (39.0365%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.5852, Accuracy: 4366/10000 (43.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 76, internal_epoch   1,  Average loss: 0.0347, Accuracy: 214/593 (36.0877%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.4664, Accuracy: 5067/10000 (50.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 39, internal_epoch   1,  Average loss: 0.0354, Accuracy: 208/583 (35.6775%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.4688, Accuracy: 4354/10000 (43.5400%), Attack Success Rate:0/10000(0.000)
time spent on training: 55.777310848236084
[foolsgold agg] training data poison_ratio: 0.10018521636639165  data num: [595, 609, 586, 593, 596, 596, 586, 602, 593, 583]
[foolsgold agg] considering poison per batch poison_fraction: 0.10018521636639165
[foolsgold agg] wv: [1.         0.39413712 0.         0.         0.         0.
 0.         0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.2269, Accuracy: 3934/10000 (39.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 2.2221, Accuracy: 3902/8991 (43.3990%)
Done in 92.03394818305969 sec.
Server Epoch:6 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
___Train Local_Simple,  epoch   6, local model 26, internal_epoch   1,  Average loss: 0.0329, Accuracy: 264/584 (45.2055%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 5.6210, Accuracy: 3015/10000 (30.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 29, internal_epoch   1,  Average loss: 0.0325, Accuracy: 282/586 (48.1229%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 5.5783, Accuracy: 2770/10000 (27.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0289, Accuracy: 289/602 (48.0066%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 3.0106, Accuracy: 3650/10000 (36.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 41, internal_epoch   1,  Average loss: 0.0277, Accuracy: 306/607 (50.4119%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 4.5135, Accuracy: 3841/10000 (38.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 99, internal_epoch   1,  Average loss: 0.0301, Accuracy: 237/407 (58.2310%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 4.0781, Accuracy: 3961/10000 (39.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 67, internal_epoch   1,  Average loss: 0.0290, Accuracy: 295/584 (50.5137%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 4.5005, Accuracy: 2838/10000 (28.3800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   6, local model 91, internal_epoch   1,  Average loss: 0.0304, Accuracy: 301/584 (51.5411%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 9.9364, Accuracy: 3199/10000 (31.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 76, internal_epoch   1,  Average loss: 0.0326, Accuracy: 244/593 (41.1467%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.7738, Accuracy: 4181/10000 (41.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0331, Accuracy: 262/593 (44.1821%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.5456, Accuracy: 3888/10000 (38.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 25, internal_epoch   1,  Average loss: 0.0306, Accuracy: 286/589 (48.5569%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.9173, Accuracy: 5783/10000 (57.8300%), Attack Success Rate:0/10000(0.000)
time spent on training: 39.70389914512634
[foolsgold agg] training data poison_ratio: 0.0  data num: [584, 586, 602, 607, 407, 584, 584, 593, 593, 589]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.9355872  1.         0.95753249 0.95753249 1.         0.5092941
 0.9355872  0.5092941  0.91636234 1.        ]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 2.1216, Accuracy: 4856/10000 (48.5600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 2.1242, Accuracy: 4510/8991 (50.1613%)
Done in 76.9636070728302 sec.
Server Epoch:7 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
___Train Local_Simple,  epoch   7, local model 66, internal_epoch   1,  Average loss: 0.0316, Accuracy: 332/602 (55.1495%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.7835, Accuracy: 3896/10000 (38.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 68, internal_epoch   1,  Average loss: 0.0361, Accuracy: 302/591 (51.0998%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.0473, Accuracy: 5152/10000 (51.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 59, internal_epoch   1,  Average loss: 0.0350, Accuracy: 329/598 (55.0167%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.9692, Accuracy: 3959/10000 (39.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 62, internal_epoch   1,  Average loss: 0.0352, Accuracy: 324/589 (55.0085%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.8482, Accuracy: 5276/10000 (52.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 31, internal_epoch   1,  Average loss: 0.0345, Accuracy: 323/599 (53.9232%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.8298, Accuracy: 5434/10000 (54.3400%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0262, Accuracy: 359/606 (59.2409%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   2,  Average loss: 0.0134, Accuracy: 476/606 (78.5479%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   3,  Average loss: 0.0103, Accuracy: 493/606 (81.3531%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   4,  Average loss: 0.0068, Accuracy: 535/606 (88.2838%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   5,  Average loss: 0.0048, Accuracy: 554/606 (91.4191%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   6,  Average loss: 0.0040, Accuracy: 564/606 (93.0693%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   7,  Average loss: 0.0037, Accuracy: 568/606 (93.7294%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   8,  Average loss: 0.0031, Accuracy: 571/606 (94.2244%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   9,  Average loss: 0.0028, Accuracy: 575/606 (94.8845%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch  10,  Average loss: 0.0029, Accuracy: 575/606 (94.8845%), train_poison_data_count: 606
Global model norm: 14.090255811655465.
Norm before scaling: 14.887519760823368. Distance: 3.4826749066795246
Total norm for 1 adversaries is: 14.887519760823368. distance: 3.4826749066795246
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.2427, Accuracy: 8319/8991 (92.5259%)
___Train Local_Simple,  epoch   7, local model 23, internal_epoch   1,  Average loss: 0.0335, Accuracy: 329/595 (55.2941%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.9451, Accuracy: 2727/10000 (27.2700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0338, Accuracy: 297/586 (50.6826%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.9501, Accuracy: 5222/10000 (52.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 99, internal_epoch   1,  Average loss: 0.0288, Accuracy: 303/407 (74.4472%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 8.6936, Accuracy: 3139/10000 (31.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 45, internal_epoch   1,  Average loss: 0.0305, Accuracy: 335/587 (57.0698%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.3773, Accuracy: 6752/10000 (67.5200%), Attack Success Rate:0/10000(0.000)
time spent on training: 53.806901931762695
[foolsgold agg] training data poison_ratio: 0.10520833333333333  data num: [602, 591, 598, 589, 599, 606, 595, 586, 407, 587]
[foolsgold agg] considering poison per batch poison_fraction: 0.10520833333333333
[foolsgold agg] wv: [1.         1.         0.         1.         1.         1.
 0.91099945 0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 2.2097, Accuracy: 4460/10000 (44.6000%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 2.2114, Accuracy: 4376/8991 (48.6709%)
Done in 90.66083478927612 sec.
Server Epoch:8 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
___Train Local_Simple,  epoch   8, local model 63, internal_epoch   1,  Average loss: 0.0280, Accuracy: 379/594 (63.8047%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.6674, Accuracy: 5345/10000 (53.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 55, internal_epoch   1,  Average loss: 0.0275, Accuracy: 356/592 (60.1351%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.4551, Accuracy: 5907/10000 (59.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 79, internal_epoch   1,  Average loss: 0.0274, Accuracy: 356/584 (60.9589%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.8382, Accuracy: 5507/10000 (55.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0274, Accuracy: 340/590 (57.6271%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6625, Accuracy: 7786/10000 (77.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 62, internal_epoch   1,  Average loss: 0.0285, Accuracy: 357/589 (60.6112%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 4.3095, Accuracy: 3280/10000 (32.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 56, internal_epoch   1,  Average loss: 0.0271, Accuracy: 357/590 (60.5085%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.0736, Accuracy: 7383/10000 (73.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 96, internal_epoch   1,  Average loss: 0.0278, Accuracy: 306/534 (57.3034%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.7750, Accuracy: 6445/10000 (64.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0279, Accuracy: 333/581 (57.3150%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 4.7554, Accuracy: 3243/10000 (32.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 92, internal_epoch   1,  Average loss: 0.0292, Accuracy: 309/535 (57.7570%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.1051, Accuracy: 7132/10000 (71.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 86, internal_epoch   1,  Average loss: 0.0275, Accuracy: 347/597 (58.1240%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.3354, Accuracy: 6212/10000 (62.1200%), Attack Success Rate:0/10000(0.000)
time spent on training: 43.40481901168823
[foolsgold agg] training data poison_ratio: 0.0  data num: [594, 592, 584, 590, 589, 590, 534, 581, 535, 597]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         0.02401013 0.02030722 0.         1.         0.
 0.         0.20782026 1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 2.1427, Accuracy: 5286/10000 (52.8600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 2.1460, Accuracy: 5073/8991 (56.4231%)
Done in 80.91178584098816 sec.
Server Epoch:9 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
___Train Local_Simple,  epoch   9, local model 28, internal_epoch   1,  Average loss: 0.0244, Accuracy: 374/584 (64.0411%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 9.5902, Accuracy: 3795/10000 (37.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 63, internal_epoch   1,  Average loss: 0.0314, Accuracy: 381/594 (64.1414%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.3490, Accuracy: 5463/10000 (54.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 33, internal_epoch   1,  Average loss: 0.0274, Accuracy: 382/598 (63.8796%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.8689, Accuracy: 5533/10000 (55.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 71, internal_epoch   1,  Average loss: 0.0256, Accuracy: 405/608 (66.6118%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.6331, Accuracy: 5895/10000 (58.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0240, Accuracy: 395/602 (65.6146%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.0442, Accuracy: 6140/10000 (61.4000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   9, local model 32, internal_epoch   1,  Average loss: 0.0259, Accuracy: 365/601 (60.7321%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.5605, Accuracy: 4649/10000 (46.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 76, internal_epoch   1,  Average loss: 0.0245, Accuracy: 399/593 (67.2850%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.0643, Accuracy: 6304/10000 (63.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 97, internal_epoch   1,  Average loss: 0.0242, Accuracy: 352/536 (65.6716%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.9729, Accuracy: 3958/10000 (39.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 23, internal_epoch   1,  Average loss: 0.0244, Accuracy: 382/595 (64.2017%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.7167, Accuracy: 5250/10000 (52.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 25, internal_epoch   1,  Average loss: 0.0274, Accuracy: 387/589 (65.7046%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.1755, Accuracy: 6351/10000 (63.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 41.250519037246704
[foolsgold agg] training data poison_ratio: 0.0  data num: [584, 594, 598, 608, 602, 601, 593, 536, 595, 589]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 1.9652, Accuracy: 5917/10000 (59.1700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 1.9604, Accuracy: 5820/8991 (64.7314%)
Done in 78.3567590713501 sec.
Server Epoch:10 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
___Train Local_Simple,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0256, Accuracy: 382/581 (65.7487%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.4056, Accuracy: 6051/10000 (60.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 56, internal_epoch   1,  Average loss: 0.0222, Accuracy: 416/590 (70.5085%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.5139, Accuracy: 4867/10000 (48.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 19, internal_epoch   1,  Average loss: 0.0207, Accuracy: 423/595 (71.0924%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.3706, Accuracy: 6774/10000 (67.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0226, Accuracy: 395/589 (67.0628%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.7082, Accuracy: 6075/10000 (60.7500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0210, Accuracy: 407/602 (67.6080%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.8278, Accuracy: 6065/10000 (60.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 78, internal_epoch   1,  Average loss: 0.0192, Accuracy: 419/600 (69.8333%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.7423, Accuracy: 5197/10000 (51.9700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  10, local model 49, internal_epoch   1,  Average loss: 0.0217, Accuracy: 407/609 (66.8309%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.4501, Accuracy: 6721/10000 (67.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 34, internal_epoch   1,  Average loss: 0.0207, Accuracy: 418/593 (70.4890%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.0199, Accuracy: 6374/10000 (63.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0182, Accuracy: 435/593 (73.3558%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.4517, Accuracy: 6777/10000 (67.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 99, internal_epoch   1,  Average loss: 0.0173, Accuracy: 322/407 (79.1155%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 4.9843, Accuracy: 5538/10000 (55.3800%), Attack Success Rate:0/10000(0.000)
time spent on training: 45.276740312576294
[foolsgold agg] training data poison_ratio: 0.0  data num: [581, 590, 595, 589, 602, 600, 609, 593, 593, 407]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         0.42879561 0.84187037 0.         0.87101079 1.
 0.         1.         0.42879561 1.        ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 1.8081, Accuracy: 6620/10000 (66.2000%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 1.7978, Accuracy: 6575/8991 (73.1287%)
Done in 95.15698719024658 sec.
Server Epoch:11 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
___Train Local_Simple,  epoch  11, local model 53, internal_epoch   1,  Average loss: 0.0219, Accuracy: 428/585 (73.1624%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.8360, Accuracy: 5020/10000 (50.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 56, internal_epoch   1,  Average loss: 0.0225, Accuracy: 427/590 (72.3729%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 3.2004, Accuracy: 4000/10000 (40.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0208, Accuracy: 432/595 (72.6050%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0804, Accuracy: 6871/10000 (68.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0191, Accuracy: 442/593 (74.5363%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.1185, Accuracy: 5349/10000 (53.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 36, internal_epoch   1,  Average loss: 0.0177, Accuracy: 417/596 (69.9664%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.5622, Accuracy: 7285/10000 (72.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0184, Accuracy: 438/598 (73.2441%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0811, Accuracy: 6570/10000 (65.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0198, Accuracy: 442/599 (73.7896%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3422, Accuracy: 6731/10000 (67.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 99, internal_epoch   1,  Average loss: 0.0152, Accuracy: 354/407 (86.9779%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 12.1199, Accuracy: 2173/10000 (21.7300%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  11, local model 88, internal_epoch   1,  Average loss: 0.0217, Accuracy: 433/582 (74.3986%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 10.8627, Accuracy: 1610/10000 (16.1000%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0205, Accuracy: 407/594 (68.5185%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3688, Accuracy: 5609/10000 (56.0900%), Attack Success Rate:1/10000(0.010)
time spent on training: 47.67701196670532
[foolsgold agg] training data poison_ratio: 0.0  data num: [585, 590, 595, 593, 596, 598, 599, 407, 582, 594]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.5508375  0.91928457 1.         0.91928457 1.         1.
 0.5508375  1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 1.7089, Accuracy: 7200/10000 (72.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 1.7153, Accuracy: 6148/8991 (68.3795%)
Done in 93.80184125900269 sec.
Server Epoch:12 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0167, Accuracy: 453/609 (74.3842%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7365, Accuracy: 6885/10000 (68.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 17, internal_epoch   1,  Average loss: 0.0174, Accuracy: 441/588 (75.0000%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0382, Accuracy: 6768/10000 (67.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0183, Accuracy: 440/588 (74.8299%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0913, Accuracy: 7099/10000 (70.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0172, Accuracy: 456/598 (76.2542%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.2403, Accuracy: 6751/10000 (67.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0176, Accuracy: 447/598 (74.7492%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9896, Accuracy: 7398/10000 (73.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 38, internal_epoch   1,  Average loss: 0.0173, Accuracy: 454/591 (76.8190%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1903, Accuracy: 5769/10000 (57.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0189, Accuracy: 445/594 (74.9158%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.4117, Accuracy: 6532/10000 (65.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 44, internal_epoch   1,  Average loss: 0.0169, Accuracy: 449/598 (75.0836%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9469, Accuracy: 7354/10000 (73.5400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0160, Accuracy: 449/583 (77.0154%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.1236, Accuracy: 6160/10000 (61.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0168, Accuracy: 458/602 (76.0797%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.0632, Accuracy: 5404/10000 (54.0400%), Attack Success Rate:0/10000(0.000)
time spent on training: 48.69734716415405
[foolsgold agg] training data poison_ratio: 0.0  data num: [609, 588, 588, 598, 598, 591, 594, 598, 583, 602]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.70922608 0.5621632  1.         0.5621632  0.34265092 0.34265092
 1.         1.         0.72956112 0.70922608]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.5571, Accuracy: 7567/10000 (75.6700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 1.5726, Accuracy: 5918/8991 (65.8214%)
Done in 92.37451791763306 sec.
Server Epoch:13 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
___Train Local_Simple,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0158, Accuracy: 459/596 (77.0134%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5820, Accuracy: 8085/10000 (80.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 38, internal_epoch   1,  Average loss: 0.0154, Accuracy: 446/591 (75.4653%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7075, Accuracy: 7588/10000 (75.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0152, Accuracy: 468/595 (78.6555%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1412, Accuracy: 6842/10000 (68.4200%), Attack Success Rate:1/10000(0.010)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0171, Accuracy: 456/606 (75.2475%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   2,  Average loss: 0.0079, Accuracy: 514/606 (84.8185%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   3,  Average loss: 0.0054, Accuracy: 548/606 (90.4290%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   4,  Average loss: 0.0034, Accuracy: 577/606 (95.2145%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   5,  Average loss: 0.0028, Accuracy: 578/606 (95.3795%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   6,  Average loss: 0.0025, Accuracy: 583/606 (96.2046%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   7,  Average loss: 0.0022, Accuracy: 586/606 (96.6997%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   8,  Average loss: 0.0020, Accuracy: 589/606 (97.1947%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   9,  Average loss: 0.0019, Accuracy: 592/606 (97.6898%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch  10,  Average loss: 0.0018, Accuracy: 593/606 (97.8548%), train_poison_data_count: 606
Global model norm: 14.442745956590166.
Norm before scaling: 15.05403272771743. Distance: 2.7341575318098337
Total norm for 2 adversaries is: 15.05403272771743. distance: 2.7341575318098337
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1960, Accuracy: 8439/8991 (93.8605%)
___Train Local_Simple,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0158, Accuracy: 461/589 (78.2683%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.1280, Accuracy: 6418/10000 (64.1800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  13, local model 76, internal_epoch   1,  Average loss: 0.0175, Accuracy: 453/593 (76.3912%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.6028, Accuracy: 6331/10000 (63.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 97, internal_epoch   1,  Average loss: 0.0167, Accuracy: 412/536 (76.8657%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.8280, Accuracy: 3179/10000 (31.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0163, Accuracy: 452/586 (77.1331%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.8196, Accuracy: 7813/10000 (78.1300%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   1,  Average loss: 0.0179, Accuracy: 435/596 (72.9866%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   2,  Average loss: 0.0078, Accuracy: 503/596 (84.3960%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   3,  Average loss: 0.0036, Accuracy: 553/596 (92.7852%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   4,  Average loss: 0.0028, Accuracy: 570/596 (95.6376%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   5,  Average loss: 0.0024, Accuracy: 575/596 (96.4765%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   6,  Average loss: 0.0022, Accuracy: 576/596 (96.6443%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   7,  Average loss: 0.0018, Accuracy: 582/596 (97.6510%), train_poison_data_count: 596
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   8,  Average loss: 0.0017, Accuracy: 582/596 (97.6510%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   9,  Average loss: 0.0015, Accuracy: 582/596 (97.6510%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch  10,  Average loss: 0.0016, Accuracy: 583/596 (97.8188%), train_poison_data_count: 596
Global model norm: 14.442745956590166.
Norm before scaling: 15.061628261048785. Distance: 2.7908076108026356
Total norm for 2 adversaries is: 15.061628261048785. distance: 2.7908076108026356
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.2057, Accuracy: 8448/8991 (93.9606%)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0166, Accuracy: 462/593 (77.9089%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.8841, Accuracy: 7310/10000 (73.1000%), Attack Success Rate:0/10000(0.000)
time spent on training: 68.24046587944031
[foolsgold agg] training data poison_ratio: 0.20438700901207277  data num: [596, 591, 595, 606, 589, 593, 536, 586, 596, 593]
[foolsgold agg] considering poison per batch poison_fraction: 0.20438700901207277
[foolsgold agg] wv: [0.66250393 0.98805352 1.         0.57423486 1.         1.
 1.         1.         0.57423486 0.66250393]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.3448, Accuracy: 7249/10000 (72.4900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 1.3434, Accuracy: 6355/8991 (70.6818%)
Done in 105.06825184822083 sec.
Server Epoch:14 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0129, Accuracy: 419/540 (77.5926%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0594, Accuracy: 7748/10000 (77.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 97, internal_epoch   1,  Average loss: 0.0130, Accuracy: 418/536 (77.9851%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1790, Accuracy: 7034/10000 (70.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0143, Accuracy: 448/581 (77.1084%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.3417, Accuracy: 6705/10000 (67.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 89, internal_epoch   1,  Average loss: 0.0148, Accuracy: 456/593 (76.8971%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6907, Accuracy: 7964/10000 (79.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0127, Accuracy: 469/589 (79.6265%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6564, Accuracy: 8307/10000 (83.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 34, internal_epoch   1,  Average loss: 0.0171, Accuracy: 451/593 (76.0540%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.8472, Accuracy: 7300/10000 (73.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 55, internal_epoch   1,  Average loss: 0.0139, Accuracy: 470/592 (79.3919%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6218, Accuracy: 8277/10000 (82.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 67, internal_epoch   1,  Average loss: 0.0139, Accuracy: 438/584 (75.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.3258, Accuracy: 7254/10000 (72.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0137, Accuracy: 460/590 (77.9661%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.3487, Accuracy: 6957/10000 (69.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0117, Accuracy: 479/588 (81.4626%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.5767, Accuracy: 7004/10000 (70.0400%), Attack Success Rate:0/10000(0.000)
time spent on training: 40.77690410614014
[foolsgold agg] training data poison_ratio: 0.0  data num: [540, 536, 581, 593, 589, 593, 592, 584, 590, 588]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.        1.        0.8895198 1.        1.        1.        1.
 0.8895198 1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.1728, Accuracy: 6589/10000 (65.8900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 1.1682, Accuracy: 6177/8991 (68.7020%)
Done in 77.9202630519867 sec.
Server Epoch:15 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
___Train Local_Simple,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0107, Accuracy: 474/602 (78.7375%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5070, Accuracy: 8356/10000 (83.5600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0136, Accuracy: 436/595 (73.2773%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   2,  Average loss: 0.0072, Accuracy: 518/595 (87.0588%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   3,  Average loss: 0.0041, Accuracy: 553/595 (92.9412%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   4,  Average loss: 0.0035, Accuracy: 565/595 (94.9580%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   5,  Average loss: 0.0027, Accuracy: 567/595 (95.2941%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   6,  Average loss: 0.0024, Accuracy: 570/595 (95.7983%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   7,  Average loss: 0.0022, Accuracy: 574/595 (96.4706%), train_poison_data_count: 595
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   8,  Average loss: 0.0020, Accuracy: 575/595 (96.6387%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   9,  Average loss: 0.0018, Accuracy: 578/595 (97.1429%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch  10,  Average loss: 0.0017, Accuracy: 578/595 (97.1429%), train_poison_data_count: 595
Global model norm: 14.595785060363157.
Norm before scaling: 15.063960720795054. Distance: 2.4208366875507625
Total norm for 2 adversaries is: 15.063960720795054. distance: 2.4208366875507625
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1750, Accuracy: 8503/8991 (94.5724%)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   1,  Average loss: 0.0127, Accuracy: 457/591 (77.3266%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   2,  Average loss: 0.0056, Accuracy: 526/591 (89.0017%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   3,  Average loss: 0.0048, Accuracy: 538/591 (91.0321%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   4,  Average loss: 0.0023, Accuracy: 567/591 (95.9391%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   5,  Average loss: 0.0018, Accuracy: 570/591 (96.4467%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   6,  Average loss: 0.0014, Accuracy: 577/591 (97.6311%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   7,  Average loss: 0.0012, Accuracy: 579/591 (97.9695%), train_poison_data_count: 591
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   8,  Average loss: 0.0011, Accuracy: 582/591 (98.4772%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   9,  Average loss: 0.0009, Accuracy: 585/591 (98.9848%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch  10,  Average loss: 0.0009, Accuracy: 585/591 (98.9848%), train_poison_data_count: 591
Global model norm: 14.595785060363157.
Norm before scaling: 15.142077176553524. Distance: 2.493200974988693
Total norm for 2 adversaries is: 15.142077176553524. distance: 2.493200974988693
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.2219, Accuracy: 8456/8991 (94.0496%)
___Train Local_Simple,  epoch  15, local model 48, internal_epoch   1,  Average loss: 0.0119, Accuracy: 451/588 (76.7007%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.9293, Accuracy: 7161/10000 (71.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0124, Accuracy: 441/592 (74.4932%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.9753, Accuracy: 7180/10000 (71.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 98, internal_epoch   1,  Average loss: 0.0108, Accuracy: 384/497 (77.2636%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.9131, Accuracy: 7545/10000 (75.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 27, internal_epoch   1,  Average loss: 0.0135, Accuracy: 454/593 (76.5599%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.7341, Accuracy: 7665/10000 (76.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0116, Accuracy: 479/609 (78.6535%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.7221, Accuracy: 7690/10000 (76.9000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0114, Accuracy: 461/594 (77.6094%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.9132, Accuracy: 7598/10000 (75.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 44, internal_epoch   1,  Average loss: 0.0125, Accuracy: 451/598 (75.4181%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5942, Accuracy: 7879/10000 (78.7900%), Attack Success Rate:0/10000(0.000)
time spent on training: 62.017032861709595
[foolsgold agg] training data poison_ratio: 0.2024236217784605  data num: [602, 595, 591, 588, 592, 497, 593, 609, 594, 598]
[foolsgold agg] considering poison per batch poison_fraction: 0.2024236217784605
[foolsgold agg] wv: [0.27384534 1.         1.         0.85285311 0.72370141 0.34945641
 1.         0.27384534 0.91790802 0.72370141]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.9489, Accuracy: 6991/10000 (69.9100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.9212, Accuracy: 6826/8991 (75.9204%)
Done in 98.94646406173706 sec.
Server Epoch:16 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
___Train Local_Simple,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0099, Accuracy: 476/589 (80.8149%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.7094, Accuracy: 8344/10000 (83.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0101, Accuracy: 481/593 (81.1130%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.9116, Accuracy: 7798/10000 (77.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0108, Accuracy: 472/581 (81.2392%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 3.5382, Accuracy: 6526/10000 (65.2600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0070, Accuracy: 359/407 (88.2064%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.0826, Accuracy: 6591/10000 (65.9100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0102, Accuracy: 484/585 (82.7350%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4277, Accuracy: 8680/10000 (86.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0109, Accuracy: 478/584 (81.8493%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.2513, Accuracy: 5661/10000 (56.6100%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   1,  Average loss: 0.0097, Accuracy: 509/595 (85.5462%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   2,  Average loss: 0.0049, Accuracy: 545/595 (91.5966%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   3,  Average loss: 0.0027, Accuracy: 565/595 (94.9580%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   4,  Average loss: 0.0018, Accuracy: 578/595 (97.1429%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   5,  Average loss: 0.0015, Accuracy: 583/595 (97.9832%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   6,  Average loss: 0.0018, Accuracy: 586/595 (98.4874%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   7,  Average loss: 0.0011, Accuracy: 586/595 (98.4874%), train_poison_data_count: 595
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   8,  Average loss: 0.0010, Accuracy: 586/595 (98.4874%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   9,  Average loss: 0.0009, Accuracy: 586/595 (98.4874%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch  10,  Average loss: 0.0010, Accuracy: 586/595 (98.4874%), train_poison_data_count: 595
Global model norm: 14.660462772408376.
Norm before scaling: 15.108767539656661. Distance: 2.206704012486578
Total norm for 2 adversaries is: 15.108767539656661. distance: 2.206704012486578
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1698, Accuracy: 8530/8991 (94.8727%)
___Train Local_Simple,  epoch  16, local model 63, internal_epoch   1,  Average loss: 0.0105, Accuracy: 485/594 (81.6498%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0370, Accuracy: 7647/10000 (76.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 52, internal_epoch   1,  Average loss: 0.0096, Accuracy: 487/595 (81.8487%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.7341, Accuracy: 8305/10000 (83.0500%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   1,  Average loss: 0.0086, Accuracy: 509/587 (86.7121%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   2,  Average loss: 0.0055, Accuracy: 532/587 (90.6303%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   3,  Average loss: 0.0039, Accuracy: 540/587 (91.9932%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   4,  Average loss: 0.0020, Accuracy: 568/587 (96.7632%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   5,  Average loss: 0.0016, Accuracy: 571/587 (97.2743%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   6,  Average loss: 0.0012, Accuracy: 578/587 (98.4668%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   7,  Average loss: 0.0011, Accuracy: 579/587 (98.6371%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   8,  Average loss: 0.0009, Accuracy: 580/587 (98.8075%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   9,  Average loss: 0.0008, Accuracy: 581/587 (98.9779%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch  10,  Average loss: 0.0009, Accuracy: 581/587 (98.9779%), train_poison_data_count: 587
Global model norm: 14.660462772408376.
Norm before scaling: 15.12621460128285. Distance: 2.181892073167556
Total norm for 2 adversaries is: 15.12621460128285. distance: 2.181892073167556
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.2119, Accuracy: 8447/8991 (93.9495%)
time spent on training: 60.73076605796814
[foolsgold agg] training data poison_ratio: 0.20700525394045535  data num: [589, 593, 581, 407, 585, 584, 595, 594, 595, 587]
[foolsgold agg] considering poison per batch poison_fraction: 0.20700525394045535
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.7602, Accuracy: 7378/10000 (73.7800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.7603, Accuracy: 6899/8991 (76.7323%)
Done in 100.27132320404053 sec.
Server Epoch:17 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0079, Accuracy: 526/602 (87.3754%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4961, Accuracy: 8742/10000 (87.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 33, internal_epoch   1,  Average loss: 0.0072, Accuracy: 516/598 (86.2876%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9791, Accuracy: 7944/10000 (79.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 56, internal_epoch   1,  Average loss: 0.0070, Accuracy: 515/590 (87.2881%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4677, Accuracy: 8787/10000 (87.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 97, internal_epoch   1,  Average loss: 0.0068, Accuracy: 479/536 (89.3657%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9175, Accuracy: 8237/10000 (82.3700%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0079, Accuracy: 524/606 (86.4686%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0047, Accuracy: 549/606 (90.5941%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   3,  Average loss: 0.0024, Accuracy: 585/606 (96.5347%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   4,  Average loss: 0.0017, Accuracy: 590/606 (97.3597%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   5,  Average loss: 0.0014, Accuracy: 592/606 (97.6898%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   6,  Average loss: 0.0011, Accuracy: 597/606 (98.5149%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   7,  Average loss: 0.0011, Accuracy: 599/606 (98.8449%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   8,  Average loss: 0.0009, Accuracy: 598/606 (98.6799%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   9,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch  10,  Average loss: 0.0009, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Global model norm: 14.735561739721911.
Norm before scaling: 15.101611504867464. Distance: 1.9865041409114959
Total norm for 2 adversaries is: 15.101611504867464. distance: 1.9865041409114959
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1636, Accuracy: 8553/8991 (95.1285%)
___Train Local_Simple,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0079, Accuracy: 511/602 (84.8837%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4928, Accuracy: 8585/10000 (85.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 77, internal_epoch   1,  Average loss: 0.0071, Accuracy: 503/583 (86.2779%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3505, Accuracy: 9135/10000 (91.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0082, Accuracy: 509/594 (85.6902%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4581, Accuracy: 8814/10000 (88.1400%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   1,  Average loss: 0.0071, Accuracy: 523/587 (89.0971%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   2,  Average loss: 0.0027, Accuracy: 558/587 (95.0596%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   3,  Average loss: 0.0030, Accuracy: 555/587 (94.5486%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   4,  Average loss: 0.0017, Accuracy: 568/587 (96.7632%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   5,  Average loss: 0.0010, Accuracy: 575/587 (97.9557%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   6,  Average loss: 0.0009, Accuracy: 578/587 (98.4668%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   7,  Average loss: 0.0007, Accuracy: 582/587 (99.1482%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   8,  Average loss: 0.0006, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   9,  Average loss: 0.0006, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch  10,  Average loss: 0.0005, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Global model norm: 14.735561739721911.
Norm before scaling: 15.118964386043288. Distance: 2.015943398574197
Total norm for 2 adversaries is: 15.118964386043288. distance: 2.015943398574197
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.2139, Accuracy: 8498/8991 (94.5167%)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0077, Accuracy: 508/598 (84.9498%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.5580, Accuracy: 8630/10000 (86.3000%), Attack Success Rate:0/10000(0.000)
time spent on training: 61.98101496696472
[foolsgold agg] training data poison_ratio: 0.20234056987788332  data num: [602, 598, 590, 536, 606, 602, 583, 594, 587, 598]
[foolsgold agg] considering poison per batch poison_fraction: 0.20234056987788332
[foolsgold agg] wv: [1.         0.55906422 1.         1.         1.         0.55906422
 1.         1.         1.         0.93982764]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.6311, Accuracy: 7718/10000 (77.1800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.6206, Accuracy: 7182/8991 (79.8799%)
Done in 99.44879102706909 sec.
Server Epoch:18 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0074, Accuracy: 509/592 (85.9797%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5733, Accuracy: 8398/10000 (83.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0074, Accuracy: 514/586 (87.7133%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.7355, Accuracy: 6764/10000 (67.6400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  18, local model 88, internal_epoch   1,  Average loss: 0.0069, Accuracy: 505/582 (86.7698%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8279, Accuracy: 7796/10000 (77.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0067, Accuracy: 527/595 (88.5714%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5271, Accuracy: 8603/10000 (86.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 39, internal_epoch   1,  Average loss: 0.0083, Accuracy: 494/583 (84.7341%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5015, Accuracy: 8314/10000 (83.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 75, internal_epoch   1,  Average loss: 0.0076, Accuracy: 505/595 (84.8739%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4439, Accuracy: 8712/10000 (87.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 82, internal_epoch   1,  Average loss: 0.0064, Accuracy: 527/593 (88.8702%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6595, Accuracy: 8209/10000 (82.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0076, Accuracy: 513/589 (87.0968%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.0956, Accuracy: 7352/10000 (73.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 95, internal_epoch   1,  Average loss: 0.0070, Accuracy: 470/540 (87.0370%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9802, Accuracy: 7821/10000 (78.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0086, Accuracy: 439/525 (83.6190%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7767, Accuracy: 7978/10000 (79.7800%), Attack Success Rate:0/10000(0.000)
time spent on training: 40.43932509422302
[foolsgold agg] training data poison_ratio: 0.0  data num: [592, 586, 582, 595, 583, 595, 593, 589, 540, 525]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.64586325 1.         1.         0.86711029 0.64586325 0.72680389
 1.         0.72680389 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.5862, Accuracy: 7800/10000 (78.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.6636, Accuracy: 6579/8991 (73.1732%)
Done in 77.81814193725586 sec.
Server Epoch:19 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
___Train Local_Simple,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0078, Accuracy: 511/594 (86.0269%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2467, Accuracy: 9230/10000 (92.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.0072, Accuracy: 500/584 (85.6164%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.7852, Accuracy: 8039/10000 (80.3900%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   1,  Average loss: 0.0065, Accuracy: 508/582 (87.2852%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   2,  Average loss: 0.0044, Accuracy: 544/582 (93.4708%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   3,  Average loss: 0.0028, Accuracy: 543/582 (93.2990%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   4,  Average loss: 0.0012, Accuracy: 565/582 (97.0790%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   5,  Average loss: 0.0011, Accuracy: 572/582 (98.2818%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   6,  Average loss: 0.0011, Accuracy: 574/582 (98.6254%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   7,  Average loss: 0.0007, Accuracy: 577/582 (99.1409%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   8,  Average loss: 0.0008, Accuracy: 577/582 (99.1409%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   9,  Average loss: 0.0006, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch  10,  Average loss: 0.0006, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Global model norm: 14.849186915477267.
Norm before scaling: 15.163620248091163. Distance: 1.9446430203296243
Total norm for 1 adversaries is: 15.163620248091163. distance: 1.9446430203296243
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1602, Accuracy: 8554/8991 (95.1396%)
___Train Local_Simple,  epoch  19, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 526/595 (88.4034%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3856, Accuracy: 8942/10000 (89.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0067, Accuracy: 510/589 (86.5874%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3528, Accuracy: 8910/10000 (89.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0084, Accuracy: 497/584 (85.1027%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.9360, Accuracy: 7451/10000 (74.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 520/593 (87.6897%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.5457, Accuracy: 8479/10000 (84.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0065, Accuracy: 523/594 (88.0471%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.5047, Accuracy: 8543/10000 (85.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0069, Accuracy: 520/598 (86.9565%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4393, Accuracy: 8647/10000 (86.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0064, Accuracy: 506/585 (86.4957%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.5547, Accuracy: 8439/10000 (84.3900%), Attack Success Rate:0/10000(0.000)
time spent on training: 49.90027594566345
[foolsgold agg] training data poison_ratio: 0.09867751780264497  data num: [594, 584, 582, 595, 589, 584, 593, 594, 598, 585]
[foolsgold agg] considering poison per batch poison_fraction: 0.09867751780264497
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.5360, Accuracy: 8133/10000 (81.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.6649, Accuracy: 6688/8991 (74.3855%)
Done in 88.12806701660156 sec.
Server Epoch:20 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
___Train Local_Simple,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 540/595 (90.7563%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3679, Accuracy: 8999/10000 (89.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0059, Accuracy: 519/584 (88.8699%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.4103, Accuracy: 8780/10000 (87.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 27, internal_epoch   1,  Average loss: 0.0068, Accuracy: 514/593 (86.6779%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3794, Accuracy: 8841/10000 (88.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 82, internal_epoch   1,  Average loss: 0.0057, Accuracy: 526/593 (88.7015%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.4507, Accuracy: 8676/10000 (86.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0059, Accuracy: 526/594 (88.5522%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.4056, Accuracy: 8856/10000 (88.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0073, Accuracy: 513/589 (87.0968%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3433, Accuracy: 8961/10000 (89.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 29, internal_epoch   1,  Average loss: 0.0064, Accuracy: 520/586 (88.7372%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3701, Accuracy: 8809/10000 (88.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 47, internal_epoch   1,  Average loss: 0.0057, Accuracy: 523/586 (89.2491%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6075, Accuracy: 8273/10000 (82.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 528/589 (89.6435%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.4358, Accuracy: 8771/10000 (87.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0055, Accuracy: 533/609 (87.5205%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6150, Accuracy: 8325/10000 (83.2500%), Attack Success Rate:0/10000(0.000)
time spent on training: 40.053006172180176
[foolsgold agg] training data poison_ratio: 0.0  data num: [595, 584, 593, 593, 594, 589, 586, 586, 589, 609]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.87221095 1.         1.
 1.         0.87221095 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.5058, Accuracy: 8307/10000 (83.0700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.7593, Accuracy: 6601/8991 (73.4179%)
Done in 77.86228013038635 sec.
Server Epoch:21 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
___Train Local_Simple,  epoch  21, local model 33, internal_epoch   1,  Average loss: 0.0059, Accuracy: 528/598 (88.2943%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2625, Accuracy: 9218/10000 (92.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 528/581 (90.8778%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4576, Accuracy: 8659/10000 (86.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0075, Accuracy: 447/525 (85.1429%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6816, Accuracy: 7953/10000 (79.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 15, internal_epoch   1,  Average loss: 0.0082, Accuracy: 495/579 (85.4922%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 8.2234, Accuracy: 2477/10000 (24.7700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0062, Accuracy: 541/607 (89.1269%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3639, Accuracy: 8890/10000 (88.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0058, Accuracy: 478/536 (89.1791%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.5464, Accuracy: 8403/10000 (84.0300%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   1,  Average loss: 0.0050, Accuracy: 535/591 (90.5245%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   2,  Average loss: 0.0025, Accuracy: 552/591 (93.4010%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   3,  Average loss: 0.0012, Accuracy: 578/591 (97.8003%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   4,  Average loss: 0.0009, Accuracy: 583/591 (98.6464%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   5,  Average loss: 0.0007, Accuracy: 586/591 (99.1540%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   6,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   7,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%), train_poison_data_count: 591
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   8,  Average loss: 0.0005, Accuracy: 589/591 (99.6616%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   9,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch  10,  Average loss: 0.0005, Accuracy: 590/591 (99.8308%), train_poison_data_count: 591
Global model norm: 14.95948813965206.
Norm before scaling: 15.241554297937995. Distance: 2.0396339521922915
Total norm for 1 adversaries is: 15.241554297937995. distance: 2.0396339521922915
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1858, Accuracy: 8523/8991 (94.7948%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 534/597 (89.4472%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4280, Accuracy: 8672/10000 (86.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0060, Accuracy: 508/577 (88.0416%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2751, Accuracy: 9188/10000 (91.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0055, Accuracy: 535/595 (89.9160%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2875, Accuracy: 9177/10000 (91.7700%), Attack Success Rate:0/10000(0.000)
time spent on training: 50.20357799530029
[foolsgold agg] training data poison_ratio: 0.10214310404424473  data num: [598, 581, 525, 579, 607, 536, 591, 597, 577, 595]
[foolsgold agg] considering poison per batch poison_fraction: 0.10214310404424473
[foolsgold agg] wv: [0.85197971 0.85197971 1.         1.         1.         0.78850924
 1.         1.         1.         0.78850924]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.5192, Accuracy: 8187/10000 (81.8700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.7614, Accuracy: 6546/8991 (72.8061%)
Done in 89.06324195861816 sec.
Server Epoch:22 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
___Train Local_Simple,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.0071, Accuracy: 514/596 (86.2416%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3434, Accuracy: 8925/10000 (89.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0067, Accuracy: 509/591 (86.1252%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.4463, Accuracy: 8583/10000 (85.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 541/609 (88.8342%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2356, Accuracy: 9288/10000 (92.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0057, Accuracy: 537/601 (89.3511%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2330, Accuracy: 9313/10000 (93.1300%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 523/595 (87.8992%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   2,  Average loss: 0.0034, Accuracy: 557/595 (93.6134%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   3,  Average loss: 0.0028, Accuracy: 565/595 (94.9580%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   4,  Average loss: 0.0012, Accuracy: 584/595 (98.1513%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   5,  Average loss: 0.0010, Accuracy: 587/595 (98.6555%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   6,  Average loss: 0.0013, Accuracy: 589/595 (98.9916%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   7,  Average loss: 0.0010, Accuracy: 589/595 (98.9916%), train_poison_data_count: 595
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   8,  Average loss: 0.0008, Accuracy: 588/595 (98.8235%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   9,  Average loss: 0.0007, Accuracy: 587/595 (98.6555%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch  10,  Average loss: 0.0007, Accuracy: 588/595 (98.8235%), train_poison_data_count: 595
Global model norm: 15.01030173997829.
Norm before scaling: 15.312755598153752. Distance: 2.237495217771055
Total norm for 1 adversaries is: 15.312755598153752. distance: 2.237495217771055
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1563, Accuracy: 8572/8991 (95.3398%)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0062, Accuracy: 513/593 (86.5093%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2860, Accuracy: 9110/10000 (91.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0073, Accuracy: 507/589 (86.0781%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3642, Accuracy: 8778/10000 (87.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 92, internal_epoch   1,  Average loss: 0.0055, Accuracy: 477/535 (89.1589%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6066, Accuracy: 8313/10000 (83.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 27, internal_epoch   1,  Average loss: 0.0057, Accuracy: 529/593 (89.2074%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3084, Accuracy: 9048/10000 (90.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 96, internal_epoch   1,  Average loss: 0.0066, Accuracy: 467/534 (87.4532%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5059, Accuracy: 8428/10000 (84.2800%), Attack Success Rate:0/10000(0.000)
time spent on training: 52.21374988555908
[foolsgold agg] training data poison_ratio: 0.10195339273474983  data num: [596, 591, 609, 601, 595, 593, 589, 535, 593, 534]
[foolsgold agg] considering poison per batch poison_fraction: 0.10195339273474983
[foolsgold agg] wv: [0.68772526 0.68772526 1.         1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.4726, Accuracy: 8420/10000 (84.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.7134, Accuracy: 6766/8991 (75.2530%)
Done in 90.50911617279053 sec.
Server Epoch:23 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0045, Accuracy: 544/590 (92.2034%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3703, Accuracy: 8764/10000 (87.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0054, Accuracy: 541/593 (91.2310%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2884, Accuracy: 9087/10000 (90.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 85, internal_epoch   1,  Average loss: 0.0055, Accuracy: 529/590 (89.6610%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3058, Accuracy: 8971/10000 (89.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0047, Accuracy: 530/588 (90.1361%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2890, Accuracy: 8962/10000 (89.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 526/593 (88.7015%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3353, Accuracy: 8867/10000 (88.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 61, internal_epoch   1,  Average loss: 0.0051, Accuracy: 531/589 (90.1528%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2534, Accuracy: 9190/10000 (91.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0057, Accuracy: 514/584 (88.0137%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3330, Accuracy: 8909/10000 (89.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0040, Accuracy: 547/597 (91.6248%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1825, Accuracy: 9431/10000 (94.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0066, Accuracy: 528/593 (89.0388%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2132, Accuracy: 9337/10000 (93.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 75, internal_epoch   1,  Average loss: 0.0057, Accuracy: 532/595 (89.4118%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2970, Accuracy: 9118/10000 (91.1800%), Attack Success Rate:0/10000(0.000)
time spent on training: 40.107362031936646
[foolsgold agg] training data poison_ratio: 0.0  data num: [590, 593, 590, 588, 593, 589, 584, 597, 593, 595]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.4843, Accuracy: 8454/10000 (84.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.8186, Accuracy: 6714/8991 (74.6747%)
Done in 78.30301690101624 sec.
Server Epoch:24 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
___Train Local_Simple,  epoch  24, local model 36, internal_epoch   1,  Average loss: 0.0059, Accuracy: 524/596 (87.9195%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.4325, Accuracy: 8504/10000 (85.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0061, Accuracy: 526/586 (89.7611%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3419, Accuracy: 8804/10000 (88.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 479/534 (89.7004%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5435, Accuracy: 8492/10000 (84.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 83, internal_epoch   1,  Average loss: 0.0067, Accuracy: 529/598 (88.4615%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3056, Accuracy: 8891/10000 (88.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 542/594 (91.2458%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2448, Accuracy: 9228/10000 (92.2800%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0056, Accuracy: 533/590 (90.3390%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   2,  Average loss: 0.0026, Accuracy: 559/590 (94.7458%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   3,  Average loss: 0.0021, Accuracy: 564/590 (95.5932%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   4,  Average loss: 0.0012, Accuracy: 577/590 (97.7966%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   5,  Average loss: 0.0009, Accuracy: 579/590 (98.1356%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   6,  Average loss: 0.0008, Accuracy: 582/590 (98.6441%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   7,  Average loss: 0.0009, Accuracy: 583/590 (98.8136%), train_poison_data_count: 590
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   8,  Average loss: 0.0006, Accuracy: 584/590 (98.9831%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   9,  Average loss: 0.0006, Accuracy: 587/590 (99.4915%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch  10,  Average loss: 0.0006, Accuracy: 587/590 (99.4915%), train_poison_data_count: 590
Global model norm: 15.101021920291004.
Norm before scaling: 15.31267189396503. Distance: 2.166547099506748
Total norm for 2 adversaries is: 15.31267189396503. distance: 2.166547099506748
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1670, Accuracy: 8532/8991 (94.8949%)
___Train Local_Simple,  epoch  24, local model 94, internal_epoch   1,  Average loss: 0.0053, Accuracy: 484/536 (90.2985%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5445, Accuracy: 8392/10000 (83.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0058, Accuracy: 520/589 (88.2852%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2645, Accuracy: 9208/10000 (92.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0053, Accuracy: 544/595 (91.4286%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3182, Accuracy: 8986/10000 (89.8600%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   1,  Average loss: 0.0063, Accuracy: 513/582 (88.1443%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   2,  Average loss: 0.0048, Accuracy: 516/582 (88.6598%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   3,  Average loss: 0.0031, Accuracy: 550/582 (94.5017%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   4,  Average loss: 0.0016, Accuracy: 566/582 (97.2509%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   5,  Average loss: 0.0014, Accuracy: 568/582 (97.5945%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   6,  Average loss: 0.0014, Accuracy: 572/582 (98.2818%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   7,  Average loss: 0.0010, Accuracy: 573/582 (98.4536%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   8,  Average loss: 0.0008, Accuracy: 573/582 (98.4536%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   9,  Average loss: 0.0007, Accuracy: 577/582 (99.1409%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch  10,  Average loss: 0.0008, Accuracy: 578/582 (99.3127%), train_poison_data_count: 582
Global model norm: 15.101021920291004.
Norm before scaling: 15.396785033892069. Distance: 2.27351604732356
Total norm for 2 adversaries is: 15.396785033892069. distance: 2.27351604732356
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1506, Accuracy: 8568/8991 (95.2953%)
time spent on training: 61.77530598640442
[foolsgold agg] training data poison_ratio: 0.20206896551724138  data num: [596, 586, 534, 598, 594, 590, 536, 589, 595, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.20206896551724138
[foolsgold agg] wv: [0.1939703 0.1939703 1.        1.        1.        1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.4664, Accuracy: 8507/10000 (85.0700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.6615, Accuracy: 6996/8991 (77.8111%)
Done in 99.57393097877502 sec.
Server Epoch:25 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
___Train Local_Simple,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0050, Accuracy: 527/587 (89.7785%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4757, Accuracy: 8427/10000 (84.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 528/598 (88.2943%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2923, Accuracy: 9075/10000 (90.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.0076, Accuracy: 515/589 (87.4363%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2893, Accuracy: 9143/10000 (91.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0043, Accuracy: 545/588 (92.6871%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2207, Accuracy: 9313/10000 (93.1300%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0047, Accuracy: 530/591 (89.6785%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0021, Accuracy: 567/591 (95.9391%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   3,  Average loss: 0.0011, Accuracy: 575/591 (97.2927%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   4,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   5,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   6,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   7,  Average loss: 0.0005, Accuracy: 589/591 (99.6616%), train_poison_data_count: 591
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   8,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   9,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch  10,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 591
Global model norm: 15.15895393084047.
Norm before scaling: 15.370181933724183. Distance: 2.033695333598399
Total norm for 1 adversaries is: 15.370181933724183. distance: 2.033695333598399
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1675, Accuracy: 8570/8991 (95.3175%)
___Train Local_Simple,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0060, Accuracy: 533/600 (88.8333%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2435, Accuracy: 9301/10000 (93.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0053, Accuracy: 520/584 (89.0411%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2628, Accuracy: 9227/10000 (92.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 525/593 (88.5329%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2858, Accuracy: 9109/10000 (91.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0069, Accuracy: 529/592 (89.3581%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2668, Accuracy: 9206/10000 (92.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0064, Accuracy: 511/585 (87.3504%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2825, Accuracy: 9133/10000 (91.3300%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.06242775917053
[foolsgold agg] training data poison_ratio: 0.10005078720162519  data num: [587, 598, 589, 588, 591, 600, 584, 593, 592, 585]
[foolsgold agg] considering poison per batch poison_fraction: 0.10005078720162519
[foolsgold agg] wv: [0.72534545 0.86185335 1.         0.86185335 1.         1.
 1.         1.         0.72534545 1.        ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.4286, Accuracy: 8665/10000 (86.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.6510, Accuracy: 7102/8991 (78.9901%)
Done in 88.85904216766357 sec.
Server Epoch:26 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
___Train Local_Simple,  epoch  26, local model 39, internal_epoch   1,  Average loss: 0.0056, Accuracy: 522/583 (89.5369%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.4721, Accuracy: 8407/10000 (84.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 550/593 (92.7487%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.4032, Accuracy: 8716/10000 (87.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 32, internal_epoch   1,  Average loss: 0.0045, Accuracy: 552/601 (91.8469%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2484, Accuracy: 9271/10000 (92.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 546/602 (90.6977%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3011, Accuracy: 9017/10000 (90.1700%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   1,  Average loss: 0.0045, Accuracy: 541/590 (91.6949%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   2,  Average loss: 0.0024, Accuracy: 562/590 (95.2542%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   3,  Average loss: 0.0017, Accuracy: 575/590 (97.4576%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   4,  Average loss: 0.0008, Accuracy: 580/590 (98.3051%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   5,  Average loss: 0.0007, Accuracy: 581/590 (98.4746%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   6,  Average loss: 0.0006, Accuracy: 586/590 (99.3220%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   7,  Average loss: 0.0005, Accuracy: 587/590 (99.4915%), train_poison_data_count: 590
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   8,  Average loss: 0.0005, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   9,  Average loss: 0.0004, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch  10,  Average loss: 0.0004, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Global model norm: 15.200614635689387.
Norm before scaling: 15.348701128850397. Distance: 1.8387596354176994
Total norm for 1 adversaries is: 15.348701128850397. distance: 1.8387596354176994
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1550, Accuracy: 8565/8991 (95.2619%)
___Train Local_Simple,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0049, Accuracy: 531/594 (89.3939%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2416, Accuracy: 9294/10000 (92.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0043, Accuracy: 551/595 (92.6050%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2076, Accuracy: 9404/10000 (94.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0069, Accuracy: 525/585 (89.7436%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2521, Accuracy: 9230/10000 (92.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 504/536 (94.0299%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3514, Accuracy: 8816/10000 (88.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 550/595 (92.4370%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2143, Accuracy: 9378/10000 (93.7800%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.1431941986084
[foolsgold agg] training data poison_ratio: 0.10044262853251618  data num: [583, 593, 601, 602, 590, 594, 595, 585, 536, 595]
[foolsgold agg] considering poison per batch poison_fraction: 0.10044262853251618
[foolsgold agg] wv: [0.24605394 0.79427916 1.         0.24605394 1.         0.84649374
 1.         0.93132059 1.         0.93132059]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.3942, Accuracy: 8811/10000 (88.1100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.6593, Accuracy: 7186/8991 (79.9244%)
Done in 89.24219489097595 sec.
Server Epoch:27 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
___Train Local_Simple,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 537/590 (91.0169%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4149, Accuracy: 8615/10000 (86.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 533/588 (90.6463%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3838, Accuracy: 8782/10000 (87.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 42, internal_epoch   1,  Average loss: 0.0048, Accuracy: 549/609 (90.1478%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2889, Accuracy: 9164/10000 (91.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 536/589 (91.0017%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.5315, Accuracy: 8481/10000 (84.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 546/588 (92.8571%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2445, Accuracy: 9240/10000 (92.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 537/594 (90.4040%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3176, Accuracy: 8948/10000 (89.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 45, internal_epoch   1,  Average loss: 0.0043, Accuracy: 529/587 (90.1193%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3001, Accuracy: 9026/10000 (90.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 515/577 (89.2548%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4526, Accuracy: 8549/10000 (85.4900%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 544/590 (92.2034%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   2,  Average loss: 0.0027, Accuracy: 554/590 (93.8983%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   3,  Average loss: 0.0024, Accuracy: 561/590 (95.0847%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   4,  Average loss: 0.0010, Accuracy: 584/590 (98.9831%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   5,  Average loss: 0.0008, Accuracy: 583/590 (98.8136%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   6,  Average loss: 0.0006, Accuracy: 585/590 (99.1525%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   7,  Average loss: 0.0005, Accuracy: 586/590 (99.3220%), train_poison_data_count: 590
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   8,  Average loss: 0.0005, Accuracy: 588/590 (99.6610%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   9,  Average loss: 0.0004, Accuracy: 588/590 (99.6610%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch  10,  Average loss: 0.0006, Accuracy: 588/590 (99.6610%), train_poison_data_count: 590
Global model norm: 15.233458506085892.
Norm before scaling: 15.412827517207715. Distance: 2.135079209870649
Total norm for 1 adversaries is: 15.412827517207715. distance: 2.135079209870649
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1594, Accuracy: 8551/8991 (95.1062%)
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 549/594 (92.4242%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2287, Accuracy: 9320/10000 (93.2000%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.2666392326355
[foolsgold agg] training data poison_ratio: 0.09989840839823907  data num: [590, 588, 609, 589, 588, 594, 587, 577, 590, 594]
[foolsgold agg] considering poison per batch poison_fraction: 0.09989840839823907
[foolsgold agg] wv: [1.         0.62341988 0.62341988 0.81300471 0.90257853 0.81300471
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.3844, Accuracy: 8814/10000 (88.1400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.5885, Accuracy: 7296/8991 (81.1478%)
Done in 89.4931390285492 sec.
Server Epoch:28 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
___Train Local_Simple,  epoch  28, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 549/598 (91.8060%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3076, Accuracy: 9078/10000 (90.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0059, Accuracy: 538/595 (90.4202%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3976, Accuracy: 8737/10000 (87.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 535/588 (90.9864%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2512, Accuracy: 9215/10000 (92.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 540/594 (90.9091%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2211, Accuracy: 9305/10000 (93.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0050, Accuracy: 545/598 (91.1371%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2768, Accuracy: 9133/10000 (91.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.0041, Accuracy: 554/596 (92.9530%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2387, Accuracy: 9294/10000 (92.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0048, Accuracy: 544/593 (91.7369%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3729, Accuracy: 8738/10000 (87.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 35, internal_epoch   1,  Average loss: 0.0074, Accuracy: 506/589 (85.9083%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3323, Accuracy: 9036/10000 (90.3600%), Attack Success Rate:0/10000(0.000)
poison local model 80 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 534/595 (89.7479%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   2,  Average loss: 0.0022, Accuracy: 575/595 (96.6387%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   3,  Average loss: 0.0017, Accuracy: 576/595 (96.8067%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   4,  Average loss: 0.0011, Accuracy: 583/595 (97.9832%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   5,  Average loss: 0.0007, Accuracy: 591/595 (99.3277%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   6,  Average loss: 0.0007, Accuracy: 590/595 (99.1597%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   7,  Average loss: 0.0008, Accuracy: 592/595 (99.4958%), train_poison_data_count: 595
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   8,  Average loss: 0.0005, Accuracy: 592/595 (99.4958%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   9,  Average loss: 0.0005, Accuracy: 592/595 (99.4958%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch  10,  Average loss: 0.0004, Accuracy: 592/595 (99.4958%), train_poison_data_count: 595
Global model norm: 15.266753452726226.
Norm before scaling: 15.416889965742776. Distance: 1.904947930573059
Total norm for 1 adversaries is: 15.416889965742776. distance: 1.904947930573059
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1368, Accuracy: 8646/8991 (96.1628%)
___Train Local_Simple,  epoch  28, local model 81, internal_epoch   1,  Average loss: 0.0046, Accuracy: 542/591 (91.7090%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3415, Accuracy: 8845/10000 (88.4500%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.05321288108826
[foolsgold agg] training data poison_ratio: 0.10021896580764696  data num: [598, 595, 588, 594, 598, 596, 593, 589, 595, 591]
[foolsgold agg] considering poison per batch poison_fraction: 0.10021896580764696
[foolsgold agg] wv: [1.         1.         0.78151656 1.         0.78151656 0.69302985
 1.         0.69302985 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.3212, Accuracy: 9028/10000 (90.2800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.6293, Accuracy: 7318/8991 (81.3925%)
Done in 89.8249888420105 sec.
Server Epoch:29 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
___Train Local_Simple,  epoch  29, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 539/586 (91.9795%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3542, Accuracy: 8846/10000 (88.4600%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   1,  Average loss: 0.0033, Accuracy: 549/587 (93.5264%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   2,  Average loss: 0.0019, Accuracy: 562/587 (95.7411%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   3,  Average loss: 0.0010, Accuracy: 576/587 (98.1261%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   4,  Average loss: 0.0006, Accuracy: 580/587 (98.8075%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   5,  Average loss: 0.0005, Accuracy: 580/587 (98.8075%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   6,  Average loss: 0.0004, Accuracy: 582/587 (99.1482%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   7,  Average loss: 0.0004, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   8,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   9,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch  10,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Global model norm: 15.296916396617888.
Norm before scaling: 15.445028469347193. Distance: 1.9196418255267746
Total norm for 3 adversaries is: 15.445028469347193. distance: 1.9196418255267746
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1561, Accuracy: 8581/8991 (95.4399%)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 552/590 (93.5593%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   2,  Average loss: 0.0024, Accuracy: 564/590 (95.5932%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   3,  Average loss: 0.0014, Accuracy: 577/590 (97.7966%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   4,  Average loss: 0.0009, Accuracy: 583/590 (98.8136%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   5,  Average loss: 0.0007, Accuracy: 583/590 (98.8136%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   6,  Average loss: 0.0007, Accuracy: 585/590 (99.1525%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   7,  Average loss: 0.0005, Accuracy: 587/590 (99.4915%), train_poison_data_count: 590
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   8,  Average loss: 0.0005, Accuracy: 586/590 (99.3220%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   9,  Average loss: 0.0004, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch  10,  Average loss: 0.0005, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Global model norm: 15.296916396617888.
Norm before scaling: 15.451146075261294. Distance: 2.111752787607493
Total norm for 3 adversaries is: 15.451146075261294. distance: 2.111752787607493
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1473, Accuracy: 8592/8991 (95.5622%)
___Train Local_Simple,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.0054, Accuracy: 541/596 (90.7718%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3239, Accuracy: 9004/10000 (90.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0042, Accuracy: 560/607 (92.2570%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2880, Accuracy: 8998/10000 (89.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 531/589 (90.1528%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4416, Accuracy: 8427/10000 (84.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0044, Accuracy: 545/594 (91.7508%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2483, Accuracy: 9228/10000 (92.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 522/584 (89.3836%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2811, Accuracy: 9041/10000 (90.4100%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 543/582 (93.2990%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0025, Accuracy: 547/582 (93.9863%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   3,  Average loss: 0.0014, Accuracy: 563/582 (96.7354%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   4,  Average loss: 0.0008, Accuracy: 574/582 (98.6254%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   5,  Average loss: 0.0006, Accuracy: 577/582 (99.1409%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   6,  Average loss: 0.0006, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   7,  Average loss: 0.0005, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   8,  Average loss: 0.0005, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   9,  Average loss: 0.0004, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch  10,  Average loss: 0.0004, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Global model norm: 15.296916396617888.
Norm before scaling: 15.440785664546883. Distance: 1.8626659344995071
Total norm for 3 adversaries is: 15.440785664546883. distance: 1.8626659344995071
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1304, Accuracy: 8636/8991 (96.0516%)
___Train Local_Simple,  epoch  29, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 553/594 (93.0976%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2739, Accuracy: 9192/10000 (91.9200%), Attack Success Rate:0/10000(0.000)
time spent on training: 70.52144408226013
[foolsgold agg] training data poison_ratio: 0.29768150279235067  data num: [586, 587, 590, 596, 607, 589, 594, 584, 582, 594]
[foolsgold agg] considering poison per batch poison_fraction: 0.29768150279235067
[foolsgold agg] wv: [1.        0.6877006 0.6877006 1.        0.6909552 1.        1.
 1.        0.6909552 1.       ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.3455, Accuracy: 8983/10000 (89.8300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.5905, Accuracy: 7356/8991 (81.8151%)
Done in 107.35600590705872 sec.
Server Epoch:30 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   1,  Average loss: 0.0038, Accuracy: 533/582 (91.5808%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   2,  Average loss: 0.0024, Accuracy: 549/582 (94.3299%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   3,  Average loss: 0.0017, Accuracy: 570/582 (97.9381%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   4,  Average loss: 0.0008, Accuracy: 576/582 (98.9691%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   5,  Average loss: 0.0008, Accuracy: 576/582 (98.9691%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   6,  Average loss: 0.0005, Accuracy: 577/582 (99.1409%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   7,  Average loss: 0.0006, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   8,  Average loss: 0.0005, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   9,  Average loss: 0.0004, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch  10,  Average loss: 0.0004, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Global model norm: 15.335874319310761.
Norm before scaling: 15.493096567819023. Distance: 1.9827839638149853
Total norm for 4 adversaries is: 15.493096567819023. distance: 1.9827839638149853
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1275, Accuracy: 8652/8991 (96.2296%)
___Train Local_Simple,  epoch  30, local model 77, internal_epoch   1,  Average loss: 0.0053, Accuracy: 520/583 (89.1938%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3700, Accuracy: 8789/10000 (87.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0048, Accuracy: 550/600 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4415, Accuracy: 8543/10000 (85.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 21, internal_epoch   1,  Average loss: 0.0071, Accuracy: 519/592 (87.6689%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2713, Accuracy: 9323/10000 (93.2300%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 554/606 (91.4191%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   2,  Average loss: 0.0034, Accuracy: 569/606 (93.8944%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   3,  Average loss: 0.0022, Accuracy: 584/606 (96.3696%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   4,  Average loss: 0.0013, Accuracy: 591/606 (97.5248%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   5,  Average loss: 0.0010, Accuracy: 595/606 (98.1848%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   6,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   7,  Average loss: 0.0008, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   8,  Average loss: 0.0007, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   9,  Average loss: 0.0006, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch  10,  Average loss: 0.0006, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Global model norm: 15.335874319310761.
Norm before scaling: 15.508638497366304. Distance: 1.9524259613300854
Total norm for 4 adversaries is: 15.508638497366304. distance: 1.9524259613300854
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1317, Accuracy: 8617/8991 (95.8403%)
___Train Local_Simple,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 531/593 (89.5447%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3038, Accuracy: 9099/10000 (90.9900%), Attack Success Rate:0/10000(0.000)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0057, Accuracy: 509/576 (88.3681%), train_poison_data_count: 576
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   2,  Average loss: 0.0041, Accuracy: 530/576 (92.0139%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   3,  Average loss: 0.0027, Accuracy: 548/576 (95.1389%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   4,  Average loss: 0.0021, Accuracy: 555/576 (96.3542%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   5,  Average loss: 0.0016, Accuracy: 558/576 (96.8750%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   6,  Average loss: 0.0014, Accuracy: 560/576 (97.2222%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   7,  Average loss: 0.0012, Accuracy: 561/576 (97.3958%), train_poison_data_count: 576
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   8,  Average loss: 0.0011, Accuracy: 562/576 (97.5694%), train_poison_data_count: 576
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   9,  Average loss: 0.0010, Accuracy: 562/576 (97.5694%), train_poison_data_count: 576
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch  10,  Average loss: 0.0010, Accuracy: 562/576 (97.5694%), train_poison_data_count: 576
Global model norm: 15.335874319310761.
Norm before scaling: 15.529523235403762. Distance: 2.2863404425350007
Total norm for 4 adversaries is: 15.529523235403762. distance: 2.2863404425350007
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1325, Accuracy: 8607/8991 (95.7291%)
___Train Local_Simple,  epoch  30, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 550/595 (92.4370%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2445, Accuracy: 9226/10000 (92.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 45, internal_epoch   1,  Average loss: 0.0049, Accuracy: 545/587 (92.8450%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3395, Accuracy: 8859/10000 (88.5900%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   1,  Average loss: 0.0042, Accuracy: 548/590 (92.8814%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   2,  Average loss: 0.0018, Accuracy: 567/590 (96.1017%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   3,  Average loss: 0.0009, Accuracy: 577/590 (97.7966%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   4,  Average loss: 0.0006, Accuracy: 585/590 (99.1525%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   5,  Average loss: 0.0005, Accuracy: 585/590 (99.1525%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   6,  Average loss: 0.0004, Accuracy: 587/590 (99.4915%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   7,  Average loss: 0.0004, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   8,  Average loss: 0.0004, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   9,  Average loss: 0.0003, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch  10,  Average loss: 0.0003, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Global model norm: 15.335874319310761.
Norm before scaling: 15.490593794098082. Distance: 2.0589302844731776
Total norm for 4 adversaries is: 15.490593794098082. distance: 2.0589302844731776
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1479, Accuracy: 8590/8991 (95.5400%)
time spent on training: 79.70059514045715
[foolsgold agg] training data poison_ratio: 0.39871273712737126  data num: [582, 583, 600, 592, 606, 593, 576, 595, 587, 590]
[foolsgold agg] considering poison per batch poison_fraction: 0.39871273712737126
[foolsgold agg] wv: [0.99060402 1.         1.         1.         0.92451192 1.
 0.65831816 1.         1.         0.65831816]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.3970, Accuracy: 8730/10000 (87.3000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.4119, Accuracy: 7829/8991 (87.0760%)
Done in 116.63764214515686 sec.
Server Epoch:31 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
___Train Local_Simple,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0048, Accuracy: 534/592 (90.2027%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3067, Accuracy: 9029/10000 (90.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0059, Accuracy: 531/590 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4207, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0012, Accuracy: 397/407 (97.5430%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.7681, Accuracy: 8072/10000 (80.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 85, internal_epoch   1,  Average loss: 0.0072, Accuracy: 522/590 (88.4746%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3230, Accuracy: 9137/10000 (91.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0048, Accuracy: 547/602 (90.8638%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3410, Accuracy: 8929/10000 (89.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 532/589 (90.3226%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3489, Accuracy: 8810/10000 (88.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 24, internal_epoch   1,  Average loss: 0.0084, Accuracy: 513/596 (86.0738%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3269, Accuracy: 9012/10000 (90.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0053, Accuracy: 542/609 (88.9984%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3315, Accuracy: 8980/10000 (89.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0065, Accuracy: 528/595 (88.7395%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2243, Accuracy: 9391/10000 (93.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 25, internal_epoch   1,  Average loss: 0.0051, Accuracy: 534/589 (90.6621%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4508, Accuracy: 8343/10000 (83.4300%), Attack Success Rate:0/10000(0.000)
time spent on training: 38.94072723388672
[foolsgold agg] training data poison_ratio: 0.0  data num: [592, 590, 407, 590, 602, 589, 596, 609, 595, 589]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         0.360508   1.
 0.54600772 0.360508   1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.3109, Accuracy: 9023/10000 (90.2300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.4450, Accuracy: 7677/8991 (85.3854%)
Done in 75.71877908706665 sec.
Server Epoch:32 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 485/525 (92.3810%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4742, Accuracy: 8443/10000 (84.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.0042, Accuracy: 549/591 (92.8934%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2177, Accuracy: 9413/10000 (94.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 540/592 (91.2162%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3666, Accuracy: 8868/10000 (88.6800%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   1,  Average loss: 0.0042, Accuracy: 542/596 (90.9396%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   2,  Average loss: 0.0036, Accuracy: 558/596 (93.6242%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   3,  Average loss: 0.0023, Accuracy: 572/596 (95.9732%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   4,  Average loss: 0.0013, Accuracy: 586/596 (98.3221%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   5,  Average loss: 0.0009, Accuracy: 590/596 (98.9933%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   6,  Average loss: 0.0009, Accuracy: 591/596 (99.1611%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   7,  Average loss: 0.0008, Accuracy: 593/596 (99.4966%), train_poison_data_count: 596
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   8,  Average loss: 0.0006, Accuracy: 593/596 (99.4966%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   9,  Average loss: 0.0005, Accuracy: 593/596 (99.4966%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch  10,  Average loss: 0.0006, Accuracy: 593/596 (99.4966%), train_poison_data_count: 596
Global model norm: 15.415488423179958.
Norm before scaling: 15.569901877739046. Distance: 1.9392056494536114
Total norm for 3 adversaries is: 15.569901877739046. distance: 1.9392056494536114
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.1158, Accuracy: 8661/8991 (96.3297%)
___Train Local_Simple,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0038, Accuracy: 544/579 (93.9551%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2346, Accuracy: 9303/10000 (93.0300%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 557/587 (94.8893%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   2,  Average loss: 0.0011, Accuracy: 572/587 (97.4446%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   3,  Average loss: 0.0008, Accuracy: 576/587 (98.1261%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   4,  Average loss: 0.0005, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   5,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   6,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   7,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   8,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   9,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch  10,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Global model norm: 15.415488423179958.
Norm before scaling: 15.478870387298837. Distance: 1.7208342659172629
Total norm for 3 adversaries is: 15.478870387298837. distance: 1.7208342659172629
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.1400, Accuracy: 8632/8991 (96.0071%)
___Train Local_Simple,  epoch  32, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 543/584 (92.9795%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2796, Accuracy: 9156/10000 (91.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 86, internal_epoch   1,  Average loss: 0.0034, Accuracy: 553/597 (92.6298%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2793, Accuracy: 9038/10000 (90.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 67, internal_epoch   1,  Average loss: 0.0035, Accuracy: 535/584 (91.6096%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2892, Accuracy: 9095/10000 (90.9500%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0033, Accuracy: 551/591 (93.2318%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   2,  Average loss: 0.0015, Accuracy: 578/591 (97.8003%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   3,  Average loss: 0.0007, Accuracy: 586/591 (99.1540%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   4,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   5,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   6,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   7,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%), train_poison_data_count: 591
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   8,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   9,  Average loss: 0.0003, Accuracy: 591/591 (100.0000%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch  10,  Average loss: 0.0003, Accuracy: 591/591 (100.0000%), train_poison_data_count: 591
Global model norm: 15.415488423179958.
Norm before scaling: 15.502759626281813. Distance: 1.5687202997929695
Total norm for 3 adversaries is: 15.502759626281813. distance: 1.5687202997929695
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.1382, Accuracy: 8637/8991 (96.0627%)
time spent on training: 70.76847887039185
[foolsgold agg] training data poison_ratio: 0.3044970820460007  data num: [525, 591, 592, 596, 579, 587, 584, 597, 584, 591]
[foolsgold agg] considering poison per batch poison_fraction: 0.3044970820460007
[foolsgold agg] wv: [1.         1.         0.11089266 0.43938294 1.         0.67553667
 1.         0.11089266 1.         0.43938294]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.3093, Accuracy: 9034/10000 (90.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.4429, Accuracy: 7695/8991 (85.5856%)
Done in 109.04534602165222 sec.
Server Epoch:33 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
___Train Local_Simple,  epoch  33, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 540/583 (92.6244%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2050, Accuracy: 9356/10000 (93.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 552/594 (92.9293%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2325, Accuracy: 9262/10000 (92.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 21, internal_epoch   1,  Average loss: 0.0058, Accuracy: 523/592 (88.3446%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2904, Accuracy: 9156/10000 (91.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.0043, Accuracy: 539/584 (92.2945%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2781, Accuracy: 9198/10000 (91.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 565/593 (95.2782%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2071, Accuracy: 9361/10000 (93.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 97, internal_epoch   1,  Average loss: 0.0031, Accuracy: 498/536 (92.9104%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3394, Accuracy: 8919/10000 (89.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0059, Accuracy: 530/584 (90.7534%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3436, Accuracy: 8897/10000 (88.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 22, internal_epoch   1,  Average loss: 0.0046, Accuracy: 553/591 (93.5702%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1966, Accuracy: 9453/10000 (94.5300%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   1,  Average loss: 0.0043, Accuracy: 547/596 (91.7785%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   2,  Average loss: 0.0024, Accuracy: 568/596 (95.3020%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   3,  Average loss: 0.0009, Accuracy: 589/596 (98.8255%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   4,  Average loss: 0.0008, Accuracy: 591/596 (99.1611%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   5,  Average loss: 0.0007, Accuracy: 591/596 (99.1611%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   6,  Average loss: 0.0006, Accuracy: 592/596 (99.3289%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   7,  Average loss: 0.0005, Accuracy: 593/596 (99.4966%), train_poison_data_count: 596
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   8,  Average loss: 0.0004, Accuracy: 594/596 (99.6644%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   9,  Average loss: 0.0004, Accuracy: 595/596 (99.8322%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch  10,  Average loss: 0.0004, Accuracy: 595/596 (99.8322%), train_poison_data_count: 596
Global model norm: 15.437988273528186.
Norm before scaling: 15.589255011903932. Distance: 1.8899857252076395
Total norm for 1 adversaries is: 15.589255011903932. distance: 1.8899857252076395
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.1221, Accuracy: 8656/8991 (96.2741%)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0048, Accuracy: 483/525 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5115, Accuracy: 8292/10000 (82.9200%), Attack Success Rate:0/10000(0.000)
time spent on training: 50.757237911224365
[foolsgold agg] training data poison_ratio: 0.10314987885081343  data num: [583, 594, 592, 584, 593, 536, 584, 591, 596, 525]
[foolsgold agg] considering poison per batch poison_fraction: 0.10314987885081343
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.2772, Accuracy: 9123/10000 (91.2300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.4451, Accuracy: 7658/8991 (85.1741%)
Done in 89.4479763507843 sec.
Server Epoch:34 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
___Train Local_Simple,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0043, Accuracy: 554/594 (93.2660%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1666, Accuracy: 9498/10000 (94.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 563/609 (92.4466%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2231, Accuracy: 9346/10000 (93.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0035, Accuracy: 565/607 (93.0807%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2158, Accuracy: 9350/10000 (93.5000%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 548/582 (94.1581%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0023, Accuracy: 556/582 (95.5326%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   3,  Average loss: 0.0025, Accuracy: 554/582 (95.1890%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   4,  Average loss: 0.0008, Accuracy: 574/582 (98.6254%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   5,  Average loss: 0.0006, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   6,  Average loss: 0.0005, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   7,  Average loss: 0.0004, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   8,  Average loss: 0.0003, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   9,  Average loss: 0.0003, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch  10,  Average loss: 0.0003, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 15.459026201183152.
Norm before scaling: 15.590332145945398. Distance: 1.6704801641232523
Total norm for 2 adversaries is: 15.590332145945398. distance: 1.6704801641232523
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1242, Accuracy: 8652/8991 (96.2296%)
___Train Local_Simple,  epoch  34, local model 71, internal_epoch   1,  Average loss: 0.0037, Accuracy: 564/608 (92.7632%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1957, Accuracy: 9357/10000 (93.5700%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   1,  Average loss: 0.0032, Accuracy: 565/595 (94.9580%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   2,  Average loss: 0.0021, Accuracy: 576/595 (96.8067%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   3,  Average loss: 0.0012, Accuracy: 584/595 (98.1513%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   4,  Average loss: 0.0007, Accuracy: 590/595 (99.1597%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   5,  Average loss: 0.0006, Accuracy: 590/595 (99.1597%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   6,  Average loss: 0.0005, Accuracy: 591/595 (99.3277%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   7,  Average loss: 0.0004, Accuracy: 591/595 (99.3277%), train_poison_data_count: 595
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   8,  Average loss: 0.0004, Accuracy: 591/595 (99.3277%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   9,  Average loss: 0.0004, Accuracy: 593/595 (99.6639%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch  10,  Average loss: 0.0004, Accuracy: 593/595 (99.6639%), train_poison_data_count: 595
Global model norm: 15.459026201183152.
Norm before scaling: 15.531879251117331. Distance: 1.6399355938522837
Total norm for 2 adversaries is: 15.531879251117331. distance: 1.6399355938522837
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1201, Accuracy: 8656/8991 (96.2741%)
___Train Local_Simple,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0033, Accuracy: 566/609 (92.9392%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1698, Accuracy: 9491/10000 (94.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 541/598 (90.4682%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3067, Accuracy: 9053/10000 (90.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.0045, Accuracy: 539/584 (92.2945%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1965, Accuracy: 9426/10000 (94.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 48, internal_epoch   1,  Average loss: 0.0045, Accuracy: 535/588 (90.9864%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2501, Accuracy: 9238/10000 (92.3800%), Attack Success Rate:0/10000(0.000)
time spent on training: 61.170047998428345
[foolsgold agg] training data poison_ratio: 0.19702042182792098  data num: [594, 609, 607, 582, 608, 595, 609, 598, 584, 588]
[foolsgold agg] considering poison per batch poison_fraction: 0.19702042182792098
[foolsgold agg] wv: [1.         1.         0.99902091 0.99902091 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.2789, Accuracy: 9124/10000 (91.2400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.4468, Accuracy: 7655/8991 (85.1407%)
Done in 99.41121983528137 sec.
Server Epoch:35 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   1,  Average loss: 0.0032, Accuracy: 537/582 (92.2680%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   2,  Average loss: 0.0020, Accuracy: 556/582 (95.5326%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   3,  Average loss: 0.0011, Accuracy: 570/582 (97.9381%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   4,  Average loss: 0.0006, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   5,  Average loss: 0.0004, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   6,  Average loss: 0.0005, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   7,  Average loss: 0.0003, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   8,  Average loss: 0.0003, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   9,  Average loss: 0.0002, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch  10,  Average loss: 0.0002, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 15.495988880569021.
Norm before scaling: 15.615691074661338. Distance: 1.7373128529485948
Total norm for 2 adversaries is: 15.615691074661338. distance: 1.7373128529485948
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1262, Accuracy: 8649/8991 (96.1962%)
___Train Local_Simple,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0042, Accuracy: 546/596 (91.6107%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2327, Accuracy: 9256/10000 (92.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 531/585 (90.7692%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2469, Accuracy: 9267/10000 (92.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.0057, Accuracy: 535/584 (91.6096%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2121, Accuracy: 9382/10000 (93.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 549/598 (91.8060%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2881, Accuracy: 9024/10000 (90.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 25, internal_epoch   1,  Average loss: 0.0045, Accuracy: 540/589 (91.6808%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3656, Accuracy: 8675/10000 (86.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0053, Accuracy: 520/579 (89.8100%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3358, Accuracy: 8980/10000 (89.8000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 537/595 (90.2521%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   2,  Average loss: 0.0032, Accuracy: 567/595 (95.2941%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   3,  Average loss: 0.0018, Accuracy: 584/595 (98.1513%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   4,  Average loss: 0.0013, Accuracy: 585/595 (98.3193%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   5,  Average loss: 0.0011, Accuracy: 585/595 (98.3193%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   6,  Average loss: 0.0010, Accuracy: 587/595 (98.6555%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   7,  Average loss: 0.0009, Accuracy: 588/595 (98.8235%), train_poison_data_count: 595
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   8,  Average loss: 0.0010, Accuracy: 589/595 (98.9916%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   9,  Average loss: 0.0008, Accuracy: 590/595 (99.1597%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch  10,  Average loss: 0.0007, Accuracy: 590/595 (99.1597%), train_poison_data_count: 595
Global model norm: 15.495988880569021.
Norm before scaling: 15.614176426989804. Distance: 2.0031996405110633
Total norm for 2 adversaries is: 15.614176426989804. distance: 2.0031996405110633
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1183, Accuracy: 8640/8991 (96.0961%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0056, Accuracy: 538/586 (91.8089%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2735, Accuracy: 9164/10000 (91.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 472/497 (94.9698%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2316, Accuracy: 9226/10000 (92.2600%), Attack Success Rate:0/10000(0.000)
time spent on training: 61.25376319885254
[foolsgold agg] training data poison_ratio: 0.20324641685373857  data num: [582, 596, 585, 584, 598, 589, 579, 595, 586, 497]
[foolsgold agg] considering poison per batch poison_fraction: 0.20324641685373857
[foolsgold agg] wv: [0.93389199 0.36415856 1.         1.         1.         1.
 1.         0.93389199 0.36415856 1.        ]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.3260, Accuracy: 8900/10000 (89.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.3285, Accuracy: 7998/8991 (88.9556%)
Done in 100.70411109924316 sec.
Server Epoch:36 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  36, local model 82, internal_epoch   1,  Average loss: 0.0036, Accuracy: 555/593 (93.5919%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1719, Accuracy: 9518/10000 (95.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 553/602 (91.8605%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2404, Accuracy: 9269/10000 (92.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 79, internal_epoch   1,  Average loss: 0.0054, Accuracy: 524/584 (89.7260%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3032, Accuracy: 9026/10000 (90.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0039, Accuracy: 556/601 (92.5125%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1955, Accuracy: 9417/10000 (94.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 47, internal_epoch   1,  Average loss: 0.0048, Accuracy: 532/586 (90.7850%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4420, Accuracy: 8521/10000 (85.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 44, internal_epoch   1,  Average loss: 0.0041, Accuracy: 552/598 (92.3077%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2041, Accuracy: 9360/10000 (93.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 89, internal_epoch   1,  Average loss: 0.0055, Accuracy: 533/593 (89.8820%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2854, Accuracy: 9124/10000 (91.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 48, internal_epoch   1,  Average loss: 0.0042, Accuracy: 544/588 (92.5170%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2493, Accuracy: 9166/10000 (91.6600%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   1,  Average loss: 0.0037, Accuracy: 546/596 (91.6107%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   2,  Average loss: 0.0023, Accuracy: 566/596 (94.9664%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   3,  Average loss: 0.0012, Accuracy: 586/596 (98.3221%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   4,  Average loss: 0.0007, Accuracy: 591/596 (99.1611%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   5,  Average loss: 0.0005, Accuracy: 595/596 (99.8322%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   6,  Average loss: 0.0004, Accuracy: 595/596 (99.8322%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   7,  Average loss: 0.0004, Accuracy: 594/596 (99.6644%), train_poison_data_count: 596
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   8,  Average loss: 0.0004, Accuracy: 594/596 (99.6644%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   9,  Average loss: 0.0003, Accuracy: 595/596 (99.8322%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch  10,  Average loss: 0.0003, Accuracy: 595/596 (99.8322%), train_poison_data_count: 596
Global model norm: 15.532682356612018.
Norm before scaling: 15.66172831735753. Distance: 1.7095757207934204
Total norm for 1 adversaries is: 15.66172831735753. distance: 1.7095757207934204
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1134, Accuracy: 8683/8991 (96.5744%)
___Train Local_Simple,  epoch  36, local model 77, internal_epoch   1,  Average loss: 0.0040, Accuracy: 535/583 (91.7667%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2103, Accuracy: 9329/10000 (93.2900%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.79547095298767
[foolsgold agg] training data poison_ratio: 0.10060769750168805  data num: [593, 602, 584, 601, 586, 598, 593, 588, 596, 583]
[foolsgold agg] considering poison per batch poison_fraction: 0.10060769750168805
[foolsgold agg] wv: [0.82172145 0.65201105 1.         1.         0.82172145 1.
 1.         1.         1.         0.65201105]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.2908, Accuracy: 9068/10000 (90.6800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.3595, Accuracy: 7882/8991 (87.6654%)
Done in 91.17391324043274 sec.
Server Epoch:37 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
___Train Local_Simple,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 545/593 (91.9056%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2365, Accuracy: 9242/10000 (92.4200%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0036, Accuracy: 556/590 (94.2373%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0017, Accuracy: 573/590 (97.1186%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   3,  Average loss: 0.0010, Accuracy: 581/590 (98.4746%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   4,  Average loss: 0.0007, Accuracy: 587/590 (99.4915%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   5,  Average loss: 0.0004, Accuracy: 587/590 (99.4915%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   6,  Average loss: 0.0004, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   7,  Average loss: 0.0003, Accuracy: 590/590 (100.0000%), train_poison_data_count: 590
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   8,  Average loss: 0.0003, Accuracy: 590/590 (100.0000%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   9,  Average loss: 0.0003, Accuracy: 590/590 (100.0000%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch  10,  Average loss: 0.0003, Accuracy: 590/590 (100.0000%), train_poison_data_count: 590
Global model norm: 15.559198849016687.
Norm before scaling: 15.640857187961878. Distance: 1.8498576882758222
Total norm for 1 adversaries is: 15.640857187961878. distance: 1.8498576882758222
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1308, Accuracy: 8628/8991 (95.9626%)
___Train Local_Simple,  epoch  37, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 552/598 (92.3077%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2342, Accuracy: 9250/10000 (92.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0036, Accuracy: 559/607 (92.0923%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2360, Accuracy: 9304/10000 (93.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 546/588 (92.8571%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2108, Accuracy: 9298/10000 (92.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 52, internal_epoch   1,  Average loss: 0.0031, Accuracy: 556/595 (93.4454%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2463, Accuracy: 9236/10000 (92.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.0036, Accuracy: 557/595 (93.6134%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1880, Accuracy: 9415/10000 (94.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 543/584 (92.9795%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.9135, Accuracy: 6902/10000 (69.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 541/589 (91.8506%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2901, Accuracy: 9104/10000 (91.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0038, Accuracy: 545/583 (93.4820%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2409, Accuracy: 9254/10000 (92.5400%), Attack Success Rate:0/10000(0.000)
time spent on training: 50.059415102005005
[foolsgold agg] training data poison_ratio: 0.09962850388382304  data num: [593, 590, 598, 607, 588, 595, 595, 584, 589, 583]
[foolsgold agg] considering poison per batch poison_fraction: 0.09962850388382304
[foolsgold agg] wv: [1.       1.       1.       1.       1.       1.       1.       1.
 0.946928 0.946928]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.2938, Accuracy: 9029/10000 (90.2900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.3148, Accuracy: 8008/8991 (89.0668%)
Done in 87.36280083656311 sec.
Server Epoch:38 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
___Train Local_Simple,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 535/583 (91.7667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3023, Accuracy: 8947/10000 (89.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 29, internal_epoch   1,  Average loss: 0.0041, Accuracy: 549/586 (93.6860%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2803, Accuracy: 8992/10000 (89.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0041, Accuracy: 559/591 (94.5854%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2280, Accuracy: 9234/10000 (92.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0051, Accuracy: 551/600 (91.8333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2564, Accuracy: 9216/10000 (92.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 540/585 (92.3077%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3673, Accuracy: 8757/10000 (87.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 83, internal_epoch   1,  Average loss: 0.0047, Accuracy: 542/598 (90.6355%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1906, Accuracy: 9462/10000 (94.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0044, Accuracy: 543/595 (91.2605%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2088, Accuracy: 9338/10000 (93.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 45, internal_epoch   1,  Average loss: 0.0038, Accuracy: 545/587 (92.8450%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1725, Accuracy: 9472/10000 (94.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 534/595 (89.7479%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4656, Accuracy: 8530/10000 (85.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0029, Accuracy: 560/588 (95.2381%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1388, Accuracy: 9535/10000 (95.3500%), Attack Success Rate:0/10000(0.000)
time spent on training: 38.8873507976532
[foolsgold agg] training data poison_ratio: 0.0  data num: [583, 586, 591, 600, 585, 598, 595, 587, 595, 588]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.2685, Accuracy: 9187/10000 (91.8700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.4246, Accuracy: 7722/8991 (85.8859%)
Done in 77.6541588306427 sec.
Server Epoch:39 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
___Train Local_Simple,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 542/585 (92.6496%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2267, Accuracy: 9350/10000 (93.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 34, internal_epoch   1,  Average loss: 0.0031, Accuracy: 559/593 (94.2664%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2007, Accuracy: 9321/10000 (93.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 32, internal_epoch   1,  Average loss: 0.0034, Accuracy: 558/601 (92.8453%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2022, Accuracy: 9359/10000 (93.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0045, Accuracy: 546/588 (92.8571%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2257, Accuracy: 9312/10000 (93.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0041, Accuracy: 556/600 (92.6667%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2670, Accuracy: 9220/10000 (92.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 570/593 (96.1214%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1799, Accuracy: 9454/10000 (94.5400%), Attack Success Rate:0/10000(0.000)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   1,  Average loss: 0.0037, Accuracy: 531/576 (92.1875%), train_poison_data_count: 576
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   2,  Average loss: 0.0018, Accuracy: 555/576 (96.3542%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   3,  Average loss: 0.0011, Accuracy: 565/576 (98.0903%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   4,  Average loss: 0.0009, Accuracy: 565/576 (98.0903%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   5,  Average loss: 0.0007, Accuracy: 567/576 (98.4375%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   6,  Average loss: 0.0006, Accuracy: 571/576 (99.1319%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   7,  Average loss: 0.0006, Accuracy: 571/576 (99.1319%), train_poison_data_count: 576
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   8,  Average loss: 0.0005, Accuracy: 573/576 (99.4792%), train_poison_data_count: 576
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   9,  Average loss: 0.0005, Accuracy: 574/576 (99.6528%), train_poison_data_count: 576
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch  10,  Average loss: 0.0005, Accuracy: 574/576 (99.6528%), train_poison_data_count: 576
Global model norm: 15.59646515534199.
Norm before scaling: 15.665903979194804. Distance: 1.6089246545698284
Total norm for 1 adversaries is: 15.665903979194804. distance: 1.6089246545698284
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1043, Accuracy: 8689/8991 (96.6411%)
___Train Local_Simple,  epoch  39, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 537/582 (92.2680%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3547, Accuracy: 8856/10000 (88.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0039, Accuracy: 557/596 (93.4564%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2563, Accuracy: 9163/10000 (91.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0043, Accuracy: 559/602 (92.8571%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2113, Accuracy: 9350/10000 (93.5000%), Attack Success Rate:0/10000(0.000)
time spent on training: 50.56543207168579
[foolsgold agg] training data poison_ratio: 0.0973630831643002  data num: [585, 593, 601, 588, 600, 593, 576, 582, 596, 602]
[foolsgold agg] considering poison per batch poison_fraction: 0.0973630831643002
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.2749, Accuracy: 9123/10000 (91.2300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.3492, Accuracy: 7886/8991 (87.7099%)
Done in 88.8637330532074 sec.
Server Epoch:40 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
___Train Local_Simple,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 528/581 (90.8778%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2106, Accuracy: 9361/10000 (93.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 23, internal_epoch   1,  Average loss: 0.0042, Accuracy: 546/595 (91.7647%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2112, Accuracy: 9364/10000 (93.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 87, internal_epoch   1,  Average loss: 0.0035, Accuracy: 558/591 (94.4162%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2767, Accuracy: 9156/10000 (91.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 98, internal_epoch   1,  Average loss: 0.0027, Accuracy: 472/497 (94.9698%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2184, Accuracy: 9272/10000 (92.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0041, Accuracy: 553/595 (92.9412%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2253, Accuracy: 9292/10000 (92.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 547/598 (91.4716%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2489, Accuracy: 9334/10000 (93.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 561/595 (94.2857%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2592, Accuracy: 9199/10000 (91.9900%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   1,  Average loss: 0.0021, Accuracy: 563/587 (95.9114%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   2,  Average loss: 0.0012, Accuracy: 572/587 (97.4446%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   3,  Average loss: 0.0013, Accuracy: 571/587 (97.2743%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   4,  Average loss: 0.0005, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   5,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   6,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   7,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   8,  Average loss: 0.0002, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   9,  Average loss: 0.0002, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch  10,  Average loss: 0.0002, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 15.617174798331503.
Norm before scaling: 15.687309355166281. Distance: 1.331947346391236
Total norm for 1 adversaries is: 15.687309355166281. distance: 1.331947346391236
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.1180, Accuracy: 8693/8991 (96.6856%)
___Train Local_Simple,  epoch  40, local model 71, internal_epoch   1,  Average loss: 0.0025, Accuracy: 576/608 (94.7368%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1639, Accuracy: 9471/10000 (94.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0040, Accuracy: 549/589 (93.2088%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2312, Accuracy: 9288/10000 (92.8800%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.07689332962036
[foolsgold agg] training data poison_ratio: 0.10058259081562715  data num: [581, 595, 591, 497, 595, 598, 595, 587, 608, 589]
[foolsgold agg] considering poison per batch poison_fraction: 0.10058259081562715
[foolsgold agg] wv: [0.7426337 1.        1.        1.        1.        1.        1.
 1.        1.        0.7426337]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.2499, Accuracy: 9205/10000 (92.0500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.3462, Accuracy: 7891/8991 (87.7655%)
Done in 89.25640511512756 sec.
Server Epoch:41 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
___Train Local_Simple,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 554/595 (93.1092%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2324, Accuracy: 9292/10000 (92.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 28, internal_epoch   1,  Average loss: 0.0040, Accuracy: 537/584 (91.9521%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2004, Accuracy: 9360/10000 (93.6000%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 563/591 (95.2623%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   2,  Average loss: 0.0020, Accuracy: 567/591 (95.9391%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   3,  Average loss: 0.0011, Accuracy: 579/591 (97.9695%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   4,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   5,  Average loss: 0.0004, Accuracy: 590/591 (99.8308%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   6,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   7,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 591
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   8,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   9,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch  10,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%), train_poison_data_count: 591
Global model norm: 15.637729189967128.
Norm before scaling: 15.725041065253414. Distance: 1.6169130396487792
Total norm for 1 adversaries is: 15.725041065253414. distance: 1.6169130396487792
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1225, Accuracy: 8666/8991 (96.3853%)
___Train Local_Simple,  epoch  41, local model 95, internal_epoch   1,  Average loss: 0.0042, Accuracy: 504/540 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2297, Accuracy: 9233/10000 (92.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 83, internal_epoch   1,  Average loss: 0.0043, Accuracy: 550/598 (91.9732%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2283, Accuracy: 9281/10000 (92.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 534/583 (91.5952%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2826, Accuracy: 9157/10000 (91.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 551/592 (93.0743%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1922, Accuracy: 9473/10000 (94.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0038, Accuracy: 567/609 (93.1034%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2563, Accuracy: 9240/10000 (92.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 29, internal_epoch   1,  Average loss: 0.0036, Accuracy: 549/586 (93.6860%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2265, Accuracy: 9276/10000 (92.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 46, internal_epoch   1,  Average loss: 0.0048, Accuracy: 553/599 (92.3205%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2469, Accuracy: 9316/10000 (93.1600%), Attack Success Rate:0/10000(0.000)
time spent on training: 50.70334839820862
[foolsgold agg] training data poison_ratio: 0.10056151097498724  data num: [595, 584, 591, 540, 598, 583, 592, 609, 586, 599]
[foolsgold agg] considering poison per batch poison_fraction: 0.10056151097498724
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.49571568 0.49571568 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.2531, Accuracy: 9220/10000 (92.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.3982, Accuracy: 7781/8991 (86.5421%)
Done in 90.8562262058258 sec.
Server Epoch:42 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0027, Accuracy: 565/591 (95.6007%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2047, Accuracy: 9357/10000 (93.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 565/600 (94.1667%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1969, Accuracy: 9351/10000 (93.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 89, internal_epoch   1,  Average loss: 0.0034, Accuracy: 553/593 (93.2546%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2669, Accuracy: 9142/10000 (91.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0062, Accuracy: 530/588 (90.1361%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3876, Accuracy: 8633/10000 (86.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0044, Accuracy: 537/591 (90.8629%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2928, Accuracy: 9057/10000 (90.5700%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 569/606 (93.8944%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   2,  Average loss: 0.0015, Accuracy: 587/606 (96.8647%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   3,  Average loss: 0.0008, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   4,  Average loss: 0.0006, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   5,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   6,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   7,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   8,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   9,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch  10,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Global model norm: 15.656317735475978.
Norm before scaling: 15.717831169560407. Distance: 1.493292673882932
Total norm for 1 adversaries is: 15.717831169560407. distance: 1.493292673882932
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1035, Accuracy: 8692/8991 (96.6745%)
___Train Local_Simple,  epoch  42, local model 92, internal_epoch   1,  Average loss: 0.0031, Accuracy: 506/535 (94.5794%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2050, Accuracy: 9275/10000 (92.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 62, internal_epoch   1,  Average loss: 0.0038, Accuracy: 556/589 (94.3973%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1675, Accuracy: 9476/10000 (94.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 545/584 (93.3219%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1581, Accuracy: 9494/10000 (94.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0052, Accuracy: 538/586 (91.8089%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2222, Accuracy: 9371/10000 (93.7100%), Attack Success Rate:0/10000(0.000)
time spent on training: 49.376302003860474
[foolsgold agg] training data poison_ratio: 0.10336005457956678  data num: [591, 600, 593, 588, 591, 606, 535, 589, 584, 586]
[foolsgold agg] considering poison per batch poison_fraction: 0.10336005457956678
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.2478, Accuracy: 9237/10000 (92.3700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.3930, Accuracy: 7799/8991 (86.7423%)
Done in 86.48922801017761 sec.
Server Epoch:43 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
___Train Local_Simple,  epoch  43, local model 38, internal_epoch   1,  Average loss: 0.0029, Accuracy: 549/591 (92.8934%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2089, Accuracy: 9323/10000 (93.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 78, internal_epoch   1,  Average loss: 0.0045, Accuracy: 544/600 (90.6667%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2916, Accuracy: 9122/10000 (91.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 542/584 (92.8082%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2327, Accuracy: 9288/10000 (92.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0037, Accuracy: 545/583 (93.4820%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2251, Accuracy: 9281/10000 (92.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0040, Accuracy: 552/596 (92.6174%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2585, Accuracy: 9181/10000 (91.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 75, internal_epoch   1,  Average loss: 0.0047, Accuracy: 536/595 (90.0840%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2490, Accuracy: 9233/10000 (92.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0043, Accuracy: 486/525 (92.5714%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2630, Accuracy: 9176/10000 (91.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 39, internal_epoch   1,  Average loss: 0.0038, Accuracy: 537/583 (92.1098%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1555, Accuracy: 9567/10000 (95.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 559/598 (93.4783%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1933, Accuracy: 9388/10000 (93.8800%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   1,  Average loss: 0.0026, Accuracy: 561/587 (95.5707%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   2,  Average loss: 0.0015, Accuracy: 568/587 (96.7632%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   3,  Average loss: 0.0008, Accuracy: 576/587 (98.1261%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   4,  Average loss: 0.0004, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   5,  Average loss: 0.0003, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   6,  Average loss: 0.0003, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   7,  Average loss: 0.0002, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   8,  Average loss: 0.0002, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   9,  Average loss: 0.0002, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch  10,  Average loss: 0.0002, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 15.676457260996802.
Norm before scaling: 15.732361620190323. Distance: 1.4485405417191568
Total norm for 1 adversaries is: 15.732361620190323. distance: 1.4485405417191568
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1262, Accuracy: 8660/8991 (96.3185%)
time spent on training: 48.9200177192688
[foolsgold agg] training data poison_ratio: 0.10047928791509757  data num: [591, 600, 584, 583, 596, 595, 525, 583, 598, 587]
[foolsgold agg] considering poison per batch poison_fraction: 0.10047928791509757
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.2681, Accuracy: 9166/10000 (91.6600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.4209, Accuracy: 7739/8991 (86.0750%)
Done in 86.78246808052063 sec.
Server Epoch:44 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
___Train Local_Simple,  epoch  44, local model 31, internal_epoch   1,  Average loss: 0.0033, Accuracy: 558/599 (93.1553%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2384, Accuracy: 9261/10000 (92.6100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0047, Accuracy: 551/595 (92.6050%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   2,  Average loss: 0.0021, Accuracy: 576/595 (96.8067%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   3,  Average loss: 0.0013, Accuracy: 580/595 (97.4790%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   4,  Average loss: 0.0011, Accuracy: 583/595 (97.9832%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   5,  Average loss: 0.0012, Accuracy: 587/595 (98.6555%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   6,  Average loss: 0.0009, Accuracy: 589/595 (98.9916%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   7,  Average loss: 0.0007, Accuracy: 590/595 (99.1597%), train_poison_data_count: 595
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   8,  Average loss: 0.0006, Accuracy: 590/595 (99.1597%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   9,  Average loss: 0.0006, Accuracy: 591/595 (99.3277%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch  10,  Average loss: 0.0005, Accuracy: 591/595 (99.3277%), train_poison_data_count: 595
Global model norm: 15.695958505402603.
Norm before scaling: 15.775319410859751. Distance: 1.7732619144045352
Total norm for 1 adversaries is: 15.775319410859751. distance: 1.7732619144045352
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1029, Accuracy: 8682/8991 (96.5632%)
___Train Local_Simple,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0033, Accuracy: 547/591 (92.5550%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1435, Accuracy: 9555/10000 (95.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 548/590 (92.8814%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1948, Accuracy: 9405/10000 (94.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 552/598 (92.3077%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2701, Accuracy: 9112/10000 (91.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0027, Accuracy: 565/595 (94.9580%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2473, Accuracy: 9226/10000 (92.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 65, internal_epoch   1,  Average loss: 0.0028, Accuracy: 557/586 (95.0512%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2415, Accuracy: 9257/10000 (92.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 66, internal_epoch   1,  Average loss: 0.0028, Accuracy: 563/602 (93.5216%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3634, Accuracy: 8804/10000 (88.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0045, Accuracy: 554/600 (92.3333%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1726, Accuracy: 9483/10000 (94.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0037, Accuracy: 540/579 (93.2642%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.0702, Accuracy: 8136/10000 (81.3600%), Attack Success Rate:1/10000(0.010)
time spent on training: 49.234659910202026
[foolsgold agg] training data poison_ratio: 0.10025273799494525  data num: [599, 595, 591, 590, 598, 595, 586, 602, 600, 579]
[foolsgold agg] considering poison per batch poison_fraction: 0.10025273799494525
[foolsgold agg] wv: [1.         1.         1.         0.74154243 0.74154243 1.
 0.89431825 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.2397, Accuracy: 9270/10000 (92.7000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.4391, Accuracy: 7728/8991 (85.9526%)
Done in 86.23524570465088 sec.
Server Epoch:45 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 548/585 (93.6752%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2962, Accuracy: 9030/10000 (90.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 75, internal_epoch   1,  Average loss: 0.0031, Accuracy: 559/595 (93.9496%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1972, Accuracy: 9411/10000 (94.1100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0047, Accuracy: 548/595 (92.1008%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0033, Accuracy: 556/595 (93.4454%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   3,  Average loss: 0.0015, Accuracy: 583/595 (97.9832%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   4,  Average loss: 0.0012, Accuracy: 585/595 (98.3193%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   5,  Average loss: 0.0009, Accuracy: 586/595 (98.4874%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   6,  Average loss: 0.0008, Accuracy: 589/595 (98.9916%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   7,  Average loss: 0.0008, Accuracy: 589/595 (98.9916%), train_poison_data_count: 595
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   8,  Average loss: 0.0006, Accuracy: 590/595 (99.1597%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   9,  Average loss: 0.0006, Accuracy: 590/595 (99.1597%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch  10,  Average loss: 0.0005, Accuracy: 590/595 (99.1597%), train_poison_data_count: 595
Global model norm: 15.71580304833646.
Norm before scaling: 15.846135368079992. Distance: 2.0697990500541303
Total norm for 2 adversaries is: 15.846135368079992. distance: 2.0697990500541303
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1015, Accuracy: 8695/8991 (96.7078%)
___Train Local_Simple,  epoch  45, local model 37, internal_epoch   1,  Average loss: 0.0026, Accuracy: 563/594 (94.7811%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1320, Accuracy: 9599/10000 (95.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 94, internal_epoch   1,  Average loss: 0.0030, Accuracy: 507/536 (94.5896%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1934, Accuracy: 9371/10000 (93.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 554/595 (93.1092%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1695, Accuracy: 9492/10000 (94.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 29, internal_epoch   1,  Average loss: 0.0034, Accuracy: 551/586 (94.0273%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1837, Accuracy: 9397/10000 (93.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0041, Accuracy: 545/583 (93.4820%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2151, Accuracy: 9310/10000 (93.1000%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   1,  Average loss: 0.0028, Accuracy: 558/595 (93.7815%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   2,  Average loss: 0.0014, Accuracy: 582/595 (97.8151%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   3,  Average loss: 0.0007, Accuracy: 589/595 (98.9916%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   4,  Average loss: 0.0005, Accuracy: 591/595 (99.3277%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   5,  Average loss: 0.0005, Accuracy: 591/595 (99.3277%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   6,  Average loss: 0.0004, Accuracy: 592/595 (99.4958%), train_poison_data_count: 595
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   7,  Average loss: 0.0003, Accuracy: 593/595 (99.6639%), train_poison_data_count: 595
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   8,  Average loss: 0.0003, Accuracy: 594/595 (99.8319%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   9,  Average loss: 0.0003, Accuracy: 594/595 (99.8319%), train_poison_data_count: 595
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch  10,  Average loss: 0.0003, Accuracy: 594/595 (99.8319%), train_poison_data_count: 595
Global model norm: 15.71580304833646.
Norm before scaling: 15.814832191216198. Distance: 1.8477010902947852
Total norm for 2 adversaries is: 15.814832191216198. distance: 1.8477010902947852
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1158, Accuracy: 8677/8991 (96.5076%)
___Train Local_Simple,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 537/588 (91.3265%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1943, Accuracy: 9474/10000 (94.7400%), Attack Success Rate:0/10000(0.000)
time spent on training: 61.550382137298584
[foolsgold agg] training data poison_ratio: 0.20334928229665072  data num: [585, 595, 595, 594, 536, 595, 586, 583, 595, 588]
[foolsgold agg] considering poison per batch poison_fraction: 0.20334928229665072
[foolsgold agg] wv: [1.         1.         0.40674335 1.         1.         1.
 1.         1.         0.40674335 1.        ]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.2298, Accuracy: 9296/10000 (92.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.4298, Accuracy: 7754/8991 (86.2418%)
Done in 100.0903389453888 sec.
Server Epoch:46 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
___Train Local_Simple,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0043, Accuracy: 543/595 (91.2605%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2212, Accuracy: 9258/10000 (92.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 78, internal_epoch   1,  Average loss: 0.0041, Accuracy: 558/600 (93.0000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2243, Accuracy: 9303/10000 (93.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0023, Accuracy: 577/593 (97.3019%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3035, Accuracy: 9050/10000 (90.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 39, internal_epoch   1,  Average loss: 0.0028, Accuracy: 551/583 (94.5111%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1652, Accuracy: 9451/10000 (94.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0035, Accuracy: 548/586 (93.5154%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.5623, Accuracy: 8287/10000 (82.8700%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 572/606 (94.3894%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   2,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   3,  Average loss: 0.0010, Accuracy: 598/606 (98.6799%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   4,  Average loss: 0.0007, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   5,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   6,  Average loss: 0.0004, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   7,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   8,  Average loss: 0.0004, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   9,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch  10,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Global model norm: 15.733085632529551.
Norm before scaling: 15.803409179642813. Distance: 1.585875937483751
Total norm for 2 adversaries is: 15.803409179642813. distance: 1.585875937483751
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0976, Accuracy: 8703/8991 (96.7968%)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 539/576 (93.5764%), train_poison_data_count: 576
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   2,  Average loss: 0.0023, Accuracy: 554/576 (96.1806%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   3,  Average loss: 0.0010, Accuracy: 568/576 (98.6111%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   4,  Average loss: 0.0009, Accuracy: 571/576 (99.1319%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   5,  Average loss: 0.0007, Accuracy: 573/576 (99.4792%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   6,  Average loss: 0.0006, Accuracy: 574/576 (99.6528%), train_poison_data_count: 576
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   7,  Average loss: 0.0005, Accuracy: 574/576 (99.6528%), train_poison_data_count: 576
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   8,  Average loss: 0.0004, Accuracy: 574/576 (99.6528%), train_poison_data_count: 576
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   9,  Average loss: 0.0004, Accuracy: 574/576 (99.6528%), train_poison_data_count: 576
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch  10,  Average loss: 0.0004, Accuracy: 574/576 (99.6528%), train_poison_data_count: 576
Global model norm: 15.733085632529551.
Norm before scaling: 15.792692421215985. Distance: 1.590589793477024
Total norm for 2 adversaries is: 15.792692421215985. distance: 1.590589793477024
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0915, Accuracy: 8728/8991 (97.0749%)
___Train Local_Simple,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 547/588 (93.0272%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1836, Accuracy: 9498/10000 (94.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 68, internal_epoch   1,  Average loss: 0.0052, Accuracy: 542/591 (91.7090%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4417, Accuracy: 8528/10000 (85.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 54, internal_epoch   1,  Average loss: 0.0078, Accuracy: 540/577 (93.5875%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 8.5581, Accuracy: 1772/10000 (17.7200%), Attack Success Rate:17/10000(0.170)
time spent on training: 61.83562970161438
[foolsgold agg] training data poison_ratio: 0.2005089058524173  data num: [595, 600, 593, 583, 586, 606, 576, 588, 591, 577]
[foolsgold agg] considering poison per batch poison_fraction: 0.2005089058524173
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.49898839
 0.49898839 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.2885, Accuracy: 9017/10000 (90.1700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.2975, Accuracy: 8050/8991 (89.5340%)
Done in 100.54607677459717 sec.
Server Epoch:47 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  47, local model 94, internal_epoch   1,  Average loss: 0.0031, Accuracy: 505/536 (94.2164%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1901, Accuracy: 9372/10000 (93.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 48, internal_epoch   1,  Average loss: 0.0035, Accuracy: 551/588 (93.7075%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2172, Accuracy: 9249/10000 (92.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 82, internal_epoch   1,  Average loss: 0.0025, Accuracy: 562/593 (94.7723%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2439, Accuracy: 9237/10000 (92.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 25, internal_epoch   1,  Average loss: 0.0031, Accuracy: 553/589 (93.8879%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2436, Accuracy: 9250/10000 (92.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 532/584 (91.0959%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1779, Accuracy: 9445/10000 (94.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 553/594 (93.0976%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1873, Accuracy: 9416/10000 (94.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0026, Accuracy: 552/586 (94.1980%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2471, Accuracy: 9201/10000 (92.0100%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0020, Accuracy: 561/587 (95.5707%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   2,  Average loss: 0.0009, Accuracy: 577/587 (98.2964%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   3,  Average loss: 0.0008, Accuracy: 579/587 (98.6371%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   4,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   5,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   6,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   7,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   8,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   9,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch  10,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 15.750723201557138.
Norm before scaling: 15.815533132235409. Distance: 1.3389137977817391
Total norm for 1 adversaries is: 15.815533132235409. distance: 1.3389137977817391
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1137, Accuracy: 8686/8991 (96.6077%)
___Train Local_Simple,  epoch  47, local model 68, internal_epoch   1,  Average loss: 0.0050, Accuracy: 541/591 (91.5398%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2010, Accuracy: 9430/10000 (94.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0036, Accuracy: 540/584 (92.4658%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3164, Accuracy: 8919/10000 (89.1900%), Attack Success Rate:0/10000(0.000)
time spent on training: 50.562666177749634
[foolsgold agg] training data poison_ratio: 0.10065157750342936  data num: [536, 588, 593, 589, 584, 594, 586, 587, 591, 584]
[foolsgold agg] considering poison per batch poison_fraction: 0.10065157750342936
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.2134, Accuracy: 9318/10000 (93.1800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.3514, Accuracy: 7919/8991 (88.0770%)
Done in 88.77429294586182 sec.
Server Epoch:48 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
___Train Local_Simple,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0021, Accuracy: 569/592 (96.1149%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1886, Accuracy: 9425/10000 (94.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 27, internal_epoch   1,  Average loss: 0.0034, Accuracy: 555/593 (93.5919%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1859, Accuracy: 9393/10000 (93.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 75, internal_epoch   1,  Average loss: 0.0030, Accuracy: 560/595 (94.1176%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1622, Accuracy: 9442/10000 (94.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0028, Accuracy: 558/595 (93.7815%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1329, Accuracy: 9562/10000 (95.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 549/586 (93.6860%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1347, Accuracy: 9595/10000 (95.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0033, Accuracy: 559/598 (93.4783%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1711, Accuracy: 9452/10000 (94.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0037, Accuracy: 557/584 (95.3767%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.0346, Accuracy: 7561/10000 (75.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 96, internal_epoch   1,  Average loss: 0.0027, Accuracy: 506/534 (94.7566%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1961, Accuracy: 9351/10000 (93.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0032, Accuracy: 551/588 (93.7075%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1534, Accuracy: 9536/10000 (95.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 57, internal_epoch   1,  Average loss: 0.0029, Accuracy: 569/594 (95.7912%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1330, Accuracy: 9562/10000 (95.6200%), Attack Success Rate:0/10000(0.000)
time spent on training: 40.428478956222534
[foolsgold agg] training data poison_ratio: 0.0  data num: [592, 593, 595, 595, 586, 598, 584, 534, 588, 594]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.1859, Accuracy: 9416/10000 (94.1600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.3929, Accuracy: 7858/8991 (87.3985%)
Done in 78.3352780342102 sec.
Server Epoch:49 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
___Train Local_Simple,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0025, Accuracy: 548/583 (93.9966%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1750, Accuracy: 9378/10000 (93.7800%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0020, Accuracy: 585/606 (96.5347%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   2,  Average loss: 0.0012, Accuracy: 592/606 (97.6898%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   3,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   4,  Average loss: 0.0005, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   5,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   6,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   7,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   8,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   9,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch  10,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 15.77650522344634.
Norm before scaling: 15.826056538245963. Distance: 1.2833185477870641
Total norm for 1 adversaries is: 15.826056538245963. distance: 1.2833185477870641
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0937, Accuracy: 8709/8991 (96.8635%)
___Train Local_Simple,  epoch  49, local model 78, internal_epoch   1,  Average loss: 0.0032, Accuracy: 561/600 (93.5000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2161, Accuracy: 9327/10000 (93.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0031, Accuracy: 564/596 (94.6309%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1705, Accuracy: 9469/10000 (94.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 91, internal_epoch   1,  Average loss: 0.0022, Accuracy: 558/584 (95.5479%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1704, Accuracy: 9461/10000 (94.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0030, Accuracy: 566/602 (94.0199%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2291, Accuracy: 9274/10000 (92.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0017, Accuracy: 481/497 (96.7807%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1673, Accuracy: 9426/10000 (94.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 21, internal_epoch   1,  Average loss: 0.0036, Accuracy: 548/592 (92.5676%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2187, Accuracy: 9302/10000 (93.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 82, internal_epoch   1,  Average loss: 0.0022, Accuracy: 575/593 (96.9646%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1358, Accuracy: 9568/10000 (95.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0024, Accuracy: 560/592 (94.5946%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1356, Accuracy: 9582/10000 (95.8200%), Attack Success Rate:0/10000(0.000)
time spent on training: 50.78573298454285
[foolsgold agg] training data poison_ratio: 0.10367835757057314  data num: [583, 606, 600, 596, 584, 602, 497, 592, 593, 592]
[foolsgold agg] considering poison per batch poison_fraction: 0.10367835757057314
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.1635, Accuracy: 9498/10000 (94.9800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.4566, Accuracy: 7832/8991 (87.1093%)
Done in 89.0391252040863 sec.
Server Epoch:50 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
___Train Local_Simple,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0036, Accuracy: 550/595 (92.4370%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1918, Accuracy: 9391/10000 (93.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 86, internal_epoch   1,  Average loss: 0.0016, Accuracy: 578/597 (96.8174%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1549, Accuracy: 9503/10000 (95.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0026, Accuracy: 566/595 (95.1261%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2416, Accuracy: 9208/10000 (92.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0024, Accuracy: 570/594 (95.9596%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1949, Accuracy: 9404/10000 (94.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 31, internal_epoch   1,  Average loss: 0.0019, Accuracy: 580/599 (96.8280%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1806, Accuracy: 9393/10000 (93.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 32, internal_epoch   1,  Average loss: 0.0024, Accuracy: 569/601 (94.6755%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3125, Accuracy: 8983/10000 (89.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 67, internal_epoch   1,  Average loss: 0.0031, Accuracy: 552/584 (94.5205%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3969, Accuracy: 8657/10000 (86.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0023, Accuracy: 569/588 (96.7687%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2920, Accuracy: 9027/10000 (90.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0032, Accuracy: 550/586 (93.8567%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1755, Accuracy: 9422/10000 (94.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0019, Accuracy: 566/586 (96.5870%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1591, Accuracy: 9478/10000 (94.7800%), Attack Success Rate:0/10000(0.000)
time spent on training: 40.967434883117676
[foolsgold agg] training data poison_ratio: 0.0  data num: [595, 597, 595, 594, 599, 601, 584, 588, 586, 586]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.1536, Accuracy: 9522/10000 (95.2200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.4388, Accuracy: 7848/8991 (87.2873%)
Done in 79.30502796173096 sec.
Saving all the graphs.
This run has a label: Mar.02_23.22.07. Visdom environment: mnist_DBA
