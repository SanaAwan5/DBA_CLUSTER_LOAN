current path: saved_models/mnist_pretrain/model_mnist_Mar.03_08.44.52
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 10, 20, 30, 40, 50, 60, 70, 80, 90]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
___Train Local_Simple,  epoch   1, local model 23, internal_epoch   1,  Average loss: 0.0353, Accuracy: 187/428 (43.6916%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.3847, Accuracy: 980/10000 (9.8000%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   1, local model 72, internal_epoch   1,  Average loss: 0.2306, Accuracy: 0/10 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.3031, Accuracy: 1011/10000 (10.1100%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch   1, local model 61, internal_epoch   1,  Average loss: 0.0207, Accuracy: 469/767 (61.1473%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.6738, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0509, Accuracy: 45/84 (53.5714%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.4831, Accuracy: 1228/10000 (12.2800%), Attack Success Rate:24/10000(0.240)
___Train Local_Simple,  epoch   1, local model 71, internal_epoch   1,  Average loss: 0.0358, Accuracy: 115/342 (33.6257%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.4458, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch   1, local model 42, internal_epoch   1,  Average loss: 0.0354, Accuracy: 58/63 (92.0635%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.3216, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   1, local model 45, internal_epoch   1,  Average loss: 0.0291, Accuracy: 206/388 (53.0928%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.5057, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   1, local model 37, internal_epoch   1,  Average loss: 0.0372, Accuracy: 168/578 (29.0657%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.4296, Accuracy: 980/10000 (9.8000%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   1, local model 21, internal_epoch   1,  Average loss: 0.0092, Accuracy: 1675/2072 (80.8398%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 4.6122, Accuracy: 2864/10000 (28.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 35, internal_epoch   1,  Average loss: 0.0144, Accuracy: 767/978 (78.4254%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.1453, Accuracy: 1135/10000 (11.3500%), Attack Success Rate:21/10000(0.210)
time spent on training: 44.23372220993042
[foolsgold agg] training data poison_ratio: 0.0  data num: [428, 10, 767, 84, 342, 63, 388, 578, 2072, 978]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         0.69849735 1.         0.32861413 1.         0.32861413
 0.69849735 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.3000, Accuracy: 1731/10000 (17.3100%), Attack Success Rate:24/10000(0.240)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2991, Accuracy: 2049/8991 (22.7895%)
Done in 81.5580050945282 sec.
Server Epoch:2 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0536, Accuracy: 23/84 (27.3810%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.3008, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   2, local model 59, internal_epoch   1,  Average loss: 0.0844, Accuracy: 5/27 (18.5185%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.2996, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   2, local model 62, internal_epoch   1,  Average loss: 1.1528, Accuracy: 0/2 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.2997, Accuracy: 1028/10000 (10.2800%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch   2, local model 28, internal_epoch   1,  Average loss: 0.0354, Accuracy: 139/237 (58.6498%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.4153, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:19/10000(0.190)
___Train Local_Simple,  epoch   2, local model 65, internal_epoch   1,  Average loss: 0.0151, Accuracy: 1047/1326 (78.9593%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 9.7336, Accuracy: 2538/10000 (25.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 22, internal_epoch   1,  Average loss: 0.0672, Accuracy: 19/34 (55.8824%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.2995, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   2, local model 78, internal_epoch   1,  Average loss: 0.0149, Accuracy: 1592/2324 (68.5026%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 4.3180, Accuracy: 4807/10000 (48.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 58, internal_epoch   1,  Average loss: 0.0245, Accuracy: 507/1015 (49.9507%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 4.5316, Accuracy: 2468/10000 (24.6800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   2, local model 41, internal_epoch   1,  Average loss: 0.0261, Accuracy: 301/509 (59.1356%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 5.5236, Accuracy: 974/10000 (9.7400%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch   2, local model 81, internal_epoch   1,  Average loss: 0.0669, Accuracy: 5/68 (7.3529%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.3030, Accuracy: 958/10000 (9.5800%), Attack Success Rate:8/10000(0.080)
time spent on training: 41.09843707084656
[foolsgold agg] training data poison_ratio: 0.0  data num: [84, 27, 2, 237, 1326, 34, 2324, 1015, 509, 68]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.03314726 0.03314726 1.         0.75848103 0.86150751 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2962, Accuracy: 1228/10000 (12.2800%), Attack Success Rate:20/10000(0.200)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2917, Accuracy: 1228/8991 (13.6581%)
Done in 78.65037107467651 sec.
Server Epoch:3 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
___Train Local_Simple,  epoch   3, local model 54, internal_epoch   1,  Average loss: 0.0503, Accuracy: 8/91 (8.7912%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.2970, Accuracy: 2042/10000 (20.4200%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   3, local model 55, internal_epoch   1,  Average loss: 0.0198, Accuracy: 1649/2803 (58.8298%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 3.7559, Accuracy: 4413/10000 (44.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 61, internal_epoch   1,  Average loss: 0.0214, Accuracy: 515/767 (67.1447%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 5.5917, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   3, local model 73, internal_epoch   1,  Average loss: 0.0152, Accuracy: 949/1205 (78.7552%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 5.5755, Accuracy: 1545/10000 (15.4500%), Attack Success Rate:20/10000(0.200)
___Train Local_Simple,  epoch   3, local model 18, internal_epoch   1,  Average loss: 0.0382, Accuracy: 108/264 (40.9091%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 3.5779, Accuracy: 892/10000 (8.9200%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch   3, local model 42, internal_epoch   1,  Average loss: 0.0367, Accuracy: 0/63 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.2954, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch   3, local model 87, internal_epoch   1,  Average loss: 0.0702, Accuracy: 0/33 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.2939, Accuracy: 1459/10000 (14.5900%), Attack Success Rate:25/10000(0.250)
___Train Local_Simple,  epoch   3, local model 41, internal_epoch   1,  Average loss: 0.0235, Accuracy: 320/509 (62.8684%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 6.4656, Accuracy: 974/10000 (9.7400%), Attack Success Rate:8/10000(0.080)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   1,  Average loss: 0.0436, Accuracy: 86/151 (56.9536%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   2,  Average loss: 0.0311, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   3,  Average loss: 0.0074, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   4,  Average loss: 0.0027, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   5,  Average loss: 0.0009, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   6,  Average loss: 0.0008, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   7,  Average loss: 0.0008, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   8,  Average loss: 0.0010, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   9,  Average loss: 0.0029, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch  10,  Average loss: 0.0010, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Global model norm: 13.894857956694583.
Norm before scaling: 14.010999990276892. Distance: 1.645817414540755
Total norm for 1 adversaries is: 14.010999990276892. distance: 1.645817414540755
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 9.8338, Accuracy: 980/8991 (10.8998%)
___Train Local_Simple,  epoch   3, local model 28, internal_epoch   1,  Average loss: 0.0341, Accuracy: 179/237 (75.5274%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.6909, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:14/10000(0.140)
time spent on training: 48.42247200012207
[foolsgold agg] training data poison_ratio: 0.024661113833088357  data num: [91, 2803, 767, 1205, 264, 63, 33, 509, 151, 237]
[foolsgold agg] considering poison per batch poison_fraction: 0.024661113833088357
[foolsgold agg] wv: [0.         1.         1.         0.         0.84059689 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.2900, Accuracy: 1909/10000 (19.0900%), Attack Success Rate:18/10000(0.180)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.2782, Accuracy: 1909/8991 (21.2323%)
Done in 85.25463485717773 sec.
Server Epoch:4 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
___Train Local_Simple,  epoch   4, local model 37, internal_epoch   1,  Average loss: 0.0322, Accuracy: 257/578 (44.4637%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.8073, Accuracy: 980/10000 (9.8000%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   4, local model 92, internal_epoch   1,  Average loss: 0.0379, Accuracy: 117/202 (57.9208%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 5.5693, Accuracy: 958/10000 (9.5800%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch   4, local model 95, internal_epoch   1,  Average loss: 0.0734, Accuracy: 28/29 (96.5517%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.2912, Accuracy: 1895/10000 (18.9500%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch   4, local model 76, internal_epoch   1,  Average loss: 0.0509, Accuracy: 15/87 (17.2414%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.2968, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.4667, Accuracy: 0/5 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.2892, Accuracy: 2311/10000 (23.1100%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch   4, local model 99, internal_epoch   1,  Average loss: 0.0169, Accuracy: 396/411 (96.3504%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 20.6877, Accuracy: 980/10000 (9.8000%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   4, local model 94, internal_epoch   1,  Average loss: 0.0196, Accuracy: 503/607 (82.8666%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.9005, Accuracy: 1135/10000 (11.3500%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch   4, local model 74, internal_epoch   1,  Average loss: 0.0245, Accuracy: 401/762 (52.6247%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 5.0695, Accuracy: 958/10000 (9.5800%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   4, local model 45, internal_epoch   1,  Average loss: 0.0368, Accuracy: 263/388 (67.7835%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.4772, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   4, local model 44, internal_epoch   1,  Average loss: 0.0473, Accuracy: 0/47 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.2922, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:11/10000(0.110)
time spent on training: 46.069486141204834
[foolsgold agg] training data poison_ratio: 0.0  data num: [578, 202, 29, 87, 5, 411, 607, 762, 388, 47]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         0.03109426 0.         1.         0.03109426
 1.         1.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 2.2911, Accuracy: 1911/10000 (19.1100%), Attack Success Rate:10/10000(0.100)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 2.2792, Accuracy: 1911/8991 (21.2546%)
Done in 84.31615805625916 sec.
Server Epoch:5 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   1,  Average loss: 0.0356, Accuracy: 238/399 (59.6491%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   2,  Average loss: 0.0207, Accuracy: 197/399 (49.3734%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   3,  Average loss: 0.0111, Accuracy: 207/399 (51.8797%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   4,  Average loss: 0.0085, Accuracy: 382/399 (95.7393%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   5,  Average loss: 0.0055, Accuracy: 389/399 (97.4937%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   6,  Average loss: 0.0038, Accuracy: 393/399 (98.4962%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   7,  Average loss: 0.0018, Accuracy: 393/399 (98.4962%), train_poison_data_count: 399
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   8,  Average loss: 0.0014, Accuracy: 393/399 (98.4962%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   9,  Average loss: 0.0012, Accuracy: 393/399 (98.4962%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch  10,  Average loss: 0.0012, Accuracy: 393/399 (98.4962%), train_poison_data_count: 399
Global model norm: 13.902561615846983.
Norm before scaling: 14.257529427840652. Distance: 2.835494918546931
Total norm for 1 adversaries is: 14.257529427840652. distance: 2.835494918546931
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 8.2483, Accuracy: 1892/8991 (21.0433%)
___Train Local_Simple,  epoch   5, local model 49, internal_epoch   1,  Average loss: 0.0423, Accuracy: 65/196 (33.1633%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.4158, Accuracy: 1028/10000 (10.2800%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   5, local model 65, internal_epoch   1,  Average loss: 0.0143, Accuracy: 1046/1326 (78.8839%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 5.5188, Accuracy: 2236/10000 (22.3600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0488, Accuracy: 0/48 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.2887, Accuracy: 3013/10000 (30.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 36, internal_epoch   1,  Average loss: 0.0281, Accuracy: 231/304 (75.9868%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 5.6882, Accuracy: 974/10000 (9.7400%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch   5, local model 24, internal_epoch   1,  Average loss: 0.4700, Accuracy: 0/5 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.2900, Accuracy: 1884/10000 (18.8400%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0503, Accuracy: 62/86 (72.0930%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.2977, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0211, Accuracy: 338/463 (73.0022%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 24.9353, Accuracy: 892/10000 (8.9200%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   5, local model 76, internal_epoch   1,  Average loss: 0.0515, Accuracy: 16/87 (18.3908%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.2932, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   5, local model 39, internal_epoch   1,  Average loss: 0.0155, Accuracy: 1046/1259 (83.0818%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 5.5239, Accuracy: 958/10000 (9.5800%), Attack Success Rate:19/10000(0.190)
time spent on training: 47.63498091697693
[foolsgold agg] training data poison_ratio: 0.09561466570812366  data num: [399, 196, 1326, 48, 304, 5, 86, 463, 87, 1259]
[foolsgold agg] considering poison per batch poison_fraction: 0.09561466570812366
[foolsgold agg] wv: [0.05175413 0.         0.92984339 1.         0.05175413 0.
 1.         1.         0.92984339 1.        ]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.2892, Accuracy: 1936/10000 (19.3600%), Attack Success Rate:8/10000(0.080)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 2.2736, Accuracy: 1936/8991 (21.5326%)
Done in 84.49908113479614 sec.
Server Epoch:6 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
___Train Local_Simple,  epoch   6, local model 26, internal_epoch   1,  Average loss: 0.0182, Accuracy: 868/1311 (66.2090%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 3.0270, Accuracy: 1462/10000 (14.6200%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch   6, local model 29, internal_epoch   1,  Average loss: 0.0166, Accuracy: 987/1232 (80.1136%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 5.1113, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0182, Accuracy: 389/463 (84.0173%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 35.7622, Accuracy: 892/10000 (8.9200%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   6, local model 41, internal_epoch   1,  Average loss: 0.0250, Accuracy: 311/509 (61.1002%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 5.4984, Accuracy: 974/10000 (9.7400%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch   6, local model 99, internal_epoch   1,  Average loss: 0.0205, Accuracy: 393/411 (95.6204%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 20.7129, Accuracy: 980/10000 (9.8000%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch   6, local model 67, internal_epoch   1,  Average loss: 0.0303, Accuracy: 258/568 (45.4225%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.8471, Accuracy: 1035/10000 (10.3500%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch   6, local model 91, internal_epoch   1,  Average loss: 0.0352, Accuracy: 120/182 (65.9341%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.3092, Accuracy: 1062/10000 (10.6200%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   6, local model 76, internal_epoch   1,  Average loss: 0.0512, Accuracy: 13/87 (14.9425%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.2915, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:23/10000(0.230)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0353, Accuracy: 145/171 (84.7953%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.4080, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   6, local model 25, internal_epoch   1,  Average loss: 0.0349, Accuracy: 26/128 (20.3125%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.2884, Accuracy: 1464/10000 (14.6400%), Attack Success Rate:16/10000(0.160)
time spent on training: 51.964284896850586
[foolsgold agg] training data poison_ratio: 0.0  data num: [1311, 1232, 463, 509, 411, 568, 182, 87, 171, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.17594118 1.         1.         1.         1.         1.
 0.83350422 0.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 2.2878, Accuracy: 1942/10000 (19.4200%), Attack Success Rate:13/10000(0.130)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 2.2711, Accuracy: 1942/8991 (21.5994%)
Done in 106.76680397987366 sec.
Server Epoch:7 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
___Train Local_Simple,  epoch   7, local model 66, internal_epoch   1,  Average loss: 0.0236, Accuracy: 437/681 (64.1703%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 3.0589, Accuracy: 1028/10000 (10.2800%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   7, local model 68, internal_epoch   1,  Average loss: 0.0134, Accuracy: 1321/1591 (83.0295%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 4.6120, Accuracy: 974/10000 (9.7400%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch   7, local model 59, internal_epoch   1,  Average loss: 0.0861, Accuracy: 0/27 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2868, Accuracy: 2090/10000 (20.9000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   7, local model 62, internal_epoch   1,  Average loss: 1.2048, Accuracy: 0/2 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2853, Accuracy: 1950/10000 (19.5000%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch   7, local model 31, internal_epoch   1,  Average loss: 0.0160, Accuracy: 1198/1839 (65.1441%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 3.8534, Accuracy: 2984/10000 (29.8400%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0278, Accuracy: 288/688 (41.8605%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   2,  Average loss: 0.0112, Accuracy: 495/688 (71.9477%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   3,  Average loss: 0.0048, Accuracy: 605/688 (87.9360%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   4,  Average loss: 0.0034, Accuracy: 643/688 (93.4593%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   5,  Average loss: 0.0028, Accuracy: 651/688 (94.6221%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   6,  Average loss: 0.0022, Accuracy: 659/688 (95.7849%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   7,  Average loss: 0.0019, Accuracy: 665/688 (96.6570%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   8,  Average loss: 0.0016, Accuracy: 670/688 (97.3837%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   9,  Average loss: 0.0015, Accuracy: 670/688 (97.3837%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch  10,  Average loss: 0.0015, Accuracy: 671/688 (97.5291%), train_poison_data_count: 688
Global model norm: 13.909324186185549.
Norm before scaling: 14.381643335831358. Distance: 3.3453036112624934
Total norm for 1 adversaries is: 14.381643335831358. distance: 3.3453036112624934
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 7.5600, Accuracy: 2785/8991 (30.9754%)
___Train Local_Simple,  epoch   7, local model 23, internal_epoch   1,  Average loss: 0.0229, Accuracy: 404/428 (94.3925%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 24.0163, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0494, Accuracy: 63/86 (73.2558%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2976, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   7, local model 99, internal_epoch   1,  Average loss: 0.0199, Accuracy: 394/411 (95.8637%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 23.5450, Accuracy: 980/10000 (9.8000%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   7, local model 45, internal_epoch   1,  Average loss: 0.0301, Accuracy: 271/388 (69.8454%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 3.7737, Accuracy: 1028/10000 (10.2800%), Attack Success Rate:12/10000(0.120)
time spent on training: 58.317912101745605
[foolsgold agg] training data poison_ratio: 0.11203387070509689  data num: [681, 1591, 27, 2, 1839, 688, 428, 86, 411, 388]
[foolsgold agg] considering poison per batch poison_fraction: 0.11203387070509689
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.36983795 0.36983795 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 2.2725, Accuracy: 2195/10000 (21.9500%), Attack Success Rate:8/10000(0.080)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 2.2535, Accuracy: 2195/8991 (24.4133%)
Done in 96.92668509483337 sec.
Server Epoch:8 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
___Train Local_Simple,  epoch   8, local model 63, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2759/3022 (91.2972%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 5.9349, Accuracy: 1143/10000 (11.4300%), Attack Success Rate:22/10000(0.220)
___Train Local_Simple,  epoch   8, local model 55, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2115/2803 (75.4549%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 4.5459, Accuracy: 4765/10000 (47.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 79, internal_epoch   1,  Average loss: 0.0884, Accuracy: 9/25 (36.0000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.2730, Accuracy: 1843/10000 (18.4300%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0392, Accuracy: 81/263 (30.7985%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 3.1147, Accuracy: 892/10000 (8.9200%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch   8, local model 62, internal_epoch   1,  Average loss: 1.1507, Accuracy: 0/2 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.2705, Accuracy: 2956/10000 (29.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 56, internal_epoch   1,  Average loss: 0.0184, Accuracy: 609/704 (86.5057%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 10.2187, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch   8, local model 96, internal_epoch   1,  Average loss: 0.0258, Accuracy: 218/505 (43.1683%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 4.6721, Accuracy: 2783/10000 (27.8300%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0246, Accuracy: 376/648 (58.0247%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 3.6464, Accuracy: 1843/10000 (18.4300%), Attack Success Rate:25/10000(0.250)
___Train Local_Simple,  epoch   8, local model 92, internal_epoch   1,  Average loss: 0.0377, Accuracy: 121/202 (59.9010%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 3.2521, Accuracy: 958/10000 (9.5800%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   8, local model 86, internal_epoch   1,  Average loss: 0.0671, Accuracy: 2/34 (5.8824%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.2705, Accuracy: 2594/10000 (25.9400%), Attack Success Rate:1/10000(0.010)
time spent on training: 45.686363220214844
[foolsgold agg] training data poison_ratio: 0.0  data num: [3022, 2803, 25, 263, 2, 704, 505, 648, 202, 34]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.        1.        1.        1.        1.        1.        0.7807152
 1.        0.7807152 1.       ]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 2.2611, Accuracy: 2363/10000 (23.6300%), Attack Success Rate:8/10000(0.080)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 2.2553, Accuracy: 2363/8991 (26.2818%)
Done in 85.41032099723816 sec.
Server Epoch:9 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
___Train Local_Simple,  epoch   9, local model 28, internal_epoch   1,  Average loss: 0.0346, Accuracy: 134/237 (56.5401%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.4348, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   9, local model 63, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2843/3022 (94.0768%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 7.6294, Accuracy: 2178/10000 (21.7800%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   9, local model 33, internal_epoch   1,  Average loss: 0.0285, Accuracy: 249/644 (38.6646%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.4140, Accuracy: 1921/10000 (19.2100%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   9, local model 71, internal_epoch   1,  Average loss: 0.0359, Accuracy: 119/342 (34.7953%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.5756, Accuracy: 892/10000 (8.9200%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.4654, Accuracy: 0/5 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2590, Accuracy: 2453/10000 (24.5300%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch   9, local model 32, internal_epoch   1,  Average loss: 0.0825, Accuracy: 0/28 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2595, Accuracy: 3076/10000 (30.7600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   9, local model 76, internal_epoch   1,  Average loss: 0.0520, Accuracy: 8/87 (9.1954%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2579, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch   9, local model 97, internal_epoch   1,  Average loss: 0.4578, Accuracy: 0/5 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2583, Accuracy: 2278/10000 (22.7800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   9, local model 23, internal_epoch   1,  Average loss: 0.0205, Accuracy: 387/428 (90.4206%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 25.0645, Accuracy: 980/10000 (9.8000%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch   9, local model 25, internal_epoch   1,  Average loss: 0.0352, Accuracy: 18/128 (14.0625%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2557, Accuracy: 3302/10000 (33.0200%), Attack Success Rate:0/10000(0.000)
time spent on training: 42.69805097579956
[foolsgold agg] training data poison_ratio: 0.0  data num: [237, 3022, 644, 342, 5, 28, 87, 5, 428, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.         0.         0.67441549 1.         0.67441549 0.
 0.         1.         1.         0.44484504]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 2.2473, Accuracy: 1901/10000 (19.0100%), Attack Success Rate:8/10000(0.080)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 2.2398, Accuracy: 1901/8991 (21.1434%)
Done in 84.56544303894043 sec.
Server Epoch:10 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
___Train Local_Simple,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0214, Accuracy: 436/648 (67.2840%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 3.4059, Accuracy: 2386/10000 (23.8600%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  10, local model 56, internal_epoch   1,  Average loss: 0.0143, Accuracy: 617/704 (87.6420%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 9.9199, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  10, local model 19, internal_epoch   1,  Average loss: 0.0331, Accuracy: 121/244 (49.5902%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.4967, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0537, Accuracy: 9/84 (10.7143%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.2419, Accuracy: 2414/10000 (24.1400%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.4609, Accuracy: 0/5 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.2443, Accuracy: 2247/10000 (22.4700%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  10, local model 78, internal_epoch   1,  Average loss: 0.0093, Accuracy: 1934/2324 (83.2186%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 3.2100, Accuracy: 4867/10000 (48.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 49, internal_epoch   1,  Average loss: 0.0367, Accuracy: 123/196 (62.7551%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 4.4729, Accuracy: 1028/10000 (10.2800%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch  10, local model 34, internal_epoch   1,  Average loss: 0.0167, Accuracy: 804/1203 (66.8329%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 4.4624, Accuracy: 3783/10000 (37.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0500, Accuracy: 0/48 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.2424, Accuracy: 2485/10000 (24.8500%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  10, local model 99, internal_epoch   1,  Average loss: 0.0185, Accuracy: 397/411 (96.5937%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 17.1938, Accuracy: 980/10000 (9.8000%), Attack Success Rate:12/10000(0.120)
time spent on training: 45.37222123146057
[foolsgold agg] training data poison_ratio: 0.0  data num: [648, 704, 244, 84, 5, 2324, 196, 1203, 48, 411]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.        0.3298789 0.3298789 1.        1.        1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 2.2211, Accuracy: 1850/10000 (18.5000%), Attack Success Rate:18/10000(0.180)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 2.2127, Accuracy: 2046/8991 (22.7561%)
Done in 84.00435280799866 sec.
Server Epoch:11 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
___Train Local_Simple,  epoch  11, local model 53, internal_epoch   1,  Average loss: 0.0222, Accuracy: 333/456 (73.0263%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 21.0132, Accuracy: 2120/10000 (21.2000%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  11, local model 56, internal_epoch   1,  Average loss: 0.0144, Accuracy: 616/704 (87.5000%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 8.7944, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0235, Accuracy: 208/259 (80.3089%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 3.6052, Accuracy: 988/10000 (9.8800%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0488, Accuracy: 0/48 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.2148, Accuracy: 2833/10000 (28.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 36, internal_epoch   1,  Average loss: 0.0231, Accuracy: 234/304 (76.9737%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 11.5857, Accuracy: 974/10000 (9.7400%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0187, Accuracy: 1303/1982 (65.7417%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 6.0533, Accuracy: 2531/10000 (25.3100%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0312, Accuracy: 150/310 (48.3871%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 3.2107, Accuracy: 985/10000 (9.8500%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  11, local model 99, internal_epoch   1,  Average loss: 0.0135, Accuracy: 397/411 (96.5937%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 21.1011, Accuracy: 980/10000 (9.8000%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch  11, local model 88, internal_epoch   1,  Average loss: 0.0446, Accuracy: 39/96 (40.6250%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.2354, Accuracy: 987/10000 (9.8700%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0218, Accuracy: 316/578 (54.6713%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.8830, Accuracy: 2662/10000 (26.6200%), Attack Success Rate:0/10000(0.000)
time spent on training: 43.24762010574341
[foolsgold agg] training data poison_ratio: 0.0  data num: [456, 704, 259, 48, 304, 1982, 310, 411, 96, 578]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.66079359 1.         1.         0.66079359 0.         1.
 1.         1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 2.2147, Accuracy: 1646/10000 (16.4600%), Attack Success Rate:16/10000(0.160)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 2.2075, Accuracy: 1814/8991 (20.1757%)
Done in 81.48862600326538 sec.
Server Epoch:12 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0358, Accuracy: 0/63 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.2098, Accuracy: 2514/10000 (25.1400%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  12, local model 17, internal_epoch   1,  Average loss: 0.0457, Accuracy: 31/94 (32.9787%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.2024, Accuracy: 1891/10000 (18.9100%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0363, Accuracy: 33/119 (27.7311%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.2027, Accuracy: 2790/10000 (27.9000%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0352, Accuracy: 121/216 (56.0185%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.8557, Accuracy: 974/10000 (9.7400%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0119, Accuracy: 1643/1982 (82.8961%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 4.9455, Accuracy: 2751/10000 (27.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 38, internal_epoch   1,  Average loss: 0.0342, Accuracy: 117/179 (65.3631%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.3236, Accuracy: 1136/10000 (11.3600%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0209, Accuracy: 321/578 (55.5363%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 3.4171, Accuracy: 2556/10000 (25.5600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  12, local model 44, internal_epoch   1,  Average loss: 0.0480, Accuracy: 0/47 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.2125, Accuracy: 2191/10000 (21.9100%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0104, Accuracy: 1268/1544 (82.1244%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 4.5187, Accuracy: 3937/10000 (39.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0192, Accuracy: 373/463 (80.5616%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 25.5516, Accuracy: 892/10000 (8.9200%), Attack Success Rate:8/10000(0.080)
time spent on training: 43.93898582458496
[foolsgold agg] training data poison_ratio: 0.0  data num: [63, 94, 119, 216, 1982, 179, 578, 47, 1544, 463]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0. 0. 0. 1. 1. 1. 1. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 2.1877, Accuracy: 2660/10000 (26.6000%), Attack Success Rate:3/10000(0.030)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 2.1782, Accuracy: 2807/8991 (31.2201%)
Done in 82.69900298118591 sec.
Server Epoch:13 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
___Train Local_Simple,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.4439, Accuracy: 1/5 (20.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.1754, Accuracy: 3396/10000 (33.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 38, internal_epoch   1,  Average loss: 0.0318, Accuracy: 119/179 (66.4804%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.7167, Accuracy: 1135/10000 (11.3500%), Attack Success Rate:20/10000(0.200)
___Train Local_Simple,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0117, Accuracy: 623/705 (88.3688%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 36.6671, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:9/10000(0.090)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0224, Accuracy: 554/688 (80.5233%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   2,  Average loss: 0.0187, Accuracy: 454/688 (65.9884%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   3,  Average loss: 0.0045, Accuracy: 636/688 (92.4419%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   4,  Average loss: 0.0034, Accuracy: 644/688 (93.6047%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   5,  Average loss: 0.0029, Accuracy: 652/688 (94.7674%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   6,  Average loss: 0.0024, Accuracy: 657/688 (95.4942%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   7,  Average loss: 0.0021, Accuracy: 659/688 (95.7849%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   8,  Average loss: 0.0019, Accuracy: 660/688 (95.9302%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   9,  Average loss: 0.0017, Accuracy: 665/688 (96.6570%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch  10,  Average loss: 0.0017, Accuracy: 664/688 (96.5116%), train_poison_data_count: 688
Global model norm: 13.99470310824387.
Norm before scaling: 15.606957356253712. Distance: 6.334000033707133
Total norm for 2 adversaries is: 15.606957356253712. distance: 6.334000033707133
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 4.7759, Accuracy: 2779/8991 (30.9087%)
___Train Local_Simple,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0527, Accuracy: 17/84 (20.2381%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.1733, Accuracy: 2828/10000 (28.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 76, internal_epoch   1,  Average loss: 0.0513, Accuracy: 11/87 (12.6437%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.1729, Accuracy: 1893/10000 (18.9300%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  13, local model 97, internal_epoch   1,  Average loss: 0.4445, Accuracy: 2/5 (40.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.1796, Accuracy: 2631/10000 (26.3100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0481, Accuracy: 56/86 (65.1163%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.1753, Accuracy: 1234/10000 (12.3400%), Attack Success Rate:33/10000(0.330)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   1,  Average loss: 0.0299, Accuracy: 241/569 (42.3550%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   2,  Average loss: 0.0140, Accuracy: 400/569 (70.2988%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   3,  Average loss: 0.0072, Accuracy: 489/569 (85.9402%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   4,  Average loss: 0.0055, Accuracy: 508/569 (89.2794%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   5,  Average loss: 0.0048, Accuracy: 518/569 (91.0369%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   6,  Average loss: 0.0040, Accuracy: 535/569 (94.0246%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   7,  Average loss: 0.0033, Accuracy: 538/569 (94.5518%), train_poison_data_count: 569
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   8,  Average loss: 0.0029, Accuracy: 540/569 (94.9033%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   9,  Average loss: 0.0025, Accuracy: 545/569 (95.7821%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch  10,  Average loss: 0.0025, Accuracy: 545/569 (95.7821%), train_poison_data_count: 569
Global model norm: 13.99470310824387.
Norm before scaling: 14.51692895196119. Distance: 3.0271227552905984
Total norm for 2 adversaries is: 14.51692895196119. distance: 3.0271227552905984
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 2.3492, Accuracy: 5279/8991 (58.7143%)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0472, Accuracy: 0/48 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.1779, Accuracy: 2725/10000 (27.2500%), Attack Success Rate:1/10000(0.010)
time spent on training: 61.50998091697693
[foolsgold agg] training data poison_ratio: 0.5118078175895765  data num: [5, 179, 705, 688, 84, 87, 5, 86, 569, 48]
[foolsgold agg] considering poison per batch poison_fraction: 0.5118078175895765
[foolsgold agg] wv: [1.         0.         0.         1.         0.         0.
 0.33194001 1.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 2.1134, Accuracy: 3886/10000 (38.8600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 2.0949, Accuracy: 3983/8991 (44.2999%)
Done in 100.07491493225098 sec.
Server Epoch:14 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0611, Accuracy: 28/29 (96.5517%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.0683, Accuracy: 2062/10000 (20.6200%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  14, local model 97, internal_epoch   1,  Average loss: 0.4209, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.0952, Accuracy: 2685/10000 (26.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0156, Accuracy: 499/648 (77.0062%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 3.8677, Accuracy: 3557/10000 (35.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 89, internal_epoch   1,  Average loss: 0.0608, Accuracy: 12/69 (17.3913%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.0426, Accuracy: 2996/10000 (29.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0342, Accuracy: 25/128 (19.5312%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.0579, Accuracy: 4412/10000 (44.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 34, internal_epoch   1,  Average loss: 0.0130, Accuracy: 945/1203 (78.5536%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 4.4961, Accuracy: 4020/10000 (40.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 55, internal_epoch   1,  Average loss: 0.0099, Accuracy: 2324/2803 (82.9112%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 4.2656, Accuracy: 4788/10000 (47.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 67, internal_epoch   1,  Average loss: 0.0195, Accuracy: 374/568 (65.8451%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.9321, Accuracy: 3734/10000 (37.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0135, Accuracy: 612/704 (86.9318%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 3.2292, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0353, Accuracy: 41/119 (34.4538%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.0784, Accuracy: 2721/10000 (27.2100%), Attack Success Rate:0/10000(0.000)
time spent on training: 46.31097388267517
[foolsgold agg] training data poison_ratio: 0.0  data num: [29, 5, 648, 69, 128, 1203, 2803, 568, 704, 119]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.        1.        0.2450318 1.        0.        1.        1.
 0.2450318 1.        0.       ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 2.0976, Accuracy: 4134/10000 (41.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 2.0796, Accuracy: 4218/8991 (46.9136%)
Done in 84.82668495178223 sec.
Server Epoch:15 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
___Train Local_Simple,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0197, Accuracy: 392/463 (84.6652%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 7.6586, Accuracy: 892/10000 (8.9200%), Attack Success Rate:11/10000(0.110)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0506, Accuracy: 31/84 (36.9048%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   2,  Average loss: 0.0442, Accuracy: 69/84 (82.1429%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   3,  Average loss: 0.0350, Accuracy: 55/84 (65.4762%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   4,  Average loss: 0.0318, Accuracy: 52/84 (61.9048%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   5,  Average loss: 0.0291, Accuracy: 52/84 (61.9048%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   6,  Average loss: 0.0267, Accuracy: 51/84 (60.7143%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   7,  Average loss: 0.0252, Accuracy: 51/84 (60.7143%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   8,  Average loss: 0.0177, Accuracy: 57/84 (67.8571%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   9,  Average loss: 0.0163, Accuracy: 65/84 (77.3810%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch  10,  Average loss: 0.0164, Accuracy: 69/84 (82.1429%), train_poison_data_count: 84
Global model norm: 14.054724955654649.
Norm before scaling: 14.14535810808123. Distance: 1.0244163898627041
Total norm for 2 adversaries is: 14.14535810808123. distance: 1.0244163898627041
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 2.4050, Accuracy: 2630/8991 (29.2515%)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2060/2180 (94.4954%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 2165/2180 (99.3119%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   3,  Average loss: 0.0002, Accuracy: 2174/2180 (99.7248%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   4,  Average loss: 0.0002, Accuracy: 2174/2180 (99.7248%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   5,  Average loss: 0.0002, Accuracy: 2174/2180 (99.7248%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   6,  Average loss: 0.0002, Accuracy: 2175/2180 (99.7706%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   7,  Average loss: 0.0002, Accuracy: 2175/2180 (99.7706%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   8,  Average loss: 0.0002, Accuracy: 2175/2180 (99.7706%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   9,  Average loss: 0.0002, Accuracy: 2176/2180 (99.8165%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch  10,  Average loss: 0.0002, Accuracy: 2176/2180 (99.8165%), train_poison_data_count: 2180
Global model norm: 14.054724955654649.
Norm before scaling: 14.534108001874634. Distance: 3.565179987961003
Total norm for 2 adversaries is: 14.534108001874634. distance: 3.565179987961003
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 3.7830, Accuracy: 3577/8991 (39.7842%)
___Train Local_Simple,  epoch  15, local model 48, internal_epoch   1,  Average loss: 0.0335, Accuracy: 52/128 (40.6250%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.0454, Accuracy: 2978/10000 (29.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0076, Accuracy: 2450/2803 (87.4064%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 3.5510, Accuracy: 4603/10000 (46.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 98, internal_epoch   1,  Average loss: 0.2950, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.0481, Accuracy: 2654/10000 (26.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 27, internal_epoch   1,  Average loss: 0.0120, Accuracy: 607/678 (89.5280%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 4.2345, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0333, Accuracy: 49/63 (77.7778%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.0805, Accuracy: 3149/10000 (31.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0233, Accuracy: 205/300 (68.3333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 8.4938, Accuracy: 1135/10000 (11.3500%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch  15, local model 44, internal_epoch   1,  Average loss: 0.0480, Accuracy: 0/47 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.0875, Accuracy: 4641/10000 (46.4100%), Attack Success Rate:1/10000(0.010)
time spent on training: 75.77974605560303
[foolsgold agg] training data poison_ratio: 0.3353080568720379  data num: [463, 84, 2180, 128, 2803, 6, 678, 63, 300, 47]
[foolsgold agg] considering poison per batch poison_fraction: 0.3353080568720379
[foolsgold agg] wv: [0.61224227 0.74432116 1.         0.61224227 1.         0.23761706
 0.23761706 1.         1.         0.74432116]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 1.9812, Accuracy: 5690/10000 (56.9000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 1.9483, Accuracy: 5697/8991 (63.3634%)
Done in 115.56370282173157 sec.
Server Epoch:16 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
___Train Local_Simple,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0322, Accuracy: 59/128 (46.0938%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.8696, Accuracy: 3481/10000 (34.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0228, Accuracy: 145/171 (84.7953%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 5.0110, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0133, Accuracy: 498/648 (76.8519%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 5.8834, Accuracy: 3804/10000 (38.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0092, Accuracy: 399/411 (97.0803%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 4.9910, Accuracy: 1855/10000 (18.5500%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0143, Accuracy: 390/456 (85.5263%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 19.0464, Accuracy: 2134/10000 (21.3400%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0077, Accuracy: 1194/1311 (91.0755%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 8.1787, Accuracy: 2030/10000 (20.3000%), Attack Success Rate:17/10000(0.170)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   1,  Average loss: 0.0229, Accuracy: 302/399 (75.6892%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   2,  Average loss: 0.0435, Accuracy: 381/399 (95.4887%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   3,  Average loss: 0.1178, Accuracy: 198/399 (49.6241%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   4,  Average loss: 0.0256, Accuracy: 198/399 (49.6241%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   5,  Average loss: 0.0244, Accuracy: 198/399 (49.6241%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   6,  Average loss: 0.0228, Accuracy: 198/399 (49.6241%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   7,  Average loss: 0.0201, Accuracy: 198/399 (49.6241%), train_poison_data_count: 399
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   8,  Average loss: 0.0166, Accuracy: 198/399 (49.6241%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   9,  Average loss: 0.0137, Accuracy: 200/399 (50.1253%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch  10,  Average loss: 0.0129, Accuracy: 229/399 (57.3935%), train_poison_data_count: 399
Global model norm: 14.090714425898588.
Norm before scaling: 15.560336410690715. Distance: 6.617312019194425
Total norm for 2 adversaries is: 15.560336410690715. distance: 6.617312019194425
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 2.9973, Accuracy: 1305/8991 (14.5145%)
___Train Local_Simple,  epoch  16, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2875/3022 (95.1357%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 5.4628, Accuracy: 2429/10000 (24.2900%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  16, local model 52, internal_epoch   1,  Average loss: 0.0089, Accuracy: 678/705 (96.1702%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 7.2866, Accuracy: 1043/10000 (10.4300%), Attack Success Rate:12/10000(0.120)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   1,  Average loss: 0.0106, Accuracy: 687/768 (89.4531%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   2,  Average loss: 0.0017, Accuracy: 738/768 (96.0938%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   3,  Average loss: 0.0011, Accuracy: 750/768 (97.6562%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   4,  Average loss: 0.0009, Accuracy: 753/768 (98.0469%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   5,  Average loss: 0.0009, Accuracy: 755/768 (98.3073%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   6,  Average loss: 0.0008, Accuracy: 756/768 (98.4375%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   7,  Average loss: 0.0007, Accuracy: 756/768 (98.4375%), train_poison_data_count: 768
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   8,  Average loss: 0.0007, Accuracy: 757/768 (98.5677%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   9,  Average loss: 0.0007, Accuracy: 757/768 (98.5677%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch  10,  Average loss: 0.0007, Accuracy: 757/768 (98.5677%), train_poison_data_count: 768
Global model norm: 14.090714425898588.
Norm before scaling: 14.515875182854762. Distance: 2.808973432616924
Total norm for 2 adversaries is: 14.515875182854762. distance: 2.808973432616924
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 4.4312, Accuracy: 2899/8991 (32.2434%)
time spent on training: 68.75968313217163
[foolsgold agg] training data poison_ratio: 0.14552936775158998  data num: [128, 171, 648, 411, 456, 1311, 399, 3022, 705, 768]
[foolsgold agg] considering poison per batch poison_fraction: 0.14552936775158998
[foolsgold agg] wv: [0.62787223 0.24629122 0.60882993 1.         0.24629122 0.01448874
 1.         0.60882993 0.01448874 0.71473131]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 2.2416, Accuracy: 3401/10000 (34.0100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 2.2254, Accuracy: 3482/8991 (38.7276%)
Done in 106.72252583503723 sec.
Server Epoch:17 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0168, Accuracy: 506/681 (74.3025%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.9821, Accuracy: 3081/10000 (30.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 33, internal_epoch   1,  Average loss: 0.0247, Accuracy: 307/644 (47.6708%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 3.7202, Accuracy: 3054/10000 (30.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 56, internal_epoch   1,  Average loss: 0.0153, Accuracy: 614/704 (87.2159%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 4.2511, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch  17, local model 97, internal_epoch   1,  Average loss: 0.4305, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.2282, Accuracy: 1848/10000 (18.4800%), Attack Success Rate:10/10000(0.100)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0241, Accuracy: 499/688 (72.5291%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0058, Accuracy: 623/688 (90.5523%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   3,  Average loss: 0.0023, Accuracy: 659/688 (95.7849%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   4,  Average loss: 0.0017, Accuracy: 667/688 (96.9477%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   5,  Average loss: 0.0014, Accuracy: 667/688 (96.9477%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   6,  Average loss: 0.0012, Accuracy: 670/688 (97.3837%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   7,  Average loss: 0.0011, Accuracy: 674/688 (97.9651%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   8,  Average loss: 0.0010, Accuracy: 675/688 (98.1105%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   9,  Average loss: 0.0009, Accuracy: 676/688 (98.2558%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch  10,  Average loss: 0.0009, Accuracy: 676/688 (98.2558%), train_poison_data_count: 688
Global model norm: 14.120901407749535.
Norm before scaling: 15.028394653921737. Distance: 4.551112766224176
Total norm for 2 adversaries is: 15.028394653921737. distance: 4.551112766224176
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 5.0357, Accuracy: 2854/8991 (31.7429%)
___Train Local_Simple,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.4682, Accuracy: 0/5 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.2327, Accuracy: 3692/10000 (36.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 77, internal_epoch   1,  Average loss: 0.0123, Accuracy: 1234/1544 (79.9223%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.9474, Accuracy: 2993/10000 (29.9300%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0199, Accuracy: 368/578 (63.6678%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 3.4160, Accuracy: 2745/10000 (27.4500%), Attack Success Rate:1/10000(0.010)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   1,  Average loss: 0.0172, Accuracy: 646/768 (84.1146%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 723/768 (94.1406%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   3,  Average loss: 0.0015, Accuracy: 745/768 (97.0052%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   4,  Average loss: 0.0012, Accuracy: 751/768 (97.7865%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   5,  Average loss: 0.0010, Accuracy: 754/768 (98.1771%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   6,  Average loss: 0.0009, Accuracy: 755/768 (98.3073%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   7,  Average loss: 0.0008, Accuracy: 758/768 (98.6979%), train_poison_data_count: 768
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   8,  Average loss: 0.0008, Accuracy: 758/768 (98.6979%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   9,  Average loss: 0.0007, Accuracy: 758/768 (98.6979%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch  10,  Average loss: 0.0007, Accuracy: 758/768 (98.6979%), train_poison_data_count: 768
Global model norm: 14.120901407749535.
Norm before scaling: 14.679993094876611. Distance: 3.609867871473901
Total norm for 2 adversaries is: 14.679993094876611. distance: 3.609867871473901
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 4.2904, Accuracy: 2876/8991 (31.9875%)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0809, Accuracy: 17/27 (62.9630%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.2301, Accuracy: 2016/10000 (20.1600%), Attack Success Rate:8/10000(0.080)
time spent on training: 68.6889898777008
[foolsgold agg] training data poison_ratio: 0.2579730687455705  data num: [681, 644, 704, 5, 688, 5, 1544, 578, 768, 27]
[foolsgold agg] considering poison per batch poison_fraction: 0.2579730687455705
[foolsgold agg] wv: [1.         0.46882496 1.         0.         1.         0.46882496
 0.54710012 1.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 2.1833, Accuracy: 3805/10000 (38.0500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 2.1631, Accuracy: 3809/8991 (42.3646%)
Done in 108.2765040397644 sec.
Server Epoch:18 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0075, Accuracy: 2514/2803 (89.6896%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 4.2123, Accuracy: 4776/10000 (47.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0161, Accuracy: 699/1015 (68.8670%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 3.3210, Accuracy: 4216/10000 (42.1600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  18, local model 88, internal_epoch   1,  Average loss: 0.0426, Accuracy: 81/96 (84.3750%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.1726, Accuracy: 1345/10000 (13.4500%), Attack Success Rate:31/10000(0.310)
___Train Local_Simple,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0152, Accuracy: 403/428 (94.1589%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 16.3869, Accuracy: 1978/10000 (19.7800%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch  18, local model 39, internal_epoch   1,  Average loss: 0.0100, Accuracy: 1117/1259 (88.7212%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 5.7846, Accuracy: 1921/10000 (19.2100%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch  18, local model 75, internal_epoch   1,  Average loss: 0.0161, Accuracy: 453/497 (91.1469%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 9.5294, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch  18, local model 82, internal_epoch   1,  Average loss: 0.0374, Accuracy: 52/114 (45.6140%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.1097, Accuracy: 2131/10000 (21.3100%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0146, Accuracy: 621/767 (80.9648%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.7549, Accuracy: 2680/10000 (26.8000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  18, local model 95, internal_epoch   1,  Average loss: 0.0688, Accuracy: 22/29 (75.8621%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.1500, Accuracy: 3474/10000 (34.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0713, Accuracy: 13/30 (43.3333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.1649, Accuracy: 3417/10000 (34.1700%), Attack Success Rate:0/10000(0.000)
time spent on training: 46.74429702758789
[foolsgold agg] training data poison_ratio: 0.0  data num: [2803, 1015, 96, 428, 1259, 497, 114, 767, 29, 30]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.99587534 1.         1.         0.         1.         1.
 1.         0.74876102 0.         0.91942914]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 2.1425, Accuracy: 4298/10000 (42.9800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 2.1164, Accuracy: 4300/8991 (47.8256%)
Done in 85.03605198860168 sec.
Server Epoch:19 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
___Train Local_Simple,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0168, Accuracy: 451/578 (78.0277%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 3.7042, Accuracy: 2816/10000 (28.1600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.3325, Accuracy: 4/6 (66.6667%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.1002, Accuracy: 3761/10000 (37.6100%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   1,  Average loss: 0.0298, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   2,  Average loss: 0.0029, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   3,  Average loss: 0.0005, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   4,  Average loss: 0.0006, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   5,  Average loss: 0.0006, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   6,  Average loss: 0.0006, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   7,  Average loss: 0.0006, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   8,  Average loss: 0.0006, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   9,  Average loss: 0.0006, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch  10,  Average loss: 0.0006, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Global model norm: 14.174215003719947.
Norm before scaling: 14.390624469835766. Distance: 1.824693638418371
Total norm for 1 adversaries is: 14.390624469835766. distance: 1.824693638418371
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 9.3348, Accuracy: 980/8991 (10.8998%)
___Train Local_Simple,  epoch  19, local model 84, internal_epoch   1,  Average loss: 0.0815, Accuracy: 1/29 (3.4483%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.1260, Accuracy: 4342/10000 (43.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0339, Accuracy: 45/128 (35.1562%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.0948, Accuracy: 5652/10000 (56.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0306, Accuracy: 133/237 (56.1181%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.8171, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0295, Accuracy: 143/171 (83.6257%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.3653, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0106, Accuracy: 838/994 (84.3058%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.6716, Accuracy: 4977/10000 (49.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0127, Accuracy: 1648/1982 (83.1483%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 8.2125, Accuracy: 2804/10000 (28.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0171, Accuracy: 714/1010 (70.6931%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.6283, Accuracy: 3157/10000 (31.5700%), Attack Success Rate:0/10000(0.000)
time spent on training: 52.57303500175476
[foolsgold agg] training data poison_ratio: 0.02856602345819145  data num: [578, 6, 151, 29, 128, 237, 171, 994, 1982, 1010]
[foolsgold agg] considering poison per batch poison_fraction: 0.02856602345819145
[foolsgold agg] wv: [1.         0.         0.         1.         0.         0.
 0.46895638 1.         0.46895638 1.        ]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 2.1135, Accuracy: 4594/10000 (45.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 2.0882, Accuracy: 4594/8991 (51.0955%)
Done in 97.44408178329468 sec.
Server Epoch:20 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
___Train Local_Simple,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0132, Accuracy: 403/428 (94.1589%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 16.1405, Accuracy: 1961/10000 (19.6100%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.3256, Accuracy: 4/6 (66.6667%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.0649, Accuracy: 4077/10000 (40.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 27, internal_epoch   1,  Average loss: 0.0124, Accuracy: 607/678 (89.5280%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 3.9675, Accuracy: 1024/10000 (10.2400%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch  20, local model 82, internal_epoch   1,  Average loss: 0.0354, Accuracy: 60/114 (52.6316%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.9924, Accuracy: 3199/10000 (31.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0160, Accuracy: 465/578 (80.4498%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 5.4657, Accuracy: 2819/10000 (28.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0115, Accuracy: 819/978 (83.7423%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 4.1449, Accuracy: 1996/10000 (19.9600%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  20, local model 29, internal_epoch   1,  Average loss: 0.0083, Accuracy: 1115/1232 (90.5032%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 3.3853, Accuracy: 3694/10000 (36.9400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  20, local model 47, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2201/2519 (87.3759%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 3.8328, Accuracy: 4693/10000 (46.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0481, Accuracy: 49/84 (58.3333%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.0365, Accuracy: 3367/10000 (33.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0313, Accuracy: 58/63 (92.0635%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.0845, Accuracy: 3232/10000 (32.3200%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.67055416107178
[foolsgold agg] training data poison_ratio: 0.0  data num: [428, 6, 678, 114, 578, 978, 1232, 2519, 84, 63]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.21130446 0.21130446 1.         1.         1.         1.
 1.         1.         0.         0.        ]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 2.0499, Accuracy: 4858/10000 (48.5800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 2.0161, Accuracy: 4860/8991 (54.0541%)
Done in 90.93402075767517 sec.
Server Epoch:21 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
___Train Local_Simple,  epoch  21, local model 33, internal_epoch   1,  Average loss: 0.0179, Accuracy: 441/644 (68.4783%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 14.1765, Accuracy: 2463/10000 (24.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0155, Accuracy: 479/648 (73.9198%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 5.9663, Accuracy: 3814/10000 (38.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0647, Accuracy: 19/30 (63.3333%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.0047, Accuracy: 4397/10000 (43.9700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  21, local model 15, internal_epoch   1,  Average loss: 0.0147, Accuracy: 747/1033 (72.3136%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 3.9512, Accuracy: 3134/10000 (31.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0151, Accuracy: 460/509 (90.3733%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 15.8722, Accuracy: 1558/10000 (15.5800%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.3687, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.0058, Accuracy: 3708/10000 (37.0800%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   1,  Average loss: 0.0037, Accuracy: 2095/2180 (96.1009%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 2167/2180 (99.4037%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   3,  Average loss: 0.0002, Accuracy: 2173/2180 (99.6789%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2176/2180 (99.8165%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Global model norm: 14.220529700606104.
Norm before scaling: 14.70775749368897. Distance: 3.4795896231182923
Total norm for 1 adversaries is: 14.70775749368897. distance: 3.4795896231182923
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 3.1672, Accuracy: 3890/8991 (43.2655%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0597, Accuracy: 19/34 (55.8824%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.0162, Accuracy: 4828/10000 (48.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0458, Accuracy: 40/91 (43.9560%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.9908, Accuracy: 5290/10000 (52.9000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0084, Accuracy: 627/705 (88.9362%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 113.3152, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:11/10000(0.110)
time spent on training: 70.66520714759827
[foolsgold agg] training data poison_ratio: 0.3708113624766117  data num: [644, 648, 30, 1033, 509, 5, 2180, 34, 91, 705]
[foolsgold agg] considering poison per batch poison_fraction: 0.3708113624766117
[foolsgold agg] wv: [1.         1.         1.         0.65548141 1.         0.
 0.84459567 0.         1.         0.59950267]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 1.9397, Accuracy: 5199/10000 (51.9900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 1.8959, Accuracy: 5216/8991 (58.0136%)
Done in 108.7242579460144 sec.
Server Epoch:22 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
___Train Local_Simple,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.3569, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.8583, Accuracy: 5082/10000 (50.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0271, Accuracy: 118/179 (65.9218%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 3.1446, Accuracy: 1889/10000 (18.8900%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0284, Accuracy: 58/63 (92.0635%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.8868, Accuracy: 4244/10000 (42.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0834, Accuracy: 0/28 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.9119, Accuracy: 5255/10000 (52.5500%), Attack Success Rate:1/10000(0.010)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   1,  Average loss: 0.0259, Accuracy: 319/399 (79.9499%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   2,  Average loss: 0.0027, Accuracy: 393/399 (98.4962%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   3,  Average loss: 0.0055, Accuracy: 371/399 (92.9825%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   4,  Average loss: 0.0067, Accuracy: 371/399 (92.9825%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   5,  Average loss: 0.0016, Accuracy: 395/399 (98.9975%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   6,  Average loss: 0.0027, Accuracy: 390/399 (97.7444%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   7,  Average loss: 0.0009, Accuracy: 397/399 (99.4987%), train_poison_data_count: 399
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   8,  Average loss: 0.0008, Accuracy: 396/399 (99.2481%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   9,  Average loss: 0.0008, Accuracy: 396/399 (99.2481%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch  10,  Average loss: 0.0009, Accuracy: 396/399 (99.2481%), train_poison_data_count: 399
Global model norm: 14.250741504316593.
Norm before scaling: 14.763676396720104. Distance: 3.05348216908722
Total norm for 1 adversaries is: 14.763676396720104. distance: 3.05348216908722
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 11.1375, Accuracy: 1912/8991 (21.2657%)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0194, Accuracy: 150/171 (87.7193%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 3.9672, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0089, Accuracy: 857/978 (87.6278%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 5.0229, Accuracy: 1953/10000 (19.5300%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch  22, local model 92, internal_epoch   1,  Average loss: 0.0313, Accuracy: 151/202 (74.7525%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 2.5978, Accuracy: 958/10000 (9.5800%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch  22, local model 27, internal_epoch   1,  Average loss: 0.0104, Accuracy: 618/678 (91.1504%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 4.7810, Accuracy: 1070/10000 (10.7000%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  22, local model 96, internal_epoch   1,  Average loss: 0.0161, Accuracy: 361/505 (71.4851%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 5.2643, Accuracy: 2734/10000 (27.3400%), Attack Success Rate:1/10000(0.010)
time spent on training: 49.63678526878357
[foolsgold agg] training data poison_ratio: 0.12437655860349127  data num: [5, 179, 63, 28, 399, 171, 978, 202, 678, 505]
[foolsgold agg] considering poison per batch poison_fraction: 0.12437655860349127
[foolsgold agg] wv: [1.         0.         1.         0.6932008  1.         0.
 0.         0.97815488 0.         0.6932008 ]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 1.9283, Accuracy: 5573/10000 (55.7300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 1.8878, Accuracy: 5555/8991 (61.7840%)
Done in 87.92074227333069 sec.
Server Epoch:23 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0115, Accuracy: 627/704 (89.0625%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.0415, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:19/10000(0.190)
___Train Local_Simple,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0273, Accuracy: 95/114 (83.3333%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.7918, Accuracy: 2845/10000 (28.4500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  23, local model 85, internal_epoch   1,  Average loss: 0.4173, Accuracy: 4/4 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.8555, Accuracy: 5249/10000 (52.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0336, Accuracy: 81/94 (86.1702%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.8713, Accuracy: 2403/10000 (24.0300%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0439, Accuracy: 53/87 (60.9195%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.7830, Accuracy: 3825/10000 (38.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 61, internal_epoch   1,  Average loss: 0.0100, Accuracy: 700/767 (91.2647%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.4232, Accuracy: 2920/10000 (29.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0071, Accuracy: 1185/1311 (90.3890%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.4170, Accuracy: 2000/10000 (20.0000%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0559, Accuracy: 24/34 (70.5882%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.8720, Accuracy: 5828/10000 (58.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0493, Accuracy: 41/69 (59.4203%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.7359, Accuracy: 3413/10000 (34.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 75, internal_epoch   1,  Average loss: 0.0111, Accuracy: 454/497 (91.3481%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 10.0236, Accuracy: 2035/10000 (20.3500%), Attack Success Rate:10/10000(0.100)
time spent on training: 43.280714988708496
[foolsgold agg] training data poison_ratio: 0.0  data num: [704, 114, 4, 94, 87, 767, 1311, 34, 69, 497]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         0.         1.         1.         0.         1.
 0.         0.83452113 0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 1.8945, Accuracy: 5490/10000 (54.9000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 1.8502, Accuracy: 5471/8991 (60.8497%)
Done in 86.85856676101685 sec.
Server Epoch:24 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
___Train Local_Simple,  epoch  24, local model 36, internal_epoch   1,  Average loss: 0.0156, Accuracy: 290/304 (95.3947%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 8.8383, Accuracy: 974/10000 (9.7400%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0081, Accuracy: 1161/1326 (87.5566%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.4541, Accuracy: 2914/10000 (29.1400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  24, local model 96, internal_epoch   1,  Average loss: 0.0134, Accuracy: 404/505 (80.0000%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 9.3607, Accuracy: 2729/10000 (27.2900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  24, local model 83, internal_epoch   1,  Average loss: 0.0130, Accuracy: 599/750 (79.8667%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.2068, Accuracy: 3814/10000 (38.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2834/3022 (93.7790%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.0713, Accuracy: 2562/10000 (25.6200%), Attack Success Rate:3/10000(0.030)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0149, Accuracy: 599/818 (73.2274%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   2,  Average loss: 0.0027, Accuracy: 784/818 (95.8435%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   3,  Average loss: 0.0008, Accuracy: 804/818 (98.2885%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   4,  Average loss: 0.0006, Accuracy: 808/818 (98.7775%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   5,  Average loss: 0.0005, Accuracy: 808/818 (98.7775%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   6,  Average loss: 0.0005, Accuracy: 809/818 (98.8998%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   7,  Average loss: 0.0004, Accuracy: 810/818 (99.0220%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   8,  Average loss: 0.0004, Accuracy: 810/818 (99.0220%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   9,  Average loss: 0.0003, Accuracy: 810/818 (99.0220%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch  10,  Average loss: 0.0003, Accuracy: 811/818 (99.1443%), train_poison_data_count: 818
Global model norm: 14.285378958989963.
Norm before scaling: 15.02894850656195. Distance: 3.736008673819167
Total norm for 2 adversaries is: 15.02894850656195. distance: 3.736008673819167
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 4.9303, Accuracy: 3688/8991 (41.0188%)
___Train Local_Simple,  epoch  24, local model 94, internal_epoch   1,  Average loss: 0.0153, Accuracy: 521/607 (85.8320%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.0584, Accuracy: 1993/10000 (19.9300%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0305, Accuracy: 75/128 (58.5938%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.7450, Accuracy: 6096/10000 (60.9600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0086, Accuracy: 659/705 (93.4752%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 11.3652, Accuracy: 1424/10000 (14.2400%), Attack Success Rate:21/10000(0.210)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   1,  Average loss: 0.0173, Accuracy: 149/151 (98.6755%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   2,  Average loss: 0.0005, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   3,  Average loss: 0.0015, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   4,  Average loss: 0.0005, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   5,  Average loss: 0.0005, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   6,  Average loss: 0.0005, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   7,  Average loss: 0.0005, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   8,  Average loss: 0.0004, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   9,  Average loss: 0.0004, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch  10,  Average loss: 0.0004, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Global model norm: 14.285378958989963.
Norm before scaling: 14.510019983847046. Distance: 1.7194353991167681
Total norm for 2 adversaries is: 14.510019983847046. distance: 1.7194353991167681
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 8.5249, Accuracy: 1261/8991 (14.0251%)
time spent on training: 68.37413215637207
[foolsgold agg] training data poison_ratio: 0.11652236652236653  data num: [304, 1326, 505, 750, 3022, 818, 607, 128, 705, 151]
[foolsgold agg] considering poison per batch poison_fraction: 0.11652236652236653
[foolsgold agg] wv: [1.         1.         0.74516466 1.         1.         1.
 1.         0.4888949  0.4888949  0.74516466]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 1.7662, Accuracy: 5755/10000 (57.5500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 1.7204, Accuracy: 5748/8991 (63.9306%)
Done in 106.51724982261658 sec.
Server Epoch:25 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
___Train Local_Simple,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0120, Accuracy: 341/388 (87.8866%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 17.3248, Accuracy: 1803/10000 (18.0300%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0129, Accuracy: 1582/1982 (79.8184%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 7.9022, Accuracy: 2508/10000 (25.0800%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.0076, Accuracy: 871/978 (89.0593%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.9436, Accuracy: 2741/10000 (27.4100%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0269, Accuracy: 84/94 (89.3617%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.8650, Accuracy: 2920/10000 (29.2000%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2120/2180 (97.2477%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0007, Accuracy: 2153/2180 (98.7615%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   3,  Average loss: 0.0002, Accuracy: 2173/2180 (99.6789%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   4,  Average loss: 0.0002, Accuracy: 2176/2180 (99.8165%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   5,  Average loss: 0.0002, Accuracy: 2177/2180 (99.8624%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2177/2180 (99.8624%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2177/2180 (99.8624%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2177/2180 (99.8624%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2177/2180 (99.8624%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2177/2180 (99.8624%), train_poison_data_count: 2180
Global model norm: 14.323663747088188.
Norm before scaling: 14.80615304421611. Distance: 3.2987055464940642
Total norm for 1 adversaries is: 14.80615304421611. distance: 3.2987055464940642
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 3.6520, Accuracy: 3760/8991 (41.8196%)
___Train Local_Simple,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0083, Accuracy: 1076/1205 (89.2946%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.6124, Accuracy: 1790/10000 (17.9000%), Attack Success Rate:24/10000(0.240)
___Train Local_Simple,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.2381, Accuracy: 5/6 (83.3333%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.6561, Accuracy: 5517/10000 (55.1700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0189, Accuracy: 144/171 (84.2105%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.8858, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0143, Accuracy: 570/762 (74.8031%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.9691, Accuracy: 3673/10000 (36.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0267, Accuracy: 705/1010 (69.8020%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.8027, Accuracy: 2344/10000 (23.4400%), Attack Success Rate:2/10000(0.020)
time spent on training: 75.55260992050171
[foolsgold agg] training data poison_ratio: 0.24840474020054695  data num: [388, 1982, 978, 94, 2180, 1205, 6, 171, 762, 1010]
[foolsgold agg] considering poison per batch poison_fraction: 0.24840474020054695
[foolsgold agg] wv: [0.         0.48253193 1.         1.         1.         0.10012171
 1.         0.         0.10012171 1.        ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 1.7840, Accuracy: 5771/10000 (57.7100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 1.7371, Accuracy: 5767/8991 (64.1419%)
Done in 113.19106411933899 sec.
Server Epoch:26 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
___Train Local_Simple,  epoch  26, local model 39, internal_epoch   1,  Average loss: 0.0061, Accuracy: 1195/1259 (94.9166%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.7295, Accuracy: 2812/10000 (28.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0465, Accuracy: 0/48 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.7608, Accuracy: 6279/10000 (62.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 32, internal_epoch   1,  Average loss: 0.0791, Accuracy: 0/28 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.7409, Accuracy: 6092/10000 (60.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0141, Accuracy: 390/463 (84.2333%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 14.4591, Accuracy: 892/10000 (8.9200%), Attack Success Rate:5/10000(0.050)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   1,  Average loss: 0.0131, Accuracy: 610/818 (74.5721%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   2,  Average loss: 0.0021, Accuracy: 779/818 (95.2323%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   3,  Average loss: 0.0014, Accuracy: 800/818 (97.7995%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   4,  Average loss: 0.0006, Accuracy: 808/818 (98.7775%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   5,  Average loss: 0.0005, Accuracy: 807/818 (98.6553%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   6,  Average loss: 0.0004, Accuracy: 812/818 (99.2665%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   7,  Average loss: 0.0003, Accuracy: 812/818 (99.2665%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   8,  Average loss: 0.0003, Accuracy: 812/818 (99.2665%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   9,  Average loss: 0.0003, Accuracy: 813/818 (99.3888%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch  10,  Average loss: 0.0003, Accuracy: 813/818 (99.3888%), train_poison_data_count: 818
Global model norm: 14.357942495194516.
Norm before scaling: 15.074212676534149. Distance: 3.6176625675140817
Total norm for 1 adversaries is: 15.074212676534149. distance: 3.6176625675140817
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 5.4225, Accuracy: 3754/8991 (41.7529%)
___Train Local_Simple,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2840/3022 (93.9775%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.7198, Accuracy: 2410/10000 (24.1000%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0078, Accuracy: 405/428 (94.6262%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 17.5101, Accuracy: 1944/10000 (19.4400%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0096, Accuracy: 849/1010 (84.0594%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 12.7373, Accuracy: 3712/10000 (37.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0147, Accuracy: 482/607 (79.4069%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.1049, Accuracy: 2450/10000 (24.5000%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  26, local model 84, internal_epoch   1,  Average loss: 0.0763, Accuracy: 1/29 (3.4483%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.7442, Accuracy: 5784/10000 (57.8400%), Attack Success Rate:0/10000(0.000)
time spent on training: 62.94606590270996
[foolsgold agg] training data poison_ratio: 0.10606846473029045  data num: [1259, 48, 28, 463, 818, 3022, 428, 1010, 607, 29]
[foolsgold agg] considering poison per batch poison_fraction: 0.10606846473029045
[foolsgold agg] wv: [1.         1.         0.         1.         1.         0.35075425
 1.         1.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 1.7007, Accuracy: 5991/10000 (59.9100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 1.6491, Accuracy: 5985/8991 (66.5666%)
Done in 104.24256801605225 sec.
Server Epoch:27 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
___Train Local_Simple,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.0117, Accuracy: 531/586 (90.6143%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.8933, Accuracy: 1860/10000 (18.6000%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0269, Accuracy: 87/119 (73.1092%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.5084, Accuracy: 4434/10000 (44.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 42, internal_epoch   1,  Average loss: 0.0225, Accuracy: 60/63 (95.2381%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.6358, Accuracy: 5202/10000 (52.0200%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0279, Accuracy: 88/128 (68.7500%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.4698, Accuracy: 6255/10000 (62.5500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0245, Accuracy: 85/94 (90.4255%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.8625, Accuracy: 3163/10000 (31.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0103, Accuracy: 509/578 (88.0623%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 6.3913, Accuracy: 2800/10000 (28.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 45, internal_epoch   1,  Average loss: 0.0105, Accuracy: 344/388 (88.6598%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 21.2928, Accuracy: 1952/10000 (19.5200%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch  27, local model 54, internal_epoch   1,  Average loss: 0.0391, Accuracy: 55/91 (60.4396%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.5198, Accuracy: 6766/10000 (67.6600%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   1,  Average loss: 0.0107, Accuracy: 662/818 (80.9291%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   2,  Average loss: 0.0014, Accuracy: 798/818 (97.5550%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   3,  Average loss: 0.0007, Accuracy: 811/818 (99.1443%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   4,  Average loss: 0.0004, Accuracy: 810/818 (99.0220%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   5,  Average loss: 0.0003, Accuracy: 812/818 (99.2665%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   6,  Average loss: 0.0002, Accuracy: 814/818 (99.5110%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   7,  Average loss: 0.0002, Accuracy: 813/818 (99.3888%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Global model norm: 14.389622424528998.
Norm before scaling: 15.068399753874932. Distance: 3.421790831763083
Total norm for 1 adversaries is: 15.068399753874932. distance: 3.421790831763083
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 9.5810, Accuracy: 3821/8991 (42.4981%)
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0181, Accuracy: 222/300 (74.0000%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 5.7002, Accuracy: 2028/10000 (20.2800%), Attack Success Rate:7/10000(0.070)
time spent on training: 53.71452212333679
[foolsgold agg] training data poison_ratio: 0.2584518167456556  data num: [586, 119, 63, 128, 94, 578, 388, 91, 818, 300]
[foolsgold agg] considering poison per batch poison_fraction: 0.2584518167456556
[foolsgold agg] wv: [0. 0. 0. 0. 0. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 1.5917, Accuracy: 7020/10000 (70.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 1.5252, Accuracy: 7009/8991 (77.9557%)
Done in 91.8439359664917 sec.
Server Epoch:28 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
___Train Local_Simple,  epoch  28, local model 33, internal_epoch   1,  Average loss: 0.0140, Accuracy: 497/644 (77.1739%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.8169, Accuracy: 3574/10000 (35.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0082, Accuracy: 245/259 (94.5946%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 3.6282, Accuracy: 2589/10000 (25.8900%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0211, Accuracy: 84/94 (89.3617%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.9028, Accuracy: 3192/10000 (31.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2858/3022 (94.5731%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.9550, Accuracy: 2475/10000 (24.7500%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 1817/1982 (91.6751%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 5.7403, Accuracy: 3641/10000 (36.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.2766, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.4660, Accuracy: 6353/10000 (63.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0189, Accuracy: 98/114 (85.9649%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.5658, Accuracy: 3859/10000 (38.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 35, internal_epoch   1,  Average loss: 0.0075, Accuracy: 901/978 (92.1268%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.0617, Accuracy: 2777/10000 (27.7700%), Attack Success Rate:0/10000(0.000)
poison local model 80 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   1,  Average loss: 0.0346, Accuracy: 66/84 (78.5714%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   2,  Average loss: 0.0069, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   3,  Average loss: 0.0028, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   4,  Average loss: 0.0032, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   5,  Average loss: 0.0033, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   6,  Average loss: 0.0028, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   7,  Average loss: 0.0017, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   8,  Average loss: 0.0026, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   9,  Average loss: 0.0013, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch  10,  Average loss: 0.0029, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Global model norm: 14.412674602896729.
Norm before scaling: 14.540985062299983. Distance: 1.249144881535454
Total norm for 1 adversaries is: 14.540985062299983. distance: 1.249144881535454
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 4.2889, Accuracy: 1418/8991 (15.7713%)
___Train Local_Simple,  epoch  28, local model 81, internal_epoch   1,  Average loss: 0.0517, Accuracy: 58/68 (85.2941%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.4326, Accuracy: 6530/10000 (65.3000%), Attack Success Rate:0/10000(0.000)
time spent on training: 54.121726989746094
[foolsgold agg] training data poison_ratio: 0.011586206896551723  data num: [644, 259, 94, 3022, 1982, 5, 114, 978, 84, 68]
[foolsgold agg] considering poison per batch poison_fraction: 0.011586206896551723
[foolsgold agg] wv: [0.38004947 1.         0.38004947 1.         1.         0.
 0.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 1.5064, Accuracy: 7284/10000 (72.8400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 1.4461, Accuracy: 7275/8991 (80.9142%)
Done in 92.87951636314392 sec.
Server Epoch:29 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
___Train Local_Simple,  epoch  29, local model 58, internal_epoch   1,  Average loss: 0.0093, Accuracy: 892/1015 (87.8818%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.9752, Accuracy: 4677/10000 (46.7700%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   1,  Average loss: 0.0066, Accuracy: 701/768 (91.2760%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   2,  Average loss: 0.0017, Accuracy: 746/768 (97.1354%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   3,  Average loss: 0.0009, Accuracy: 753/768 (98.0469%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   4,  Average loss: 0.0007, Accuracy: 756/768 (98.4375%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   5,  Average loss: 0.0005, Accuracy: 759/768 (98.8281%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   6,  Average loss: 0.0005, Accuracy: 759/768 (98.8281%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   7,  Average loss: 0.0004, Accuracy: 759/768 (98.8281%), train_poison_data_count: 768
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   8,  Average loss: 0.0004, Accuracy: 760/768 (98.9583%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   9,  Average loss: 0.0004, Accuracy: 762/768 (99.2188%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch  10,  Average loss: 0.0004, Accuracy: 762/768 (99.2188%), train_poison_data_count: 768
Global model norm: 14.440914922667156.
Norm before scaling: 14.86580906149189. Distance: 2.584294376245807
Total norm for 3 adversaries is: 14.86580906149189. distance: 2.584294376245807
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 3.7727, Accuracy: 2966/8991 (32.9885%)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0083, Accuracy: 743/818 (90.8313%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   2,  Average loss: 0.0012, Accuracy: 805/818 (98.4108%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   3,  Average loss: 0.0004, Accuracy: 811/818 (99.1443%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   4,  Average loss: 0.0003, Accuracy: 813/818 (99.3888%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   5,  Average loss: 0.0002, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 815/818 (99.6333%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 14.440914922667156.
Norm before scaling: 15.029597264907416. Distance: 3.084911320677681
Total norm for 3 adversaries is: 15.029597264907416. distance: 3.084911320677681
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 9.1819, Accuracy: 3853/8991 (42.8540%)
___Train Local_Simple,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.1510, Accuracy: 7/10 (70.0000%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.3838, Accuracy: 7002/10000 (70.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0306, Accuracy: 408/509 (80.1572%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 15.2741, Accuracy: 974/10000 (9.7400%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0251, Accuracy: 91/128 (71.0938%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.2364, Accuracy: 7114/10000 (71.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 897/994 (90.2414%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.9869, Accuracy: 6081/10000 (60.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 91, internal_epoch   1,  Average loss: 0.0200, Accuracy: 160/182 (87.9121%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.6654, Accuracy: 3561/10000 (35.6100%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0077, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0004, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   3,  Average loss: 0.0002, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   4,  Average loss: 0.0002, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   5,  Average loss: 0.0006, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   6,  Average loss: 0.0002, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   7,  Average loss: 0.0002, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   8,  Average loss: 0.0002, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch  10,  Average loss: 0.0004, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Global model norm: 14.440914922667156.
Norm before scaling: 14.59713411813739. Distance: 1.2518054797732627
Total norm for 3 adversaries is: 14.59713411813739. distance: 1.2518054797732627
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 5.2832, Accuracy: 2076/8991 (23.0898%)
___Train Local_Simple,  epoch  29, local model 57, internal_epoch   1,  Average loss: 0.0073, Accuracy: 1292/1437 (89.9095%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.1892, Accuracy: 3920/10000 (39.2000%), Attack Success Rate:0/10000(0.000)
time spent on training: 75.91288805007935
[foolsgold agg] training data poison_ratio: 0.28892215568862273  data num: [1015, 768, 818, 10, 509, 128, 994, 182, 151, 1437]
[foolsgold agg] considering poison per batch poison_fraction: 0.28892215568862273
[foolsgold agg] wv: [0.26106902 0.18161473 1.         0.18161473 1.         0.34140954
 0.44065224 0.26106902 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 1.5759, Accuracy: 5979/10000 (59.7900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 1.5200, Accuracy: 5967/8991 (66.3664%)
Done in 117.75067090988159 sec.
Server Epoch:30 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   1,  Average loss: 0.0075, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   2,  Average loss: 0.0004, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   3,  Average loss: 0.0001, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   4,  Average loss: 0.0001, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Global model norm: 14.476975148429391.
Norm before scaling: 14.629485135408848. Distance: 1.2353309599473954
Total norm for 4 adversaries is: 14.629485135408848. distance: 1.2353309599473954
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 5.0298, Accuracy: 1824/8991 (20.2870%)
___Train Local_Simple,  epoch  30, local model 77, internal_epoch   1,  Average loss: 0.0049, Accuracy: 1423/1544 (92.1632%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.1404, Accuracy: 4237/10000 (42.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 1087/1205 (90.2075%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.3060, Accuracy: 1924/10000 (19.2400%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  30, local model 21, internal_epoch   1,  Average loss: 0.0045, Accuracy: 1955/2072 (94.3533%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.0001, Accuracy: 2885/10000 (28.8500%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0074, Accuracy: 643/688 (93.4593%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   2,  Average loss: 0.0030, Accuracy: 663/688 (96.3663%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   3,  Average loss: 0.0012, Accuracy: 670/688 (97.3837%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   4,  Average loss: 0.0007, Accuracy: 677/688 (98.4012%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   5,  Average loss: 0.0004, Accuracy: 684/688 (99.4186%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   6,  Average loss: 0.0003, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   7,  Average loss: 0.0002, Accuracy: 685/688 (99.5640%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   8,  Average loss: 0.0002, Accuracy: 685/688 (99.5640%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   9,  Average loss: 0.0002, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch  10,  Average loss: 0.0002, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Global model norm: 14.476975148429391.
Norm before scaling: 15.023733055790116. Distance: 2.7916870590907528
Total norm for 4 adversaries is: 15.023733055790116. distance: 2.7916870590907528
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 6.3901, Accuracy: 2898/8991 (32.2322%)
___Train Local_Simple,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0223, Accuracy: 109/171 (63.7427%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.3217, Accuracy: 1636/10000 (16.3600%), Attack Success Rate:24/10000(0.240)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0112, Accuracy: 388/436 (88.9908%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   2,  Average loss: 0.0044, Accuracy: 403/436 (92.4312%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   3,  Average loss: 0.0024, Accuracy: 417/436 (95.6422%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   4,  Average loss: 0.0011, Accuracy: 426/436 (97.7064%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   5,  Average loss: 0.0008, Accuracy: 431/436 (98.8532%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   6,  Average loss: 0.0007, Accuracy: 431/436 (98.8532%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   7,  Average loss: 0.0006, Accuracy: 432/436 (99.0826%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   8,  Average loss: 0.0005, Accuracy: 432/436 (99.0826%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   9,  Average loss: 0.0005, Accuracy: 433/436 (99.3119%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch  10,  Average loss: 0.0005, Accuracy: 433/436 (99.3119%), train_poison_data_count: 436
Global model norm: 14.476975148429391.
Norm before scaling: 14.854909456504187. Distance: 2.1568989537339602
Total norm for 4 adversaries is: 14.854909456504187. distance: 2.1568989537339602
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 3.3959, Accuracy: 3703/8991 (41.1856%)
___Train Local_Simple,  epoch  30, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 659/705 (93.4752%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 9.0728, Accuracy: 1870/10000 (18.7000%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch  30, local model 45, internal_epoch   1,  Average loss: 0.0118, Accuracy: 313/388 (80.6701%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 16.5093, Accuracy: 1974/10000 (19.7400%), Attack Success Rate:12/10000(0.120)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   1,  Average loss: 0.0089, Accuracy: 721/818 (88.1418%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   2,  Average loss: 0.0015, Accuracy: 797/818 (97.4328%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   3,  Average loss: 0.0006, Accuracy: 807/818 (98.6553%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   4,  Average loss: 0.0004, Accuracy: 809/818 (98.8998%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   5,  Average loss: 0.0003, Accuracy: 811/818 (99.1443%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   6,  Average loss: 0.0002, Accuracy: 813/818 (99.3888%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 14.476975148429391.
Norm before scaling: 15.128728737985194. Distance: 3.2079410726029507
Total norm for 4 adversaries is: 15.128728737985194. distance: 3.2079410726029507
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 8.2417, Accuracy: 3837/8991 (42.6760%)
time spent on training: 100.69327902793884
[foolsgold agg] training data poison_ratio: 0.25593054536561505  data num: [151, 1544, 1205, 2072, 688, 171, 436, 705, 388, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.25593054536561505
[foolsgold agg] wv: [1. 1. 1. 1. 1. 0. 1. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 1.4485, Accuracy: 6837/10000 (68.3700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 1.3759, Accuracy: 6812/8991 (75.7647%)
Done in 139.5789189338684 sec.
Server Epoch:31 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
___Train Local_Simple,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0094, Accuracy: 647/762 (84.9081%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.4530, Accuracy: 3837/10000 (38.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0153, Accuracy: 192/263 (73.0038%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 9.5415, Accuracy: 1866/10000 (18.6600%), Attack Success Rate:20/10000(0.200)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0027, Accuracy: 405/411 (98.5401%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 6.1657, Accuracy: 2926/10000 (29.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 85, internal_epoch   1,  Average loss: 0.3705, Accuracy: 3/4 (75.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.3741, Accuracy: 6890/10000 (68.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0132, Accuracy: 428/463 (92.4406%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 7.7356, Accuracy: 995/10000 (9.9500%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0246, Accuracy: 70/84 (83.3333%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.4864, Accuracy: 5149/10000 (51.4900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  31, local model 24, internal_epoch   1,  Average loss: 0.2553, Accuracy: 4/5 (80.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.3181, Accuracy: 6724/10000 (67.2400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0159, Accuracy: 60/63 (95.2381%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.4472, Accuracy: 5992/10000 (59.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0074, Accuracy: 372/428 (86.9159%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 11.4521, Accuracy: 1977/10000 (19.7700%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  31, local model 25, internal_epoch   1,  Average loss: 0.0247, Accuracy: 81/128 (63.2812%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.1700, Accuracy: 7194/10000 (71.9400%), Attack Success Rate:0/10000(0.000)
time spent on training: 48.34163212776184
[foolsgold agg] training data poison_ratio: 0.0  data num: [762, 263, 411, 4, 463, 84, 5, 63, 428, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.         0.         0.8798039  0.03696559 1.         0.
 1.         0.         0.03696559 1.        ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 1.4019, Accuracy: 7020/10000 (70.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 1.3265, Accuracy: 6996/8991 (77.8111%)
Done in 91.6071617603302 sec.
Server Epoch:32 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0608, Accuracy: 11/30 (36.6667%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.2968, Accuracy: 7675/10000 (76.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.0381, Accuracy: 32/33 (96.9697%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.3019, Accuracy: 7012/10000 (70.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2600/2803 (92.7578%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.0811, Accuracy: 4879/10000 (48.7900%), Attack Success Rate:1/10000(0.010)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   1,  Average loss: 0.0124, Accuracy: 451/569 (79.2619%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   2,  Average loss: 0.0037, Accuracy: 523/569 (91.9156%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   3,  Average loss: 0.0016, Accuracy: 553/569 (97.1880%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   4,  Average loss: 0.0010, Accuracy: 557/569 (97.8910%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   5,  Average loss: 0.0008, Accuracy: 559/569 (98.2425%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   6,  Average loss: 0.0007, Accuracy: 562/569 (98.7698%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   7,  Average loss: 0.0006, Accuracy: 564/569 (99.1213%), train_poison_data_count: 569
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   8,  Average loss: 0.0005, Accuracy: 565/569 (99.2970%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   9,  Average loss: 0.0005, Accuracy: 565/569 (99.2970%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch  10,  Average loss: 0.0005, Accuracy: 565/569 (99.2970%), train_poison_data_count: 569
Global model norm: 14.538343047923362.
Norm before scaling: 15.075545743613178. Distance: 2.567496383203858
Total norm for 3 adversaries is: 15.075545743613178. distance: 2.567496383203858
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 1.6112, Accuracy: 6544/8991 (72.7839%)
___Train Local_Simple,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0118, Accuracy: 883/1033 (85.4792%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.4102, Accuracy: 3644/10000 (36.4400%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   1,  Average loss: 0.0093, Accuracy: 655/768 (85.2865%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   2,  Average loss: 0.0019, Accuracy: 730/768 (95.0521%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   3,  Average loss: 0.0010, Accuracy: 749/768 (97.5260%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   4,  Average loss: 0.0008, Accuracy: 755/768 (98.3073%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   5,  Average loss: 0.0007, Accuracy: 755/768 (98.3073%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   6,  Average loss: 0.0006, Accuracy: 755/768 (98.3073%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   7,  Average loss: 0.0006, Accuracy: 757/768 (98.5677%), train_poison_data_count: 768
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   8,  Average loss: 0.0006, Accuracy: 757/768 (98.5677%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   9,  Average loss: 0.0005, Accuracy: 758/768 (98.6979%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch  10,  Average loss: 0.0005, Accuracy: 758/768 (98.6979%), train_poison_data_count: 768
Global model norm: 14.538343047923362.
Norm before scaling: 15.03790021888575. Distance: 3.072213940631296
Total norm for 3 adversaries is: 15.03790021888575. distance: 3.072213940631296
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 3.6409, Accuracy: 2938/8991 (32.6771%)
___Train Local_Simple,  epoch  32, local model 91, internal_epoch   1,  Average loss: 0.0198, Accuracy: 147/182 (80.7692%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.3105, Accuracy: 4981/10000 (49.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 86, internal_epoch   1,  Average loss: 0.0344, Accuracy: 31/34 (91.1765%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.3097, Accuracy: 6750/10000 (67.5000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  32, local model 67, internal_epoch   1,  Average loss: 0.0116, Accuracy: 462/568 (81.3380%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.0496, Accuracy: 5421/10000 (54.2100%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0014, Accuracy: 2144/2180 (98.3486%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 2168/2180 (99.4495%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Global model norm: 14.538343047923362.
Norm before scaling: 14.67498479839103. Distance: 2.0912548399400084
Total norm for 3 adversaries is: 14.67498479839103. distance: 2.0912548399400084
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 2.1328, Accuracy: 4410/8991 (49.0490%)
time spent on training: 96.41947817802429
[foolsgold agg] training data poison_ratio: 0.42890243902439024  data num: [30, 33, 2803, 569, 1033, 768, 182, 34, 568, 2180]
[foolsgold agg] considering poison per batch poison_fraction: 0.42890243902439024
[foolsgold agg] wv: [0.74339459 1.         1.         1.         1.         0.74339459
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 1.1917, Accuracy: 7666/10000 (76.6600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 1.0939, Accuracy: 7636/8991 (84.9294%)
Done in 134.41590404510498 sec.
Server Epoch:33 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
___Train Local_Simple,  epoch  33, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 1464/1544 (94.8187%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.5548, Accuracy: 4426/10000 (44.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0043, Accuracy: 1324/1437 (92.1364%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.1387, Accuracy: 3647/10000 (36.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 21, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2004/2072 (96.7181%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.0501, Accuracy: 2939/10000 (29.3900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.0098, Accuracy: 474/568 (83.4507%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.4101, Accuracy: 5558/10000 (55.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0312, Accuracy: 38/48 (79.1667%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.1258, Accuracy: 7271/10000 (72.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 97, internal_epoch   1,  Average loss: 0.1254, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.2334, Accuracy: 7154/10000 (71.5400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0109, Accuracy: 198/237 (83.5443%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.9484, Accuracy: 2648/10000 (26.4800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  33, local model 22, internal_epoch   1,  Average loss: 0.0483, Accuracy: 20/34 (58.8235%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.0923, Accuracy: 8025/10000 (80.2500%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   1,  Average loss: 0.0099, Accuracy: 477/569 (83.8313%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   2,  Average loss: 0.0028, Accuracy: 534/569 (93.8489%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   3,  Average loss: 0.0016, Accuracy: 548/569 (96.3093%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   4,  Average loss: 0.0009, Accuracy: 558/569 (98.0668%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   5,  Average loss: 0.0007, Accuracy: 560/569 (98.4183%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   6,  Average loss: 0.0005, Accuracy: 564/569 (99.1213%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   7,  Average loss: 0.0004, Accuracy: 565/569 (99.2970%), train_poison_data_count: 569
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   8,  Average loss: 0.0004, Accuracy: 565/569 (99.2970%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   9,  Average loss: 0.0003, Accuracy: 566/569 (99.4728%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch  10,  Average loss: 0.0003, Accuracy: 566/569 (99.4728%), train_poison_data_count: 569
Global model norm: 14.597357816557398.
Norm before scaling: 15.103173514851989. Distance: 2.376117844777078
Total norm for 1 adversaries is: 15.103173514851989. distance: 2.376117844777078
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 1.3945, Accuracy: 6571/8991 (73.0842%)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0478, Accuracy: 21/30 (70.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.0822, Accuracy: 7842/10000 (78.4200%), Attack Success Rate:0/10000(0.000)
time spent on training: 57.22289991378784
[foolsgold agg] training data poison_ratio: 0.08694987775061125  data num: [1544, 1437, 2072, 568, 48, 5, 237, 34, 569, 30]
[foolsgold agg] considering poison per batch poison_fraction: 0.08694987775061125
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 0. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 1.0461, Accuracy: 7921/10000 (79.2100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.9480, Accuracy: 7884/8991 (87.6877%)
Done in 93.54172587394714 sec.
Server Epoch:34 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
___Train Local_Simple,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0080, Accuracy: 542/578 (93.7716%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 10.7118, Accuracy: 2012/10000 (20.1200%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0048, Accuracy: 187/196 (95.4082%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.6661, Accuracy: 2575/10000 (25.7500%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0071, Accuracy: 453/509 (88.9980%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 11.0312, Accuracy: 1793/10000 (17.9300%), Attack Success Rate:18/10000(0.180)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0045, Accuracy: 149/151 (98.6755%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0004, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 14.637762777183328.
Norm before scaling: 14.729100825672031. Distance: 0.9087907756278515
Total norm for 2 adversaries is: 14.729100825672031. distance: 0.9087907756278515
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 2.5897, Accuracy: 3890/8991 (43.2655%)
___Train Local_Simple,  epoch  34, local model 71, internal_epoch   1,  Average loss: 0.0113, Accuracy: 274/342 (80.1170%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.3363, Accuracy: 5641/10000 (56.4100%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   1,  Average loss: 0.0071, Accuracy: 391/399 (97.9950%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   2,  Average loss: 0.0005, Accuracy: 395/399 (98.9975%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   3,  Average loss: 0.0007, Accuracy: 397/399 (99.4987%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   4,  Average loss: 0.0007, Accuracy: 397/399 (99.4987%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   5,  Average loss: 0.0006, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   6,  Average loss: 0.0005, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   7,  Average loss: 0.0004, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   8,  Average loss: 0.0003, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   9,  Average loss: 0.0002, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch  10,  Average loss: 0.0002, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Global model norm: 14.637762777183328.
Norm before scaling: 15.061680941650767. Distance: 2.536901781195011
Total norm for 2 adversaries is: 15.061680941650767. distance: 2.536901781195011
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 19.7254, Accuracy: 2060/8991 (22.9118%)
___Train Local_Simple,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0125, Accuracy: 58/63 (92.0635%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.1071, Accuracy: 7472/10000 (74.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0058, Accuracy: 688/750 (91.7333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.0856, Accuracy: 5239/10000 (52.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 1241/1311 (94.6606%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.7502, Accuracy: 2027/10000 (20.2700%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  34, local model 48, internal_epoch   1,  Average loss: 0.0140, Accuracy: 125/128 (97.6562%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.0084, Accuracy: 6307/10000 (63.0700%), Attack Success Rate:0/10000(0.000)
time spent on training: 55.176433801651
[foolsgold agg] training data poison_ratio: 0.1242376327083804  data num: [578, 196, 509, 151, 342, 399, 63, 750, 1311, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.1242376327083804
[foolsgold agg] wv: [0.81079667 1.         0.71964243 0.95742085 0.38011078 0.71964243
 1.         1.         1.         0.38011078]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.9673, Accuracy: 7898/10000 (78.9800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.8508, Accuracy: 7859/8991 (87.4096%)
Done in 92.25251269340515 sec.
Server Epoch:35 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   1,  Average loss: 0.0038, Accuracy: 149/151 (98.6755%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   2,  Average loss: 0.0004, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   4,  Average loss: 0.0001, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 14.668661559870001.
Norm before scaling: 14.750216207697706. Distance: 0.8315461584848723
Total norm for 2 adversaries is: 14.750216207697706. distance: 0.8315461584848723
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 2.2388, Accuracy: 4363/8991 (48.5263%)
___Train Local_Simple,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0052, Accuracy: 294/304 (96.7105%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 10.9468, Accuracy: 1119/10000 (11.1900%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch  35, local model 53, internal_epoch   1,  Average loss: 0.0127, Accuracy: 428/456 (93.8596%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 7.6715, Accuracy: 2752/10000 (27.5200%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.0280, Accuracy: 24/25 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.9453, Accuracy: 6836/10000 (68.3600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0081, Accuracy: 539/644 (83.6957%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.5335, Accuracy: 4899/10000 (48.9900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  35, local model 25, internal_epoch   1,  Average loss: 0.0156, Accuracy: 96/128 (75.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.7550, Accuracy: 8003/10000 (80.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0081, Accuracy: 931/1033 (90.1258%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.8700, Accuracy: 3383/10000 (33.8300%), Attack Success Rate:1/10000(0.010)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0180, Accuracy: 75/84 (89.2857%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   2,  Average loss: 0.0069, Accuracy: 78/84 (92.8571%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   3,  Average loss: 0.0041, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   4,  Average loss: 0.0031, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   5,  Average loss: 0.0033, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   6,  Average loss: 0.0030, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   7,  Average loss: 0.0016, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   8,  Average loss: 0.0013, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   9,  Average loss: 0.0010, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch  10,  Average loss: 0.0012, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Global model norm: 14.668661559870001.
Norm before scaling: 14.792366863745661. Distance: 0.8539887258446575
Total norm for 2 adversaries is: 14.792366863745661. distance: 0.8539887258446575
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.0264, Accuracy: 6059/8991 (67.3896%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0034, Accuracy: 1253/1326 (94.4947%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.8227, Accuracy: 2830/10000 (28.3000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  35, local model 98, internal_epoch   1,  Average loss: 0.1438, Accuracy: 5/6 (83.3333%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8857, Accuracy: 8010/10000 (80.1000%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.81962203979492
[foolsgold agg] training data poison_ratio: 0.056531152273273995  data num: [151, 304, 456, 25, 644, 128, 1033, 84, 1326, 6]
[foolsgold agg] considering poison per batch poison_fraction: 0.056531152273273995
[foolsgold agg] wv: [1. 0. 1. 0. 1. 1. 0. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.8998, Accuracy: 7817/10000 (78.1700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.7737, Accuracy: 7781/8991 (86.5421%)
Done in 88.2496268749237 sec.
Server Epoch:36 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  36, local model 82, internal_epoch   1,  Average loss: 0.0056, Accuracy: 108/114 (94.7368%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9275, Accuracy: 7212/10000 (72.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 429/463 (92.6566%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 11.4465, Accuracy: 986/10000 (9.8600%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  36, local model 79, internal_epoch   1,  Average loss: 0.0242, Accuracy: 24/25 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.8970, Accuracy: 6947/10000 (69.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0771, Accuracy: 0/28 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9777, Accuracy: 7811/10000 (78.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 47, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2434/2519 (96.6256%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.5312, Accuracy: 5277/10000 (52.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 44, internal_epoch   1,  Average loss: 0.0169, Accuracy: 43/47 (91.4894%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9340, Accuracy: 7223/10000 (72.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 89, internal_epoch   1,  Average loss: 0.0206, Accuracy: 42/69 (60.8696%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.8452, Accuracy: 7761/10000 (77.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 48, internal_epoch   1,  Average loss: 0.0122, Accuracy: 114/128 (89.0625%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9578, Accuracy: 6525/10000 (65.2500%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   1,  Average loss: 0.0070, Accuracy: 507/569 (89.1037%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   2,  Average loss: 0.0020, Accuracy: 548/569 (96.3093%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   3,  Average loss: 0.0007, Accuracy: 561/569 (98.5940%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   4,  Average loss: 0.0005, Accuracy: 565/569 (99.2970%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   5,  Average loss: 0.0004, Accuracy: 565/569 (99.2970%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   6,  Average loss: 0.0003, Accuracy: 566/569 (99.4728%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   7,  Average loss: 0.0003, Accuracy: 566/569 (99.4728%), train_poison_data_count: 569
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   8,  Average loss: 0.0003, Accuracy: 567/569 (99.6485%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   9,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch  10,  Average loss: 0.0002, Accuracy: 568/569 (99.8243%), train_poison_data_count: 569
Global model norm: 14.691894912605619.
Norm before scaling: 15.133676105488062. Distance: 2.1654161977360666
Total norm for 1 adversaries is: 15.133676105488062. distance: 2.1654161977360666
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 2.0501, Accuracy: 6563/8991 (72.9952%)
___Train Local_Simple,  epoch  36, local model 77, internal_epoch   1,  Average loss: 0.0022, Accuracy: 1488/1544 (96.3731%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.4540, Accuracy: 5157/10000 (51.5700%), Attack Success Rate:0/10000(0.000)
time spent on training: 54.15890908241272
[foolsgold agg] training data poison_ratio: 0.1033418089357065  data num: [114, 463, 25, 28, 2519, 47, 69, 128, 569, 1544]
[foolsgold agg] considering poison per batch poison_fraction: 0.1033418089357065
[foolsgold agg] wv: [0.         0.82108836 1.         0.62674797 0.         1.
 0.         0.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.8244, Accuracy: 7970/10000 (79.7000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.7167, Accuracy: 7935/8991 (88.2549%)
Done in 90.27147006988525 sec.
Server Epoch:37 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
___Train Local_Simple,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0054, Accuracy: 624/678 (92.0354%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.0952, Accuracy: 2644/10000 (26.4400%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0033, Accuracy: 789/818 (96.4548%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0010, Accuracy: 804/818 (98.2885%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   3,  Average loss: 0.0004, Accuracy: 811/818 (99.1443%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   7,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   8,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 14.707199845481188.
Norm before scaling: 15.148224457791507. Distance: 2.5581588258983703
Total norm for 1 adversaries is: 15.148224457791507. distance: 2.5581588258983703
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 11.4464, Accuracy: 3877/8991 (43.1209%)
___Train Local_Simple,  epoch  37, local model 33, internal_epoch   1,  Average loss: 0.0083, Accuracy: 539/644 (83.6957%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 2.2313, Accuracy: 5411/10000 (54.1100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0053, Accuracy: 467/509 (91.7485%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 13.7478, Accuracy: 1262/10000 (12.6200%), Attack Success Rate:24/10000(0.240)
___Train Local_Simple,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0041, Accuracy: 977/1046 (93.4034%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.2918, Accuracy: 2750/10000 (27.5000%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  37, local model 52, internal_epoch   1,  Average loss: 0.0016, Accuracy: 698/705 (99.0071%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 8.8214, Accuracy: 2120/10000 (21.2000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.0555, Accuracy: 8/29 (27.5862%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7575, Accuracy: 8086/10000 (80.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0655, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7910, Accuracy: 7861/10000 (78.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 62, internal_epoch   1,  Average loss: 0.2547, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.8403, Accuracy: 7567/10000 (75.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0078, Accuracy: 224/264 (84.8485%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 6.3031, Accuracy: 1822/10000 (18.2200%), Attack Success Rate:13/10000(0.130)
time spent on training: 53.6015100479126
[foolsgold agg] training data poison_ratio: 0.17400553073814082  data num: [678, 818, 644, 509, 1046, 705, 29, 6, 2, 264]
[foolsgold agg] considering poison per batch poison_fraction: 0.17400553073814082
[foolsgold agg] wv: [1.         0.22265899 0.22265899 1.         0.490427   1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.7305, Accuracy: 8233/10000 (82.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.6408, Accuracy: 8200/8991 (91.2023%)
Done in 91.31146383285522 sec.
Server Epoch:38 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
___Train Local_Simple,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0023, Accuracy: 1215/1259 (96.5052%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.6765, Accuracy: 4048/10000 (40.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 1170/1232 (94.9675%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.0599, Accuracy: 5525/10000 (55.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0178, Accuracy: 33/33 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6816, Accuracy: 8004/10000 (80.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2222/2324 (95.6110%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.7579, Accuracy: 5699/10000 (56.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0053, Accuracy: 434/456 (95.1754%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 8.5371, Accuracy: 2970/10000 (29.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 713/750 (95.0667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.0545, Accuracy: 4748/10000 (47.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0050, Accuracy: 226/244 (92.6230%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.5138, Accuracy: 2318/10000 (23.1800%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  38, local model 45, internal_epoch   1,  Average loss: 0.0049, Accuracy: 357/388 (92.0103%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 6.8368, Accuracy: 2077/10000 (20.7700%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  38, local model 52, internal_epoch   1,  Average loss: 0.0018, Accuracy: 693/705 (98.2979%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 9.9524, Accuracy: 2033/10000 (20.3300%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0100, Accuracy: 85/94 (90.4255%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.2349, Accuracy: 6994/10000 (69.9400%), Attack Success Rate:0/10000(0.000)
time spent on training: 48.086483001708984
[foolsgold agg] training data poison_ratio: 0.0  data num: [1259, 1232, 33, 2324, 456, 750, 244, 388, 705, 94]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         0.         1.         0.         1.
 0.59718355 1.         0.59718355 1.        ]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.6852, Accuracy: 8310/10000 (83.1000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.5814, Accuracy: 8270/8991 (91.9809%)
Done in 86.67515087127686 sec.
Server Epoch:39 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
___Train Local_Simple,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 955/1010 (94.5545%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.7944, Accuracy: 5108/10000 (51.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 34, internal_epoch   1,  Average loss: 0.0044, Accuracy: 1112/1203 (92.4356%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.9711, Accuracy: 5323/10000 (53.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 32, internal_epoch   1,  Average loss: 0.0626, Accuracy: 0/28 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.8569, Accuracy: 8206/10000 (82.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 998/1046 (95.4111%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.7648, Accuracy: 3216/10000 (32.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0030, Accuracy: 1152/1205 (95.6017%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.5257, Accuracy: 3838/10000 (38.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0172, Accuracy: 46/48 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.7148, Accuracy: 7515/10000 (75.1500%), Attack Success Rate:0/10000(0.000)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   1,  Average loss: 0.0036, Accuracy: 414/436 (94.9541%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   2,  Average loss: 0.0008, Accuracy: 428/436 (98.1651%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   3,  Average loss: 0.0006, Accuracy: 430/436 (98.6239%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   4,  Average loss: 0.0004, Accuracy: 434/436 (99.5413%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   5,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   7,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   8,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch  10,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Global model norm: 14.748436796469418.
Norm before scaling: 14.963026636937306. Distance: 1.459267952564642
Total norm for 1 adversaries is: 14.963026636937306. distance: 1.459267952564642
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 2.9935, Accuracy: 4410/8991 (49.0490%)
___Train Local_Simple,  epoch  39, local model 88, internal_epoch   1,  Average loss: 0.0133, Accuracy: 81/96 (84.3750%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.2215, Accuracy: 5252/10000 (52.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0742, Accuracy: 8/10 (80.0000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6882, Accuracy: 8156/10000 (81.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.1306, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6544, Accuracy: 8236/10000 (82.3600%), Attack Success Rate:0/10000(0.000)
time spent on training: 54.067559003829956
[foolsgold agg] training data poison_ratio: 0.08570866915667387  data num: [1010, 1203, 28, 1046, 1205, 48, 436, 96, 10, 5]
[foolsgold agg] considering poison per batch poison_fraction: 0.08570866915667387
[foolsgold agg] wv: [1.         1.         1.         0.37616842 0.37616842 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.6097, Accuracy: 8367/10000 (83.6700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.5370, Accuracy: 8293/8991 (92.2367%)
Done in 90.38897728919983 sec.
Server Epoch:40 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
___Train Local_Simple,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 586/648 (90.4321%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.3021, Accuracy: 4747/10000 (47.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 23, internal_epoch   1,  Average loss: 0.0023, Accuracy: 411/428 (96.0280%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.7975, Accuracy: 2845/10000 (28.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 87, internal_epoch   1,  Average loss: 0.0126, Accuracy: 33/33 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5803, Accuracy: 8136/10000 (81.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 98, internal_epoch   1,  Average loss: 0.0547, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5993, Accuracy: 8207/10000 (82.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0019, Accuracy: 255/259 (98.4556%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.2767, Accuracy: 5943/10000 (59.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 83, internal_epoch   1,  Average loss: 0.0034, Accuracy: 710/750 (94.6667%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.9212, Accuracy: 5604/10000 (56.0400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0016, Accuracy: 696/705 (98.7234%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 9.2342, Accuracy: 1745/10000 (17.4500%), Attack Success Rate:16/10000(0.160)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   1,  Average loss: 0.0031, Accuracy: 729/768 (94.9219%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   2,  Average loss: 0.0006, Accuracy: 754/768 (98.1771%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   3,  Average loss: 0.0003, Accuracy: 764/768 (99.4792%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   4,  Average loss: 0.0003, Accuracy: 766/768 (99.7396%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   5,  Average loss: 0.0002, Accuracy: 766/768 (99.7396%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   6,  Average loss: 0.0002, Accuracy: 766/768 (99.7396%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   7,  Average loss: 0.0002, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   8,  Average loss: 0.0002, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   9,  Average loss: 0.0002, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch  10,  Average loss: 0.0002, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Global model norm: 14.772422687084825.
Norm before scaling: 14.958772077297885. Distance: 1.7193566378823157
Total norm for 1 adversaries is: 14.958772077297885. distance: 1.7193566378823157
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 3.2166, Accuracy: 3401/8991 (37.8267%)
___Train Local_Simple,  epoch  40, local model 71, internal_epoch   1,  Average loss: 0.0071, Accuracy: 303/342 (88.5965%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.2683, Accuracy: 5898/10000 (58.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0099, Accuracy: 79/84 (94.0476%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.9595, Accuracy: 7419/10000 (74.1900%), Attack Success Rate:0/10000(0.000)
time spent on training: 52.907227754592896
[foolsgold agg] training data poison_ratio: 0.19090231170768082  data num: [648, 428, 33, 6, 259, 750, 705, 768, 342, 84]
[foolsgold agg] considering poison per batch poison_fraction: 0.19090231170768082
[foolsgold agg] wv: [1.         0.11027097 0.7735433  0.11027097 1.         0.7735433
 1.         0.79634971 1.         0.79634971]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.5634, Accuracy: 8339/10000 (83.3900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.4893, Accuracy: 8261/8991 (91.8808%)
Done in 90.38258600234985 sec.
Server Epoch:41 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
___Train Local_Simple,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0021, Accuracy: 254/259 (98.0695%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.8987, Accuracy: 6891/10000 (68.9100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  41, local model 28, internal_epoch   1,  Average loss: 0.0035, Accuracy: 226/237 (95.3586%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.4127, Accuracy: 5273/10000 (52.7300%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   1,  Average loss: 0.0006, Accuracy: 2159/2180 (99.0367%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   2,  Average loss: 0.0002, Accuracy: 2176/2180 (99.8165%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Global model norm: 14.794898024939522.
Norm before scaling: 14.729692348108356. Distance: 1.4200953150714706
Total norm for 1 adversaries is: 14.729692348108356. distance: 1.4200953150714706
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 1.5003, Accuracy: 5475/8991 (60.8942%)
___Train Local_Simple,  epoch  41, local model 95, internal_epoch   1,  Average loss: 0.0118, Accuracy: 28/29 (96.5517%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5569, Accuracy: 8181/10000 (81.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 83, internal_epoch   1,  Average loss: 0.0031, Accuracy: 718/750 (95.7333%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.0789, Accuracy: 5077/10000 (50.7700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0051, Accuracy: 245/264 (92.8030%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.8341, Accuracy: 2475/10000 (24.7500%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  41, local model 55, internal_epoch   1,  Average loss: 0.0031, Accuracy: 2643/2803 (94.2918%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.1707, Accuracy: 4821/10000 (48.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0080, Accuracy: 57/63 (90.4762%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.7313, Accuracy: 8009/10000 (80.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 1179/1232 (95.6981%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.9949, Accuracy: 4090/10000 (40.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 46, internal_epoch   1,  Average loss: 0.0101, Accuracy: 228/310 (73.5484%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.3273, Accuracy: 5401/10000 (54.0100%), Attack Success Rate:0/10000(0.000)
time spent on training: 75.42473316192627
[foolsgold agg] training data poison_ratio: 0.2682416635905008  data num: [259, 237, 2180, 29, 750, 264, 2803, 63, 1232, 310]
[foolsgold agg] considering poison per batch poison_fraction: 0.2682416635905008
[foolsgold agg] wv: [0.41257629 1.         0.41257629 1.         1.         1.
 0.81464995 1.         0.81464995 1.        ]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.5296, Accuracy: 8343/10000 (83.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.4450, Accuracy: 8279/8991 (92.0810%)
Done in 111.35372805595398 sec.
Server Epoch:42 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0080, Accuracy: 33/33 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5153, Accuracy: 8204/10000 (82.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0025, Accuracy: 1156/1205 (95.9336%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.8278, Accuracy: 3505/10000 (35.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 89, internal_epoch   1,  Average loss: 0.0195, Accuracy: 43/69 (62.3188%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.8741, Accuracy: 7844/10000 (78.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0058, Accuracy: 122/128 (95.3125%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6460, Accuracy: 7358/10000 (73.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0141, Accuracy: 64/68 (94.1176%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6433, Accuracy: 7728/10000 (77.2800%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 656/688 (95.3488%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   2,  Average loss: 0.0018, Accuracy: 668/688 (97.0930%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   3,  Average loss: 0.0005, Accuracy: 681/688 (98.9826%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   4,  Average loss: 0.0004, Accuracy: 682/688 (99.1279%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   5,  Average loss: 0.0003, Accuracy: 685/688 (99.5640%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   6,  Average loss: 0.0002, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   7,  Average loss: 0.0002, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 14.818169776243561.
Norm before scaling: 15.05186346436879. Distance: 1.9374127522174602
Total norm for 1 adversaries is: 15.05186346436879. distance: 1.9374127522174602
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 5.1409, Accuracy: 3180/8991 (35.3687%)
___Train Local_Simple,  epoch  42, local model 92, internal_epoch   1,  Average loss: 0.0039, Accuracy: 197/202 (97.5248%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.1742, Accuracy: 4854/10000 (48.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 62, internal_epoch   1,  Average loss: 0.1297, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5329, Accuracy: 8187/10000 (81.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 26, internal_epoch   1,  Average loss: 0.0022, Accuracy: 1248/1311 (95.1945%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.8554, Accuracy: 2990/10000 (29.9000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0026, Accuracy: 1183/1232 (96.0227%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.0170, Accuracy: 5830/10000 (58.3000%), Attack Success Rate:0/10000(0.000)
time spent on training: 52.810063123703
[foolsgold agg] training data poison_ratio: 0.13932766302146618  data num: [33, 1205, 69, 128, 68, 688, 202, 2, 1311, 1232]
[foolsgold agg] considering poison per batch poison_fraction: 0.13932766302146618
[foolsgold agg] wv: [0.22677856 0.         0.2485449  0.22677856 0.85031778 1.
 0.         0.2485449  1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.5315, Accuracy: 8353/10000 (83.5300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.4257, Accuracy: 8304/8991 (92.3590%)
Done in 89.29256391525269 sec.
Server Epoch:43 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
___Train Local_Simple,  epoch  43, local model 38, internal_epoch   1,  Average loss: 0.0026, Accuracy: 178/179 (99.4413%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.7861, Accuracy: 5212/10000 (52.1200%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  43, local model 78, internal_epoch   1,  Average loss: 0.0022, Accuracy: 2238/2324 (96.2995%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.6794, Accuracy: 5817/10000 (58.1700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  43, local model 26, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1269/1311 (96.7963%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 5.8195, Accuracy: 2857/10000 (28.5700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0046, Accuracy: 246/264 (93.1818%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.4438, Accuracy: 3145/10000 (31.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0520, Accuracy: 8/10 (80.0000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5728, Accuracy: 8152/10000 (81.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 494/497 (99.3964%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 8.7151, Accuracy: 3045/10000 (30.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0103, Accuracy: 26/30 (86.6667%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5663, Accuracy: 8080/10000 (80.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 39, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1230/1259 (97.6966%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.9628, Accuracy: 5082/10000 (50.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 44, internal_epoch   1,  Average loss: 0.0075, Accuracy: 44/47 (93.6170%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6038, Accuracy: 7964/10000 (79.6400%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   1,  Average loss: 0.0019, Accuracy: 742/768 (96.6146%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   2,  Average loss: 0.0008, Accuracy: 754/768 (98.1771%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   3,  Average loss: 0.0003, Accuracy: 764/768 (99.4792%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   4,  Average loss: 0.0002, Accuracy: 765/768 (99.6094%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   5,  Average loss: 0.0002, Accuracy: 765/768 (99.6094%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   6,  Average loss: 0.0002, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   7,  Average loss: 0.0001, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   8,  Average loss: 0.0001, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   9,  Average loss: 0.0001, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch  10,  Average loss: 0.0001, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Global model norm: 14.83038718008174.
Norm before scaling: 14.953336740108742. Distance: 1.4112035185843566
Total norm for 1 adversaries is: 14.953336740108742. distance: 1.4112035185843566
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 2.8383, Accuracy: 3623/8991 (40.2959%)
time spent on training: 57.038800954818726
[foolsgold agg] training data poison_ratio: 0.11481536851547317  data num: [179, 2324, 1311, 264, 10, 497, 30, 1259, 47, 768]
[foolsgold agg] considering poison per batch poison_fraction: 0.11481536851547317
[foolsgold agg] wv: [0.90855494 0.96581194 0.         0.96581194 0.         0.90855494
 0.         1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.5193, Accuracy: 8320/10000 (83.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.3896, Accuracy: 8278/8991 (92.0698%)
Done in 92.90375304222107 sec.
Server Epoch:44 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
___Train Local_Simple,  epoch  44, local model 31, internal_epoch   1,  Average loss: 0.0046, Accuracy: 1694/1839 (92.1153%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.6015, Accuracy: 5050/10000 (50.5000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0058, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   2,  Average loss: 0.0026, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   3,  Average loss: 0.0013, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   4,  Average loss: 0.0013, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   5,  Average loss: 0.0019, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   6,  Average loss: 0.0016, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   7,  Average loss: 0.0013, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   8,  Average loss: 0.0008, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   9,  Average loss: 0.0005, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch  10,  Average loss: 0.0007, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 14.849877435968327.
Norm before scaling: 14.9132271038621. Distance: 0.5146298197033438
Total norm for 1 adversaries is: 14.9132271038621. distance: 0.5146298197033438
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.5248, Accuracy: 7455/8991 (82.9162%)
___Train Local_Simple,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0019, Accuracy: 177/179 (98.8827%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.5450, Accuracy: 5564/10000 (55.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 226/263 (85.9316%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 6.7567, Accuracy: 2585/10000 (25.8500%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 1877/1982 (94.7023%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.6615, Accuracy: 3655/10000 (36.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 229/244 (93.8525%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.2130, Accuracy: 2582/10000 (25.8200%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  44, local model 65, internal_epoch   1,  Average loss: 0.0020, Accuracy: 1278/1326 (96.3801%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.2445, Accuracy: 3713/10000 (37.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 66, internal_epoch   1,  Average loss: 0.0015, Accuracy: 667/681 (97.9442%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 6.2035, Accuracy: 3547/10000 (35.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1170/1205 (97.0954%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.3618, Accuracy: 3964/10000 (39.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0051, Accuracy: 945/1033 (91.4811%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.8270, Accuracy: 4026/10000 (40.2600%), Attack Success Rate:0/10000(0.000)
time spent on training: 54.90284514427185
[foolsgold agg] training data poison_ratio: 0.009506564056133997  data num: [1839, 84, 179, 263, 1982, 244, 1326, 681, 1205, 1033]
[foolsgold agg] considering poison per batch poison_fraction: 0.009506564056133997
[foolsgold agg] wv: [0.90392009 0.54175663 0.49095897 0.90392009 1.         0.26863215
 0.         0.49095897 1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.4403, Accuracy: 8481/10000 (84.8100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.3827, Accuracy: 8266/8991 (91.9364%)
Done in 90.58845520019531 sec.
Server Epoch:45 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0020, Accuracy: 439/456 (96.2719%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 4.5987, Accuracy: 3686/10000 (36.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 75, internal_epoch   1,  Average loss: 0.0017, Accuracy: 488/497 (98.1891%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 9.1024, Accuracy: 2230/10000 (22.3000%), Attack Success Rate:3/10000(0.030)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0050, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0030, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   3,  Average loss: 0.0016, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   4,  Average loss: 0.0016, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   5,  Average loss: 0.0009, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   6,  Average loss: 0.0007, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   7,  Average loss: 0.0008, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   8,  Average loss: 0.0006, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   9,  Average loss: 0.0006, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch  10,  Average loss: 0.0007, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 14.863723198915686.
Norm before scaling: 14.924130126549409. Distance: 0.485393100242867
Total norm for 2 adversaries is: 14.924130126549409. distance: 0.485393100242867
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.4809, Accuracy: 7608/8991 (84.6180%)
___Train Local_Simple,  epoch  45, local model 37, internal_epoch   1,  Average loss: 0.0028, Accuracy: 553/578 (95.6747%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.8525, Accuracy: 4634/10000 (46.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 94, internal_epoch   1,  Average loss: 0.0023, Accuracy: 582/607 (95.8814%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.0597, Accuracy: 6479/10000 (64.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 252/259 (97.2973%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.9024, Accuracy: 6760/10000 (67.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 29, internal_epoch   1,  Average loss: 0.0021, Accuracy: 1194/1232 (96.9156%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.6736, Accuracy: 6266/10000 (62.6600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1222/1259 (97.0612%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.9559, Accuracy: 6496/10000 (64.9600%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   1,  Average loss: 0.0031, Accuracy: 386/399 (96.7419%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   2,  Average loss: 0.0005, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   3,  Average loss: 0.0005, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   4,  Average loss: 0.0004, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   5,  Average loss: 0.0004, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   6,  Average loss: 0.0003, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   7,  Average loss: 0.0003, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   8,  Average loss: 0.0002, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   9,  Average loss: 0.0002, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch  10,  Average loss: 0.0002, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Global model norm: 14.863723198915686.
Norm before scaling: 15.061604453408592. Distance: 1.762081404954251
Total norm for 2 adversaries is: 15.061604453408592. distance: 1.762081404954251
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 11.2643, Accuracy: 2098/8991 (23.3344%)
___Train Local_Simple,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0027, Accuracy: 999/1046 (95.5067%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.5879, Accuracy: 4239/10000 (42.3900%), Attack Success Rate:0/10000(0.000)
time spent on training: 60.837597131729126
[foolsgold agg] training data poison_ratio: 0.07526881720430108  data num: [456, 497, 84, 578, 607, 259, 1232, 1259, 399, 1046]
[foolsgold agg] considering poison per batch poison_fraction: 0.07526881720430108
[foolsgold agg] wv: [1.         1.         0.66973778 0.         1.         1.
 1.         0.         1.         0.66973778]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.4432, Accuracy: 8434/10000 (84.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.3453, Accuracy: 8341/8991 (92.7705%)
Done in 102.2877471446991 sec.
Server Epoch:46 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
___Train Local_Simple,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 489/497 (98.3903%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 7.5351, Accuracy: 2869/10000 (28.6900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  46, local model 78, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2240/2324 (96.3855%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.9543, Accuracy: 5495/10000 (54.9500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0066, Accuracy: 46/48 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4500, Accuracy: 8235/10000 (82.3500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  46, local model 39, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1229/1259 (97.6172%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.6176, Accuracy: 5554/10000 (55.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 78/86 (90.6977%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.7005, Accuracy: 7434/10000 (74.3400%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 659/688 (95.7849%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   2,  Average loss: 0.0008, Accuracy: 679/688 (98.6919%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   3,  Average loss: 0.0002, Accuracy: 684/688 (99.4186%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 685/688 (99.5640%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   5,  Average loss: 0.0002, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 14.882688442724424.
Norm before scaling: 15.043296887650659. Distance: 1.6213907360442312
Total norm for 2 adversaries is: 15.043296887650659. distance: 1.6213907360442312
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 4.3487, Accuracy: 3287/8991 (36.5588%)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   1,  Average loss: 0.0024, Accuracy: 417/436 (95.6422%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   2,  Average loss: 0.0006, Accuracy: 430/436 (98.6239%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   3,  Average loss: 0.0005, Accuracy: 432/436 (99.0826%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   4,  Average loss: 0.0003, Accuracy: 435/436 (99.7706%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   5,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   7,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   8,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch  10,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Global model norm: 14.882688442724424.
Norm before scaling: 15.013825720600153. Distance: 1.2532674998551736
Total norm for 2 adversaries is: 15.013825720600153. distance: 1.2532674998551736
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 1.9701, Accuracy: 5331/8991 (59.2926%)
___Train Local_Simple,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0053, Accuracy: 108/119 (90.7563%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6107, Accuracy: 7705/10000 (77.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 68, internal_epoch   1,  Average loss: 0.0026, Accuracy: 1516/1591 (95.2860%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.7655, Accuracy: 4016/10000 (40.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 54, internal_epoch   1,  Average loss: 0.0089, Accuracy: 82/91 (90.1099%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4391, Accuracy: 8403/10000 (84.0300%), Attack Success Rate:0/10000(0.000)
time spent on training: 78.6736888885498
[foolsgold agg] training data poison_ratio: 0.1574450203109679  data num: [497, 2324, 48, 1259, 86, 688, 436, 119, 1591, 91]
[foolsgold agg] considering poison per batch poison_fraction: 0.1574450203109679
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.4409, Accuracy: 8437/10000 (84.3700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.3013, Accuracy: 8373/8991 (93.1265%)
Done in 124.3169629573822 sec.
Server Epoch:47 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  47, local model 94, internal_epoch   1,  Average loss: 0.0017, Accuracy: 590/607 (97.1993%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.0985, Accuracy: 6273/10000 (62.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 48, internal_epoch   1,  Average loss: 0.0034, Accuracy: 124/128 (96.8750%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5390, Accuracy: 7810/10000 (78.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 108/114 (94.7368%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4545, Accuracy: 8244/10000 (82.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 25, internal_epoch   1,  Average loss: 0.0061, Accuracy: 113/128 (88.2812%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3750, Accuracy: 8730/10000 (87.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1273/1311 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 4.5200, Accuracy: 2958/10000 (29.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0026, Accuracy: 944/994 (94.9698%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.8042, Accuracy: 6507/10000 (65.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 78/86 (90.6977%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6382, Accuracy: 7545/10000 (75.4500%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0017, Accuracy: 744/768 (96.8750%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   2,  Average loss: 0.0007, Accuracy: 756/768 (98.4375%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   3,  Average loss: 0.0003, Accuracy: 764/768 (99.4792%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   4,  Average loss: 0.0002, Accuracy: 763/768 (99.3490%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   5,  Average loss: 0.0002, Accuracy: 765/768 (99.6094%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   6,  Average loss: 0.0002, Accuracy: 766/768 (99.7396%), train_poison_data_count: 768
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   7,  Average loss: 0.0002, Accuracy: 766/768 (99.7396%), train_poison_data_count: 768
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   8,  Average loss: 0.0001, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   9,  Average loss: 0.0001, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch  10,  Average loss: 0.0001, Accuracy: 767/768 (99.8698%), train_poison_data_count: 768
Global model norm: 14.91055434037597.
Norm before scaling: 14.99361232807262. Distance: 1.31612327545282
Total norm for 1 adversaries is: 14.99361232807262. distance: 1.31612327545282
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 2.3611, Accuracy: 4399/8991 (48.9267%)
___Train Local_Simple,  epoch  47, local model 68, internal_epoch   1,  Average loss: 0.0023, Accuracy: 1516/1591 (95.2860%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.4520, Accuracy: 4241/10000 (42.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0255, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4364, Accuracy: 8426/10000 (84.2600%), Attack Success Rate:0/10000(0.000)
time spent on training: 64.43524813652039
[foolsgold agg] training data poison_ratio: 0.13396127681841968  data num: [607, 128, 114, 128, 1311, 994, 86, 768, 1591, 6]
[foolsgold agg] considering poison per batch poison_fraction: 0.13396127681841968
[foolsgold agg] wv: [1.         1.         1.         0.74782775 1.         0.74782775
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.4025, Accuracy: 8472/10000 (84.7200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.2936, Accuracy: 8371/8991 (93.1042%)
Done in 110.56942796707153 sec.
Server Epoch:48 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
___Train Local_Simple,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0028, Accuracy: 720/762 (94.4882%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 5.5727, Accuracy: 4376/10000 (43.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 27, internal_epoch   1,  Average loss: 0.0020, Accuracy: 653/678 (96.3127%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.8276, Accuracy: 3364/10000 (33.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 489/497 (98.3903%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 6.6333, Accuracy: 2627/10000 (26.2700%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0029, Accuracy: 230/244 (94.2623%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.7489, Accuracy: 2921/10000 (29.2100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  48, local model 58, internal_epoch   1,  Average loss: 0.0031, Accuracy: 951/1015 (93.6946%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.0450, Accuracy: 4447/10000 (44.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0020, Accuracy: 727/750 (96.9333%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.5324, Accuracy: 6187/10000 (61.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0023, Accuracy: 177/182 (97.2527%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.5254, Accuracy: 7953/10000 (79.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 96, internal_epoch   1,  Average loss: 0.0027, Accuracy: 474/505 (93.8614%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.9212, Accuracy: 4442/10000 (44.4200%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0053, Accuracy: 88/94 (93.6170%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.7098, Accuracy: 7957/10000 (79.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 57, internal_epoch   1,  Average loss: 0.0024, Accuracy: 1371/1437 (95.4071%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.4212, Accuracy: 6432/10000 (64.3200%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.52909517288208
[foolsgold agg] training data poison_ratio: 0.0  data num: [762, 678, 497, 244, 1015, 750, 182, 505, 94, 1437]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         0.         1.         0.84292123 0.60685597
 0.60685597 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.3599, Accuracy: 8600/10000 (86.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.3029, Accuracy: 8275/8991 (92.0365%)
Done in 95.76896619796753 sec.
Server Epoch:49 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
___Train Local_Simple,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0023, Accuracy: 1495/1544 (96.8264%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.3780, Accuracy: 6221/10000 (62.2100%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 661/688 (96.0756%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   2,  Average loss: 0.0007, Accuracy: 680/688 (98.8372%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   3,  Average loss: 0.0004, Accuracy: 682/688 (99.1279%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   4,  Average loss: 0.0003, Accuracy: 684/688 (99.4186%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   5,  Average loss: 0.0002, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 14.936912110064418.
Norm before scaling: 15.07214958103734. Distance: 1.5815779425065546
Total norm for 1 adversaries is: 15.07214958103734. distance: 1.5815779425065546
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 5.0108, Accuracy: 3308/8991 (36.7923%)
___Train Local_Simple,  epoch  49, local model 78, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2260/2324 (97.2461%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.5686, Accuracy: 6065/10000 (60.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0343, Accuracy: 9/10 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4286, Accuracy: 8387/10000 (83.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 91, internal_epoch   1,  Average loss: 0.0021, Accuracy: 177/182 (97.2527%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4917, Accuracy: 8121/10000 (81.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0560, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3642, Accuracy: 8574/10000 (85.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0083, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3624, Accuracy: 8588/10000 (85.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 2027/2072 (97.8282%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.6607, Accuracy: 2940/10000 (29.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 110/114 (96.4912%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4149, Accuracy: 8467/10000 (84.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0020, Accuracy: 733/762 (96.1942%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 4.6200, Accuracy: 4917/10000 (49.1700%), Attack Success Rate:0/10000(0.000)
time spent on training: 70.38411116600037
[foolsgold agg] training data poison_ratio: 0.08926949526404568  data num: [1544, 688, 2324, 10, 182, 5, 6, 2072, 114, 762]
[foolsgold agg] considering poison per batch poison_fraction: 0.08926949526404568
[foolsgold agg] wv: [0.32094287 1.         0.70444376 0.         0.74768829 0.51061065
 0.         0.6770281  0.32094287 0.41340956]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.3465, Accuracy: 8654/10000 (86.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.2913, Accuracy: 8295/8991 (92.2589%)
Done in 124.93348598480225 sec.
Server Epoch:50 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
___Train Local_Simple,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0013, Accuracy: 489/497 (98.3903%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 7.5236, Accuracy: 2681/10000 (26.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 86, internal_epoch   1,  Average loss: 0.0076, Accuracy: 33/34 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.4088, Accuracy: 8450/10000 (84.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0013, Accuracy: 254/259 (98.0695%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.0601, Accuracy: 6953/10000 (69.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 294/300 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.9432, Accuracy: 6938/10000 (69.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 31, internal_epoch   1,  Average loss: 0.0031, Accuracy: 1741/1839 (94.6710%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.3393, Accuracy: 5760/10000 (57.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 32, internal_epoch   1,  Average loss: 0.0434, Accuracy: 5/28 (17.8571%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.1305, Accuracy: 8238/10000 (82.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 67, internal_epoch   1,  Average loss: 0.0031, Accuracy: 521/568 (91.7254%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.6452, Accuracy: 6296/10000 (62.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 89/94 (94.6809%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.7452, Accuracy: 7988/10000 (79.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1194/1232 (96.9156%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.5291, Accuracy: 5756/10000 (57.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 80/86 (93.0233%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.5376, Accuracy: 8122/10000 (81.2200%), Attack Success Rate:0/10000(0.000)
time spent on training: 53.41692590713501
[foolsgold agg] training data poison_ratio: 0.0  data num: [497, 34, 259, 300, 1839, 28, 568, 94, 1232, 86]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.         0.38596807 1.         1.         0.39590322 0.
 0.         0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.3412, Accuracy: 8664/10000 (86.6400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.2870, Accuracy: 8279/8991 (92.0810%)
Done in 100.61379504203796 sec.
Saving all the graphs.
This run has a label: Mar.03_08.44.52. Visdom environment: mnist_DBA
