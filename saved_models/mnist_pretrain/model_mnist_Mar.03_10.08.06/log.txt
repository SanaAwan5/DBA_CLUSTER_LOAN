current path: saved_models/mnist_pretrain/model_mnist_Mar.03_10.08.06
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 10, 20, 30, 40, 50, 60, 70, 80, 90]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
___Train Local_Simple,  epoch   1, local model 23, internal_epoch   1,  Average loss: 0.0361, Accuracy: 70/293 (23.8908%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.6854, Accuracy: 1910/10000 (19.1000%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   1, local model 72, internal_epoch   1,  Average loss: 0.0265, Accuracy: 306/731 (41.8605%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.0029, Accuracy: 1154/10000 (11.5400%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch   1, local model 61, internal_epoch   1,  Average loss: 0.0293, Accuracy: 264/699 (37.7682%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.5968, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0359, Accuracy: 142/645 (22.0155%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.5551, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch   1, local model 71, internal_epoch   1,  Average loss: 0.0226, Accuracy: 734/1384 (53.0347%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.9821, Accuracy: 3564/10000 (35.6400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   1, local model 42, internal_epoch   1,  Average loss: 0.0349, Accuracy: 68/236 (28.8136%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 4.5640, Accuracy: 974/10000 (9.7400%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch   1, local model 45, internal_epoch   1,  Average loss: 0.0299, Accuracy: 204/628 (32.4841%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.5974, Accuracy: 1822/10000 (18.2200%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   1, local model 37, internal_epoch   1,  Average loss: 0.0276, Accuracy: 383/860 (44.5349%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.8648, Accuracy: 1133/10000 (11.3300%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch   1, local model 21, internal_epoch   1,  Average loss: 0.0327, Accuracy: 113/312 (36.2179%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.7912, Accuracy: 2449/10000 (24.4900%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch   1, local model 35, internal_epoch   1,  Average loss: 0.0307, Accuracy: 193/499 (38.6774%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.3848, Accuracy: 980/10000 (9.8000%), Attack Success Rate:11/10000(0.110)
time spent on training: 53.13246512413025
[foolsgold agg] training data poison_ratio: 0.0  data num: [293, 731, 699, 645, 1384, 236, 628, 860, 312, 499]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.30363226
 1.         1.         0.30363226 1.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2863, Accuracy: 2683/10000 (26.8300%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2906, Accuracy: 2047/8991 (22.7672%)
Done in 101.64196014404297 sec.
Server Epoch:2 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0358, Accuracy: 158/645 (24.4961%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.3630, Accuracy: 2656/10000 (26.5600%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   2, local model 59, internal_epoch   1,  Average loss: 0.0331, Accuracy: 278/760 (36.5789%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.2949, Accuracy: 2022/10000 (20.2200%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   2, local model 62, internal_epoch   1,  Average loss: 0.0355, Accuracy: 118/423 (27.8960%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.6619, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch   2, local model 28, internal_epoch   1,  Average loss: 0.0339, Accuracy: 142/501 (28.3433%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.6131, Accuracy: 892/10000 (8.9200%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   2, local model 65, internal_epoch   1,  Average loss: 0.0325, Accuracy: 158/371 (42.5876%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.5982, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch   2, local model 22, internal_epoch   1,  Average loss: 0.0308, Accuracy: 263/583 (45.1115%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.9630, Accuracy: 1951/10000 (19.5100%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   2, local model 78, internal_epoch   1,  Average loss: 0.0331, Accuracy: 96/303 (31.6832%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 6.0306, Accuracy: 1028/10000 (10.2800%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   2, local model 58, internal_epoch   1,  Average loss: 0.0358, Accuracy: 115/276 (41.6667%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 3.8037, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch   2, local model 41, internal_epoch   1,  Average loss: 0.0262, Accuracy: 331/606 (54.6205%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.6310, Accuracy: 892/10000 (8.9200%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   2, local model 81, internal_epoch   1,  Average loss: 0.0313, Accuracy: 527/1227 (42.9503%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 3.2997, Accuracy: 892/10000 (8.9200%), Attack Success Rate:9/10000(0.090)
time spent on training: 42.808037996292114
[foolsgold agg] training data poison_ratio: 0.0  data num: [645, 760, 423, 501, 371, 583, 303, 276, 606, 1227]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2713, Accuracy: 4094/10000 (40.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2727, Accuracy: 3172/8991 (35.2797%)
Done in 80.63889527320862 sec.
Server Epoch:3 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
___Train Local_Simple,  epoch   3, local model 54, internal_epoch   1,  Average loss: 0.0326, Accuracy: 230/519 (44.3160%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.4893, Accuracy: 1056/10000 (10.5600%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   3, local model 55, internal_epoch   1,  Average loss: 0.0316, Accuracy: 200/354 (56.4972%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 6.2489, Accuracy: 980/10000 (9.8000%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   3, local model 61, internal_epoch   1,  Average loss: 0.0312, Accuracy: 277/699 (39.6280%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.5860, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch   3, local model 73, internal_epoch   1,  Average loss: 0.0243, Accuracy: 400/591 (67.6819%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.8540, Accuracy: 1554/10000 (15.5400%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch   3, local model 18, internal_epoch   1,  Average loss: 0.0358, Accuracy: 137/459 (29.8475%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.9480, Accuracy: 1924/10000 (19.2400%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch   3, local model 42, internal_epoch   1,  Average loss: 0.0366, Accuracy: 87/236 (36.8644%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.4984, Accuracy: 974/10000 (9.7400%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   3, local model 87, internal_epoch   1,  Average loss: 0.0305, Accuracy: 280/470 (59.5745%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.3726, Accuracy: 1251/10000 (12.5100%), Attack Success Rate:20/10000(0.200)
___Train Local_Simple,  epoch   3, local model 41, internal_epoch   1,  Average loss: 0.0264, Accuracy: 356/606 (58.7459%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.9897, Accuracy: 985/10000 (9.8500%), Attack Success Rate:9/10000(0.090)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   1,  Average loss: 0.0346, Accuracy: 173/474 (36.4979%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   2,  Average loss: 0.0300, Accuracy: 165/474 (34.8101%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   3,  Average loss: 0.0271, Accuracy: 177/474 (37.3418%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   4,  Average loss: 0.0246, Accuracy: 197/474 (41.5612%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   5,  Average loss: 0.0214, Accuracy: 255/474 (53.7975%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   6,  Average loss: 0.0169, Accuracy: 319/474 (67.2996%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   7,  Average loss: 0.0153, Accuracy: 360/474 (75.9494%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   8,  Average loss: 0.0136, Accuracy: 371/474 (78.2700%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   9,  Average loss: 0.0118, Accuracy: 388/474 (81.8565%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch  10,  Average loss: 0.0120, Accuracy: 386/474 (81.4346%), train_poison_data_count: 474
Global model norm: 13.905806699394951.
Norm before scaling: 14.199443881468342. Distance: 2.6258577126263387
Total norm for 1 adversaries is: 14.199443881468342. distance: 2.6258577126263387
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 2.6212, Accuracy: 3189/8991 (35.4688%)
___Train Local_Simple,  epoch   3, local model 28, internal_epoch   1,  Average loss: 0.0339, Accuracy: 157/501 (31.3373%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.2686, Accuracy: 3614/10000 (36.1400%), Attack Success Rate:0/10000(0.000)
time spent on training: 49.41863799095154
[foolsgold agg] training data poison_ratio: 0.09655734365451211  data num: [519, 354, 699, 591, 459, 236, 470, 606, 474, 501]
[foolsgold agg] considering poison per batch poison_fraction: 0.09655734365451211
[foolsgold agg] wv: [1.         1.         1.         1.         0.59971529 1.
 0.97121493 0.97121493 1.         0.59971529]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.2080, Accuracy: 2765/10000 (27.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.1989, Accuracy: 2762/8991 (30.7196%)
Done in 87.30871415138245 sec.
Server Epoch:4 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
___Train Local_Simple,  epoch   4, local model 37, internal_epoch   1,  Average loss: 0.0233, Accuracy: 447/860 (51.9767%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.7594, Accuracy: 2729/10000 (27.2900%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   4, local model 92, internal_epoch   1,  Average loss: 0.0243, Accuracy: 486/937 (51.8677%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.8032, Accuracy: 3463/10000 (34.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 95, internal_epoch   1,  Average loss: 0.0324, Accuracy: 293/602 (48.6711%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.7223, Accuracy: 982/10000 (9.8200%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   4, local model 76, internal_epoch   1,  Average loss: 0.0567, Accuracy: 9/78 (11.5385%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.1736, Accuracy: 2936/10000 (29.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0219, Accuracy: 406/734 (55.3134%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.7832, Accuracy: 4582/10000 (45.8200%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   4, local model 99, internal_epoch   1,  Average loss: 0.0297, Accuracy: 133/377 (35.2785%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 5.2443, Accuracy: 1037/10000 (10.3700%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   4, local model 94, internal_epoch   1,  Average loss: 0.0369, Accuracy: 101/150 (67.3333%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 5.4273, Accuracy: 974/10000 (9.7400%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch   4, local model 74, internal_epoch   1,  Average loss: 0.0293, Accuracy: 225/557 (40.3950%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.9753, Accuracy: 3567/10000 (35.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 45, internal_epoch   1,  Average loss: 0.0248, Accuracy: 342/628 (54.4586%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.2815, Accuracy: 2501/10000 (25.0100%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   4, local model 44, internal_epoch   1,  Average loss: 0.0283, Accuracy: 242/517 (46.8085%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 4.5304, Accuracy: 1734/10000 (17.3400%), Attack Success Rate:10/10000(0.100)
time spent on training: 51.27169609069824
[foolsgold agg] training data poison_ratio: 0.0  data num: [860, 937, 602, 78, 734, 377, 150, 557, 628, 517]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.38546481 1.         1.
 1.         1.         1.         0.38546481]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 2.1788, Accuracy: 4080/10000 (40.8000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 2.1763, Accuracy: 4073/8991 (45.3009%)
Done in 98.85501790046692 sec.
Server Epoch:5 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   1,  Average loss: 0.0333, Accuracy: 194/338 (57.3964%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   2,  Average loss: 0.0180, Accuracy: 228/338 (67.4556%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   3,  Average loss: 0.0085, Accuracy: 283/338 (83.7278%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   4,  Average loss: 0.0073, Accuracy: 292/338 (86.3905%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   5,  Average loss: 0.0067, Accuracy: 305/338 (90.2367%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   6,  Average loss: 0.0065, Accuracy: 315/338 (93.1953%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   7,  Average loss: 0.0052, Accuracy: 315/338 (93.1953%), train_poison_data_count: 338
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   8,  Average loss: 0.0043, Accuracy: 315/338 (93.1953%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   9,  Average loss: 0.0039, Accuracy: 320/338 (94.6746%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch  10,  Average loss: 0.0042, Accuracy: 322/338 (95.2663%), train_poison_data_count: 338
Global model norm: 13.962470296556644.
Norm before scaling: 14.336093429839998. Distance: 2.3388976666529175
Total norm for 1 adversaries is: 14.336093429839998. distance: 2.3388976666529175
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.6619, Accuracy: 7048/8991 (78.3895%)
___Train Local_Simple,  epoch   5, local model 49, internal_epoch   1,  Average loss: 0.0240, Accuracy: 288/506 (56.9170%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.7192, Accuracy: 4511/10000 (45.1100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   5, local model 65, internal_epoch   1,  Average loss: 0.0289, Accuracy: 196/371 (52.8302%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.5724, Accuracy: 2115/10000 (21.1500%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0280, Accuracy: 211/376 (56.1170%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.1451, Accuracy: 1692/10000 (16.9200%), Attack Success Rate:22/10000(0.220)
___Train Local_Simple,  epoch   5, local model 36, internal_epoch   1,  Average loss: 0.0200, Accuracy: 620/1005 (61.6915%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.9418, Accuracy: 7043/10000 (70.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 24, internal_epoch   1,  Average loss: 0.0298, Accuracy: 174/379 (45.9103%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.0142, Accuracy: 2224/10000 (22.2400%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0306, Accuracy: 194/418 (46.4115%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.2244, Accuracy: 3302/10000 (33.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0282, Accuracy: 394/658 (59.8784%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.5197, Accuracy: 2413/10000 (24.1300%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   5, local model 76, internal_epoch   1,  Average loss: 0.0547, Accuracy: 32/78 (41.0256%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.0840, Accuracy: 4262/10000 (42.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 39, internal_epoch   1,  Average loss: 0.0295, Accuracy: 131/257 (50.9728%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 6.1922, Accuracy: 1255/10000 (12.5500%), Attack Success Rate:22/10000(0.220)
time spent on training: 68.3501570224762
[foolsgold agg] training data poison_ratio: 0.07706338349293206  data num: [338, 506, 371, 376, 1005, 379, 418, 658, 78, 257]
[foolsgold agg] considering poison per batch poison_fraction: 0.07706338349293206
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         1.         0.58863261 0.58863261]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.0448, Accuracy: 5585/10000 (55.8500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 2.0384, Accuracy: 5572/8991 (61.9731%)
Done in 118.29322528839111 sec.
Server Epoch:6 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
___Train Local_Simple,  epoch   6, local model 26, internal_epoch   1,  Average loss: 0.0227, Accuracy: 329/554 (59.3863%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.9853, Accuracy: 6425/10000 (64.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 29, internal_epoch   1,  Average loss: 0.0143, Accuracy: 742/1002 (74.0519%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.2746, Accuracy: 4803/10000 (48.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0235, Accuracy: 403/658 (61.2462%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 3.6153, Accuracy: 2245/10000 (22.4500%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch   6, local model 41, internal_epoch   1,  Average loss: 0.0184, Accuracy: 419/606 (69.1419%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.6601, Accuracy: 2693/10000 (26.9300%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   6, local model 99, internal_epoch   1,  Average loss: 0.0249, Accuracy: 217/377 (57.5597%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 3.2957, Accuracy: 3947/10000 (39.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 67, internal_epoch   1,  Average loss: 0.0157, Accuracy: 745/998 (74.6493%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 3.4476, Accuracy: 5285/10000 (52.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 91, internal_epoch   1,  Average loss: 0.0239, Accuracy: 187/256 (73.0469%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 3.6436, Accuracy: 3061/10000 (30.6100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   6, local model 76, internal_epoch   1,  Average loss: 0.0490, Accuracy: 47/78 (60.2564%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.8305, Accuracy: 4440/10000 (44.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0210, Accuracy: 386/633 (60.9795%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.6483, Accuracy: 5153/10000 (51.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 25, internal_epoch   1,  Average loss: 0.0204, Accuracy: 439/647 (67.8516%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 3.2160, Accuracy: 2352/10000 (23.5200%), Attack Success Rate:2/10000(0.020)
time spent on training: 47.47473883628845
[foolsgold agg] training data poison_ratio: 0.0  data num: [554, 1002, 658, 606, 377, 998, 256, 78, 633, 647]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.89938454 1.         0.73357541 1.         0.73357541 0.89938454
 1.         1.         0.99278024 1.        ]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 1.8830, Accuracy: 6152/10000 (61.5200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 1.8796, Accuracy: 6030/8991 (67.0671%)
Done in 90.67794489860535 sec.
Server Epoch:7 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
___Train Local_Simple,  epoch   7, local model 66, internal_epoch   1,  Average loss: 0.0302, Accuracy: 336/660 (50.9091%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 3.5084, Accuracy: 1607/10000 (16.0700%), Attack Success Rate:23/10000(0.230)
___Train Local_Simple,  epoch   7, local model 68, internal_epoch   1,  Average loss: 0.0291, Accuracy: 290/494 (58.7045%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.0033, Accuracy: 3021/10000 (30.2100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   7, local model 59, internal_epoch   1,  Average loss: 0.0340, Accuracy: 383/760 (50.3947%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2878, Accuracy: 2103/10000 (21.0300%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch   7, local model 62, internal_epoch   1,  Average loss: 0.0220, Accuracy: 295/423 (69.7400%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.2836, Accuracy: 5501/10000 (55.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 31, internal_epoch   1,  Average loss: 0.0155, Accuracy: 600/835 (71.8563%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.0538, Accuracy: 6652/10000 (66.5200%), Attack Success Rate:1/10000(0.010)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0101, Accuracy: 784/892 (87.8924%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   2,  Average loss: 0.0032, Accuracy: 844/892 (94.6188%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   3,  Average loss: 0.0025, Accuracy: 854/892 (95.7399%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   4,  Average loss: 0.0021, Accuracy: 857/892 (96.0762%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   5,  Average loss: 0.0019, Accuracy: 859/892 (96.3004%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   6,  Average loss: 0.0018, Accuracy: 858/892 (96.1883%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   7,  Average loss: 0.0017, Accuracy: 861/892 (96.5247%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   8,  Average loss: 0.0016, Accuracy: 863/892 (96.7489%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   9,  Average loss: 0.0015, Accuracy: 865/892 (96.9731%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch  10,  Average loss: 0.0015, Accuracy: 864/892 (96.8610%), train_poison_data_count: 892
Global model norm: 14.061350864506782.
Norm before scaling: 14.579506043071587. Distance: 3.1937684896572174
Total norm for 1 adversaries is: 14.579506043071587. distance: 3.1937684896572174
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 3.4159, Accuracy: 3603/8991 (40.0734%)
___Train Local_Simple,  epoch   7, local model 23, internal_epoch   1,  Average loss: 0.0254, Accuracy: 188/293 (64.1638%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.0545, Accuracy: 4206/10000 (42.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0233, Accuracy: 260/418 (62.2010%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.3595, Accuracy: 4622/10000 (46.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 99, internal_epoch   1,  Average loss: 0.0248, Accuracy: 187/377 (49.6021%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.7614, Accuracy: 4329/10000 (43.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 45, internal_epoch   1,  Average loss: 0.0237, Accuracy: 424/628 (67.5159%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.0373, Accuracy: 2161/10000 (21.6100%), Attack Success Rate:8/10000(0.080)
time spent on training: 55.73327302932739
[foolsgold agg] training data poison_ratio: 0.15432525951557094  data num: [660, 494, 760, 423, 835, 892, 293, 418, 377, 628]
[foolsgold agg] considering poison per batch poison_fraction: 0.15432525951557094
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 1.9958, Accuracy: 5502/10000 (55.0200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 1.9978, Accuracy: 4806/8991 (53.4535%)
Done in 96.60320806503296 sec.
Server Epoch:8 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
___Train Local_Simple,  epoch   8, local model 63, internal_epoch   1,  Average loss: 0.0282, Accuracy: 524/889 (58.9426%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.1213, Accuracy: 2357/10000 (23.5700%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   8, local model 55, internal_epoch   1,  Average loss: 0.0251, Accuracy: 255/354 (72.0339%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 6.5294, Accuracy: 2074/10000 (20.7400%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   8, local model 79, internal_epoch   1,  Average loss: 0.0292, Accuracy: 112/182 (61.5385%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.5563, Accuracy: 4555/10000 (45.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0224, Accuracy: 269/436 (61.6972%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.1858, Accuracy: 5702/10000 (57.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 62, internal_epoch   1,  Average loss: 0.0220, Accuracy: 299/423 (70.6856%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 4.5435, Accuracy: 3856/10000 (38.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 56, internal_epoch   1,  Average loss: 0.0195, Accuracy: 555/880 (63.0682%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.2570, Accuracy: 5775/10000 (57.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 96, internal_epoch   1,  Average loss: 0.0170, Accuracy: 467/672 (69.4940%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.3057, Accuracy: 3978/10000 (39.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0186, Accuracy: 761/1160 (65.6034%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.3470, Accuracy: 5286/10000 (52.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 92, internal_epoch   1,  Average loss: 0.0226, Accuracy: 565/937 (60.2988%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.6105, Accuracy: 2812/10000 (28.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 86, internal_epoch   1,  Average loss: 0.0275, Accuracy: 159/250 (63.6000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.5088, Accuracy: 4662/10000 (46.6200%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.62132692337036
[foolsgold agg] training data poison_ratio: 0.0  data num: [889, 354, 182, 436, 423, 880, 672, 1160, 937, 250]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 1.9368, Accuracy: 5828/10000 (58.2800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 1.9444, Accuracy: 5503/8991 (61.2057%)
Done in 99.38116002082825 sec.
Server Epoch:9 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
___Train Local_Simple,  epoch   9, local model 28, internal_epoch   1,  Average loss: 0.0245, Accuracy: 318/501 (63.4731%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.4431, Accuracy: 6330/10000 (63.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 63, internal_epoch   1,  Average loss: 0.0252, Accuracy: 556/889 (62.5422%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.1616, Accuracy: 3011/10000 (30.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 33, internal_epoch   1,  Average loss: 0.0212, Accuracy: 415/623 (66.6132%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2061, Accuracy: 5138/10000 (51.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 71, internal_epoch   1,  Average loss: 0.0108, Accuracy: 1182/1384 (85.4046%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2458, Accuracy: 4982/10000 (49.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0139, Accuracy: 561/734 (76.4305%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.2286, Accuracy: 5203/10000 (52.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 32, internal_epoch   1,  Average loss: 0.0184, Accuracy: 728/977 (74.5138%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.5719, Accuracy: 4670/10000 (46.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 76, internal_epoch   1,  Average loss: 0.0461, Accuracy: 61/78 (78.2051%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.5663, Accuracy: 6053/10000 (60.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 97, internal_epoch   1,  Average loss: 0.0197, Accuracy: 362/487 (74.3326%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.5466, Accuracy: 5605/10000 (56.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 23, internal_epoch   1,  Average loss: 0.0257, Accuracy: 194/293 (66.2116%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.7158, Accuracy: 4316/10000 (43.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 25, internal_epoch   1,  Average loss: 0.0164, Accuracy: 493/647 (76.1978%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.4810, Accuracy: 5313/10000 (53.1300%), Attack Success Rate:0/10000(0.000)
time spent on training: 49.99990463256836
[foolsgold agg] training data poison_ratio: 0.0  data num: [501, 889, 623, 1384, 734, 977, 78, 487, 293, 647]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.      1.      1.      0.71376 1.      1.      0.71376 1.      1.
 1.     ]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 1.8543, Accuracy: 6486/10000 (64.8600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 1.8570, Accuracy: 6000/8991 (66.7334%)
Done in 90.90400195121765 sec.
Server Epoch:10 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
___Train Local_Simple,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0137, Accuracy: 855/1160 (73.7069%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.1108, Accuracy: 6658/10000 (66.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 56, internal_epoch   1,  Average loss: 0.0207, Accuracy: 619/880 (70.3409%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.5716, Accuracy: 4215/10000 (42.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 19, internal_epoch   1,  Average loss: 0.0331, Accuracy: 116/205 (56.5854%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.3011, Accuracy: 5266/10000 (52.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0202, Accuracy: 457/645 (70.8527%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.1502, Accuracy: 6537/10000 (65.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0128, Accuracy: 591/734 (80.5177%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.4678, Accuracy: 6207/10000 (62.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 78, internal_epoch   1,  Average loss: 0.0216, Accuracy: 211/303 (69.6370%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.8575, Accuracy: 4746/10000 (47.4600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  10, local model 49, internal_epoch   1,  Average loss: 0.0147, Accuracy: 391/506 (77.2727%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.0066, Accuracy: 6843/10000 (68.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 34, internal_epoch   1,  Average loss: 0.0203, Accuracy: 297/413 (71.9128%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.7445, Accuracy: 4992/10000 (49.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0149, Accuracy: 313/376 (83.2447%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 3.1287, Accuracy: 4717/10000 (47.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 99, internal_epoch   1,  Average loss: 0.0182, Accuracy: 297/377 (78.7798%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 4.6234, Accuracy: 4562/10000 (45.6200%), Attack Success Rate:0/10000(0.000)
time spent on training: 47.66027903556824
[foolsgold agg] training data poison_ratio: 0.0  data num: [1160, 880, 205, 645, 734, 303, 506, 413, 376, 377]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.62618083 0.45237534 0.35709664 1.         0.45237534 0.35709664
 0.62618083 0.75086871 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 1.6960, Accuracy: 6613/10000 (66.1300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 1.6906, Accuracy: 6522/8991 (72.5392%)
Done in 86.14426493644714 sec.
Server Epoch:11 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
___Train Local_Simple,  epoch  11, local model 53, internal_epoch   1,  Average loss: 0.0122, Accuracy: 642/739 (86.8742%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3076, Accuracy: 6102/10000 (61.0200%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  11, local model 56, internal_epoch   1,  Average loss: 0.0193, Accuracy: 593/880 (67.3864%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.2787, Accuracy: 5927/10000 (59.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0118, Accuracy: 506/568 (89.0845%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3230, Accuracy: 5856/10000 (58.5600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0133, Accuracy: 318/376 (84.5745%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 3.6141, Accuracy: 4750/10000 (47.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 36, internal_epoch   1,  Average loss: 0.0117, Accuracy: 822/1005 (81.7910%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3075, Accuracy: 6936/10000 (69.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0160, Accuracy: 448/615 (72.8455%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0766, Accuracy: 6098/10000 (60.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0190, Accuracy: 481/710 (67.7465%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0366, Accuracy: 6967/10000 (69.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 99, internal_epoch   1,  Average loss: 0.0149, Accuracy: 309/377 (81.9629%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 3.6923, Accuracy: 5581/10000 (55.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 88, internal_epoch   1,  Average loss: 0.0167, Accuracy: 434/530 (81.8868%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.9709, Accuracy: 6401/10000 (64.0100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0100, Accuracy: 709/860 (82.4419%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.2379, Accuracy: 5673/10000 (56.7300%), Attack Success Rate:1/10000(0.010)
time spent on training: 45.35002374649048
[foolsgold agg] training data poison_ratio: 0.0  data num: [739, 880, 568, 376, 1005, 615, 710, 377, 530, 860]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         0.76716543 0.88472689 1.         0.76716543 1.
 0.88472689 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 1.5866, Accuracy: 7066/10000 (70.6600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 1.5839, Accuracy: 6868/8991 (76.3875%)
Done in 84.37007403373718 sec.
Server Epoch:12 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
___Train Local_Simple,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0237, Accuracy: 163/236 (69.0678%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.3131, Accuracy: 5331/10000 (53.3100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  12, local model 17, internal_epoch   1,  Average loss: 0.0133, Accuracy: 498/620 (80.3226%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.5030, Accuracy: 5739/10000 (57.3900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0137, Accuracy: 440/548 (80.2920%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7890, Accuracy: 7176/10000 (71.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0137, Accuracy: 634/813 (77.9828%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.6869, Accuracy: 5978/10000 (59.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0137, Accuracy: 475/615 (77.2358%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1710, Accuracy: 7136/10000 (71.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 38, internal_epoch   1,  Average loss: 0.0127, Accuracy: 760/895 (84.9162%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.2545, Accuracy: 6169/10000 (61.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0111, Accuracy: 724/860 (84.1860%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0261, Accuracy: 5839/10000 (58.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 44, internal_epoch   1,  Average loss: 0.0130, Accuracy: 408/517 (78.9168%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7771, Accuracy: 7710/10000 (77.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0204, Accuracy: 400/589 (67.9117%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.5743, Accuracy: 7910/10000 (79.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0143, Accuracy: 509/658 (77.3556%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 3.0640, Accuracy: 2902/10000 (29.0200%), Attack Success Rate:0/10000(0.000)
time spent on training: 45.70031476020813
[foolsgold agg] training data poison_ratio: 0.0  data num: [236, 620, 548, 813, 615, 895, 860, 517, 589, 658]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.4531, Accuracy: 7754/10000 (77.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 1.4560, Accuracy: 7139/8991 (79.4016%)
Done in 84.33531069755554 sec.
Server Epoch:13 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
___Train Local_Simple,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0133, Accuracy: 297/379 (78.3641%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6470, Accuracy: 7981/10000 (79.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 38, internal_epoch   1,  Average loss: 0.0207, Accuracy: 732/895 (81.7877%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.0565, Accuracy: 3778/10000 (37.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0134, Accuracy: 212/253 (83.7945%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.6706, Accuracy: 5769/10000 (57.6900%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0078, Accuracy: 798/892 (89.4619%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   2,  Average loss: 0.0021, Accuracy: 863/892 (96.7489%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   3,  Average loss: 0.0014, Accuracy: 862/892 (96.6368%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   4,  Average loss: 0.0011, Accuracy: 873/892 (97.8700%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   5,  Average loss: 0.0010, Accuracy: 875/892 (98.0942%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   6,  Average loss: 0.0010, Accuracy: 878/892 (98.4305%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   7,  Average loss: 0.0009, Accuracy: 876/892 (98.2063%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   8,  Average loss: 0.0008, Accuracy: 878/892 (98.4305%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   9,  Average loss: 0.0008, Accuracy: 880/892 (98.6547%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch  10,  Average loss: 0.0008, Accuracy: 880/892 (98.6547%), train_poison_data_count: 892
Global model norm: 14.426852705267777.
Norm before scaling: 14.860277086346937. Distance: 2.707919857056333
Total norm for 2 adversaries is: 14.860277086346937. distance: 2.707919857056333
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 2.2470, Accuracy: 4623/8991 (51.4181%)
___Train Local_Simple,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0157, Accuracy: 514/645 (79.6899%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.2154, Accuracy: 6908/10000 (69.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 76, internal_epoch   1,  Average loss: 0.0310, Accuracy: 63/78 (80.7692%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.9827, Accuracy: 7553/10000 (75.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 97, internal_epoch   1,  Average loss: 0.0127, Accuracy: 416/487 (85.4209%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.8765, Accuracy: 5866/10000 (58.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0166, Accuracy: 330/418 (78.9474%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.4634, Accuracy: 6783/10000 (67.8300%), Attack Success Rate:1/10000(0.010)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   1,  Average loss: 0.0134, Accuracy: 560/724 (77.3481%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   2,  Average loss: 0.0067, Accuracy: 639/724 (88.2597%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   3,  Average loss: 0.0039, Accuracy: 669/724 (92.4033%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   4,  Average loss: 0.0024, Accuracy: 692/724 (95.5801%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   5,  Average loss: 0.0020, Accuracy: 699/724 (96.5470%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   6,  Average loss: 0.0017, Accuracy: 702/724 (96.9613%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   7,  Average loss: 0.0014, Accuracy: 703/724 (97.0994%), train_poison_data_count: 724
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   8,  Average loss: 0.0012, Accuracy: 705/724 (97.3757%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   9,  Average loss: 0.0011, Accuracy: 707/724 (97.6519%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch  10,  Average loss: 0.0011, Accuracy: 706/724 (97.5138%), train_poison_data_count: 724
Global model norm: 14.426852705267777.
Norm before scaling: 15.138754399408988. Distance: 3.0257821072971933
Total norm for 2 adversaries is: 15.138754399408988. distance: 3.0257821072971933
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.8603, Accuracy: 7249/8991 (80.6251%)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0110, Accuracy: 339/376 (90.1596%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.4852, Accuracy: 5358/10000 (53.5800%), Attack Success Rate:0/10000(0.000)
time spent on training: 68.00855088233948
[foolsgold agg] training data poison_ratio: 0.3139693025063144  data num: [379, 895, 253, 892, 645, 78, 487, 418, 724, 376]
[foolsgold agg] considering poison per batch poison_fraction: 0.3139693025063144
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.15381707
 1.         0.15381707 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.2685, Accuracy: 7860/10000 (78.6000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 1.2500, Accuracy: 7797/8991 (86.7201%)
Done in 106.37178707122803 sec.
Server Epoch:14 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0103, Accuracy: 527/602 (87.5415%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 4.3498, Accuracy: 4125/10000 (41.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 97, internal_epoch   1,  Average loss: 0.0102, Accuracy: 423/487 (86.8583%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 3.0726, Accuracy: 6426/10000 (64.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0109, Accuracy: 953/1160 (82.1552%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.6186, Accuracy: 5779/10000 (57.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 89, internal_epoch   1,  Average loss: 0.0152, Accuracy: 403/492 (81.9106%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.8025, Accuracy: 4264/10000 (42.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0109, Accuracy: 539/647 (83.3076%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0451, Accuracy: 6480/10000 (64.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 34, internal_epoch   1,  Average loss: 0.0111, Accuracy: 363/413 (87.8935%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.9007, Accuracy: 6012/10000 (60.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 55, internal_epoch   1,  Average loss: 0.0093, Accuracy: 330/354 (93.2203%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 3.9427, Accuracy: 5136/10000 (51.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 67, internal_epoch   1,  Average loss: 0.0093, Accuracy: 874/998 (87.5752%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1704, Accuracy: 5647/10000 (56.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0111, Accuracy: 719/880 (81.7045%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1518, Accuracy: 6783/10000 (67.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0116, Accuracy: 465/548 (84.8540%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9259, Accuracy: 7029/10000 (70.2900%), Attack Success Rate:1/10000(0.010)
time spent on training: 46.126938819885254
[foolsgold agg] training data poison_ratio: 0.0  data num: [602, 487, 1160, 492, 647, 413, 354, 998, 880, 548]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         1.         0.66730993 0.66730993
 1.         1.         0.76042733 1.        ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.2172, Accuracy: 7862/10000 (78.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 1.2080, Accuracy: 7730/8991 (85.9749%)
Done in 84.69999885559082 sec.
Server Epoch:15 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
___Train Local_Simple,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0111, Accuracy: 530/658 (80.5471%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.6953, Accuracy: 6258/10000 (62.5800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0109, Accuracy: 674/760 (88.6842%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   2,  Average loss: 0.0072, Accuracy: 671/760 (88.2895%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   3,  Average loss: 0.0034, Accuracy: 720/760 (94.7368%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   4,  Average loss: 0.0028, Accuracy: 729/760 (95.9211%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   5,  Average loss: 0.0023, Accuracy: 732/760 (96.3158%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   6,  Average loss: 0.0021, Accuracy: 736/760 (96.8421%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   7,  Average loss: 0.0018, Accuracy: 740/760 (97.3684%), train_poison_data_count: 760
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   8,  Average loss: 0.0016, Accuracy: 743/760 (97.7632%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   9,  Average loss: 0.0015, Accuracy: 747/760 (98.2895%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch  10,  Average loss: 0.0015, Accuracy: 747/760 (98.2895%), train_poison_data_count: 760
Global model norm: 14.556522566985704.
Norm before scaling: 15.212994311536818. Distance: 2.881758665252998
Total norm for 2 adversaries is: 15.212994311536818. distance: 2.881758665252998
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.3475, Accuracy: 7938/8991 (88.2883%)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   1,  Average loss: 0.0127, Accuracy: 372/429 (86.7133%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   2,  Average loss: 0.0062, Accuracy: 394/429 (91.8415%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   3,  Average loss: 0.0036, Accuracy: 400/429 (93.2401%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   4,  Average loss: 0.0017, Accuracy: 411/429 (95.8042%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   5,  Average loss: 0.0012, Accuracy: 421/429 (98.1352%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   6,  Average loss: 0.0012, Accuracy: 420/429 (97.9021%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   7,  Average loss: 0.0009, Accuracy: 422/429 (98.3683%), train_poison_data_count: 429
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   8,  Average loss: 0.0008, Accuracy: 422/429 (98.3683%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   9,  Average loss: 0.0007, Accuracy: 423/429 (98.6014%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch  10,  Average loss: 0.0007, Accuracy: 423/429 (98.6014%), train_poison_data_count: 429
Global model norm: 14.556522566985704.
Norm before scaling: 14.959117872372396. Distance: 2.059705285777024
Total norm for 2 adversaries is: 14.959117872372396. distance: 2.059705285777024
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.7266, Accuracy: 7258/8991 (80.7252%)
___Train Local_Simple,  epoch  15, local model 48, internal_epoch   1,  Average loss: 0.0090, Accuracy: 379/448 (84.5982%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8855, Accuracy: 7430/10000 (74.3000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0076, Accuracy: 336/354 (94.9153%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 3.8788, Accuracy: 5158/10000 (51.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 98, internal_epoch   1,  Average loss: 0.0085, Accuracy: 685/818 (83.7408%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1529, Accuracy: 6980/10000 (69.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 27, internal_epoch   1,  Average loss: 0.0093, Accuracy: 413/471 (87.6858%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.8491, Accuracy: 5493/10000 (54.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0168, Accuracy: 199/236 (84.3220%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.3974, Accuracy: 5896/10000 (58.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0165, Accuracy: 342/435 (78.6207%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.5761, Accuracy: 6822/10000 (68.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 44, internal_epoch   1,  Average loss: 0.0111, Accuracy: 433/517 (83.7524%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1097, Accuracy: 6838/10000 (68.3800%), Attack Success Rate:0/10000(0.000)
time spent on training: 65.44352221488953
[foolsgold agg] training data poison_ratio: 0.23195474053843151  data num: [658, 760, 429, 448, 354, 818, 471, 236, 435, 517]
[foolsgold agg] considering poison per batch poison_fraction: 0.23195474053843151
[foolsgold agg] wv: [0.71514896 1.         1.         1.         1.         0.71514896
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.8872, Accuracy: 8054/10000 (80.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.8419, Accuracy: 8001/8991 (88.9890%)
Done in 105.17112612724304 sec.
Server Epoch:16 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
___Train Local_Simple,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0075, Accuracy: 574/647 (88.7172%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5665, Accuracy: 8088/10000 (80.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0090, Accuracy: 545/633 (86.0979%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.9788, Accuracy: 7568/10000 (75.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0077, Accuracy: 1009/1160 (86.9828%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.2422, Accuracy: 6908/10000 (69.0800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0068, Accuracy: 324/377 (85.9416%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.0095, Accuracy: 6651/10000 (66.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 666/739 (90.1218%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.3100, Accuracy: 6738/10000 (67.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0068, Accuracy: 500/554 (90.2527%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5814, Accuracy: 8516/10000 (85.1600%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   1,  Average loss: 0.0089, Accuracy: 304/338 (89.9408%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   2,  Average loss: 0.0037, Accuracy: 311/338 (92.0118%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   3,  Average loss: 0.0020, Accuracy: 323/338 (95.5621%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   4,  Average loss: 0.0020, Accuracy: 326/338 (96.4497%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   5,  Average loss: 0.0013, Accuracy: 326/338 (96.4497%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   6,  Average loss: 0.0010, Accuracy: 331/338 (97.9290%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   7,  Average loss: 0.0008, Accuracy: 334/338 (98.8166%), train_poison_data_count: 338
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   8,  Average loss: 0.0007, Accuracy: 336/338 (99.4083%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   9,  Average loss: 0.0007, Accuracy: 336/338 (99.4083%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch  10,  Average loss: 0.0006, Accuracy: 336/338 (99.4083%), train_poison_data_count: 338
Global model norm: 14.633194152123794.
Norm before scaling: 14.929829563361253. Distance: 1.5698286990847807
Total norm for 2 adversaries is: 14.929829563361253. distance: 1.5698286990847807
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.4386, Accuracy: 7872/8991 (87.5542%)
___Train Local_Simple,  epoch  16, local model 63, internal_epoch   1,  Average loss: 0.0082, Accuracy: 756/889 (85.0394%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6220, Accuracy: 7823/10000 (78.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 52, internal_epoch   1,  Average loss: 0.0094, Accuracy: 205/253 (81.0277%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0779, Accuracy: 7114/10000 (71.1400%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   1,  Average loss: 0.0089, Accuracy: 607/683 (88.8726%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   2,  Average loss: 0.0043, Accuracy: 626/683 (91.6545%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   3,  Average loss: 0.0021, Accuracy: 652/683 (95.4612%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   4,  Average loss: 0.0016, Accuracy: 661/683 (96.7789%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   5,  Average loss: 0.0013, Accuracy: 663/683 (97.0717%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   6,  Average loss: 0.0012, Accuracy: 669/683 (97.9502%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   7,  Average loss: 0.0011, Accuracy: 671/683 (98.2430%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   8,  Average loss: 0.0010, Accuracy: 673/683 (98.5359%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch   9,  Average loss: 0.0009, Accuracy: 674/683 (98.6823%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 90, internal_epoch  10,  Average loss: 0.0009, Accuracy: 674/683 (98.6823%), train_poison_data_count: 683
Global model norm: 14.633194152123794.
Norm before scaling: 15.071547707285033. Distance: 2.288402058494801
Total norm for 2 adversaries is: 15.071547707285033. distance: 2.288402058494801
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.0225, Accuracy: 6303/8991 (70.1034%)
time spent on training: 64.87574005126953
[foolsgold agg] training data poison_ratio: 0.16276103937509964  data num: [647, 633, 1160, 377, 739, 554, 338, 889, 253, 683]
[foolsgold agg] considering poison per batch poison_fraction: 0.16276103937509964
[foolsgold agg] wv: [1.         0.89472758 1.         1.         1.         0.89472758
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.6934, Accuracy: 8230/10000 (82.3000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.6341, Accuracy: 8139/8991 (90.5239%)
Done in 103.56232500076294 sec.
Server Epoch:17 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0056, Accuracy: 612/660 (92.7273%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 4.0077, Accuracy: 5266/10000 (52.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 33, internal_epoch   1,  Average loss: 0.0082, Accuracy: 529/623 (84.9117%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.6269, Accuracy: 5922/10000 (59.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 56, internal_epoch   1,  Average loss: 0.0077, Accuracy: 766/880 (87.0455%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.7404, Accuracy: 7496/10000 (74.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 97, internal_epoch   1,  Average loss: 0.0044, Accuracy: 454/487 (93.2238%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.2466, Accuracy: 7329/10000 (73.2900%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 858/892 (96.1883%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0015, Accuracy: 875/892 (98.0942%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   3,  Average loss: 0.0008, Accuracy: 878/892 (98.4305%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   4,  Average loss: 0.0006, Accuracy: 883/892 (98.9910%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   5,  Average loss: 0.0005, Accuracy: 884/892 (99.1031%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   6,  Average loss: 0.0005, Accuracy: 886/892 (99.3274%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   7,  Average loss: 0.0004, Accuracy: 885/892 (99.2152%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   8,  Average loss: 0.0004, Accuracy: 887/892 (99.4395%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   9,  Average loss: 0.0004, Accuracy: 888/892 (99.5516%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch  10,  Average loss: 0.0004, Accuracy: 888/892 (99.5516%), train_poison_data_count: 892
Global model norm: 14.700149348531825.
Norm before scaling: 14.88589258236243. Distance: 1.7024432576452317
Total norm for 2 adversaries is: 14.88589258236243. distance: 1.7024432576452317
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.4084, Accuracy: 5407/8991 (60.1379%)
___Train Local_Simple,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 671/734 (91.4169%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9060, Accuracy: 7377/10000 (73.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 77, internal_epoch   1,  Average loss: 0.0088, Accuracy: 495/589 (84.0407%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.5258, Accuracy: 8574/10000 (85.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0054, Accuracy: 787/860 (91.5116%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6549, Accuracy: 8082/10000 (80.8200%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   1,  Average loss: 0.0075, Accuracy: 612/683 (89.6047%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   2,  Average loss: 0.0057, Accuracy: 608/683 (89.0190%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   3,  Average loss: 0.0028, Accuracy: 648/683 (94.8755%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   4,  Average loss: 0.0021, Accuracy: 655/683 (95.9004%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   5,  Average loss: 0.0017, Accuracy: 664/683 (97.2182%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   6,  Average loss: 0.0014, Accuracy: 665/683 (97.3646%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   7,  Average loss: 0.0012, Accuracy: 666/683 (97.5110%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   8,  Average loss: 0.0011, Accuracy: 670/683 (98.0966%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch   9,  Average loss: 0.0010, Accuracy: 670/683 (98.0966%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 90, internal_epoch  10,  Average loss: 0.0010, Accuracy: 671/683 (98.2430%), train_poison_data_count: 683
Global model norm: 14.700149348531825.
Norm before scaling: 15.17394464835714. Distance: 2.335807260818491
Total norm for 2 adversaries is: 15.17394464835714. distance: 2.335807260818491
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.8782, Accuracy: 6532/8991 (72.6504%)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0063, Accuracy: 683/760 (89.8684%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6722, Accuracy: 7811/10000 (78.1100%), Attack Success Rate:0/10000(0.000)
time spent on training: 72.55804896354675
[foolsgold agg] training data poison_ratio: 0.2197265625  data num: [660, 623, 880, 487, 892, 734, 589, 860, 683, 760]
[foolsgold agg] considering poison per batch poison_fraction: 0.2197265625
[foolsgold agg] wv: [0.94970029 0.84160967 0.30026524 1.         1.         0.30026524
 0.70709378 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.5533, Accuracy: 8350/10000 (83.5000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.4659, Accuracy: 8266/8991 (91.9364%)
Done in 112.15341377258301 sec.
Server Epoch:18 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0033, Accuracy: 342/354 (96.6102%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.2424, Accuracy: 6031/10000 (60.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0051, Accuracy: 261/276 (94.5652%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.1972, Accuracy: 6316/10000 (63.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 88, internal_epoch   1,  Average loss: 0.0050, Accuracy: 481/530 (90.7547%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6920, Accuracy: 7866/10000 (78.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0054, Accuracy: 270/293 (92.1502%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7802, Accuracy: 7434/10000 (74.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 39, internal_epoch   1,  Average loss: 0.0047, Accuracy: 239/257 (92.9961%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8828, Accuracy: 7078/10000 (70.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 75, internal_epoch   1,  Average loss: 0.0070, Accuracy: 593/686 (86.4431%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4962, Accuracy: 8365/10000 (83.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 670/713 (93.9691%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.3103, Accuracy: 7297/10000 (72.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0057, Accuracy: 626/699 (89.5565%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.1389, Accuracy: 7820/10000 (78.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 95, internal_epoch   1,  Average loss: 0.0038, Accuracy: 551/602 (91.5282%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 5.7236, Accuracy: 4175/10000 (41.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0028, Accuracy: 593/623 (95.1846%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.1359, Accuracy: 6703/10000 (67.0300%), Attack Success Rate:0/10000(0.000)
time spent on training: 45.818480253219604
[foolsgold agg] training data poison_ratio: 0.0  data num: [354, 276, 530, 293, 257, 686, 713, 699, 602, 623]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         1.         0.87063087 0.87063087 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.4549, Accuracy: 8516/10000 (85.1600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.4212, Accuracy: 8111/8991 (90.2124%)
Done in 90.25576615333557 sec.
Server Epoch:19 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
___Train Local_Simple,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0038, Accuracy: 814/860 (94.6512%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4447, Accuracy: 8514/10000 (85.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.0063, Accuracy: 356/408 (87.2549%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8908, Accuracy: 8010/10000 (80.1000%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   1,  Average loss: 0.0043, Accuracy: 447/474 (94.3038%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   2,  Average loss: 0.0022, Accuracy: 456/474 (96.2025%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   3,  Average loss: 0.0013, Accuracy: 462/474 (97.4684%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   4,  Average loss: 0.0009, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   5,  Average loss: 0.0008, Accuracy: 467/474 (98.5232%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   6,  Average loss: 0.0006, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   7,  Average loss: 0.0006, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   8,  Average loss: 0.0006, Accuracy: 469/474 (98.9451%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   9,  Average loss: 0.0005, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch  10,  Average loss: 0.0005, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Global model norm: 14.790788020870298.
Norm before scaling: 15.012788026255786. Distance: 1.4073854313053946
Total norm for 1 adversaries is: 15.012788026255786. distance: 1.4073854313053946
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.4717, Accuracy: 7836/8991 (87.1538%)
___Train Local_Simple,  epoch  19, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 1136/1246 (91.1717%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4176, Accuracy: 8666/10000 (86.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 597/647 (92.2720%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.1636, Accuracy: 6252/10000 (62.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0054, Accuracy: 459/501 (91.6168%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2954, Accuracy: 9091/10000 (90.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0065, Accuracy: 568/633 (89.7314%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3869, Accuracy: 8818/10000 (88.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0047, Accuracy: 818/915 (89.3989%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3346, Accuracy: 9016/10000 (90.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 560/615 (91.0569%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8989, Accuracy: 7758/10000 (77.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 846/923 (91.6576%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.9596, Accuracy: 6355/10000 (63.5500%), Attack Success Rate:0/10000(0.000)
time spent on training: 57.845624923706055
[foolsgold agg] training data poison_ratio: 0.06563278870119081  data num: [860, 408, 474, 1246, 647, 501, 633, 915, 615, 923]
[foolsgold agg] considering poison per batch poison_fraction: 0.06563278870119081
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.4001, Accuracy: 8743/10000 (87.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.3863, Accuracy: 8043/8991 (89.4561%)
Done in 97.10626888275146 sec.
Server Epoch:20 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
___Train Local_Simple,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0041, Accuracy: 275/293 (93.8567%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.5057, Accuracy: 8343/10000 (83.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0065, Accuracy: 367/408 (89.9510%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.8254, Accuracy: 7715/10000 (77.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 443/471 (94.0552%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.2957, Accuracy: 7425/10000 (74.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 82, internal_epoch   1,  Average loss: 0.0032, Accuracy: 677/713 (94.9509%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.2088, Accuracy: 7183/10000 (71.8300%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0029, Accuracy: 823/860 (95.6977%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.5552, Accuracy: 8073/10000 (80.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0027, Accuracy: 483/499 (96.7936%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0371, Accuracy: 7516/10000 (75.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 29, internal_epoch   1,  Average loss: 0.0025, Accuracy: 954/1002 (95.2096%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.2005, Accuracy: 6828/10000 (68.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 47, internal_epoch   1,  Average loss: 0.0041, Accuracy: 724/776 (93.2990%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6400, Accuracy: 8244/10000 (82.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 582/645 (90.2326%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 5.1042, Accuracy: 3037/10000 (30.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0054, Accuracy: 217/236 (91.9492%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6409, Accuracy: 7515/10000 (75.1500%), Attack Success Rate:0/10000(0.000)
time spent on training: 47.8480019569397
[foolsgold agg] training data poison_ratio: 0.0  data num: [293, 408, 471, 713, 860, 499, 1002, 776, 645, 236]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.3388, Accuracy: 9123/10000 (91.2300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.3680, Accuracy: 7840/8991 (87.1983%)
Done in 88.00884580612183 sec.
Server Epoch:21 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
___Train Local_Simple,  epoch  21, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 571/623 (91.6533%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.9692, Accuracy: 7379/10000 (73.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 1065/1160 (91.8103%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7923, Accuracy: 7227/10000 (72.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0023, Accuracy: 602/623 (96.6292%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.8869, Accuracy: 6756/10000 (67.5600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  21, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 378/401 (94.2643%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.5309, Accuracy: 8301/10000 (83.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0044, Accuracy: 563/606 (92.9043%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.7068, Accuracy: 5484/10000 (54.8400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0028, Accuracy: 461/487 (94.6612%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0217, Accuracy: 7724/10000 (77.2400%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   1,  Average loss: 0.0036, Accuracy: 402/429 (93.7063%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   2,  Average loss: 0.0018, Accuracy: 409/429 (95.3380%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   3,  Average loss: 0.0007, Accuracy: 423/429 (98.6014%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   4,  Average loss: 0.0006, Accuracy: 425/429 (99.0676%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   5,  Average loss: 0.0004, Accuracy: 427/429 (99.5338%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   6,  Average loss: 0.0004, Accuracy: 427/429 (99.5338%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   7,  Average loss: 0.0004, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   8,  Average loss: 0.0003, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   9,  Average loss: 0.0003, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch  10,  Average loss: 0.0003, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Global model norm: 14.850769824486635.
Norm before scaling: 15.013038055154187. Distance: 1.2506774497102784
Total norm for 1 adversaries is: 15.013038055154187. distance: 1.2506774497102784
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.5345, Accuracy: 7608/8991 (84.6180%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0042, Accuracy: 232/250 (92.8000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7539, Accuracy: 7877/10000 (78.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 470/519 (90.5588%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.9904, Accuracy: 7190/10000 (71.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0051, Accuracy: 231/253 (91.3043%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7801, Accuracy: 8004/10000 (80.0400%), Attack Success Rate:0/10000(0.000)
time spent on training: 54.293112993240356
[foolsgold agg] training data poison_ratio: 0.08017193048028406  data num: [623, 1160, 623, 401, 606, 487, 429, 250, 519, 253]
[foolsgold agg] considering poison per batch poison_fraction: 0.08017193048028406
[foolsgold agg] wv: [1.         1.         0.         1.         1.         1.
 1.         0.05056864 1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.3363, Accuracy: 8946/10000 (89.4600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.3312, Accuracy: 8028/8991 (89.2893%)
Done in 94.5736448764801 sec.
Server Epoch:22 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
___Train Local_Simple,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 348/379 (91.8206%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.4365, Accuracy: 8474/10000 (84.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0034, Accuracy: 836/895 (93.4078%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.8344, Accuracy: 7813/10000 (78.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0051, Accuracy: 214/236 (90.6780%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5595, Accuracy: 7682/10000 (76.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0043, Accuracy: 905/977 (92.6305%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.4566, Accuracy: 8572/10000 (85.7200%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   1,  Average loss: 0.0040, Accuracy: 316/338 (93.4911%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   2,  Average loss: 0.0024, Accuracy: 323/338 (95.5621%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   3,  Average loss: 0.0012, Accuracy: 328/338 (97.0414%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   4,  Average loss: 0.0012, Accuracy: 333/338 (98.5207%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   5,  Average loss: 0.0007, Accuracy: 334/338 (98.8166%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   6,  Average loss: 0.0007, Accuracy: 335/338 (99.1124%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   7,  Average loss: 0.0007, Accuracy: 335/338 (99.1124%), train_poison_data_count: 338
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   8,  Average loss: 0.0005, Accuracy: 336/338 (99.4083%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   9,  Average loss: 0.0005, Accuracy: 337/338 (99.7041%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch  10,  Average loss: 0.0005, Accuracy: 337/338 (99.7041%), train_poison_data_count: 338
Global model norm: 14.875816515142539.
Norm before scaling: 15.00585111304764. Distance: 0.9633255106092458
Total norm for 1 adversaries is: 15.00585111304764. distance: 0.9633255106092458
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.3818, Accuracy: 7979/8991 (88.7443%)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 578/633 (91.3112%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3466, Accuracy: 8757/10000 (87.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0027, Accuracy: 476/499 (95.3908%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.3468, Accuracy: 7183/10000 (71.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 92, internal_epoch   1,  Average loss: 0.0032, Accuracy: 878/937 (93.7033%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.9259, Accuracy: 7719/10000 (77.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 27, internal_epoch   1,  Average loss: 0.0032, Accuracy: 440/471 (93.4183%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.6838, Accuracy: 6496/10000 (64.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 96, internal_epoch   1,  Average loss: 0.0029, Accuracy: 638/672 (94.9405%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.0117, Accuracy: 7960/10000 (79.6000%), Attack Success Rate:0/10000(0.000)
time spent on training: 53.275293827056885
[foolsgold agg] training data poison_ratio: 0.05598807354646348  data num: [379, 895, 236, 977, 338, 633, 499, 937, 471, 672]
[foolsgold agg] considering poison per batch poison_fraction: 0.05598807354646348
[foolsgold agg] wv: [0.58845811 1.         0.58845811 1.         1.         1.
 1.         1.         1.         0.88987301]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.3070, Accuracy: 8993/10000 (89.9300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.3139, Accuracy: 7983/8991 (88.7888%)
Done in 101.33827519416809 sec.
Server Epoch:23 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0036, Accuracy: 823/880 (93.5227%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4026, Accuracy: 8694/10000 (86.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0045, Accuracy: 676/713 (94.8107%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.9094, Accuracy: 7413/10000 (74.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 85, internal_epoch   1,  Average loss: 0.0030, Accuracy: 411/431 (95.3596%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.0167, Accuracy: 8202/10000 (82.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0041, Accuracy: 572/620 (92.2581%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4646, Accuracy: 8634/10000 (86.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0069, Accuracy: 66/78 (84.6154%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2872, Accuracy: 9211/10000 (92.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 61, internal_epoch   1,  Average loss: 0.0036, Accuracy: 648/699 (92.7039%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.4556, Accuracy: 7163/10000 (71.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0035, Accuracy: 519/554 (93.6823%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4156, Accuracy: 8621/10000 (86.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0035, Accuracy: 230/250 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.7348, Accuracy: 8188/10000 (81.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0020, Accuracy: 477/492 (96.9512%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.7344, Accuracy: 7893/10000 (78.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 75, internal_epoch   1,  Average loss: 0.0035, Accuracy: 636/686 (92.7114%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4923, Accuracy: 8600/10000 (86.0000%), Attack Success Rate:0/10000(0.000)
time spent on training: 47.1710319519043
[foolsgold agg] training data poison_ratio: 0.0  data num: [880, 713, 431, 620, 78, 699, 554, 250, 492, 686]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         0.71165976 1.         0.71165976 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.2676, Accuracy: 9222/10000 (92.2200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.3256, Accuracy: 7821/8991 (86.9870%)
Done in 85.13349199295044 sec.
Server Epoch:24 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
___Train Local_Simple,  epoch  24, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 940/1005 (93.5323%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.3833, Accuracy: 7535/10000 (75.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0026, Accuracy: 356/371 (95.9569%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.8149, Accuracy: 7708/10000 (77.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 96, internal_epoch   1,  Average loss: 0.0025, Accuracy: 650/672 (96.7262%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.7120, Accuracy: 8245/10000 (82.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 83, internal_epoch   1,  Average loss: 0.0037, Accuracy: 404/433 (93.3025%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2665, Accuracy: 9088/10000 (90.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 812/889 (91.3386%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3534, Accuracy: 8895/10000 (88.9500%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0033, Accuracy: 379/400 (94.7500%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   2,  Average loss: 0.0023, Accuracy: 384/400 (96.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   3,  Average loss: 0.0014, Accuracy: 389/400 (97.2500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   4,  Average loss: 0.0009, Accuracy: 395/400 (98.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   5,  Average loss: 0.0010, Accuracy: 394/400 (98.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   6,  Average loss: 0.0007, Accuracy: 395/400 (98.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   7,  Average loss: 0.0007, Accuracy: 397/400 (99.2500%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   8,  Average loss: 0.0006, Accuracy: 398/400 (99.5000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   9,  Average loss: 0.0006, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch  10,  Average loss: 0.0005, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Global model norm: 14.922926684961183.
Norm before scaling: 15.026578625407279. Distance: 0.9921715502320525
Total norm for 2 adversaries is: 15.026578625407279. distance: 0.9921715502320525
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.5582, Accuracy: 7398/8991 (82.2823%)
___Train Local_Simple,  epoch  24, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 141/150 (94.0000%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.0156, Accuracy: 6484/10000 (64.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0042, Accuracy: 595/647 (91.9629%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3419, Accuracy: 8925/10000 (89.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0049, Accuracy: 228/253 (90.1186%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5744, Accuracy: 8107/10000 (81.0700%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   1,  Average loss: 0.0029, Accuracy: 453/474 (95.5696%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   2,  Average loss: 0.0021, Accuracy: 460/474 (97.0464%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   3,  Average loss: 0.0010, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   4,  Average loss: 0.0007, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   5,  Average loss: 0.0006, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   6,  Average loss: 0.0006, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   7,  Average loss: 0.0005, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   8,  Average loss: 0.0005, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   9,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch  10,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Global model norm: 14.922926684961183.
Norm before scaling: 15.051258244939504. Distance: 1.1076498452936527
Total norm for 2 adversaries is: 15.051258244939504. distance: 1.1076498452936527
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.3613, Accuracy: 8012/8991 (89.1113%)
time spent on training: 63.405582904815674
[foolsgold agg] training data poison_ratio: 0.1650925576123914  data num: [1005, 371, 672, 433, 889, 400, 150, 647, 253, 474]
[foolsgold agg] considering poison per batch poison_fraction: 0.1650925576123914
[foolsgold agg] wv: [1.         1.         0.88383201 1.         1.         1.
 0.88383201 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.2311, Accuracy: 9333/10000 (93.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.3286, Accuracy: 7753/8991 (86.2307%)
Done in 99.87305998802185 sec.
Server Epoch:25 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
___Train Local_Simple,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0033, Accuracy: 586/628 (93.3121%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.2425, Accuracy: 6620/10000 (66.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0034, Accuracy: 575/615 (93.4959%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6535, Accuracy: 7929/10000 (79.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.0016, Accuracy: 489/499 (97.9960%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.9320, Accuracy: 7971/10000 (79.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0027, Accuracy: 583/620 (94.0323%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3795, Accuracy: 8905/10000 (89.0500%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 403/429 (93.9394%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0014, Accuracy: 415/429 (96.7366%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   3,  Average loss: 0.0009, Accuracy: 420/429 (97.9021%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   4,  Average loss: 0.0006, Accuracy: 424/429 (98.8345%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   5,  Average loss: 0.0004, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   6,  Average loss: 0.0003, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   7,  Average loss: 0.0003, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   8,  Average loss: 0.0003, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   9,  Average loss: 0.0002, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch  10,  Average loss: 0.0002, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Global model norm: 14.956136529781377.
Norm before scaling: 15.065939862660827. Distance: 1.2136712011968327
Total norm for 1 adversaries is: 15.065939862660827. distance: 1.2136712011968327
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.4898, Accuracy: 7706/8991 (85.7079%)
___Train Local_Simple,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0023, Accuracy: 566/591 (95.7699%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4082, Accuracy: 8655/10000 (86.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0055, Accuracy: 379/408 (92.8922%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.5816, Accuracy: 8110/10000 (81.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0039, Accuracy: 590/633 (93.2070%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3394, Accuracy: 8916/10000 (89.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0049, Accuracy: 501/557 (89.9461%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.5487, Accuracy: 8036/10000 (80.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 861/923 (93.2828%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4760, Accuracy: 8289/10000 (82.8900%), Attack Success Rate:0/10000(0.000)
time spent on training: 53.464481830596924
[foolsgold agg] training data poison_ratio: 0.07267491106217178  data num: [628, 615, 499, 620, 429, 591, 408, 633, 557, 923]
[foolsgold agg] considering poison per batch poison_fraction: 0.07267491106217178
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.2165, Accuracy: 9381/10000 (93.8100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.3352, Accuracy: 7761/8991 (86.3197%)
Done in 89.74280667304993 sec.
Server Epoch:26 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
___Train Local_Simple,  epoch  26, local model 39, internal_epoch   1,  Average loss: 0.0026, Accuracy: 243/257 (94.5525%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3179, Accuracy: 8903/10000 (89.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 352/376 (93.6170%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.5136, Accuracy: 8253/10000 (82.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 32, internal_epoch   1,  Average loss: 0.0035, Accuracy: 921/977 (94.2682%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3406, Accuracy: 8903/10000 (89.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 613/658 (93.1611%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.8256, Accuracy: 7689/10000 (76.8900%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   1,  Average loss: 0.0025, Accuracy: 380/400 (95.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   2,  Average loss: 0.0019, Accuracy: 383/400 (95.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   3,  Average loss: 0.0013, Accuracy: 390/400 (97.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   4,  Average loss: 0.0006, Accuracy: 397/400 (99.2500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   5,  Average loss: 0.0007, Accuracy: 397/400 (99.2500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   6,  Average loss: 0.0005, Accuracy: 398/400 (99.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   7,  Average loss: 0.0006, Accuracy: 397/400 (99.2500%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   8,  Average loss: 0.0004, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   9,  Average loss: 0.0005, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch  10,  Average loss: 0.0005, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Global model norm: 14.977709675026253.
Norm before scaling: 15.055819094245017. Distance: 0.893210956769708
Total norm for 1 adversaries is: 15.055819094245017. distance: 0.893210956769708
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.5752, Accuracy: 7428/8991 (82.6159%)
___Train Local_Simple,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 824/889 (92.6884%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.4773, Accuracy: 8470/10000 (84.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0020, Accuracy: 285/293 (97.2696%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3371, Accuracy: 8892/10000 (88.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 868/923 (94.0412%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.5489, Accuracy: 8015/10000 (80.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0038, Accuracy: 142/150 (94.6667%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.5682, Accuracy: 7944/10000 (79.4400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  26, local model 84, internal_epoch   1,  Average loss: 0.0032, Accuracy: 1173/1246 (94.1413%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2905, Accuracy: 9052/10000 (90.5200%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.70783305168152
[foolsgold agg] training data poison_ratio: 0.0648403306856865  data num: [257, 376, 977, 658, 400, 889, 293, 923, 150, 1246]
[foolsgold agg] considering poison per batch poison_fraction: 0.0648403306856865
[foolsgold agg] wv: [0.42960407 1.         1.         1.         1.         1.
 0.42960407 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.2096, Accuracy: 9384/10000 (93.8400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.3383, Accuracy: 7768/8991 (86.3975%)
Done in 87.83428907394409 sec.
Server Epoch:27 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
___Train Local_Simple,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.0033, Accuracy: 239/256 (93.3594%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3971, Accuracy: 8395/10000 (83.9500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 514/548 (93.7956%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3952, Accuracy: 8704/10000 (87.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 42, internal_epoch   1,  Average loss: 0.0033, Accuracy: 220/236 (93.2203%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.6210, Accuracy: 7811/10000 (78.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0033, Accuracy: 607/647 (93.8176%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.5878, Accuracy: 7794/10000 (77.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0030, Accuracy: 591/620 (95.3226%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3417, Accuracy: 8972/10000 (89.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0024, Accuracy: 824/860 (95.8140%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4322, Accuracy: 8613/10000 (86.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 45, internal_epoch   1,  Average loss: 0.0026, Accuracy: 593/628 (94.4268%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.4379, Accuracy: 6720/10000 (67.2000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  27, local model 54, internal_epoch   1,  Average loss: 0.0030, Accuracy: 491/519 (94.6050%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.7264, Accuracy: 7721/10000 (77.2100%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   1,  Average loss: 0.0029, Accuracy: 380/400 (95.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   2,  Average loss: 0.0016, Accuracy: 391/400 (97.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   3,  Average loss: 0.0019, Accuracy: 385/400 (96.2500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   4,  Average loss: 0.0011, Accuracy: 394/400 (98.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   5,  Average loss: 0.0006, Accuracy: 397/400 (99.2500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   6,  Average loss: 0.0005, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   7,  Average loss: 0.0004, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   8,  Average loss: 0.0004, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   9,  Average loss: 0.0004, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch  10,  Average loss: 0.0004, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Global model norm: 15.002195579060514.
Norm before scaling: 15.082219934555287. Distance: 0.9731921515941279
Total norm for 1 adversaries is: 15.082219934555287. distance: 0.9731921515941279
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.6260, Accuracy: 7360/8991 (81.8596%)
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 407/435 (93.5632%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.5919, Accuracy: 8239/10000 (82.3900%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.298413038253784
[foolsgold agg] training data poison_ratio: 0.07768498737618955  data num: [256, 548, 236, 647, 620, 860, 628, 519, 400, 435]
[foolsgold agg] considering poison per batch poison_fraction: 0.07768498737618955
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.1918, Accuracy: 9424/10000 (94.2400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.3667, Accuracy: 7755/8991 (86.2529%)
Done in 87.3488278388977 sec.
Server Epoch:28 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
___Train Local_Simple,  epoch  28, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 577/623 (92.6164%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6513, Accuracy: 7945/10000 (79.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0026, Accuracy: 537/568 (94.5423%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.4795, Accuracy: 8465/10000 (84.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0032, Accuracy: 583/620 (94.0323%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3325, Accuracy: 8904/10000 (89.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 824/889 (92.6884%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3686, Accuracy: 8861/10000 (88.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 577/615 (93.8211%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6465, Accuracy: 7666/10000 (76.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.0024, Accuracy: 364/379 (96.0422%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3601, Accuracy: 8755/10000 (87.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0029, Accuracy: 673/713 (94.3899%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.7514, Accuracy: 7347/10000 (73.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 35, internal_epoch   1,  Average loss: 0.0017, Accuracy: 483/499 (96.7936%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.7227, Accuracy: 7865/10000 (78.6500%), Attack Success Rate:0/10000(0.000)
poison local model 80 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   1,  Average loss: 0.0020, Accuracy: 410/431 (95.1276%), train_poison_data_count: 431
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   2,  Average loss: 0.0014, Accuracy: 418/431 (96.9838%), train_poison_data_count: 431
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   3,  Average loss: 0.0008, Accuracy: 426/431 (98.8399%), train_poison_data_count: 431
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   4,  Average loss: 0.0006, Accuracy: 427/431 (99.0719%), train_poison_data_count: 431
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   5,  Average loss: 0.0004, Accuracy: 429/431 (99.5360%), train_poison_data_count: 431
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   6,  Average loss: 0.0003, Accuracy: 429/431 (99.5360%), train_poison_data_count: 431
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   7,  Average loss: 0.0003, Accuracy: 430/431 (99.7680%), train_poison_data_count: 431
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   8,  Average loss: 0.0003, Accuracy: 431/431 (100.0000%), train_poison_data_count: 431
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   9,  Average loss: 0.0002, Accuracy: 431/431 (100.0000%), train_poison_data_count: 431
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch  10,  Average loss: 0.0002, Accuracy: 431/431 (100.0000%), train_poison_data_count: 431
Global model norm: 15.022667605727936.
Norm before scaling: 15.07603207624813. Distance: 0.8852828579190894
Total norm for 1 adversaries is: 15.07603207624813. distance: 0.8852828579190894
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.2982, Accuracy: 8196/8991 (91.1578%)
___Train Local_Simple,  epoch  28, local model 81, internal_epoch   1,  Average loss: 0.0020, Accuracy: 1177/1227 (95.9250%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.1535, Accuracy: 7519/10000 (75.1900%), Attack Success Rate:0/10000(0.000)
time spent on training: 52.68930006027222
[foolsgold agg] training data poison_ratio: 0.06566118220597197  data num: [623, 568, 620, 889, 615, 379, 713, 499, 431, 1227]
[foolsgold agg] considering poison per batch poison_fraction: 0.06566118220597197
[foolsgold agg] wv: [0.96922448 1.         0.96922448 1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.1849, Accuracy: 9446/10000 (94.4600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.3779, Accuracy: 7765/8991 (86.3641%)
Done in 89.42172312736511 sec.
Server Epoch:29 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
___Train Local_Simple,  epoch  29, local model 58, internal_epoch   1,  Average loss: 0.0045, Accuracy: 262/276 (94.9275%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4241, Accuracy: 8463/10000 (84.6300%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 646/683 (94.5827%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   2,  Average loss: 0.0015, Accuracy: 662/683 (96.9253%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   3,  Average loss: 0.0008, Accuracy: 672/683 (98.3895%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   4,  Average loss: 0.0006, Accuracy: 675/683 (98.8287%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   5,  Average loss: 0.0006, Accuracy: 678/683 (99.2679%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   6,  Average loss: 0.0005, Accuracy: 677/683 (99.1215%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   7,  Average loss: 0.0005, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   8,  Average loss: 0.0004, Accuracy: 678/683 (99.2679%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch   9,  Average loss: 0.0004, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 90, internal_epoch  10,  Average loss: 0.0004, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Global model norm: 15.044688984022786.
Norm before scaling: 15.131537419661532. Distance: 1.306231470296019
Total norm for 3 adversaries is: 15.131537419661532. distance: 1.306231470296019
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.9777, Accuracy: 6808/8991 (75.7202%)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0026, Accuracy: 381/400 (95.2500%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   2,  Average loss: 0.0020, Accuracy: 385/400 (96.2500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   3,  Average loss: 0.0010, Accuracy: 391/400 (97.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   4,  Average loss: 0.0008, Accuracy: 396/400 (99.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   5,  Average loss: 0.0005, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   6,  Average loss: 0.0005, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   7,  Average loss: 0.0004, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   8,  Average loss: 0.0003, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   9,  Average loss: 0.0003, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch  10,  Average loss: 0.0003, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Global model norm: 15.044688984022786.
Norm before scaling: 15.111464820412172. Distance: 0.9226055483409132
Total norm for 3 adversaries is: 15.111464820412172. distance: 0.9226055483409132
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.6779, Accuracy: 7358/8991 (81.8374%)
___Train Local_Simple,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.0026, Accuracy: 700/731 (95.7592%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4929, Accuracy: 8346/10000 (83.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0029, Accuracy: 579/606 (95.5446%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.5916, Accuracy: 8031/10000 (80.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0027, Accuracy: 611/647 (94.4359%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.5460, Accuracy: 8144/10000 (81.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0033, Accuracy: 853/915 (93.2240%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2921, Accuracy: 9104/10000 (91.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 91, internal_epoch   1,  Average loss: 0.0023, Accuracy: 247/256 (96.4844%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3159, Accuracy: 8849/10000 (88.4900%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0025, Accuracy: 447/474 (94.3038%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0015, Accuracy: 461/474 (97.2574%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   3,  Average loss: 0.0007, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   4,  Average loss: 0.0005, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   5,  Average loss: 0.0004, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   6,  Average loss: 0.0004, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   7,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   8,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   9,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch  10,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Global model norm: 15.044688984022786.
Norm before scaling: 15.124444620323821. Distance: 1.1750365779134322
Total norm for 3 adversaries is: 15.124444620323821. distance: 1.1750365779134322
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.3297, Accuracy: 8132/8991 (90.4460%)
___Train Local_Simple,  epoch  29, local model 57, internal_epoch   1,  Average loss: 0.0049, Accuracy: 317/343 (92.4198%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.5136, Accuracy: 8564/10000 (85.6400%), Attack Success Rate:0/10000(0.000)
time spent on training: 69.38980102539062
[foolsgold agg] training data poison_ratio: 0.2920652785593697  data num: [276, 683, 400, 731, 606, 647, 915, 256, 474, 343]
[foolsgold agg] considering poison per batch poison_fraction: 0.2920652785593697
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.1859, Accuracy: 9429/10000 (94.2900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.3315, Accuracy: 7816/8991 (86.9314%)
Done in 105.41391491889954 sec.
Server Epoch:30 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   1,  Average loss: 0.0022, Accuracy: 452/474 (95.3586%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   2,  Average loss: 0.0011, Accuracy: 464/474 (97.8903%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   3,  Average loss: 0.0007, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   4,  Average loss: 0.0005, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   5,  Average loss: 0.0004, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   6,  Average loss: 0.0005, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   7,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   8,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   9,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch  10,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Global model norm: 15.079854377832719.
Norm before scaling: 15.140828071232338. Distance: 1.056699120106407
Total norm for 4 adversaries is: 15.140828071232338. distance: 1.056699120106407
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2923, Accuracy: 8196/8991 (91.1578%)
___Train Local_Simple,  epoch  30, local model 77, internal_epoch   1,  Average loss: 0.0041, Accuracy: 540/589 (91.6808%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4053, Accuracy: 8654/10000 (86.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0021, Accuracy: 565/591 (95.6007%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.7419, Accuracy: 7410/10000 (74.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 21, internal_epoch   1,  Average loss: 0.0028, Accuracy: 291/312 (93.2692%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6998, Accuracy: 7667/10000 (76.6700%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0025, Accuracy: 851/892 (95.4036%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   2,  Average loss: 0.0011, Accuracy: 877/892 (98.3184%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   3,  Average loss: 0.0007, Accuracy: 880/892 (98.6547%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   4,  Average loss: 0.0005, Accuracy: 879/892 (98.5426%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   5,  Average loss: 0.0005, Accuracy: 882/892 (98.8789%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   6,  Average loss: 0.0004, Accuracy: 885/892 (99.2152%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   7,  Average loss: 0.0004, Accuracy: 886/892 (99.3274%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   8,  Average loss: 0.0003, Accuracy: 887/892 (99.4395%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   9,  Average loss: 0.0003, Accuracy: 887/892 (99.4395%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch  10,  Average loss: 0.0003, Accuracy: 887/892 (99.4395%), train_poison_data_count: 892
Global model norm: 15.079854377832719.
Norm before scaling: 15.14167156873731. Distance: 2.035805977403204
Total norm for 4 adversaries is: 15.14167156873731. distance: 2.035805977403204
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.2257, Accuracy: 6151/8991 (68.4129%)
___Train Local_Simple,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 583/633 (92.1011%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4322, Accuracy: 8728/10000 (87.2800%), Attack Success Rate:0/10000(0.000)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0023, Accuracy: 737/772 (95.4663%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   2,  Average loss: 0.0011, Accuracy: 754/772 (97.6684%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   3,  Average loss: 0.0005, Accuracy: 766/772 (99.2228%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   4,  Average loss: 0.0003, Accuracy: 769/772 (99.6114%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   5,  Average loss: 0.0003, Accuracy: 770/772 (99.7409%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   6,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   7,  Average loss: 0.0002, Accuracy: 770/772 (99.7409%), train_poison_data_count: 772
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   8,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   9,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch  10,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Global model norm: 15.079854377832719.
Norm before scaling: 15.184056021069487. Distance: 1.3704123257299288
Total norm for 4 adversaries is: 15.184056021069487. distance: 1.3704123257299288
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.6073, Accuracy: 7674/8991 (85.3520%)
___Train Local_Simple,  epoch  30, local model 52, internal_epoch   1,  Average loss: 0.0036, Accuracy: 232/253 (91.6996%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6246, Accuracy: 8306/10000 (83.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 45, internal_epoch   1,  Average loss: 0.0023, Accuracy: 596/628 (94.9045%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.1476, Accuracy: 6967/10000 (69.6700%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   1,  Average loss: 0.0022, Accuracy: 381/400 (95.2500%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   2,  Average loss: 0.0011, Accuracy: 392/400 (98.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   3,  Average loss: 0.0005, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   4,  Average loss: 0.0005, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   5,  Average loss: 0.0003, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   6,  Average loss: 0.0003, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   7,  Average loss: 0.0003, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   8,  Average loss: 0.0003, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   9,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch  10,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Global model norm: 15.079854377832719.
Norm before scaling: 15.131406325833066. Distance: 0.8153578309703778
Total norm for 4 adversaries is: 15.131406325833066. distance: 0.8153578309703778
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.6605, Accuracy: 7398/8991 (82.2823%)
time spent on training: 82.36385798454285
[foolsgold agg] training data poison_ratio: 0.4577922077922078  data num: [474, 589, 591, 312, 892, 633, 772, 253, 628, 400]
[foolsgold agg] considering poison per batch poison_fraction: 0.4577922077922078
[foolsgold agg] wv: [0.72155013 1.         1.         1.         0.72155013 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.1917, Accuracy: 9363/10000 (93.6300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.2888, Accuracy: 7904/8991 (87.9101%)
Done in 119.12964081764221 sec.
Server Epoch:31 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
___Train Local_Simple,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 514/557 (92.2801%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4722, Accuracy: 8378/10000 (83.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 406/436 (93.1193%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4277, Accuracy: 8556/10000 (85.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0035, Accuracy: 354/377 (93.8992%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.5359, Accuracy: 8152/10000 (81.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 85, internal_epoch   1,  Average loss: 0.0017, Accuracy: 416/431 (96.5197%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.8627, Accuracy: 8361/10000 (83.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 597/658 (90.7295%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.7144, Accuracy: 7620/10000 (76.2000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0040, Accuracy: 607/645 (94.1085%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.3828, Accuracy: 6790/10000 (67.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 24, internal_epoch   1,  Average loss: 0.0025, Accuracy: 359/379 (94.7230%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3274, Accuracy: 8859/10000 (88.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0027, Accuracy: 223/236 (94.4915%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4403, Accuracy: 8402/10000 (84.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0016, Accuracy: 285/293 (97.2696%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2471, Accuracy: 9242/10000 (92.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 25, internal_epoch   1,  Average loss: 0.0031, Accuracy: 610/647 (94.2813%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6015, Accuracy: 7999/10000 (79.9900%), Attack Success Rate:0/10000(0.000)
time spent on training: 310.3411247730255
[foolsgold agg] training data poison_ratio: 0.0  data num: [557, 436, 377, 431, 658, 645, 379, 236, 293, 647]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1.         1.         0.90385245 1.         0.90385245 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.1521, Accuracy: 9536/10000 (95.3600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.4360, Accuracy: 7751/8991 (86.2084%)
Done in 348.24186873435974 sec.
Server Epoch:32 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0009, Accuracy: 608/623 (97.5923%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.7256, Accuracy: 7837/10000 (78.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.0029, Accuracy: 445/470 (94.6809%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4059, Accuracy: 8609/10000 (86.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 55, internal_epoch   1,  Average loss: 0.0019, Accuracy: 344/354 (97.1751%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.2338, Accuracy: 7001/10000 (70.0100%), Attack Success Rate:1/10000(0.010)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   1,  Average loss: 0.0027, Accuracy: 687/724 (94.8895%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   2,  Average loss: 0.0019, Accuracy: 702/724 (96.9613%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   3,  Average loss: 0.0009, Accuracy: 710/724 (98.0663%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   4,  Average loss: 0.0006, Accuracy: 718/724 (99.1713%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   5,  Average loss: 0.0005, Accuracy: 720/724 (99.4475%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   6,  Average loss: 0.0004, Accuracy: 722/724 (99.7238%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   7,  Average loss: 0.0004, Accuracy: 722/724 (99.7238%), train_poison_data_count: 724
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   8,  Average loss: 0.0004, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   9,  Average loss: 0.0003, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch  10,  Average loss: 0.0003, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Global model norm: 15.12538335645373.
Norm before scaling: 15.233102911633146. Distance: 1.471902102729088
Total norm for 3 adversaries is: 15.233102911633146. distance: 1.471902102729088
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.4582, Accuracy: 7810/8991 (86.8646%)
___Train Local_Simple,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0017, Accuracy: 388/401 (96.7581%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3818, Accuracy: 8725/10000 (87.2500%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 653/683 (95.6076%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   2,  Average loss: 0.0010, Accuracy: 669/683 (97.9502%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   3,  Average loss: 0.0006, Accuracy: 677/683 (99.1215%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   4,  Average loss: 0.0005, Accuracy: 678/683 (99.2679%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   5,  Average loss: 0.0005, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   6,  Average loss: 0.0004, Accuracy: 680/683 (99.5608%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   7,  Average loss: 0.0004, Accuracy: 681/683 (99.7072%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   8,  Average loss: 0.0003, Accuracy: 680/683 (99.5608%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch   9,  Average loss: 0.0003, Accuracy: 680/683 (99.5608%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 90, internal_epoch  10,  Average loss: 0.0003, Accuracy: 681/683 (99.7072%), train_poison_data_count: 683
Global model norm: 15.12538335645373.
Norm before scaling: 15.168541146165959. Distance: 1.349785181897324
Total norm for 3 adversaries is: 15.168541146165959. distance: 1.349785181897324
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 1.2382, Accuracy: 6563/8991 (72.9952%)
___Train Local_Simple,  epoch  32, local model 91, internal_epoch   1,  Average loss: 0.0017, Accuracy: 249/256 (97.2656%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2071, Accuracy: 9324/10000 (93.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 86, internal_epoch   1,  Average loss: 0.0019, Accuracy: 239/250 (95.6000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3192, Accuracy: 8933/10000 (89.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 67, internal_epoch   1,  Average loss: 0.0026, Accuracy: 948/998 (94.9900%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5674, Accuracy: 8072/10000 (80.7200%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0032, Accuracy: 401/429 (93.4732%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   2,  Average loss: 0.0012, Accuracy: 420/429 (97.9021%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   3,  Average loss: 0.0006, Accuracy: 426/429 (99.3007%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   4,  Average loss: 0.0005, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   5,  Average loss: 0.0004, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   6,  Average loss: 0.0003, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   7,  Average loss: 0.0003, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   8,  Average loss: 0.0002, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   9,  Average loss: 0.0002, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch  10,  Average loss: 0.0002, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Global model norm: 15.12538335645373.
Norm before scaling: 15.191190294813708. Distance: 1.6609777953462534
Total norm for 3 adversaries is: 15.191190294813708. distance: 1.6609777953462534
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.3650, Accuracy: 7972/8991 (88.6664%)
time spent on training: 72.45361113548279
[foolsgold agg] training data poison_ratio: 0.353893600616808  data num: [623, 470, 354, 724, 401, 683, 256, 250, 998, 429]
[foolsgold agg] considering poison per batch poison_fraction: 0.353893600616808
[foolsgold agg] wv: [0. 1. 1. 1. 1. 1. 1. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.1709, Accuracy: 9440/10000 (94.4000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.3120, Accuracy: 7848/8991 (87.2873%)
Done in 109.06325197219849 sec.
Server Epoch:33 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
___Train Local_Simple,  epoch  33, local model 77, internal_epoch   1,  Average loss: 0.0037, Accuracy: 547/589 (92.8693%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3455, Accuracy: 8880/10000 (88.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0062, Accuracy: 307/343 (89.5044%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4108, Accuracy: 8559/10000 (85.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 21, internal_epoch   1,  Average loss: 0.0021, Accuracy: 299/312 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3139, Accuracy: 8945/10000 (89.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.0034, Accuracy: 941/998 (94.2886%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.0510, Accuracy: 6829/10000 (68.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0038, Accuracy: 352/376 (93.6170%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3362, Accuracy: 8924/10000 (89.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 97, internal_epoch   1,  Average loss: 0.0026, Accuracy: 461/487 (94.6612%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6099, Accuracy: 7830/10000 (78.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0028, Accuracy: 476/501 (95.0100%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2115, Accuracy: 9349/10000 (93.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 22, internal_epoch   1,  Average loss: 0.0030, Accuracy: 550/583 (94.3396%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5387, Accuracy: 8294/10000 (82.9400%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   1,  Average loss: 0.0025, Accuracy: 690/724 (95.3039%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   2,  Average loss: 0.0015, Accuracy: 704/724 (97.2376%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   3,  Average loss: 0.0008, Accuracy: 716/724 (98.8950%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   4,  Average loss: 0.0005, Accuracy: 722/724 (99.7238%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   5,  Average loss: 0.0004, Accuracy: 721/724 (99.5856%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   6,  Average loss: 0.0003, Accuracy: 722/724 (99.7238%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   7,  Average loss: 0.0003, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   8,  Average loss: 0.0003, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   9,  Average loss: 0.0002, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch  10,  Average loss: 0.0002, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Global model norm: 15.15756679202462.
Norm before scaling: 15.253577641306808. Distance: 1.3491691169378797
Total norm for 1 adversaries is: 15.253577641306808. distance: 1.3491691169378797
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.3767, Accuracy: 7960/8991 (88.5330%)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0010, Accuracy: 610/623 (97.9133%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.4223, Accuracy: 7024/10000 (70.2400%), Attack Success Rate:0/10000(0.000)
time spent on training: 53.8916699886322
[foolsgold agg] training data poison_ratio: 0.13078034682080925  data num: [589, 343, 312, 998, 376, 487, 501, 583, 724, 623]
[foolsgold agg] considering poison per batch poison_fraction: 0.13078034682080925
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.1619, Accuracy: 9478/10000 (94.7800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.3394, Accuracy: 7820/8991 (86.9759%)
Done in 90.39794397354126 sec.
Server Epoch:34 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
___Train Local_Simple,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0024, Accuracy: 827/860 (96.1628%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4638, Accuracy: 8384/10000 (83.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0018, Accuracy: 482/506 (95.2569%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2151, Accuracy: 9324/10000 (93.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0025, Accuracy: 578/606 (95.3795%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6909, Accuracy: 7855/10000 (78.5500%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0021, Accuracy: 456/474 (96.2025%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0011, Accuracy: 466/474 (98.3122%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   3,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   4,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   5,  Average loss: 0.0003, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   6,  Average loss: 0.0003, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   7,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   8,  Average loss: 0.0003, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   9,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch  10,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 15.175714888851045.
Norm before scaling: 15.214760510041875. Distance: 1.0789234687596845
Total norm for 2 adversaries is: 15.214760510041875. distance: 1.0789234687596845
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.3479, Accuracy: 8080/8991 (89.8676%)
___Train Local_Simple,  epoch  34, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1334/1384 (96.3873%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.9693, Accuracy: 7816/10000 (78.1600%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   1,  Average loss: 0.0029, Accuracy: 325/338 (96.1538%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   2,  Average loss: 0.0019, Accuracy: 329/338 (97.3373%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   3,  Average loss: 0.0008, Accuracy: 333/338 (98.5207%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   4,  Average loss: 0.0007, Accuracy: 337/338 (99.7041%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   5,  Average loss: 0.0005, Accuracy: 337/338 (99.7041%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   6,  Average loss: 0.0004, Accuracy: 338/338 (100.0000%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   7,  Average loss: 0.0004, Accuracy: 338/338 (100.0000%), train_poison_data_count: 338
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   8,  Average loss: 0.0003, Accuracy: 338/338 (100.0000%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   9,  Average loss: 0.0003, Accuracy: 338/338 (100.0000%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch  10,  Average loss: 0.0003, Accuracy: 338/338 (100.0000%), train_poison_data_count: 338
Global model norm: 15.175714888851045.
Norm before scaling: 15.183466622988515. Distance: 0.8106390843164191
Total norm for 2 adversaries is: 15.183466622988515. distance: 0.8106390843164191
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.3747, Accuracy: 7749/8991 (86.1862%)
___Train Local_Simple,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0019, Accuracy: 228/236 (96.6102%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3642, Accuracy: 8757/10000 (87.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0024, Accuracy: 415/433 (95.8430%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2250, Accuracy: 9195/10000 (91.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.0022, Accuracy: 529/554 (95.4874%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2664, Accuracy: 9185/10000 (91.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 48, internal_epoch   1,  Average loss: 0.0022, Accuracy: 423/448 (94.4196%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2977, Accuracy: 9065/10000 (90.6500%), Attack Success Rate:0/10000(0.000)
time spent on training: 59.52517127990723
[foolsgold agg] training data poison_ratio: 0.13906490837472169  data num: [860, 506, 606, 474, 1384, 338, 236, 433, 554, 448]
[foolsgold agg] considering poison per batch poison_fraction: 0.13906490837472169
[foolsgold agg] wv: [0.62327412 1.         0.62327412 1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.1732, Accuracy: 9430/10000 (94.3000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.3293, Accuracy: 7832/8991 (87.1093%)
Done in 96.17049908638 sec.
Server Epoch:35 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
poison local model 50 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 457/474 (96.4135%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   2,  Average loss: 0.0008, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   3,  Average loss: 0.0005, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   4,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   5,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   6,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   7,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   8,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   9,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch  10,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 15.196080676277086.
Norm before scaling: 15.221750077275578. Distance: 0.9273099550871879
Total norm for 2 adversaries is: 15.221750077275578. distance: 0.9273099550871879
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.3127, Accuracy: 8171/8991 (90.8798%)
___Train Local_Simple,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0034, Accuracy: 941/1005 (93.6318%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.1537, Accuracy: 7224/10000 (72.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 53, internal_epoch   1,  Average loss: 0.0023, Accuracy: 706/739 (95.5345%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6802, Accuracy: 7933/10000 (79.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.0053, Accuracy: 163/182 (89.5604%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2136, Accuracy: 9309/10000 (93.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0031, Accuracy: 585/623 (93.9005%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8332, Accuracy: 7851/10000 (78.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 601/647 (92.8903%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4795, Accuracy: 8366/10000 (83.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0014, Accuracy: 392/401 (97.7556%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3295, Accuracy: 8883/10000 (88.8300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 719/760 (94.6053%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   2,  Average loss: 0.0016, Accuracy: 742/760 (97.6316%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   3,  Average loss: 0.0006, Accuracy: 751/760 (98.8158%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   4,  Average loss: 0.0005, Accuracy: 754/760 (99.2105%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   5,  Average loss: 0.0005, Accuracy: 756/760 (99.4737%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   6,  Average loss: 0.0004, Accuracy: 756/760 (99.4737%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   7,  Average loss: 0.0004, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   8,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   9,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch  10,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Global model norm: 15.196080676277086.
Norm before scaling: 15.275540835831261. Distance: 1.3867240368379634
Total norm for 2 adversaries is: 15.275540835831261. distance: 1.3867240368379634
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.2487, Accuracy: 8249/8991 (91.7473%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0022, Accuracy: 356/371 (95.9569%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4453, Accuracy: 8365/10000 (83.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 98, internal_epoch   1,  Average loss: 0.0032, Accuracy: 756/818 (92.4205%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.5211, Accuracy: 8239/10000 (82.3900%), Attack Success Rate:0/10000(0.000)
time spent on training: 63.86321806907654
[foolsgold agg] training data poison_ratio: 0.20498338870431893  data num: [474, 1005, 739, 182, 623, 647, 401, 760, 371, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.20498338870431893
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.1664, Accuracy: 9450/10000 (94.5000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.3366, Accuracy: 7846/8991 (87.2650%)
Done in 100.36393404006958 sec.
Server Epoch:36 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  36, local model 82, internal_epoch   1,  Average loss: 0.0022, Accuracy: 685/713 (96.0729%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4751, Accuracy: 8446/10000 (84.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0029, Accuracy: 621/658 (94.3769%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.4959, Accuracy: 8390/10000 (83.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 79, internal_epoch   1,  Average loss: 0.0045, Accuracy: 164/182 (90.1099%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2370, Accuracy: 9215/10000 (92.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0030, Accuracy: 921/977 (94.2682%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5841, Accuracy: 7847/10000 (78.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 47, internal_epoch   1,  Average loss: 0.0021, Accuracy: 747/776 (96.2629%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2578, Accuracy: 9090/10000 (90.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 44, internal_epoch   1,  Average loss: 0.0032, Accuracy: 491/517 (94.9710%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6108, Accuracy: 8116/10000 (81.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 89, internal_epoch   1,  Average loss: 0.0018, Accuracy: 477/492 (96.9512%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6675, Accuracy: 7962/10000 (79.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 48, internal_epoch   1,  Average loss: 0.0018, Accuracy: 428/448 (95.5357%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2617, Accuracy: 9187/10000 (91.8700%), Attack Success Rate:0/10000(0.000)
poison local model 70 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   1,  Average loss: 0.0018, Accuracy: 696/724 (96.1326%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   2,  Average loss: 0.0011, Accuracy: 703/724 (97.0994%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   3,  Average loss: 0.0008, Accuracy: 715/724 (98.7569%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   4,  Average loss: 0.0004, Accuracy: 722/724 (99.7238%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   5,  Average loss: 0.0003, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   6,  Average loss: 0.0002, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   7,  Average loss: 0.0002, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   8,  Average loss: 0.0002, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   9,  Average loss: 0.0002, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch  10,  Average loss: 0.0002, Accuracy: 723/724 (99.8619%), train_poison_data_count: 724
Global model norm: 15.221555603974346.
Norm before scaling: 15.278524268822817. Distance: 1.204301184870172
Total norm for 1 adversaries is: 15.278524268822817. distance: 1.204301184870172
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.3699, Accuracy: 7993/8991 (88.9000%)
___Train Local_Simple,  epoch  36, local model 77, internal_epoch   1,  Average loss: 0.0029, Accuracy: 552/589 (93.7182%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2542, Accuracy: 9183/10000 (91.8300%), Attack Success Rate:0/10000(0.000)
time spent on training: 54.93620705604553
[foolsgold agg] training data poison_ratio: 0.11915734035549704  data num: [713, 658, 182, 977, 776, 517, 492, 448, 724, 589]
[foolsgold agg] considering poison per batch poison_fraction: 0.11915734035549704
[foolsgold agg] wv: [1.         1.         0.61141143 0.76104218 1.         0.76104218
 1.         0.61141143 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.1681, Accuracy: 9437/10000 (94.3700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.3147, Accuracy: 7881/8991 (87.6543%)
Done in 92.35535216331482 sec.
Server Epoch:37 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
___Train Local_Simple,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0044, Accuracy: 430/471 (91.2951%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6102, Accuracy: 7817/10000 (78.1700%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0019, Accuracy: 384/400 (96.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0014, Accuracy: 385/400 (96.2500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   3,  Average loss: 0.0007, Accuracy: 395/400 (98.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   4,  Average loss: 0.0003, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   5,  Average loss: 0.0003, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   6,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   7,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   8,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Global model norm: 15.23749317046991.
Norm before scaling: 15.271082579004203. Distance: 0.934994209802008
Total norm for 1 adversaries is: 15.271082579004203. distance: 0.934994209802008
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.6835, Accuracy: 7405/8991 (82.3601%)
___Train Local_Simple,  epoch  37, local model 33, internal_epoch   1,  Average loss: 0.0043, Accuracy: 577/623 (92.6164%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4292, Accuracy: 8541/10000 (85.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0025, Accuracy: 581/606 (95.8746%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4675, Accuracy: 8543/10000 (85.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 412/434 (94.9309%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6193, Accuracy: 8129/10000 (81.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 52, internal_epoch   1,  Average loss: 0.0081, Accuracy: 226/253 (89.3281%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5730, Accuracy: 8392/10000 (83.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.0031, Accuracy: 1172/1246 (94.0610%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2623, Accuracy: 9132/10000 (91.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0042, Accuracy: 386/408 (94.6078%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4263, Accuracy: 8537/10000 (85.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 62, internal_epoch   1,  Average loss: 0.0025, Accuracy: 401/423 (94.7991%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.3311, Accuracy: 8959/10000 (89.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0032, Accuracy: 435/459 (94.7712%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2967, Accuracy: 8844/10000 (88.4400%), Attack Success Rate:0/10000(0.000)
time spent on training: 50.6526939868927
[foolsgold agg] training data poison_ratio: 0.0751455945895172  data num: [471, 400, 623, 606, 434, 253, 1246, 408, 423, 459]
[foolsgold agg] considering poison per batch poison_fraction: 0.0751455945895172
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.01346958
 1.         0.01346958 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.1668, Accuracy: 9438/10000 (94.3800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.3101, Accuracy: 7888/8991 (87.7322%)
Done in 92.60313606262207 sec.
Server Epoch:38 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
___Train Local_Simple,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0021, Accuracy: 246/257 (95.7198%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3555, Accuracy: 8738/10000 (87.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 29, internal_epoch   1,  Average loss: 0.0022, Accuracy: 960/1002 (95.8084%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.2129, Accuracy: 6586/10000 (65.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0019, Accuracy: 451/470 (95.9574%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4516, Accuracy: 8646/10000 (86.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0013, Accuracy: 295/303 (97.3597%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0024, Accuracy: 7455/10000 (74.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0016, Accuracy: 717/739 (97.0230%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6550, Accuracy: 8226/10000 (82.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 83, internal_epoch   1,  Average loss: 0.0024, Accuracy: 411/433 (94.9192%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1697, Accuracy: 9448/10000 (94.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0022, Accuracy: 196/205 (95.6098%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.9909, Accuracy: 7271/10000 (72.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 45, internal_epoch   1,  Average loss: 0.0024, Accuracy: 597/628 (95.0637%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0455, Accuracy: 7309/10000 (73.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 52, internal_epoch   1,  Average loss: 0.0039, Accuracy: 237/253 (93.6759%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.5987, Accuracy: 8478/10000 (84.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0028, Accuracy: 589/620 (95.0000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3186, Accuracy: 9001/10000 (90.0100%), Attack Success Rate:0/10000(0.000)
time spent on training: 43.745304107666016
[foolsgold agg] training data poison_ratio: 0.0  data num: [257, 1002, 470, 303, 739, 433, 205, 628, 253, 620]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.         1.         1.         0.9300954  1.         1.
 0.         1.         0.98449798 0.98449798]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.1521, Accuracy: 9503/10000 (95.0300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.3367, Accuracy: 7847/8991 (87.2762%)
Done in 80.99739193916321 sec.
Server Epoch:39 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
___Train Local_Simple,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 873/923 (94.5829%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4022, Accuracy: 8640/10000 (86.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 34, internal_epoch   1,  Average loss: 0.0021, Accuracy: 396/413 (95.8838%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4373, Accuracy: 8406/10000 (84.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 32, internal_epoch   1,  Average loss: 0.0030, Accuracy: 926/977 (94.7799%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3143, Accuracy: 9065/10000 (90.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0027, Accuracy: 417/434 (96.0829%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3490, Accuracy: 8765/10000 (87.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0023, Accuracy: 567/591 (95.9391%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3612, Accuracy: 8734/10000 (87.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 355/376 (94.4149%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3047, Accuracy: 9003/10000 (90.0300%), Attack Success Rate:0/10000(0.000)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   1,  Average loss: 0.0020, Accuracy: 735/772 (95.2073%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   2,  Average loss: 0.0009, Accuracy: 760/772 (98.4456%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   3,  Average loss: 0.0005, Accuracy: 766/772 (99.2228%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   4,  Average loss: 0.0003, Accuracy: 770/772 (99.7409%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   5,  Average loss: 0.0003, Accuracy: 769/772 (99.6114%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   6,  Average loss: 0.0002, Accuracy: 770/772 (99.7409%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   7,  Average loss: 0.0002, Accuracy: 770/772 (99.7409%), train_poison_data_count: 772
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   8,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   9,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch  10,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Global model norm: 15.250313677454054.
Norm before scaling: 15.314988039256777. Distance: 1.380064826078499
Total norm for 1 adversaries is: 15.314988039256777. distance: 1.380064826078499
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.2962, Accuracy: 8192/8991 (91.1133%)
___Train Local_Simple,  epoch  39, local model 88, internal_epoch   1,  Average loss: 0.0021, Accuracy: 508/530 (95.8491%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.1586, Accuracy: 7039/10000 (70.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0021, Accuracy: 707/731 (96.7168%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3210, Accuracy: 8893/10000 (88.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 703/734 (95.7766%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2963, Accuracy: 9096/10000 (90.9600%), Attack Success Rate:0/10000(0.000)
time spent on training: 56.72578263282776
[foolsgold agg] training data poison_ratio: 0.11911742015121124  data num: [923, 413, 977, 434, 591, 376, 772, 530, 731, 734]
[foolsgold agg] considering poison per batch poison_fraction: 0.11911742015121124
[foolsgold agg] wv: [1.         0.05681626 1.         1.         1.         1.
 1.         1.         1.         0.05681626]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.1494, Accuracy: 9521/10000 (95.2100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.3386, Accuracy: 7847/8991 (87.2762%)
Done in 93.31437468528748 sec.
Server Epoch:40 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
___Train Local_Simple,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 1082/1160 (93.2759%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5851, Accuracy: 7971/10000 (79.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 23, internal_epoch   1,  Average loss: 0.0016, Accuracy: 287/293 (97.9522%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1794, Accuracy: 9429/10000 (94.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 87, internal_epoch   1,  Average loss: 0.0026, Accuracy: 446/470 (94.8936%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2620, Accuracy: 9146/10000 (91.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 98, internal_epoch   1,  Average loss: 0.0026, Accuracy: 774/818 (94.6210%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.7453, Accuracy: 7930/10000 (79.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0025, Accuracy: 548/568 (96.4789%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5331, Accuracy: 8310/10000 (83.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 83, internal_epoch   1,  Average loss: 0.0025, Accuracy: 412/433 (95.1501%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1913, Accuracy: 9344/10000 (93.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 234/253 (92.4901%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2943, Accuracy: 8913/10000 (89.1300%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   1,  Average loss: 0.0021, Accuracy: 655/683 (95.9004%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   2,  Average loss: 0.0010, Accuracy: 670/683 (98.0966%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   3,  Average loss: 0.0006, Accuracy: 675/683 (98.8287%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   4,  Average loss: 0.0004, Accuracy: 681/683 (99.7072%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   5,  Average loss: 0.0004, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   6,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   7,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   8,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch   9,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 90, internal_epoch  10,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Global model norm: 15.260720908958817.
Norm before scaling: 15.271797486278885. Distance: 1.1527719510300132
Total norm for 1 adversaries is: 15.271797486278885. distance: 1.1527719510300132
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.8564, Accuracy: 7046/8991 (78.3673%)
___Train Local_Simple,  epoch  40, local model 71, internal_epoch   1,  Average loss: 0.0020, Accuracy: 1329/1384 (96.0260%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.8824, Accuracy: 7556/10000 (75.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0027, Accuracy: 617/645 (95.6589%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6129, Accuracy: 8302/10000 (83.0200%), Attack Success Rate:0/10000(0.000)
time spent on training: 55.68779706954956
[foolsgold agg] training data poison_ratio: 0.1018339048755032  data num: [1160, 293, 470, 818, 568, 433, 253, 683, 1384, 645]
[foolsgold agg] considering poison per batch poison_fraction: 0.1018339048755032
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.1458, Accuracy: 9541/10000 (95.4100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.3647, Accuracy: 7823/8991 (87.0092%)
Done in 92.46105289459229 sec.
Server Epoch:41 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
___Train Local_Simple,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0014, Accuracy: 552/568 (97.1831%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4639, Accuracy: 8621/10000 (86.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 28, internal_epoch   1,  Average loss: 0.0028, Accuracy: 475/501 (94.8104%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2223, Accuracy: 9238/10000 (92.3800%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   1,  Average loss: 0.0023, Accuracy: 409/429 (95.3380%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   2,  Average loss: 0.0012, Accuracy: 418/429 (97.4359%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   3,  Average loss: 0.0004, Accuracy: 426/429 (99.3007%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   4,  Average loss: 0.0003, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   5,  Average loss: 0.0002, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   6,  Average loss: 0.0002, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   7,  Average loss: 0.0002, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   8,  Average loss: 0.0002, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Global model norm: 15.277732771990213.
Norm before scaling: 15.317890573001405. Distance: 1.353597971515398
Total norm for 1 adversaries is: 15.317890573001405. distance: 1.353597971515398
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.4090, Accuracy: 7894/8991 (87.7989%)
___Train Local_Simple,  epoch  41, local model 95, internal_epoch   1,  Average loss: 0.0011, Accuracy: 586/602 (97.3422%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 4.2829, Accuracy: 5433/10000 (54.3300%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  41, local model 83, internal_epoch   1,  Average loss: 0.0022, Accuracy: 413/433 (95.3811%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2266, Accuracy: 9157/10000 (91.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0035, Accuracy: 435/459 (94.7712%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4089, Accuracy: 8542/10000 (85.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 55, internal_epoch   1,  Average loss: 0.0022, Accuracy: 342/354 (96.6102%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.8934, Accuracy: 7087/10000 (70.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0018, Accuracy: 228/236 (96.6102%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4143, Accuracy: 8659/10000 (86.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 29, internal_epoch   1,  Average loss: 0.0024, Accuracy: 953/1002 (95.1098%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5256, Accuracy: 8250/10000 (82.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 46, internal_epoch   1,  Average loss: 0.0035, Accuracy: 667/710 (93.9437%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4037, Accuracy: 8571/10000 (85.7100%), Attack Success Rate:0/10000(0.000)
time spent on training: 55.21323609352112
[foolsgold agg] training data poison_ratio: 0.08103513411409143  data num: [568, 501, 429, 602, 433, 459, 354, 236, 1002, 710]
[foolsgold agg] considering poison per batch poison_fraction: 0.08103513411409143
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.1486, Accuracy: 9514/10000 (95.1400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.3321, Accuracy: 7853/8991 (87.3429%)
Done in 100.38102316856384 sec.
Server Epoch:42 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0019, Accuracy: 451/470 (95.9574%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4151, Accuracy: 8720/10000 (87.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0023, Accuracy: 566/591 (95.7699%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3924, Accuracy: 8738/10000 (87.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 89, internal_epoch   1,  Average loss: 0.0014, Accuracy: 478/492 (97.1545%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5227, Accuracy: 8510/10000 (85.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0022, Accuracy: 427/448 (95.3125%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2255, Accuracy: 9282/10000 (92.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1189/1227 (96.9030%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6725, Accuracy: 8108/10000 (81.0800%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 857/892 (96.0762%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   2,  Average loss: 0.0015, Accuracy: 866/892 (97.0852%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   3,  Average loss: 0.0006, Accuracy: 884/892 (99.1031%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   4,  Average loss: 0.0005, Accuracy: 884/892 (99.1031%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   5,  Average loss: 0.0004, Accuracy: 885/892 (99.2152%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   6,  Average loss: 0.0003, Accuracy: 887/892 (99.4395%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   7,  Average loss: 0.0003, Accuracy: 887/892 (99.4395%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   8,  Average loss: 0.0003, Accuracy: 887/892 (99.4395%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   9,  Average loss: 0.0002, Accuracy: 888/892 (99.5516%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch  10,  Average loss: 0.0002, Accuracy: 888/892 (99.5516%), train_poison_data_count: 892
Global model norm: 15.288387324610294.
Norm before scaling: 15.377324618631091. Distance: 2.229504271519212
Total norm for 1 adversaries is: 15.377324618631091. distance: 2.229504271519212
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.7136, Accuracy: 6983/8991 (77.6666%)
___Train Local_Simple,  epoch  42, local model 92, internal_epoch   1,  Average loss: 0.0016, Accuracy: 911/937 (97.2252%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6226, Accuracy: 8215/10000 (82.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 62, internal_epoch   1,  Average loss: 0.0022, Accuracy: 407/423 (96.2175%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3910, Accuracy: 8669/10000 (86.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 26, internal_epoch   1,  Average loss: 0.0022, Accuracy: 530/554 (95.6679%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1700, Accuracy: 9506/10000 (95.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0017, Accuracy: 966/1002 (96.4072%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3915, Accuracy: 8725/10000 (87.2500%), Attack Success Rate:0/10000(0.000)
time spent on training: 71.43998789787292
[foolsgold agg] training data poison_ratio: 0.1267765776009096  data num: [470, 591, 492, 448, 1227, 892, 937, 423, 554, 1002]
[foolsgold agg] considering poison per batch poison_fraction: 0.1267765776009096
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.1754, Accuracy: 9369/10000 (93.6900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.2664, Accuracy: 7994/8991 (88.9111%)
Done in 115.14978885650635 sec.
Server Epoch:43 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
___Train Local_Simple,  epoch  43, local model 38, internal_epoch   1,  Average loss: 0.0018, Accuracy: 866/895 (96.7598%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4728, Accuracy: 8387/10000 (83.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 78, internal_epoch   1,  Average loss: 0.0013, Accuracy: 295/303 (97.3597%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4505, Accuracy: 8521/10000 (85.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 26, internal_epoch   1,  Average loss: 0.0020, Accuracy: 532/554 (96.0289%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2340, Accuracy: 9237/10000 (92.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0036, Accuracy: 436/459 (94.9891%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4633, Accuracy: 8245/10000 (82.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0019, Accuracy: 707/731 (96.7168%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4065, Accuracy: 8697/10000 (86.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 75, internal_epoch   1,  Average loss: 0.0024, Accuracy: 651/686 (94.8980%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2148, Accuracy: 9337/10000 (93.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0008, Accuracy: 612/623 (98.2343%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.1347, Accuracy: 7599/10000 (75.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 39, internal_epoch   1,  Average loss: 0.0021, Accuracy: 249/257 (96.8872%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2229, Accuracy: 9266/10000 (92.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 44, internal_epoch   1,  Average loss: 0.0033, Accuracy: 485/517 (93.8104%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3562, Accuracy: 8944/10000 (89.4400%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   1,  Average loss: 0.0018, Accuracy: 661/683 (96.7789%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   2,  Average loss: 0.0009, Accuracy: 668/683 (97.8038%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   3,  Average loss: 0.0005, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   4,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   5,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   6,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   7,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   8,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch   9,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 90, internal_epoch  10,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Global model norm: 15.304349014410342.
Norm before scaling: 15.32275246697089. Distance: 1.0695038685383145
Total norm for 1 adversaries is: 15.32275246697089. distance: 1.0695038685383145
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.6372, Accuracy: 7290/8991 (81.0811%)
time spent on training: 72.18646717071533
[foolsgold agg] training data poison_ratio: 0.11965662228451296  data num: [895, 303, 554, 459, 731, 686, 623, 257, 517, 683]
[foolsgold agg] considering poison per batch poison_fraction: 0.11965662228451296
[foolsgold agg] wv: [1.         0.67761175 1.         1.         1.         1.
 1.         0.67761175 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.1589, Accuracy: 9458/10000 (94.5800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.2930, Accuracy: 7918/8991 (88.0658%)
Done in 112.36928987503052 sec.
Server Epoch:44 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
___Train Local_Simple,  epoch  44, local model 31, internal_epoch   1,  Average loss: 0.0019, Accuracy: 800/835 (95.8084%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4894, Accuracy: 8665/10000 (86.6500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 726/760 (95.5263%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   2,  Average loss: 0.0012, Accuracy: 744/760 (97.8947%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   3,  Average loss: 0.0006, Accuracy: 756/760 (99.4737%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   4,  Average loss: 0.0004, Accuracy: 757/760 (99.6053%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   5,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   6,  Average loss: 0.0003, Accuracy: 757/760 (99.6053%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   7,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   8,  Average loss: 0.0002, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   9,  Average loss: 0.0002, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch  10,  Average loss: 0.0002, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Global model norm: 15.316015719645042.
Norm before scaling: 15.382561041780447. Distance: 1.2599195282836715
Total norm for 1 adversaries is: 15.382561041780447. distance: 1.2599195282836715
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.2475, Accuracy: 8284/8991 (92.1366%)
___Train Local_Simple,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0021, Accuracy: 862/895 (96.3128%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.0430, Accuracy: 7547/10000 (75.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0027, Accuracy: 413/436 (94.7248%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1727, Accuracy: 9434/10000 (94.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0019, Accuracy: 589/615 (95.7724%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6643, Accuracy: 7817/10000 (78.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0019, Accuracy: 199/205 (97.0732%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4717, Accuracy: 8561/10000 (85.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 65, internal_epoch   1,  Average loss: 0.0013, Accuracy: 357/371 (96.2264%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3042, Accuracy: 8850/10000 (88.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 66, internal_epoch   1,  Average loss: 0.0014, Accuracy: 646/660 (97.8788%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4258, Accuracy: 8608/10000 (86.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0020, Accuracy: 575/591 (97.2927%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3298, Accuracy: 8916/10000 (89.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0018, Accuracy: 390/401 (97.2569%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3498, Accuracy: 8804/10000 (88.0400%), Attack Success Rate:0/10000(0.000)
time spent on training: 59.326276779174805
[foolsgold agg] training data poison_ratio: 0.13173860287744843  data num: [835, 760, 895, 436, 615, 205, 371, 660, 591, 401]
[foolsgold agg] considering poison per batch poison_fraction: 0.13173860287744843
[foolsgold agg] wv: [1.         0.91462118 1.         1.         0.91462118 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.1586, Accuracy: 9475/10000 (94.7500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.3045, Accuracy: 7917/8991 (88.0547%)
Done in 100.29042100906372 sec.
Server Epoch:45 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0019, Accuracy: 713/739 (96.4817%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5308, Accuracy: 8459/10000 (84.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 75, internal_epoch   1,  Average loss: 0.0024, Accuracy: 652/686 (95.0437%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2568, Accuracy: 9193/10000 (91.9300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 729/760 (95.9211%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0014, Accuracy: 740/760 (97.3684%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   3,  Average loss: 0.0010, Accuracy: 744/760 (97.8947%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   4,  Average loss: 0.0005, Accuracy: 753/760 (99.0789%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   5,  Average loss: 0.0004, Accuracy: 756/760 (99.4737%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   6,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   7,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   8,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   9,  Average loss: 0.0002, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch  10,  Average loss: 0.0002, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Global model norm: 15.331087251989828.
Norm before scaling: 15.407072033723466. Distance: 1.2554239375455374
Total norm for 2 adversaries is: 15.407072033723466. distance: 1.2554239375455374
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.2355, Accuracy: 8310/8991 (92.4258%)
___Train Local_Simple,  epoch  45, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 829/860 (96.3953%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3943, Accuracy: 8731/10000 (87.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 94, internal_epoch   1,  Average loss: 0.0029, Accuracy: 144/150 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2571, Accuracy: 9155/10000 (91.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0012, Accuracy: 552/568 (97.1831%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5378, Accuracy: 8409/10000 (84.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 29, internal_epoch   1,  Average loss: 0.0019, Accuracy: 969/1002 (96.7066%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3685, Accuracy: 8868/10000 (88.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0020, Accuracy: 247/257 (96.1089%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1758, Accuracy: 9438/10000 (94.3800%), Attack Success Rate:0/10000(0.000)
poison local model 60 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   1,  Average loss: 0.0025, Accuracy: 326/338 (96.4497%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   2,  Average loss: 0.0018, Accuracy: 330/338 (97.6331%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   3,  Average loss: 0.0009, Accuracy: 335/338 (99.1124%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   4,  Average loss: 0.0009, Accuracy: 335/338 (99.1124%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   5,  Average loss: 0.0007, Accuracy: 336/338 (99.4083%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   6,  Average loss: 0.0005, Accuracy: 336/338 (99.4083%), train_poison_data_count: 338
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   7,  Average loss: 0.0004, Accuracy: 336/338 (99.4083%), train_poison_data_count: 338
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   8,  Average loss: 0.0004, Accuracy: 337/338 (99.7041%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   9,  Average loss: 0.0003, Accuracy: 337/338 (99.7041%), train_poison_data_count: 338
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch  10,  Average loss: 0.0003, Accuracy: 337/338 (99.7041%), train_poison_data_count: 338
Global model norm: 15.331087251989828.
Norm before scaling: 15.329902320346571. Distance: 0.8621053497676795
Total norm for 2 adversaries is: 15.329902320346571. distance: 0.8621053497676795
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.3717, Accuracy: 7702/8991 (85.6634%)
___Train Local_Simple,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 415/434 (95.6221%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5009, Accuracy: 8401/10000 (84.0100%), Attack Success Rate:0/10000(0.000)
time spent on training: 73.14604496955872
[foolsgold agg] training data poison_ratio: 0.18950638591646532  data num: [739, 686, 760, 860, 150, 568, 1002, 257, 338, 434]
[foolsgold agg] considering poison per batch poison_fraction: 0.18950638591646532
[foolsgold agg] wv: [1.        1.        1.        1.        1.        0.6590004 1.
 0.6590004 1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.1676, Accuracy: 9400/10000 (94.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.2868, Accuracy: 7956/8991 (88.4885%)
Done in 112.78108501434326 sec.
Server Epoch:46 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
___Train Local_Simple,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0027, Accuracy: 641/686 (93.4402%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2208, Accuracy: 9279/10000 (92.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 78, internal_epoch   1,  Average loss: 0.0015, Accuracy: 293/303 (96.6997%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6056, Accuracy: 8158/10000 (81.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 360/376 (95.7447%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2190, Accuracy: 9318/10000 (93.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 39, internal_epoch   1,  Average loss: 0.0018, Accuracy: 249/257 (96.8872%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1781, Accuracy: 9411/10000 (94.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0022, Accuracy: 398/418 (95.2153%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.7002, Accuracy: 8300/10000 (83.0000%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 858/892 (96.1883%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   2,  Average loss: 0.0006, Accuracy: 883/892 (98.9910%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   3,  Average loss: 0.0003, Accuracy: 888/892 (99.5516%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   5,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   6,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   7,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Global model norm: 15.35487897541395.
Norm before scaling: 15.406514442139708. Distance: 2.0703441689426314
Total norm for 2 adversaries is: 15.406514442139708. distance: 2.0703441689426314
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.7606, Accuracy: 7104/8991 (79.0123%)
poison local model 40 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   1,  Average loss: 0.0019, Accuracy: 736/772 (95.3368%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   2,  Average loss: 0.0011, Accuracy: 750/772 (97.1503%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   3,  Average loss: 0.0005, Accuracy: 768/772 (99.4819%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   4,  Average loss: 0.0003, Accuracy: 770/772 (99.7409%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   5,  Average loss: 0.0003, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   6,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   7,  Average loss: 0.0002, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   8,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch  10,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Global model norm: 15.35487897541395.
Norm before scaling: 15.433610557444657. Distance: 1.4181137641337216
Total norm for 2 adversaries is: 15.433610557444657. distance: 1.4181137641337216
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.2471, Accuracy: 8329/8991 (92.6371%)
___Train Local_Simple,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 523/548 (95.4380%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2915, Accuracy: 9055/10000 (90.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 68, internal_epoch   1,  Average loss: 0.0020, Accuracy: 475/494 (96.1538%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3265, Accuracy: 8949/10000 (89.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 54, internal_epoch   1,  Average loss: 0.0023, Accuracy: 492/519 (94.7977%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.5824, Accuracy: 7994/10000 (79.9400%), Attack Success Rate:0/10000(0.000)
time spent on training: 71.31375002861023
[foolsgold agg] training data poison_ratio: 0.3160493827160494  data num: [686, 303, 376, 257, 418, 892, 772, 548, 494, 519]
[foolsgold agg] considering poison per batch poison_fraction: 0.3160493827160494
[foolsgold agg] wv: [1.         0.68314251 1.         0.68314251 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.1820, Accuracy: 9313/10000 (93.1300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.2292, Accuracy: 8126/8991 (90.3793%)
Done in 111.65072393417358 sec.
Server Epoch:47 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  47, local model 94, internal_epoch   1,  Average loss: 0.0020, Accuracy: 144/150 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2620, Accuracy: 9088/10000 (90.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 48, internal_epoch   1,  Average loss: 0.0018, Accuracy: 428/448 (95.5357%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2096, Accuracy: 9385/10000 (93.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 82, internal_epoch   1,  Average loss: 0.0017, Accuracy: 686/713 (96.2132%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5449, Accuracy: 8337/10000 (83.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 25, internal_epoch   1,  Average loss: 0.0018, Accuracy: 620/647 (95.8269%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5776, Accuracy: 8001/10000 (80.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0020, Accuracy: 537/554 (96.9314%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2056, Accuracy: 9400/10000 (94.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0043, Accuracy: 836/915 (91.3661%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2160, Accuracy: 9404/10000 (94.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0023, Accuracy: 398/418 (95.2153%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3708, Accuracy: 8675/10000 (86.7500%), Attack Success Rate:0/10000(0.000)
poison local model 90 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0016, Accuracy: 659/683 (96.4861%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   2,  Average loss: 0.0008, Accuracy: 671/683 (98.2430%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   3,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   4,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   5,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   6,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   7,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   8,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch   9,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 90, internal_epoch  10,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Global model norm: 15.374241259702004.
Norm before scaling: 15.36058497586538. Distance: 0.9985754475940507
Total norm for 1 adversaries is: 15.36058497586538. distance: 0.9985754475940507
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.4947, Accuracy: 7553/8991 (84.0062%)
___Train Local_Simple,  epoch  47, local model 68, internal_epoch   1,  Average loss: 0.0028, Accuracy: 466/494 (94.3320%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5914, Accuracy: 8155/10000 (81.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0061, Accuracy: 375/408 (91.9118%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5225, Accuracy: 8436/10000 (84.3600%), Attack Success Rate:0/10000(0.000)
time spent on training: 70.61825489997864
[foolsgold agg] training data poison_ratio: 0.12578268876611418  data num: [150, 448, 713, 647, 554, 915, 418, 683, 494, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.12578268876611418
[foolsgold agg] wv: [1.         1.         1.         1.         0.93969173 1.
 0.93969173 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.1463, Accuracy: 9522/10000 (95.2200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.3074, Accuracy: 7937/8991 (88.2772%)
Done in 112.63029909133911 sec.
Server Epoch:48 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
___Train Local_Simple,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0043, Accuracy: 511/557 (91.7415%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4020, Accuracy: 8708/10000 (87.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 27, internal_epoch   1,  Average loss: 0.0023, Accuracy: 451/471 (95.7537%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3066, Accuracy: 8937/10000 (89.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 75, internal_epoch   1,  Average loss: 0.0019, Accuracy: 659/686 (96.0641%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1957, Accuracy: 9353/10000 (93.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0019, Accuracy: 198/205 (96.5854%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4609, Accuracy: 8614/10000 (86.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2465, Accuracy: 9202/10000 (92.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0018, Accuracy: 420/433 (96.9977%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1680, Accuracy: 9459/10000 (94.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0019, Accuracy: 249/256 (97.2656%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2281, Accuracy: 9142/10000 (91.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 96, internal_epoch   1,  Average loss: 0.0018, Accuracy: 654/672 (97.3214%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3310, Accuracy: 8844/10000 (88.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0022, Accuracy: 598/620 (96.4516%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2126, Accuracy: 9330/10000 (93.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 57, internal_epoch   1,  Average loss: 0.0044, Accuracy: 314/343 (91.5452%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.5361, Accuracy: 8379/10000 (83.7900%), Attack Success Rate:0/10000(0.000)
time spent on training: 52.54261302947998
[foolsgold agg] training data poison_ratio: 0.0  data num: [557, 471, 686, 205, 276, 433, 256, 672, 620, 343]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [0.16710917 0.98862352 1.         1.         1.         1.
 0.16710917 0.98862352 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.1511, Accuracy: 9499/10000 (94.9900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.3114, Accuracy: 7925/8991 (88.1437%)
Done in 91.77944684028625 sec.
Server Epoch:49 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
___Train Local_Simple,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0029, Accuracy: 557/589 (94.5671%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3044, Accuracy: 9010/10000 (90.1000%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0018, Accuracy: 858/892 (96.1883%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   2,  Average loss: 0.0007, Accuracy: 879/892 (98.5426%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   3,  Average loss: 0.0003, Accuracy: 889/892 (99.6637%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 889/892 (99.6637%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   5,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   6,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Global model norm: 15.389553718268147.
Norm before scaling: 15.439043840440096. Distance: 2.056147647617678
Total norm for 1 adversaries is: 15.439043840440096. distance: 2.056147647617678
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.7085, Accuracy: 7032/8991 (78.2115%)
___Train Local_Simple,  epoch  49, local model 78, internal_epoch   1,  Average loss: 0.0013, Accuracy: 295/303 (97.3597%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3257, Accuracy: 8920/10000 (89.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0028, Accuracy: 697/731 (95.3488%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3384, Accuracy: 8846/10000 (88.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 91, internal_epoch   1,  Average loss: 0.0026, Accuracy: 245/256 (95.7031%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2124, Accuracy: 9199/10000 (91.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 715/734 (97.4114%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5291, Accuracy: 8521/10000 (85.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0027, Accuracy: 765/818 (93.5208%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3834, Accuracy: 8761/10000 (87.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 21, internal_epoch   1,  Average loss: 0.0018, Accuracy: 301/312 (96.4744%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3246, Accuracy: 8954/10000 (89.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 82, internal_epoch   1,  Average loss: 0.0030, Accuracy: 673/713 (94.3899%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4989, Accuracy: 8309/10000 (83.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0039, Accuracy: 513/557 (92.1005%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3703, Accuracy: 8790/10000 (87.9000%), Attack Success Rate:0/10000(0.000)
time spent on training: 59.28779602050781
[foolsgold agg] training data poison_ratio: 0.1510584250635055  data num: [589, 892, 303, 731, 256, 734, 818, 312, 713, 557]
[foolsgold agg] considering poison per batch poison_fraction: 0.1510584250635055
[foolsgold agg] wv: [1.         1.         1.         1.         0.28372299 1.
 1.         1.         1.         0.28372299]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.1671, Accuracy: 9398/10000 (93.9800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.2661, Accuracy: 7996/8991 (88.9334%)
Done in 98.25156092643738 sec.
Server Epoch:50 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
___Train Local_Simple,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0018, Accuracy: 659/686 (96.0641%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2702, Accuracy: 9134/10000 (91.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 86, internal_epoch   1,  Average loss: 0.0020, Accuracy: 238/250 (95.2000%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3146, Accuracy: 8993/10000 (89.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0015, Accuracy: 552/568 (97.1831%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.5971, Accuracy: 8266/10000 (82.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0024, Accuracy: 414/435 (95.1724%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.4282, Accuracy: 8681/10000 (86.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 31, internal_epoch   1,  Average loss: 0.0020, Accuracy: 803/835 (96.1677%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3939, Accuracy: 8857/10000 (88.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 32, internal_epoch   1,  Average loss: 0.0034, Accuracy: 915/977 (93.6540%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3717, Accuracy: 8789/10000 (87.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 67, internal_epoch   1,  Average loss: 0.0027, Accuracy: 949/998 (95.0902%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.5034, Accuracy: 8377/10000 (83.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0021, Accuracy: 597/620 (96.2903%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1709, Accuracy: 9470/10000 (94.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0015, Accuracy: 979/1002 (97.7046%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3052, Accuracy: 9044/10000 (90.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0018, Accuracy: 405/418 (96.8900%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.4935, Accuracy: 8559/10000 (85.5900%), Attack Success Rate:0/10000(0.000)
time spent on training: 47.87258577346802
[foolsgold agg] training data poison_ratio: 0.0  data num: [686, 250, 568, 435, 835, 977, 998, 620, 1002, 418]
[foolsgold agg] considering poison per batch poison_fraction: 0.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.1337, Accuracy: 9570/10000 (95.7000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.3361, Accuracy: 7907/8991 (87.9435%)
Done in 86.26426410675049 sec.
Saving all the graphs.
This run has a label: Mar.03_10.08.06. Visdom environment: mnist_DBA
