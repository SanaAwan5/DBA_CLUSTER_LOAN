current path: saved_models/mnist_pretrain/model_mnist_Mar.03_11.45.22
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   1,  Average loss: 0.0273, Accuracy: 178/428 (41.5888%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   2,  Average loss: 0.0361, Accuracy: 220/428 (51.4019%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   3,  Average loss: 0.0187, Accuracy: 206/428 (48.1308%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   4,  Average loss: 0.0164, Accuracy: 206/428 (48.1308%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   5,  Average loss: 0.0139, Accuracy: 206/428 (48.1308%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   6,  Average loss: 0.0127, Accuracy: 270/428 (63.0841%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   7,  Average loss: 0.0114, Accuracy: 343/428 (80.1402%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   8,  Average loss: 0.0105, Accuracy: 368/428 (85.9813%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   9,  Average loss: 0.0093, Accuracy: 412/428 (96.2617%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch  10,  Average loss: 0.0089, Accuracy: 411/428 (96.0280%), train_poison_data_count: 428
Global model norm: 13.89800383141575.
Norm before scaling: 14.461230835085408. Distance: 4.432406228628637
Total norm for 7 adversaries is: 14.461230835085408. distance: 4.432406228628637
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 5.7182, Accuracy: 1946/8991 (21.6439%)
___Train Local_Simple,  epoch   1, local model 72, internal_epoch   1,  Average loss: 0.2306, Accuracy: 0/10 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.3031, Accuracy: 1011/10000 (10.1100%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch   1, local model 61, internal_epoch   1,  Average loss: 0.0232, Accuracy: 453/767 (59.0613%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 6.4639, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:15/10000(0.150)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0520, Accuracy: 45/84 (53.5714%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   2,  Average loss: 0.0373, Accuracy: 50/84 (59.5238%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   3,  Average loss: 0.0221, Accuracy: 45/84 (53.5714%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   4,  Average loss: 0.0174, Accuracy: 52/84 (61.9048%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   5,  Average loss: 0.0217, Accuracy: 37/84 (44.0476%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   6,  Average loss: 0.0173, Accuracy: 49/84 (58.3333%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   7,  Average loss: 0.0179, Accuracy: 45/84 (53.5714%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   8,  Average loss: 0.0192, Accuracy: 45/84 (53.5714%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   9,  Average loss: 0.0155, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch  10,  Average loss: 0.0176, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Global model norm: 13.89800383141575.
Norm before scaling: 13.94874782616593. Distance: 0.9601894661579637
Total norm for 7 adversaries is: 13.94874782616593. distance: 0.9601894661579637
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 5.6064, Accuracy: 1807/8991 (20.0979%)
___Train Local_Simple,  epoch   1, local model 71, internal_epoch   1,  Average loss: 0.0355, Accuracy: 128/342 (37.4269%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.4216, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:18/10000(0.180)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   1,  Average loss: 0.0354, Accuracy: 58/63 (92.0635%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   2,  Average loss: 0.0315, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   3,  Average loss: 0.0211, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   4,  Average loss: 0.0187, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   5,  Average loss: 0.0151, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   6,  Average loss: 0.0106, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   7,  Average loss: 0.0064, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   8,  Average loss: 0.0040, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   9,  Average loss: 0.0034, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch  10,  Average loss: 0.0034, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Global model norm: 13.89800383141575.
Norm before scaling: 13.93373885104571. Distance: 0.7226953856722446
Total norm for 7 adversaries is: 13.93373885104571. distance: 0.7226953856722446
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 5.2043, Accuracy: 982/8991 (10.9220%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   1,  Average loss: 0.0284, Accuracy: 225/388 (57.9897%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   2,  Average loss: 0.0247, Accuracy: 272/388 (70.1031%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   3,  Average loss: 0.0162, Accuracy: 272/388 (70.1031%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   4,  Average loss: 0.0128, Accuracy: 272/388 (70.1031%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   5,  Average loss: 0.0150, Accuracy: 272/388 (70.1031%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   6,  Average loss: 0.0113, Accuracy: 272/388 (70.1031%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   7,  Average loss: 0.0100, Accuracy: 272/388 (70.1031%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   8,  Average loss: 0.0085, Accuracy: 313/388 (80.6701%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   9,  Average loss: 0.0075, Accuracy: 358/388 (92.2680%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch  10,  Average loss: 0.0074, Accuracy: 359/388 (92.5258%), train_poison_data_count: 388
Global model norm: 13.89800383141575.
Norm before scaling: 14.269390632861766. Distance: 3.6070530676558867
Total norm for 7 adversaries is: 14.269390632861766. distance: 3.6070530676558867
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 5.8150, Accuracy: 1876/8991 (20.8653%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   1,  Average loss: 0.0307, Accuracy: 244/578 (42.2145%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   2,  Average loss: 0.0254, Accuracy: 175/578 (30.2768%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   3,  Average loss: 0.0127, Accuracy: 392/578 (67.8201%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   4,  Average loss: 0.0083, Accuracy: 503/578 (87.0242%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   5,  Average loss: 0.0066, Accuracy: 515/578 (89.1003%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   6,  Average loss: 0.0055, Accuracy: 538/578 (93.0796%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   7,  Average loss: 0.0042, Accuracy: 541/578 (93.5986%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   8,  Average loss: 0.0054, Accuracy: 542/578 (93.7716%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   9,  Average loss: 0.0032, Accuracy: 547/578 (94.6367%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch  10,  Average loss: 0.0043, Accuracy: 548/578 (94.8097%), train_poison_data_count: 578
Global model norm: 13.89800383141575.
Norm before scaling: 14.471842820426867. Distance: 4.061130938559119
Total norm for 7 adversaries is: 14.471842820426867. distance: 4.061130938559119
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 4.1700, Accuracy: 2819/8991 (31.3536%)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   1,  Average loss: 0.0106, Accuracy: 1619/2072 (78.1371%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   2,  Average loss: 0.0012, Accuracy: 2032/2072 (98.0695%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   3,  Average loss: 0.0005, Accuracy: 2055/2072 (99.1795%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   4,  Average loss: 0.0004, Accuracy: 2059/2072 (99.3726%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   5,  Average loss: 0.0004, Accuracy: 2060/2072 (99.4208%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   6,  Average loss: 0.0004, Accuracy: 2061/2072 (99.4691%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   7,  Average loss: 0.0004, Accuracy: 2059/2072 (99.3726%), train_poison_data_count: 2072
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   8,  Average loss: 0.0003, Accuracy: 2061/2072 (99.4691%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   9,  Average loss: 0.0003, Accuracy: 2061/2072 (99.4691%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch  10,  Average loss: 0.0003, Accuracy: 2061/2072 (99.4691%), train_poison_data_count: 2072
Global model norm: 13.89800383141575.
Norm before scaling: 14.520931526337355. Distance: 4.6411927771745765
Total norm for 7 adversaries is: 14.520931526337355. distance: 4.6411927771745765
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 4.8024, Accuracy: 2950/8991 (32.8106%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   1,  Average loss: 0.0144, Accuracy: 825/978 (84.3558%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   2,  Average loss: 0.0045, Accuracy: 880/978 (89.9796%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   3,  Average loss: 0.0031, Accuracy: 924/978 (94.4785%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   4,  Average loss: 0.0023, Accuracy: 942/978 (96.3190%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   5,  Average loss: 0.0022, Accuracy: 941/978 (96.2168%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   6,  Average loss: 0.0018, Accuracy: 941/978 (96.2168%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   7,  Average loss: 0.0016, Accuracy: 943/978 (96.4213%), train_poison_data_count: 978
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   8,  Average loss: 0.0017, Accuracy: 944/978 (96.5235%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   9,  Average loss: 0.0015, Accuracy: 943/978 (96.4213%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch  10,  Average loss: 0.0016, Accuracy: 943/978 (96.4213%), train_poison_data_count: 978
Global model norm: 13.89800383141575.
Norm before scaling: 14.293864415773763. Distance: 3.7067953342179916
Total norm for 7 adversaries is: 14.293864415773763. distance: 3.7067953342179916
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 4.5588, Accuracy: 1962/8991 (21.8218%)
time spent on training: 123.95125913619995
[foolsgold agg] training data poison_ratio: 0.8040280210157619  data num: [428, 10, 767, 84, 342, 63, 388, 578, 2072, 978]
[foolsgold agg] considering poison per batch poison_fraction: 0.8040280210157619
[foolsgold agg] wv: [0.74590654 1.         0.74590654 1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2917, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:13/10000(0.130)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2515, Accuracy: 982/8991 (10.9220%)
Done in 302.6114559173584 sec.
Server Epoch:2 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0419, Accuracy: 45/84 (53.5714%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   2,  Average loss: 0.0190, Accuracy: 50/84 (59.5238%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   3,  Average loss: 0.0743, Accuracy: 37/84 (44.0476%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   4,  Average loss: 0.0223, Accuracy: 37/84 (44.0476%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   5,  Average loss: 0.0414, Accuracy: 45/84 (53.5714%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   6,  Average loss: 0.0263, Accuracy: 45/84 (53.5714%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   7,  Average loss: 0.0183, Accuracy: 54/84 (64.2857%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   8,  Average loss: 0.0218, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   9,  Average loss: 0.0244, Accuracy: 56/84 (66.6667%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch  10,  Average loss: 0.0240, Accuracy: 49/84 (58.3333%), train_poison_data_count: 84
Global model norm: 13.947014405077155.
Norm before scaling: 13.984822902219582. Distance: 0.9363427649202115
Total norm for 4 adversaries is: 13.984822902219582. distance: 0.9363427649202115
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 2.5621, Accuracy: 1209/8991 (13.4468%)
___Train Local_Simple,  epoch   2, local model 59, internal_epoch   1,  Average loss: 0.0648, Accuracy: 22/27 (81.4815%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 3.1561, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch   2, local model 62, internal_epoch   1,  Average loss: 1.1103, Accuracy: 0/2 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.3945, Accuracy: 1028/10000 (10.2800%), Attack Success Rate:13/10000(0.130)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   1,  Average loss: 0.0260, Accuracy: 130/237 (54.8523%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   2,  Average loss: 0.0205, Accuracy: 180/237 (75.9494%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   3,  Average loss: 0.0169, Accuracy: 182/237 (76.7932%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   4,  Average loss: 0.0128, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   5,  Average loss: 0.0123, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   6,  Average loss: 0.0130, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   7,  Average loss: 0.0114, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   8,  Average loss: 0.0110, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   9,  Average loss: 0.0111, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch  10,  Average loss: 0.0108, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Global model norm: 13.947014405077155.
Norm before scaling: 14.043708690519741. Distance: 1.6936422109616955
Total norm for 4 adversaries is: 14.043708690519741. distance: 1.6936422109616955
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 3.3173, Accuracy: 1036/8991 (11.5226%)
___Train Local_Simple,  epoch   2, local model 65, internal_epoch   1,  Average loss: 0.0087, Accuracy: 1090/1326 (82.2021%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 7.5479, Accuracy: 2678/10000 (26.7800%), Attack Success Rate:1/10000(0.010)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   1,  Average loss: 0.0684, Accuracy: 0/34 (0.0000%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   2,  Average loss: 0.0586, Accuracy: 13/34 (38.2353%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   3,  Average loss: 0.0436, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   4,  Average loss: 0.0414, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   5,  Average loss: 0.0385, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   6,  Average loss: 0.0353, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   7,  Average loss: 0.0327, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   8,  Average loss: 0.0312, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   9,  Average loss: 0.0311, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch  10,  Average loss: 0.0311, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Global model norm: 13.947014405077155.
Norm before scaling: 13.96919348778657. Distance: 0.6237946331132084
Total norm for 4 adversaries is: 13.96919348778657. distance: 0.6237946331132084
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 3.4390, Accuracy: 1010/8991 (11.2335%)
___Train Local_Simple,  epoch   2, local model 78, internal_epoch   1,  Average loss: 0.0100, Accuracy: 1848/2324 (79.5181%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 3.8063, Accuracy: 5073/10000 (50.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 58, internal_epoch   1,  Average loss: 0.0232, Accuracy: 513/1015 (50.5419%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 7.8835, Accuracy: 2196/10000 (21.9600%), Attack Success Rate:10/10000(0.100)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   1,  Average loss: 0.0208, Accuracy: 263/509 (51.6699%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   2,  Average loss: 0.0120, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   3,  Average loss: 0.0092, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   4,  Average loss: 0.0081, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   5,  Average loss: 0.0071, Accuracy: 427/509 (83.8900%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   6,  Average loss: 0.0061, Accuracy: 440/509 (86.4440%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   7,  Average loss: 0.0052, Accuracy: 474/509 (93.1238%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   8,  Average loss: 0.0043, Accuracy: 476/509 (93.5167%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   9,  Average loss: 0.0039, Accuracy: 478/509 (93.9096%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch  10,  Average loss: 0.0039, Accuracy: 481/509 (94.4990%), train_poison_data_count: 509
Global model norm: 13.947014405077155.
Norm before scaling: 14.293271937546843. Distance: 3.2698468383010337
Total norm for 4 adversaries is: 14.293271937546843. distance: 3.2698468383010337
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 6.3769, Accuracy: 1857/8991 (20.6540%)
___Train Local_Simple,  epoch   2, local model 81, internal_epoch   1,  Average loss: 0.0543, Accuracy: 7/68 (10.2941%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 6.5815, Accuracy: 958/10000 (9.5800%), Attack Success Rate:6/10000(0.060)
time spent on training: 74.97385811805725
[foolsgold agg] training data poison_ratio: 0.153572698186989  data num: [84, 27, 2, 237, 1326, 34, 2324, 1015, 509, 68]
[foolsgold agg] considering poison per batch poison_fraction: 0.153572698186989
[foolsgold agg] wv: [0.03088633 1.         1.         0.03088633 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2460, Accuracy: 1891/10000 (18.9100%), Attack Success Rate:16/10000(0.160)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.1700, Accuracy: 1888/8991 (20.9988%)
Done in 255.2253658771515 sec.
Server Epoch:3 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
___Train Local_Simple,  epoch   3, local model 54, internal_epoch   1,  Average loss: 0.0426, Accuracy: 25/91 (27.4725%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 3.3296, Accuracy: 1117/10000 (11.1700%), Attack Success Rate:19/10000(0.190)
___Train Local_Simple,  epoch   3, local model 55, internal_epoch   1,  Average loss: 0.0099, Accuracy: 2204/2803 (78.6300%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 5.2967, Accuracy: 4729/10000 (47.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 61, internal_epoch   1,  Average loss: 0.0134, Accuracy: 591/767 (77.0535%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 7.9566, Accuracy: 2820/10000 (28.2000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   3, local model 73, internal_epoch   1,  Average loss: 0.0093, Accuracy: 996/1205 (82.6556%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 7.4677, Accuracy: 1757/10000 (17.5700%), Attack Success Rate:18/10000(0.180)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   1,  Average loss: 0.0261, Accuracy: 141/264 (53.4091%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   2,  Average loss: 0.0137, Accuracy: 201/264 (76.1364%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   3,  Average loss: 0.0118, Accuracy: 210/264 (79.5455%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   4,  Average loss: 0.0106, Accuracy: 215/264 (81.4394%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   5,  Average loss: 0.0097, Accuracy: 230/264 (87.1212%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   6,  Average loss: 0.0077, Accuracy: 241/264 (91.2879%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   7,  Average loss: 0.0067, Accuracy: 243/264 (92.0455%), train_poison_data_count: 264
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   8,  Average loss: 0.0056, Accuracy: 241/264 (91.2879%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   9,  Average loss: 0.0053, Accuracy: 243/264 (92.0455%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch  10,  Average loss: 0.0079, Accuracy: 244/264 (92.4242%), train_poison_data_count: 264
Global model norm: 13.975255078766954.
Norm before scaling: 14.180818976034306. Distance: 2.2718808852254626
Total norm for 5 adversaries is: 14.180818976034306. distance: 2.2718808852254626
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 4.4453, Accuracy: 1753/8991 (19.4973%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   1,  Average loss: 0.0274, Accuracy: 60/63 (95.2381%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   2,  Average loss: 0.0101, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   3,  Average loss: 0.0039, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   4,  Average loss: 0.0043, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   5,  Average loss: 0.0045, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   6,  Average loss: 0.0047, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   7,  Average loss: 0.0048, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   8,  Average loss: 0.0048, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   9,  Average loss: 0.0048, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch  10,  Average loss: 0.0047, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Global model norm: 13.975255078766954.
Norm before scaling: 14.019556283064862. Distance: 0.7516854342283729
Total norm for 5 adversaries is: 14.019556283064862. distance: 0.7516854342283729
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 8.6367, Accuracy: 982/8991 (10.9220%)
___Train Local_Simple,  epoch   3, local model 87, internal_epoch   1,  Average loss: 0.0707, Accuracy: 0/33 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.2534, Accuracy: 1149/10000 (11.4900%), Attack Success Rate:7/10000(0.070)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   1,  Average loss: 0.0180, Accuracy: 295/509 (57.9568%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   2,  Average loss: 0.0096, Accuracy: 389/509 (76.4244%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   3,  Average loss: 0.0046, Accuracy: 475/509 (93.3202%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   4,  Average loss: 0.0040, Accuracy: 478/509 (93.9096%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   5,  Average loss: 0.0034, Accuracy: 485/509 (95.2849%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   6,  Average loss: 0.0030, Accuracy: 487/509 (95.6778%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   7,  Average loss: 0.0027, Accuracy: 487/509 (95.6778%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   8,  Average loss: 0.0024, Accuracy: 488/509 (95.8743%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   9,  Average loss: 0.0022, Accuracy: 489/509 (96.0707%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch  10,  Average loss: 0.0022, Accuracy: 493/509 (96.8566%), train_poison_data_count: 509
Global model norm: 13.975255078766954.
Norm before scaling: 14.380931924007209. Distance: 3.2965902051811042
Total norm for 5 adversaries is: 14.380931924007209. distance: 3.2965902051811042
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 5.9091, Accuracy: 1920/8991 (21.3547%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   1,  Average loss: 0.0281, Accuracy: 87/151 (57.6159%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   2,  Average loss: 0.0008, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   3,  Average loss: 0.0040, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   4,  Average loss: 0.0042, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   5,  Average loss: 0.0042, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   6,  Average loss: 0.0041, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   7,  Average loss: 0.0038, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   8,  Average loss: 0.0034, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   9,  Average loss: 0.0030, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch  10,  Average loss: 0.0030, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Global model norm: 13.975255078766954.
Norm before scaling: 14.181732484251803. Distance: 2.365207057703779
Total norm for 5 adversaries is: 14.181732484251803. distance: 2.365207057703779
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 30.8166, Accuracy: 980/8991 (10.8998%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   1,  Average loss: 0.0232, Accuracy: 137/237 (57.8059%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   2,  Average loss: 0.0187, Accuracy: 186/237 (78.4810%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   3,  Average loss: 0.0115, Accuracy: 178/237 (75.1055%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   4,  Average loss: 0.0109, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   5,  Average loss: 0.0102, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   6,  Average loss: 0.0095, Accuracy: 179/237 (75.5274%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   7,  Average loss: 0.0091, Accuracy: 194/237 (81.8565%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   8,  Average loss: 0.0083, Accuracy: 198/237 (83.5443%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   9,  Average loss: 0.0077, Accuracy: 200/237 (84.3882%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch  10,  Average loss: 0.0076, Accuracy: 199/237 (83.9662%), train_poison_data_count: 237
Global model norm: 13.975255078766954.
Norm before scaling: 14.097724979916972. Distance: 1.7564912026280313
Total norm for 5 adversaries is: 14.097724979916972. distance: 1.7564912026280313
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 3.6364, Accuracy: 1723/8991 (19.1636%)
time spent on training: 76.12262511253357
[foolsgold agg] training data poison_ratio: 0.19990200881920628  data num: [91, 2803, 767, 1205, 264, 63, 33, 509, 151, 237]
[foolsgold agg] considering poison per batch poison_fraction: 0.19990200881920628
[foolsgold agg] wv: [0.         0.70040024 0.70040024 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.1330, Accuracy: 2171/10000 (21.7100%), Attack Success Rate:6/10000(0.060)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.0565, Accuracy: 2161/8991 (24.0351%)
Done in 255.61194396018982 sec.
Server Epoch:4 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   1,  Average loss: 0.0216, Accuracy: 364/578 (62.9758%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   2,  Average loss: 0.0062, Accuracy: 525/578 (90.8304%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   3,  Average loss: 0.0042, Accuracy: 537/578 (92.9066%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   4,  Average loss: 0.0029, Accuracy: 549/578 (94.9827%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   5,  Average loss: 0.0023, Accuracy: 550/578 (95.1557%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   6,  Average loss: 0.0021, Accuracy: 551/578 (95.3287%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   7,  Average loss: 0.0019, Accuracy: 555/578 (96.0208%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   8,  Average loss: 0.0017, Accuracy: 559/578 (96.7128%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   9,  Average loss: 0.0020, Accuracy: 560/578 (96.8858%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch  10,  Average loss: 0.0016, Accuracy: 561/578 (97.0588%), train_poison_data_count: 578
Global model norm: 14.012121130443411.
Norm before scaling: 14.874427079138785. Distance: 4.586162711077267
Total norm for 4 adversaries is: 14.874427079138785. distance: 4.586162711077267
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 4.1993, Accuracy: 3090/8991 (34.3677%)
___Train Local_Simple,  epoch   4, local model 92, internal_epoch   1,  Average loss: 0.0218, Accuracy: 124/202 (61.3861%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 16.4417, Accuracy: 958/10000 (9.5800%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   4, local model 95, internal_epoch   1,  Average loss: 0.0593, Accuracy: 16/29 (55.1724%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.4701, Accuracy: 1756/10000 (17.5600%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   4, local model 76, internal_epoch   1,  Average loss: 0.0390, Accuracy: 30/87 (34.4828%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 5.8830, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:15/10000(0.150)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.4767, Accuracy: 0/5 (0.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   2,  Average loss: 0.3980, Accuracy: 2/5 (40.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   3,  Average loss: 0.2957, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   4,  Average loss: 0.2802, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   5,  Average loss: 0.2583, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   6,  Average loss: 0.2312, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   7,  Average loss: 0.2008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   8,  Average loss: 0.1702, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   9,  Average loss: 0.1426, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch  10,  Average loss: 0.1401, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.012121130443411.
Norm before scaling: 14.041576773849098. Distance: 0.6832704269909355
Total norm for 4 adversaries is: 14.041576773849098. distance: 0.6832704269909355
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 2.5711, Accuracy: 2208/8991 (24.5579%)
___Train Local_Simple,  epoch   4, local model 99, internal_epoch   1,  Average loss: 0.0107, Accuracy: 356/411 (86.6180%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 11.1549, Accuracy: 980/10000 (9.8000%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch   4, local model 94, internal_epoch   1,  Average loss: 0.0122, Accuracy: 514/607 (84.6787%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 3.4276, Accuracy: 1135/10000 (11.3500%), Attack Success Rate:20/10000(0.200)
___Train Local_Simple,  epoch   4, local model 74, internal_epoch   1,  Average loss: 0.0153, Accuracy: 506/762 (66.4042%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 6.3018, Accuracy: 3444/10000 (34.4400%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   1,  Average loss: 0.0154, Accuracy: 279/388 (71.9072%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 357/388 (92.0103%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   3,  Average loss: 0.0036, Accuracy: 368/388 (94.8454%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   4,  Average loss: 0.0027, Accuracy: 371/388 (95.6186%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   5,  Average loss: 0.0025, Accuracy: 371/388 (95.6186%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   6,  Average loss: 0.0023, Accuracy: 370/388 (95.3608%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   7,  Average loss: 0.0034, Accuracy: 373/388 (96.1340%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   8,  Average loss: 0.0023, Accuracy: 374/388 (96.3918%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   9,  Average loss: 0.0021, Accuracy: 375/388 (96.6495%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch  10,  Average loss: 0.0020, Accuracy: 375/388 (96.6495%), train_poison_data_count: 388
Global model norm: 14.012121130443411.
Norm before scaling: 14.30931995495391. Distance: 2.628929648217289
Total norm for 4 adversaries is: 14.30931995495391. distance: 2.628929648217289
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 4.9008, Accuracy: 1956/8991 (21.7551%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   1,  Average loss: 0.0468, Accuracy: 0/47 (0.0000%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   2,  Average loss: 0.0289, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   3,  Average loss: 0.0054, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   4,  Average loss: 0.0049, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   5,  Average loss: 0.0046, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   6,  Average loss: 0.0046, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   7,  Average loss: 0.0047, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   8,  Average loss: 0.0048, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   9,  Average loss: 0.0049, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch  10,  Average loss: 0.0049, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Global model norm: 14.012121130443411.
Norm before scaling: 14.048205082502143. Distance: 0.7834845058854224
Total norm for 4 adversaries is: 14.048205082502143. distance: 0.7834845058854224
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 5.3671, Accuracy: 1032/8991 (11.4781%)
time spent on training: 63.79974389076233
[foolsgold agg] training data poison_ratio: 0.3267008985879333  data num: [578, 202, 29, 87, 5, 411, 607, 762, 388, 47]
[foolsgold agg] considering poison per batch poison_fraction: 0.3267008985879333
[foolsgold agg] wv: [1.         0.90438747 0.34575353 0.         1.         0.34575353
 1.         0.90438747 1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 1.9968, Accuracy: 4453/10000 (44.5300%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 1.8829, Accuracy: 4708/8991 (52.3635%)
Done in 230.4596700668335 sec.
Server Epoch:5 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
___Train Local_Simple,  epoch   5, local model 60, internal_epoch   1,  Average loss: 0.0580, Accuracy: 216/399 (54.1353%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.4565, Accuracy: 958/10000 (9.5800%), Attack Success Rate:11/10000(0.110)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   1,  Average loss: 0.0117, Accuracy: 187/196 (95.4082%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   2,  Average loss: 0.0164, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   3,  Average loss: 0.0038, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   4,  Average loss: 0.0034, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   5,  Average loss: 0.0027, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   6,  Average loss: 0.0078, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   7,  Average loss: 0.0029, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   8,  Average loss: 0.0028, Accuracy: 185/196 (94.3878%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   9,  Average loss: 0.0029, Accuracy: 185/196 (94.3878%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch  10,  Average loss: 0.0028, Accuracy: 185/196 (94.3878%), train_poison_data_count: 196
Global model norm: 14.042588985650825.
Norm before scaling: 14.14286336306921. Distance: 1.6074993722063087
Total norm for 7 adversaries is: 14.14286336306921. distance: 1.6074993722063087
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 3.1771, Accuracy: 1035/8991 (11.5115%)
___Train Local_Simple,  epoch   5, local model 65, internal_epoch   1,  Average loss: 0.0113, Accuracy: 1061/1326 (80.0151%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 4.7527, Accuracy: 2394/10000 (23.9400%), Attack Success Rate:3/10000(0.030)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0450, Accuracy: 3/48 (6.2500%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   2,  Average loss: 0.0290, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   3,  Average loss: 0.0052, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   4,  Average loss: 0.0041, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   5,  Average loss: 0.0034, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   6,  Average loss: 0.0029, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   7,  Average loss: 0.0027, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   8,  Average loss: 0.0026, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   9,  Average loss: 0.0026, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch  10,  Average loss: 0.0026, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Global model norm: 14.042588985650825.
Norm before scaling: 14.085607642248423. Distance: 0.7938572082808311
Total norm for 7 adversaries is: 14.085607642248423. distance: 0.7938572082808311
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 6.0265, Accuracy: 1135/8991 (12.6237%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   1,  Average loss: 0.0157, Accuracy: 230/304 (75.6579%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   2,  Average loss: 0.0087, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   3,  Average loss: 0.0036, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   4,  Average loss: 0.0030, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   5,  Average loss: 0.0033, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   6,  Average loss: 0.0030, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   7,  Average loss: 0.0030, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   8,  Average loss: 0.0029, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   9,  Average loss: 0.0028, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch  10,  Average loss: 0.0029, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Global model norm: 14.042588985650825.
Norm before scaling: 14.25013491918037. Distance: 2.7452714320993614
Total norm for 7 adversaries is: 14.25013491918037. distance: 2.7452714320993614
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 4.4727, Accuracy: 974/8991 (10.8331%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   1,  Average loss: 0.3407, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   2,  Average loss: 0.1823, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   3,  Average loss: 0.1141, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   4,  Average loss: 0.1081, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   5,  Average loss: 0.0913, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   6,  Average loss: 0.0682, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   7,  Average loss: 0.0461, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   8,  Average loss: 0.0323, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   9,  Average loss: 0.0288, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch  10,  Average loss: 0.0289, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.042588985650825.
Norm before scaling: 14.085309734520672. Distance: 0.6877931923346621
Total norm for 7 adversaries is: 14.085309734520672. distance: 0.6877931923346621
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 3.3323, Accuracy: 1828/8991 (20.3314%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0260, Accuracy: 73/86 (84.8837%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   2,  Average loss: 0.0117, Accuracy: 68/86 (79.0698%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   3,  Average loss: 0.0151, Accuracy: 57/86 (66.2791%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   4,  Average loss: 0.0033, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   5,  Average loss: 0.0032, Accuracy: 83/86 (96.5116%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   6,  Average loss: 0.0068, Accuracy: 79/86 (91.8605%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   7,  Average loss: 0.0045, Accuracy: 79/86 (91.8605%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   8,  Average loss: 0.0047, Accuracy: 80/86 (93.0233%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   9,  Average loss: 0.0044, Accuracy: 82/86 (95.3488%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch  10,  Average loss: 0.0041, Accuracy: 82/86 (95.3488%), train_poison_data_count: 86
Global model norm: 14.042588985650825.
Norm before scaling: 14.145063076856257. Distance: 1.1842059072605196
Total norm for 7 adversaries is: 14.145063076856257. distance: 1.1842059072605196
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 4.8892, Accuracy: 1824/8991 (20.2870%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0098, Accuracy: 399/463 (86.1771%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   2,  Average loss: 0.0082, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   3,  Average loss: 0.0020, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   4,  Average loss: 0.0020, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   5,  Average loss: 0.0020, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   6,  Average loss: 0.0019, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   7,  Average loss: 0.0019, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   8,  Average loss: 0.0019, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   9,  Average loss: 0.0023, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch  10,  Average loss: 0.0019, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Global model norm: 14.042588985650825.
Norm before scaling: 14.266336279160047. Distance: 2.851402299117249
Total norm for 7 adversaries is: 14.266336279160047. distance: 2.851402299117249
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 4.8841, Accuracy: 892/8991 (9.9210%)
___Train Local_Simple,  epoch   5, local model 76, internal_epoch   1,  Average loss: 0.0338, Accuracy: 50/87 (57.4713%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 5.1000, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:9/10000(0.090)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   1,  Average loss: 0.0088, Accuracy: 1137/1259 (90.3098%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   2,  Average loss: 0.0018, Accuracy: 1216/1259 (96.5846%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   3,  Average loss: 0.0011, Accuracy: 1229/1259 (97.6172%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   4,  Average loss: 0.0010, Accuracy: 1230/1259 (97.6966%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   5,  Average loss: 0.0009, Accuracy: 1236/1259 (98.1732%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   6,  Average loss: 0.0009, Accuracy: 1238/1259 (98.3320%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   7,  Average loss: 0.0008, Accuracy: 1241/1259 (98.5703%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   8,  Average loss: 0.0008, Accuracy: 1240/1259 (98.4909%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   9,  Average loss: 0.0008, Accuracy: 1242/1259 (98.6497%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch  10,  Average loss: 0.0008, Accuracy: 1242/1259 (98.6497%), train_poison_data_count: 1259
Global model norm: 14.042588985650825.
Norm before scaling: 14.818283561531711. Distance: 4.718534957331003
Total norm for 7 adversaries is: 14.818283561531711. distance: 4.718534957331003
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 3.6923, Accuracy: 2644/8991 (29.4072%)
time spent on training: 89.80804204940796
[foolsgold agg] training data poison_ratio: 0.5657800143781452  data num: [399, 196, 1326, 48, 304, 5, 86, 463, 87, 1259]
[foolsgold agg] considering poison per batch poison_fraction: 0.5657800143781452
[foolsgold agg] wv: [1. 1. 0. 1. 0. 0. 1. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.0453, Accuracy: 4897/10000 (48.9700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 1.9691, Accuracy: 4822/8991 (53.6314%)
Done in 249.44942688941956 sec.
Server Epoch:6 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   1,  Average loss: 0.0077, Accuracy: 1115/1311 (85.0496%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   2,  Average loss: 0.0010, Accuracy: 1291/1311 (98.4744%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   3,  Average loss: 0.0007, Accuracy: 1288/1311 (98.2456%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1299/1311 (99.0847%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1301/1311 (99.2372%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1301/1311 (99.2372%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1301/1311 (99.2372%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1301/1311 (99.2372%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1301/1311 (99.2372%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1301/1311 (99.2372%), train_poison_data_count: 1311
Global model norm: 14.056502627370767.
Norm before scaling: 14.84080305862202. Distance: 4.725733761604783
Total norm for 6 adversaries is: 14.84080305862202. distance: 4.725733761604783
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 5.8867, Accuracy: 1982/8991 (22.0443%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   1,  Average loss: 0.0115, Accuracy: 1055/1232 (85.6331%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 1152/1232 (93.5065%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   3,  Average loss: 0.0018, Accuracy: 1179/1232 (95.6981%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   4,  Average loss: 0.0016, Accuracy: 1185/1232 (96.1851%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   5,  Average loss: 0.0014, Accuracy: 1198/1232 (97.2403%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   6,  Average loss: 0.0014, Accuracy: 1205/1232 (97.8084%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   7,  Average loss: 0.0012, Accuracy: 1208/1232 (98.0519%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   8,  Average loss: 0.0010, Accuracy: 1210/1232 (98.2143%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   9,  Average loss: 0.0010, Accuracy: 1214/1232 (98.5390%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch  10,  Average loss: 0.0010, Accuracy: 1214/1232 (98.5390%), train_poison_data_count: 1232
Global model norm: 14.056502627370767.
Norm before scaling: 14.685288542788696. Distance: 3.9008602954106832
Total norm for 6 adversaries is: 14.685288542788696. distance: 3.9008602954106832
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 3.3000, Accuracy: 4575/8991 (50.8842%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0123, Accuracy: 399/463 (86.1771%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   2,  Average loss: 0.0101, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   3,  Average loss: 0.0034, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   4,  Average loss: 0.0018, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   5,  Average loss: 0.0019, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   6,  Average loss: 0.0025, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   7,  Average loss: 0.0018, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   8,  Average loss: 0.0022, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   9,  Average loss: 0.0017, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch  10,  Average loss: 0.0017, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Global model norm: 14.056502627370767.
Norm before scaling: 14.279195758814804. Distance: 2.637875361195751
Total norm for 6 adversaries is: 14.279195758814804. distance: 2.637875361195751
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 4.5988, Accuracy: 892/8991 (9.9210%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   1,  Average loss: 0.0318, Accuracy: 318/509 (62.4754%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   2,  Average loss: 0.0204, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   3,  Average loss: 0.0116, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   4,  Average loss: 0.0091, Accuracy: 371/509 (72.8880%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   5,  Average loss: 0.0061, Accuracy: 453/509 (88.9980%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   6,  Average loss: 0.0045, Accuracy: 465/509 (91.3556%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   7,  Average loss: 0.0036, Accuracy: 476/509 (93.5167%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   8,  Average loss: 0.0031, Accuracy: 478/509 (93.9096%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   9,  Average loss: 0.0029, Accuracy: 485/509 (95.2849%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch  10,  Average loss: 0.0027, Accuracy: 485/509 (95.2849%), train_poison_data_count: 509
Global model norm: 14.056502627370767.
Norm before scaling: 16.04404300411741. Distance: 8.091423731364479
Total norm for 6 adversaries is: 16.04404300411741. distance: 8.091423731364479
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 5.9780, Accuracy: 1855/8991 (20.6317%)
___Train Local_Simple,  epoch   6, local model 99, internal_epoch   1,  Average loss: 0.0128, Accuracy: 380/411 (92.4574%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 6.3987, Accuracy: 995/10000 (9.9500%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   6, local model 67, internal_epoch   1,  Average loss: 0.0209, Accuracy: 358/568 (63.0282%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.4360, Accuracy: 3809/10000 (38.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 91, internal_epoch   1,  Average loss: 0.0154, Accuracy: 167/182 (91.7582%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 8.5345, Accuracy: 1944/10000 (19.4400%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   6, local model 76, internal_epoch   1,  Average loss: 0.0422, Accuracy: 29/87 (33.3333%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 3.2415, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:12/10000(0.120)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0207, Accuracy: 147/171 (85.9649%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   2,  Average loss: 0.0118, Accuracy: 147/171 (85.9649%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   3,  Average loss: 0.0062, Accuracy: 151/171 (88.3041%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   4,  Average loss: 0.0061, Accuracy: 153/171 (89.4737%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   5,  Average loss: 0.0055, Accuracy: 153/171 (89.4737%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   6,  Average loss: 0.0052, Accuracy: 153/171 (89.4737%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   7,  Average loss: 0.0050, Accuracy: 151/171 (88.3041%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   8,  Average loss: 0.0051, Accuracy: 153/171 (89.4737%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   9,  Average loss: 0.0045, Accuracy: 155/171 (90.6433%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch  10,  Average loss: 0.0049, Accuracy: 155/171 (90.6433%), train_poison_data_count: 171
Global model norm: 14.056502627370767.
Norm before scaling: 14.158812975079558. Distance: 1.301972448077992
Total norm for 6 adversaries is: 14.158812975079558. distance: 1.301972448077992
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 3.0448, Accuracy: 1529/8991 (17.0059%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   1,  Average loss: 0.0281, Accuracy: 64/128 (50.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   2,  Average loss: 0.0176, Accuracy: 96/128 (75.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   3,  Average loss: 0.0136, Accuracy: 82/128 (64.0625%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   4,  Average loss: 0.0104, Accuracy: 102/128 (79.6875%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   5,  Average loss: 0.0093, Accuracy: 99/128 (77.3438%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   6,  Average loss: 0.0090, Accuracy: 105/128 (82.0312%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   7,  Average loss: 0.0077, Accuracy: 116/128 (90.6250%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   8,  Average loss: 0.0069, Accuracy: 120/128 (93.7500%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   9,  Average loss: 0.0065, Accuracy: 117/128 (91.4062%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch  10,  Average loss: 0.0064, Accuracy: 118/128 (92.1875%), train_poison_data_count: 128
Global model norm: 14.056502627370767.
Norm before scaling: 14.171463158121401. Distance: 1.041191444078538
Total norm for 6 adversaries is: 14.171463158121401. distance: 1.041191444078538
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 3.1685, Accuracy: 3595/8991 (39.9844%)
time spent on training: 101.05443406105042
[foolsgold agg] training data poison_ratio: 0.75345713156855  data num: [1311, 1232, 463, 509, 411, 568, 182, 87, 171, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.75345713156855
[foolsgold agg] wv: [0.         1.         1.         0.79792259 1.         1.
 0.         0.         0.79792259 0.        ]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 2.0061, Accuracy: 5754/10000 (57.5400%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 1.9326, Accuracy: 5643/8991 (62.7628%)
Done in 260.0534739494324 sec.
Server Epoch:7 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
___Train Local_Simple,  epoch   7, local model 66, internal_epoch   1,  Average loss: 0.0117, Accuracy: 564/681 (82.8194%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.9841, Accuracy: 1972/10000 (19.7200%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   7, local model 68, internal_epoch   1,  Average loss: 0.0078, Accuracy: 1372/1591 (86.2351%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 5.7640, Accuracy: 2774/10000 (27.7400%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch   7, local model 59, internal_epoch   1,  Average loss: 0.0759, Accuracy: 18/27 (66.6667%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.0000, Accuracy: 2157/10000 (21.5700%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   7, local model 62, internal_epoch   1,  Average loss: 0.9294, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.0287, Accuracy: 1904/10000 (19.0400%), Attack Success Rate:8/10000(0.080)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   1,  Average loss: 0.0082, Accuracy: 1547/1839 (84.1218%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   2,  Average loss: 0.0015, Accuracy: 1792/1839 (97.4443%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   3,  Average loss: 0.0007, Accuracy: 1817/1839 (98.8037%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   4,  Average loss: 0.0006, Accuracy: 1821/1839 (99.0212%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   5,  Average loss: 0.0006, Accuracy: 1820/1839 (98.9668%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   6,  Average loss: 0.0006, Accuracy: 1823/1839 (99.1300%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   7,  Average loss: 0.0005, Accuracy: 1823/1839 (99.1300%), train_poison_data_count: 1839
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   8,  Average loss: 0.0005, Accuracy: 1823/1839 (99.1300%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1824/1839 (99.1843%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1824/1839 (99.1843%), train_poison_data_count: 1839
Global model norm: 14.085834047907682.
Norm before scaling: 15.089608139501534. Distance: 5.028697628134453
Total norm for 5 adversaries is: 15.089608139501534. distance: 5.028697628134453
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 3.2933, Accuracy: 4421/8991 (49.1714%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0263, Accuracy: 422/688 (61.3372%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   2,  Average loss: 0.0171, Accuracy: 417/688 (60.6105%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   3,  Average loss: 0.0046, Accuracy: 608/688 (88.3721%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   4,  Average loss: 0.0038, Accuracy: 633/688 (92.0058%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   5,  Average loss: 0.0033, Accuracy: 646/688 (93.8953%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   6,  Average loss: 0.0029, Accuracy: 643/688 (93.4593%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   7,  Average loss: 0.0026, Accuracy: 651/688 (94.6221%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   8,  Average loss: 0.0024, Accuracy: 654/688 (95.0581%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   9,  Average loss: 0.0022, Accuracy: 660/688 (95.9302%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch  10,  Average loss: 0.0021, Accuracy: 658/688 (95.6395%), train_poison_data_count: 688
Global model norm: 14.085834047907682.
Norm before scaling: 15.897602001234288. Distance: 7.162056378911509
Total norm for 5 adversaries is: 15.897602001234288. distance: 7.162056378911509
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 5.1325, Accuracy: 2753/8991 (30.6195%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   1,  Average loss: 0.0120, Accuracy: 400/428 (93.4579%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   2,  Average loss: 0.0049, Accuracy: 399/428 (93.2243%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   3,  Average loss: 0.0019, Accuracy: 417/428 (97.4299%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   4,  Average loss: 0.0016, Accuracy: 417/428 (97.4299%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   5,  Average loss: 0.0010, Accuracy: 417/428 (97.4299%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   6,  Average loss: 0.0007, Accuracy: 418/428 (97.6636%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   7,  Average loss: 0.0005, Accuracy: 425/428 (99.2991%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   8,  Average loss: 0.0003, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   9,  Average loss: 0.0003, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch  10,  Average loss: 0.0003, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Global model norm: 14.085834047907682.
Norm before scaling: 14.458586383697535. Distance: 2.602313692164955
Total norm for 5 adversaries is: 14.458586383697535. distance: 2.602313692164955
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 5.8504, Accuracy: 2595/8991 (28.8622%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0328, Accuracy: 83/86 (96.5116%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   2,  Average loss: 0.0086, Accuracy: 77/86 (89.5349%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   3,  Average loss: 0.0092, Accuracy: 74/86 (86.0465%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   4,  Average loss: 0.0069, Accuracy: 79/86 (91.8605%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   5,  Average loss: 0.0019, Accuracy: 83/86 (96.5116%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   6,  Average loss: 0.0042, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   7,  Average loss: 0.0035, Accuracy: 83/86 (96.5116%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   8,  Average loss: 0.0029, Accuracy: 83/86 (96.5116%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   9,  Average loss: 0.0039, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch  10,  Average loss: 0.0021, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Global model norm: 14.085834047907682.
Norm before scaling: 14.205373923815934. Distance: 1.1280100079626798
Total norm for 5 adversaries is: 14.205373923815934. distance: 1.1280100079626798
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 5.4205, Accuracy: 1934/8991 (21.5104%)
___Train Local_Simple,  epoch   7, local model 99, internal_epoch   1,  Average loss: 0.0132, Accuracy: 390/411 (94.8905%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 7.2776, Accuracy: 1483/10000 (14.8300%), Attack Success Rate:28/10000(0.280)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   1,  Average loss: 0.0133, Accuracy: 332/388 (85.5670%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   2,  Average loss: 0.0076, Accuracy: 355/388 (91.4948%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   3,  Average loss: 0.0051, Accuracy: 352/388 (90.7216%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   4,  Average loss: 0.0029, Accuracy: 368/388 (94.8454%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   5,  Average loss: 0.0020, Accuracy: 375/388 (96.6495%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   6,  Average loss: 0.0018, Accuracy: 375/388 (96.6495%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   7,  Average loss: 0.0017, Accuracy: 376/388 (96.9072%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   8,  Average loss: 0.0016, Accuracy: 376/388 (96.9072%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   9,  Average loss: 0.0015, Accuracy: 377/388 (97.1649%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch  10,  Average loss: 0.0015, Accuracy: 377/388 (97.1649%), train_poison_data_count: 388
Global model norm: 14.085834047907682.
Norm before scaling: 14.411048867718597. Distance: 2.5138056081485463
Total norm for 5 adversaries is: 14.411048867718597. distance: 2.5138056081485463
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 4.3561, Accuracy: 2046/8991 (22.7561%)
time spent on training: 93.70774030685425
[foolsgold agg] training data poison_ratio: 0.5583781143136297  data num: [681, 1591, 27, 2, 1839, 688, 428, 86, 411, 388]
[foolsgold agg] considering poison per batch poison_fraction: 0.5583781143136297
[foolsgold agg] wv: [1.         1.         1.         0.37370296 1.         1.
 1.         1.         1.         0.37370296]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 1.9542, Accuracy: 6340/10000 (63.4000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 1.8712, Accuracy: 6349/8991 (70.6151%)
Done in 850.4425799846649 sec.
Server Epoch:8 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
___Train Local_Simple,  epoch   8, local model 63, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2784/3022 (92.1244%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 7.4826, Accuracy: 2247/10000 (22.4700%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch   8, local model 55, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2523/2803 (90.0107%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 4.1496, Accuracy: 4794/10000 (47.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 79, internal_epoch   1,  Average loss: 0.0828, Accuracy: 12/25 (48.0000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.8958, Accuracy: 5282/10000 (52.8200%), Attack Success Rate:1/10000(0.010)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0230, Accuracy: 203/263 (77.1863%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   2,  Average loss: 0.0099, Accuracy: 249/263 (94.6768%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   3,  Average loss: 0.0169, Accuracy: 223/263 (84.7909%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   4,  Average loss: 0.0125, Accuracy: 225/263 (85.5513%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   5,  Average loss: 0.0052, Accuracy: 254/263 (96.5779%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   6,  Average loss: 0.0020, Accuracy: 257/263 (97.7186%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   7,  Average loss: 0.0013, Accuracy: 255/263 (96.9582%), train_poison_data_count: 263
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   8,  Average loss: 0.0011, Accuracy: 256/263 (97.3384%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   9,  Average loss: 0.0013, Accuracy: 257/263 (97.7186%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch  10,  Average loss: 0.0011, Accuracy: 257/263 (97.7186%), train_poison_data_count: 263
Global model norm: 14.136976717734717.
Norm before scaling: 14.45721964802264. Distance: 2.4073087666618247
Total norm for 2 adversaries is: 14.45721964802264. distance: 2.4073087666618247
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 4.6528, Accuracy: 1864/8991 (20.7318%)
___Train Local_Simple,  epoch   8, local model 62, internal_epoch   1,  Average loss: 0.8849, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.8879, Accuracy: 3166/10000 (31.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 56, internal_epoch   1,  Average loss: 0.0104, Accuracy: 615/704 (87.3580%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.6851, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   8, local model 96, internal_epoch   1,  Average loss: 0.0146, Accuracy: 399/505 (79.0099%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 3.1872, Accuracy: 2682/10000 (26.8200%), Attack Success Rate:1/10000(0.010)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0120, Accuracy: 562/648 (86.7284%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   2,  Average loss: 0.0042, Accuracy: 608/648 (93.8272%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   3,  Average loss: 0.0021, Accuracy: 632/648 (97.5309%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   4,  Average loss: 0.0014, Accuracy: 633/648 (97.6852%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   5,  Average loss: 0.0011, Accuracy: 634/648 (97.8395%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   6,  Average loss: 0.0009, Accuracy: 635/648 (97.9938%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   7,  Average loss: 0.0009, Accuracy: 637/648 (98.3025%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   8,  Average loss: 0.0008, Accuracy: 638/648 (98.4568%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   9,  Average loss: 0.0007, Accuracy: 640/648 (98.7654%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch  10,  Average loss: 0.0007, Accuracy: 640/648 (98.7654%), train_poison_data_count: 648
Global model norm: 14.136976717734717.
Norm before scaling: 14.723377059331531. Distance: 3.2337207961855805
Total norm for 2 adversaries is: 14.723377059331531. distance: 3.2337207961855805
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 2.5772, Accuracy: 4766/8991 (53.0086%)
___Train Local_Simple,  epoch   8, local model 92, internal_epoch   1,  Average loss: 0.0148, Accuracy: 192/202 (95.0495%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 20.8623, Accuracy: 958/10000 (9.5800%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   8, local model 86, internal_epoch   1,  Average loss: 0.0622, Accuracy: 16/34 (47.0588%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.9005, Accuracy: 6070/10000 (60.7000%), Attack Success Rate:0/10000(0.000)
time spent on training: 63.16687798500061
[foolsgold agg] training data poison_ratio: 0.11098927875243665  data num: [3022, 2803, 25, 263, 2, 704, 505, 648, 202, 34]
[foolsgold agg] considering poison per batch poison_fraction: 0.11098927875243665
[foolsgold agg] wv: [1.         1.         1.         0.84634944 1.         0.82028212
 1.         1.         0.84634944 0.82028212]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 1.9016, Accuracy: 6537/10000 (65.3700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 1.8228, Accuracy: 6517/8991 (72.4836%)
Done in 230.5150008201599 sec.
Server Epoch:9 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   1,  Average loss: 0.0248, Accuracy: 162/237 (68.3544%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   2,  Average loss: 0.0118, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   3,  Average loss: 0.0051, Accuracy: 210/237 (88.6076%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   4,  Average loss: 0.0030, Accuracy: 227/237 (95.7806%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   5,  Average loss: 0.0024, Accuracy: 230/237 (97.0464%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   6,  Average loss: 0.0023, Accuracy: 228/237 (96.2025%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   7,  Average loss: 0.0023, Accuracy: 227/237 (95.7806%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   8,  Average loss: 0.0019, Accuracy: 228/237 (96.2025%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   9,  Average loss: 0.0018, Accuracy: 232/237 (97.8903%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch  10,  Average loss: 0.0018, Accuracy: 232/237 (97.8903%), train_poison_data_count: 237
Global model norm: 14.176311366327917.
Norm before scaling: 14.403010138502461. Distance: 1.7585447693506546
Total norm for 6 adversaries is: 14.403010138502461. distance: 1.7585447693506546
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 2.3432, Accuracy: 3833/8991 (42.6315%)
___Train Local_Simple,  epoch   9, local model 63, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2825/3022 (93.4811%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 6.9781, Accuracy: 2193/10000 (21.9300%), Attack Success Rate:8/10000(0.080)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   1,  Average loss: 0.0182, Accuracy: 529/644 (82.1429%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   2,  Average loss: 0.0106, Accuracy: 554/644 (86.0248%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   3,  Average loss: 0.0027, Accuracy: 613/644 (95.1863%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   4,  Average loss: 0.0025, Accuracy: 616/644 (95.6522%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   5,  Average loss: 0.0020, Accuracy: 618/644 (95.9627%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 621/644 (96.4286%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   7,  Average loss: 0.0018, Accuracy: 622/644 (96.5839%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   8,  Average loss: 0.0017, Accuracy: 622/644 (96.5839%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   9,  Average loss: 0.0016, Accuracy: 622/644 (96.5839%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch  10,  Average loss: 0.0016, Accuracy: 624/644 (96.8944%), train_poison_data_count: 644
Global model norm: 14.176311366327917.
Norm before scaling: 15.594244633782111. Distance: 5.659577629046976
Total norm for 6 adversaries is: 15.594244633782111. distance: 5.659577629046976
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 2.6480, Accuracy: 2810/8991 (31.2535%)
___Train Local_Simple,  epoch   9, local model 71, internal_epoch   1,  Average loss: 0.0203, Accuracy: 230/342 (67.2515%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.6467, Accuracy: 5537/10000 (55.3700%), Attack Success Rate:1/10000(0.010)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.4062, Accuracy: 2/5 (40.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   2,  Average loss: 0.3617, Accuracy: 3/5 (60.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   3,  Average loss: 0.2661, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   4,  Average loss: 0.2509, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   5,  Average loss: 0.2305, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   6,  Average loss: 0.2057, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   7,  Average loss: 0.1772, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   8,  Average loss: 0.1466, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   9,  Average loss: 0.1157, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch  10,  Average loss: 0.1125, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.176311366327917.
Norm before scaling: 14.219693800235676. Distance: 0.6175906639105015
Total norm for 6 adversaries is: 14.219693800235676. distance: 0.6175906639105015
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 1.5394, Accuracy: 4626/8991 (51.4515%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   1,  Average loss: 0.0595, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   2,  Average loss: 0.0444, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   3,  Average loss: 0.0126, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   4,  Average loss: 0.0097, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   5,  Average loss: 0.0068, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   6,  Average loss: 0.0044, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   7,  Average loss: 0.0027, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   8,  Average loss: 0.0016, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   9,  Average loss: 0.0009, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch  10,  Average loss: 0.0008, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 14.176311366327917.
Norm before scaling: 14.232378856331652. Distance: 0.701987108735782
Total norm for 6 adversaries is: 14.232378856331652. distance: 0.701987108735782
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 2.0511, Accuracy: 1828/8991 (20.3314%)
___Train Local_Simple,  epoch   9, local model 76, internal_epoch   1,  Average loss: 0.0439, Accuracy: 41/87 (47.1264%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.7529, Accuracy: 3276/10000 (32.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 97, internal_epoch   1,  Average loss: 0.3417, Accuracy: 4/5 (80.0000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.8499, Accuracy: 3568/10000 (35.6800%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   1,  Average loss: 0.0088, Accuracy: 417/428 (97.4299%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   2,  Average loss: 0.0027, Accuracy: 420/428 (98.1308%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   3,  Average loss: 0.0014, Accuracy: 418/428 (97.6636%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   4,  Average loss: 0.0008, Accuracy: 425/428 (99.2991%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   5,  Average loss: 0.0005, Accuracy: 425/428 (99.2991%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   6,  Average loss: 0.0003, Accuracy: 424/428 (99.0654%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   7,  Average loss: 0.0002, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 14.176311366327917.
Norm before scaling: 14.600705043543435. Distance: 2.566142215239726
Total norm for 6 adversaries is: 14.600705043543435. distance: 2.566142215239726
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 18.6996, Accuracy: 2894/8991 (32.1877%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   1,  Average loss: 0.0282, Accuracy: 80/128 (62.5000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   2,  Average loss: 0.0188, Accuracy: 104/128 (81.2500%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   3,  Average loss: 0.0085, Accuracy: 109/128 (85.1562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   4,  Average loss: 0.0077, Accuracy: 110/128 (85.9375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   5,  Average loss: 0.0066, Accuracy: 116/128 (90.6250%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   6,  Average loss: 0.0055, Accuracy: 118/128 (92.1875%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   7,  Average loss: 0.0048, Accuracy: 121/128 (94.5312%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   8,  Average loss: 0.0045, Accuracy: 121/128 (94.5312%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   9,  Average loss: 0.0043, Accuracy: 117/128 (91.4062%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch  10,  Average loss: 0.0043, Accuracy: 119/128 (92.9688%), train_poison_data_count: 128
Global model norm: 14.176311366327917.
Norm before scaling: 14.30693485725596. Distance: 1.0996954496312592
Total norm for 6 adversaries is: 14.30693485725596. distance: 1.0996954496312592
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 2.0321, Accuracy: 3932/8991 (43.7326%)
time spent on training: 90.18140482902527
[foolsgold agg] training data poison_ratio: 0.2984165651644336  data num: [237, 3022, 644, 342, 5, 28, 87, 5, 428, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.2984165651644336
[foolsgold agg] wv: [0. 1. 1. 1. 1. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 1.5724, Accuracy: 7124/10000 (71.2400%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 1.4163, Accuracy: 7235/8991 (80.4694%)
Done in 261.49275612831116 sec.
Server Epoch:10 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0077, Accuracy: 590/648 (91.0494%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   2,  Average loss: 0.0023, Accuracy: 626/648 (96.6049%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   3,  Average loss: 0.0008, Accuracy: 636/648 (98.1481%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   4,  Average loss: 0.0007, Accuracy: 638/648 (98.4568%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   5,  Average loss: 0.0007, Accuracy: 639/648 (98.6111%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   6,  Average loss: 0.0005, Accuracy: 640/648 (98.7654%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   7,  Average loss: 0.0005, Accuracy: 641/648 (98.9198%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   8,  Average loss: 0.0004, Accuracy: 642/648 (99.0741%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   9,  Average loss: 0.0004, Accuracy: 642/648 (99.0741%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch  10,  Average loss: 0.0004, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Global model norm: 14.240270137153352.
Norm before scaling: 14.634176912663479. Distance: 2.382923561384598
Total norm for 7 adversaries is: 14.634176912663479. distance: 2.382923561384598
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 2.8616, Accuracy: 4840/8991 (53.8316%)
___Train Local_Simple,  epoch  10, local model 56, internal_epoch   1,  Average loss: 0.0074, Accuracy: 657/704 (93.3239%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.4149, Accuracy: 1032/10000 (10.3200%), Attack Success Rate:15/10000(0.150)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   1,  Average loss: 0.0175, Accuracy: 170/244 (69.6721%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   2,  Average loss: 0.0060, Accuracy: 219/244 (89.7541%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   3,  Average loss: 0.0037, Accuracy: 232/244 (95.0820%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   4,  Average loss: 0.0036, Accuracy: 235/244 (96.3115%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   5,  Average loss: 0.0034, Accuracy: 235/244 (96.3115%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   6,  Average loss: 0.0028, Accuracy: 234/244 (95.9016%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   7,  Average loss: 0.0024, Accuracy: 237/244 (97.1311%), train_poison_data_count: 244
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   8,  Average loss: 0.0021, Accuracy: 238/244 (97.5410%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   9,  Average loss: 0.0019, Accuracy: 239/244 (97.9508%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch  10,  Average loss: 0.0019, Accuracy: 239/244 (97.9508%), train_poison_data_count: 244
Global model norm: 14.240270137153352.
Norm before scaling: 14.44883118228529. Distance: 1.9017836982005107
Total norm for 7 adversaries is: 14.44883118228529. distance: 1.9017836982005107
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 7.2881, Accuracy: 1977/8991 (21.9887%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0334, Accuracy: 59/84 (70.2381%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   2,  Average loss: 0.0082, Accuracy: 77/84 (91.6667%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   3,  Average loss: 0.0052, Accuracy: 79/84 (94.0476%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   4,  Average loss: 0.0094, Accuracy: 79/84 (94.0476%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   5,  Average loss: 0.0044, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   6,  Average loss: 0.0044, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   7,  Average loss: 0.0065, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   8,  Average loss: 0.0061, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   9,  Average loss: 0.0070, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch  10,  Average loss: 0.0053, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Global model norm: 14.240270137153352.
Norm before scaling: 14.360453003775083. Distance: 1.1837079084379196
Total norm for 7 adversaries is: 14.360453003775083. distance: 1.1837079084379196
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 5.2152, Accuracy: 1965/8991 (21.8552%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.2545, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   2,  Average loss: 0.1544, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   3,  Average loss: 0.0369, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   4,  Average loss: 0.0303, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   5,  Average loss: 0.0242, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   6,  Average loss: 0.0188, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   7,  Average loss: 0.0143, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   8,  Average loss: 0.0107, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   9,  Average loss: 0.0080, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch  10,  Average loss: 0.0078, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.240270137153352.
Norm before scaling: 14.303489014000494. Distance: 0.6475149969256833
Total norm for 7 adversaries is: 14.303489014000494. distance: 0.6475149969256833
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 1.5324, Accuracy: 3836/8991 (42.6649%)
___Train Local_Simple,  epoch  10, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2196/2324 (94.4923%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 3.7336, Accuracy: 5263/10000 (52.6300%), Attack Success Rate:1/10000(0.010)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   1,  Average loss: 0.0076, Accuracy: 185/196 (94.3878%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   2,  Average loss: 0.0059, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   3,  Average loss: 0.0030, Accuracy: 186/196 (94.8980%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   4,  Average loss: 0.0023, Accuracy: 187/196 (95.4082%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   5,  Average loss: 0.0022, Accuracy: 188/196 (95.9184%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   6,  Average loss: 0.0011, Accuracy: 192/196 (97.9592%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   7,  Average loss: 0.0009, Accuracy: 193/196 (98.4694%), train_poison_data_count: 196
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   8,  Average loss: 0.0014, Accuracy: 194/196 (98.9796%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   9,  Average loss: 0.0034, Accuracy: 194/196 (98.9796%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch  10,  Average loss: 0.0007, Accuracy: 194/196 (98.9796%), train_poison_data_count: 196
Global model norm: 14.240270137153352.
Norm before scaling: 14.400003729925732. Distance: 1.282149394633836
Total norm for 7 adversaries is: 14.400003729925732. distance: 1.282149394633836
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 2.5966, Accuracy: 4046/8991 (45.0006%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   1,  Average loss: 0.0101, Accuracy: 1012/1203 (84.1230%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   2,  Average loss: 0.0028, Accuracy: 1141/1203 (94.8462%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   3,  Average loss: 0.0014, Accuracy: 1177/1203 (97.8387%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   4,  Average loss: 0.0011, Accuracy: 1180/1203 (98.0881%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   5,  Average loss: 0.0010, Accuracy: 1183/1203 (98.3375%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   6,  Average loss: 0.0009, Accuracy: 1184/1203 (98.4206%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   7,  Average loss: 0.0008, Accuracy: 1186/1203 (98.5869%), train_poison_data_count: 1203
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   8,  Average loss: 0.0008, Accuracy: 1187/1203 (98.6700%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   9,  Average loss: 0.0007, Accuracy: 1189/1203 (98.8362%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch  10,  Average loss: 0.0007, Accuracy: 1189/1203 (98.8362%), train_poison_data_count: 1203
Global model norm: 14.240270137153352.
Norm before scaling: 15.376774383130147. Distance: 4.535644925491492
Total norm for 7 adversaries is: 15.376774383130147. distance: 4.535644925491492
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 3.3037, Accuracy: 5271/8991 (58.6253%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0383, Accuracy: 42/48 (87.5000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   2,  Average loss: 0.0266, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   3,  Average loss: 0.0049, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   4,  Average loss: 0.0036, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   5,  Average loss: 0.0025, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   6,  Average loss: 0.0018, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   7,  Average loss: 0.0013, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   8,  Average loss: 0.0011, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   9,  Average loss: 0.0009, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch  10,  Average loss: 0.0009, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Global model norm: 14.240270137153352.
Norm before scaling: 14.292668225010836. Distance: 0.7338630027771483
Total norm for 7 adversaries is: 14.292668225010836. distance: 0.7338630027771483
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 2.6069, Accuracy: 2173/8991 (24.1686%)
___Train Local_Simple,  epoch  10, local model 99, internal_epoch   1,  Average loss: 0.0057, Accuracy: 399/411 (97.0803%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 6.0295, Accuracy: 1999/10000 (19.9900%), Attack Success Rate:10/10000(0.100)
time spent on training: 111.7807719707489
[foolsgold agg] training data poison_ratio: 0.41384012272029996  data num: [648, 704, 244, 84, 5, 2324, 196, 1203, 48, 411]
[foolsgold agg] considering poison per batch poison_fraction: 0.41384012272029996
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.67473828 1.         0.67473828 1.        ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 1.4126, Accuracy: 7418/10000 (74.1800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 1.2254, Accuracy: 7442/8991 (82.7717%)
Done in 294.682984828949 sec.
Server Epoch:11 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
___Train Local_Simple,  epoch  11, local model 53, internal_epoch   1,  Average loss: 0.0085, Accuracy: 423/456 (92.7632%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 4.7259, Accuracy: 2488/10000 (24.8800%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  11, local model 56, internal_epoch   1,  Average loss: 0.0072, Accuracy: 668/704 (94.8864%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.1786, Accuracy: 1150/10000 (11.5000%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 248/259 (95.7529%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 11.6412, Accuracy: 1422/10000 (14.2200%), Attack Success Rate:19/10000(0.190)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0259, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   2,  Average loss: 0.0108, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   3,  Average loss: 0.0008, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   4,  Average loss: 0.0007, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   5,  Average loss: 0.0007, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   6,  Average loss: 0.0007, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   7,  Average loss: 0.0007, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   8,  Average loss: 0.0007, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   9,  Average loss: 0.0007, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch  10,  Average loss: 0.0007, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Global model norm: 14.300425937951497.
Norm before scaling: 14.359252796337998. Distance: 0.6732161023005947
Total norm for 5 adversaries is: 14.359252796337998. distance: 0.6732161023005947
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 3.1781, Accuracy: 2204/8991 (24.5134%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   1,  Average loss: 0.0132, Accuracy: 248/304 (81.5789%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   2,  Average loss: 0.0080, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   3,  Average loss: 0.0014, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   4,  Average loss: 0.0013, Accuracy: 300/304 (98.6842%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   5,  Average loss: 0.0012, Accuracy: 300/304 (98.6842%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   6,  Average loss: 0.0012, Accuracy: 300/304 (98.6842%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   7,  Average loss: 0.0010, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   8,  Average loss: 0.0010, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   9,  Average loss: 0.0010, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch  10,  Average loss: 0.0009, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Global model norm: 14.300425937951497.
Norm before scaling: 14.48628691366155. Distance: 2.042470371587073
Total norm for 5 adversaries is: 14.48628691366155. distance: 2.042470371587073
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 4.7920, Accuracy: 1858/8991 (20.6651%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 1822/1982 (91.9273%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   2,  Average loss: 0.0014, Accuracy: 1931/1982 (97.4268%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   3,  Average loss: 0.0007, Accuracy: 1958/1982 (98.7891%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   4,  Average loss: 0.0006, Accuracy: 1960/1982 (98.8900%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   5,  Average loss: 0.0006, Accuracy: 1960/1982 (98.8900%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1961/1982 (98.9405%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   7,  Average loss: 0.0005, Accuracy: 1963/1982 (99.0414%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1964/1982 (99.0918%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1966/1982 (99.1927%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1966/1982 (99.1927%), train_poison_data_count: 1982
Global model norm: 14.300425937951497.
Norm before scaling: 15.06988319113759. Distance: 4.254136036393017
Total norm for 5 adversaries is: 15.06988319113759. distance: 4.254136036393017
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 4.9213, Accuracy: 2844/8991 (31.6316%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0085, Accuracy: 290/310 (93.5484%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   2,  Average loss: 0.0045, Accuracy: 290/310 (93.5484%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   3,  Average loss: 0.0022, Accuracy: 298/310 (96.1290%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   4,  Average loss: 0.0012, Accuracy: 301/310 (97.0968%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   5,  Average loss: 0.0010, Accuracy: 300/310 (96.7742%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   6,  Average loss: 0.0010, Accuracy: 302/310 (97.4194%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   7,  Average loss: 0.0008, Accuracy: 303/310 (97.7419%), train_poison_data_count: 310
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   8,  Average loss: 0.0007, Accuracy: 305/310 (98.3871%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   9,  Average loss: 0.0006, Accuracy: 306/310 (98.7097%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch  10,  Average loss: 0.0005, Accuracy: 306/310 (98.7097%), train_poison_data_count: 310
Global model norm: 14.300425937951497.
Norm before scaling: 14.519678902766863. Distance: 1.5400793908450274
Total norm for 5 adversaries is: 14.519678902766863. distance: 1.5400793908450274
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 2.8705, Accuracy: 3261/8991 (36.2696%)
___Train Local_Simple,  epoch  11, local model 99, internal_epoch   1,  Average loss: 0.0039, Accuracy: 399/411 (97.0803%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 5.6207, Accuracy: 2637/10000 (26.3700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  11, local model 88, internal_epoch   1,  Average loss: 0.0308, Accuracy: 53/96 (55.2083%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 3.2951, Accuracy: 1028/10000 (10.2800%), Attack Success Rate:15/10000(0.150)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0090, Accuracy: 507/578 (87.7163%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   2,  Average loss: 0.0080, Accuracy: 511/578 (88.4083%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   3,  Average loss: 0.0043, Accuracy: 540/578 (93.4256%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   4,  Average loss: 0.0026, Accuracy: 548/578 (94.8097%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   5,  Average loss: 0.0023, Accuracy: 551/578 (95.3287%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   6,  Average loss: 0.0018, Accuracy: 555/578 (96.0208%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   7,  Average loss: 0.0015, Accuracy: 562/578 (97.2318%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   8,  Average loss: 0.0013, Accuracy: 565/578 (97.7509%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   9,  Average loss: 0.0012, Accuracy: 566/578 (97.9239%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch  10,  Average loss: 0.0012, Accuracy: 566/578 (97.9239%), train_poison_data_count: 578
Global model norm: 14.300425937951497.
Norm before scaling: 15.020310955866975. Distance: 3.5879540186033343
Total norm for 5 adversaries is: 15.020310955866975. distance: 3.5879540186033343
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 2.3724, Accuracy: 3668/8991 (40.7964%)
time spent on training: 103.82138299942017
[foolsgold agg] training data poison_ratio: 0.6258741258741258  data num: [456, 704, 259, 48, 304, 1982, 310, 411, 96, 578]
[foolsgold agg] considering poison per batch poison_fraction: 0.6258741258741258
[foolsgold agg] wv: [1.         0.82951003 0.82951003 1.         0.         0.43085427
 0.43085427 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 1.2487, Accuracy: 7462/10000 (74.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 1.0014, Accuracy: 7485/8991 (83.2499%)
Done in 289.9914901256561 sec.
Server Epoch:12 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0150, Accuracy: 57/63 (90.4762%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   2,  Average loss: 0.0055, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   3,  Average loss: 0.0016, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   4,  Average loss: 0.0016, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   5,  Average loss: 0.0016, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   6,  Average loss: 0.0016, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   7,  Average loss: 0.0016, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   8,  Average loss: 0.0016, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   9,  Average loss: 0.0016, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch  10,  Average loss: 0.0016, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Global model norm: 14.347797163581092.
Norm before scaling: 14.395483135080351. Distance: 0.5904421770627932
Total norm for 8 adversaries is: 14.395483135080351. distance: 0.5904421770627932
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 2.2696, Accuracy: 1982/8991 (22.0443%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   1,  Average loss: 0.0144, Accuracy: 89/94 (94.6809%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   2,  Average loss: 0.0039, Accuracy: 86/94 (91.4894%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   3,  Average loss: 0.0082, Accuracy: 84/94 (89.3617%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   4,  Average loss: 0.0047, Accuracy: 85/94 (90.4255%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   5,  Average loss: 0.0028, Accuracy: 89/94 (94.6809%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   6,  Average loss: 0.0017, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   7,  Average loss: 0.0013, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   8,  Average loss: 0.0014, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   9,  Average loss: 0.0015, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch  10,  Average loss: 0.0017, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Global model norm: 14.347797163581092.
Norm before scaling: 14.453135557428576. Distance: 0.9243429414917199
Total norm for 8 adversaries is: 14.453135557428576. distance: 0.9243429414917199
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 2.4589, Accuracy: 3134/8991 (34.8571%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0147, Accuracy: 98/119 (82.3529%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   2,  Average loss: 0.0054, Accuracy: 107/119 (89.9160%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   3,  Average loss: 0.0040, Accuracy: 109/119 (91.5966%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   4,  Average loss: 0.0039, Accuracy: 109/119 (91.5966%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   5,  Average loss: 0.0034, Accuracy: 110/119 (92.4370%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   6,  Average loss: 0.0028, Accuracy: 112/119 (94.1176%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   7,  Average loss: 0.0025, Accuracy: 114/119 (95.7983%), train_poison_data_count: 119
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   8,  Average loss: 0.0022, Accuracy: 114/119 (95.7983%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   9,  Average loss: 0.0019, Accuracy: 114/119 (95.7983%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch  10,  Average loss: 0.0018, Accuracy: 114/119 (95.7983%), train_poison_data_count: 119
Global model norm: 14.347797163581092.
Norm before scaling: 14.45490012325378. Distance: 0.9959141887310198
Total norm for 8 adversaries is: 14.45490012325378. distance: 0.9959141887310198
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 3.9125, Accuracy: 2820/8991 (31.3647%)
___Train Local_Simple,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0217, Accuracy: 144/216 (66.6667%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.1834, Accuracy: 2344/10000 (23.4400%), Attack Success Rate:7/10000(0.070)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0039, Accuracy: 1847/1982 (93.1887%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1952/1982 (98.4864%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1966/1982 (99.1927%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1965/1982 (99.1423%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1967/1982 (99.2432%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1967/1982 (99.2432%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1969/1982 (99.3441%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1967/1982 (99.2432%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1970/1982 (99.3946%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1970/1982 (99.3946%), train_poison_data_count: 1982
Global model norm: 14.347797163581092.
Norm before scaling: 14.832465900103543. Distance: 3.475173638485846
Total norm for 8 adversaries is: 14.832465900103543. distance: 3.475173638485846
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 5.5617, Accuracy: 2847/8991 (31.6650%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   1,  Average loss: 0.0064, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   2,  Average loss: 0.0029, Accuracy: 172/179 (96.0894%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   3,  Average loss: 0.0015, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   4,  Average loss: 0.0012, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   5,  Average loss: 0.0012, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   6,  Average loss: 0.0011, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   7,  Average loss: 0.0008, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   8,  Average loss: 0.0005, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   9,  Average loss: 0.0004, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch  10,  Average loss: 0.0004, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Global model norm: 14.347797163581092.
Norm before scaling: 14.498141465616593. Distance: 1.2317191900136129
Total norm for 8 adversaries is: 14.498141465616593. distance: 1.2317191900136129
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 5.9016, Accuracy: 2455/8991 (27.3051%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0070, Accuracy: 523/578 (90.4844%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   2,  Average loss: 0.0046, Accuracy: 526/578 (91.0035%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   3,  Average loss: 0.0021, Accuracy: 555/578 (96.0208%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   4,  Average loss: 0.0015, Accuracy: 563/578 (97.4048%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   5,  Average loss: 0.0030, Accuracy: 562/578 (97.2318%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   6,  Average loss: 0.0016, Accuracy: 567/578 (98.0969%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   7,  Average loss: 0.0010, Accuracy: 568/578 (98.2699%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   8,  Average loss: 0.0008, Accuracy: 570/578 (98.6159%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   9,  Average loss: 0.0010, Accuracy: 572/578 (98.9619%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch  10,  Average loss: 0.0007, Accuracy: 573/578 (99.1349%), train_poison_data_count: 578
Global model norm: 14.347797163581092.
Norm before scaling: 14.8029831843864. Distance: 2.5447608270284587
Total norm for 8 adversaries is: 14.8029831843864. distance: 2.5447608270284587
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 2.4528, Accuracy: 4295/8991 (47.7700%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   1,  Average loss: 0.0285, Accuracy: 34/47 (72.3404%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   2,  Average loss: 0.0096, Accuracy: 46/47 (97.8723%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   3,  Average loss: 0.0026, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   4,  Average loss: 0.0027, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   5,  Average loss: 0.0028, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   6,  Average loss: 0.0029, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   7,  Average loss: 0.0030, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   8,  Average loss: 0.0031, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   9,  Average loss: 0.0031, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch  10,  Average loss: 0.0031, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Global model norm: 14.347797163581092.
Norm before scaling: 14.396511269858545. Distance: 0.6982277395180807
Total norm for 8 adversaries is: 14.396511269858545. distance: 0.6982277395180807
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 3.0066, Accuracy: 1626/8991 (18.0848%)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0034, Accuracy: 1463/1544 (94.7539%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.3408, Accuracy: 4933/10000 (49.3300%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0073, Accuracy: 435/463 (93.9525%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   3,  Average loss: 0.0018, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   4,  Average loss: 0.0014, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   5,  Average loss: 0.0014, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   6,  Average loss: 0.0012, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   7,  Average loss: 0.0017, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   8,  Average loss: 0.0010, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   9,  Average loss: 0.0010, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch  10,  Average loss: 0.0010, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Global model norm: 14.347797163581092.
Norm before scaling: 14.51067196342327. Distance: 2.125168625368062
Total norm for 8 adversaries is: 14.51067196342327. distance: 2.125168625368062
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 3.1209, Accuracy: 930/8991 (10.3437%)
time spent on training: 127.12296104431152
[foolsgold agg] training data poison_ratio: 0.6669820245979187  data num: [63, 94, 119, 216, 1982, 179, 578, 47, 1544, 463]
[foolsgold agg] considering poison per batch poison_fraction: 0.6669820245979187
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.0629, Accuracy: 7729/10000 (77.2900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 0.7417, Accuracy: 7745/8991 (86.1417%)
Done in 313.3855879306793 sec.
Server Epoch:13 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.1239, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   2,  Average loss: 0.0808, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   3,  Average loss: 0.0389, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   4,  Average loss: 0.0350, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   5,  Average loss: 0.0306, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   6,  Average loss: 0.0261, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   7,  Average loss: 0.0216, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   8,  Average loss: 0.0174, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   9,  Average loss: 0.0136, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch  10,  Average loss: 0.0133, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.41667278194114.
Norm before scaling: 14.447292953409667. Distance: 0.44361681752896287
Total norm for 6 adversaries is: 14.447292953409667. distance: 0.44361681752896287
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.7248, Accuracy: 7266/8991 (80.8141%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   1,  Average loss: 0.0057, Accuracy: 177/179 (98.8827%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   2,  Average loss: 0.0009, Accuracy: 175/179 (97.7654%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   3,  Average loss: 0.0020, Accuracy: 175/179 (97.7654%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   4,  Average loss: 0.0018, Accuracy: 177/179 (98.8827%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   5,  Average loss: 0.0013, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   6,  Average loss: 0.0010, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   7,  Average loss: 0.0008, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   8,  Average loss: 0.0006, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   9,  Average loss: 0.0004, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch  10,  Average loss: 0.0004, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Global model norm: 14.41667278194114.
Norm before scaling: 14.562572822879881. Distance: 1.2004169355712364
Total norm for 6 adversaries is: 14.562572822879881. distance: 1.2004169355712364
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 6.1203, Accuracy: 2665/8991 (29.6408%)
___Train Local_Simple,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0035, Accuracy: 685/705 (97.1631%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 4.2737, Accuracy: 1880/10000 (18.8000%), Attack Success Rate:12/10000(0.120)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 619/688 (89.9709%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   2,  Average loss: 0.0024, Accuracy: 668/688 (97.0930%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   3,  Average loss: 0.0014, Accuracy: 673/688 (97.8198%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   4,  Average loss: 0.0008, Accuracy: 680/688 (98.8372%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   5,  Average loss: 0.0007, Accuracy: 678/688 (98.5465%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   6,  Average loss: 0.0006, Accuracy: 683/688 (99.2733%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   7,  Average loss: 0.0005, Accuracy: 682/688 (99.1279%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   8,  Average loss: 0.0004, Accuracy: 684/688 (99.4186%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   9,  Average loss: 0.0004, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch  10,  Average loss: 0.0004, Accuracy: 685/688 (99.5640%), train_poison_data_count: 688
Global model norm: 14.41667278194114.
Norm before scaling: 14.760569260947443. Distance: 2.6028307323662245
Total norm for 6 adversaries is: 14.760569260947443. distance: 2.6028307323662245
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 6.1781, Accuracy: 2871/8991 (31.9319%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0155, Accuracy: 75/84 (89.2857%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   2,  Average loss: 0.0074, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   3,  Average loss: 0.0038, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   4,  Average loss: 0.0041, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   5,  Average loss: 0.0024, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   6,  Average loss: 0.0035, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   7,  Average loss: 0.0040, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   8,  Average loss: 0.0026, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   9,  Average loss: 0.0011, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch  10,  Average loss: 0.0020, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Global model norm: 14.41667278194114.
Norm before scaling: 14.497598383412294. Distance: 0.813574300804221
Total norm for 6 adversaries is: 14.497598383412294. distance: 0.813574300804221
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 2.5850, Accuracy: 3004/8991 (33.4112%)
___Train Local_Simple,  epoch  13, local model 76, internal_epoch   1,  Average loss: 0.0146, Accuracy: 75/87 (86.2069%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.8751, Accuracy: 4684/10000 (46.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 97, internal_epoch   1,  Average loss: 0.0953, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.6857, Accuracy: 5727/10000 (57.2700%), Attack Success Rate:0/10000(0.000)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0100, Accuracy: 81/86 (94.1860%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   2,  Average loss: 0.0016, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   3,  Average loss: 0.0030, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   4,  Average loss: 0.0032, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   5,  Average loss: 0.0009, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   6,  Average loss: 0.0011, Accuracy: 85/86 (98.8372%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   7,  Average loss: 0.0008, Accuracy: 85/86 (98.8372%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   8,  Average loss: 0.0004, Accuracy: 85/86 (98.8372%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   9,  Average loss: 0.0004, Accuracy: 85/86 (98.8372%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch  10,  Average loss: 0.0010, Accuracy: 85/86 (98.8372%), train_poison_data_count: 86
Global model norm: 14.41667278194114.
Norm before scaling: 14.503725822840854. Distance: 0.8264628229451212
Total norm for 6 adversaries is: 14.503725822840854. distance: 0.8264628229451212
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 3.0707, Accuracy: 2512/8991 (27.9391%)
___Train Local_Simple,  epoch  13, local model 70, internal_epoch   1,  Average loss: 0.0065, Accuracy: 499/569 (87.6977%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 3.9213, Accuracy: 5611/10000 (56.1100%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0188, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   3,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   4,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   5,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   6,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   7,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   8,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   9,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch  10,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 14.41667278194114.
Norm before scaling: 14.46914494348259. Distance: 0.6280298227348154
Total norm for 6 adversaries is: 14.46914494348259. distance: 0.6280298227348154
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 2.3538, Accuracy: 3772/8991 (41.9531%)
time spent on training: 74.86806201934814
[foolsgold agg] training data poison_ratio: 0.44381107491856675  data num: [5, 179, 705, 688, 84, 87, 5, 86, 569, 48]
[foolsgold agg] considering poison per batch poison_fraction: 0.44381107491856675
[foolsgold agg] wv: [1.         1.         0.21207054 0.91325966 0.96241793 0.21207054
 0.91325966 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.0813, Accuracy: 7734/10000 (77.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 0.6455, Accuracy: 7731/8991 (85.9860%)
Done in 236.75622415542603 sec.
Server Epoch:14 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0181, Accuracy: 25/29 (86.2069%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1656, Accuracy: 6883/10000 (68.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 97, internal_epoch   1,  Average loss: 0.0398, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.4993, Accuracy: 6510/10000 (65.1000%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0023, Accuracy: 626/648 (96.6049%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   2,  Average loss: 0.0014, Accuracy: 629/648 (97.0679%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   3,  Average loss: 0.0011, Accuracy: 635/648 (97.9938%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   4,  Average loss: 0.0004, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   5,  Average loss: 0.0004, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   6,  Average loss: 0.0003, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   7,  Average loss: 0.0003, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   8,  Average loss: 0.0003, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   9,  Average loss: 0.0002, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch  10,  Average loss: 0.0002, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Global model norm: 14.457185873767822.
Norm before scaling: 14.609400589048445. Distance: 1.3513184696462806
Total norm for 4 adversaries is: 14.609400589048445. distance: 1.3513184696462806
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 2.2031, Accuracy: 4960/8991 (55.1663%)
___Train Local_Simple,  epoch  14, local model 89, internal_epoch   1,  Average loss: 0.0429, Accuracy: 39/69 (56.5217%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2558, Accuracy: 7439/10000 (74.3900%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0089, Accuracy: 113/128 (88.2812%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   2,  Average loss: 0.0043, Accuracy: 122/128 (95.3125%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   3,  Average loss: 0.0028, Accuracy: 122/128 (95.3125%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   4,  Average loss: 0.0026, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   5,  Average loss: 0.0023, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   6,  Average loss: 0.0022, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   7,  Average loss: 0.0020, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   8,  Average loss: 0.0019, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   9,  Average loss: 0.0017, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch  10,  Average loss: 0.0017, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Global model norm: 14.457185873767822.
Norm before scaling: 14.545043961191999. Distance: 0.7733483311278558
Total norm for 4 adversaries is: 14.545043961191999. distance: 0.7733483311278558
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.4440, Accuracy: 5341/8991 (59.4038%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 1112/1203 (92.4356%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   2,  Average loss: 0.0022, Accuracy: 1149/1203 (95.5112%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   3,  Average loss: 0.0009, Accuracy: 1182/1203 (98.2544%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   4,  Average loss: 0.0007, Accuracy: 1188/1203 (98.7531%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   5,  Average loss: 0.0006, Accuracy: 1191/1203 (99.0025%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1192/1203 (99.0856%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   7,  Average loss: 0.0005, Accuracy: 1193/1203 (99.1687%), train_poison_data_count: 1203
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1193/1203 (99.1687%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1196/1203 (99.4181%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1196/1203 (99.4181%), train_poison_data_count: 1203
Global model norm: 14.457185873767822.
Norm before scaling: 14.904753859828425. Distance: 2.5880757967360384
Total norm for 4 adversaries is: 14.904753859828425. distance: 2.5880757967360384
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 2.7695, Accuracy: 6017/8991 (66.9225%)
___Train Local_Simple,  epoch  14, local model 55, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2574/2803 (91.8302%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 3.8244, Accuracy: 4826/10000 (48.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 67, internal_epoch   1,  Average loss: 0.0133, Accuracy: 476/568 (83.8028%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.3650, Accuracy: 5077/10000 (50.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0047, Accuracy: 666/704 (94.6023%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.4160, Accuracy: 1400/10000 (14.0000%), Attack Success Rate:21/10000(0.210)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0115, Accuracy: 97/119 (81.5126%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   2,  Average loss: 0.0036, Accuracy: 112/119 (94.1176%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   3,  Average loss: 0.0046, Accuracy: 105/119 (88.2353%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   4,  Average loss: 0.0036, Accuracy: 110/119 (92.4370%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   5,  Average loss: 0.0031, Accuracy: 110/119 (92.4370%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   6,  Average loss: 0.0029, Accuracy: 110/119 (92.4370%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   7,  Average loss: 0.0022, Accuracy: 114/119 (95.7983%), train_poison_data_count: 119
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   8,  Average loss: 0.0017, Accuracy: 115/119 (96.6387%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   9,  Average loss: 0.0015, Accuracy: 115/119 (96.6387%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch  10,  Average loss: 0.0014, Accuracy: 115/119 (96.6387%), train_poison_data_count: 119
Global model norm: 14.457185873767822.
Norm before scaling: 14.541355483142189. Distance: 0.9464109674908964
Total norm for 4 adversaries is: 14.541355483142189. distance: 0.9464109674908964
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 3.5951, Accuracy: 2855/8991 (31.7540%)
time spent on training: 80.1319329738617
[foolsgold agg] training data poison_ratio: 0.334289356277884  data num: [29, 5, 648, 69, 128, 1203, 2803, 568, 704, 119]
[foolsgold agg] considering poison per batch poison_fraction: 0.334289356277884
[foolsgold agg] wv: [1. 1. 1. 0. 1. 1. 1. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.1746, Accuracy: 7538/10000 (75.3800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.6015, Accuracy: 7523/8991 (83.6726%)
Done in 243.79730105400085 sec.
Server Epoch:15 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 431/463 (93.0886%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   2,  Average loss: 0.0024, Accuracy: 454/463 (98.0562%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   3,  Average loss: 0.0018, Accuracy: 457/463 (98.7041%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   4,  Average loss: 0.0011, Accuracy: 455/463 (98.2721%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   5,  Average loss: 0.0014, Accuracy: 454/463 (98.0562%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   6,  Average loss: 0.0008, Accuracy: 454/463 (98.0562%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   7,  Average loss: 0.0012, Accuracy: 454/463 (98.0562%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   8,  Average loss: 0.0008, Accuracy: 454/463 (98.0562%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   9,  Average loss: 0.0007, Accuracy: 456/463 (98.4881%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch  10,  Average loss: 0.0008, Accuracy: 457/463 (98.7041%), train_poison_data_count: 463
Global model norm: 14.507865088084548.
Norm before scaling: 14.640226344459029. Distance: 2.218940404324626
Total norm for 7 adversaries is: 14.640226344459029. distance: 2.218940404324626
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 2.7535, Accuracy: 1470/8991 (16.3497%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0113, Accuracy: 70/84 (83.3333%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   2,  Average loss: 0.0055, Accuracy: 79/84 (94.0476%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   3,  Average loss: 0.0018, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   4,  Average loss: 0.0016, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   5,  Average loss: 0.0016, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   6,  Average loss: 0.0012, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   7,  Average loss: 0.0007, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   8,  Average loss: 0.0006, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   9,  Average loss: 0.0006, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch  10,  Average loss: 0.0009, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 14.507865088084548.
Norm before scaling: 14.585410240871912. Distance: 0.7182975257023688
Total norm for 7 adversaries is: 14.585410240871912. distance: 0.7182975257023688
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.2146, Accuracy: 5336/8991 (59.3482%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 2147/2180 (98.4862%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 2173/2180 (99.6789%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2176/2180 (99.8165%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Global model norm: 14.507865088084548.
Norm before scaling: 14.50273211817696. Distance: 1.842731711881045
Total norm for 7 adversaries is: 14.50273211817696. distance: 1.842731711881045
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 2.3691, Accuracy: 4534/8991 (50.4282%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   1,  Average loss: 0.0080, Accuracy: 115/128 (89.8438%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   2,  Average loss: 0.0022, Accuracy: 122/128 (95.3125%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   3,  Average loss: 0.0030, Accuracy: 119/128 (92.9688%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   4,  Average loss: 0.0027, Accuracy: 120/128 (93.7500%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   5,  Average loss: 0.0021, Accuracy: 120/128 (93.7500%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   6,  Average loss: 0.0014, Accuracy: 121/128 (94.5312%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   7,  Average loss: 0.0011, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   8,  Average loss: 0.0008, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   9,  Average loss: 0.0007, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch  10,  Average loss: 0.0007, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Global model norm: 14.507865088084548.
Norm before scaling: 14.590529288613041. Distance: 0.7869448051970969
Total norm for 7 adversaries is: 14.590529288613041. distance: 0.7869448051970969
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.4025, Accuracy: 4948/8991 (55.0328%)
___Train Local_Simple,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2650/2803 (94.5416%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 5.0207, Accuracy: 4759/10000 (47.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 98, internal_epoch   1,  Average loss: 0.0466, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.2284, Accuracy: 7097/10000 (70.9700%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   1,  Average loss: 0.0051, Accuracy: 615/678 (90.7080%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   2,  Average loss: 0.0019, Accuracy: 657/678 (96.9027%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   3,  Average loss: 0.0009, Accuracy: 665/678 (98.0826%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   4,  Average loss: 0.0008, Accuracy: 665/678 (98.0826%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   5,  Average loss: 0.0007, Accuracy: 666/678 (98.2301%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   6,  Average loss: 0.0006, Accuracy: 668/678 (98.5251%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   7,  Average loss: 0.0006, Accuracy: 669/678 (98.6726%), train_poison_data_count: 678
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   8,  Average loss: 0.0005, Accuracy: 670/678 (98.8201%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   9,  Average loss: 0.0005, Accuracy: 671/678 (98.9676%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch  10,  Average loss: 0.0005, Accuracy: 671/678 (98.9676%), train_poison_data_count: 678
Global model norm: 14.507865088084548.
Norm before scaling: 14.72636770428196. Distance: 2.3134102962821124
Total norm for 7 adversaries is: 14.72636770428196. distance: 2.3134102962821124
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 3.7537, Accuracy: 2382/8991 (26.4932%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0027, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   2,  Average loss: 0.0017, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   3,  Average loss: 0.0012, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   4,  Average loss: 0.0011, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   5,  Average loss: 0.0011, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   6,  Average loss: 0.0011, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   7,  Average loss: 0.0010, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   8,  Average loss: 0.0010, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   9,  Average loss: 0.0010, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch  10,  Average loss: 0.0010, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Global model norm: 14.507865088084548.
Norm before scaling: 14.520391398217262. Distance: 0.20392753628816884
Total norm for 7 adversaries is: 14.520391398217262. distance: 0.20392753628816884
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.9080, Accuracy: 6078/8991 (67.6009%)
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0026, Accuracy: 289/300 (96.3333%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 7.1166, Accuracy: 2199/10000 (21.9900%), Attack Success Rate:6/10000(0.060)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   1,  Average loss: 0.0216, Accuracy: 30/47 (63.8298%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   2,  Average loss: 0.0030, Accuracy: 46/47 (97.8723%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   3,  Average loss: 0.0027, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   4,  Average loss: 0.0029, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   5,  Average loss: 0.0030, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   6,  Average loss: 0.0031, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   7,  Average loss: 0.0032, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   8,  Average loss: 0.0031, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   9,  Average loss: 0.0030, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch  10,  Average loss: 0.0030, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Global model norm: 14.507865088084548.
Norm before scaling: 14.539845932848689. Distance: 0.6837640604669127
Total norm for 7 adversaries is: 14.539845932848689. distance: 0.6837640604669127
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 2.6500, Accuracy: 2378/8991 (26.4487%)
time spent on training: 122.82286810874939
[foolsgold agg] training data poison_ratio: 0.5395438388625592  data num: [463, 84, 2180, 128, 2803, 6, 678, 63, 300, 47]
[foolsgold agg] considering poison per batch poison_fraction: 0.5395438388625592
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         1.         0.51801955 0.51801955]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 1.1673, Accuracy: 7862/10000 (78.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.4800, Accuracy: 7848/8991 (87.2873%)
Done in 309.60919284820557 sec.
Server Epoch:16 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0055, Accuracy: 120/128 (93.7500%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   2,  Average loss: 0.0027, Accuracy: 122/128 (95.3125%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   3,  Average loss: 0.0023, Accuracy: 122/128 (95.3125%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   4,  Average loss: 0.0020, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   5,  Average loss: 0.0018, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   6,  Average loss: 0.0016, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   7,  Average loss: 0.0014, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   8,  Average loss: 0.0013, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   9,  Average loss: 0.0012, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch  10,  Average loss: 0.0012, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Global model norm: 14.5574958291065.
Norm before scaling: 14.612750800650577. Distance: 0.5447627830020939
Total norm for 4 adversaries is: 14.612750800650577. distance: 0.5447627830020939
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.8597, Accuracy: 6693/8991 (74.4411%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 159/171 (92.9825%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   2,  Average loss: 0.0036, Accuracy: 158/171 (92.3977%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   3,  Average loss: 0.0020, Accuracy: 165/171 (96.4912%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   4,  Average loss: 0.0015, Accuracy: 166/171 (97.0760%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   5,  Average loss: 0.0010, Accuracy: 168/171 (98.2456%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   6,  Average loss: 0.0010, Accuracy: 168/171 (98.2456%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   7,  Average loss: 0.0011, Accuracy: 167/171 (97.6608%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   8,  Average loss: 0.0010, Accuracy: 169/171 (98.8304%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   9,  Average loss: 0.0008, Accuracy: 169/171 (98.8304%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch  10,  Average loss: 0.0008, Accuracy: 169/171 (98.8304%), train_poison_data_count: 171
Global model norm: 14.5574958291065.
Norm before scaling: 14.611521713102332. Distance: 0.8462803656850696
Total norm for 4 adversaries is: 14.611521713102332. distance: 0.8462803656850696
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.7573, Accuracy: 4038/8991 (44.9116%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 630/648 (97.2222%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   2,  Average loss: 0.0009, Accuracy: 639/648 (98.6111%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   3,  Average loss: 0.0012, Accuracy: 631/648 (97.3765%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   4,  Average loss: 0.0004, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   5,  Average loss: 0.0002, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   6,  Average loss: 0.0003, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   7,  Average loss: 0.0002, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   8,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   9,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch  10,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 14.5574958291065.
Norm before scaling: 14.643782072728161. Distance: 1.1221337893918268
Total norm for 4 adversaries is: 14.643782072728161. distance: 1.1221337893918268
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 2.3295, Accuracy: 5070/8991 (56.3897%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0005, Accuracy: 409/411 (99.5134%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 4.3044, Accuracy: 3681/10000 (36.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0055, Accuracy: 430/456 (94.2982%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.0088, Accuracy: 5057/10000 (50.5700%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1275/1311 (97.2540%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1294/1311 (98.7033%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1302/1311 (99.3135%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1303/1311 (99.3898%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1304/1311 (99.4661%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1307/1311 (99.6949%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1308/1311 (99.7712%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1308/1311 (99.7712%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1308/1311 (99.7712%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1308/1311 (99.7712%), train_poison_data_count: 1311
Global model norm: 14.5574958291065.
Norm before scaling: 14.614026248217627. Distance: 1.9940761215732312
Total norm for 4 adversaries is: 14.614026248217627. distance: 1.9940761215732312
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 4.1319, Accuracy: 2121/8991 (23.5903%)
___Train Local_Simple,  epoch  16, local model 60, internal_epoch   1,  Average loss: 0.0037, Accuracy: 379/399 (94.9875%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 22.4207, Accuracy: 1913/10000 (19.1300%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch  16, local model 63, internal_epoch   1,  Average loss: 0.0087, Accuracy: 2813/3022 (93.0841%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 5.3808, Accuracy: 982/10000 (9.8200%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  16, local model 52, internal_epoch   1,  Average loss: 0.0033, Accuracy: 689/705 (97.7305%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 5.2986, Accuracy: 1871/10000 (18.7100%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch  16, local model 90, internal_epoch   1,  Average loss: 0.0030, Accuracy: 722/768 (94.0104%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 3.4791, Accuracy: 2869/10000 (28.6900%), Attack Success Rate:1/10000(0.010)
time spent on training: 81.79674577713013
[foolsgold agg] training data poison_ratio: 0.2815812445442075  data num: [128, 171, 648, 411, 456, 1311, 399, 3022, 705, 768]
[foolsgold agg] considering poison per batch poison_fraction: 0.2815812445442075
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.51908075
 1.         1.         0.51908075 1.        ]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.8447, Accuracy: 8268/10000 (82.6800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.4243, Accuracy: 8249/8991 (91.7473%)
Done in 241.452565908432 sec.
Server Epoch:17 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0022, Accuracy: 667/681 (97.9442%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 5.9182, Accuracy: 3186/10000 (31.8600%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   1,  Average loss: 0.0027, Accuracy: 617/644 (95.8075%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   2,  Average loss: 0.0017, Accuracy: 618/644 (95.9627%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   3,  Average loss: 0.0010, Accuracy: 634/644 (98.4472%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   4,  Average loss: 0.0012, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   5,  Average loss: 0.0006, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   7,  Average loss: 0.0005, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   8,  Average loss: 0.0004, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   9,  Average loss: 0.0004, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch  10,  Average loss: 0.0004, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Global model norm: 14.568532062800417.
Norm before scaling: 14.706352698489956. Distance: 1.3177721764499255
Total norm for 4 adversaries is: 14.706352698489956. distance: 1.3177721764499255
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.6922, Accuracy: 5050/8991 (56.1673%)
___Train Local_Simple,  epoch  17, local model 56, internal_epoch   1,  Average loss: 0.0037, Accuracy: 680/704 (96.5909%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.8398, Accuracy: 4351/10000 (43.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 97, internal_epoch   1,  Average loss: 0.0196, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.0369, Accuracy: 7867/10000 (78.6700%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 640/688 (93.0233%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0016, Accuracy: 663/688 (96.3663%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   3,  Average loss: 0.0007, Accuracy: 678/688 (98.5465%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   4,  Average loss: 0.0005, Accuracy: 683/688 (99.2733%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   5,  Average loss: 0.0004, Accuracy: 683/688 (99.2733%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   6,  Average loss: 0.0004, Accuracy: 684/688 (99.4186%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   7,  Average loss: 0.0003, Accuracy: 685/688 (99.5640%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   8,  Average loss: 0.0003, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   9,  Average loss: 0.0003, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch  10,  Average loss: 0.0002, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Global model norm: 14.568532062800417.
Norm before scaling: 14.772872002166093. Distance: 1.902296312433918
Total norm for 4 adversaries is: 14.772872002166093. distance: 1.902296312433918
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 3.5891, Accuracy: 3047/8991 (33.8894%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0628, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   2,  Average loss: 0.0160, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   3,  Average loss: 0.0033, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   4,  Average loss: 0.0028, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   5,  Average loss: 0.0024, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   6,  Average loss: 0.0021, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   7,  Average loss: 0.0018, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   8,  Average loss: 0.0016, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   9,  Average loss: 0.0013, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch  10,  Average loss: 0.0013, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.568532062800417.
Norm before scaling: 14.59616924875432. Distance: 0.38763429175923303
Total norm for 4 adversaries is: 14.59616924875432. distance: 0.38763429175923303
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.5737, Accuracy: 7462/8991 (82.9941%)
___Train Local_Simple,  epoch  17, local model 77, internal_epoch   1,  Average loss: 0.0022, Accuracy: 1480/1544 (95.8549%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.5762, Accuracy: 5251/10000 (52.5100%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0031, Accuracy: 548/578 (94.8097%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   2,  Average loss: 0.0020, Accuracy: 557/578 (96.3668%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   3,  Average loss: 0.0012, Accuracy: 562/578 (97.2318%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   4,  Average loss: 0.0006, Accuracy: 570/578 (98.6159%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   5,  Average loss: 0.0004, Accuracy: 573/578 (99.1349%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   6,  Average loss: 0.0005, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   7,  Average loss: 0.0003, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   8,  Average loss: 0.0003, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   9,  Average loss: 0.0003, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch  10,  Average loss: 0.0003, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Global model norm: 14.568532062800417.
Norm before scaling: 14.846516497954106. Distance: 1.8015280145419792
Total norm for 4 adversaries is: 14.846516497954106. distance: 1.8015280145419792
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 2.1737, Accuracy: 4937/8991 (54.9105%)
___Train Local_Simple,  epoch  17, local model 90, internal_epoch   1,  Average loss: 0.0021, Accuracy: 742/768 (96.6146%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 3.5514, Accuracy: 2925/10000 (29.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0075, Accuracy: 27/27 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9925, Accuracy: 7994/10000 (79.9400%), Attack Success Rate:0/10000(0.000)
time spent on training: 77.32157492637634
[foolsgold agg] training data poison_ratio: 0.3392983699503898  data num: [681, 644, 704, 5, 688, 5, 1544, 578, 768, 27]
[foolsgold agg] considering poison per batch poison_fraction: 0.3392983699503898
[foolsgold agg] wv: [1. 1. 1. 0. 1. 1. 1. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.7934, Accuracy: 8353/10000 (83.5300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.3636, Accuracy: 8349/8991 (92.8595%)
Done in 237.88377904891968 sec.
Server Epoch:18 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0034, Accuracy: 2618/2803 (93.3999%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 3.8671, Accuracy: 4746/10000 (47.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0055, Accuracy: 902/1015 (88.8670%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.5484, Accuracy: 3768/10000 (37.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 88, internal_epoch   1,  Average loss: 0.0134, Accuracy: 80/96 (83.3333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.8640, Accuracy: 2988/10000 (29.8800%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0014, Accuracy: 422/428 (98.5981%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 425/428 (99.2991%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   3,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   4,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   5,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 14.604441743111227.
Norm before scaling: 14.70052769550696. Distance: 1.2565217118093224
Total norm for 2 adversaries is: 14.70052769550696. distance: 1.2565217118093224
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 6.9085, Accuracy: 2922/8991 (32.4992%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1222/1259 (97.0612%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1247/1259 (99.0469%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1253/1259 (99.5234%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1255/1259 (99.6823%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Global model norm: 14.604441743111227.
Norm before scaling: 14.741953061033362. Distance: 1.9252349511967546
Total norm for 2 adversaries is: 14.741953061033362. distance: 1.9252349511967546
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 1.7853, Accuracy: 5383/8991 (59.8710%)
___Train Local_Simple,  epoch  18, local model 75, internal_epoch   1,  Average loss: 0.0011, Accuracy: 488/497 (98.1891%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 12.4083, Accuracy: 2133/10000 (21.3300%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  18, local model 82, internal_epoch   1,  Average loss: 0.0031, Accuracy: 109/114 (95.6140%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9325, Accuracy: 7559/10000 (75.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0028, Accuracy: 735/767 (95.8279%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 3.9169, Accuracy: 3353/10000 (33.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 95, internal_epoch   1,  Average loss: 0.0097, Accuracy: 27/29 (93.1034%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8575, Accuracy: 7960/10000 (79.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0100, Accuracy: 28/30 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9120, Accuracy: 7718/10000 (77.1800%), Attack Success Rate:0/10000(0.000)
time spent on training: 67.9887478351593
[foolsgold agg] training data poison_ratio: 0.23969877806194942  data num: [2803, 1015, 96, 428, 1259, 497, 114, 767, 29, 30]
[foolsgold agg] considering poison per batch poison_fraction: 0.23969877806194942
[foolsgold agg] wv: [1.         0.23856736 0.23856736 0.         1.         1.
 1.         0.         0.         0.        ]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.7818, Accuracy: 8390/10000 (83.9000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.3300, Accuracy: 8384/8991 (93.2488%)
Done in 229.65203213691711 sec.
Server Epoch:19 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0023, Accuracy: 555/578 (96.0208%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   2,  Average loss: 0.0016, Accuracy: 553/578 (95.6747%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   3,  Average loss: 0.0018, Accuracy: 550/578 (95.1557%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   4,  Average loss: 0.0005, Accuracy: 572/578 (98.9619%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   5,  Average loss: 0.0005, Accuracy: 570/578 (98.6159%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   6,  Average loss: 0.0003, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   7,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   8,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   9,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch  10,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Global model norm: 14.622480648221668.
Norm before scaling: 14.783335629319303. Distance: 1.2925161162945096
Total norm for 9 adversaries is: 14.783335629319303. distance: 1.2925161162945096
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.5840, Accuracy: 5319/8991 (59.1592%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.0282, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   2,  Average loss: 0.0152, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   3,  Average loss: 0.0057, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   4,  Average loss: 0.0051, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   5,  Average loss: 0.0046, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   6,  Average loss: 0.0041, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   7,  Average loss: 0.0036, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   8,  Average loss: 0.0032, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   9,  Average loss: 0.0029, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch  10,  Average loss: 0.0028, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Global model norm: 14.622480648221668.
Norm before scaling: 14.644733906806634. Distance: 0.24544928952541864
Total norm for 9 adversaries is: 14.644733906806634. distance: 0.24544928952541864
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.3551, Accuracy: 8199/8991 (91.1912%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   1,  Average loss: 0.0020, Accuracy: 149/151 (98.6755%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 14.622480648221668.
Norm before scaling: 14.6558273026732. Distance: 0.7005073777694515
Total norm for 9 adversaries is: 14.6558273026732. distance: 0.7005073777694515
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 2.7005, Accuracy: 4187/8991 (46.5688%)
___Train Local_Simple,  epoch  19, local model 84, internal_epoch   1,  Average loss: 0.1147, Accuracy: 9/29 (31.0345%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8733, Accuracy: 8373/10000 (83.7300%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   2,  Average loss: 0.0024, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   3,  Average loss: 0.0017, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   4,  Average loss: 0.0016, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   5,  Average loss: 0.0014, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   6,  Average loss: 0.0012, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   7,  Average loss: 0.0011, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   8,  Average loss: 0.0011, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   9,  Average loss: 0.0010, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch  10,  Average loss: 0.0010, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Global model norm: 14.622480648221668.
Norm before scaling: 14.677254467578557. Distance: 0.5093329628758723
Total norm for 9 adversaries is: 14.677254467578557. distance: 0.5093329628758723
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.6523, Accuracy: 7199/8991 (80.0690%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0034, Accuracy: 222/237 (93.6709%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   2,  Average loss: 0.0018, Accuracy: 229/237 (96.6245%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   3,  Average loss: 0.0009, Accuracy: 233/237 (98.3122%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   4,  Average loss: 0.0007, Accuracy: 234/237 (98.7342%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   5,  Average loss: 0.0004, Accuracy: 234/237 (98.7342%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   6,  Average loss: 0.0003, Accuracy: 235/237 (99.1561%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   7,  Average loss: 0.0003, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   8,  Average loss: 0.0003, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   9,  Average loss: 0.0003, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch  10,  Average loss: 0.0003, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Global model norm: 14.622480648221668.
Norm before scaling: 14.71788796656263. Distance: 0.9378876520417173
Total norm for 9 adversaries is: 14.71788796656263. distance: 0.9378876520417173
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 2.0594, Accuracy: 4963/8991 (55.1996%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 161/171 (94.1520%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   2,  Average loss: 0.0024, Accuracy: 162/171 (94.7368%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   3,  Average loss: 0.0011, Accuracy: 168/171 (98.2456%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   4,  Average loss: 0.0011, Accuracy: 168/171 (98.2456%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   5,  Average loss: 0.0010, Accuracy: 169/171 (98.8304%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   6,  Average loss: 0.0007, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   7,  Average loss: 0.0006, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   8,  Average loss: 0.0006, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   9,  Average loss: 0.0006, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch  10,  Average loss: 0.0006, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Global model norm: 14.622480648221668.
Norm before scaling: 14.668294874037635. Distance: 0.6403357387736169
Total norm for 9 adversaries is: 14.668294874037635. distance: 0.6403357387736169
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.2536, Accuracy: 5306/8991 (59.0146%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0019, Accuracy: 963/994 (96.8813%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   2,  Average loss: 0.0011, Accuracy: 976/994 (98.1891%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   3,  Average loss: 0.0005, Accuracy: 985/994 (99.0946%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   4,  Average loss: 0.0004, Accuracy: 989/994 (99.4970%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   5,  Average loss: 0.0003, Accuracy: 989/994 (99.4970%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   6,  Average loss: 0.0003, Accuracy: 989/994 (99.4970%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   7,  Average loss: 0.0003, Accuracy: 990/994 (99.5976%), train_poison_data_count: 994
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   8,  Average loss: 0.0003, Accuracy: 991/994 (99.6982%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   9,  Average loss: 0.0002, Accuracy: 991/994 (99.6982%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch  10,  Average loss: 0.0002, Accuracy: 991/994 (99.6982%), train_poison_data_count: 994
Global model norm: 14.622480648221668.
Norm before scaling: 14.742594266049629. Distance: 1.3962483666802317
Total norm for 9 adversaries is: 14.742594266049629. distance: 1.3962483666802317
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.0393, Accuracy: 6947/8991 (77.2662%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0018, Accuracy: 1908/1982 (96.2664%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   2,  Average loss: 0.0016, Accuracy: 1914/1982 (96.5691%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1960/1982 (98.8900%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1964/1982 (99.0918%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1965/1982 (99.1423%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1966/1982 (99.1927%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1967/1982 (99.2432%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1971/1982 (99.4450%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1971/1982 (99.4450%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1971/1982 (99.4450%), train_poison_data_count: 1982
Global model norm: 14.622480648221668.
Norm before scaling: 14.829591314815561. Distance: 2.67790683494256
Total norm for 9 adversaries is: 14.829591314815561. distance: 2.67790683494256
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 3.9642, Accuracy: 2852/8991 (31.7206%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0039, Accuracy: 944/1010 (93.4653%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   2,  Average loss: 0.0024, Accuracy: 964/1010 (95.4455%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   3,  Average loss: 0.0008, Accuracy: 997/1010 (98.7129%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   4,  Average loss: 0.0007, Accuracy: 997/1010 (98.7129%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   5,  Average loss: 0.0006, Accuracy: 999/1010 (98.9109%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   6,  Average loss: 0.0006, Accuracy: 1001/1010 (99.1089%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   7,  Average loss: 0.0005, Accuracy: 1002/1010 (99.2079%), train_poison_data_count: 1010
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   8,  Average loss: 0.0005, Accuracy: 1003/1010 (99.3069%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   9,  Average loss: 0.0005, Accuracy: 1003/1010 (99.3069%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1003/1010 (99.3069%), train_poison_data_count: 1010
Global model norm: 14.622480648221668.
Norm before scaling: 15.004585582447007. Distance: 2.5632898927570213
Total norm for 9 adversaries is: 15.004585582447007. distance: 2.5632898927570213
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 2.5273, Accuracy: 4502/8991 (50.0723%)
time spent on training: 131.77420377731323
[foolsgold agg] training data poison_ratio: 0.9945138100643208  data num: [578, 6, 151, 29, 128, 237, 171, 994, 1982, 1010]
[foolsgold agg] considering poison per batch poison_fraction: 0.9945138100643208
[foolsgold agg] wv: [0.81188701 1.         1.         1.         0.88710251 1.
 0.81133581 0.88710251 0.81133581 1.        ]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.7018, Accuracy: 8337/10000 (83.3700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.2861, Accuracy: 8357/8991 (92.9485%)
Done in 292.0812909603119 sec.
Server Epoch:20 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 421/428 (98.3645%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   2,  Average loss: 0.0002, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   3,  Average loss: 0.0001, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   4,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   5,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 14.674797116490444.
Norm before scaling: 14.703447230960256. Distance: 0.8214558580557821
Total norm for 9 adversaries is: 14.703447230960256. distance: 0.8214558580557821
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 3.9555, Accuracy: 3334/8991 (37.0815%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0117, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   2,  Average loss: 0.0072, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   3,  Average loss: 0.0037, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   4,  Average loss: 0.0034, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   5,  Average loss: 0.0032, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   6,  Average loss: 0.0029, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   7,  Average loss: 0.0027, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   8,  Average loss: 0.0024, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   9,  Average loss: 0.0022, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch  10,  Average loss: 0.0022, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Global model norm: 14.674797116490444.
Norm before scaling: 14.686520807618706. Distance: 0.14861082949591878
Total norm for 9 adversaries is: 14.686520807618706. distance: 0.14861082949591878
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.3046, Accuracy: 8284/8991 (92.1366%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   1,  Average loss: 0.0020, Accuracy: 651/678 (96.0177%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   2,  Average loss: 0.0006, Accuracy: 670/678 (98.8201%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   3,  Average loss: 0.0003, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   4,  Average loss: 0.0002, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   5,  Average loss: 0.0002, Accuracy: 676/678 (99.7050%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   6,  Average loss: 0.0002, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   7,  Average loss: 0.0002, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   8,  Average loss: 0.0002, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   9,  Average loss: 0.0002, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Global model norm: 14.674797116490444.
Norm before scaling: 14.739504425951921. Distance: 1.413994086702384
Total norm for 9 adversaries is: 14.739504425951921. distance: 1.413994086702384
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 3.7561, Accuracy: 4145/8991 (46.1017%)
___Train Local_Simple,  epoch  20, local model 82, internal_epoch   1,  Average loss: 0.0024, Accuracy: 109/114 (95.6140%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.7638, Accuracy: 7999/10000 (79.9900%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0022, Accuracy: 555/578 (96.0208%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   2,  Average loss: 0.0014, Accuracy: 561/578 (97.0588%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   3,  Average loss: 0.0007, Accuracy: 573/578 (99.1349%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   4,  Average loss: 0.0004, Accuracy: 573/578 (99.1349%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   5,  Average loss: 0.0003, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   6,  Average loss: 0.0003, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   7,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   8,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   9,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch  10,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Global model norm: 14.674797116490444.
Norm before scaling: 14.7972085949394. Distance: 1.2339791737658468
Total norm for 9 adversaries is: 14.7972085949394. distance: 1.2339791737658468
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.5645, Accuracy: 5186/8991 (57.6799%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0012, Accuracy: 961/978 (98.2618%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   2,  Average loss: 0.0004, Accuracy: 970/978 (99.1820%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   3,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   4,  Average loss: 0.0001, Accuracy: 975/978 (99.6933%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   5,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   6,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   7,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   8,  Average loss: 0.0001, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Global model norm: 14.674797116490444.
Norm before scaling: 14.76968828434106. Distance: 1.6060800989444655
Total norm for 9 adversaries is: 14.76968828434106. distance: 1.6060800989444655
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 2.8346, Accuracy: 4893/8991 (54.4211%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1190/1232 (96.5909%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1214/1232 (98.5390%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1222/1232 (99.1883%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1225/1232 (99.4318%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1225/1232 (99.4318%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1225/1232 (99.4318%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1227/1232 (99.5942%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1227/1232 (99.5942%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1227/1232 (99.5942%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1227/1232 (99.5942%), train_poison_data_count: 1232
Global model norm: 14.674797116490444.
Norm before scaling: 14.721510966332088. Distance: 1.4074517519254819
Total norm for 9 adversaries is: 14.721510966332088. distance: 1.4074517519254819
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.3839, Accuracy: 5838/8991 (64.9316%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2449/2519 (97.2211%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   2,  Average loss: 0.0007, Accuracy: 2485/2519 (98.6503%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   3,  Average loss: 0.0003, Accuracy: 2506/2519 (99.4839%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   4,  Average loss: 0.0002, Accuracy: 2509/2519 (99.6030%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   5,  Average loss: 0.0002, Accuracy: 2512/2519 (99.7221%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   6,  Average loss: 0.0002, Accuracy: 2512/2519 (99.7221%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   7,  Average loss: 0.0002, Accuracy: 2512/2519 (99.7221%), train_poison_data_count: 2519
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   8,  Average loss: 0.0002, Accuracy: 2513/2519 (99.7618%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   9,  Average loss: 0.0002, Accuracy: 2514/2519 (99.8015%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2514/2519 (99.8015%), train_poison_data_count: 2519
Global model norm: 14.674797116490444.
Norm before scaling: 14.867992128778056. Distance: 2.507322459605639
Total norm for 9 adversaries is: 14.867992128778056. distance: 2.507322459605639
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.7123, Accuracy: 5745/8991 (63.8972%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   2,  Average loss: 0.0019, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   3,  Average loss: 0.0015, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   4,  Average loss: 0.0019, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   6,  Average loss: 0.0037, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   7,  Average loss: 0.0014, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   8,  Average loss: 0.0010, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   9,  Average loss: 0.0009, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch  10,  Average loss: 0.0008, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Global model norm: 14.674797116490444.
Norm before scaling: 14.708393446211408. Distance: 0.5767311356133579
Total norm for 9 adversaries is: 14.708393446211408. distance: 0.5767311356133579
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.1507, Accuracy: 5703/8991 (63.4301%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0038, Accuracy: 60/63 (95.2381%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   2,  Average loss: 0.0012, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   3,  Average loss: 0.0006, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   4,  Average loss: 0.0006, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   5,  Average loss: 0.0006, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   6,  Average loss: 0.0006, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   7,  Average loss: 0.0006, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   8,  Average loss: 0.0005, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   9,  Average loss: 0.0005, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch  10,  Average loss: 0.0005, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Global model norm: 14.674797116490444.
Norm before scaling: 14.6894124835314. Distance: 0.31580736443960267
Total norm for 9 adversaries is: 14.6894124835314. distance: 0.31580736443960267
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.5485, Accuracy: 7444/8991 (82.7939%)
time spent on training: 339.9870047569275
[foolsgold agg] training data poison_ratio: 0.982934131736527  data num: [428, 6, 678, 114, 578, 978, 1232, 2519, 84, 63]
[foolsgold agg] considering poison per batch poison_fraction: 0.982934131736527
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.7548, Accuracy: 8354/10000 (83.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.2567, Accuracy: 8356/8991 (92.9374%)
Done in 501.2618360519409 sec.
Server Epoch:21 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 621/644 (96.4286%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 630/644 (97.8261%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   3,  Average loss: 0.0012, Accuracy: 626/644 (97.2050%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   4,  Average loss: 0.0008, Accuracy: 633/644 (98.2919%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   5,  Average loss: 0.0004, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   7,  Average loss: 0.0003, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   8,  Average loss: 0.0003, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   9,  Average loss: 0.0003, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch  10,  Average loss: 0.0003, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Global model norm: 14.724814945217425.
Norm before scaling: 14.816276487370075. Distance: 1.4075744326002575
Total norm for 5 adversaries is: 14.816276487370075. distance: 1.4075744326002575
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 2.1495, Accuracy: 5066/8991 (56.3452%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 629/648 (97.0679%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   2,  Average loss: 0.0005, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   3,  Average loss: 0.0008, Accuracy: 638/648 (98.4568%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   4,  Average loss: 0.0002, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   5,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   6,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   8,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   9,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch  10,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 14.724814945217425.
Norm before scaling: 14.77520925305898. Distance: 1.1379186321024133
Total norm for 5 adversaries is: 14.77520925305898. distance: 1.1379186321024133
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 1.8825, Accuracy: 5397/8991 (60.0267%)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0032, Accuracy: 30/30 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8004, Accuracy: 8140/10000 (81.4000%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   1,  Average loss: 0.0031, Accuracy: 966/1033 (93.5140%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   2,  Average loss: 0.0018, Accuracy: 990/1033 (95.8374%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   3,  Average loss: 0.0007, Accuracy: 1017/1033 (98.4511%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   4,  Average loss: 0.0006, Accuracy: 1026/1033 (99.3224%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1029/1033 (99.6128%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1028/1033 (99.5160%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1029/1033 (99.6128%), train_poison_data_count: 1033
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1031/1033 (99.8064%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1031/1033 (99.8064%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1031/1033 (99.8064%), train_poison_data_count: 1033
Global model norm: 14.724814945217425.
Norm before scaling: 14.983570510859762. Distance: 2.3748911782480704
Total norm for 5 adversaries is: 14.983570510859762. distance: 2.3748911782480704
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 3.6743, Accuracy: 3865/8991 (42.9874%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0049, Accuracy: 459/509 (90.1768%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0020, Accuracy: 486/509 (95.4813%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0010, Accuracy: 500/509 (98.2318%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0005, Accuracy: 507/509 (99.6071%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0004, Accuracy: 507/509 (99.6071%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0003, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Global model norm: 14.724814945217425.
Norm before scaling: 14.952544357522298. Distance: 2.2880793728899107
Total norm for 5 adversaries is: 14.952544357522298. distance: 2.2880793728899107
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 4.4920, Accuracy: 2643/8991 (29.3961%)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0182, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0196, Accuracy: 8075/10000 (80.7500%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   1,  Average loss: 0.0004, Accuracy: 2168/2180 (99.4495%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   2,  Average loss: 0.0002, Accuracy: 2176/2180 (99.8165%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   4,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   5,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Global model norm: 14.724814945217425.
Norm before scaling: 14.540295088973059. Distance: 1.0741027769428777
Total norm for 5 adversaries is: 14.540295088973059. distance: 1.0741027769428777
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 1.6810, Accuracy: 5329/8991 (59.2704%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0087, Accuracy: 33/34 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8255, Accuracy: 8380/10000 (83.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0072, Accuracy: 80/91 (87.9121%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.1035, Accuracy: 6717/10000 (67.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0007, Accuracy: 697/705 (98.8652%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 8.9508, Accuracy: 1898/10000 (18.9800%), Attack Success Rate:12/10000(0.120)
time spent on training: 119.01132917404175
[foolsgold agg] training data poison_ratio: 0.8528661336962068  data num: [644, 648, 30, 1033, 509, 5, 2180, 34, 91, 705]
[foolsgold agg] considering poison per batch poison_fraction: 0.8528661336962068
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.81477695
 1.         0.81477695 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.8249, Accuracy: 8481/10000 (84.8100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.2039, Accuracy: 8476/8991 (94.2720%)
Done in 307.62339997291565 sec.
Server Epoch:22 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.0115, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   2,  Average loss: 0.0051, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   3,  Average loss: 0.0018, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   4,  Average loss: 0.0016, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   5,  Average loss: 0.0014, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   6,  Average loss: 0.0013, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   7,  Average loss: 0.0012, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   8,  Average loss: 0.0010, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   9,  Average loss: 0.0009, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch  10,  Average loss: 0.0009, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.769863396324752.
Norm before scaling: 14.776832614078437. Distance: 0.15155514153580107
Total norm for 7 adversaries is: 14.776832614078437. distance: 0.15155514153580107
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2470, Accuracy: 8255/8991 (91.8140%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0012, Accuracy: 177/179 (98.8827%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   3,  Average loss: 0.0003, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   4,  Average loss: 0.0003, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   5,  Average loss: 0.0002, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   6,  Average loss: 0.0002, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   7,  Average loss: 0.0001, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Global model norm: 14.769863396324752.
Norm before scaling: 14.797926803958468. Distance: 0.6221219554885645
Total norm for 7 adversaries is: 14.797926803958468. distance: 0.6221219554885645
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.9947, Accuracy: 5525/8991 (61.4503%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0018, Accuracy: 60/63 (95.2381%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   2,  Average loss: 0.0007, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   3,  Average loss: 0.0003, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   4,  Average loss: 0.0003, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   5,  Average loss: 0.0003, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   6,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   7,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   8,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Global model norm: 14.769863396324752.
Norm before scaling: 14.77603179891869. Distance: 0.20692679631229072
Total norm for 7 adversaries is: 14.77603179891869. distance: 0.20692679631229072
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.3585, Accuracy: 7983/8991 (88.7888%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   2,  Average loss: 0.0005, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   3,  Average loss: 0.0002, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   4,  Average loss: 0.0002, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   8,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   9,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch  10,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 14.769863396324752.
Norm before scaling: 14.772734110370468. Distance: 0.10820873517940591
Total norm for 7 adversaries is: 14.772734110370468. distance: 0.10820873517940591
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2319, Accuracy: 8370/8991 (93.0931%)
___Train Local_Simple,  epoch  22, local model 60, internal_epoch   1,  Average loss: 0.0011, Accuracy: 391/399 (97.9950%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 14.4497, Accuracy: 1916/10000 (19.1600%), Attack Success Rate:18/10000(0.180)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0026, Accuracy: 161/171 (94.1520%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   2,  Average loss: 0.0017, Accuracy: 163/171 (95.3216%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   3,  Average loss: 0.0009, Accuracy: 168/171 (98.2456%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   4,  Average loss: 0.0009, Accuracy: 169/171 (98.8304%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   5,  Average loss: 0.0006, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   6,  Average loss: 0.0004, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   7,  Average loss: 0.0004, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   8,  Average loss: 0.0004, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   9,  Average loss: 0.0004, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch  10,  Average loss: 0.0003, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Global model norm: 14.769863396324752.
Norm before scaling: 14.780003436634042. Distance: 0.5872174080484239
Total norm for 7 adversaries is: 14.780003436634042. distance: 0.5872174080484239
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.2606, Accuracy: 5404/8991 (60.1045%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0010, Accuracy: 958/978 (97.9550%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   2,  Average loss: 0.0005, Accuracy: 971/978 (99.2843%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   3,  Average loss: 0.0002, Accuracy: 973/978 (99.4888%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   4,  Average loss: 0.0002, Accuracy: 974/978 (99.5910%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   5,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   6,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   7,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   8,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   9,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch  10,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Global model norm: 14.769863396324752.
Norm before scaling: 14.82522487116026. Distance: 1.6304086027946032
Total norm for 7 adversaries is: 14.82522487116026. distance: 1.6304086027946032
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.6308, Accuracy: 5468/8991 (60.8164%)
___Train Local_Simple,  epoch  22, local model 92, internal_epoch   1,  Average loss: 0.0011, Accuracy: 199/202 (98.5149%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 4.2025, Accuracy: 3250/10000 (32.5000%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   1,  Average loss: 0.0015, Accuracy: 657/678 (96.9027%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   2,  Average loss: 0.0004, Accuracy: 673/678 (99.2625%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   3,  Average loss: 0.0003, Accuracy: 676/678 (99.7050%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   4,  Average loss: 0.0002, Accuracy: 676/678 (99.7050%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   5,  Average loss: 0.0002, Accuracy: 676/678 (99.7050%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   6,  Average loss: 0.0002, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   7,  Average loss: 0.0002, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Global model norm: 14.769863396324752.
Norm before scaling: 14.82187275573855. Distance: 1.571526053736699
Total norm for 7 adversaries is: 14.82187275573855. distance: 1.571526053736699
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 5.4504, Accuracy: 3858/8991 (42.9096%)
___Train Local_Simple,  epoch  22, local model 96, internal_epoch   1,  Average loss: 0.0050, Accuracy: 475/505 (94.0594%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 3.4710, Accuracy: 3793/10000 (37.9300%), Attack Success Rate:0/10000(0.000)
time spent on training: 105.88983583450317
[foolsgold agg] training data poison_ratio: 0.6552369077306733  data num: [5, 179, 63, 28, 399, 171, 978, 202, 678, 505]
[foolsgold agg] considering poison per batch poison_fraction: 0.6552369077306733
[foolsgold agg] wv: [1.         1.         0.         0.         0.2561813  0.99807286
 1.         0.2561813  0.99807286 1.        ]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.7637, Accuracy: 8511/10000 (85.1100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.1931, Accuracy: 8507/8991 (94.6168%)
Done in 273.68020486831665 sec.
Server Epoch:23 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0034, Accuracy: 675/704 (95.8807%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.7070, Accuracy: 2777/10000 (27.7700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0020, Accuracy: 108/114 (94.7368%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.0198, Accuracy: 7321/10000 (73.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 85, internal_epoch   1,  Average loss: 0.0293, Accuracy: 4/4 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.8588, Accuracy: 8057/10000 (80.5700%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0029, Accuracy: 90/94 (95.7447%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   3,  Average loss: 0.0005, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   4,  Average loss: 0.0008, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   6,  Average loss: 0.0005, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   8,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   9,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch  10,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Global model norm: 14.784977706980097.
Norm before scaling: 14.794449378799976. Distance: 0.42346764981521945
Total norm for 2 adversaries is: 14.794449378799976. distance: 0.42346764981521945
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.7399, Accuracy: 7051/8991 (78.4229%)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0034, Accuracy: 81/87 (93.1034%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.2664, Accuracy: 6562/10000 (65.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 61, internal_epoch   1,  Average loss: 0.0024, Accuracy: 737/767 (96.0887%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.8463, Accuracy: 4466/10000 (44.6600%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1279/1311 (97.5591%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1301/1311 (99.2372%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1306/1311 (99.6186%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1306/1311 (99.6186%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1305/1311 (99.5423%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1305/1311 (99.5423%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1306/1311 (99.6186%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1308/1311 (99.7712%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1308/1311 (99.7712%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1308/1311 (99.7712%), train_poison_data_count: 1311
Global model norm: 14.784977706980097.
Norm before scaling: 14.768304878336314. Distance: 1.8763539194380683
Total norm for 2 adversaries is: 14.768304878336314. distance: 1.8763539194380683
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 3.4450, Accuracy: 2379/8991 (26.4598%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0059, Accuracy: 32/34 (94.1176%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.8398, Accuracy: 8429/10000 (84.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0345, Accuracy: 40/69 (57.9710%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.2868, Accuracy: 7170/10000 (71.7000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  23, local model 75, internal_epoch   1,  Average loss: 0.0022, Accuracy: 478/497 (96.1771%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 10.3426, Accuracy: 1933/10000 (19.3300%), Attack Success Rate:9/10000(0.090)
time spent on training: 81.87352108955383
[foolsgold agg] training data poison_ratio: 0.3816897582178756  data num: [704, 114, 4, 94, 87, 767, 1311, 34, 69, 497]
[foolsgold agg] considering poison per batch poison_fraction: 0.3816897582178756
[foolsgold agg] wv: [0.80446225 1.         1.         1.         0.         1.
 0.         0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.5808, Accuracy: 8534/10000 (85.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.1957, Accuracy: 8534/8991 (94.9171%)
Done in 253.20996713638306 sec.
Server Epoch:24 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   1,  Average loss: 0.0019, Accuracy: 293/304 (96.3816%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   2,  Average loss: 0.0008, Accuracy: 301/304 (99.0132%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   3,  Average loss: 0.0007, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   4,  Average loss: 0.0004, Accuracy: 302/304 (99.3421%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   5,  Average loss: 0.0002, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   6,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   7,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   8,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Global model norm: 14.783419750237721.
Norm before scaling: 14.80469574538029. Distance: 0.8022573125499424
Total norm for 4 adversaries is: 14.80469574538029. distance: 0.8022573125499424
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 2.7839, Accuracy: 3991/8991 (44.3888%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1292/1326 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.5469, Accuracy: 3474/10000 (34.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 452/505 (89.5050%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 3.0080, Accuracy: 5135/10000 (51.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 83, internal_epoch   1,  Average loss: 0.0018, Accuracy: 722/750 (96.2667%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.5379, Accuracy: 5867/10000 (58.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2882/3022 (95.3673%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.8999, Accuracy: 1924/10000 (19.2400%), Attack Success Rate:10/10000(0.100)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0014, Accuracy: 799/818 (97.6773%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   2,  Average loss: 0.0008, Accuracy: 805/818 (98.4108%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   3,  Average loss: 0.0004, Accuracy: 813/818 (99.3888%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   4,  Average loss: 0.0002, Accuracy: 815/818 (99.6333%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   5,  Average loss: 0.0002, Accuracy: 814/818 (99.5110%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 815/818 (99.6333%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 14.783419750237721.
Norm before scaling: 14.89489441515689. Distance: 1.7067269549425348
Total norm for 4 adversaries is: 14.89489441515689. distance: 1.7067269549425348
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 4.6053, Accuracy: 3866/8991 (42.9986%)
___Train Local_Simple,  epoch  24, local model 94, internal_epoch   1,  Average loss: 0.0021, Accuracy: 591/607 (97.3641%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.2082, Accuracy: 5887/10000 (58.8700%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0024, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   2,  Average loss: 0.0014, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   3,  Average loss: 0.0009, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   4,  Average loss: 0.0008, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   5,  Average loss: 0.0008, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   6,  Average loss: 0.0007, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   7,  Average loss: 0.0007, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   8,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   9,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch  10,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Global model norm: 14.783419750237721.
Norm before scaling: 14.805250236666467. Distance: 0.3607086851779179
Total norm for 4 adversaries is: 14.805250236666467. distance: 0.3607086851779179
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.3476, Accuracy: 8008/8991 (89.0668%)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0019, Accuracy: 692/705 (98.1560%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.4627, Accuracy: 1969/10000 (19.6900%), Attack Success Rate:11/10000(0.110)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   1,  Average loss: 0.0007, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 14.783419750237721.
Norm before scaling: 14.78205982272224. Distance: 0.3247309855179743
Total norm for 4 adversaries is: 14.78205982272224. distance: 0.3247309855179743
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.6117, Accuracy: 7365/8991 (81.9152%)
time spent on training: 80.97392988204956
[foolsgold agg] training data poison_ratio: 0.16847041847041846  data num: [304, 1326, 505, 750, 3022, 818, 607, 128, 705, 151]
[foolsgold agg] considering poison per batch poison_fraction: 0.16847041847041846
[foolsgold agg] wv: [1.         0.76022674 0.         1.         0.         1.
 1.         1.         0.76022674 1.        ]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.5906, Accuracy: 8543/10000 (85.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.1833, Accuracy: 8550/8991 (95.0951%)
Done in 248.19834113121033 sec.
Server Epoch:25 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0028, Accuracy: 369/388 (95.1031%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 383/388 (98.7113%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   3,  Average loss: 0.0173, Accuracy: 280/388 (72.1649%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   4,  Average loss: 0.0020, Accuracy: 381/388 (98.1959%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   5,  Average loss: 0.0019, Accuracy: 378/388 (97.4227%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   6,  Average loss: 0.0014, Accuracy: 377/388 (97.1649%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   7,  Average loss: 0.0012, Accuracy: 381/388 (98.1959%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   8,  Average loss: 0.0010, Accuracy: 380/388 (97.9381%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   9,  Average loss: 0.0009, Accuracy: 380/388 (97.9381%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch  10,  Average loss: 0.0011, Accuracy: 380/388 (97.9381%), train_poison_data_count: 388
Global model norm: 14.796460960581344.
Norm before scaling: 14.88184769674588. Distance: 1.807225214224782
Total norm for 8 adversaries is: 14.88184769674588. distance: 1.807225214224782
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 2.8295, Accuracy: 2911/8991 (32.3768%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1915/1982 (96.6196%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1950/1982 (98.3855%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1969/1982 (99.3441%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1970/1982 (99.3946%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1970/1982 (99.3946%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1974/1982 (99.5964%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1974/1982 (99.5964%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1973/1982 (99.5459%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1975/1982 (99.6468%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1975/1982 (99.6468%), train_poison_data_count: 1982
Global model norm: 14.796460960581344.
Norm before scaling: 14.825554740523465. Distance: 2.2945203064555915
Total norm for 8 adversaries is: 14.825554740523465. distance: 2.2945203064555915
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 5.6491, Accuracy: 2849/8991 (31.6872%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 969/978 (99.0798%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   2,  Average loss: 0.0002, Accuracy: 973/978 (99.4888%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   3,  Average loss: 0.0001, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   4,  Average loss: 0.0000, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   5,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Global model norm: 14.796460960581344.
Norm before scaling: 14.793166794620973. Distance: 1.2386492353888843
Total norm for 8 adversaries is: 14.793166794620973. distance: 1.2386492353888843
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 2.7539, Accuracy: 5294/8991 (58.8811%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0033, Accuracy: 88/94 (93.6170%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   3,  Average loss: 0.0010, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   4,  Average loss: 0.0006, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   7,  Average loss: 0.0004, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   8,  Average loss: 0.0005, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   9,  Average loss: 0.0004, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch  10,  Average loss: 0.0002, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Global model norm: 14.796460960581344.
Norm before scaling: 14.810657499298383. Distance: 0.47826266706594417
Total norm for 8 adversaries is: 14.810657499298383. distance: 0.47826266706594417
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.8173, Accuracy: 6827/8991 (75.9315%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0005, Accuracy: 2160/2180 (99.0826%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0001, Accuracy: 2173/2180 (99.6789%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   3,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   4,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   5,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Global model norm: 14.796460960581344.
Norm before scaling: 14.629977430742107. Distance: 1.2477637792218919
Total norm for 8 adversaries is: 14.629977430742107. distance: 1.2477637792218919
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.7063, Accuracy: 5561/8991 (61.8507%)
___Train Local_Simple,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1178/1205 (97.7593%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.2689, Accuracy: 4713/10000 (47.1300%), Attack Success Rate:1/10000(0.010)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0032, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   2,  Average loss: 0.0026, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   3,  Average loss: 0.0018, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   4,  Average loss: 0.0017, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   5,  Average loss: 0.0016, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   6,  Average loss: 0.0015, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   7,  Average loss: 0.0014, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   8,  Average loss: 0.0013, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   9,  Average loss: 0.0012, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch  10,  Average loss: 0.0012, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Global model norm: 14.796460960581344.
Norm before scaling: 14.800222467348517. Distance: 0.06419226932891368
Total norm for 8 adversaries is: 14.800222467348517. distance: 0.06419226932891368
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1932, Accuracy: 8523/8991 (94.7948%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 164/171 (95.9064%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   2,  Average loss: 0.0012, Accuracy: 166/171 (97.0760%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   3,  Average loss: 0.0004, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   4,  Average loss: 0.0004, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   5,  Average loss: 0.0003, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   6,  Average loss: 0.0003, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   7,  Average loss: 0.0003, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   8,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   9,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch  10,  Average loss: 0.0003, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Global model norm: 14.796460960581344.
Norm before scaling: 14.81092690915066. Distance: 0.5017109446243639
Total norm for 8 adversaries is: 14.81092690915066. distance: 0.5017109446243639
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.0801, Accuracy: 6096/8991 (67.8011%)
___Train Local_Simple,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0032, Accuracy: 718/762 (94.2257%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.2517, Accuracy: 3925/10000 (39.2500%), Attack Success Rate:0/10000(0.000)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0022, Accuracy: 969/1010 (95.9406%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   2,  Average loss: 0.0010, Accuracy: 993/1010 (98.3168%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   3,  Average loss: 0.0006, Accuracy: 997/1010 (98.7129%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1005/1010 (99.5050%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1005/1010 (99.5050%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1005/1010 (99.5050%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1006/1010 (99.6040%), train_poison_data_count: 1010
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1005/1010 (99.5050%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1006/1010 (99.6040%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1006/1010 (99.6040%), train_poison_data_count: 1010
Global model norm: 14.796460960581344.
Norm before scaling: 14.879403624530108. Distance: 1.6369459044665404
Total norm for 8 adversaries is: 14.879403624530108. distance: 1.6369459044665404
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 2.3112, Accuracy: 5138/8991 (57.1460%)
time spent on training: 167.7009871006012
[foolsgold agg] training data poison_ratio: 0.775865998176846  data num: [388, 1982, 978, 94, 2180, 1205, 6, 171, 762, 1010]
[foolsgold agg] considering poison per batch poison_fraction: 0.775865998176846
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.54261549
 1.         1.         0.54261549 1.        ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.6110, Accuracy: 8271/10000 (82.7100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.2674, Accuracy: 8304/8991 (92.3590%)
Done in 370.4751498699188 sec.
Server Epoch:26 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1244/1259 (98.8086%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1251/1259 (99.3646%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1255/1259 (99.6823%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Global model norm: 14.837720815016537.
Norm before scaling: 14.822881094951754. Distance: 1.3453236613768724
Total norm for 7 adversaries is: 14.822881094951754. distance: 1.3453236613768724
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.8321, Accuracy: 6208/8991 (69.0468%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0083, Accuracy: 45/48 (93.7500%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   2,  Average loss: 0.0005, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   3,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   4,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   5,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   6,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 14.837720815016537.
Norm before scaling: 14.861109811816451. Distance: 0.5464019636902913
Total norm for 7 adversaries is: 14.861109811816451. distance: 0.5464019636902913
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.8552, Accuracy: 6829/8991 (75.9537%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   1,  Average loss: 0.0070, Accuracy: 27/28 (96.4286%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   2,  Average loss: 0.0005, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   3,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   4,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   5,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   6,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 14.837720815016537.
Norm before scaling: 14.852492799473039. Distance: 0.37046837564141366
Total norm for 7 adversaries is: 14.852492799473039. distance: 0.37046837564141366
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.3507, Accuracy: 8051/8991 (89.5451%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0014, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   2,  Average loss: 0.0012, Accuracy: 460/463 (99.3521%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   3,  Average loss: 0.0009, Accuracy: 459/463 (99.1361%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   4,  Average loss: 0.0007, Accuracy: 459/463 (99.1361%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   5,  Average loss: 0.0006, Accuracy: 461/463 (99.5680%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   6,  Average loss: 0.0005, Accuracy: 461/463 (99.5680%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   7,  Average loss: 0.0005, Accuracy: 461/463 (99.5680%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   8,  Average loss: 0.0004, Accuracy: 461/463 (99.5680%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   9,  Average loss: 0.0004, Accuracy: 461/463 (99.5680%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch  10,  Average loss: 0.0004, Accuracy: 461/463 (99.5680%), train_poison_data_count: 463
Global model norm: 14.837720815016537.
Norm before scaling: 14.830171626738364. Distance: 1.18347786817659
Total norm for 7 adversaries is: 14.830171626738364. distance: 1.18347786817659
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.0172, Accuracy: 5760/8991 (64.0641%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 796/818 (97.3105%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   2,  Average loss: 0.0004, Accuracy: 810/818 (99.0220%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   3,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 14.837720815016537.
Norm before scaling: 14.974250053770692. Distance: 2.0614466433766285
Total norm for 7 adversaries is: 14.974250053770692. distance: 2.0614466433766285
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 5.1063, Accuracy: 3940/8991 (43.8216%)
___Train Local_Simple,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2873/3022 (95.0695%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.8692, Accuracy: 1881/10000 (18.8100%), Attack Success Rate:12/10000(0.120)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 421/428 (98.3645%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   3,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   4,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   5,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 14.837720815016537.
Norm before scaling: 14.843578843585606. Distance: 0.7604983211902595
Total norm for 7 adversaries is: 14.843578843585606. distance: 0.7604983211902595
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 3.2781, Accuracy: 3940/8991 (43.8216%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0023, Accuracy: 973/1010 (96.3366%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   2,  Average loss: 0.0026, Accuracy: 958/1010 (94.8515%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   3,  Average loss: 0.0010, Accuracy: 994/1010 (98.4158%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   4,  Average loss: 0.0008, Accuracy: 995/1010 (98.5149%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   5,  Average loss: 0.0007, Accuracy: 997/1010 (98.7129%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   6,  Average loss: 0.0006, Accuracy: 999/1010 (98.9109%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   7,  Average loss: 0.0005, Accuracy: 998/1010 (98.8119%), train_poison_data_count: 1010
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   8,  Average loss: 0.0005, Accuracy: 1002/1010 (99.2079%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   9,  Average loss: 0.0005, Accuracy: 1004/1010 (99.4059%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1004/1010 (99.4059%), train_poison_data_count: 1010
Global model norm: 14.837720815016537.
Norm before scaling: 15.079267990194921. Distance: 2.44502671006792
Total norm for 7 adversaries is: 15.079267990194921. distance: 2.44502671006792
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 2.3943, Accuracy: 4164/8991 (46.3130%)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0037, Accuracy: 587/607 (96.7051%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.9949, Accuracy: 6796/10000 (67.9600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  26, local model 84, internal_epoch   1,  Average loss: 0.0822, Accuracy: 7/29 (24.1379%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.3669, Accuracy: 7484/10000 (74.8400%), Attack Success Rate:0/10000(0.000)
time spent on training: 128.02764105796814
[foolsgold agg] training data poison_ratio: 0.5256742738589212  data num: [1259, 48, 28, 463, 818, 3022, 428, 1010, 607, 29]
[foolsgold agg] considering poison per batch poison_fraction: 0.5256742738589212
[foolsgold agg] wv: [1. 0. 1. 1. 1. 0. 1. 1. 0. 0.]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.6695, Accuracy: 8325/10000 (83.2500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.2355, Accuracy: 8359/8991 (92.9707%)
Done in 322.10877680778503 sec.
Server Epoch:27 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
___Train Local_Simple,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.0030, Accuracy: 562/586 (95.9044%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.1784, Accuracy: 3128/10000 (31.2800%), Attack Success Rate:0/10000(0.000)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 109/119 (91.5966%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   2,  Average loss: 0.0074, Accuracy: 103/119 (86.5546%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   3,  Average loss: 0.0067, Accuracy: 106/119 (89.0756%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   4,  Average loss: 0.0057, Accuracy: 108/119 (90.7563%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   5,  Average loss: 0.0031, Accuracy: 114/119 (95.7983%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   6,  Average loss: 0.0015, Accuracy: 114/119 (95.7983%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   7,  Average loss: 0.0007, Accuracy: 116/119 (97.4790%), train_poison_data_count: 119
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   8,  Average loss: 0.0008, Accuracy: 117/119 (98.3193%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   9,  Average loss: 0.0011, Accuracy: 117/119 (98.3193%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch  10,  Average loss: 0.0012, Accuracy: 117/119 (98.3193%), train_poison_data_count: 119
Global model norm: 14.864150249727846.
Norm before scaling: 14.882312163505752. Distance: 0.7286619801308059
Total norm for 7 adversaries is: 14.882312163505752. distance: 0.7286619801308059
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.5114, Accuracy: 7482/8991 (83.2165%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   1,  Average loss: 0.0037, Accuracy: 60/63 (95.2381%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   2,  Average loss: 0.0008, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   4,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   5,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   6,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   7,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   8,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Global model norm: 14.864150249727846.
Norm before scaling: 14.874501965303589. Distance: 0.35465774663410565
Total norm for 7 adversaries is: 14.874501965303589. distance: 0.35465774663410565
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.4221, Accuracy: 7857/8991 (87.3874%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0032, Accuracy: 118/128 (92.1875%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   2,  Average loss: 0.0023, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   3,  Average loss: 0.0013, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   4,  Average loss: 0.0010, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   5,  Average loss: 0.0008, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   6,  Average loss: 0.0007, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   7,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   8,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   9,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch  10,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Global model norm: 14.864150249727846.
Norm before scaling: 14.882117355812898. Distance: 0.4385373725439249
Total norm for 7 adversaries is: 14.882117355812898. distance: 0.4385373725439249
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.3158, Accuracy: 8088/8991 (89.9566%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 87/94 (92.5532%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   2,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   3,  Average loss: 0.0008, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   4,  Average loss: 0.0009, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   5,  Average loss: 0.0008, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   6,  Average loss: 0.0013, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   7,  Average loss: 0.0006, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   8,  Average loss: 0.0009, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   9,  Average loss: 0.0008, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch  10,  Average loss: 0.0004, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Global model norm: 14.864150249727846.
Norm before scaling: 14.879155964857768. Distance: 0.6199217721209473
Total norm for 7 adversaries is: 14.879155964857768. distance: 0.6199217721209473
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 1.1607, Accuracy: 6188/8991 (68.8244%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 560/578 (96.8858%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   2,  Average loss: 0.0035, Accuracy: 536/578 (92.7336%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   3,  Average loss: 0.0041, Accuracy: 551/578 (95.3287%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   4,  Average loss: 0.0017, Accuracy: 560/578 (96.8858%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   5,  Average loss: 0.0011, Accuracy: 567/578 (98.0969%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   6,  Average loss: 0.0008, Accuracy: 571/578 (98.7889%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   7,  Average loss: 0.0006, Accuracy: 572/578 (98.9619%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   8,  Average loss: 0.0005, Accuracy: 572/578 (98.9619%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   9,  Average loss: 0.0004, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch  10,  Average loss: 0.0004, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Global model norm: 14.864150249727846.
Norm before scaling: 15.165186939087198. Distance: 2.508539302476218
Total norm for 7 adversaries is: 15.165186939087198. distance: 2.508539302476218
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 1.4120, Accuracy: 5301/8991 (58.9590%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   1,  Average loss: 0.0020, Accuracy: 376/388 (96.9072%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   2,  Average loss: 0.0016, Accuracy: 379/388 (97.6804%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   3,  Average loss: 0.0006, Accuracy: 385/388 (99.2268%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   4,  Average loss: 0.0004, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   5,  Average loss: 0.0003, Accuracy: 385/388 (99.2268%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   6,  Average loss: 0.0003, Accuracy: 386/388 (99.4845%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   7,  Average loss: 0.0003, Accuracy: 385/388 (99.2268%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   8,  Average loss: 0.0010, Accuracy: 386/388 (99.4845%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   9,  Average loss: 0.0003, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch  10,  Average loss: 0.0002, Accuracy: 386/388 (99.4845%), train_poison_data_count: 388
Global model norm: 14.864150249727846.
Norm before scaling: 14.845596616222656. Distance: 0.9881521751339334
Total norm for 7 adversaries is: 14.845596616222656. distance: 0.9881521751339334
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 2.0259, Accuracy: 5199/8991 (57.8245%)
___Train Local_Simple,  epoch  27, local model 54, internal_epoch   1,  Average loss: 0.0065, Accuracy: 84/91 (92.3077%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.7309, Accuracy: 8120/10000 (81.2000%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   1,  Average loss: 0.0011, Accuracy: 798/818 (97.5550%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   2,  Average loss: 0.0004, Accuracy: 811/818 (99.1443%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   3,  Average loss: 0.0001, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 14.864150249727846.
Norm before scaling: 14.92923830515376. Distance: 1.5748841651827241
Total norm for 7 adversaries is: 14.92923830515376. distance: 1.5748841651827241
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 4.3484, Accuracy: 4006/8991 (44.5557%)
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0029, Accuracy: 288/300 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.0565, Accuracy: 4985/10000 (49.8500%), Attack Success Rate:1/10000(0.010)
time spent on training: 110.92723178863525
[foolsgold agg] training data poison_ratio: 0.6913112164296998  data num: [586, 119, 63, 128, 94, 578, 388, 91, 818, 300]
[foolsgold agg] considering poison per batch poison_fraction: 0.6913112164296998
[foolsgold agg] wv: [0.20284141 1.         0.20284141 1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.6306, Accuracy: 8529/10000 (85.2900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.1842, Accuracy: 8535/8991 (94.9283%)
Done in 309.289990901947 sec.
Server Epoch:28 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 630/644 (97.8261%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 630/644 (97.8261%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   3,  Average loss: 0.0005, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   4,  Average loss: 0.0003, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   5,  Average loss: 0.0003, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   8,  Average loss: 0.0002, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch  10,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Global model norm: 14.892281375117248.
Norm before scaling: 14.92929298602248. Distance: 1.16766920044
Total norm for 5 adversaries is: 14.92929298602248. distance: 1.16766920044
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.7744, Accuracy: 5729/8991 (63.7193%)
___Train Local_Simple,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0009, Accuracy: 256/259 (98.8417%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.5591, Accuracy: 6251/10000 (62.5100%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0034, Accuracy: 91/94 (96.8085%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   3,  Average loss: 0.0003, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   4,  Average loss: 0.0003, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   5,  Average loss: 0.0003, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   7,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   8,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch  10,  Average loss: 0.0003, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Global model norm: 14.892281375117248.
Norm before scaling: 14.90653559573105. Distance: 0.5236971766161389
Total norm for 5 adversaries is: 14.90653559573105. distance: 0.5236971766161389
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.0126, Accuracy: 6700/8991 (74.5190%)
___Train Local_Simple,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 2879/3022 (95.2680%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 3.9476, Accuracy: 1928/10000 (19.2800%), Attack Success Rate:14/10000(0.140)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1918/1982 (96.7709%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1947/1982 (98.2341%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1969/1982 (99.3441%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1971/1982 (99.4450%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1972/1982 (99.4955%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1973/1982 (99.5459%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1974/1982 (99.5964%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1976/1982 (99.6973%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1977/1982 (99.7477%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1977/1982 (99.7477%), train_poison_data_count: 1982
Global model norm: 14.892281375117248.
Norm before scaling: 14.938162944559252. Distance: 2.132434070815727
Total norm for 5 adversaries is: 14.938162944559252. distance: 2.132434070815727
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 3.4550, Accuracy: 2887/8991 (32.1099%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.0127, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   2,  Average loss: 0.0033, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   3,  Average loss: 0.0011, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   4,  Average loss: 0.0010, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   5,  Average loss: 0.0009, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   6,  Average loss: 0.0009, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   7,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   8,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   9,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch  10,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.892281375117248.
Norm before scaling: 14.897942297256451. Distance: 0.17897275080204708
Total norm for 5 adversaries is: 14.897942297256451. distance: 0.17897275080204708
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1827, Accuracy: 8495/8991 (94.4834%)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0014, Accuracy: 111/114 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6883, Accuracy: 8170/10000 (81.7000%), Attack Success Rate:0/10000(0.000)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   1,  Average loss: 0.0009, Accuracy: 964/978 (98.5685%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   2,  Average loss: 0.0005, Accuracy: 968/978 (98.9775%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   3,  Average loss: 0.0003, Accuracy: 973/978 (99.4888%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   4,  Average loss: 0.0002, Accuracy: 975/978 (99.6933%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   5,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   6,  Average loss: 0.0001, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   7,  Average loss: 0.0001, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   8,  Average loss: 0.0001, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   9,  Average loss: 0.0001, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch  10,  Average loss: 0.0001, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Global model norm: 14.892281375117248.
Norm before scaling: 14.961209303177219. Distance: 1.528798690856421
Total norm for 5 adversaries is: 14.961209303177219. distance: 1.528798690856421
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.0820, Accuracy: 6157/8991 (68.4796%)
___Train Local_Simple,  epoch  28, local model 80, internal_epoch   1,  Average loss: 0.0023, Accuracy: 82/84 (97.6190%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.9600, Accuracy: 7444/10000 (74.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 81, internal_epoch   1,  Average loss: 0.0021, Accuracy: 66/68 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6738, Accuracy: 8353/10000 (83.5300%), Attack Success Rate:0/10000(0.000)
time spent on training: 129.02515506744385
[foolsgold agg] training data poison_ratio: 0.5107586206896552  data num: [644, 259, 94, 3022, 1982, 5, 114, 978, 84, 68]
[foolsgold agg] considering poison per batch poison_fraction: 0.5107586206896552
[foolsgold agg] wv: [1.         0.         0.89830779 1.         1.         1.
 1.         1.         0.         0.89830779]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.3693, Accuracy: 8559/10000 (85.5900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.2119, Accuracy: 8496/8991 (94.4945%)
Done in 312.5409429073334 sec.
Server Epoch:29 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
___Train Local_Simple,  epoch  29, local model 58, internal_epoch   1,  Average loss: 0.0026, Accuracy: 960/1015 (94.5813%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.7004, Accuracy: 5151/10000 (51.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 90, internal_epoch   1,  Average loss: 0.0012, Accuracy: 753/768 (98.0469%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.2869, Accuracy: 5413/10000 (54.1300%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0010, Accuracy: 804/818 (98.2885%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   2,  Average loss: 0.0004, Accuracy: 812/818 (99.2665%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   3,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   8,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 14.908511072289484.
Norm before scaling: 14.962475443145053. Distance: 1.4165611321278364
Total norm for 5 adversaries is: 14.962475443145053. distance: 1.4165611321278364
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 3.9590, Accuracy: 3999/8991 (44.4778%)
___Train Local_Simple,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.0486, Accuracy: 9/10 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.5741, Accuracy: 8021/10000 (80.2100%), Attack Success Rate:0/10000(0.000)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0051, Accuracy: 466/509 (91.5521%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0018, Accuracy: 486/509 (95.4813%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0005, Accuracy: 504/509 (99.0177%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0004, Accuracy: 507/509 (99.6071%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 507/509 (99.6071%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 507/509 (99.6071%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 507/509 (99.6071%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 507/509 (99.6071%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 507/509 (99.6071%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 507/509 (99.6071%), train_poison_data_count: 509
Global model norm: 14.908511072289484.
Norm before scaling: 15.11286628727298. Distance: 2.3545044400668855
Total norm for 5 adversaries is: 15.11286628727298. distance: 2.3545044400668855
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 3.8512, Accuracy: 2772/8991 (30.8308%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0027, Accuracy: 122/128 (95.3125%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   2,  Average loss: 0.0011, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   3,  Average loss: 0.0009, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   4,  Average loss: 0.0008, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   5,  Average loss: 0.0008, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   6,  Average loss: 0.0007, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   7,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   8,  Average loss: 0.0005, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   9,  Average loss: 0.0005, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch  10,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Global model norm: 14.908511072289484.
Norm before scaling: 14.929255169368275. Distance: 0.3963086908780348
Total norm for 5 adversaries is: 14.929255169368275. distance: 0.3963086908780348
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.2489, Accuracy: 8312/8991 (92.4480%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0015, Accuracy: 963/994 (96.8813%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   2,  Average loss: 0.0006, Accuracy: 983/994 (98.8934%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   3,  Average loss: 0.0003, Accuracy: 988/994 (99.3964%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   4,  Average loss: 0.0002, Accuracy: 989/994 (99.4970%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   5,  Average loss: 0.0002, Accuracy: 991/994 (99.6982%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   6,  Average loss: 0.0002, Accuracy: 991/994 (99.6982%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   7,  Average loss: 0.0002, Accuracy: 992/994 (99.7988%), train_poison_data_count: 994
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   8,  Average loss: 0.0002, Accuracy: 993/994 (99.8994%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   9,  Average loss: 0.0001, Accuracy: 993/994 (99.8994%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch  10,  Average loss: 0.0001, Accuracy: 993/994 (99.8994%), train_poison_data_count: 994
Global model norm: 14.908511072289484.
Norm before scaling: 14.94078481142306. Distance: 1.2622680885407536
Total norm for 5 adversaries is: 14.94078481142306. distance: 1.2622680885407536
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.6426, Accuracy: 7249/8991 (80.6251%)
___Train Local_Simple,  epoch  29, local model 91, internal_epoch   1,  Average loss: 0.0009, Accuracy: 179/182 (98.3516%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4902, Accuracy: 8189/10000 (81.8900%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0012, Accuracy: 147/151 (97.3510%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 14.908511072289484.
Norm before scaling: 14.911203133276535. Distance: 0.5379546571293311
Total norm for 5 adversaries is: 14.911203133276535. distance: 0.5379546571293311
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 1.1845, Accuracy: 6415/8991 (71.3491%)
___Train Local_Simple,  epoch  29, local model 57, internal_epoch   1,  Average loss: 0.0026, Accuracy: 1355/1437 (94.2937%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.5459, Accuracy: 3935/10000 (39.3500%), Attack Success Rate:0/10000(0.000)
time spent on training: 99.00943326950073
[foolsgold agg] training data poison_ratio: 0.4324683965402528  data num: [1015, 768, 818, 10, 509, 128, 994, 182, 151, 1437]
[foolsgold agg] considering poison per batch poison_fraction: 0.4324683965402528
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.4521, Accuracy: 8538/10000 (85.3800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.2013, Accuracy: 8488/8991 (94.4055%)
Done in 260.89526200294495 sec.
Server Epoch:30 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 149/151 (98.6755%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 14.936978510608068.
Norm before scaling: 14.936208756952013. Distance: 0.4023277872122598
Total norm for 7 adversaries is: 14.936208756952013. distance: 0.4023277872122598
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.6435, Accuracy: 7419/8991 (82.5158%)
___Train Local_Simple,  epoch  30, local model 77, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1503/1544 (97.3446%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.9107, Accuracy: 5581/10000 (55.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1178/1205 (97.7593%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.0698, Accuracy: 5517/10000 (55.1700%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 2046/2072 (98.7452%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   2,  Average loss: 0.0002, Accuracy: 2064/2072 (99.6139%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2069/2072 (99.8552%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2071/2072 (99.9517%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2070/2072 (99.9035%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2070/2072 (99.9035%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2070/2072 (99.9035%), train_poison_data_count: 2072
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2071/2072 (99.9517%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2071/2072 (99.9517%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2071/2072 (99.9517%), train_poison_data_count: 2072
Global model norm: 14.936978510608068.
Norm before scaling: 14.778752121956257. Distance: 1.4829167481126126
Total norm for 7 adversaries is: 14.778752121956257. distance: 1.4829167481126126
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 2.0889, Accuracy: 4833/8991 (53.7538%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0023, Accuracy: 658/688 (95.6395%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   2,  Average loss: 0.0008, Accuracy: 677/688 (98.4012%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   3,  Average loss: 0.0003, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   5,  Average loss: 0.0002, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 14.936978510608068.
Norm before scaling: 15.012555780235672. Distance: 1.8062403219947119
Total norm for 7 adversaries is: 15.012555780235672. distance: 1.8062403219947119
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 4.4137, Accuracy: 3189/8991 (35.4688%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 164/171 (95.9064%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   2,  Average loss: 0.0005, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   3,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   4,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   5,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   6,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   7,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   8,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   9,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Global model norm: 14.936978510608068.
Norm before scaling: 14.942243134242345. Distance: 0.4328677999375188
Total norm for 7 adversaries is: 14.942243134242345. distance: 0.4328677999375188
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.6721, Accuracy: 6898/8991 (76.7212%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0012, Accuracy: 428/436 (98.1651%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   2,  Average loss: 0.0005, Accuracy: 430/436 (98.6239%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   3,  Average loss: 0.0005, Accuracy: 431/436 (98.8532%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   7,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   8,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch  10,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Global model norm: 14.936978510608068.
Norm before scaling: 14.984059319537087. Distance: 0.9327420295920773
Total norm for 7 adversaries is: 14.984059319537087. distance: 0.9327420295920773
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.1278, Accuracy: 6663/8991 (74.1074%)
___Train Local_Simple,  epoch  30, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 697/705 (98.8652%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.6141, Accuracy: 3141/10000 (31.4100%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   1,  Average loss: 0.0029, Accuracy: 373/388 (96.1340%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   2,  Average loss: 0.0023, Accuracy: 376/388 (96.9072%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   3,  Average loss: 0.0008, Accuracy: 383/388 (98.7113%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   4,  Average loss: 0.0010, Accuracy: 384/388 (98.9691%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   5,  Average loss: 0.0008, Accuracy: 383/388 (98.7113%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   6,  Average loss: 0.0007, Accuracy: 384/388 (98.9691%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   7,  Average loss: 0.0004, Accuracy: 385/388 (99.2268%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   8,  Average loss: 0.0003, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   9,  Average loss: 0.0003, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch  10,  Average loss: 0.0003, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Global model norm: 14.936978510608068.
Norm before scaling: 14.907558167833649. Distance: 1.1181827726839366
Total norm for 7 adversaries is: 14.907558167833649. distance: 1.1181827726839366
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.4057, Accuracy: 5177/8991 (57.5798%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   1,  Average loss: 0.0013, Accuracy: 796/818 (97.3105%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   2,  Average loss: 0.0002, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   3,  Average loss: 0.0001, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 14.936978510608068.
Norm before scaling: 15.012844435578323. Distance: 1.6476934842080342
Total norm for 7 adversaries is: 15.012844435578323. distance: 1.6476934842080342
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 3.8628, Accuracy: 4301/8991 (47.8367%)
time spent on training: 141.754576921463
[foolsgold agg] training data poison_ratio: 0.5776473465394962  data num: [151, 1544, 1205, 2072, 688, 171, 436, 705, 388, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.5776473465394962
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.4943, Accuracy: 8579/10000 (85.7900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.1828, Accuracy: 8532/8991 (94.8949%)
Done in 301.3117570877075 sec.
Server Epoch:31 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
___Train Local_Simple,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0030, Accuracy: 716/762 (93.9633%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.4733, Accuracy: 4690/10000 (46.9000%), Attack Success Rate:0/10000(0.000)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0029, Accuracy: 251/263 (95.4373%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   2,  Average loss: 0.0016, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   3,  Average loss: 0.0011, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   4,  Average loss: 0.0010, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   5,  Average loss: 0.0008, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   6,  Average loss: 0.0005, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   7,  Average loss: 0.0004, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   8,  Average loss: 0.0003, Accuracy: 262/263 (99.6198%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   9,  Average loss: 0.0002, Accuracy: 262/263 (99.6198%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch  10,  Average loss: 0.0002, Accuracy: 262/263 (99.6198%), train_poison_data_count: 263
Global model norm: 14.967758623714287.
Norm before scaling: 14.977636833043425. Distance: 1.3283084967017162
Total norm for 7 adversaries is: 14.977636833043425. distance: 1.3283084967017162
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 2.5790, Accuracy: 3294/8991 (36.6366%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0001, Accuracy: 411/411 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.6706, Accuracy: 6457/10000 (64.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 85, internal_epoch   1,  Average loss: 0.0225, Accuracy: 4/4 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.5452, Accuracy: 8444/10000 (84.4400%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0019, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   2,  Average loss: 0.0005, Accuracy: 458/463 (98.9201%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   3,  Average loss: 0.0004, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   4,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   5,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   6,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   7,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   8,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   9,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch  10,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Global model norm: 14.967758623714287.
Norm before scaling: 14.937044910856542. Distance: 0.9696307946558558
Total norm for 7 adversaries is: 14.937044910856542. distance: 0.9696307946558558
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.2880, Accuracy: 5800/8991 (64.5090%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0033, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   2,  Average loss: 0.0013, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   3,  Average loss: 0.0010, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   4,  Average loss: 0.0010, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   7,  Average loss: 0.0003, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   8,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   9,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch  10,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 14.967758623714287.
Norm before scaling: 14.97399377260299. Distance: 0.41055420234739926
Total norm for 7 adversaries is: 14.97399377260299. distance: 0.41055420234739926
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.3915, Accuracy: 7933/8991 (88.2327%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   2,  Average loss: 0.0026, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   3,  Average loss: 0.0012, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   4,  Average loss: 0.0011, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   5,  Average loss: 0.0010, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   6,  Average loss: 0.0009, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   7,  Average loss: 0.0009, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   8,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   9,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch  10,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.967758623714287.
Norm before scaling: 14.970419645269425. Distance: 0.08965030867674514
Total norm for 7 adversaries is: 14.970419645269425. distance: 0.08965030867674514
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1779, Accuracy: 8535/8991 (94.9283%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0027, Accuracy: 59/63 (93.6508%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   2,  Average loss: 0.0006, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   4,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   5,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   6,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   7,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   8,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Global model norm: 14.967758623714287.
Norm before scaling: 14.97373035378986. Distance: 0.2851128349175795
Total norm for 7 adversaries is: 14.97373035378986. distance: 0.2851128349175795
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.2798, Accuracy: 8206/8991 (91.2690%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 423/428 (98.8318%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   2,  Average loss: 0.0002, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   3,  Average loss: 0.0001, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   4,  Average loss: 0.0001, Accuracy: 427/428 (99.7664%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   5,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 14.967758623714287.
Norm before scaling: 14.961492829934963. Distance: 0.9750063284644127
Total norm for 7 adversaries is: 14.961492829934963. distance: 0.9750063284644127
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 4.0822, Accuracy: 3620/8991 (40.2625%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   1,  Average loss: 0.0018, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   2,  Average loss: 0.0009, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   3,  Average loss: 0.0009, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   4,  Average loss: 0.0008, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   5,  Average loss: 0.0007, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   6,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   7,  Average loss: 0.0005, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   8,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   9,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch  10,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 14.967758623714287.
Norm before scaling: 14.97893469166183. Distance: 0.31334310287267236
Total norm for 7 adversaries is: 14.97893469166183. distance: 0.31334310287267236
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.2265, Accuracy: 8386/8991 (93.2710%)
time spent on training: 83.92835927009583
[foolsgold agg] training data poison_ratio: 0.5492148602068173  data num: [762, 263, 411, 4, 463, 84, 5, 63, 428, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.5492148602068173
[foolsgold agg] wv: [1.        1.        1.        0.0529452 1.        1.        0.0529452
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.4609, Accuracy: 8549/10000 (85.4900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.2016, Accuracy: 8478/8991 (94.2943%)
Done in 243.91735816001892 sec.
Server Epoch:32 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0047, Accuracy: 29/30 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5190, Accuracy: 8377/10000 (83.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.0012, Accuracy: 33/33 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4616, Accuracy: 8554/10000 (85.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 55, internal_epoch   1,  Average loss: 0.0022, Accuracy: 2686/2803 (95.8259%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.8003, Accuracy: 4862/10000 (48.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 70, internal_epoch   1,  Average loss: 0.0025, Accuracy: 545/569 (95.7821%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.7807, Accuracy: 7247/10000 (72.4700%), Attack Success Rate:1/10000(0.010)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0024, Accuracy: 971/1033 (93.9981%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   2,  Average loss: 0.0011, Accuracy: 1008/1033 (97.5799%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1020/1033 (98.7415%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1030/1033 (99.7096%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Global model norm: 14.976669987714173.
Norm before scaling: 15.109841561436664. Distance: 1.9497051969844865
Total norm for 2 adversaries is: 15.109841561436664. distance: 1.9497051969844865
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 2.5509, Accuracy: 3973/8991 (44.1886%)
___Train Local_Simple,  epoch  32, local model 90, internal_epoch   1,  Average loss: 0.0019, Accuracy: 735/768 (95.7031%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.6101, Accuracy: 3933/10000 (39.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 178/182 (97.8022%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5478, Accuracy: 8280/10000 (82.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 33/34 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5824, Accuracy: 8552/10000 (85.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 67, internal_epoch   1,  Average loss: 0.0062, Accuracy: 504/568 (88.7324%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.8888, Accuracy: 5892/10000 (58.9200%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0005, Accuracy: 2160/2180 (99.0826%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   2,  Average loss: 0.0001, Accuracy: 2176/2180 (99.8165%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2176/2180 (99.8165%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   4,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   5,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Global model norm: 14.976669987714173.
Norm before scaling: 14.782850505480424. Distance: 1.3787690005199345
Total norm for 2 adversaries is: 14.782850505480424. distance: 1.3787690005199345
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 2.0782, Accuracy: 5726/8991 (63.6859%)
time spent on training: 94.72332692146301
[foolsgold agg] training data poison_ratio: 0.39182926829268294  data num: [30, 33, 2803, 569, 1033, 768, 182, 34, 568, 2180]
[foolsgold agg] considering poison per batch poison_fraction: 0.39182926829268294
[foolsgold agg] wv: [0.94761937 1.         1.         0.26091771 0.26091771 1.
 0.94761937 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.3598, Accuracy: 8614/10000 (86.1400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.1996, Accuracy: 8503/8991 (94.5724%)
Done in 251.89306712150574 sec.
Server Epoch:33 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
___Train Local_Simple,  epoch  33, local model 77, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1507/1544 (97.6036%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.9262, Accuracy: 6245/10000 (62.4500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1374/1437 (95.6159%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.2837, Accuracy: 4898/10000 (48.9800%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   1,  Average loss: 0.0007, Accuracy: 2044/2072 (98.6486%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   2,  Average loss: 0.0004, Accuracy: 2059/2072 (99.3726%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2066/2072 (99.7104%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2068/2072 (99.8069%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2067/2072 (99.7587%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2069/2072 (99.8552%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2071/2072 (99.9517%), train_poison_data_count: 2072
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2071/2072 (99.9517%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2071/2072 (99.9517%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2071/2072 (99.9517%), train_poison_data_count: 2072
Global model norm: 14.988224239206144.
Norm before scaling: 14.85158099354451. Distance: 1.493229527157954
Total norm for 4 adversaries is: 14.85158099354451. distance: 1.493229527157954
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 1.4899, Accuracy: 5247/8991 (58.3584%)
___Train Local_Simple,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 504/568 (88.7324%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.9246, Accuracy: 5832/10000 (58.3200%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0023, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   2,  Average loss: 0.0010, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   3,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   4,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   5,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 14.988224239206144.
Norm before scaling: 14.99539520790987. Distance: 0.2164438139335721
Total norm for 4 adversaries is: 14.99539520790987. distance: 0.2164438139335721
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.2303, Accuracy: 8377/8991 (93.1709%)
___Train Local_Simple,  epoch  33, local model 97, internal_epoch   1,  Average loss: 0.0503, Accuracy: 4/5 (80.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.1943, Accuracy: 7750/10000 (77.5000%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0012, Accuracy: 231/237 (97.4684%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   2,  Average loss: 0.0006, Accuracy: 234/237 (98.7342%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   3,  Average loss: 0.0002, Accuracy: 236/237 (99.5781%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   4,  Average loss: 0.0002, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   5,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   6,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Global model norm: 14.988224239206144.
Norm before scaling: 15.002672084589944. Distance: 0.5139716546391807
Total norm for 4 adversaries is: 15.002672084589944. distance: 0.5139716546391807
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.7607, Accuracy: 6826/8991 (75.9204%)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   1,  Average loss: 0.0024, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   2,  Average loss: 0.0008, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   3,  Average loss: 0.0004, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   4,  Average loss: 0.0004, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   5,  Average loss: 0.0004, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   6,  Average loss: 0.0003, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   7,  Average loss: 0.0003, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   8,  Average loss: 0.0003, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   9,  Average loss: 0.0003, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch  10,  Average loss: 0.0003, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Global model norm: 14.988224239206144.
Norm before scaling: 14.9931390966236. Distance: 0.19138340911043467
Total norm for 4 adversaries is: 14.9931390966236. distance: 0.19138340911043467
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.2354, Accuracy: 8393/8991 (93.3489%)
___Train Local_Simple,  epoch  33, local model 70, internal_epoch   1,  Average loss: 0.0029, Accuracy: 529/569 (92.9701%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5706, Accuracy: 7861/10000 (78.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0031, Accuracy: 29/30 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3963, Accuracy: 8506/10000 (85.0600%), Attack Success Rate:1/10000(0.010)
time spent on training: 84.37980008125305
[foolsgold agg] training data poison_ratio: 0.3653728606356968  data num: [1544, 1437, 2072, 568, 48, 5, 237, 34, 569, 30]
[foolsgold agg] considering poison per batch poison_fraction: 0.3653728606356968
[foolsgold agg] wv: [0.        1.        1.        0.        1.        1.        1.
 0.4673094 1.        0.4673094]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.4237, Accuracy: 8600/10000 (86.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.1812, Accuracy: 8524/8991 (94.8059%)
Done in 241.39351987838745 sec.
Server Epoch:34 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 566/578 (97.9239%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   2,  Average loss: 0.0007, Accuracy: 568/578 (98.2699%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   3,  Average loss: 0.0002, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   4,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   8,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 15.001913838682123.
Norm before scaling: 15.030922614515541. Distance: 0.889590683369941
Total norm for 7 adversaries is: 15.030922614515541. distance: 0.889590683369941
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1.0324, Accuracy: 6301/8991 (70.0812%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0018, Accuracy: 189/196 (96.4286%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   2,  Average loss: 0.0002, Accuracy: 195/196 (99.4898%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   3,  Average loss: 0.0031, Accuracy: 189/196 (96.4286%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   4,  Average loss: 0.0004, Accuracy: 194/196 (98.9796%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   5,  Average loss: 0.0001, Accuracy: 196/196 (100.0000%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   6,  Average loss: 0.0001, Accuracy: 195/196 (99.4898%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   7,  Average loss: 0.0002, Accuracy: 195/196 (99.4898%), train_poison_data_count: 196
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   8,  Average loss: 0.0002, Accuracy: 195/196 (99.4898%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   9,  Average loss: 0.0002, Accuracy: 195/196 (99.4898%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch  10,  Average loss: 0.0002, Accuracy: 195/196 (99.4898%), train_poison_data_count: 196
Global model norm: 15.001913838682123.
Norm before scaling: 15.006235988090866. Distance: 0.7397402520783166
Total norm for 7 adversaries is: 15.006235988090866. distance: 0.7397402520783166
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.6795, Accuracy: 7455/8991 (82.9162%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0026, Accuracy: 482/509 (94.6955%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0012, Accuracy: 493/509 (96.8566%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 506/509 (99.4106%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Global model norm: 15.001913838682123.
Norm before scaling: 15.061649535929458. Distance: 1.584863609197814
Total norm for 7 adversaries is: 15.061649535929458. distance: 1.584863609197814
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 3.4846, Accuracy: 3143/8991 (34.9572%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 149/151 (98.6755%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 15.001913838682123.
Norm before scaling: 14.999763486904916. Distance: 0.41462025773490707
Total norm for 7 adversaries is: 14.999763486904916. distance: 0.41462025773490707
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.6198, Accuracy: 7509/8991 (83.5169%)
___Train Local_Simple,  epoch  34, local model 71, internal_epoch   1,  Average loss: 0.0034, Accuracy: 322/342 (94.1520%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.9155, Accuracy: 7520/10000 (75.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 60, internal_epoch   1,  Average loss: 0.0009, Accuracy: 394/399 (98.7469%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 7.0893, Accuracy: 2361/10000 (23.6100%), Attack Success Rate:2/10000(0.020)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0024, Accuracy: 60/63 (95.2381%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   2,  Average loss: 0.0006, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   4,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   5,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Global model norm: 15.001913838682123.
Norm before scaling: 15.008447430120656. Distance: 0.2596621056131846
Total norm for 7 adversaries is: 15.008447430120656. distance: 0.2596621056131846
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2504, Accuracy: 8296/8991 (92.2700%)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0014, Accuracy: 730/750 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.7392, Accuracy: 7379/10000 (73.7900%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1288/1311 (98.2456%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1303/1311 (99.3898%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Global model norm: 15.001913838682123.
Norm before scaling: 14.919543850141299. Distance: 1.676891039452779
Total norm for 7 adversaries is: 14.919543850141299. distance: 1.676891039452779
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 3.8597, Accuracy: 3290/8991 (36.5921%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   1,  Average loss: 0.0013, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   3,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   7,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   8,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   9,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch  10,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.001913838682123.
Norm before scaling: 15.01247091044356. Distance: 0.35934338223234247
Total norm for 7 adversaries is: 15.01247091044356. distance: 0.35934338223234247
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.3624, Accuracy: 7975/8991 (88.6998%)
time spent on training: 105.52359890937805
[foolsgold agg] training data poison_ratio: 0.663203072057827  data num: [578, 196, 509, 151, 342, 399, 63, 750, 1311, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.663203072057827
[foolsgold agg] wv: [1.        0.9920412 1.        1.        0.9920412 1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.5198, Accuracy: 8594/10000 (85.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.1652, Accuracy: 8544/8991 (95.0284%)
Done in 279.86455392837524 sec.
Server Epoch:35 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   1,  Average loss: 0.0007, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 15.020635525075111.
Norm before scaling: 15.01861282139937. Distance: 0.3496252407970561
Total norm for 6 adversaries is: 15.01861282139937. distance: 0.3496252407970561
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.4793, Accuracy: 7737/8991 (86.0527%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 295/304 (97.0395%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   2,  Average loss: 0.0011, Accuracy: 296/304 (97.3684%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   3,  Average loss: 0.0009, Accuracy: 297/304 (97.6974%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   4,  Average loss: 0.0006, Accuracy: 300/304 (98.6842%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   5,  Average loss: 0.0003, Accuracy: 302/304 (99.3421%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   6,  Average loss: 0.0002, Accuracy: 302/304 (99.3421%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   7,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   8,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Global model norm: 15.020635525075111.
Norm before scaling: 15.035334866761833. Distance: 0.8014780130160811
Total norm for 6 adversaries is: 15.035334866761833. distance: 0.8014780130160811
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.3654, Accuracy: 5889/8991 (65.4988%)
___Train Local_Simple,  epoch  35, local model 53, internal_epoch   1,  Average loss: 0.0010, Accuracy: 448/456 (98.2456%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.6862, Accuracy: 5634/10000 (56.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.0077, Accuracy: 24/25 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.5365, Accuracy: 8578/10000 (85.7800%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0012, Accuracy: 633/644 (98.2919%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   2,  Average loss: 0.0010, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   3,  Average loss: 0.0005, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   4,  Average loss: 0.0003, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   5,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   8,  Average loss: 0.0002, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch  10,  Average loss: 0.0002, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 15.020635525075111.
Norm before scaling: 15.042042115545993. Distance: 1.1624424048481858
Total norm for 6 adversaries is: 15.042042115545993. distance: 1.1624424048481858
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.3213, Accuracy: 6602/8991 (73.4290%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   1,  Average loss: 0.0018, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   2,  Average loss: 0.0008, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   3,  Average loss: 0.0005, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   4,  Average loss: 0.0005, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   5,  Average loss: 0.0005, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   6,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   7,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   8,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   9,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch  10,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.020635525075111.
Norm before scaling: 15.031542356824199. Distance: 0.32352194536009676
Total norm for 6 adversaries is: 15.031542356824199. distance: 0.32352194536009676
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.2237, Accuracy: 8376/8991 (93.1598%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0022, Accuracy: 988/1033 (95.6438%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   2,  Average loss: 0.0011, Accuracy: 1012/1033 (97.9671%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1022/1033 (98.9351%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1030/1033 (99.7096%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1031/1033 (99.8064%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1030/1033 (99.7096%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Global model norm: 15.020635525075111.
Norm before scaling: 15.137149691446208. Distance: 1.9834596820731059
Total norm for 6 adversaries is: 15.137149691446208. distance: 1.9834596820731059
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 2.9823, Accuracy: 4106/8991 (45.6679%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0008, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   2,  Average loss: 0.0005, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   3,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   4,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   5,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   6,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   7,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 15.020635525075111.
Norm before scaling: 15.028223569740682. Distance: 0.19334686123206893
Total norm for 6 adversaries is: 15.028223569740682. distance: 0.19334686123206893
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1967, Accuracy: 8457/8991 (94.0607%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0018, Accuracy: 1283/1326 (96.7572%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.9566, Accuracy: 3897/10000 (38.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 98, internal_epoch   1,  Average loss: 0.0018, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.5190, Accuracy: 8600/10000 (86.0000%), Attack Success Rate:0/10000(0.000)
time spent on training: 88.83116912841797
[foolsgold agg] training data poison_ratio: 0.5638681741640607  data num: [151, 304, 456, 25, 644, 128, 1033, 84, 1326, 6]
[foolsgold agg] considering poison per batch poison_fraction: 0.5638681741640607
[foolsgold agg] wv: [1.         0.31769178 1.         0.59783654 1.         1.
 1.         0.31769178 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.5782, Accuracy: 8616/10000 (86.1600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.1506, Accuracy: 8582/8991 (95.4510%)
Done in 247.22022008895874 sec.
Server Epoch:36 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  36, local model 82, internal_epoch   1,  Average loss: 0.0013, Accuracy: 111/114 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5661, Accuracy: 8311/10000 (83.1100%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 456/463 (98.4881%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   2,  Average loss: 0.0014, Accuracy: 456/463 (98.4881%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   3,  Average loss: 0.0003, Accuracy: 460/463 (99.3521%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   4,  Average loss: 0.0003, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   5,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   6,  Average loss: 0.0006, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   7,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   8,  Average loss: 0.0001, Accuracy: 463/463 (100.0000%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   9,  Average loss: 0.0001, Accuracy: 463/463 (100.0000%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch  10,  Average loss: 0.0001, Accuracy: 463/463 (100.0000%), train_poison_data_count: 463
Global model norm: 15.042453960128253.
Norm before scaling: 15.012356564156574. Distance: 1.0342561082998456
Total norm for 5 adversaries is: 15.012356564156574. distance: 1.0342561082998456
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 1.6584, Accuracy: 5748/8991 (63.9306%)
___Train Local_Simple,  epoch  36, local model 79, internal_epoch   1,  Average loss: 0.0067, Accuracy: 24/25 (96.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6034, Accuracy: 8602/10000 (86.0200%), Attack Success Rate:0/10000(0.000)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0024, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   2,  Average loss: 0.0006, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   3,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 15.042453960128253.
Norm before scaling: 15.046180843768907. Distance: 0.18322003658623065
Total norm for 5 adversaries is: 15.046180843768907. distance: 0.18322003658623065
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1701, Accuracy: 8514/8991 (94.6947%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   1,  Average loss: 0.0008, Accuracy: 2482/2519 (98.5312%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   2,  Average loss: 0.0003, Accuracy: 2506/2519 (99.4839%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   3,  Average loss: 0.0002, Accuracy: 2509/2519 (99.6030%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2513/2519 (99.7618%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2516/2519 (99.8809%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2516/2519 (99.8809%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2517/2519 (99.9206%), train_poison_data_count: 2519
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2517/2519 (99.9206%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2517/2519 (99.9206%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2517/2519 (99.9206%), train_poison_data_count: 2519
Global model norm: 15.042453960128253.
Norm before scaling: 14.89953129178377. Distance: 1.5867148312436223
Total norm for 5 adversaries is: 14.89953129178377. distance: 1.5867148312436223
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 1.0499, Accuracy: 6612/8991 (73.5402%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 42/47 (89.3617%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   2,  Average loss: 0.0006, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   3,  Average loss: 0.0005, Accuracy: 46/47 (97.8723%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   4,  Average loss: 0.0006, Accuracy: 46/47 (97.8723%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   5,  Average loss: 0.0006, Accuracy: 46/47 (97.8723%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   6,  Average loss: 0.0005, Accuracy: 46/47 (97.8723%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   7,  Average loss: 0.0005, Accuracy: 46/47 (97.8723%), train_poison_data_count: 47
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   8,  Average loss: 0.0004, Accuracy: 46/47 (97.8723%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   9,  Average loss: 0.0003, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch  10,  Average loss: 0.0003, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Global model norm: 15.042453960128253.
Norm before scaling: 15.044905013662174. Distance: 0.35081544552247274
Total norm for 5 adversaries is: 15.044905013662174. distance: 0.35081544552247274
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.4391, Accuracy: 7721/8991 (85.8748%)
___Train Local_Simple,  epoch  36, local model 89, internal_epoch   1,  Average loss: 0.0323, Accuracy: 40/69 (57.9710%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.8420, Accuracy: 5574/10000 (55.7400%), Attack Success Rate:1/10000(0.010)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   1,  Average loss: 0.0009, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   3,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   7,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   8,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   9,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch  10,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.042453960128253.
Norm before scaling: 15.050378250995783. Distance: 0.30576422759458083
Total norm for 5 adversaries is: 15.050378250995783. distance: 0.30576422759458083
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.3033, Accuracy: 8135/8991 (90.4794%)
___Train Local_Simple,  epoch  36, local model 70, internal_epoch   1,  Average loss: 0.0017, Accuracy: 547/569 (96.1336%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.1431, Accuracy: 6972/10000 (69.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 77, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1511/1544 (97.8627%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.4828, Accuracy: 5820/10000 (58.2000%), Attack Success Rate:0/10000(0.000)
time spent on training: 104.57511281967163
[foolsgold agg] training data poison_ratio: 0.5784598619687613  data num: [114, 463, 25, 28, 2519, 47, 69, 128, 569, 1544]
[foolsgold agg] considering poison per batch poison_fraction: 0.5784598619687613
[foolsgold agg] wv: [0.36417227 1.         1.         1.         1.         1.
 0.         1.         0.36417227 0.        ]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.6141, Accuracy: 8639/10000 (86.3900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.1415, Accuracy: 8612/8991 (95.7847%)
Done in 264.5622420310974 sec.
Server Epoch:37 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0013, Accuracy: 661/678 (97.4926%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   2,  Average loss: 0.0006, Accuracy: 671/678 (98.9676%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   3,  Average loss: 0.0003, Accuracy: 674/678 (99.4100%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Global model norm: 15.055010821320526.
Norm before scaling: 15.045642837984794. Distance: 1.2982440294803907
Total norm for 7 adversaries is: 15.045642837984794. distance: 1.2982440294803907
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 3.3149, Accuracy: 4315/8991 (47.9924%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0007, Accuracy: 806/818 (98.5330%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0002, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   3,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   4,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   5,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   6,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   7,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   8,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 15.055010821320526.
Norm before scaling: 15.04180322023297. Distance: 1.0450935008915585
Total norm for 7 adversaries is: 15.04180322023297. distance: 1.0450935008915585
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 2.5994, Accuracy: 4772/8991 (53.0753%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   1,  Average loss: 0.0010, Accuracy: 634/644 (98.4472%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   2,  Average loss: 0.0007, Accuracy: 635/644 (98.6025%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   3,  Average loss: 0.0002, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   4,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   7,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   8,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   9,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 15.055010821320526.
Norm before scaling: 15.04785660090001. Distance: 0.9969076085512314
Total norm for 7 adversaries is: 15.04785660090001. distance: 0.9969076085512314
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.5264, Accuracy: 6205/8991 (69.0135%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0018, Accuracy: 484/509 (95.0884%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0008, Accuracy: 501/509 (98.4283%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0008, Accuracy: 499/509 (98.0354%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 506/509 (99.4106%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 505/509 (99.2141%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 506/509 (99.4106%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Global model norm: 15.055010821320526.
Norm before scaling: 15.113936989037429. Distance: 1.502901846644545
Total norm for 7 adversaries is: 15.113936989037429. distance: 1.502901846644545
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 4.2617, Accuracy: 2931/8991 (32.5993%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1034/1046 (98.8528%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1044/1046 (99.8088%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Global model norm: 15.055010821320526.
Norm before scaling: 15.010493867540166. Distance: 0.9349725987504252
Total norm for 7 adversaries is: 15.010493867540166. distance: 0.9349725987504252
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.2029, Accuracy: 6477/8991 (72.0387%)
___Train Local_Simple,  epoch  37, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 699/705 (99.1489%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 5.2528, Accuracy: 2266/10000 (22.6600%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.1086, Accuracy: 9/29 (31.0345%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.3254, Accuracy: 8263/10000 (82.6300%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   2,  Average loss: 0.0011, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   3,  Average loss: 0.0007, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   4,  Average loss: 0.0007, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   5,  Average loss: 0.0007, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   6,  Average loss: 0.0006, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   7,  Average loss: 0.0006, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   8,  Average loss: 0.0006, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   9,  Average loss: 0.0005, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch  10,  Average loss: 0.0005, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Global model norm: 15.055010821320526.
Norm before scaling: 15.055410655795757. Distance: 0.0447127694721636
Total norm for 7 adversaries is: 15.055410655795757. distance: 0.0447127694721636
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1425, Accuracy: 8614/8991 (95.8069%)
___Train Local_Simple,  epoch  37, local model 62, internal_epoch   1,  Average loss: 0.0112, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5771, Accuracy: 8651/10000 (86.5100%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0015, Accuracy: 257/264 (97.3485%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   2,  Average loss: 0.0019, Accuracy: 252/264 (95.4545%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   3,  Average loss: 0.0005, Accuracy: 263/264 (99.6212%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   4,  Average loss: 0.0004, Accuracy: 263/264 (99.6212%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   5,  Average loss: 0.0006, Accuracy: 262/264 (99.2424%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   6,  Average loss: 0.0002, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   9,  Average loss: 0.0002, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Global model norm: 15.055010821320526.
Norm before scaling: 15.065765153588647. Distance: 0.6850419752806564
Total norm for 7 adversaries is: 15.065765153588647. distance: 0.6850419752806564
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.4598, Accuracy: 7563/8991 (84.1175%)
time spent on training: 111.81575393676758
[foolsgold agg] training data poison_ratio: 0.8434375664752181  data num: [678, 818, 644, 509, 1046, 705, 29, 6, 2, 264]
[foolsgold agg] considering poison per batch poison_fraction: 0.8434375664752181
[foolsgold agg] wv: [0.         0.61652122 0.61652122 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.3278, Accuracy: 8668/10000 (86.6800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.1726, Accuracy: 8543/8991 (95.0172%)
Done in 272.32964396476746 sec.
Server Epoch:38 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1234/1259 (98.0143%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1250/1259 (99.2851%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Global model norm: 15.061411964722755.
Norm before scaling: 15.017708561380804. Distance: 1.4258571656801347
Total norm for 5 adversaries is: 15.017708561380804. distance: 1.4258571656801347
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.8010, Accuracy: 6944/8991 (77.2328%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1196/1232 (97.0779%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1218/1232 (98.8636%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1223/1232 (99.2695%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1227/1232 (99.5942%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1226/1232 (99.5130%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1228/1232 (99.6753%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1228/1232 (99.6753%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Global model norm: 15.061411964722755.
Norm before scaling: 15.056299476653088. Distance: 1.5675817630743667
Total norm for 5 adversaries is: 15.056299476653088. distance: 1.5675817630743667
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.1050, Accuracy: 6548/8991 (72.8284%)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0003, Accuracy: 33/33 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3286, Accuracy: 8667/10000 (86.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0016, Accuracy: 2256/2324 (97.0740%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.6365, Accuracy: 5870/10000 (58.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0016, Accuracy: 441/456 (96.7105%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.8349, Accuracy: 7120/10000 (71.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 724/750 (96.5333%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.8394, Accuracy: 6356/10000 (63.5600%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0022, Accuracy: 228/244 (93.4426%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   2,  Average loss: 0.0008, Accuracy: 239/244 (97.9508%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   3,  Average loss: 0.0010, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   4,  Average loss: 0.0008, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   5,  Average loss: 0.0006, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   6,  Average loss: 0.0005, Accuracy: 242/244 (99.1803%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   7,  Average loss: 0.0004, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   8,  Average loss: 0.0003, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   9,  Average loss: 0.0002, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch  10,  Average loss: 0.0002, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Global model norm: 15.061411964722755.
Norm before scaling: 15.073627081709216. Distance: 0.8378142920093943
Total norm for 5 adversaries is: 15.073627081709216. distance: 0.8378142920093943
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 2.0243, Accuracy: 4288/8991 (47.6921%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   1,  Average loss: 0.0019, Accuracy: 373/388 (96.1340%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   2,  Average loss: 0.0059, Accuracy: 380/388 (97.9381%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   3,  Average loss: 0.0050, Accuracy: 342/388 (88.1443%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   4,  Average loss: 0.0010, Accuracy: 377/388 (97.1649%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   5,  Average loss: 0.0006, Accuracy: 384/388 (98.9691%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   6,  Average loss: 0.0005, Accuracy: 383/388 (98.7113%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   7,  Average loss: 0.0005, Accuracy: 382/388 (98.4536%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   8,  Average loss: 0.0005, Accuracy: 384/388 (98.9691%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   9,  Average loss: 0.0004, Accuracy: 384/388 (98.9691%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch  10,  Average loss: 0.0004, Accuracy: 384/388 (98.9691%), train_poison_data_count: 388
Global model norm: 15.061411964722755.
Norm before scaling: 15.044509464075206. Distance: 1.3418982410594777
Total norm for 5 adversaries is: 15.044509464075206. distance: 1.3418982410594777
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.4307, Accuracy: 5848/8991 (65.0428%)
___Train Local_Simple,  epoch  38, local model 52, internal_epoch   1,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 12.5375, Accuracy: 1250/10000 (12.5000%), Attack Success Rate:13/10000(0.130)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0035, Accuracy: 90/94 (95.7447%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   2,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   3,  Average loss: 0.0003, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   4,  Average loss: 0.0007, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   6,  Average loss: 0.0005, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   8,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Global model norm: 15.061411964722755.
Norm before scaling: 15.071399892729358. Distance: 0.5015839283961776
Total norm for 5 adversaries is: 15.071399892729358. distance: 0.5015839283961776
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.6983, Accuracy: 7367/8991 (81.9375%)
time spent on training: 107.76894807815552
[foolsgold agg] training data poison_ratio: 0.42979291917167667  data num: [1259, 1232, 33, 2324, 456, 750, 244, 388, 705, 94]
[foolsgold agg] considering poison per batch poison_fraction: 0.42979291917167667
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.3670, Accuracy: 8662/10000 (86.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.1598, Accuracy: 8593/8991 (95.5734%)
Done in 269.22997188568115 sec.
Server Epoch:39 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0027, Accuracy: 958/1010 (94.8515%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   2,  Average loss: 0.0013, Accuracy: 987/1010 (97.7228%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1002/1010 (99.2079%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1005/1010 (99.5050%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1004/1010 (99.4059%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1005/1010 (99.5050%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1005/1010 (99.5050%), train_poison_data_count: 1010
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1006/1010 (99.6040%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1006/1010 (99.6040%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1006/1010 (99.6040%), train_poison_data_count: 1010
Global model norm: 15.083985765934482.
Norm before scaling: 15.249405646076628. Distance: 2.1133761287692288
Total norm for 7 adversaries is: 15.249405646076628. distance: 2.1133761287692288
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 3.0918, Accuracy: 4612/8991 (51.2957%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   1,  Average loss: 0.0018, Accuracy: 1162/1203 (96.5919%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1183/1203 (98.3375%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1191/1203 (99.0025%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1197/1203 (99.5012%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1201/1203 (99.8337%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1203/1203 (100.0000%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1202/1203 (99.9169%), train_poison_data_count: 1203
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1202/1203 (99.9169%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1203/1203 (100.0000%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1203/1203 (100.0000%), train_poison_data_count: 1203
Global model norm: 15.083985765934482.
Norm before scaling: 15.170636897538387. Distance: 1.5684058157575869
Total norm for 7 adversaries is: 15.170636897538387. distance: 1.5684058157575869
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.3642, Accuracy: 6596/8991 (73.3623%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   1,  Average loss: 0.0084, Accuracy: 26/28 (92.8571%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   2,  Average loss: 0.0003, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   3,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   4,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   5,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   6,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 15.083985765934482.
Norm before scaling: 15.095211234748579. Distance: 0.43085745277563936
Total norm for 7 adversaries is: 15.095211234748579. distance: 0.43085745277563936
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.2265, Accuracy: 8407/8991 (93.5046%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1034/1046 (98.8528%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1035/1046 (98.9484%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1044/1046 (99.8088%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   5,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Global model norm: 15.083985765934482.
Norm before scaling: 15.039594653734282. Distance: 0.9643853832385552
Total norm for 7 adversaries is: 15.039594653734282. distance: 0.9643853832385552
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.0293, Accuracy: 6783/8991 (75.4421%)
___Train Local_Simple,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1186/1205 (98.4232%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.0990, Accuracy: 6793/10000 (67.9300%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0008, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   2,  Average loss: 0.0005, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   3,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   4,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   5,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   6,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 15.083985765934482.
Norm before scaling: 15.086461931750733. Distance: 0.10945204592682709
Total norm for 7 adversaries is: 15.086461931750733. distance: 0.10945204592682709
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1749, Accuracy: 8520/8991 (94.7614%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   1,  Average loss: 0.0015, Accuracy: 423/436 (97.0183%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   2,  Average loss: 0.0004, Accuracy: 432/436 (99.0826%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   3,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   5,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   6,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Global model norm: 15.083985765934482.
Norm before scaling: 15.136311990502445. Distance: 1.2279607493126223
Total norm for 7 adversaries is: 15.136311990502445. distance: 1.2279607493126223
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 2.2869, Accuracy: 5933/8991 (65.9882%)
___Train Local_Simple,  epoch  39, local model 88, internal_epoch   1,  Average loss: 0.0062, Accuracy: 85/96 (88.5417%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.8791, Accuracy: 5158/10000 (51.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0669, Accuracy: 9/10 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4559, Accuracy: 8314/10000 (83.1400%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0118, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   2,  Average loss: 0.0006, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   3,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   4,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   7,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   8,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   9,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch  10,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 15.083985765934482.
Norm before scaling: 15.087734247773763. Distance: 0.22173147394877746
Total norm for 7 adversaries is: 15.087734247773763. distance: 0.22173147394877746
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.2217, Accuracy: 8434/8991 (93.8049%)
time spent on training: 116.85886120796204
[foolsgold agg] training data poison_ratio: 0.7422842539807352  data num: [1010, 1203, 28, 1046, 1205, 48, 436, 96, 10, 5]
[foolsgold agg] considering poison per batch poison_fraction: 0.7422842539807352
[foolsgold agg] wv: [1.         0.89633604 0.44563718 0.89633604 1.         1.
 0.44563718 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.3566, Accuracy: 8670/10000 (86.7000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.1495, Accuracy: 8607/8991 (95.7291%)
Done in 297.096862077713 sec.
Server Epoch:40 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0014, Accuracy: 634/648 (97.8395%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   2,  Average loss: 0.0008, Accuracy: 638/648 (98.4568%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   3,  Average loss: 0.0004, Accuracy: 642/648 (99.0741%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   4,  Average loss: 0.0003, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   5,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   6,  Average loss: 0.0001, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   8,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 15.106332403549295.
Norm before scaling: 15.177846847036946. Distance: 1.7471857603170555
Total norm for 3 adversaries is: 15.177846847036946. distance: 1.7471857603170555
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 1.7559, Accuracy: 6018/8991 (66.9336%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 422/428 (98.5981%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   3,  Average loss: 0.0001, Accuracy: 427/428 (99.7664%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   4,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   5,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 15.106332403549295.
Norm before scaling: 15.099634006940523. Distance: 0.9112994500597983
Total norm for 3 adversaries is: 15.099634006940523. distance: 0.9112994500597983
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 3.1115, Accuracy: 4399/8991 (48.9267%)
___Train Local_Simple,  epoch  40, local model 87, internal_epoch   1,  Average loss: 0.0003, Accuracy: 33/33 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3571, Accuracy: 8674/10000 (86.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 98, internal_epoch   1,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3569, Accuracy: 8673/10000 (86.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0008, Accuracy: 255/259 (98.4556%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.7895, Accuracy: 6548/10000 (65.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 83, internal_epoch   1,  Average loss: 0.0008, Accuracy: 735/750 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.5511, Accuracy: 5984/10000 (59.8400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 697/705 (98.8652%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 5.2566, Accuracy: 2199/10000 (21.9900%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  40, local model 90, internal_epoch   1,  Average loss: 0.0013, Accuracy: 751/768 (97.7865%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.8786, Accuracy: 4390/10000 (43.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 71, internal_epoch   1,  Average loss: 0.0019, Accuracy: 331/342 (96.7836%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.5626, Accuracy: 6318/10000 (63.1800%), Attack Success Rate:0/10000(0.000)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   2,  Average loss: 0.0010, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   3,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   4,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   7,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   8,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   9,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 15.106332403549295.
Norm before scaling: 15.114450353786284. Distance: 0.6401521519387088
Total norm for 3 adversaries is: 15.114450353786284. distance: 0.6401521519387088
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.5364, Accuracy: 7566/8991 (84.1508%)
time spent on training: 82.51300764083862
[foolsgold agg] training data poison_ratio: 0.28834203330847624  data num: [648, 428, 33, 6, 259, 750, 705, 768, 342, 84]
[foolsgold agg] considering poison per batch poison_fraction: 0.28834203330847624
[foolsgold agg] wv: [1.         0.38598118 1.         0.91530819 1.         1.
 1.         0.38598118 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.4001, Accuracy: 8678/10000 (86.7800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.1385, Accuracy: 8638/8991 (96.0739%)
Done in 273.7601888179779 sec.
Server Epoch:41 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
___Train Local_Simple,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 256/259 (98.8417%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6972, Accuracy: 7878/10000 (78.7800%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   1,  Average loss: 0.0013, Accuracy: 230/237 (97.0464%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   2,  Average loss: 0.0007, Accuracy: 234/237 (98.7342%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   3,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   4,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   5,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   6,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Global model norm: 15.112352363868656.
Norm before scaling: 15.122150247256041. Distance: 0.5684323083809304
Total norm for 6 adversaries is: 15.122150247256041. distance: 0.5684323083809304
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.7835, Accuracy: 7045/8991 (78.3561%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   1,  Average loss: 0.0004, Accuracy: 2169/2180 (99.4954%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   2,  Average loss: 0.0008, Accuracy: 2151/2180 (98.6697%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   3,  Average loss: 0.0002, Accuracy: 2173/2180 (99.6789%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2175/2180 (99.7706%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Global model norm: 15.112352363868656.
Norm before scaling: 15.023814307222072. Distance: 2.027108533440589
Total norm for 6 adversaries is: 15.023814307222072. distance: 2.027108533440589
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 1.5564, Accuracy: 5393/8991 (59.9822%)
___Train Local_Simple,  epoch  41, local model 95, internal_epoch   1,  Average loss: 0.0006, Accuracy: 29/29 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4042, Accuracy: 8671/10000 (86.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 83, internal_epoch   1,  Average loss: 0.0009, Accuracy: 735/750 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 2.1328, Accuracy: 5369/10000 (53.6900%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0012, Accuracy: 258/264 (97.7273%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   2,  Average loss: 0.0006, Accuracy: 262/264 (99.2424%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   3,  Average loss: 0.0002, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   4,  Average loss: 0.0002, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Global model norm: 15.112352363868656.
Norm before scaling: 15.111057381129266. Distance: 0.5088355103596208
Total norm for 6 adversaries is: 15.111057381129266. distance: 0.5088355103596208
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.4009, Accuracy: 7817/8991 (86.9425%)
___Train Local_Simple,  epoch  41, local model 55, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2668/2803 (95.1837%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.1845, Accuracy: 4883/10000 (48.8300%), Attack Success Rate:0/10000(0.000)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0020, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   2,  Average loss: 0.0006, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   3,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Global model norm: 15.112352363868656.
Norm before scaling: 15.11757509193046. Distance: 0.23820506112927994
Total norm for 6 adversaries is: 15.11757509193046. distance: 0.23820506112927994
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1824, Accuracy: 8476/8991 (94.2720%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1203/1232 (97.6461%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1218/1232 (98.8636%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1227/1232 (99.5942%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1228/1232 (99.6753%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Global model norm: 15.112352363868656.
Norm before scaling: 15.079955058144705. Distance: 1.3637078172574209
Total norm for 6 adversaries is: 15.079955058144705. distance: 1.3637078172574209
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.9450, Accuracy: 6976/8991 (77.5887%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   1,  Average loss: 0.0028, Accuracy: 294/310 (94.8387%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   2,  Average loss: 0.0023, Accuracy: 299/310 (96.4516%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   3,  Average loss: 0.0008, Accuracy: 303/310 (97.7419%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   4,  Average loss: 0.0005, Accuracy: 308/310 (99.3548%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   5,  Average loss: 0.0003, Accuracy: 309/310 (99.6774%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   6,  Average loss: 0.0003, Accuracy: 309/310 (99.6774%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   7,  Average loss: 0.0002, Accuracy: 309/310 (99.6774%), train_poison_data_count: 310
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   8,  Average loss: 0.0002, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   9,  Average loss: 0.0002, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch  10,  Average loss: 0.0002, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Global model norm: 15.112352363868656.
Norm before scaling: 15.118779187846464. Distance: 1.138097392401487
Total norm for 6 adversaries is: 15.118779187846464. distance: 1.138097392401487
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.8311, Accuracy: 6460/8991 (71.8496%)
time spent on training: 118.83669018745422
[foolsgold agg] training data poison_ratio: 0.5273778762150855  data num: [259, 237, 2180, 29, 750, 264, 2803, 63, 1232, 310]
[foolsgold agg] considering poison per batch poison_fraction: 0.5273778762150855
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.4918, Accuracy: 8677/10000 (86.7700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.1320, Accuracy: 8650/8991 (96.2073%)
Done in 276.116247177124 sec.
Server Epoch:42 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 33/33 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4928, Accuracy: 8679/10000 (86.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1189/1205 (98.6722%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.4827, Accuracy: 6000/10000 (60.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 89, internal_epoch   1,  Average loss: 0.0212, Accuracy: 43/69 (62.3188%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.6213, Accuracy: 8033/10000 (80.3300%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   3,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.142578502877914.
Norm before scaling: 15.145286385771358. Distance: 0.16158925344990238
Total norm for 4 adversaries is: 15.145286385771358. distance: 0.16158925344990238
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1911, Accuracy: 8483/8991 (94.3499%)
___Train Local_Simple,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0012, Accuracy: 66/68 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4869, Accuracy: 8638/10000 (86.3800%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 667/688 (96.9477%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   2,  Average loss: 0.0009, Accuracy: 676/688 (98.2558%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   3,  Average loss: 0.0009, Accuracy: 675/688 (98.1105%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   4,  Average loss: 0.0003, Accuracy: 685/688 (99.5640%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 15.142578502877914.
Norm before scaling: 15.17597681260738. Distance: 1.389635913012341
Total norm for 4 adversaries is: 15.17597681260738. distance: 1.389635913012341
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 2.3325, Accuracy: 4348/8991 (48.3595%)
___Train Local_Simple,  epoch  42, local model 92, internal_epoch   1,  Average loss: 0.0004, Accuracy: 200/202 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.0992, Accuracy: 7398/10000 (73.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 62, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4894, Accuracy: 8669/10000 (86.6900%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1289/1311 (98.3219%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1306/1311 (99.6186%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   4,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Global model norm: 15.142578502877914.
Norm before scaling: 15.059943397689167. Distance: 1.7316649287450376
Total norm for 4 adversaries is: 15.059943397689167. distance: 1.7316649287450376
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 2.6551, Accuracy: 4493/8991 (49.9722%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1206/1232 (97.8896%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1220/1232 (99.0260%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1225/1232 (99.4318%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1230/1232 (99.8377%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Global model norm: 15.142578502877914.
Norm before scaling: 15.107291960697065. Distance: 1.4003154569533767
Total norm for 4 adversaries is: 15.107291960697065. distance: 1.4003154569533767
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 1.1482, Accuracy: 6993/8991 (77.7778%)
time spent on training: 100.64626502990723
[foolsgold agg] training data poison_ratio: 0.6802349129202107  data num: [33, 1205, 69, 128, 68, 688, 202, 2, 1311, 1232]
[foolsgold agg] considering poison per batch poison_fraction: 0.6802349129202107
[foolsgold agg] wv: [1.         0.14550332 1.         1.         0.         1.
 0.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.3717, Accuracy: 8715/10000 (87.1500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.1378, Accuracy: 8648/8991 (96.1851%)
Done in 282.6055443286896 sec.
Server Epoch:43 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   1,  Average loss: 0.0007, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   2,  Average loss: 0.0002, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   3,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   4,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   5,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   6,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   7,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Global model norm: 15.15469648127118.
Norm before scaling: 15.14919143382355. Distance: 0.3749925493453867
Total norm for 5 adversaries is: 15.14919143382355. distance: 0.3749925493453867
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.4459, Accuracy: 7825/8991 (87.0315%)
___Train Local_Simple,  epoch  43, local model 78, internal_epoch   1,  Average loss: 0.0017, Accuracy: 2245/2324 (96.6007%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.0476, Accuracy: 6542/10000 (65.4200%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1292/1311 (98.5507%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1305/1311 (99.5423%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   4,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Global model norm: 15.15469648127118.
Norm before scaling: 15.044737667029178. Distance: 1.4449742101724012
Total norm for 5 adversaries is: 15.044737667029178. distance: 1.4449742101724012
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 2.5421, Accuracy: 4527/8991 (50.3504%)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0012, Accuracy: 260/264 (98.4848%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   2,  Average loss: 0.0005, Accuracy: 263/264 (99.6212%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   3,  Average loss: 0.0003, Accuracy: 263/264 (99.6212%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   4,  Average loss: 0.0003, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Global model norm: 15.15469648127118.
Norm before scaling: 15.161862181781496. Distance: 0.6412862760756662
Total norm for 5 adversaries is: 15.161862181781496. distance: 0.6412862760756662
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.4071, Accuracy: 7863/8991 (87.4541%)
___Train Local_Simple,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0566, Accuracy: 9/10 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5125, Accuracy: 8224/10000 (82.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 75, internal_epoch   1,  Average loss: 0.0016, Accuracy: 484/497 (97.3843%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 8.9480, Accuracy: 3253/10000 (32.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0031, Accuracy: 29/30 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4071, Accuracy: 8614/10000 (86.1400%), Attack Success Rate:0/10000(0.000)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1245/1259 (98.8880%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1255/1259 (99.6823%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Global model norm: 15.15469648127118.
Norm before scaling: 15.061686007083555. Distance: 0.9455455146054206
Total norm for 5 adversaries is: 15.061686007083555. distance: 0.9455455146054206
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.8622, Accuracy: 7234/8991 (80.4582%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   1,  Average loss: 0.0040, Accuracy: 43/47 (91.4894%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   3,  Average loss: 0.0002, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   4,  Average loss: 0.0002, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   5,  Average loss: 0.0002, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   6,  Average loss: 0.0002, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   7,  Average loss: 0.0002, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   8,  Average loss: 0.0002, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   9,  Average loss: 0.0002, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch  10,  Average loss: 0.0002, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Global model norm: 15.15469648127118.
Norm before scaling: 15.157277369335713. Distance: 0.3112130846399814
Total norm for 5 adversaries is: 15.157277369335713. distance: 0.3112130846399814
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.3471, Accuracy: 8038/8991 (89.4005%)
___Train Local_Simple,  epoch  43, local model 90, internal_epoch   1,  Average loss: 0.0011, Accuracy: 755/768 (98.3073%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.0687, Accuracy: 3516/10000 (35.1600%), Attack Success Rate:0/10000(0.000)
time spent on training: 120.33089780807495
[foolsgold agg] training data poison_ratio: 0.4574674839288384  data num: [179, 2324, 1311, 264, 10, 497, 30, 1259, 47, 768]
[foolsgold agg] considering poison per batch poison_fraction: 0.4574674839288384
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.3934, Accuracy: 8706/10000 (87.0600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.1389, Accuracy: 8637/8991 (96.0627%)
Done in 299.63662910461426 sec.
Server Epoch:44 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1794/1839 (97.5530%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1825/1839 (99.2387%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1832/1839 (99.6194%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1832/1839 (99.6194%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1834/1839 (99.7281%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1836/1839 (99.8369%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Global model norm: 15.16491275469206.
Norm before scaling: 15.167788677143816. Distance: 2.1293100516555925
Total norm for 7 adversaries is: 15.167788677143816. distance: 2.1293100516555925
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.9443, Accuracy: 5811/8991 (64.6313%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0005, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   2,  Average loss: 0.0003, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   3,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   4,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 15.16491275469206.
Norm before scaling: 15.167423494899614. Distance: 0.15550374998120112
Total norm for 7 adversaries is: 15.167423494899614. distance: 0.15550374998120112
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1535, Accuracy: 8581/8991 (95.4399%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0004, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   3,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   4,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   5,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   6,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   7,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Global model norm: 15.16491275469206.
Norm before scaling: 15.159714890670148. Distance: 0.28025013630733525
Total norm for 7 adversaries is: 15.159714890670148. distance: 0.28025013630733525
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.3135, Accuracy: 8156/8991 (90.7129%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0022, Accuracy: 250/263 (95.0570%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   2,  Average loss: 0.0014, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   3,  Average loss: 0.0008, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   4,  Average loss: 0.0007, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   5,  Average loss: 0.0005, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   6,  Average loss: 0.0003, Accuracy: 261/263 (99.2395%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   7,  Average loss: 0.0002, Accuracy: 262/263 (99.6198%), train_poison_data_count: 263
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   8,  Average loss: 0.0001, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   9,  Average loss: 0.0001, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch  10,  Average loss: 0.0001, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Global model norm: 15.16491275469206.
Norm before scaling: 15.17307428399199. Distance: 1.1612933202738167
Total norm for 7 adversaries is: 15.17307428399199. distance: 1.1612933202738167
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.6716, Accuracy: 5233/8991 (58.2026%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1929/1982 (97.3259%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1963/1982 (99.0414%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1978/1982 (99.7982%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1979/1982 (99.8486%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1979/1982 (99.8486%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1979/1982 (99.8486%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1979/1982 (99.8486%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1979/1982 (99.8486%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1980/1982 (99.8991%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1980/1982 (99.8991%), train_poison_data_count: 1982
Global model norm: 15.16491275469206.
Norm before scaling: 15.096021398386625. Distance: 1.9195343899419781
Total norm for 7 adversaries is: 15.096021398386625. distance: 1.9195343899419781
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 3.2651, Accuracy: 3626/8991 (40.3292%)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0018, Accuracy: 231/244 (94.6721%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   2,  Average loss: 0.0005, Accuracy: 242/244 (99.1803%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   3,  Average loss: 0.0008, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   4,  Average loss: 0.0007, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   5,  Average loss: 0.0005, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   6,  Average loss: 0.0004, Accuracy: 242/244 (99.1803%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   7,  Average loss: 0.0003, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   8,  Average loss: 0.0002, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   9,  Average loss: 0.0002, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch  10,  Average loss: 0.0002, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Global model norm: 15.16491275469206.
Norm before scaling: 15.177332610537942. Distance: 0.7669169755063411
Total norm for 7 adversaries is: 15.177332610537942. distance: 0.7669169755063411
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.9044, Accuracy: 4721/8991 (52.5081%)
___Train Local_Simple,  epoch  44, local model 65, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1285/1326 (96.9080%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.4639, Accuracy: 3494/10000 (34.9400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  44, local model 66, internal_epoch   1,  Average loss: 0.0015, Accuracy: 671/681 (98.5316%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.6616, Accuracy: 5588/10000 (55.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1180/1205 (97.9253%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.9335, Accuracy: 6731/10000 (67.3100%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1003/1033 (97.0958%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   2,  Average loss: 0.0016, Accuracy: 997/1033 (96.5150%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   3,  Average loss: 0.0008, Accuracy: 1016/1033 (98.3543%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1030/1033 (99.7096%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1030/1033 (99.7096%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Global model norm: 15.16491275469206.
Norm before scaling: 15.274930993156831. Distance: 1.9790467945405128
Total norm for 7 adversaries is: 15.274930993156831. distance: 1.9790467945405128
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.7569, Accuracy: 5136/8991 (57.1238%)
time spent on training: 132.85985708236694
[foolsgold agg] training data poison_ratio: 0.6364870982344952  data num: [1839, 84, 179, 263, 1982, 244, 1326, 681, 1205, 1033]
[foolsgold agg] considering poison per batch poison_fraction: 0.6364870982344952
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.4997, Accuracy: 8689/10000 (86.8900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.1176, Accuracy: 8670/8991 (96.4298%)
Done in 299.5310757160187 sec.
Server Epoch:45 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0011, Accuracy: 445/456 (97.5877%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.1619, Accuracy: 5460/10000 (54.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 75, internal_epoch   1,  Average loss: 0.0006, Accuracy: 489/497 (98.3903%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 10.9900, Accuracy: 2270/10000 (22.7000%), Attack Success Rate:5/10000(0.050)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0003, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   3,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   4,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 15.197391507037123.
Norm before scaling: 15.197691712033885. Distance: 0.11005989283799457
Total norm for 5 adversaries is: 15.197691712033885. distance: 0.11005989283799457
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1327, Accuracy: 8622/8991 (95.8959%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 568/578 (98.2699%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   2,  Average loss: 0.0006, Accuracy: 571/578 (98.7889%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   3,  Average loss: 0.0002, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   4,  Average loss: 0.0002, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 15.197391507037123.
Norm before scaling: 15.209530021233295. Distance: 0.8243066460626236
Total norm for 5 adversaries is: 15.209530021233295. distance: 0.8243066460626236
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.4289, Accuracy: 7819/8991 (86.9647%)
___Train Local_Simple,  epoch  45, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 598/607 (98.5173%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.7185, Accuracy: 6468/10000 (64.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 256/259 (98.8417%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.0444, Accuracy: 7482/10000 (74.8200%), Attack Success Rate:0/10000(0.000)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1206/1232 (97.8896%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1225/1232 (99.4318%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1228/1232 (99.6753%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Global model norm: 15.197391507037123.
Norm before scaling: 15.154372769537046. Distance: 1.3720517194580968
Total norm for 5 adversaries is: 15.154372769537046. distance: 1.3720517194580968
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 1.0971, Accuracy: 7142/8991 (79.4350%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1243/1259 (98.7292%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1248/1259 (99.1263%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1255/1259 (99.6823%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Global model norm: 15.197391507037123.
Norm before scaling: 15.110903894337566. Distance: 1.1400287062393668
Total norm for 5 adversaries is: 15.110903894337566. distance: 1.1400287062393668
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.7721, Accuracy: 7306/8991 (81.2590%)
___Train Local_Simple,  epoch  45, local model 60, internal_epoch   1,  Average loss: 0.0009, Accuracy: 392/399 (98.2456%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.7234, Accuracy: 3692/10000 (36.9200%), Attack Success Rate:0/10000(0.000)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1033/1046 (98.7572%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1039/1046 (99.3308%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1042/1046 (99.6176%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1045/1046 (99.9044%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1045/1046 (99.9044%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Global model norm: 15.197391507037123.
Norm before scaling: 15.147233746976603. Distance: 1.0487858996424768
Total norm for 5 adversaries is: 15.147233746976603. distance: 1.0487858996424768
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 1.1152, Accuracy: 6807/8991 (75.7090%)
time spent on training: 112.282958984375
[foolsgold agg] training data poison_ratio: 0.6543556178899798  data num: [456, 497, 84, 578, 607, 259, 1232, 1259, 399, 1046]
[foolsgold agg] considering poison per batch poison_fraction: 0.6543556178899798
[foolsgold agg] wv: [0.66904062 1.         0.46008595 0.94722264 0.66904062 1.
 1.         1.         1.         0.46008595]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.5486, Accuracy: 8708/10000 (87.0800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.1123, Accuracy: 8681/8991 (96.5521%)
Done in 314.78372406959534 sec.
Server Epoch:46 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
___Train Local_Simple,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0005, Accuracy: 491/497 (98.7928%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 6.2913, Accuracy: 3931/10000 (39.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 78, internal_epoch   1,  Average loss: 0.0013, Accuracy: 2270/2324 (97.6764%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.4923, Accuracy: 6066/10000 (60.6600%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0004, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 15.213993778408518.
Norm before scaling: 15.214253037313348. Distance: 0.07730441682757563
Total norm for 6 adversaries is: 15.214253037313348. distance: 0.07730441682757563
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1212, Accuracy: 8650/8991 (96.2073%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1242/1259 (98.6497%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1250/1259 (99.2851%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1254/1259 (99.6029%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Global model norm: 15.213993778408518.
Norm before scaling: 15.139510831199528. Distance: 1.1614500595733221
Total norm for 6 adversaries is: 15.139510831199528. distance: 1.1614500595733221
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.6162, Accuracy: 7566/8991 (84.1508%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0028, Accuracy: 82/86 (95.3488%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   2,  Average loss: 0.0004, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   3,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   4,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   5,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Global model norm: 15.213993778408518.
Norm before scaling: 15.2108778127039. Distance: 0.44231414261949936
Total norm for 6 adversaries is: 15.2108778127039. distance: 0.44231414261949936
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.5452, Accuracy: 7557/8991 (84.0507%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0014, Accuracy: 665/688 (96.6570%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   2,  Average loss: 0.0013, Accuracy: 665/688 (96.6570%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   3,  Average loss: 0.0003, Accuracy: 683/688 (99.2733%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   4,  Average loss: 0.0003, Accuracy: 683/688 (99.2733%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   5,  Average loss: 0.0002, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   6,  Average loss: 0.0002, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 15.213993778408518.
Norm before scaling: 15.226478823044834. Distance: 1.3372346258272756
Total norm for 6 adversaries is: 15.226478823044834. distance: 1.3372346258272756
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 1.1970, Accuracy: 5572/8991 (61.9731%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   1,  Average loss: 0.0007, Accuracy: 428/436 (98.1651%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 433/436 (99.3119%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   3,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   5,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   6,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Global model norm: 15.213993778408518.
Norm before scaling: 15.228558084179939. Distance: 0.805941373320994
Total norm for 6 adversaries is: 15.228558084179939. distance: 0.805941373320994
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 1.0560, Accuracy: 6885/8991 (76.5766%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 113/119 (94.9580%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   2,  Average loss: 0.0005, Accuracy: 118/119 (99.1597%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   3,  Average loss: 0.0004, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   4,  Average loss: 0.0003, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   5,  Average loss: 0.0003, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   6,  Average loss: 0.0002, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   7,  Average loss: 0.0002, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   8,  Average loss: 0.0002, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   9,  Average loss: 0.0002, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch  10,  Average loss: 0.0001, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Global model norm: 15.213993778408518.
Norm before scaling: 15.220386205678226. Distance: 0.5358933433381241
Total norm for 6 adversaries is: 15.220386205678226. distance: 0.5358933433381241
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.8178, Accuracy: 7027/8991 (78.1559%)
___Train Local_Simple,  epoch  46, local model 68, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1549/1591 (97.3602%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.4007, Accuracy: 4769/10000 (47.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 54, internal_epoch   1,  Average loss: 0.0034, Accuracy: 86/91 (94.5055%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.5661, Accuracy: 8458/10000 (84.5800%), Attack Success Rate:0/10000(0.000)
time spent on training: 114.05068182945251
[foolsgold agg] training data poison_ratio: 0.3692393892702059  data num: [497, 2324, 48, 1259, 86, 688, 436, 119, 1591, 91]
[foolsgold agg] considering poison per batch poison_fraction: 0.3692393892702059
[foolsgold agg] wv: [0.99089684 1.         1.         0.98444578 1.         1.
 0.99089684 1.         0.98444578 1.        ]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.5694, Accuracy: 8703/10000 (87.0300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.1182, Accuracy: 8676/8991 (96.4965%)
Done in 314.29701685905457 sec.
Server Epoch:47 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  47, local model 94, internal_epoch   1,  Average loss: 0.0015, Accuracy: 590/607 (97.1993%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 4.4203, Accuracy: 4374/10000 (43.7400%), Attack Success Rate:1/10000(0.010)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   3,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   5,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   6,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.230076016031619.
Norm before scaling: 15.232441283525588. Distance: 0.339801084098299
Total norm for 6 adversaries is: 15.232441283525588. distance: 0.339801084098299
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.3009, Accuracy: 8196/8991 (91.1578%)
___Train Local_Simple,  epoch  47, local model 82, internal_epoch   1,  Average loss: 0.0008, Accuracy: 112/114 (98.2456%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5191, Accuracy: 8538/10000 (85.3800%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   1,  Average loss: 0.0014, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   2,  Average loss: 0.0007, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   3,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   4,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   5,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   6,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   7,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   8,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   9,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch  10,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.230076016031619.
Norm before scaling: 15.234611877164825. Distance: 0.30896063615777164
Total norm for 6 adversaries is: 15.234611877164825. distance: 0.30896063615777164
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1523, Accuracy: 8564/8991 (95.2508%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1294/1311 (98.7033%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1303/1311 (99.3898%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   4,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Global model norm: 15.230076016031619.
Norm before scaling: 15.137379521867796. Distance: 1.56252937289286
Total norm for 6 adversaries is: 15.137379521867796. distance: 1.56252937289286
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 2.3578, Accuracy: 4473/8991 (49.7497%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0012, Accuracy: 973/994 (97.8873%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   2,  Average loss: 0.0006, Accuracy: 982/994 (98.7928%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   3,  Average loss: 0.0004, Accuracy: 986/994 (99.1952%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   4,  Average loss: 0.0002, Accuracy: 988/994 (99.3964%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   5,  Average loss: 0.0002, Accuracy: 992/994 (99.7988%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   6,  Average loss: 0.0001, Accuracy: 992/994 (99.7988%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   7,  Average loss: 0.0001, Accuracy: 994/994 (100.0000%), train_poison_data_count: 994
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   8,  Average loss: 0.0001, Accuracy: 994/994 (100.0000%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   9,  Average loss: 0.0001, Accuracy: 994/994 (100.0000%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch  10,  Average loss: 0.0001, Accuracy: 994/994 (100.0000%), train_poison_data_count: 994
Global model norm: 15.230076016031619.
Norm before scaling: 15.215821534691642. Distance: 1.309779071596625
Total norm for 6 adversaries is: 15.215821534691642. distance: 1.309779071596625
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.5049, Accuracy: 7496/8991 (83.3723%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0024, Accuracy: 81/86 (94.1860%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   3,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   4,  Average loss: 0.0001, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   7,  Average loss: 0.0001, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Global model norm: 15.230076016031619.
Norm before scaling: 15.227868702792659. Distance: 0.44023830205592523
Total norm for 6 adversaries is: 15.227868702792659. distance: 0.44023830205592523
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.7940, Accuracy: 7223/8991 (80.3359%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0009, Accuracy: 754/768 (98.1771%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.5478, Accuracy: 5201/10000 (52.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 68, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1549/1591 (97.3602%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.2165, Accuracy: 4519/10000 (45.1900%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   2,  Average loss: 0.0008, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   3,  Average loss: 0.0005, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   4,  Average loss: 0.0004, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   5,  Average loss: 0.0004, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   6,  Average loss: 0.0004, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   7,  Average loss: 0.0004, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   8,  Average loss: 0.0003, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   9,  Average loss: 0.0003, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch  10,  Average loss: 0.0003, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Global model norm: 15.230076016031619.
Norm before scaling: 15.229719340693348. Distance: 0.04444767393519799
Total norm for 6 adversaries is: 15.229719340693348. distance: 0.04444767393519799
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1169, Accuracy: 8676/8991 (96.4965%)
time spent on training: 119.07183790206909
[foolsgold agg] training data poison_ratio: 0.4627594627594628  data num: [607, 128, 114, 128, 1311, 994, 86, 768, 1591, 6]
[foolsgold agg] considering poison per batch poison_fraction: 0.4627594627594628
[foolsgold agg] wv: [1.         1.         1.         0.62417315 1.         1.
 0.62417315 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.6274, Accuracy: 8662/10000 (86.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.1274, Accuracy: 8630/8991 (95.9849%)
Done in 326.88642621040344 sec.
Server Epoch:48 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
___Train Local_Simple,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0026, Accuracy: 721/762 (94.6194%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.2249, Accuracy: 5775/10000 (57.7500%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 665/678 (98.0826%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 674/678 (99.4100%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   3,  Average loss: 0.0003, Accuracy: 672/678 (99.1150%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 676/678 (99.7050%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Global model norm: 15.243098964450734.
Norm before scaling: 15.218900895202905. Distance: 1.1761338221774245
Total norm for 3 adversaries is: 15.218900895202905. distance: 1.1761338221774245
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 2.5073, Accuracy: 4657/8991 (51.7962%)
___Train Local_Simple,  epoch  48, local model 75, internal_epoch   1,  Average loss: 0.0009, Accuracy: 488/497 (98.1891%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 5.8411, Accuracy: 3597/10000 (35.9700%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0021, Accuracy: 232/244 (95.0820%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   2,  Average loss: 0.0007, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   3,  Average loss: 0.0010, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   4,  Average loss: 0.0008, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   5,  Average loss: 0.0006, Accuracy: 242/244 (99.1803%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   6,  Average loss: 0.0004, Accuracy: 242/244 (99.1803%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   7,  Average loss: 0.0003, Accuracy: 242/244 (99.1803%), train_poison_data_count: 244
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   8,  Average loss: 0.0002, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   9,  Average loss: 0.0002, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch  10,  Average loss: 0.0002, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Global model norm: 15.243098964450734.
Norm before scaling: 15.25362915881491. Distance: 0.9393260655757085
Total norm for 3 adversaries is: 15.25362915881491. distance: 0.9393260655757085
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 2.5543, Accuracy: 4003/8991 (44.5223%)
___Train Local_Simple,  epoch  48, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 964/1015 (94.9754%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.1579, Accuracy: 5266/10000 (52.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0005, Accuracy: 740/750 (98.6667%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.1236, Accuracy: 6298/10000 (62.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0009, Accuracy: 179/182 (98.3516%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.5737, Accuracy: 8676/10000 (86.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 96, internal_epoch   1,  Average loss: 0.0035, Accuracy: 481/505 (95.2475%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 2.9019, Accuracy: 5515/10000 (55.1500%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 91/94 (96.8085%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   2,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   3,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Global model norm: 15.243098964450734.
Norm before scaling: 15.241045214437086. Distance: 0.3818668830995395
Total norm for 3 adversaries is: 15.241045214437086. distance: 0.3818668830995395
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.4594, Accuracy: 7777/8991 (86.4976%)
___Train Local_Simple,  epoch  48, local model 57, internal_epoch   1,  Average loss: 0.0027, Accuracy: 1364/1437 (94.9200%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.0384, Accuracy: 3552/10000 (35.5200%), Attack Success Rate:0/10000(0.000)
time spent on training: 83.27407479286194
[foolsgold agg] training data poison_ratio: 0.16482803374432187  data num: [762, 678, 497, 244, 1015, 750, 182, 505, 94, 1437]
[foolsgold agg] considering poison per batch poison_fraction: 0.16482803374432187
[foolsgold agg] wv: [0.         0.30869742 1.         1.         0.33965641 1.
 0.30869742 0.         0.62789326 1.        ]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.6497, Accuracy: 8652/10000 (86.5200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.1349, Accuracy: 8618/8991 (95.8514%)
Done in 270.10452699661255 sec.
Server Epoch:49 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
___Train Local_Simple,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1488/1544 (96.3731%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.0336, Accuracy: 6226/10000 (62.2600%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0023, Accuracy: 652/688 (94.7674%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   2,  Average loss: 0.0009, Accuracy: 674/688 (97.9651%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   3,  Average loss: 0.0002, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 15.247683990214044.
Norm before scaling: 15.330039181892504. Distance: 1.7303802260926404
Total norm for 3 adversaries is: 15.330039181892504. distance: 1.7303802260926404
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 1.7107, Accuracy: 4568/8991 (50.8064%)
___Train Local_Simple,  epoch  49, local model 78, internal_epoch   1,  Average loss: 0.0018, Accuracy: 2248/2324 (96.7298%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.5243, Accuracy: 6171/10000 (61.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0392, Accuracy: 9/10 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.8009, Accuracy: 8070/10000 (80.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 91, internal_epoch   1,  Average loss: 0.0009, Accuracy: 179/182 (98.3516%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5805, Accuracy: 8670/10000 (86.7000%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0405, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   3,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   4,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   7,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   8,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   9,  Average loss: 0.0000, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch  10,  Average loss: 0.0000, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 15.247683990214044.
Norm before scaling: 15.25760348519151. Distance: 0.5451332967380911
Total norm for 3 adversaries is: 15.25760348519151. distance: 0.5451332967380911
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.2932, Accuracy: 8260/8991 (91.8696%)
___Train Local_Simple,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0004, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6493, Accuracy: 8653/10000 (86.5300%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 2046/2072 (98.7452%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   2,  Average loss: 0.0003, Accuracy: 2058/2072 (99.3243%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   3,  Average loss: 0.0002, Accuracy: 2065/2072 (99.6622%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2066/2072 (99.7104%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2068/2072 (99.8069%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2069/2072 (99.8552%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2068/2072 (99.8069%), train_poison_data_count: 2072
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2069/2072 (99.8552%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2071/2072 (99.9517%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2071/2072 (99.9517%), train_poison_data_count: 2072
Global model norm: 15.247683990214044.
Norm before scaling: 15.086315780472216. Distance: 1.5581532097139923
Total norm for 3 adversaries is: 15.086315780472216. distance: 1.5581532097139923
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 1.1901, Accuracy: 5979/8991 (66.4998%)
___Train Local_Simple,  epoch  49, local model 82, internal_epoch   1,  Average loss: 0.0014, Accuracy: 111/114 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5643, Accuracy: 8302/10000 (83.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0023, Accuracy: 724/762 (95.0131%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 4.1129, Accuracy: 5315/10000 (53.1500%), Attack Success Rate:0/10000(0.000)
time spent on training: 101.71359992027283
[foolsgold agg] training data poison_ratio: 0.35876475930971846  data num: [1544, 688, 2324, 10, 182, 5, 6, 2072, 114, 762]
[foolsgold agg] considering poison per batch poison_fraction: 0.35876475930971846
[foolsgold agg] wv: [0.         1.         1.         1.         0.68196317 0.69386514
 0.68196317 1.         0.63993636 0.        ]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.6327, Accuracy: 8684/10000 (86.8400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.1274, Accuracy: 8648/8991 (96.1851%)
Done in 286.6257700920105 sec.
Server Epoch:50 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
___Train Local_Simple,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0014, Accuracy: 487/497 (97.9879%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 4.8682, Accuracy: 4021/10000 (40.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 86, internal_epoch   1,  Average loss: 0.0020, Accuracy: 34/34 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6192, Accuracy: 8690/10000 (86.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 255/259 (98.4556%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.7684, Accuracy: 8123/10000 (81.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 297/300 (99.0000%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6190, Accuracy: 8587/10000 (85.8700%), Attack Success Rate:0/10000(0.000)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1790/1839 (97.3355%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1822/1839 (99.0756%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1834/1839 (99.7281%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1833/1839 (99.6737%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1836/1839 (99.8369%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1836/1839 (99.8369%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1837/1839 (99.8912%), train_poison_data_count: 1839
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1837/1839 (99.8912%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Global model norm: 15.25915202693304.
Norm before scaling: 15.27631946115611. Distance: 2.021542401793981
Total norm for 5 adversaries is: 15.27631946115611. distance: 2.021542401793981
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 1.4877, Accuracy: 5988/8991 (66.5999%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   1,  Average loss: 0.0015, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   2,  Average loss: 0.0006, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   3,  Average loss: 0.0002, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   8,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   9,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch  10,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 15.25915202693304.
Norm before scaling: 15.261386310207046. Distance: 0.13091726588317054
Total norm for 5 adversaries is: 15.261386310207046. distance: 0.13091726588317054
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.1376, Accuracy: 8596/8991 (95.6067%)
___Train Local_Simple,  epoch  50, local model 67, internal_epoch   1,  Average loss: 0.0091, Accuracy: 495/568 (87.1479%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.3845, Accuracy: 5871/10000 (58.7100%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 91/94 (96.8085%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   2,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   3,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Global model norm: 15.25915202693304.
Norm before scaling: 15.258757531217421. Distance: 0.3522465831984802
Total norm for 5 adversaries is: 15.258757531217421. distance: 0.3522465831984802
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.4281, Accuracy: 7842/8991 (87.2206%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1215/1232 (98.6201%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1217/1232 (98.7825%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1227/1232 (99.5942%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1228/1232 (99.6753%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1230/1232 (99.8377%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1230/1232 (99.8377%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1230/1232 (99.8377%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Global model norm: 15.25915202693304.
Norm before scaling: 15.194244017703916. Distance: 1.2707749598286577
Total norm for 5 adversaries is: 15.194244017703916. distance: 1.2707749598286577
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.7474, Accuracy: 7267/8991 (80.8253%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0025, Accuracy: 81/86 (94.1860%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   3,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   4,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   5,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Global model norm: 15.25915202693304.
Norm before scaling: 15.255819742339058. Distance: 0.4109690469156695
Total norm for 5 adversaries is: 15.255819742339058. distance: 0.4109690469156695
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.5749, Accuracy: 7442/8991 (82.7717%)
time spent on training: 109.5797529220581
[foolsgold agg] training data poison_ratio: 0.6641685233947742  data num: [497, 34, 259, 300, 1839, 28, 568, 94, 1232, 86]
[foolsgold agg] considering poison per batch poison_fraction: 0.6641685233947742
[foolsgold agg] wv: [0.64849684 0.33072504 0.55981078 0.33072504 0.74821143 0.64849684
 1.         1.         0.87993664 1.        ]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.4420, Accuracy: 8685/10000 (86.8500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.1315, Accuracy: 8634/8991 (96.0294%)
Done in 289.4639837741852 sec.
Saving all the graphs.
This run has a label: Mar.03_11.45.22. Visdom environment: mnist_DBA
