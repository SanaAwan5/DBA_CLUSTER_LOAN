current path: saved_models/mnist_pretrain/model_mnist_Mar.03_15.55.20
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   1,  Average loss: 0.0372, Accuracy: 61/293 (20.8191%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   2,  Average loss: 0.0305, Accuracy: 119/293 (40.6143%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   3,  Average loss: 0.0276, Accuracy: 95/293 (32.4232%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   4,  Average loss: 0.0267, Accuracy: 165/293 (56.3140%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   5,  Average loss: 0.0244, Accuracy: 171/293 (58.3618%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   6,  Average loss: 0.0229, Accuracy: 170/293 (58.0205%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   7,  Average loss: 0.0217, Accuracy: 171/293 (58.3618%), train_poison_data_count: 293
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   8,  Average loss: 0.0204, Accuracy: 189/293 (64.5051%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   9,  Average loss: 0.0185, Accuracy: 186/293 (63.4812%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch  10,  Average loss: 0.0190, Accuracy: 182/293 (62.1160%), train_poison_data_count: 293
Global model norm: 13.89800383141575.
Norm before scaling: 13.998355768925093. Distance: 1.5025156701360942
Total norm for 7 adversaries is: 13.998355768925093. distance: 1.5025156701360942
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 2.6567, Accuracy: 2357/8991 (26.2151%)
___Train Local_Simple,  epoch   1, local model 72, internal_epoch   1,  Average loss: 0.0253, Accuracy: 366/731 (50.0684%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.8372, Accuracy: 1902/10000 (19.0200%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   1, local model 61, internal_epoch   1,  Average loss: 0.0285, Accuracy: 260/699 (37.1960%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.9264, Accuracy: 1924/10000 (19.2400%), Attack Success Rate:17/10000(0.170)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0341, Accuracy: 191/645 (29.6124%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   2,  Average loss: 0.0275, Accuracy: 302/645 (46.8217%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   3,  Average loss: 0.0190, Accuracy: 368/645 (57.0543%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   4,  Average loss: 0.0201, Accuracy: 487/645 (75.5039%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   5,  Average loss: 0.0134, Accuracy: 519/645 (80.4651%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   6,  Average loss: 0.0119, Accuracy: 514/645 (79.6899%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   7,  Average loss: 0.0107, Accuracy: 526/645 (81.5504%), train_poison_data_count: 645
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   8,  Average loss: 0.0092, Accuracy: 520/645 (80.6202%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   9,  Average loss: 0.0079, Accuracy: 553/645 (85.7364%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch  10,  Average loss: 0.0077, Accuracy: 554/645 (85.8915%), train_poison_data_count: 645
Global model norm: 13.89800383141575.
Norm before scaling: 14.253393471867223. Distance: 2.9887702890789964
Total norm for 7 adversaries is: 14.253393471867223. distance: 2.9887702890789964
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 1.5533, Accuracy: 4693/8991 (52.1966%)
___Train Local_Simple,  epoch   1, local model 71, internal_epoch   1,  Average loss: 0.0218, Accuracy: 699/1384 (50.5058%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.3890, Accuracy: 3789/10000 (37.8900%), Attack Success Rate:0/10000(0.000)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   1,  Average loss: 0.0371, Accuracy: 71/236 (30.0847%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   2,  Average loss: 0.0295, Accuracy: 93/236 (39.4068%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   3,  Average loss: 0.0273, Accuracy: 91/236 (38.5593%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   4,  Average loss: 0.0266, Accuracy: 90/236 (38.1356%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   5,  Average loss: 0.0265, Accuracy: 90/236 (38.1356%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   6,  Average loss: 0.0259, Accuracy: 90/236 (38.1356%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   7,  Average loss: 0.0256, Accuracy: 93/236 (39.4068%), train_poison_data_count: 236
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   8,  Average loss: 0.0250, Accuracy: 101/236 (42.7966%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   9,  Average loss: 0.0249, Accuracy: 110/236 (46.6102%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch  10,  Average loss: 0.0250, Accuracy: 112/236 (47.4576%), train_poison_data_count: 236
Global model norm: 13.89800383141575.
Norm before scaling: 13.943067593292835. Distance: 1.0828338290669373
Total norm for 7 adversaries is: 13.943067593292835. distance: 1.0828338290669373
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 2.9110, Accuracy: 1331/8991 (14.8037%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   1,  Average loss: 0.0297, Accuracy: 281/628 (44.7452%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   2,  Average loss: 0.0139, Accuracy: 448/628 (71.3376%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   3,  Average loss: 0.0070, Accuracy: 542/628 (86.3057%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   4,  Average loss: 0.0058, Accuracy: 563/628 (89.6497%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   5,  Average loss: 0.0050, Accuracy: 568/628 (90.4459%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   6,  Average loss: 0.0045, Accuracy: 581/628 (92.5159%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   7,  Average loss: 0.0041, Accuracy: 580/628 (92.3567%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   8,  Average loss: 0.0037, Accuracy: 587/628 (93.4713%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   9,  Average loss: 0.0035, Accuracy: 589/628 (93.7898%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch  10,  Average loss: 0.0033, Accuracy: 589/628 (93.7898%), train_poison_data_count: 628
Global model norm: 13.89800383141575.
Norm before scaling: 14.324164955073515. Distance: 3.1597113938664236
Total norm for 7 adversaries is: 14.324164955073515. distance: 3.1597113938664236
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 2.1658, Accuracy: 5230/8991 (58.1693%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   1,  Average loss: 0.0262, Accuracy: 374/860 (43.4884%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   2,  Average loss: 0.0128, Accuracy: 656/860 (76.2791%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   3,  Average loss: 0.0068, Accuracy: 755/860 (87.7907%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   4,  Average loss: 0.0059, Accuracy: 770/860 (89.5349%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   5,  Average loss: 0.0054, Accuracy: 785/860 (91.2791%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   6,  Average loss: 0.0048, Accuracy: 792/860 (92.0930%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   7,  Average loss: 0.0044, Accuracy: 793/860 (92.2093%), train_poison_data_count: 860
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   8,  Average loss: 0.0039, Accuracy: 805/860 (93.6047%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   9,  Average loss: 0.0035, Accuracy: 809/860 (94.0698%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch  10,  Average loss: 0.0034, Accuracy: 813/860 (94.5349%), train_poison_data_count: 860
Global model norm: 13.89800383141575.
Norm before scaling: 14.400096977755046. Distance: 3.592708005358573
Total norm for 7 adversaries is: 14.400096977755046. distance: 3.592708005358573
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 1.6284, Accuracy: 5026/8991 (55.9003%)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   1,  Average loss: 0.0340, Accuracy: 114/312 (36.5385%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   2,  Average loss: 0.0279, Accuracy: 79/312 (25.3205%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   3,  Average loss: 0.0257, Accuracy: 113/312 (36.2179%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   4,  Average loss: 0.0252, Accuracy: 113/312 (36.2179%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   5,  Average loss: 0.0243, Accuracy: 113/312 (36.2179%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   6,  Average loss: 0.0237, Accuracy: 128/312 (41.0256%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   7,  Average loss: 0.0230, Accuracy: 182/312 (58.3333%), train_poison_data_count: 312
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   8,  Average loss: 0.0221, Accuracy: 175/312 (56.0897%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   9,  Average loss: 0.0214, Accuracy: 172/312 (55.1282%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch  10,  Average loss: 0.0213, Accuracy: 174/312 (55.7692%), train_poison_data_count: 312
Global model norm: 13.89800383141575.
Norm before scaling: 13.971018084358654. Distance: 1.3603404771034107
Total norm for 7 adversaries is: 13.971018084358654. distance: 1.3603404771034107
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 3.0662, Accuracy: 1859/8991 (20.6762%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   1,  Average loss: 0.0311, Accuracy: 186/499 (37.2745%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   2,  Average loss: 0.0217, Accuracy: 250/499 (50.1002%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   3,  Average loss: 0.0161, Accuracy: 333/499 (66.7335%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   4,  Average loss: 0.0144, Accuracy: 343/499 (68.7375%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   5,  Average loss: 0.0135, Accuracy: 343/499 (68.7375%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   6,  Average loss: 0.0124, Accuracy: 348/499 (69.7395%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   7,  Average loss: 0.0115, Accuracy: 356/499 (71.3427%), train_poison_data_count: 499
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   8,  Average loss: 0.0102, Accuracy: 392/499 (78.5571%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   9,  Average loss: 0.0092, Accuracy: 412/499 (82.5651%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch  10,  Average loss: 0.0090, Accuracy: 412/499 (82.5651%), train_poison_data_count: 499
Global model norm: 13.89800383141575.
Norm before scaling: 14.15276962511308. Distance: 2.4963274683653154
Total norm for 7 adversaries is: 14.15276962511308. distance: 2.4963274683653154
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 2.6729, Accuracy: 3979/8991 (44.2554%)
time spent on training: 111.05894899368286
[foolsgold agg] training data poison_ratio: 0.5524097343725147  data num: [293, 731, 699, 645, 1384, 236, 628, 860, 312, 499]
[foolsgold agg] considering poison per batch poison_fraction: 0.5524097343725147
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.63598321
 1.         1.         0.63598321 1.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 1.9675, Accuracy: 3361/10000 (33.6100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 1.8657, Accuracy: 3463/8991 (38.5163%)
Done in 270.61592507362366 sec.
Server Epoch:2 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0216, Accuracy: 399/645 (61.8605%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   2,  Average loss: 0.0140, Accuracy: 482/645 (74.7287%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   3,  Average loss: 0.0070, Accuracy: 559/645 (86.6667%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   4,  Average loss: 0.0054, Accuracy: 577/645 (89.4574%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   5,  Average loss: 0.0048, Accuracy: 588/645 (91.1628%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   6,  Average loss: 0.0039, Accuracy: 599/645 (92.8682%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   7,  Average loss: 0.0037, Accuracy: 602/645 (93.3333%), train_poison_data_count: 645
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   8,  Average loss: 0.0032, Accuracy: 613/645 (95.0388%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   9,  Average loss: 0.0029, Accuracy: 615/645 (95.3488%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch  10,  Average loss: 0.0029, Accuracy: 614/645 (95.1938%), train_poison_data_count: 645
Global model norm: 14.026640476835722.
Norm before scaling: 15.011908826535382. Distance: 4.689723390340338
Total norm for 4 adversaries is: 15.011908826535382. distance: 4.689723390340338
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.7783, Accuracy: 6862/8991 (76.3208%)
___Train Local_Simple,  epoch   2, local model 59, internal_epoch   1,  Average loss: 0.0331, Accuracy: 366/760 (48.1579%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.2416, Accuracy: 2941/10000 (29.4100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   2, local model 62, internal_epoch   1,  Average loss: 0.0288, Accuracy: 213/423 (50.3546%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8040, Accuracy: 3863/10000 (38.6300%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   1,  Average loss: 0.0247, Accuracy: 223/501 (44.5110%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   2,  Average loss: 0.0146, Accuracy: 350/501 (69.8603%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   3,  Average loss: 0.0078, Accuracy: 413/501 (82.4351%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   4,  Average loss: 0.0060, Accuracy: 438/501 (87.4251%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   5,  Average loss: 0.0051, Accuracy: 450/501 (89.8204%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   6,  Average loss: 0.0044, Accuracy: 459/501 (91.6168%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   7,  Average loss: 0.0039, Accuracy: 468/501 (93.4132%), train_poison_data_count: 501
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   8,  Average loss: 0.0035, Accuracy: 470/501 (93.8124%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   9,  Average loss: 0.0032, Accuracy: 473/501 (94.4112%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch  10,  Average loss: 0.0032, Accuracy: 477/501 (95.2096%), train_poison_data_count: 501
Global model norm: 14.026640476835722.
Norm before scaling: 14.721607360156076. Distance: 3.490419217484017
Total norm for 4 adversaries is: 14.721607360156076. distance: 3.490419217484017
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.4768, Accuracy: 7566/8991 (84.1508%)
___Train Local_Simple,  epoch   2, local model 65, internal_epoch   1,  Average loss: 0.0224, Accuracy: 203/371 (54.7170%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.0119, Accuracy: 2901/10000 (29.0100%), Attack Success Rate:2/10000(0.020)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   1,  Average loss: 0.0175, Accuracy: 401/583 (68.7822%), train_poison_data_count: 583
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   2,  Average loss: 0.0086, Accuracy: 493/583 (84.5626%), train_poison_data_count: 583
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   3,  Average loss: 0.0059, Accuracy: 515/583 (88.3362%), train_poison_data_count: 583
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   4,  Average loss: 0.0044, Accuracy: 533/583 (91.4237%), train_poison_data_count: 583
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   5,  Average loss: 0.0035, Accuracy: 550/583 (94.3396%), train_poison_data_count: 583
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   6,  Average loss: 0.0030, Accuracy: 558/583 (95.7118%), train_poison_data_count: 583
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   7,  Average loss: 0.0028, Accuracy: 557/583 (95.5403%), train_poison_data_count: 583
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   8,  Average loss: 0.0024, Accuracy: 558/583 (95.7118%), train_poison_data_count: 583
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   9,  Average loss: 0.0023, Accuracy: 563/583 (96.5695%), train_poison_data_count: 583
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch  10,  Average loss: 0.0020, Accuracy: 563/583 (96.5695%), train_poison_data_count: 583
Global model norm: 14.026640476835722.
Norm before scaling: 14.655391057919502. Distance: 3.357412075274747
Total norm for 4 adversaries is: 14.655391057919502. distance: 3.357412075274747
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.4496, Accuracy: 7697/8991 (85.6078%)
___Train Local_Simple,  epoch   2, local model 78, internal_epoch   1,  Average loss: 0.0400, Accuracy: 140/303 (46.2046%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.2672, Accuracy: 1135/10000 (11.3500%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch   2, local model 58, internal_epoch   1,  Average loss: 0.0228, Accuracy: 154/276 (55.7971%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.5314, Accuracy: 2907/10000 (29.0700%), Attack Success Rate:0/10000(0.000)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   1,  Average loss: 0.0169, Accuracy: 425/606 (70.1320%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   2,  Average loss: 0.0104, Accuracy: 492/606 (81.1881%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   3,  Average loss: 0.0059, Accuracy: 536/606 (88.4488%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   4,  Average loss: 0.0049, Accuracy: 544/606 (89.7690%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   5,  Average loss: 0.0041, Accuracy: 559/606 (92.2442%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   6,  Average loss: 0.0034, Accuracy: 573/606 (94.5545%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   7,  Average loss: 0.0030, Accuracy: 578/606 (95.3795%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   8,  Average loss: 0.0026, Accuracy: 581/606 (95.8746%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   9,  Average loss: 0.0025, Accuracy: 583/606 (96.2046%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch  10,  Average loss: 0.0024, Accuracy: 583/606 (96.2046%), train_poison_data_count: 606
Global model norm: 14.026640476835722.
Norm before scaling: 14.633640964434537. Distance: 3.5651742367746926
Total norm for 4 adversaries is: 14.633640964434537. distance: 3.5651742367746926
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 1.9242, Accuracy: 5319/8991 (59.1592%)
___Train Local_Simple,  epoch   2, local model 81, internal_epoch   1,  Average loss: 0.0147, Accuracy: 875/1227 (71.3121%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.9639, Accuracy: 5376/10000 (53.7600%), Attack Success Rate:1/10000(0.010)
time spent on training: 79.2349271774292
[foolsgold agg] training data poison_ratio: 0.4100087796312555  data num: [645, 760, 423, 501, 371, 583, 303, 276, 606, 1227]
[foolsgold agg] considering poison per batch poison_fraction: 0.4100087796312555
[foolsgold agg] wv: [1.         0.         1.         0.53466852 1.         0.53466852
 0.         1.         0.94406361 0.94406361]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 1.6803, Accuracy: 5318/10000 (53.1800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 1.5194, Accuracy: 5328/8991 (59.2593%)
Done in 240.75718212127686 sec.
Server Epoch:3 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
___Train Local_Simple,  epoch   3, local model 54, internal_epoch   1,  Average loss: 0.0220, Accuracy: 263/519 (50.6744%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 4.2025, Accuracy: 2598/10000 (25.9800%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   3, local model 55, internal_epoch   1,  Average loss: 0.0210, Accuracy: 226/354 (63.8418%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 3.3426, Accuracy: 2524/10000 (25.2400%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch   3, local model 61, internal_epoch   1,  Average loss: 0.0148, Accuracy: 495/699 (70.8155%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 3.0449, Accuracy: 3767/10000 (37.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 73, internal_epoch   1,  Average loss: 0.0130, Accuracy: 462/591 (78.1726%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.5774, Accuracy: 3982/10000 (39.8200%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   1,  Average loss: 0.0184, Accuracy: 331/459 (72.1133%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   2,  Average loss: 0.0172, Accuracy: 313/459 (68.1917%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   3,  Average loss: 0.0135, Accuracy: 342/459 (74.5098%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   4,  Average loss: 0.0088, Accuracy: 397/459 (86.4924%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   5,  Average loss: 0.0066, Accuracy: 415/459 (90.4139%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   6,  Average loss: 0.0049, Accuracy: 424/459 (92.3747%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   7,  Average loss: 0.0043, Accuracy: 431/459 (93.8998%), train_poison_data_count: 459
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   8,  Average loss: 0.0034, Accuracy: 435/459 (94.7712%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   9,  Average loss: 0.0030, Accuracy: 440/459 (95.8606%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch  10,  Average loss: 0.0031, Accuracy: 440/459 (95.8606%), train_poison_data_count: 459
Global model norm: 14.102250675728813.
Norm before scaling: 14.979007017994123. Distance: 3.985182856022426
Total norm for 5 adversaries is: 14.979007017994123. distance: 3.985182856022426
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.8327, Accuracy: 7128/8991 (79.2793%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   1,  Average loss: 0.0210, Accuracy: 146/236 (61.8644%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   2,  Average loss: 0.0157, Accuracy: 167/236 (70.7627%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   3,  Average loss: 0.0108, Accuracy: 186/236 (78.8136%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   4,  Average loss: 0.0098, Accuracy: 190/236 (80.5085%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   5,  Average loss: 0.0086, Accuracy: 199/236 (84.3220%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   6,  Average loss: 0.0074, Accuracy: 202/236 (85.5932%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   7,  Average loss: 0.0066, Accuracy: 206/236 (87.2881%), train_poison_data_count: 236
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   8,  Average loss: 0.0057, Accuracy: 209/236 (88.5593%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   9,  Average loss: 0.0052, Accuracy: 212/236 (89.8305%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch  10,  Average loss: 0.0053, Accuracy: 214/236 (90.6780%), train_poison_data_count: 236
Global model norm: 14.102250675728813.
Norm before scaling: 14.364883179977973. Distance: 1.73669869037666
Total norm for 5 adversaries is: 14.364883179977973. distance: 1.73669869037666
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 1.0722, Accuracy: 5629/8991 (62.6071%)
___Train Local_Simple,  epoch   3, local model 87, internal_epoch   1,  Average loss: 0.0176, Accuracy: 338/470 (71.9149%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.5660, Accuracy: 5557/10000 (55.5700%), Attack Success Rate:0/10000(0.000)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   1,  Average loss: 0.0159, Accuracy: 429/606 (70.7921%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   2,  Average loss: 0.0065, Accuracy: 529/606 (87.2937%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   3,  Average loss: 0.0034, Accuracy: 571/606 (94.2244%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   4,  Average loss: 0.0030, Accuracy: 573/606 (94.5545%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   5,  Average loss: 0.0029, Accuracy: 576/606 (95.0495%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   6,  Average loss: 0.0023, Accuracy: 583/606 (96.2046%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   7,  Average loss: 0.0021, Accuracy: 586/606 (96.6997%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   8,  Average loss: 0.0019, Accuracy: 587/606 (96.8647%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   9,  Average loss: 0.0018, Accuracy: 586/606 (96.6997%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch  10,  Average loss: 0.0018, Accuracy: 589/606 (97.1947%), train_poison_data_count: 606
Global model norm: 14.102250675728813.
Norm before scaling: 14.90318078006441. Distance: 4.002840940594957
Total norm for 5 adversaries is: 14.90318078006441. distance: 4.002840940594957
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 1.9063, Accuracy: 5476/8991 (60.9053%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   1,  Average loss: 0.0239, Accuracy: 256/474 (54.0084%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   2,  Average loss: 0.0117, Accuracy: 388/474 (81.8565%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   3,  Average loss: 0.0056, Accuracy: 421/474 (88.8186%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   4,  Average loss: 0.0045, Accuracy: 437/474 (92.1941%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   5,  Average loss: 0.0042, Accuracy: 439/474 (92.6160%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   6,  Average loss: 0.0032, Accuracy: 448/474 (94.5148%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   7,  Average loss: 0.0028, Accuracy: 452/474 (95.3586%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   8,  Average loss: 0.0027, Accuracy: 451/474 (95.1477%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   9,  Average loss: 0.0021, Accuracy: 457/474 (96.4135%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch  10,  Average loss: 0.0020, Accuracy: 459/474 (96.8354%), train_poison_data_count: 474
Global model norm: 14.102250675728813.
Norm before scaling: 15.036063012569771. Distance: 4.516905923022046
Total norm for 5 adversaries is: 15.036063012569771. distance: 4.516905923022046
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 1.8674, Accuracy: 6223/8991 (69.2137%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   1,  Average loss: 0.0167, Accuracy: 361/501 (72.0559%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   2,  Average loss: 0.0147, Accuracy: 387/501 (77.2455%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   3,  Average loss: 0.0065, Accuracy: 447/501 (89.2216%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   4,  Average loss: 0.0053, Accuracy: 452/501 (90.2196%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   5,  Average loss: 0.0043, Accuracy: 457/501 (91.2176%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   6,  Average loss: 0.0038, Accuracy: 466/501 (93.0140%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   7,  Average loss: 0.0032, Accuracy: 474/501 (94.6108%), train_poison_data_count: 501
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   8,  Average loss: 0.0029, Accuracy: 475/501 (94.8104%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   9,  Average loss: 0.0026, Accuracy: 481/501 (96.0080%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch  10,  Average loss: 0.0025, Accuracy: 479/501 (95.6088%), train_poison_data_count: 501
Global model norm: 14.102250675728813.
Norm before scaling: 14.904075607918879. Distance: 3.653043204665306
Total norm for 5 adversaries is: 14.904075607918879. distance: 3.653043204665306
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.4059, Accuracy: 7803/8991 (86.7868%)
time spent on training: 86.75666308403015
[foolsgold agg] training data poison_ratio: 0.46363821552250967  data num: [519, 354, 699, 591, 459, 236, 470, 606, 474, 501]
[foolsgold agg] considering poison per batch poison_fraction: 0.46363821552250967
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 1.2902, Accuracy: 5973/10000 (59.7300%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 0.9888, Accuracy: 5979/8991 (66.4998%)
Done in 260.0862646102905 sec.
Server Epoch:4 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   1,  Average loss: 0.0062, Accuracy: 775/860 (90.1163%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   2,  Average loss: 0.0030, Accuracy: 814/860 (94.6512%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   3,  Average loss: 0.0022, Accuracy: 831/860 (96.6279%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   4,  Average loss: 0.0013, Accuracy: 838/860 (97.4419%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   5,  Average loss: 0.0011, Accuracy: 841/860 (97.7907%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   6,  Average loss: 0.0009, Accuracy: 848/860 (98.6047%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   7,  Average loss: 0.0008, Accuracy: 848/860 (98.6047%), train_poison_data_count: 860
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   8,  Average loss: 0.0007, Accuracy: 849/860 (98.7209%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   9,  Average loss: 0.0007, Accuracy: 852/860 (99.0698%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch  10,  Average loss: 0.0007, Accuracy: 852/860 (99.0698%), train_poison_data_count: 860
Global model norm: 14.244106747225928.
Norm before scaling: 14.77075545376081. Distance: 2.6632777873403075
Total norm for 4 adversaries is: 14.77075545376081. distance: 2.6632777873403075
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5005, Accuracy: 7556/8991 (84.0396%)
___Train Local_Simple,  epoch   4, local model 92, internal_epoch   1,  Average loss: 0.0123, Accuracy: 695/937 (74.1729%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.7755, Accuracy: 5362/10000 (53.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 95, internal_epoch   1,  Average loss: 0.0180, Accuracy: 421/602 (69.9336%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 5.4923, Accuracy: 3591/10000 (35.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 76, internal_epoch   1,  Average loss: 0.0222, Accuracy: 60/78 (76.9231%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 3.0866, Accuracy: 3049/10000 (30.4900%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0064, Accuracy: 640/734 (87.1935%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   2,  Average loss: 0.0033, Accuracy: 692/734 (94.2779%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   3,  Average loss: 0.0017, Accuracy: 711/734 (96.8665%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   4,  Average loss: 0.0012, Accuracy: 715/734 (97.4114%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   5,  Average loss: 0.0010, Accuracy: 720/734 (98.0926%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   6,  Average loss: 0.0008, Accuracy: 723/734 (98.5014%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   7,  Average loss: 0.0007, Accuracy: 724/734 (98.6376%), train_poison_data_count: 734
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   8,  Average loss: 0.0007, Accuracy: 725/734 (98.7738%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   9,  Average loss: 0.0006, Accuracy: 727/734 (99.0463%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch  10,  Average loss: 0.0006, Accuracy: 727/734 (99.0463%), train_poison_data_count: 734
Global model norm: 14.244106747225928.
Norm before scaling: 14.721788226434462. Distance: 2.481888396342965
Total norm for 4 adversaries is: 14.721788226434462. distance: 2.481888396342965
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 1.2285, Accuracy: 6696/8991 (74.4745%)
___Train Local_Simple,  epoch   4, local model 99, internal_epoch   1,  Average loss: 0.0156, Accuracy: 257/377 (68.1698%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.7349, Accuracy: 4699/10000 (46.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 94, internal_epoch   1,  Average loss: 0.0296, Accuracy: 77/150 (51.3333%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.9871, Accuracy: 3454/10000 (34.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 74, internal_epoch   1,  Average loss: 0.0140, Accuracy: 420/557 (75.4039%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.5645, Accuracy: 5785/10000 (57.8500%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   1,  Average loss: 0.0072, Accuracy: 549/628 (87.4204%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   2,  Average loss: 0.0042, Accuracy: 572/628 (91.0828%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   3,  Average loss: 0.0029, Accuracy: 595/628 (94.7452%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   4,  Average loss: 0.0022, Accuracy: 600/628 (95.5414%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   5,  Average loss: 0.0018, Accuracy: 607/628 (96.6561%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   6,  Average loss: 0.0016, Accuracy: 609/628 (96.9745%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   7,  Average loss: 0.0014, Accuracy: 611/628 (97.2930%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   8,  Average loss: 0.0013, Accuracy: 612/628 (97.4522%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   9,  Average loss: 0.0012, Accuracy: 616/628 (98.0892%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch  10,  Average loss: 0.0012, Accuracy: 617/628 (98.2484%), train_poison_data_count: 628
Global model norm: 14.244106747225928.
Norm before scaling: 14.712826194809475. Distance: 2.687144056302395
Total norm for 4 adversaries is: 14.712826194809475. distance: 2.687144056302395
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 1.4092, Accuracy: 6598/8991 (73.3845%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   1,  Average loss: 0.0085, Accuracy: 441/517 (85.2998%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   2,  Average loss: 0.0067, Accuracy: 457/517 (88.3946%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   3,  Average loss: 0.0053, Accuracy: 458/517 (88.5880%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   4,  Average loss: 0.0036, Accuracy: 486/517 (94.0039%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   5,  Average loss: 0.0025, Accuracy: 498/517 (96.3250%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   6,  Average loss: 0.0035, Accuracy: 497/517 (96.1315%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   7,  Average loss: 0.0024, Accuracy: 496/517 (95.9381%), train_poison_data_count: 517
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   8,  Average loss: 0.0052, Accuracy: 501/517 (96.9052%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   9,  Average loss: 0.0019, Accuracy: 499/517 (96.5184%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch  10,  Average loss: 0.0018, Accuracy: 500/517 (96.7118%), train_poison_data_count: 517
Global model norm: 14.244106747225928.
Norm before scaling: 14.70152152355061. Distance: 2.2455662381568597
Total norm for 4 adversaries is: 14.70152152355061. distance: 2.2455662381568597
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.3168, Accuracy: 8055/8991 (89.5896%)
time spent on training: 87.82357573509216
[foolsgold agg] training data poison_ratio: 0.5034926470588236  data num: [860, 937, 602, 78, 734, 377, 150, 557, 628, 517]
[foolsgold agg] considering poison per batch poison_fraction: 0.5034926470588236
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.66805403
 1.         0.66805403 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 1.0817, Accuracy: 6921/10000 (69.2100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 0.7249, Accuracy: 6941/8991 (77.1994%)
Done in 251.44722080230713 sec.
Server Epoch:5 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
___Train Local_Simple,  epoch   5, local model 60, internal_epoch   1,  Average loss: 0.0090, Accuracy: 286/338 (84.6154%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.5459, Accuracy: 6182/10000 (61.8200%), Attack Success Rate:0/10000(0.000)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   1,  Average loss: 0.0064, Accuracy: 447/506 (88.3399%), train_poison_data_count: 506
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   2,  Average loss: 0.0044, Accuracy: 471/506 (93.0830%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   3,  Average loss: 0.0023, Accuracy: 479/506 (94.6640%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   4,  Average loss: 0.0018, Accuracy: 486/506 (96.0474%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   5,  Average loss: 0.0015, Accuracy: 495/506 (97.8261%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   6,  Average loss: 0.0013, Accuracy: 495/506 (97.8261%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   7,  Average loss: 0.0011, Accuracy: 496/506 (98.0237%), train_poison_data_count: 506
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   8,  Average loss: 0.0010, Accuracy: 497/506 (98.2213%), train_poison_data_count: 506
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   9,  Average loss: 0.0009, Accuracy: 500/506 (98.8142%), train_poison_data_count: 506
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch  10,  Average loss: 0.0009, Accuracy: 500/506 (98.8142%), train_poison_data_count: 506
Global model norm: 14.327397085687846.
Norm before scaling: 14.69302069615824. Distance: 1.9098916211761001
Total norm for 7 adversaries is: 14.69302069615824. distance: 1.9098916211761001
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.4348, Accuracy: 7780/8991 (86.5310%)
___Train Local_Simple,  epoch   5, local model 65, internal_epoch   1,  Average loss: 0.0152, Accuracy: 273/371 (73.5849%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.7352, Accuracy: 3746/10000 (37.4600%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 347/376 (92.2872%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   2,  Average loss: 0.0043, Accuracy: 345/376 (91.7553%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   3,  Average loss: 0.0024, Accuracy: 362/376 (96.2766%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   4,  Average loss: 0.0020, Accuracy: 364/376 (96.8085%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   5,  Average loss: 0.0019, Accuracy: 362/376 (96.2766%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   6,  Average loss: 0.0018, Accuracy: 363/376 (96.5426%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   7,  Average loss: 0.0016, Accuracy: 366/376 (97.3404%), train_poison_data_count: 376
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   8,  Average loss: 0.0014, Accuracy: 366/376 (97.3404%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   9,  Average loss: 0.0014, Accuracy: 366/376 (97.3404%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch  10,  Average loss: 0.0014, Accuracy: 366/376 (97.3404%), train_poison_data_count: 376
Global model norm: 14.327397085687846.
Norm before scaling: 14.477325600502628. Distance: 1.0911671796484512
Total norm for 7 adversaries is: 14.477325600502628. distance: 1.0911671796484512
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.7207, Accuracy: 6822/8991 (75.8759%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 901/1005 (89.6517%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   2,  Average loss: 0.0020, Accuracy: 963/1005 (95.8209%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   3,  Average loss: 0.0011, Accuracy: 981/1005 (97.6119%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   4,  Average loss: 0.0008, Accuracy: 991/1005 (98.6070%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   5,  Average loss: 0.0006, Accuracy: 995/1005 (99.0050%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   6,  Average loss: 0.0005, Accuracy: 997/1005 (99.2040%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   7,  Average loss: 0.0004, Accuracy: 998/1005 (99.3035%), train_poison_data_count: 1005
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1000/1005 (99.5025%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1002/1005 (99.7015%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1002/1005 (99.7015%), train_poison_data_count: 1005
Global model norm: 14.327397085687846.
Norm before scaling: 14.85148801187922. Distance: 2.6027586423843823
Total norm for 7 adversaries is: 14.85148801187922. distance: 2.6027586423843823
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.9078, Accuracy: 7714/8991 (85.7969%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   1,  Average loss: 0.0076, Accuracy: 326/379 (86.0158%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   2,  Average loss: 0.0063, Accuracy: 327/379 (86.2797%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   3,  Average loss: 0.0024, Accuracy: 361/379 (95.2507%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   4,  Average loss: 0.0022, Accuracy: 361/379 (95.2507%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   5,  Average loss: 0.0018, Accuracy: 364/379 (96.0422%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   6,  Average loss: 0.0016, Accuracy: 362/379 (95.5145%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   7,  Average loss: 0.0014, Accuracy: 366/379 (96.5699%), train_poison_data_count: 379
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   8,  Average loss: 0.0012, Accuracy: 371/379 (97.8892%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   9,  Average loss: 0.0011, Accuracy: 370/379 (97.6253%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch  10,  Average loss: 0.0011, Accuracy: 371/379 (97.8892%), train_poison_data_count: 379
Global model norm: 14.327397085687846.
Norm before scaling: 14.647291100974257. Distance: 1.7189317780516553
Total norm for 7 adversaries is: 14.647291100974257. distance: 1.7189317780516553
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.7001, Accuracy: 6836/8991 (76.0316%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0101, Accuracy: 332/418 (79.4258%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   2,  Average loss: 0.0045, Accuracy: 377/418 (90.1914%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   3,  Average loss: 0.0025, Accuracy: 400/418 (95.6938%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   4,  Average loss: 0.0019, Accuracy: 407/418 (97.3684%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   5,  Average loss: 0.0016, Accuracy: 411/418 (98.3254%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   6,  Average loss: 0.0012, Accuracy: 413/418 (98.8038%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   7,  Average loss: 0.0011, Accuracy: 412/418 (98.5646%), train_poison_data_count: 418
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   8,  Average loss: 0.0009, Accuracy: 414/418 (99.0431%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   9,  Average loss: 0.0008, Accuracy: 415/418 (99.2823%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch  10,  Average loss: 0.0008, Accuracy: 415/418 (99.2823%), train_poison_data_count: 418
Global model norm: 14.327397085687846.
Norm before scaling: 14.740910202350126. Distance: 2.0575470842278913
Total norm for 7 adversaries is: 14.740910202350126. distance: 2.0575470842278913
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 1.1655, Accuracy: 7396/8991 (82.2600%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 571/658 (86.7781%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 611/658 (92.8571%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   3,  Average loss: 0.0020, Accuracy: 632/658 (96.0486%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   4,  Average loss: 0.0017, Accuracy: 641/658 (97.4164%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   5,  Average loss: 0.0016, Accuracy: 642/658 (97.5684%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   6,  Average loss: 0.0019, Accuracy: 645/658 (98.0243%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   7,  Average loss: 0.0012, Accuracy: 645/658 (98.0243%), train_poison_data_count: 658
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   8,  Average loss: 0.0011, Accuracy: 646/658 (98.1763%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   9,  Average loss: 0.0011, Accuracy: 647/658 (98.3283%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch  10,  Average loss: 0.0011, Accuracy: 648/658 (98.4802%), train_poison_data_count: 658
Global model norm: 14.327397085687846.
Norm before scaling: 14.761523384523562. Distance: 2.562964978714438
Total norm for 7 adversaries is: 14.761523384523562. distance: 2.562964978714438
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 1.9441, Accuracy: 6338/8991 (70.4927%)
___Train Local_Simple,  epoch   5, local model 76, internal_epoch   1,  Average loss: 0.0168, Accuracy: 63/78 (80.7692%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.7219, Accuracy: 4460/10000 (44.6000%), Attack Success Rate:0/10000(0.000)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   1,  Average loss: 0.0060, Accuracy: 234/257 (91.0506%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   2,  Average loss: 0.0067, Accuracy: 233/257 (90.6615%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   3,  Average loss: 0.0907, Accuracy: 77/257 (29.9611%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   4,  Average loss: 0.0295, Accuracy: 219/257 (85.2140%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   5,  Average loss: 0.0228, Accuracy: 214/257 (83.2685%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   6,  Average loss: 0.0144, Accuracy: 200/257 (77.8210%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   7,  Average loss: 0.0125, Accuracy: 196/257 (76.2646%), train_poison_data_count: 257
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   8,  Average loss: 0.0096, Accuracy: 208/257 (80.9339%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   9,  Average loss: 0.0081, Accuracy: 218/257 (84.8249%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch  10,  Average loss: 0.0079, Accuracy: 218/257 (84.8249%), train_poison_data_count: 257
Global model norm: 14.327397085687846.
Norm before scaling: 14.812090517975351. Distance: 3.229824384751507
Total norm for 7 adversaries is: 14.812090517975351. distance: 3.229824384751507
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 1.3996, Accuracy: 4934/8991 (54.8771%)
time spent on training: 104.97641801834106
[foolsgold agg] training data poison_ratio: 0.8205654354765162  data num: [338, 506, 371, 376, 1005, 379, 418, 658, 78, 257]
[foolsgold agg] considering poison per batch poison_fraction: 0.8205654354765162
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 1.2633, Accuracy: 6184/10000 (61.8400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 0.8595, Accuracy: 6163/8991 (68.5463%)
Done in 280.20918893814087 sec.
Server Epoch:6 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   1,  Average loss: 0.0066, Accuracy: 481/554 (86.8231%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   2,  Average loss: 0.0060, Accuracy: 493/554 (88.9892%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   3,  Average loss: 0.0026, Accuracy: 531/554 (95.8484%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   4,  Average loss: 0.0018, Accuracy: 542/554 (97.8339%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   5,  Average loss: 0.0014, Accuracy: 544/554 (98.1949%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   6,  Average loss: 0.0011, Accuracy: 548/554 (98.9170%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   7,  Average loss: 0.0009, Accuracy: 548/554 (98.9170%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   8,  Average loss: 0.0008, Accuracy: 550/554 (99.2780%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   9,  Average loss: 0.0007, Accuracy: 550/554 (99.2780%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch  10,  Average loss: 0.0007, Accuracy: 551/554 (99.4585%), train_poison_data_count: 554
Global model norm: 14.466284127751804.
Norm before scaling: 14.859927450955347. Distance: 2.085658136869895
Total norm for 6 adversaries is: 14.859927450955347. distance: 2.085658136869895
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.2310, Accuracy: 8385/8991 (93.2599%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 909/1002 (90.7186%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   2,  Average loss: 0.0021, Accuracy: 959/1002 (95.7086%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   3,  Average loss: 0.0011, Accuracy: 982/1002 (98.0040%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   4,  Average loss: 0.0008, Accuracy: 989/1002 (98.7026%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   5,  Average loss: 0.0006, Accuracy: 994/1002 (99.2016%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   6,  Average loss: 0.0005, Accuracy: 994/1002 (99.2016%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   7,  Average loss: 0.0005, Accuracy: 996/1002 (99.4012%), train_poison_data_count: 1002
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   8,  Average loss: 0.0004, Accuracy: 996/1002 (99.4012%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   9,  Average loss: 0.0004, Accuracy: 996/1002 (99.4012%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch  10,  Average loss: 0.0004, Accuracy: 996/1002 (99.4012%), train_poison_data_count: 1002
Global model norm: 14.466284127751804.
Norm before scaling: 14.90359390234633. Distance: 2.645781498999492
Total norm for 6 adversaries is: 14.90359390234633. distance: 2.645781498999492
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.9231, Accuracy: 7169/8991 (79.7353%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0077, Accuracy: 555/658 (84.3465%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   2,  Average loss: 0.0041, Accuracy: 611/658 (92.8571%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   3,  Average loss: 0.0021, Accuracy: 633/658 (96.2006%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   4,  Average loss: 0.0016, Accuracy: 641/658 (97.4164%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   5,  Average loss: 0.0013, Accuracy: 641/658 (97.4164%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   6,  Average loss: 0.0011, Accuracy: 645/658 (98.0243%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   7,  Average loss: 0.0010, Accuracy: 647/658 (98.3283%), train_poison_data_count: 658
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   8,  Average loss: 0.0009, Accuracy: 648/658 (98.4802%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   9,  Average loss: 0.0009, Accuracy: 650/658 (98.7842%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch  10,  Average loss: 0.0009, Accuracy: 650/658 (98.7842%), train_poison_data_count: 658
Global model norm: 14.466284127751804.
Norm before scaling: 15.006970629693015. Distance: 3.293608724325808
Total norm for 6 adversaries is: 15.006970629693015. distance: 3.293608724325808
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 1.6048, Accuracy: 6380/8991 (70.9598%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   1,  Average loss: 0.0063, Accuracy: 533/606 (87.9538%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   2,  Average loss: 0.0035, Accuracy: 569/606 (93.8944%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   3,  Average loss: 0.0020, Accuracy: 580/606 (95.7096%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   4,  Average loss: 0.0013, Accuracy: 595/606 (98.1848%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   5,  Average loss: 0.0011, Accuracy: 599/606 (98.8449%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   6,  Average loss: 0.0009, Accuracy: 600/606 (99.0099%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   7,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   8,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   9,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch  10,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Global model norm: 14.466284127751804.
Norm before scaling: 14.862798222276105. Distance: 2.300178280430701
Total norm for 6 adversaries is: 14.862798222276105. distance: 2.300178280430701
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 1.3589, Accuracy: 6746/8991 (75.0306%)
___Train Local_Simple,  epoch   6, local model 99, internal_epoch   1,  Average loss: 0.0147, Accuracy: 266/377 (70.5570%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.5246, Accuracy: 5656/10000 (56.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 67, internal_epoch   1,  Average loss: 0.0109, Accuracy: 808/998 (80.9619%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.0179, Accuracy: 5669/10000 (56.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 91, internal_epoch   1,  Average loss: 0.0120, Accuracy: 202/256 (78.9062%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.1440, Accuracy: 5754/10000 (57.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 76, internal_epoch   1,  Average loss: 0.0170, Accuracy: 61/78 (78.2051%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.2166, Accuracy: 5765/10000 (57.6500%), Attack Success Rate:0/10000(0.000)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0085, Accuracy: 536/633 (84.6761%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   2,  Average loss: 0.0071, Accuracy: 546/633 (86.2559%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   3,  Average loss: 0.0038, Accuracy: 598/633 (94.4708%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   4,  Average loss: 0.0028, Accuracy: 606/633 (95.7346%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   5,  Average loss: 0.0022, Accuracy: 608/633 (96.0506%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   6,  Average loss: 0.0019, Accuracy: 612/633 (96.6825%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   7,  Average loss: 0.0017, Accuracy: 615/633 (97.1564%), train_poison_data_count: 633
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   8,  Average loss: 0.0015, Accuracy: 619/633 (97.7883%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   9,  Average loss: 0.0014, Accuracy: 620/633 (97.9463%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch  10,  Average loss: 0.0014, Accuracy: 620/633 (97.9463%), train_poison_data_count: 633
Global model norm: 14.466284127751804.
Norm before scaling: 15.00290499213819. Distance: 2.6000700097561884
Total norm for 6 adversaries is: 15.00290499213819. distance: 2.6000700097561884
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.6165, Accuracy: 7518/8991 (83.6170%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   1,  Average loss: 0.0052, Accuracy: 579/647 (89.4900%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   2,  Average loss: 0.0028, Accuracy: 613/647 (94.7450%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   3,  Average loss: 0.0024, Accuracy: 620/647 (95.8269%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   4,  Average loss: 0.0011, Accuracy: 635/647 (98.1453%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   5,  Average loss: 0.0014, Accuracy: 636/647 (98.2998%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   6,  Average loss: 0.0010, Accuracy: 638/647 (98.6090%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   7,  Average loss: 0.0015, Accuracy: 639/647 (98.7635%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   8,  Average loss: 0.0013, Accuracy: 630/647 (97.3725%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   9,  Average loss: 0.0012, Accuracy: 634/647 (97.9907%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch  10,  Average loss: 0.0010, Accuracy: 638/647 (98.6090%), train_poison_data_count: 647
Global model norm: 14.466284127751804.
Norm before scaling: 14.78911821502976. Distance: 2.0337129186474754
Total norm for 6 adversaries is: 14.78911821502976. distance: 2.0337129186474754
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 1.2901, Accuracy: 6652/8991 (73.9851%)
time spent on training: 108.90641903877258
[foolsgold agg] training data poison_ratio: 0.705801342744018  data num: [554, 1002, 658, 606, 377, 998, 256, 78, 633, 647]
[foolsgold agg] considering poison per batch poison_fraction: 0.705801342744018
[foolsgold agg] wv: [0.97819799 1.         1.         1.         0.66916171 0.66916171
 0.9069174  1.         0.97819799 1.        ]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 0.9404, Accuracy: 7757/10000 (77.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 0.4300, Accuracy: 7768/8991 (86.3975%)
Done in 287.8510961532593 sec.
Server Epoch:7 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
___Train Local_Simple,  epoch   7, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 593/660 (89.8485%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.9548, Accuracy: 5304/10000 (53.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 68, internal_epoch   1,  Average loss: 0.0144, Accuracy: 384/494 (77.7328%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.5507, Accuracy: 5406/10000 (54.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 59, internal_epoch   1,  Average loss: 0.0052, Accuracy: 689/760 (90.6579%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.7954, Accuracy: 5631/10000 (56.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 62, internal_epoch   1,  Average loss: 0.0085, Accuracy: 364/423 (86.0520%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.5862, Accuracy: 8303/10000 (83.0300%), Attack Success Rate:0/10000(0.000)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   1,  Average loss: 0.0039, Accuracy: 770/835 (92.2156%), train_poison_data_count: 835
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   2,  Average loss: 0.0023, Accuracy: 793/835 (94.9701%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   3,  Average loss: 0.0012, Accuracy: 818/835 (97.9641%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   4,  Average loss: 0.0010, Accuracy: 817/835 (97.8443%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   5,  Average loss: 0.0006, Accuracy: 828/835 (99.1617%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   6,  Average loss: 0.0005, Accuracy: 829/835 (99.2814%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   7,  Average loss: 0.0005, Accuracy: 830/835 (99.4012%), train_poison_data_count: 835
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   8,  Average loss: 0.0004, Accuracy: 832/835 (99.6407%), train_poison_data_count: 835
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   9,  Average loss: 0.0003, Accuracy: 832/835 (99.6407%), train_poison_data_count: 835
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch  10,  Average loss: 0.0003, Accuracy: 832/835 (99.6407%), train_poison_data_count: 835
Global model norm: 14.592876922826617.
Norm before scaling: 14.943953520610664. Distance: 2.0294874320269565
Total norm for 5 adversaries is: 14.943953520610664. distance: 2.0294874320269565
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.2624, Accuracy: 8347/8991 (92.8373%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0023, Accuracy: 857/892 (96.0762%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   2,  Average loss: 0.0021, Accuracy: 858/892 (96.1883%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   3,  Average loss: 0.0012, Accuracy: 870/892 (97.5336%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   4,  Average loss: 0.0008, Accuracy: 878/892 (98.4305%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   5,  Average loss: 0.0007, Accuracy: 880/892 (98.6547%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   6,  Average loss: 0.0006, Accuracy: 882/892 (98.8789%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   7,  Average loss: 0.0006, Accuracy: 885/892 (99.2152%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   8,  Average loss: 0.0005, Accuracy: 887/892 (99.4395%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   9,  Average loss: 0.0005, Accuracy: 887/892 (99.4395%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch  10,  Average loss: 0.0005, Accuracy: 887/892 (99.4395%), train_poison_data_count: 892
Global model norm: 14.592876922826617.
Norm before scaling: 14.75336120584449. Distance: 1.782871512156
Total norm for 5 adversaries is: 14.75336120584449. distance: 1.782871512156
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 1.9061, Accuracy: 5013/8991 (55.7558%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   1,  Average loss: 0.0070, Accuracy: 250/293 (85.3242%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   2,  Average loss: 0.0039, Accuracy: 269/293 (91.8089%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   3,  Average loss: 0.0026, Accuracy: 281/293 (95.9044%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   4,  Average loss: 0.0021, Accuracy: 285/293 (97.2696%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   5,  Average loss: 0.0016, Accuracy: 289/293 (98.6348%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   6,  Average loss: 0.0014, Accuracy: 289/293 (98.6348%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   7,  Average loss: 0.0013, Accuracy: 289/293 (98.6348%), train_poison_data_count: 293
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   8,  Average loss: 0.0010, Accuracy: 290/293 (98.9761%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   9,  Average loss: 0.0010, Accuracy: 291/293 (99.3174%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch  10,  Average loss: 0.0009, Accuracy: 291/293 (99.3174%), train_poison_data_count: 293
Global model norm: 14.592876922826617.
Norm before scaling: 14.789739320223202. Distance: 1.5323956154997815
Total norm for 5 adversaries is: 14.789739320223202. distance: 1.5323956154997815
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5578, Accuracy: 7448/8991 (82.8384%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 383/418 (91.6268%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   2,  Average loss: 0.0027, Accuracy: 393/418 (94.0191%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   3,  Average loss: 0.0015, Accuracy: 406/418 (97.1292%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   4,  Average loss: 0.0009, Accuracy: 414/418 (99.0431%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   5,  Average loss: 0.0009, Accuracy: 414/418 (99.0431%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   6,  Average loss: 0.0007, Accuracy: 416/418 (99.5215%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   7,  Average loss: 0.0005, Accuracy: 416/418 (99.5215%), train_poison_data_count: 418
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   8,  Average loss: 0.0006, Accuracy: 416/418 (99.5215%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   9,  Average loss: 0.0004, Accuracy: 416/418 (99.5215%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch  10,  Average loss: 0.0005, Accuracy: 416/418 (99.5215%), train_poison_data_count: 418
Global model norm: 14.592876922826617.
Norm before scaling: 14.784832703692384. Distance: 1.3172758495888066
Total norm for 5 adversaries is: 14.784832703692384. distance: 1.3172758495888066
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.8519, Accuracy: 7429/8991 (82.6271%)
___Train Local_Simple,  epoch   7, local model 99, internal_epoch   1,  Average loss: 0.0115, Accuracy: 295/377 (78.2493%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.5706, Accuracy: 5682/10000 (56.8200%), Attack Success Rate:1/10000(0.010)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   1,  Average loss: 0.0045, Accuracy: 569/628 (90.6051%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   2,  Average loss: 0.0026, Accuracy: 596/628 (94.9045%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   3,  Average loss: 0.0016, Accuracy: 611/628 (97.2930%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   4,  Average loss: 0.0011, Accuracy: 615/628 (97.9299%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   5,  Average loss: 0.0010, Accuracy: 618/628 (98.4076%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   6,  Average loss: 0.0008, Accuracy: 620/628 (98.7261%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   7,  Average loss: 0.0007, Accuracy: 620/628 (98.7261%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   8,  Average loss: 0.0007, Accuracy: 623/628 (99.2038%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   9,  Average loss: 0.0006, Accuracy: 624/628 (99.3631%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch  10,  Average loss: 0.0006, Accuracy: 624/628 (99.3631%), train_poison_data_count: 628
Global model norm: 14.592876922826617.
Norm before scaling: 14.854197084343125. Distance: 2.0217555062360657
Total norm for 5 adversaries is: 14.854197084343125. distance: 2.0217555062360657
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.8066, Accuracy: 6853/8991 (76.2207%)
time spent on training: 98.74414110183716
[foolsgold agg] training data poison_ratio: 0.5304498269896194  data num: [660, 494, 760, 423, 835, 892, 293, 418, 377, 628]
[foolsgold agg] considering poison per batch poison_fraction: 0.5304498269896194
[foolsgold agg] wv: [1.         0.14058452 1.         1.         1.         1.
 1.         1.         0.14058452 1.        ]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 1.1088, Accuracy: 7967/10000 (79.6700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 0.3534, Accuracy: 7956/8991 (88.4885%)
Done in 278.8052861690521 sec.
Server Epoch:8 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
___Train Local_Simple,  epoch   8, local model 63, internal_epoch   1,  Average loss: 0.0144, Accuracy: 663/889 (74.5782%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.8780, Accuracy: 6917/10000 (69.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 55, internal_epoch   1,  Average loss: 0.0056, Accuracy: 316/354 (89.2655%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.2242, Accuracy: 5696/10000 (56.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 79, internal_epoch   1,  Average loss: 0.0325, Accuracy: 119/182 (65.3846%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.5344, Accuracy: 5902/10000 (59.0200%), Attack Success Rate:0/10000(0.000)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 408/436 (93.5780%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   2,  Average loss: 0.0033, Accuracy: 404/436 (92.6606%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   3,  Average loss: 0.0020, Accuracy: 422/436 (96.7890%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   4,  Average loss: 0.0015, Accuracy: 427/436 (97.9358%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   5,  Average loss: 0.0013, Accuracy: 429/436 (98.3945%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   6,  Average loss: 0.0011, Accuracy: 429/436 (98.3945%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   7,  Average loss: 0.0010, Accuracy: 430/436 (98.6239%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   8,  Average loss: 0.0009, Accuracy: 430/436 (98.6239%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   9,  Average loss: 0.0009, Accuracy: 430/436 (98.6239%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch  10,  Average loss: 0.0009, Accuracy: 430/436 (98.6239%), train_poison_data_count: 436
Global model norm: 14.682830977461236.
Norm before scaling: 14.80338879527991. Distance: 1.193355279344189
Total norm for 2 adversaries is: 14.80338879527991. distance: 1.193355279344189
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.3758, Accuracy: 7912/8991 (87.9991%)
___Train Local_Simple,  epoch   8, local model 62, internal_epoch   1,  Average loss: 0.0100, Accuracy: 346/423 (81.7967%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.5363, Accuracy: 8139/10000 (81.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 56, internal_epoch   1,  Average loss: 0.0089, Accuracy: 731/880 (83.0682%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.0659, Accuracy: 6801/10000 (68.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 96, internal_epoch   1,  Average loss: 0.0090, Accuracy: 564/672 (83.9286%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.0201, Accuracy: 5879/10000 (58.7900%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 1055/1160 (90.9483%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   2,  Average loss: 0.0023, Accuracy: 1114/1160 (96.0345%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   3,  Average loss: 0.0008, Accuracy: 1145/1160 (98.7069%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   4,  Average loss: 0.0006, Accuracy: 1150/1160 (99.1379%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1150/1160 (99.1379%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1153/1160 (99.3966%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1153/1160 (99.3966%), train_poison_data_count: 1160
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1154/1160 (99.4828%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1156/1160 (99.6552%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1156/1160 (99.6552%), train_poison_data_count: 1160
Global model norm: 14.682830977461236.
Norm before scaling: 15.25741796964958. Distance: 3.0097280768565544
Total norm for 2 adversaries is: 15.25741796964958. distance: 3.0097280768565544
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.4144, Accuracy: 8055/8991 (89.5896%)
___Train Local_Simple,  epoch   8, local model 92, internal_epoch   1,  Average loss: 0.0048, Accuracy: 847/937 (90.3949%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.7966, Accuracy: 5808/10000 (58.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 86, internal_epoch   1,  Average loss: 0.0190, Accuracy: 184/250 (73.6000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.4689, Accuracy: 5884/10000 (58.8400%), Attack Success Rate:0/10000(0.000)
time spent on training: 66.80991816520691
[foolsgold agg] training data poison_ratio: 0.25812712275594374  data num: [889, 354, 182, 436, 423, 880, 672, 1160, 937, 250]
[foolsgold agg] considering poison per batch poison_fraction: 0.25812712275594374
[foolsgold agg] wv: [1.         1.         0.         1.         0.90949906 1.
 1.         1.         0.90949906 0.        ]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 0.9405, Accuracy: 8249/10000 (82.4900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 0.2654, Accuracy: 8240/8991 (91.6472%)
Done in 235.67286491394043 sec.
Server Epoch:9 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   1,  Average loss: 0.0045, Accuracy: 453/501 (90.4192%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   2,  Average loss: 0.0028, Accuracy: 481/501 (96.0080%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   3,  Average loss: 0.0014, Accuracy: 489/501 (97.6048%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   4,  Average loss: 0.0012, Accuracy: 488/501 (97.4052%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   5,  Average loss: 0.0010, Accuracy: 491/501 (98.0040%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   6,  Average loss: 0.0009, Accuracy: 495/501 (98.8024%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   7,  Average loss: 0.0008, Accuracy: 495/501 (98.8024%), train_poison_data_count: 501
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   8,  Average loss: 0.0007, Accuracy: 496/501 (99.0020%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   9,  Average loss: 0.0007, Accuracy: 498/501 (99.4012%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch  10,  Average loss: 0.0007, Accuracy: 498/501 (99.4012%), train_poison_data_count: 501
Global model norm: 14.737753229012142.
Norm before scaling: 14.915615506491847. Distance: 1.2957935650151862
Total norm for 6 adversaries is: 14.915615506491847. distance: 1.2957935650151862
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.2024, Accuracy: 8449/8991 (93.9717%)
___Train Local_Simple,  epoch   9, local model 63, internal_epoch   1,  Average loss: 0.0084, Accuracy: 750/889 (84.3645%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6554, Accuracy: 8243/10000 (82.4300%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   1,  Average loss: 0.0044, Accuracy: 570/623 (91.4928%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   2,  Average loss: 0.0027, Accuracy: 586/623 (94.0610%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   3,  Average loss: 0.0013, Accuracy: 609/623 (97.7528%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   4,  Average loss: 0.0009, Accuracy: 612/623 (98.2343%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   5,  Average loss: 0.0008, Accuracy: 614/623 (98.5554%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 617/623 (99.0369%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   7,  Average loss: 0.0006, Accuracy: 618/623 (99.1974%), train_poison_data_count: 623
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   8,  Average loss: 0.0005, Accuracy: 618/623 (99.1974%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   9,  Average loss: 0.0004, Accuracy: 620/623 (99.5185%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch  10,  Average loss: 0.0004, Accuracy: 620/623 (99.5185%), train_poison_data_count: 623
Global model norm: 14.737753229012142.
Norm before scaling: 14.976172786889627. Distance: 1.753296336132989
Total norm for 6 adversaries is: 14.976172786889627. distance: 1.753296336132989
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 1.0138, Accuracy: 7086/8991 (78.8121%)
___Train Local_Simple,  epoch   9, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 1286/1384 (92.9191%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.6750, Accuracy: 7397/10000 (73.9700%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 695/734 (94.6866%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   2,  Average loss: 0.0014, Accuracy: 714/734 (97.2752%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   3,  Average loss: 0.0005, Accuracy: 729/734 (99.3188%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   4,  Average loss: 0.0004, Accuracy: 730/734 (99.4550%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   5,  Average loss: 0.0003, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   6,  Average loss: 0.0003, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   7,  Average loss: 0.0003, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   8,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   9,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch  10,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Global model norm: 14.737753229012142.
Norm before scaling: 14.880462412878632. Distance: 1.4839570912792373
Total norm for 6 adversaries is: 14.880462412878632. distance: 1.4839570912792373
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.8682, Accuracy: 7325/8991 (81.4704%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   1,  Average loss: 0.0052, Accuracy: 891/977 (91.1975%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   2,  Average loss: 0.0029, Accuracy: 922/977 (94.3705%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   3,  Average loss: 0.0018, Accuracy: 947/977 (96.9294%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   4,  Average loss: 0.0011, Accuracy: 957/977 (97.9529%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   5,  Average loss: 0.0010, Accuracy: 956/977 (97.8506%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   6,  Average loss: 0.0009, Accuracy: 962/977 (98.4647%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   7,  Average loss: 0.0008, Accuracy: 966/977 (98.8741%), train_poison_data_count: 977
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   8,  Average loss: 0.0007, Accuracy: 966/977 (98.8741%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   9,  Average loss: 0.0006, Accuracy: 967/977 (98.9765%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch  10,  Average loss: 0.0007, Accuracy: 968/977 (99.0788%), train_poison_data_count: 977
Global model norm: 14.737753229012142.
Norm before scaling: 15.135003935123734. Distance: 2.340409199401269
Total norm for 6 adversaries is: 15.135003935123734. distance: 2.340409199401269
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.3343, Accuracy: 8073/8991 (89.7898%)
___Train Local_Simple,  epoch   9, local model 76, internal_epoch   1,  Average loss: 0.0166, Accuracy: 63/78 (80.7692%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.9026, Accuracy: 8015/10000 (80.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 97, internal_epoch   1,  Average loss: 0.0039, Accuracy: 446/487 (91.5811%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.1865, Accuracy: 7330/10000 (73.3000%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   1,  Average loss: 0.0043, Accuracy: 268/293 (91.4676%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   2,  Average loss: 0.0026, Accuracy: 282/293 (96.2457%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   3,  Average loss: 0.0024, Accuracy: 281/293 (95.9044%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   4,  Average loss: 0.0014, Accuracy: 289/293 (98.6348%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   5,  Average loss: 0.0009, Accuracy: 291/293 (99.3174%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   6,  Average loss: 0.0010, Accuracy: 290/293 (98.9761%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   7,  Average loss: 0.0009, Accuracy: 290/293 (98.9761%), train_poison_data_count: 293
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   8,  Average loss: 0.0007, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   9,  Average loss: 0.0006, Accuracy: 291/293 (99.3174%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch  10,  Average loss: 0.0006, Accuracy: 291/293 (99.3174%), train_poison_data_count: 293
Global model norm: 14.737753229012142.
Norm before scaling: 14.842837656995176. Distance: 1.062000044835264
Total norm for 6 adversaries is: 14.842837656995176. distance: 1.062000044835264
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.4339, Accuracy: 7731/8991 (85.9860%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   1,  Average loss: 0.0029, Accuracy: 612/647 (94.5904%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   2,  Average loss: 0.0020, Accuracy: 618/647 (95.5178%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   3,  Average loss: 0.0019, Accuracy: 626/647 (96.7543%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   4,  Average loss: 0.0010, Accuracy: 633/647 (97.8362%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   5,  Average loss: 0.0007, Accuracy: 640/647 (98.9181%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   6,  Average loss: 0.0006, Accuracy: 640/647 (98.9181%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   7,  Average loss: 0.0005, Accuracy: 642/647 (99.2272%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   8,  Average loss: 0.0004, Accuracy: 644/647 (99.5363%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   9,  Average loss: 0.0004, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch  10,  Average loss: 0.0004, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Global model norm: 14.737753229012142.
Norm before scaling: 14.910421303643584. Distance: 1.4646759343977613
Total norm for 6 adversaries is: 14.910421303643584. distance: 1.4646759343977613
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.6901, Accuracy: 6986/8991 (77.6999%)
time spent on training: 111.28939700126648
[foolsgold agg] training data poison_ratio: 0.570845304702858  data num: [501, 889, 623, 1384, 734, 977, 78, 487, 293, 647]
[foolsgold agg] considering poison per batch poison_fraction: 0.570845304702858
[foolsgold agg] wv: [1.         1.         1.         0.07804474 1.         1.
 0.07804474 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 1.1116, Accuracy: 8211/10000 (82.1100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 0.2951, Accuracy: 8197/8991 (91.1689%)
Done in 292.9193789958954 sec.
Server Epoch:10 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0032, Accuracy: 1092/1160 (94.1379%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   2,  Average loss: 0.0018, Accuracy: 1119/1160 (96.4655%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   3,  Average loss: 0.0007, Accuracy: 1143/1160 (98.5345%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1152/1160 (99.3103%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1152/1160 (99.3103%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1155/1160 (99.5690%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1155/1160 (99.5690%), train_poison_data_count: 1160
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1156/1160 (99.6552%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1156/1160 (99.6552%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1157/1160 (99.7414%), train_poison_data_count: 1160
Global model norm: 14.84057017750192.
Norm before scaling: 15.151856342057615. Distance: 2.189843475635741
Total norm for 7 adversaries is: 15.151856342057615. distance: 2.189843475635741
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.3251, Accuracy: 8229/8991 (91.5249%)
___Train Local_Simple,  epoch  10, local model 56, internal_epoch   1,  Average loss: 0.0087, Accuracy: 728/880 (82.7273%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.3056, Accuracy: 7379/10000 (73.7900%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   1,  Average loss: 0.0071, Accuracy: 180/205 (87.8049%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   2,  Average loss: 0.0028, Accuracy: 197/205 (96.0976%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   3,  Average loss: 0.0022, Accuracy: 198/205 (96.5854%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   4,  Average loss: 0.0022, Accuracy: 198/205 (96.5854%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   5,  Average loss: 0.0014, Accuracy: 199/205 (97.0732%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   6,  Average loss: 0.0010, Accuracy: 201/205 (98.0488%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   7,  Average loss: 0.0008, Accuracy: 204/205 (99.5122%), train_poison_data_count: 205
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   8,  Average loss: 0.0007, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   9,  Average loss: 0.0007, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch  10,  Average loss: 0.0007, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Global model norm: 14.84057017750192.
Norm before scaling: 14.886565512692036. Distance: 1.086135297366673
Total norm for 7 adversaries is: 14.886565512692036. distance: 1.086135297366673
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.7386, Accuracy: 6648/8991 (73.9406%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 583/645 (90.3876%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   2,  Average loss: 0.0033, Accuracy: 610/645 (94.5736%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   3,  Average loss: 0.0017, Accuracy: 624/645 (96.7442%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 630/645 (97.6744%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 636/645 (98.6047%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 638/645 (98.9147%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   7,  Average loss: 0.0010, Accuracy: 638/645 (98.9147%), train_poison_data_count: 645
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   8,  Average loss: 0.0008, Accuracy: 638/645 (98.9147%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   9,  Average loss: 0.0008, Accuracy: 638/645 (98.9147%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch  10,  Average loss: 0.0007, Accuracy: 639/645 (99.0698%), train_poison_data_count: 645
Global model norm: 14.84057017750192.
Norm before scaling: 15.179260781926839. Distance: 2.3406848446538433
Total norm for 7 adversaries is: 15.179260781926839. distance: 2.3406848446538433
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.4235, Accuracy: 7750/8991 (86.1973%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 687/734 (93.5967%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   2,  Average loss: 0.0016, Accuracy: 712/734 (97.0027%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   3,  Average loss: 0.0006, Accuracy: 727/734 (99.0463%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   4,  Average loss: 0.0004, Accuracy: 731/734 (99.5913%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   5,  Average loss: 0.0003, Accuracy: 732/734 (99.7275%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   6,  Average loss: 0.0003, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   7,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   8,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   9,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch  10,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Global model norm: 14.84057017750192.
Norm before scaling: 14.975556357211168. Distance: 1.617362929702085
Total norm for 7 adversaries is: 14.975556357211168. distance: 1.617362929702085
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.5795, Accuracy: 7511/8991 (83.5391%)
___Train Local_Simple,  epoch  10, local model 78, internal_epoch   1,  Average loss: 0.0042, Accuracy: 279/303 (92.0792%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.7939, Accuracy: 7405/10000 (74.0500%), Attack Success Rate:0/10000(0.000)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   1,  Average loss: 0.0030, Accuracy: 467/506 (92.2925%), train_poison_data_count: 506
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   2,  Average loss: 0.0040, Accuracy: 475/506 (93.8735%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   3,  Average loss: 0.0019, Accuracy: 487/506 (96.2451%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   4,  Average loss: 0.0015, Accuracy: 490/506 (96.8379%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   5,  Average loss: 0.0011, Accuracy: 495/506 (97.8261%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   6,  Average loss: 0.0008, Accuracy: 499/506 (98.6166%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   7,  Average loss: 0.0007, Accuracy: 499/506 (98.6166%), train_poison_data_count: 506
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   8,  Average loss: 0.0006, Accuracy: 502/506 (99.2095%), train_poison_data_count: 506
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   9,  Average loss: 0.0005, Accuracy: 503/506 (99.4071%), train_poison_data_count: 506
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch  10,  Average loss: 0.0005, Accuracy: 504/506 (99.6047%), train_poison_data_count: 506
Global model norm: 14.84057017750192.
Norm before scaling: 15.007064681557328. Distance: 1.606743967417991
Total norm for 7 adversaries is: 15.007064681557328. distance: 1.606743967417991
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.2667, Accuracy: 8216/8991 (91.3803%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   1,  Average loss: 0.0023, Accuracy: 394/413 (95.3995%), train_poison_data_count: 413
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   2,  Average loss: 0.0013, Accuracy: 404/413 (97.8208%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   3,  Average loss: 0.0025, Accuracy: 398/413 (96.3680%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   4,  Average loss: 0.0009, Accuracy: 407/413 (98.5472%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   5,  Average loss: 0.0006, Accuracy: 410/413 (99.2736%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   6,  Average loss: 0.0006, Accuracy: 410/413 (99.2736%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   7,  Average loss: 0.0005, Accuracy: 411/413 (99.5157%), train_poison_data_count: 413
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   8,  Average loss: 0.0003, Accuracy: 412/413 (99.7579%), train_poison_data_count: 413
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   9,  Average loss: 0.0003, Accuracy: 413/413 (100.0000%), train_poison_data_count: 413
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch  10,  Average loss: 0.0003, Accuracy: 413/413 (100.0000%), train_poison_data_count: 413
Global model norm: 14.84057017750192.
Norm before scaling: 14.904326948641197. Distance: 1.0426044756638326
Total norm for 7 adversaries is: 14.904326948641197. distance: 1.0426044756638326
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.4120, Accuracy: 7841/8991 (87.2094%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 349/376 (92.8191%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 349/376 (92.8191%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   3,  Average loss: 0.0022, Accuracy: 364/376 (96.8085%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   4,  Average loss: 0.0017, Accuracy: 369/376 (98.1383%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   5,  Average loss: 0.0013, Accuracy: 371/376 (98.6702%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   6,  Average loss: 0.0010, Accuracy: 370/376 (98.4043%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   7,  Average loss: 0.0009, Accuracy: 372/376 (98.9362%), train_poison_data_count: 376
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   8,  Average loss: 0.0008, Accuracy: 372/376 (98.9362%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   9,  Average loss: 0.0007, Accuracy: 373/376 (99.2021%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch  10,  Average loss: 0.0007, Accuracy: 373/376 (99.2021%), train_poison_data_count: 376
Global model norm: 14.84057017750192.
Norm before scaling: 14.872641496650507. Distance: 1.2190694634796801
Total norm for 7 adversaries is: 14.872641496650507. distance: 1.2190694634796801
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.4497, Accuracy: 7431/8991 (82.6493%)
___Train Local_Simple,  epoch  10, local model 99, internal_epoch   1,  Average loss: 0.0277, Accuracy: 247/377 (65.5172%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.7013, Accuracy: 4828/10000 (48.2800%), Attack Success Rate:1/10000(0.010)
time spent on training: 116.79130506515503
[foolsgold agg] training data poison_ratio: 0.7213788176460082  data num: [1160, 880, 205, 645, 734, 303, 506, 413, 376, 377]
[foolsgold agg] considering poison per batch poison_fraction: 0.7213788176460082
[foolsgold agg] wv: [1.        1.        1.        1.        0.6509398 1.        0.6509398
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 0.9750, Accuracy: 8430/10000 (84.3000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 0.2163, Accuracy: 8414/8991 (93.5825%)
Done in 284.33061695098877 sec.
Server Epoch:11 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
___Train Local_Simple,  epoch  11, local model 53, internal_epoch   1,  Average loss: 0.0054, Accuracy: 670/739 (90.6631%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.2599, Accuracy: 6522/10000 (65.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 56, internal_epoch   1,  Average loss: 0.0095, Accuracy: 731/880 (83.0682%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.8976, Accuracy: 7935/10000 (79.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0056, Accuracy: 511/568 (89.9648%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.4975, Accuracy: 5405/10000 (54.0500%), Attack Success Rate:1/10000(0.010)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 363/376 (96.5426%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   2,  Average loss: 0.0034, Accuracy: 352/376 (93.6170%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   3,  Average loss: 0.0033, Accuracy: 348/376 (92.5532%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   4,  Average loss: 0.0010, Accuracy: 371/376 (98.6702%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   5,  Average loss: 0.0011, Accuracy: 367/376 (97.6064%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   6,  Average loss: 0.0010, Accuracy: 368/376 (97.8723%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   7,  Average loss: 0.0006, Accuracy: 371/376 (98.6702%), train_poison_data_count: 376
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   8,  Average loss: 0.0005, Accuracy: 375/376 (99.7340%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   9,  Average loss: 0.0005, Accuracy: 375/376 (99.7340%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch  10,  Average loss: 0.0005, Accuracy: 375/376 (99.7340%), train_poison_data_count: 376
Global model norm: 14.93209626205567.
Norm before scaling: 14.940932386276604. Distance: 1.0577595932772743
Total norm for 5 adversaries is: 14.940932386276604. distance: 1.0577595932772743
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.2950, Accuracy: 8037/8991 (89.3894%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 952/1005 (94.7264%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   2,  Average loss: 0.0013, Accuracy: 979/1005 (97.4129%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   3,  Average loss: 0.0005, Accuracy: 997/1005 (99.2040%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1002/1005 (99.7015%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1002/1005 (99.7015%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1003/1005 (99.8010%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1004/1005 (99.9005%), train_poison_data_count: 1005
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1004/1005 (99.9005%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Global model norm: 14.93209626205567.
Norm before scaling: 15.173105961906744. Distance: 2.13276543757457
Total norm for 5 adversaries is: 15.173105961906744. distance: 2.13276543757457
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.8470, Accuracy: 7775/8991 (86.4754%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 571/615 (92.8455%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   2,  Average loss: 0.0031, Accuracy: 585/615 (95.1220%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   3,  Average loss: 0.0014, Accuracy: 602/615 (97.8862%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   4,  Average loss: 0.0007, Accuracy: 610/615 (99.1870%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   5,  Average loss: 0.0006, Accuracy: 610/615 (99.1870%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   6,  Average loss: 0.0004, Accuracy: 613/615 (99.6748%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   7,  Average loss: 0.0004, Accuracy: 614/615 (99.8374%), train_poison_data_count: 615
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   8,  Average loss: 0.0003, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   9,  Average loss: 0.0003, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch  10,  Average loss: 0.0003, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Global model norm: 14.93209626205567.
Norm before scaling: 15.07687919885787. Distance: 1.5748786395106804
Total norm for 5 adversaries is: 15.07687919885787. distance: 1.5748786395106804
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.3023, Accuracy: 8136/8991 (90.4905%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0051, Accuracy: 646/710 (90.9859%), train_poison_data_count: 710
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   2,  Average loss: 0.0052, Accuracy: 641/710 (90.2817%), train_poison_data_count: 710
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   3,  Average loss: 0.0026, Accuracy: 675/710 (95.0704%), train_poison_data_count: 710
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   4,  Average loss: 0.0017, Accuracy: 694/710 (97.7465%), train_poison_data_count: 710
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   5,  Average loss: 0.0014, Accuracy: 695/710 (97.8873%), train_poison_data_count: 710
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   6,  Average loss: 0.0010, Accuracy: 699/710 (98.4507%), train_poison_data_count: 710
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   7,  Average loss: 0.0012, Accuracy: 701/710 (98.7324%), train_poison_data_count: 710
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   8,  Average loss: 0.0008, Accuracy: 703/710 (99.0141%), train_poison_data_count: 710
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   9,  Average loss: 0.0007, Accuracy: 702/710 (98.8732%), train_poison_data_count: 710
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch  10,  Average loss: 0.0007, Accuracy: 703/710 (99.0141%), train_poison_data_count: 710
Global model norm: 14.93209626205567.
Norm before scaling: 15.263813703955591. Distance: 2.729840251314896
Total norm for 5 adversaries is: 15.263813703955591. distance: 2.729840251314896
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.7129, Accuracy: 6921/8991 (76.9770%)
___Train Local_Simple,  epoch  11, local model 99, internal_epoch   1,  Average loss: 0.0164, Accuracy: 307/377 (81.4324%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.1889, Accuracy: 6245/10000 (62.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 88, internal_epoch   1,  Average loss: 0.0116, Accuracy: 438/530 (82.6415%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.4324, Accuracy: 2940/10000 (29.4000%), Attack Success Rate:1/10000(0.010)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0029, Accuracy: 819/860 (95.2326%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   2,  Average loss: 0.0017, Accuracy: 833/860 (96.8605%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   3,  Average loss: 0.0007, Accuracy: 850/860 (98.8372%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   4,  Average loss: 0.0005, Accuracy: 852/860 (99.0698%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   5,  Average loss: 0.0004, Accuracy: 855/860 (99.4186%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   6,  Average loss: 0.0004, Accuracy: 855/860 (99.4186%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   7,  Average loss: 0.0003, Accuracy: 857/860 (99.6512%), train_poison_data_count: 860
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   8,  Average loss: 0.0003, Accuracy: 857/860 (99.6512%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   9,  Average loss: 0.0003, Accuracy: 858/860 (99.7674%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch  10,  Average loss: 0.0003, Accuracy: 858/860 (99.7674%), train_poison_data_count: 860
Global model norm: 14.93209626205567.
Norm before scaling: 15.115769272944418. Distance: 1.8723524475022983
Total norm for 5 adversaries is: 15.115769272944418. distance: 1.8723524475022983
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.3242, Accuracy: 8042/8991 (89.4450%)
time spent on training: 106.5172278881073
[foolsgold agg] training data poison_ratio: 0.5354354354354355  data num: [739, 880, 568, 376, 1005, 615, 710, 377, 530, 860]
[foolsgold agg] considering poison per batch poison_fraction: 0.5354354354354355
[foolsgold agg] wv: [1.         0.79242493 1.         1.         1.         1.
 1.         0.79242493 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.8975, Accuracy: 8505/10000 (85.0500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 0.2059, Accuracy: 8464/8991 (94.1386%)
Done in 296.82991099357605 sec.
Server Epoch:12 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0035, Accuracy: 220/236 (93.2203%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   2,  Average loss: 0.0028, Accuracy: 224/236 (94.9153%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   3,  Average loss: 0.0011, Accuracy: 234/236 (99.1525%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   4,  Average loss: 0.0007, Accuracy: 234/236 (99.1525%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   5,  Average loss: 0.0006, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   6,  Average loss: 0.0005, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   7,  Average loss: 0.0004, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   8,  Average loss: 0.0004, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   9,  Average loss: 0.0003, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch  10,  Average loss: 0.0003, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Global model norm: 15.01673565904107.
Norm before scaling: 15.029274412142083. Distance: 0.8578480766992986
Total norm for 8 adversaries is: 15.029274412142083. distance: 0.8578480766992986
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.2733, Accuracy: 8217/8991 (91.3914%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   1,  Average loss: 0.0042, Accuracy: 577/620 (93.0645%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   2,  Average loss: 0.0020, Accuracy: 596/620 (96.1290%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   3,  Average loss: 0.0013, Accuracy: 608/620 (98.0645%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   4,  Average loss: 0.0010, Accuracy: 608/620 (98.0645%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   5,  Average loss: 0.0008, Accuracy: 610/620 (98.3871%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   6,  Average loss: 0.0008, Accuracy: 612/620 (98.7097%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   7,  Average loss: 0.0006, Accuracy: 614/620 (99.0323%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   8,  Average loss: 0.0005, Accuracy: 616/620 (99.3548%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   9,  Average loss: 0.0005, Accuracy: 616/620 (99.3548%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 616/620 (99.3548%), train_poison_data_count: 620
Global model norm: 15.01673565904107.
Norm before scaling: 15.103171999396663. Distance: 1.776817361203411
Total norm for 8 adversaries is: 15.103171999396663. distance: 1.776817361203411
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.7990, Accuracy: 6803/8991 (75.6646%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 514/548 (93.7956%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   2,  Average loss: 0.0015, Accuracy: 534/548 (97.4453%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   3,  Average loss: 0.0014, Accuracy: 537/548 (97.9927%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   4,  Average loss: 0.0010, Accuracy: 540/548 (98.5401%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   5,  Average loss: 0.0008, Accuracy: 543/548 (99.0876%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   6,  Average loss: 0.0006, Accuracy: 545/548 (99.4526%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   7,  Average loss: 0.0006, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   8,  Average loss: 0.0006, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   9,  Average loss: 0.0004, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch  10,  Average loss: 0.0004, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Global model norm: 15.01673565904107.
Norm before scaling: 15.042941869782528. Distance: 1.4320954436936186
Total norm for 8 adversaries is: 15.042941869782528. distance: 1.4320954436936186
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.2986, Accuracy: 8144/8991 (90.5795%)
___Train Local_Simple,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0101, Accuracy: 669/813 (82.2878%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.3249, Accuracy: 6302/10000 (63.0200%), Attack Success Rate:0/10000(0.000)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 578/615 (93.9837%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   2,  Average loss: 0.0018, Accuracy: 597/615 (97.0732%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   3,  Average loss: 0.0007, Accuracy: 613/615 (99.6748%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   4,  Average loss: 0.0005, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   5,  Average loss: 0.0004, Accuracy: 614/615 (99.8374%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   6,  Average loss: 0.0003, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   7,  Average loss: 0.0003, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   8,  Average loss: 0.0002, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   9,  Average loss: 0.0002, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch  10,  Average loss: 0.0002, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Global model norm: 15.01673565904107.
Norm before scaling: 15.129270849111707. Distance: 1.4198054248855023
Total norm for 8 adversaries is: 15.129270849111707. distance: 1.4198054248855023
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.2643, Accuracy: 8248/8991 (91.7362%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   1,  Average loss: 0.0037, Accuracy: 831/895 (92.8492%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   2,  Average loss: 0.0023, Accuracy: 859/895 (95.9777%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   3,  Average loss: 0.0011, Accuracy: 878/895 (98.1006%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   4,  Average loss: 0.0007, Accuracy: 886/895 (98.9944%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   5,  Average loss: 0.0006, Accuracy: 885/895 (98.8827%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   6,  Average loss: 0.0005, Accuracy: 887/895 (99.1061%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   7,  Average loss: 0.0004, Accuracy: 888/895 (99.2179%), train_poison_data_count: 895
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   8,  Average loss: 0.0004, Accuracy: 891/895 (99.5531%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   9,  Average loss: 0.0003, Accuracy: 892/895 (99.6648%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch  10,  Average loss: 0.0003, Accuracy: 892/895 (99.6648%), train_poison_data_count: 895
Global model norm: 15.01673565904107.
Norm before scaling: 15.222832666734995. Distance: 2.1421136065648283
Total norm for 8 adversaries is: 15.222832666734995. distance: 2.1421136065648283
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.8756, Accuracy: 7197/8991 (80.0467%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0025, Accuracy: 821/860 (95.4651%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   2,  Average loss: 0.0018, Accuracy: 830/860 (96.5116%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   3,  Average loss: 0.0008, Accuracy: 852/860 (99.0698%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   4,  Average loss: 0.0005, Accuracy: 855/860 (99.4186%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   5,  Average loss: 0.0004, Accuracy: 854/860 (99.3023%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   6,  Average loss: 0.0004, Accuracy: 856/860 (99.5349%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   7,  Average loss: 0.0003, Accuracy: 857/860 (99.6512%), train_poison_data_count: 860
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   8,  Average loss: 0.0003, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   9,  Average loss: 0.0002, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch  10,  Average loss: 0.0002, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Global model norm: 15.01673565904107.
Norm before scaling: 15.151149874821279. Distance: 1.89579765230354
Total norm for 8 adversaries is: 15.151149874821279. distance: 1.89579765230354
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.3510, Accuracy: 7984/8991 (88.7999%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   1,  Average loss: 0.0060, Accuracy: 476/517 (92.0696%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   2,  Average loss: 0.0074, Accuracy: 458/517 (88.5880%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   3,  Average loss: 0.0051, Accuracy: 467/517 (90.3288%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   4,  Average loss: 0.0023, Accuracy: 500/517 (96.7118%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   5,  Average loss: 0.0020, Accuracy: 502/517 (97.0986%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   6,  Average loss: 0.0015, Accuracy: 506/517 (97.8723%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   7,  Average loss: 0.0014, Accuracy: 508/517 (98.2592%), train_poison_data_count: 517
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   8,  Average loss: 0.0012, Accuracy: 511/517 (98.8395%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   9,  Average loss: 0.0011, Accuracy: 510/517 (98.6460%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch  10,  Average loss: 0.0042, Accuracy: 510/517 (98.6460%), train_poison_data_count: 517
Global model norm: 15.01673565904107.
Norm before scaling: 15.305236339221098. Distance: 2.7458823327500466
Total norm for 8 adversaries is: 15.305236339221098. distance: 2.7458823327500466
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.2076, Accuracy: 8393/8991 (93.3489%)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0169, Accuracy: 477/589 (80.9847%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.5360, Accuracy: 5713/10000 (57.1300%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 599/658 (91.0334%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   2,  Average loss: 0.0031, Accuracy: 625/658 (94.9848%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   3,  Average loss: 0.0011, Accuracy: 640/658 (97.2644%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   4,  Average loss: 0.0009, Accuracy: 646/658 (98.1763%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   5,  Average loss: 0.0008, Accuracy: 650/658 (98.7842%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   6,  Average loss: 0.0006, Accuracy: 653/658 (99.2401%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   7,  Average loss: 0.0007, Accuracy: 653/658 (99.2401%), train_poison_data_count: 658
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   8,  Average loss: 0.0005, Accuracy: 654/658 (99.3921%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   9,  Average loss: 0.0005, Accuracy: 656/658 (99.6960%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch  10,  Average loss: 0.0004, Accuracy: 656/658 (99.6960%), train_poison_data_count: 658
Global model norm: 15.01673565904107.
Norm before scaling: 15.298272447978501. Distance: 2.485981931355275
Total norm for 8 adversaries is: 15.298272447978501. distance: 2.485981931355275
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.0078, Accuracy: 6885/8991 (76.5766%)
time spent on training: 271.209166765213
[foolsgold agg] training data poison_ratio: 0.7792473626200598  data num: [236, 620, 548, 813, 615, 895, 860, 517, 589, 658]
[foolsgold agg] considering poison per batch poison_fraction: 0.7792473626200598
[foolsgold agg] wv: [1. 1. 1. 0. 1. 1. 1. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.3345, Accuracy: 8443/10000 (84.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 0.2558, Accuracy: 8410/8991 (93.5380%)
Done in 705.5368168354034 sec.
Server Epoch:13 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0026, Accuracy: 366/379 (96.5699%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   2,  Average loss: 0.0021, Accuracy: 364/379 (96.0422%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   3,  Average loss: 0.0010, Accuracy: 372/379 (98.1530%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   4,  Average loss: 0.0005, Accuracy: 377/379 (99.4723%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   5,  Average loss: 0.0004, Accuracy: 377/379 (99.4723%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   6,  Average loss: 0.0004, Accuracy: 378/379 (99.7361%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   7,  Average loss: 0.0003, Accuracy: 378/379 (99.7361%), train_poison_data_count: 379
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   8,  Average loss: 0.0002, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   9,  Average loss: 0.0002, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch  10,  Average loss: 0.0002, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Global model norm: 15.135778700648341.
Norm before scaling: 15.116753970689327. Distance: 1.1019385487303353
Total norm for 6 adversaries is: 15.116753970689327. distance: 1.1019385487303353
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.2490, Accuracy: 8248/8991 (91.7362%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   1,  Average loss: 0.0024, Accuracy: 851/895 (95.0838%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   2,  Average loss: 0.0018, Accuracy: 863/895 (96.4246%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   3,  Average loss: 0.0009, Accuracy: 878/895 (98.1006%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   4,  Average loss: 0.0006, Accuracy: 886/895 (98.9944%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   5,  Average loss: 0.0004, Accuracy: 890/895 (99.4413%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   6,  Average loss: 0.0003, Accuracy: 891/895 (99.5531%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   7,  Average loss: 0.0003, Accuracy: 892/895 (99.6648%), train_poison_data_count: 895
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   8,  Average loss: 0.0002, Accuracy: 893/895 (99.7765%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   9,  Average loss: 0.0002, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch  10,  Average loss: 0.0002, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Global model norm: 15.135778700648341.
Norm before scaling: 15.268088197672755. Distance: 2.018489133437537
Total norm for 6 adversaries is: 15.268088197672755. distance: 2.018489133437537
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.7140, Accuracy: 7313/8991 (81.3369%)
___Train Local_Simple,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0342, Accuracy: 181/253 (71.5415%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.6530, Accuracy: 4883/10000 (48.8300%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 859/892 (96.3004%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   2,  Average loss: 0.0008, Accuracy: 882/892 (98.8789%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   3,  Average loss: 0.0006, Accuracy: 882/892 (98.8789%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   4,  Average loss: 0.0004, Accuracy: 885/892 (99.2152%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   5,  Average loss: 0.0003, Accuracy: 887/892 (99.4395%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   6,  Average loss: 0.0003, Accuracy: 889/892 (99.6637%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   7,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   8,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   9,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch  10,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%), train_poison_data_count: 892
Global model norm: 15.135778700648341.
Norm before scaling: 15.162101701378. Distance: 2.08205048800915
Total norm for 6 adversaries is: 15.162101701378. distance: 2.08205048800915
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 2.0831, Accuracy: 5137/8991 (57.1349%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 585/645 (90.6977%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   2,  Average loss: 0.0033, Accuracy: 609/645 (94.4186%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   3,  Average loss: 0.0032, Accuracy: 622/645 (96.4341%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 631/645 (97.8295%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 634/645 (98.2946%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 637/645 (98.7597%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   7,  Average loss: 0.0009, Accuracy: 635/645 (98.4496%), train_poison_data_count: 645
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   8,  Average loss: 0.0013, Accuracy: 639/645 (99.0698%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   9,  Average loss: 0.0007, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch  10,  Average loss: 0.0005, Accuracy: 642/645 (99.5349%), train_poison_data_count: 645
Global model norm: 15.135778700648341.
Norm before scaling: 15.434876995183515. Distance: 2.596938138669352
Total norm for 6 adversaries is: 15.434876995183515. distance: 2.596938138669352
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.3851, Accuracy: 7927/8991 (88.1659%)
___Train Local_Simple,  epoch  13, local model 76, internal_epoch   1,  Average loss: 0.0187, Accuracy: 69/78 (88.4615%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.7463, Accuracy: 7937/10000 (79.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 97, internal_epoch   1,  Average loss: 0.0136, Accuracy: 406/487 (83.3676%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.4373, Accuracy: 5831/10000 (58.3100%), Attack Success Rate:0/10000(0.000)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 381/418 (91.1483%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   2,  Average loss: 0.0028, Accuracy: 392/418 (93.7799%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   3,  Average loss: 0.0016, Accuracy: 409/418 (97.8469%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   4,  Average loss: 0.0010, Accuracy: 416/418 (99.5215%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   5,  Average loss: 0.0007, Accuracy: 416/418 (99.5215%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   6,  Average loss: 0.0006, Accuracy: 416/418 (99.5215%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   7,  Average loss: 0.0005, Accuracy: 415/418 (99.2823%), train_poison_data_count: 418
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   8,  Average loss: 0.0004, Accuracy: 416/418 (99.5215%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   9,  Average loss: 0.0004, Accuracy: 416/418 (99.5215%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch  10,  Average loss: 0.0004, Accuracy: 417/418 (99.7608%), train_poison_data_count: 418
Global model norm: 15.135778700648341.
Norm before scaling: 15.21662527679686. Distance: 1.6897102292625537
Total norm for 6 adversaries is: 15.21662527679686. distance: 1.6897102292625537
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.2256, Accuracy: 8301/8991 (92.3257%)
___Train Local_Simple,  epoch  13, local model 70, internal_epoch   1,  Average loss: 0.0071, Accuracy: 641/724 (88.5359%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.4540, Accuracy: 6314/10000 (63.1400%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 356/376 (94.6809%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   2,  Average loss: 0.0033, Accuracy: 355/376 (94.4149%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   3,  Average loss: 0.0024, Accuracy: 360/376 (95.7447%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   4,  Average loss: 0.0009, Accuracy: 371/376 (98.6702%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   5,  Average loss: 0.0008, Accuracy: 372/376 (98.9362%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   6,  Average loss: 0.0006, Accuracy: 372/376 (98.9362%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   7,  Average loss: 0.0005, Accuracy: 372/376 (98.9362%), train_poison_data_count: 376
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   8,  Average loss: 0.0004, Accuracy: 375/376 (99.7340%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   9,  Average loss: 0.0003, Accuracy: 375/376 (99.7340%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch  10,  Average loss: 0.0003, Accuracy: 375/376 (99.7340%), train_poison_data_count: 376
Global model norm: 15.135778700648341.
Norm before scaling: 15.133113986090756. Distance: 1.3731119023819627
Total norm for 6 adversaries is: 15.133113986090756. distance: 1.3731119023819627
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.2946, Accuracy: 8102/8991 (90.1123%)
time spent on training: 279.74064898490906
[foolsgold agg] training data poison_ratio: 0.7004080046629104  data num: [379, 895, 253, 892, 645, 78, 487, 418, 724, 376]
[foolsgold agg] considering poison per batch poison_fraction: 0.7004080046629104
[foolsgold agg] wv: [1.         0.93300558 0.         1.         0.83927079 0.
 1.         0.83927079 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.5066, Accuracy: 8385/10000 (83.8500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 0.2895, Accuracy: 8347/8991 (92.8373%)
Done in 763.552453994751 sec.
Server Epoch:14 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0514, Accuracy: 328/602 (54.4850%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 4.7260, Accuracy: 982/10000 (9.8200%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  14, local model 97, internal_epoch   1,  Average loss: 0.0031, Accuracy: 462/487 (94.8665%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9849, Accuracy: 8070/10000 (80.7000%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 1080/1160 (93.1034%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   2,  Average loss: 0.0016, Accuracy: 1123/1160 (96.8103%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1145/1160 (98.7069%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1154/1160 (99.4828%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1154/1160 (99.4828%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1156/1160 (99.6552%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1156/1160 (99.6552%), train_poison_data_count: 1160
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1157/1160 (99.7414%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1158/1160 (99.8276%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1158/1160 (99.8276%), train_poison_data_count: 1160
Global model norm: 15.203164644571897.
Norm before scaling: 15.651758825170067. Distance: 3.037502957566317
Total norm for 4 adversaries is: 15.651758825170067. distance: 3.037502957566317
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.4651, Accuracy: 8052/8991 (89.5562%)
___Train Local_Simple,  epoch  14, local model 89, internal_epoch   1,  Average loss: 0.0122, Accuracy: 402/492 (81.7073%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.8955, Accuracy: 3671/10000 (36.7100%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 614/647 (94.8995%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   2,  Average loss: 0.0040, Accuracy: 608/647 (93.9722%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   3,  Average loss: 0.0019, Accuracy: 629/647 (97.2179%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   4,  Average loss: 0.0016, Accuracy: 635/647 (98.1453%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   5,  Average loss: 0.0011, Accuracy: 636/647 (98.2998%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   6,  Average loss: 0.0009, Accuracy: 638/647 (98.6090%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   7,  Average loss: 0.0008, Accuracy: 638/647 (98.6090%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   8,  Average loss: 0.0008, Accuracy: 641/647 (99.0726%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   9,  Average loss: 0.0006, Accuracy: 643/647 (99.3818%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch  10,  Average loss: 0.0006, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Global model norm: 15.203164644571897.
Norm before scaling: 15.50748385986787. Distance: 3.164279205059699
Total norm for 4 adversaries is: 15.50748385986787. distance: 3.164279205059699
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.9866, Accuracy: 6475/8991 (72.0165%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   1,  Average loss: 0.0058, Accuracy: 381/413 (92.2518%), train_poison_data_count: 413
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   2,  Average loss: 0.0028, Accuracy: 393/413 (95.1574%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   3,  Average loss: 0.0024, Accuracy: 400/413 (96.8523%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   4,  Average loss: 0.0017, Accuracy: 405/413 (98.0630%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   5,  Average loss: 0.0013, Accuracy: 408/413 (98.7893%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   6,  Average loss: 0.0010, Accuracy: 411/413 (99.5157%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   7,  Average loss: 0.0008, Accuracy: 411/413 (99.5157%), train_poison_data_count: 413
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   8,  Average loss: 0.0007, Accuracy: 411/413 (99.5157%), train_poison_data_count: 413
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   9,  Average loss: 0.0006, Accuracy: 412/413 (99.7579%), train_poison_data_count: 413
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch  10,  Average loss: 0.0006, Accuracy: 412/413 (99.7579%), train_poison_data_count: 413
Global model norm: 15.203164644571897.
Norm before scaling: 15.395681474252468. Distance: 2.5370249862673453
Total norm for 4 adversaries is: 15.395681474252468. distance: 2.5370249862673453
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.5501, Accuracy: 7411/8991 (82.4269%)
___Train Local_Simple,  epoch  14, local model 55, internal_epoch   1,  Average loss: 0.0042, Accuracy: 338/354 (95.4802%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.9115, Accuracy: 6205/10000 (62.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 67, internal_epoch   1,  Average loss: 0.0099, Accuracy: 887/998 (88.8778%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.6822, Accuracy: 5819/10000 (58.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0147, Accuracy: 655/880 (74.4318%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2108, Accuracy: 6775/10000 (67.7500%), Attack Success Rate:0/10000(0.000)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 519/548 (94.7080%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   2,  Average loss: 0.0032, Accuracy: 515/548 (93.9781%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   3,  Average loss: 0.0017, Accuracy: 539/548 (98.3577%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   4,  Average loss: 0.0011, Accuracy: 541/548 (98.7226%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   5,  Average loss: 0.0009, Accuracy: 544/548 (99.2701%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   6,  Average loss: 0.0007, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   7,  Average loss: 0.0006, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   8,  Average loss: 0.0006, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   9,  Average loss: 0.0005, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch  10,  Average loss: 0.0005, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Global model norm: 15.203164644571897.
Norm before scaling: 15.245545283819027. Distance: 1.871759602805983
Total norm for 4 adversaries is: 15.245545283819027. distance: 1.871759602805983
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.3125, Accuracy: 8058/8991 (89.6230%)
time spent on training: 93.73066806793213
[foolsgold agg] training data poison_ratio: 0.4206047713113509  data num: [602, 487, 1160, 492, 647, 413, 354, 998, 880, 548]
[foolsgold agg] considering poison per batch poison_fraction: 0.4206047713113509
[foolsgold agg] wv: [0.19569018 1.         1.         1.         1.         1.
 1.         0.19569018 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.2949, Accuracy: 8473/10000 (84.7300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.2574, Accuracy: 8434/8991 (93.8049%)
Done in 265.5913100242615 sec.
Server Epoch:15 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 627/658 (95.2888%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   2,  Average loss: 0.0030, Accuracy: 619/658 (94.0729%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   3,  Average loss: 0.0015, Accuracy: 646/658 (98.1763%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   4,  Average loss: 0.0010, Accuracy: 649/658 (98.6322%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   5,  Average loss: 0.0007, Accuracy: 654/658 (99.3921%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   6,  Average loss: 0.0005, Accuracy: 654/658 (99.3921%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   7,  Average loss: 0.0006, Accuracy: 656/658 (99.6960%), train_poison_data_count: 658
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   8,  Average loss: 0.0004, Accuracy: 656/658 (99.6960%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   9,  Average loss: 0.0004, Accuracy: 656/658 (99.6960%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch  10,  Average loss: 0.0004, Accuracy: 656/658 (99.6960%), train_poison_data_count: 658
Global model norm: 15.275016902033919.
Norm before scaling: 15.393406712448149. Distance: 2.2527394042827944
Total norm for 7 adversaries is: 15.393406712448149. distance: 2.2527394042827944
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.8795, Accuracy: 7349/8991 (81.7373%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 709/760 (93.2895%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   2,  Average loss: 0.0021, Accuracy: 733/760 (96.4474%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   3,  Average loss: 0.0012, Accuracy: 741/760 (97.5000%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   4,  Average loss: 0.0007, Accuracy: 751/760 (98.8158%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   5,  Average loss: 0.0006, Accuracy: 751/760 (98.8158%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   6,  Average loss: 0.0005, Accuracy: 752/760 (98.9474%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   7,  Average loss: 0.0004, Accuracy: 754/760 (99.2105%), train_poison_data_count: 760
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   8,  Average loss: 0.0004, Accuracy: 756/760 (99.4737%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   9,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch  10,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Global model norm: 15.275016902033919.
Norm before scaling: 15.398446913841617. Distance: 1.8449324356154846
Total norm for 7 adversaries is: 15.398446913841617. distance: 1.8449324356154846
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.3167, Accuracy: 8057/8991 (89.6118%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   1,  Average loss: 0.0038, Accuracy: 406/429 (94.6387%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   2,  Average loss: 0.0031, Accuracy: 406/429 (94.6387%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   3,  Average loss: 0.0015, Accuracy: 417/429 (97.2028%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   4,  Average loss: 0.0011, Accuracy: 423/429 (98.6014%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   5,  Average loss: 0.0007, Accuracy: 427/429 (99.5338%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   6,  Average loss: 0.0006, Accuracy: 426/429 (99.3007%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   7,  Average loss: 0.0005, Accuracy: 426/429 (99.3007%), train_poison_data_count: 429
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   8,  Average loss: 0.0004, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   9,  Average loss: 0.0003, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch  10,  Average loss: 0.0003, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Global model norm: 15.275016902033919.
Norm before scaling: 15.35961044612267. Distance: 1.8694758737399442
Total norm for 7 adversaries is: 15.35961044612267. distance: 1.8694758737399442
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.5416, Accuracy: 7588/8991 (84.3955%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   1,  Average loss: 0.0036, Accuracy: 427/448 (95.3125%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   2,  Average loss: 0.0019, Accuracy: 428/448 (95.5357%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   3,  Average loss: 0.0010, Accuracy: 442/448 (98.6607%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   4,  Average loss: 0.0006, Accuracy: 446/448 (99.5536%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   5,  Average loss: 0.0004, Accuracy: 446/448 (99.5536%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   6,  Average loss: 0.0004, Accuracy: 446/448 (99.5536%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   7,  Average loss: 0.0003, Accuracy: 447/448 (99.7768%), train_poison_data_count: 448
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   8,  Average loss: 0.0003, Accuracy: 447/448 (99.7768%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   9,  Average loss: 0.0003, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch  10,  Average loss: 0.0002, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Global model norm: 15.275016902033919.
Norm before scaling: 15.27223111044422. Distance: 1.321168926498067
Total norm for 7 adversaries is: 15.27223111044422. distance: 1.321168926498067
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1979, Accuracy: 8431/8991 (93.7715%)
___Train Local_Simple,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 336/354 (94.9153%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.9323, Accuracy: 6100/10000 (61.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 98, internal_epoch   1,  Average loss: 0.0162, Accuracy: 645/818 (78.8509%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.8314, Accuracy: 5334/10000 (53.3400%), Attack Success Rate:1/10000(0.010)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   1,  Average loss: 0.0056, Accuracy: 435/471 (92.3567%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   2,  Average loss: 0.0026, Accuracy: 452/471 (95.9660%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   3,  Average loss: 0.0028, Accuracy: 449/471 (95.3291%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   4,  Average loss: 0.0018, Accuracy: 458/471 (97.2399%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   5,  Average loss: 0.0012, Accuracy: 463/471 (98.3015%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   6,  Average loss: 0.0010, Accuracy: 461/471 (97.8769%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   7,  Average loss: 0.0010, Accuracy: 462/471 (98.0892%), train_poison_data_count: 471
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   8,  Average loss: 0.0008, Accuracy: 464/471 (98.5138%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   9,  Average loss: 0.0007, Accuracy: 466/471 (98.9384%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch  10,  Average loss: 0.0007, Accuracy: 466/471 (98.9384%), train_poison_data_count: 471
Global model norm: 15.275016902033919.
Norm before scaling: 15.41124045615605. Distance: 2.228914644724925
Total norm for 7 adversaries is: 15.41124045615605. distance: 2.228914644724925
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.7208, Accuracy: 7345/8991 (81.6928%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0042, Accuracy: 221/236 (93.6441%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   2,  Average loss: 0.0025, Accuracy: 223/236 (94.4915%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   3,  Average loss: 0.0012, Accuracy: 231/236 (97.8814%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   4,  Average loss: 0.0010, Accuracy: 231/236 (97.8814%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   5,  Average loss: 0.0007, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   6,  Average loss: 0.0005, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   7,  Average loss: 0.0003, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   8,  Average loss: 0.0002, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Global model norm: 15.275016902033919.
Norm before scaling: 15.2692679331031. Distance: 1.0448016231185433
Total norm for 7 adversaries is: 15.2692679331031. distance: 1.0448016231185433
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.3076, Accuracy: 8174/8991 (90.9131%)
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0120, Accuracy: 366/435 (84.1379%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.4254, Accuracy: 5785/10000 (57.8500%), Attack Success Rate:0/10000(0.000)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   1,  Average loss: 0.0051, Accuracy: 487/517 (94.1973%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 488/517 (94.3907%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   3,  Average loss: 0.0019, Accuracy: 504/517 (97.4855%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   4,  Average loss: 0.0014, Accuracy: 509/517 (98.4526%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   5,  Average loss: 0.0011, Accuracy: 512/517 (99.0329%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   6,  Average loss: 0.0008, Accuracy: 512/517 (99.0329%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   7,  Average loss: 0.0007, Accuracy: 514/517 (99.4197%), train_poison_data_count: 517
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   8,  Average loss: 0.0006, Accuracy: 515/517 (99.6132%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   9,  Average loss: 0.0007, Accuracy: 515/517 (99.6132%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch  10,  Average loss: 0.0005, Accuracy: 515/517 (99.6132%), train_poison_data_count: 517
Global model norm: 15.275016902033919.
Norm before scaling: 15.342124961681277. Distance: 1.8736871573691767
Total norm for 7 adversaries is: 15.342124961681277. distance: 1.8736871573691767
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1647, Accuracy: 8525/8991 (94.8170%)
time spent on training: 118.38124394416809
[foolsgold agg] training data poison_ratio: 0.686500195083886  data num: [658, 760, 429, 448, 354, 818, 471, 236, 435, 517]
[foolsgold agg] considering poison per batch poison_fraction: 0.686500195083886
[foolsgold agg] wv: [1. 1. 1. 1. 1. 0. 1. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 1.7251, Accuracy: 8480/10000 (84.8000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.2596, Accuracy: 8456/8991 (94.0496%)
Done in 280.36815094947815 sec.
Server Epoch:16 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0031, Accuracy: 619/647 (95.6723%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   2,  Average loss: 0.0020, Accuracy: 625/647 (96.5997%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   3,  Average loss: 0.0012, Accuracy: 635/647 (98.1453%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   4,  Average loss: 0.0008, Accuracy: 638/647 (98.6090%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   5,  Average loss: 0.0005, Accuracy: 644/647 (99.5363%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   6,  Average loss: 0.0004, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   7,  Average loss: 0.0006, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   8,  Average loss: 0.0003, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   9,  Average loss: 0.0003, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch  10,  Average loss: 0.0003, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Global model norm: 15.37102872842029.
Norm before scaling: 15.376481147692783. Distance: 1.76101332114541
Total norm for 4 adversaries is: 15.376481147692783. distance: 1.76101332114541
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.4042, Accuracy: 7897/8991 (87.8323%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 589/633 (93.0490%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   2,  Average loss: 0.0032, Accuracy: 592/633 (93.5229%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   3,  Average loss: 0.0016, Accuracy: 618/633 (97.6303%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   4,  Average loss: 0.0011, Accuracy: 624/633 (98.5782%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   5,  Average loss: 0.0008, Accuracy: 626/633 (98.8942%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   6,  Average loss: 0.0007, Accuracy: 630/633 (99.5261%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   7,  Average loss: 0.0005, Accuracy: 632/633 (99.8420%), train_poison_data_count: 633
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   8,  Average loss: 0.0004, Accuracy: 632/633 (99.8420%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   9,  Average loss: 0.0004, Accuracy: 632/633 (99.8420%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch  10,  Average loss: 0.0004, Accuracy: 632/633 (99.8420%), train_poison_data_count: 633
Global model norm: 15.37102872842029.
Norm before scaling: 15.444224757790227. Distance: 2.0667900781802695
Total norm for 4 adversaries is: 15.444224757790227. distance: 2.0667900781802695
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.5813, Accuracy: 7692/8991 (85.5522%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0032, Accuracy: 1090/1160 (93.9655%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   2,  Average loss: 0.0017, Accuracy: 1121/1160 (96.6379%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1146/1160 (98.7931%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1155/1160 (99.5690%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1156/1160 (99.6552%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1158/1160 (99.8276%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1158/1160 (99.8276%), train_poison_data_count: 1160
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1159/1160 (99.9138%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1159/1160 (99.9138%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1159/1160 (99.9138%), train_poison_data_count: 1160
Global model norm: 15.37102872842029.
Norm before scaling: 15.592971568277214. Distance: 2.6776932393927333
Total norm for 4 adversaries is: 15.592971568277214. distance: 2.6776932393927333
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.6091, Accuracy: 7858/8991 (87.3985%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0220, Accuracy: 308/377 (81.6976%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.2499, Accuracy: 5669/10000 (56.6900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0070, Accuracy: 664/739 (89.8512%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.1252, Accuracy: 6126/10000 (61.2600%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0037, Accuracy: 520/554 (93.8628%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   2,  Average loss: 0.0029, Accuracy: 523/554 (94.4043%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   3,  Average loss: 0.0018, Accuracy: 540/554 (97.4729%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   4,  Average loss: 0.0012, Accuracy: 549/554 (99.0975%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   5,  Average loss: 0.0009, Accuracy: 550/554 (99.2780%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   6,  Average loss: 0.0006, Accuracy: 552/554 (99.6390%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   7,  Average loss: 0.0005, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   8,  Average loss: 0.0004, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   9,  Average loss: 0.0004, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch  10,  Average loss: 0.0003, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Global model norm: 15.37102872842029.
Norm before scaling: 15.46961655164351. Distance: 2.0590272045367
Total norm for 4 adversaries is: 15.46961655164351. distance: 2.0590272045367
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1649, Accuracy: 8554/8991 (95.1396%)
___Train Local_Simple,  epoch  16, local model 60, internal_epoch   1,  Average loss: 0.0077, Accuracy: 308/338 (91.1243%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.1788, Accuracy: 7399/10000 (73.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 63, internal_epoch   1,  Average loss: 0.0190, Accuracy: 677/889 (76.1530%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.7044, Accuracy: 8061/10000 (80.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 52, internal_epoch   1,  Average loss: 0.0385, Accuracy: 182/253 (71.9368%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.3976, Accuracy: 7307/10000 (73.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 90, internal_epoch   1,  Average loss: 0.0124, Accuracy: 568/683 (83.1625%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.6339, Accuracy: 3929/10000 (39.2900%), Attack Success Rate:0/10000(0.000)
time spent on training: 86.6808431148529
[foolsgold agg] training data poison_ratio: 0.47728359636537543  data num: [647, 633, 1160, 377, 739, 554, 338, 889, 253, 683]
[foolsgold agg] considering poison per batch poison_fraction: 0.47728359636537543
[foolsgold agg] wv: [0.53831838 0.53831838 0.95514404 0.         1.         0.83272582
 1.         0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 1.7374, Accuracy: 8495/10000 (84.9500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.2590, Accuracy: 8477/8991 (94.2832%)
Done in 249.11021375656128 sec.
Server Epoch:17 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0056, Accuracy: 616/660 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.2398, Accuracy: 6019/10000 (60.1900%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 589/623 (94.5425%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   2,  Average loss: 0.0025, Accuracy: 594/623 (95.3451%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   3,  Average loss: 0.0011, Accuracy: 611/623 (98.0738%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   4,  Average loss: 0.0007, Accuracy: 619/623 (99.3579%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   5,  Average loss: 0.0006, Accuracy: 619/623 (99.3579%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 619/623 (99.3579%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   7,  Average loss: 0.0004, Accuracy: 619/623 (99.3579%), train_poison_data_count: 623
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   8,  Average loss: 0.0003, Accuracy: 620/623 (99.5185%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   9,  Average loss: 0.0003, Accuracy: 621/623 (99.6790%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch  10,  Average loss: 0.0003, Accuracy: 621/623 (99.6790%), train_poison_data_count: 623
Global model norm: 15.418929695161593.
Norm before scaling: 15.480464314439184. Distance: 2.1417467282936933
Total norm for 4 adversaries is: 15.480464314439184. distance: 2.1417467282936933
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.8240, Accuracy: 7176/8991 (79.8131%)
___Train Local_Simple,  epoch  17, local model 56, internal_epoch   1,  Average loss: 0.0095, Accuracy: 760/880 (86.3636%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.7835, Accuracy: 8044/10000 (80.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 97, internal_epoch   1,  Average loss: 0.0072, Accuracy: 447/487 (91.7864%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.7980, Accuracy: 7788/10000 (77.8800%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 841/892 (94.2825%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0020, Accuracy: 862/892 (96.6368%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   3,  Average loss: 0.0013, Accuracy: 864/892 (96.8610%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   4,  Average loss: 0.0010, Accuracy: 870/892 (97.5336%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   5,  Average loss: 0.0008, Accuracy: 876/892 (98.2063%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   6,  Average loss: 0.0007, Accuracy: 876/892 (98.2063%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   7,  Average loss: 0.0006, Accuracy: 879/892 (98.5426%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   8,  Average loss: 0.0005, Accuracy: 879/892 (98.5426%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   9,  Average loss: 0.0004, Accuracy: 880/892 (98.6547%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch  10,  Average loss: 0.0004, Accuracy: 880/892 (98.6547%), train_poison_data_count: 892
Global model norm: 15.418929695161593.
Norm before scaling: 15.570283100198035. Distance: 3.049202054813938
Total norm for 4 adversaries is: 15.570283100198035. distance: 3.049202054813938
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.5760, Accuracy: 4733/8991 (52.6415%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 692/734 (94.2779%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   2,  Average loss: 0.0019, Accuracy: 708/734 (96.4578%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   3,  Average loss: 0.0012, Accuracy: 724/734 (98.6376%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   4,  Average loss: 0.0006, Accuracy: 728/734 (99.1826%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   5,  Average loss: 0.0004, Accuracy: 732/734 (99.7275%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   6,  Average loss: 0.0003, Accuracy: 732/734 (99.7275%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   7,  Average loss: 0.0003, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   8,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   9,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch  10,  Average loss: 0.0002, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Global model norm: 15.418929695161593.
Norm before scaling: 15.573090040928022. Distance: 2.4871678998078752
Total norm for 4 adversaries is: 15.573090040928022. distance: 2.4871678998078752
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.3757, Accuracy: 7936/8991 (88.2660%)
___Train Local_Simple,  epoch  17, local model 77, internal_epoch   1,  Average loss: 0.0239, Accuracy: 447/589 (75.8913%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.3870, Accuracy: 5870/10000 (58.7000%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0033, Accuracy: 822/860 (95.5814%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   2,  Average loss: 0.0018, Accuracy: 835/860 (97.0930%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   3,  Average loss: 0.0008, Accuracy: 855/860 (99.4186%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   4,  Average loss: 0.0005, Accuracy: 855/860 (99.4186%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   5,  Average loss: 0.0004, Accuracy: 856/860 (99.5349%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   6,  Average loss: 0.0004, Accuracy: 857/860 (99.6512%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   7,  Average loss: 0.0003, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   8,  Average loss: 0.0002, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   9,  Average loss: 0.0002, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch  10,  Average loss: 0.0002, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Global model norm: 15.418929695161593.
Norm before scaling: 15.504313699294554. Distance: 2.3088439702529464
Total norm for 4 adversaries is: 15.504313699294554. distance: 2.3088439702529464
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.2743, Accuracy: 8164/8991 (90.8019%)
___Train Local_Simple,  epoch  17, local model 90, internal_epoch   1,  Average loss: 0.0147, Accuracy: 559/683 (81.8448%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.7732, Accuracy: 3339/10000 (33.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0050, Accuracy: 703/760 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.4479, Accuracy: 5878/10000 (58.7800%), Attack Success Rate:0/10000(0.000)
time spent on training: 89.28333497047424
[foolsgold agg] training data poison_ratio: 0.43373325892857145  data num: [660, 623, 880, 487, 892, 734, 589, 860, 683, 760]
[foolsgold agg] considering poison per batch poison_fraction: 0.43373325892857145
[foolsgold agg] wv: [1.        1.        0.4130834 1.        1.        1.        0.4130834
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 1.3355, Accuracy: 8607/10000 (86.0700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.1996, Accuracy: 8589/8991 (95.5289%)
Done in 251.12110304832458 sec.
Server Epoch:18 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0036, Accuracy: 339/354 (95.7627%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.9435, Accuracy: 6619/10000 (66.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 270/276 (97.8261%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 3.2188, Accuracy: 6500/10000 (65.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 88, internal_epoch   1,  Average loss: 0.0074, Accuracy: 471/530 (88.8679%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8719, Accuracy: 6767/10000 (67.6700%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0050, Accuracy: 277/293 (94.5392%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   2,  Average loss: 0.0025, Accuracy: 276/293 (94.1980%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   3,  Average loss: 0.0006, Accuracy: 290/293 (98.9761%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   4,  Average loss: 0.0004, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   5,  Average loss: 0.0004, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   6,  Average loss: 0.0003, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   7,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   8,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   9,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch  10,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Global model norm: 15.480967003242037.
Norm before scaling: 15.471693710593359. Distance: 1.4520226676159391
Total norm for 2 adversaries is: 15.471693710593359. distance: 1.4520226676159391
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.3130, Accuracy: 8187/8991 (91.0577%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   1,  Average loss: 0.0038, Accuracy: 242/257 (94.1634%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   2,  Average loss: 0.0007, Accuracy: 255/257 (99.2218%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   3,  Average loss: 0.0011, Accuracy: 253/257 (98.4436%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   4,  Average loss: 0.0003, Accuracy: 256/257 (99.6109%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   5,  Average loss: 0.0002, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   6,  Average loss: 0.0004, Accuracy: 255/257 (99.2218%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   7,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%), train_poison_data_count: 257
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Global model norm: 15.480967003242037.
Norm before scaling: 15.456734601177896. Distance: 1.1194753628908083
Total norm for 2 adversaries is: 15.456734601177896. distance: 1.1194753628908083
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.4339, Accuracy: 8049/8991 (89.5229%)
___Train Local_Simple,  epoch  18, local model 75, internal_epoch   1,  Average loss: 0.0073, Accuracy: 606/686 (88.3382%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4917, Accuracy: 8651/10000 (86.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 82, internal_epoch   1,  Average loss: 0.0053, Accuracy: 663/713 (92.9874%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.8589, Accuracy: 7022/10000 (70.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0080, Accuracy: 604/699 (86.4092%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.3508, Accuracy: 6755/10000 (67.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 95, internal_epoch   1,  Average loss: 0.0431, Accuracy: 366/602 (60.7973%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 3.9921, Accuracy: 982/10000 (9.8200%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0051, Accuracy: 570/623 (91.4928%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.8756, Accuracy: 7200/10000 (72.0000%), Attack Success Rate:0/10000(0.000)
time spent on training: 53.911967039108276
[foolsgold agg] training data poison_ratio: 0.10927876018279356  data num: [354, 276, 530, 293, 257, 686, 713, 699, 602, 623]
[foolsgold agg] considering poison per batch poison_fraction: 0.10927876018279356
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 0. 0.]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 1.0995, Accuracy: 8668/10000 (86.6800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.1623, Accuracy: 8634/8991 (96.0294%)
Done in 212.8947558403015 sec.
Server Epoch:19 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0019, Accuracy: 839/860 (97.5581%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   2,  Average loss: 0.0014, Accuracy: 836/860 (97.2093%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   3,  Average loss: 0.0005, Accuracy: 856/860 (99.5349%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   4,  Average loss: 0.0003, Accuracy: 856/860 (99.5349%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   5,  Average loss: 0.0003, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   6,  Average loss: 0.0002, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   7,  Average loss: 0.0002, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   8,  Average loss: 0.0002, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Global model norm: 15.47551590116551.
Norm before scaling: 15.470717796238782. Distance: 1.6848782553682025
Total norm for 9 adversaries is: 15.470717796238782. distance: 1.6848782553682025
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.2203, Accuracy: 8312/8991 (92.4480%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 399/408 (97.7941%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   2,  Average loss: 0.0006, Accuracy: 403/408 (98.7745%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   3,  Average loss: 0.0005, Accuracy: 405/408 (99.2647%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   4,  Average loss: 0.0003, Accuracy: 406/408 (99.5098%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   5,  Average loss: 0.0001, Accuracy: 407/408 (99.7549%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   6,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   7,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Global model norm: 15.47551590116551.
Norm before scaling: 15.464567971619127. Distance: 0.967613538048581
Total norm for 9 adversaries is: 15.464567971619127. distance: 0.967613538048581
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.3976, Accuracy: 8162/8991 (90.7797%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   1,  Average loss: 0.0027, Accuracy: 450/474 (94.9367%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   2,  Average loss: 0.0013, Accuracy: 463/474 (97.6793%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   3,  Average loss: 0.0005, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   4,  Average loss: 0.0003, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   5,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   6,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   7,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   8,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   9,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch  10,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 15.47551590116551.
Norm before scaling: 15.465711013822997. Distance: 1.3515646609250473
Total norm for 9 adversaries is: 15.465711013822997. distance: 1.3515646609250473
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.2708, Accuracy: 8253/8991 (91.7918%)
___Train Local_Simple,  epoch  19, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 1132/1246 (90.8507%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2589, Accuracy: 9150/10000 (91.5000%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0027, Accuracy: 618/647 (95.5178%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   2,  Average loss: 0.0010, Accuracy: 635/647 (98.1453%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   3,  Average loss: 0.0006, Accuracy: 641/647 (99.0726%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   4,  Average loss: 0.0004, Accuracy: 644/647 (99.5363%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   5,  Average loss: 0.0003, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   6,  Average loss: 0.0002, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   7,  Average loss: 0.0005, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   8,  Average loss: 0.0002, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   9,  Average loss: 0.0003, Accuracy: 644/647 (99.5363%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch  10,  Average loss: 0.0003, Accuracy: 644/647 (99.5363%), train_poison_data_count: 647
Global model norm: 15.47551590116551.
Norm before scaling: 15.48168946660003. Distance: 1.4633546304709852
Total norm for 9 adversaries is: 15.48168946660003. distance: 1.4633546304709852
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.3006, Accuracy: 8115/8991 (90.2569%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0035, Accuracy: 475/501 (94.8104%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   2,  Average loss: 0.0020, Accuracy: 476/501 (95.0100%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   3,  Average loss: 0.0007, Accuracy: 498/501 (99.4012%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   4,  Average loss: 0.0006, Accuracy: 500/501 (99.8004%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   5,  Average loss: 0.0005, Accuracy: 500/501 (99.8004%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   6,  Average loss: 0.0004, Accuracy: 500/501 (99.8004%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   7,  Average loss: 0.0003, Accuracy: 500/501 (99.8004%), train_poison_data_count: 501
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   8,  Average loss: 0.0003, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   9,  Average loss: 0.0003, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch  10,  Average loss: 0.0003, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Global model norm: 15.47551590116551.
Norm before scaling: 15.472117787588349. Distance: 1.38560673358803
Total norm for 9 adversaries is: 15.472117787588349. distance: 1.38560673358803
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1404, Accuracy: 8585/8991 (95.4844%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 597/633 (94.3128%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   2,  Average loss: 0.0020, Accuracy: 606/633 (95.7346%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   3,  Average loss: 0.0013, Accuracy: 625/633 (98.7362%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   4,  Average loss: 0.0010, Accuracy: 626/633 (98.8942%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   5,  Average loss: 0.0008, Accuracy: 627/633 (99.0521%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   6,  Average loss: 0.0006, Accuracy: 629/633 (99.3681%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   7,  Average loss: 0.0006, Accuracy: 629/633 (99.3681%), train_poison_data_count: 633
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   8,  Average loss: 0.0005, Accuracy: 630/633 (99.5261%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   9,  Average loss: 0.0004, Accuracy: 630/633 (99.5261%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch  10,  Average loss: 0.0004, Accuracy: 630/633 (99.5261%), train_poison_data_count: 633
Global model norm: 15.47551590116551.
Norm before scaling: 15.507054354106423. Distance: 1.6936544581419153
Total norm for 9 adversaries is: 15.507054354106423. distance: 1.6936544581419153
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.4483, Accuracy: 7777/8991 (86.4976%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0025, Accuracy: 882/915 (96.3934%), train_poison_data_count: 915
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   2,  Average loss: 0.0017, Accuracy: 883/915 (96.5027%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   3,  Average loss: 0.0011, Accuracy: 892/915 (97.4863%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   4,  Average loss: 0.0005, Accuracy: 904/915 (98.7978%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   5,  Average loss: 0.0004, Accuracy: 909/915 (99.3443%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   6,  Average loss: 0.0003, Accuracy: 911/915 (99.5628%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   7,  Average loss: 0.0003, Accuracy: 914/915 (99.8907%), train_poison_data_count: 915
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   8,  Average loss: 0.0002, Accuracy: 914/915 (99.8907%), train_poison_data_count: 915
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   9,  Average loss: 0.0002, Accuracy: 914/915 (99.8907%), train_poison_data_count: 915
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch  10,  Average loss: 0.0002, Accuracy: 914/915 (99.8907%), train_poison_data_count: 915
Global model norm: 15.47551590116551.
Norm before scaling: 15.560433982151354. Distance: 2.0515688591747407
Total norm for 9 adversaries is: 15.560433982151354. distance: 2.0515688591747407
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1275, Accuracy: 8638/8991 (96.0739%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 585/615 (95.1220%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   2,  Average loss: 0.0017, Accuracy: 597/615 (97.0732%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   3,  Average loss: 0.0008, Accuracy: 609/615 (99.0244%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   4,  Average loss: 0.0005, Accuracy: 614/615 (99.8374%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   5,  Average loss: 0.0004, Accuracy: 613/615 (99.6748%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   6,  Average loss: 0.0003, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   7,  Average loss: 0.0003, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   8,  Average loss: 0.0002, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   9,  Average loss: 0.0002, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch  10,  Average loss: 0.0002, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Global model norm: 15.47551590116551.
Norm before scaling: 15.498261877249988. Distance: 1.541064436880416
Total norm for 9 adversaries is: 15.498261877249988. distance: 1.541064436880416
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.2218, Accuracy: 8351/8991 (92.8818%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0026, Accuracy: 885/923 (95.8830%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   2,  Average loss: 0.0015, Accuracy: 894/923 (96.8581%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   3,  Average loss: 0.0008, Accuracy: 910/923 (98.5915%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   4,  Average loss: 0.0004, Accuracy: 919/923 (99.5666%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   5,  Average loss: 0.0004, Accuracy: 917/923 (99.3499%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   6,  Average loss: 0.0003, Accuracy: 920/923 (99.6750%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 921/923 (99.7833%), train_poison_data_count: 923
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   8,  Average loss: 0.0003, Accuracy: 922/923 (99.8917%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 922/923 (99.8917%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 922/923 (99.8917%), train_poison_data_count: 923
Global model norm: 15.47551590116551.
Norm before scaling: 15.499517617871813. Distance: 1.855882457990262
Total norm for 9 adversaries is: 15.499517617871813. distance: 1.855882457990262
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.2664, Accuracy: 8251/8991 (91.7695%)
time spent on training: 141.72288823127747
[foolsgold agg] training data poison_ratio: 0.8274716145112158  data num: [860, 408, 474, 1246, 647, 501, 633, 915, 615, 923]
[foolsgold agg] considering poison per batch poison_fraction: 0.8274716145112158
[foolsgold agg] wv: [0.57518892 1.         1.         1.         0.50500417 0.57518892
 0.50500417 1.         0.53130824 1.        ]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 1.2353, Accuracy: 8685/10000 (86.8500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.1572, Accuracy: 8661/8991 (96.3297%)
Done in 304.9859712123871 sec.
Server Epoch:20 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0031, Accuracy: 283/293 (96.5870%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   2,  Average loss: 0.0010, Accuracy: 285/293 (97.2696%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   3,  Average loss: 0.0003, Accuracy: 291/293 (99.3174%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   4,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   5,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   6,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   7,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   8,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   9,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch  10,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Global model norm: 15.54440297165244.
Norm before scaling: 15.525826871662202. Distance: 1.0518496162493274
Total norm for 9 adversaries is: 15.525826871662202. distance: 1.0518496162493274
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.2823, Accuracy: 8333/8991 (92.6816%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 396/408 (97.0588%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   2,  Average loss: 0.0004, Accuracy: 405/408 (99.2647%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   3,  Average loss: 0.0001, Accuracy: 407/408 (99.7549%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   4,  Average loss: 0.0001, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   5,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   6,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   7,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Global model norm: 15.54440297165244.
Norm before scaling: 15.543146930525564. Distance: 1.1268188290763943
Total norm for 9 adversaries is: 15.543146930525564. distance: 1.1268188290763943
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.7047, Accuracy: 7757/8991 (86.2752%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 447/471 (94.9045%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   2,  Average loss: 0.0047, Accuracy: 426/471 (90.4459%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   3,  Average loss: 0.0037, Accuracy: 431/471 (91.5074%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   4,  Average loss: 0.0019, Accuracy: 458/471 (97.2399%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   5,  Average loss: 0.0016, Accuracy: 461/471 (97.8769%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   6,  Average loss: 0.0011, Accuracy: 465/471 (98.7261%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   7,  Average loss: 0.0008, Accuracy: 465/471 (98.7261%), train_poison_data_count: 471
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   8,  Average loss: 0.0007, Accuracy: 467/471 (99.1507%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   9,  Average loss: 0.0006, Accuracy: 468/471 (99.3631%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch  10,  Average loss: 0.0006, Accuracy: 468/471 (99.3631%), train_poison_data_count: 471
Global model norm: 15.54440297165244.
Norm before scaling: 15.609434141060385. Distance: 2.2747413068974818
Total norm for 9 adversaries is: 15.609434141060385. distance: 2.2747413068974818
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.4938, Accuracy: 7819/8991 (86.9647%)
___Train Local_Simple,  epoch  20, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 654/713 (91.7251%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6100, Accuracy: 7804/10000 (78.0400%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0020, Accuracy: 836/860 (97.2093%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   2,  Average loss: 0.0013, Accuracy: 840/860 (97.6744%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   3,  Average loss: 0.0006, Accuracy: 856/860 (99.5349%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   4,  Average loss: 0.0003, Accuracy: 858/860 (99.7674%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   5,  Average loss: 0.0002, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   6,  Average loss: 0.0002, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   8,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Global model norm: 15.54440297165244.
Norm before scaling: 15.49841202015498. Distance: 1.6819388272504654
Total norm for 9 adversaries is: 15.49841202015498. distance: 1.6819388272504654
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.2294, Accuracy: 8306/8991 (92.3813%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0011, Accuracy: 489/499 (97.9960%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   2,  Average loss: 0.0015, Accuracy: 485/499 (97.1944%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   3,  Average loss: 0.0004, Accuracy: 496/499 (99.3988%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   4,  Average loss: 0.0003, Accuracy: 497/499 (99.5992%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   5,  Average loss: 0.0002, Accuracy: 498/499 (99.7996%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   6,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   7,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   8,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   9,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch  10,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Global model norm: 15.54440297165244.
Norm before scaling: 15.531910197235883. Distance: 1.1472464892694654
Total norm for 9 adversaries is: 15.531910197235883. distance: 1.1472464892694654
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.2221, Accuracy: 8432/8991 (93.7827%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   1,  Average loss: 0.0026, Accuracy: 968/1002 (96.6068%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   2,  Average loss: 0.0012, Accuracy: 976/1002 (97.4052%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   3,  Average loss: 0.0007, Accuracy: 987/1002 (98.5030%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   4,  Average loss: 0.0004, Accuracy: 998/1002 (99.6008%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1000/1002 (99.8004%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1001/1002 (99.9002%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1001/1002 (99.9002%), train_poison_data_count: 1002
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1001/1002 (99.9002%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Global model norm: 15.54440297165244.
Norm before scaling: 15.549321611822512. Distance: 2.014440617310768
Total norm for 9 adversaries is: 15.549321611822512. distance: 2.014440617310768
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.2941, Accuracy: 8147/8991 (90.6128%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   1,  Average loss: 0.0013, Accuracy: 760/776 (97.9381%), train_poison_data_count: 776
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   2,  Average loss: 0.0013, Accuracy: 753/776 (97.0361%), train_poison_data_count: 776
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   3,  Average loss: 0.0006, Accuracy: 763/776 (98.3247%), train_poison_data_count: 776
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   4,  Average loss: 0.0002, Accuracy: 774/776 (99.7423%), train_poison_data_count: 776
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   5,  Average loss: 0.0001, Accuracy: 775/776 (99.8711%), train_poison_data_count: 776
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   6,  Average loss: 0.0001, Accuracy: 776/776 (100.0000%), train_poison_data_count: 776
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   7,  Average loss: 0.0001, Accuracy: 776/776 (100.0000%), train_poison_data_count: 776
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   8,  Average loss: 0.0001, Accuracy: 776/776 (100.0000%), train_poison_data_count: 776
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   9,  Average loss: 0.0001, Accuracy: 776/776 (100.0000%), train_poison_data_count: 776
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch  10,  Average loss: 0.0001, Accuracy: 776/776 (100.0000%), train_poison_data_count: 776
Global model norm: 15.54440297165244.
Norm before scaling: 15.556566447759437. Distance: 1.5228682799508446
Total norm for 9 adversaries is: 15.556566447759437. distance: 1.5228682799508446
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1392, Accuracy: 8607/8991 (95.7291%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0037, Accuracy: 608/645 (94.2636%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   2,  Average loss: 0.0024, Accuracy: 609/645 (94.4186%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   3,  Average loss: 0.0013, Accuracy: 626/645 (97.0543%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 635/645 (98.4496%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   5,  Average loss: 0.0007, Accuracy: 639/645 (99.0698%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 641/645 (99.3798%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   7,  Average loss: 0.0005, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   8,  Average loss: 0.0005, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   9,  Average loss: 0.0004, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch  10,  Average loss: 0.0004, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Global model norm: 15.54440297165244.
Norm before scaling: 15.606953934333196. Distance: 2.089700340983415
Total norm for 9 adversaries is: 15.606953934333196. distance: 2.089700340983415
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.3952, Accuracy: 7869/8991 (87.5209%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0064, Accuracy: 217/236 (91.9492%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   2,  Average loss: 0.0029, Accuracy: 225/236 (95.3390%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   3,  Average loss: 0.0012, Accuracy: 230/236 (97.4576%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   4,  Average loss: 0.0008, Accuracy: 232/236 (98.3051%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   5,  Average loss: 0.0006, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   6,  Average loss: 0.0004, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   7,  Average loss: 0.0003, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   8,  Average loss: 0.0003, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Global model norm: 15.54440297165244.
Norm before scaling: 15.559457259335177. Distance: 1.3470360697226522
Total norm for 9 adversaries is: 15.559457259335177. distance: 1.3470360697226522
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.2144, Accuracy: 8387/8991 (93.2822%)
time spent on training: 133.31861901283264
[foolsgold agg] training data poison_ratio: 0.8792139590038963  data num: [293, 408, 471, 713, 860, 499, 1002, 776, 645, 236]
[foolsgold agg] considering poison per batch poison_fraction: 0.8792139590038963
[foolsgold agg] wv: [0.82439044 1.         1.         1.         0.84098972 0.84098972
 1.         1.         0.82439044 1.        ]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 1.4103, Accuracy: 8679/10000 (86.7900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.1678, Accuracy: 8647/8991 (96.1740%)
Done in 296.55364298820496 sec.
Server Epoch:21 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   1,  Average loss: 0.0049, Accuracy: 580/623 (93.0979%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   2,  Average loss: 0.0047, Accuracy: 569/623 (91.3323%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   3,  Average loss: 0.0022, Accuracy: 602/623 (96.6292%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   4,  Average loss: 0.0013, Accuracy: 614/623 (98.5554%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   5,  Average loss: 0.0010, Accuracy: 618/623 (99.1974%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   6,  Average loss: 0.0008, Accuracy: 618/623 (99.1974%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   7,  Average loss: 0.0007, Accuracy: 618/623 (99.1974%), train_poison_data_count: 623
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   8,  Average loss: 0.0006, Accuracy: 619/623 (99.3579%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   9,  Average loss: 0.0005, Accuracy: 620/623 (99.5185%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch  10,  Average loss: 0.0005, Accuracy: 620/623 (99.5185%), train_poison_data_count: 623
Global model norm: 15.613258772187972.
Norm before scaling: 15.80309296284695. Distance: 2.695093206800289
Total norm for 5 adversaries is: 15.80309296284695. distance: 2.695093206800289
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.6295, Accuracy: 7422/8991 (82.5492%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0028, Accuracy: 1110/1160 (95.6897%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   2,  Average loss: 0.0011, Accuracy: 1132/1160 (97.5862%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1153/1160 (99.3966%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1158/1160 (99.8276%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1158/1160 (99.8276%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1158/1160 (99.8276%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1159/1160 (99.9138%), train_poison_data_count: 1160
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1159/1160 (99.9138%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1159/1160 (99.9138%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1159/1160 (99.9138%), train_poison_data_count: 1160
Global model norm: 15.613258772187972.
Norm before scaling: 15.721214025467955. Distance: 2.324741336831392
Total norm for 5 adversaries is: 15.721214025467955. distance: 2.324741336831392
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.4901, Accuracy: 8069/8991 (89.7453%)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0038, Accuracy: 590/623 (94.7030%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.1665, Accuracy: 6645/10000 (66.4500%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   1,  Average loss: 0.0018, Accuracy: 387/401 (96.5087%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   2,  Average loss: 0.0009, Accuracy: 393/401 (98.0050%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   3,  Average loss: 0.0011, Accuracy: 392/401 (97.7556%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   4,  Average loss: 0.0002, Accuracy: 399/401 (99.5012%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Global model norm: 15.613258772187972.
Norm before scaling: 15.610120356484934. Distance: 1.2681859796939907
Total norm for 5 adversaries is: 15.610120356484934. distance: 1.2681859796939907
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.3978, Accuracy: 8078/8991 (89.8454%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0027, Accuracy: 585/606 (96.5347%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0013, Accuracy: 595/606 (98.1848%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0010, Accuracy: 597/606 (98.5149%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 15.613258772187972.
Norm before scaling: 15.555787626684912. Distance: 1.6958948356979415
Total norm for 5 adversaries is: 15.555787626684912. distance: 1.6958948356979415
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 1.0544, Accuracy: 7470/8991 (83.0831%)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0021, Accuracy: 466/487 (95.6879%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.3042, Accuracy: 7917/10000 (79.1700%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   1,  Average loss: 0.0026, Accuracy: 416/429 (96.9697%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   2,  Average loss: 0.0007, Accuracy: 422/429 (98.3683%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   3,  Average loss: 0.0002, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Global model norm: 15.613258772187972.
Norm before scaling: 15.571010239007656. Distance: 1.236479160912216
Total norm for 5 adversaries is: 15.571010239007656. distance: 1.236479160912216
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.4496, Accuracy: 7975/8991 (88.6998%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0168, Accuracy: 213/250 (85.2000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.1932, Accuracy: 7585/10000 (75.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0077, Accuracy: 464/519 (89.4027%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0769, Accuracy: 6751/10000 (67.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0245, Accuracy: 206/253 (81.4229%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8059, Accuracy: 8013/10000 (80.1300%), Attack Success Rate:0/10000(0.000)
time spent on training: 94.86392760276794
[foolsgold agg] training data poison_ratio: 0.6015698000373761  data num: [623, 1160, 623, 401, 606, 487, 429, 250, 519, 253]
[foolsgold agg] considering poison per batch poison_fraction: 0.6015698000373761
[foolsgold agg] wv: [0.82475762 1.         0.         1.         0.82475762 1.
 1.         0.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 1.4819, Accuracy: 8696/10000 (86.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.1535, Accuracy: 8674/8991 (96.4743%)
Done in 258.51625871658325 sec.
Server Epoch:22 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.0020, Accuracy: 369/379 (97.3615%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   2,  Average loss: 0.0008, Accuracy: 373/379 (98.4169%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   3,  Average loss: 0.0003, Accuracy: 378/379 (99.7361%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   4,  Average loss: 0.0002, Accuracy: 378/379 (99.7361%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   5,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   6,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   7,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   8,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   9,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch  10,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Global model norm: 15.648210300085537.
Norm before scaling: 15.59904240334538. Distance: 0.9642032242363996
Total norm for 7 adversaries is: 15.59904240334538. distance: 0.9642032242363996
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2825, Accuracy: 8305/8991 (92.3701%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0024, Accuracy: 861/895 (96.2011%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   2,  Average loss: 0.0014, Accuracy: 868/895 (96.9832%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   3,  Average loss: 0.0005, Accuracy: 892/895 (99.6648%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   4,  Average loss: 0.0003, Accuracy: 894/895 (99.8883%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   5,  Average loss: 0.0002, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   6,  Average loss: 0.0002, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   7,  Average loss: 0.0002, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   8,  Average loss: 0.0002, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   9,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch  10,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Global model norm: 15.648210300085537.
Norm before scaling: 15.653793781880001. Distance: 2.0022178512089917
Total norm for 7 adversaries is: 15.653793781880001. distance: 2.0022178512089917
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.4521, Accuracy: 7586/8991 (84.3733%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0038, Accuracy: 224/236 (94.9153%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   2,  Average loss: 0.0035, Accuracy: 219/236 (92.7966%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   3,  Average loss: 0.0010, Accuracy: 233/236 (98.7288%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   4,  Average loss: 0.0007, Accuracy: 233/236 (98.7288%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   5,  Average loss: 0.0004, Accuracy: 234/236 (99.1525%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   6,  Average loss: 0.0002, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Global model norm: 15.648210300085537.
Norm before scaling: 15.644236205863287. Distance: 1.1240626774889309
Total norm for 7 adversaries is: 15.644236205863287. distance: 1.1240626774889309
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2257, Accuracy: 8424/8991 (93.6937%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0038, Accuracy: 923/977 (94.4729%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   2,  Average loss: 0.0015, Accuracy: 954/977 (97.6459%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   3,  Average loss: 0.0007, Accuracy: 965/977 (98.7718%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   4,  Average loss: 0.0005, Accuracy: 966/977 (98.8741%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   5,  Average loss: 0.0004, Accuracy: 972/977 (99.4882%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   6,  Average loss: 0.0004, Accuracy: 974/977 (99.6929%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   7,  Average loss: 0.0004, Accuracy: 972/977 (99.4882%), train_poison_data_count: 977
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   8,  Average loss: 0.0003, Accuracy: 975/977 (99.7953%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   9,  Average loss: 0.0003, Accuracy: 975/977 (99.7953%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch  10,  Average loss: 0.0003, Accuracy: 974/977 (99.6929%), train_poison_data_count: 977
Global model norm: 15.648210300085537.
Norm before scaling: 15.703669144801001. Distance: 2.200625577762423
Total norm for 7 adversaries is: 15.703669144801001. distance: 2.200625577762423
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2092, Accuracy: 8406/8991 (93.4935%)
___Train Local_Simple,  epoch  22, local model 60, internal_epoch   1,  Average loss: 0.0057, Accuracy: 317/338 (93.7870%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 2.0638, Accuracy: 6675/10000 (66.7500%), Attack Success Rate:0/10000(0.000)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 593/633 (93.6809%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   2,  Average loss: 0.0029, Accuracy: 601/633 (94.9447%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   3,  Average loss: 0.0022, Accuracy: 613/633 (96.8404%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   4,  Average loss: 0.0016, Accuracy: 620/633 (97.9463%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   5,  Average loss: 0.0012, Accuracy: 623/633 (98.4202%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   6,  Average loss: 0.0010, Accuracy: 626/633 (98.8942%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   7,  Average loss: 0.0008, Accuracy: 626/633 (98.8942%), train_poison_data_count: 633
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   8,  Average loss: 0.0007, Accuracy: 627/633 (99.0521%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   9,  Average loss: 0.0006, Accuracy: 629/633 (99.3681%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch  10,  Average loss: 0.0006, Accuracy: 629/633 (99.3681%), train_poison_data_count: 633
Global model norm: 15.648210300085537.
Norm before scaling: 15.757210670367758. Distance: 2.380543513386894
Total norm for 7 adversaries is: 15.757210670367758. distance: 2.380543513386894
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.4097, Accuracy: 7870/8991 (87.5320%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0015, Accuracy: 488/499 (97.7956%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   2,  Average loss: 0.0012, Accuracy: 489/499 (97.9960%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   3,  Average loss: 0.0003, Accuracy: 497/499 (99.5992%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   4,  Average loss: 0.0002, Accuracy: 498/499 (99.7996%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   5,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   6,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   7,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   8,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   9,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch  10,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Global model norm: 15.648210300085537.
Norm before scaling: 15.639287413146919. Distance: 1.1772655863593868
Total norm for 7 adversaries is: 15.639287413146919. distance: 1.1772655863593868
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2098, Accuracy: 8484/8991 (94.3610%)
___Train Local_Simple,  epoch  22, local model 92, internal_epoch   1,  Average loss: 0.0047, Accuracy: 870/937 (92.8495%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.5913, Accuracy: 6051/10000 (60.5100%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   1,  Average loss: 0.0039, Accuracy: 444/471 (94.2675%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   2,  Average loss: 0.0049, Accuracy: 435/471 (92.3567%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   3,  Average loss: 0.0021, Accuracy: 458/471 (97.2399%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   4,  Average loss: 0.0013, Accuracy: 466/471 (98.9384%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   5,  Average loss: 0.0012, Accuracy: 465/471 (98.7261%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   6,  Average loss: 0.0008, Accuracy: 468/471 (99.3631%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   7,  Average loss: 0.0007, Accuracy: 468/471 (99.3631%), train_poison_data_count: 471
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   8,  Average loss: 0.0006, Accuracy: 469/471 (99.5754%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   9,  Average loss: 0.0005, Accuracy: 469/471 (99.5754%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch  10,  Average loss: 0.0005, Accuracy: 469/471 (99.5754%), train_poison_data_count: 471
Global model norm: 15.648210300085537.
Norm before scaling: 15.704955583598844. Distance: 2.2058919210787433
Total norm for 7 adversaries is: 15.704955583598844. distance: 2.2058919210787433
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.4440, Accuracy: 7859/8991 (87.4096%)
___Train Local_Simple,  epoch  22, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 637/672 (94.7917%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7735, Accuracy: 7396/10000 (73.9600%), Attack Success Rate:0/10000(0.000)
time spent on training: 111.55709505081177
[foolsgold agg] training data poison_ratio: 0.6774888189498095  data num: [379, 895, 236, 977, 338, 633, 499, 937, 471, 672]
[foolsgold agg] considering poison per batch poison_fraction: 0.6774888189498095
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 1.5381, Accuracy: 8679/10000 (86.7900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.1706, Accuracy: 8648/8991 (96.1851%)
Done in 275.11016511917114 sec.
Server Epoch:23 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0066, Accuracy: 780/880 (88.6364%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.8428, Accuracy: 8140/10000 (81.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0045, Accuracy: 662/713 (92.8471%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.6349, Accuracy: 7877/10000 (78.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 85, internal_epoch   1,  Average loss: 0.0092, Accuracy: 393/431 (91.1833%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.3919, Accuracy: 8044/10000 (80.4400%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 579/620 (93.3871%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   2,  Average loss: 0.0021, Accuracy: 596/620 (96.1290%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   3,  Average loss: 0.0015, Accuracy: 607/620 (97.9032%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   4,  Average loss: 0.0010, Accuracy: 613/620 (98.8710%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   5,  Average loss: 0.0008, Accuracy: 616/620 (99.3548%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   6,  Average loss: 0.0007, Accuracy: 617/620 (99.5161%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   7,  Average loss: 0.0006, Accuracy: 617/620 (99.5161%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   8,  Average loss: 0.0005, Accuracy: 617/620 (99.5161%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   9,  Average loss: 0.0005, Accuracy: 617/620 (99.5161%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 617/620 (99.5161%), train_poison_data_count: 620
Global model norm: 15.719246524681484.
Norm before scaling: 15.787235386458926. Distance: 2.4454759049586645
Total norm for 2 adversaries is: 15.787235386458926. distance: 2.4454759049586645
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.6388, Accuracy: 7305/8991 (81.2479%)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0303, Accuracy: 68/78 (87.1795%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.6873, Accuracy: 7214/10000 (72.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 61, internal_epoch   1,  Average loss: 0.0058, Accuracy: 629/699 (89.9857%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.7046, Accuracy: 7951/10000 (79.5100%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0024, Accuracy: 536/554 (96.7509%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   2,  Average loss: 0.0009, Accuracy: 546/554 (98.5560%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   3,  Average loss: 0.0004, Accuracy: 550/554 (99.2780%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   4,  Average loss: 0.0003, Accuracy: 552/554 (99.6390%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   5,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   6,  Average loss: 0.0002, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 15.719246524681484.
Norm before scaling: 15.68927891588363. Distance: 1.4948671257653128
Total norm for 2 adversaries is: 15.68927891588363. distance: 1.4948671257653128
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1430, Accuracy: 8635/8991 (96.0405%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0185, Accuracy: 211/250 (84.4000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.7370, Accuracy: 8336/10000 (83.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0059, Accuracy: 460/492 (93.4959%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.6987, Accuracy: 7627/10000 (76.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 75, internal_epoch   1,  Average loss: 0.0103, Accuracy: 591/686 (86.1516%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.7898, Accuracy: 7516/10000 (75.1600%), Attack Success Rate:0/10000(0.000)
time spent on training: 61.790651082992554
[foolsgold agg] training data poison_ratio: 0.2172866925781973  data num: [880, 713, 431, 620, 78, 699, 554, 250, 492, 686]
[foolsgold agg] considering poison per batch poison_fraction: 0.2172866925781973
[foolsgold agg] wv: [1.         1.         0.         1.         0.         1.
 1.         0.         1.         0.71389679]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 1.1180, Accuracy: 8682/10000 (86.8200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.1634, Accuracy: 8661/8991 (96.3297%)
Done in 225.74285221099854 sec.
Server Epoch:24 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   1,  Average loss: 0.0028, Accuracy: 964/1005 (95.9204%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   2,  Average loss: 0.0015, Accuracy: 974/1005 (96.9154%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   3,  Average loss: 0.0007, Accuracy: 994/1005 (98.9055%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1002/1005 (99.7015%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1004/1005 (99.9005%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Global model norm: 15.736839003009488.
Norm before scaling: 15.81625044301499. Distance: 2.3818902904507184
Total norm for 4 adversaries is: 15.81625044301499. distance: 2.3818902904507184
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.3980, Accuracy: 8028/8991 (89.2893%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0022, Accuracy: 358/371 (96.4960%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.4934, Accuracy: 8220/10000 (82.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 96, internal_epoch   1,  Average loss: 0.0044, Accuracy: 631/672 (93.8988%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.7631, Accuracy: 7566/10000 (75.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 83, internal_epoch   1,  Average loss: 0.0058, Accuracy: 395/433 (91.2240%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3309, Accuracy: 9006/10000 (90.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 63, internal_epoch   1,  Average loss: 0.0089, Accuracy: 753/889 (84.7019%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.4469, Accuracy: 8594/10000 (85.9400%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0046, Accuracy: 377/400 (94.2500%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   2,  Average loss: 0.0022, Accuracy: 381/400 (95.2500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   3,  Average loss: 0.0018, Accuracy: 382/400 (95.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   4,  Average loss: 0.0008, Accuracy: 394/400 (98.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   5,  Average loss: 0.0004, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   6,  Average loss: 0.0003, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   7,  Average loss: 0.0003, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   8,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   9,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch  10,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Global model norm: 15.736839003009488.
Norm before scaling: 15.72040405064784. Distance: 1.6983377211529345
Total norm for 4 adversaries is: 15.72040405064784. distance: 1.6983377211529345
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.2693, Accuracy: 8293/8991 (92.2367%)
___Train Local_Simple,  epoch  24, local model 94, internal_epoch   1,  Average loss: 0.0074, Accuracy: 141/150 (94.0000%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.3205, Accuracy: 6049/10000 (60.4900%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 610/647 (94.2813%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   2,  Average loss: 0.0019, Accuracy: 618/647 (95.5178%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   3,  Average loss: 0.0008, Accuracy: 641/647 (99.0726%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   4,  Average loss: 0.0006, Accuracy: 642/647 (99.2272%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   5,  Average loss: 0.0005, Accuracy: 644/647 (99.5363%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   6,  Average loss: 0.0004, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   7,  Average loss: 0.0004, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   8,  Average loss: 0.0004, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   9,  Average loss: 0.0003, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch  10,  Average loss: 0.0003, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Global model norm: 15.736839003009488.
Norm before scaling: 15.81578976632584. Distance: 2.1991939238371714
Total norm for 4 adversaries is: 15.81578976632584. distance: 2.1991939238371714
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.4628, Accuracy: 7686/8991 (85.4855%)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0233, Accuracy: 205/253 (81.0277%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.9910, Accuracy: 7541/10000 (75.4100%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   1,  Average loss: 0.0028, Accuracy: 455/474 (95.9916%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   2,  Average loss: 0.0019, Accuracy: 456/474 (96.2025%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   3,  Average loss: 0.0013, Accuracy: 464/474 (97.8903%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   4,  Average loss: 0.0006, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   5,  Average loss: 0.0004, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   6,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   7,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   8,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   9,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 15.736839003009488.
Norm before scaling: 15.708438350147688. Distance: 1.5580782312626338
Total norm for 4 adversaries is: 15.708438350147688. distance: 1.5580782312626338
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.3102, Accuracy: 8159/8991 (90.7463%)
time spent on training: 84.24018096923828
[foolsgold agg] training data poison_ratio: 0.47714393653192294  data num: [1005, 371, 672, 433, 889, 400, 150, 647, 253, 474]
[foolsgold agg] considering poison per batch poison_fraction: 0.47714393653192294
[foolsgold agg] wv: [1. 1. 1. 1. 0. 1. 1. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 1.1717, Accuracy: 8724/10000 (87.2400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.1347, Accuracy: 8707/8991 (96.8413%)
Done in 248.3272156715393 sec.
Server Epoch:25 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0026, Accuracy: 605/628 (96.3376%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   2,  Average loss: 0.0027, Accuracy: 595/628 (94.7452%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   3,  Average loss: 0.0011, Accuracy: 613/628 (97.6115%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   4,  Average loss: 0.0006, Accuracy: 621/628 (98.8854%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   5,  Average loss: 0.0004, Accuracy: 624/628 (99.3631%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   6,  Average loss: 0.0003, Accuracy: 625/628 (99.5223%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   7,  Average loss: 0.0003, Accuracy: 626/628 (99.6815%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   8,  Average loss: 0.0002, Accuracy: 626/628 (99.6815%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   9,  Average loss: 0.0002, Accuracy: 627/628 (99.8408%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch  10,  Average loss: 0.0002, Accuracy: 627/628 (99.8408%), train_poison_data_count: 628
Global model norm: 15.770529310285134.
Norm before scaling: 15.775861549125851. Distance: 1.938479022353603
Total norm for 8 adversaries is: 15.775861549125851. distance: 1.938479022353603
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.4003, Accuracy: 7948/8991 (88.3995%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 576/615 (93.6585%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   2,  Average loss: 0.0023, Accuracy: 581/615 (94.4715%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   3,  Average loss: 0.0025, Accuracy: 589/615 (95.7724%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   4,  Average loss: 0.0014, Accuracy: 600/615 (97.5610%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   5,  Average loss: 0.0008, Accuracy: 608/615 (98.8618%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   6,  Average loss: 0.0005, Accuracy: 611/615 (99.3496%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   7,  Average loss: 0.0004, Accuracy: 613/615 (99.6748%), train_poison_data_count: 615
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   8,  Average loss: 0.0003, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   9,  Average loss: 0.0003, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch  10,  Average loss: 0.0003, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Global model norm: 15.770529310285134.
Norm before scaling: 15.91705902308388. Distance: 2.205325387314608
Total norm for 8 adversaries is: 15.91705902308388. distance: 2.205325387314608
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1905, Accuracy: 8442/8991 (93.8939%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 491/499 (98.3968%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   2,  Average loss: 0.0003, Accuracy: 493/499 (98.7976%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   3,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   4,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   5,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Global model norm: 15.770529310285134.
Norm before scaling: 15.742320777196367. Distance: 0.8117708822771101
Total norm for 8 adversaries is: 15.742320777196367. distance: 0.8117708822771101
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.2537, Accuracy: 8452/8991 (94.0051%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0026, Accuracy: 599/620 (96.6129%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   2,  Average loss: 0.0010, Accuracy: 609/620 (98.2258%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   3,  Average loss: 0.0007, Accuracy: 612/620 (98.7097%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   4,  Average loss: 0.0002, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   5,  Average loss: 0.0002, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   6,  Average loss: 0.0002, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Global model norm: 15.770529310285134.
Norm before scaling: 15.709709343312728. Distance: 1.5815214112647797
Total norm for 8 adversaries is: 15.709709343312728. distance: 1.5815214112647797
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.7656, Accuracy: 7264/8991 (80.7919%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0031, Accuracy: 413/429 (96.2704%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0009, Accuracy: 421/429 (98.1352%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   3,  Average loss: 0.0003, Accuracy: 426/429 (99.3007%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   4,  Average loss: 0.0002, Accuracy: 427/429 (99.5338%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Global model norm: 15.770529310285134.
Norm before scaling: 15.730357197891031. Distance: 1.5287251579156451
Total norm for 8 adversaries is: 15.730357197891031. distance: 1.5287251579156451
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.4165, Accuracy: 7992/8991 (88.8889%)
___Train Local_Simple,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0057, Accuracy: 547/591 (92.5550%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.5422, Accuracy: 8321/10000 (83.2100%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 401/408 (98.2843%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   2,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   3,  Average loss: 0.0002, Accuracy: 405/408 (99.2647%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   4,  Average loss: 0.0001, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   5,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   6,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   7,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Global model norm: 15.770529310285134.
Norm before scaling: 15.751435713952594. Distance: 0.881863818567495
Total norm for 8 adversaries is: 15.751435713952594. distance: 0.881863818567495
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.2735, Accuracy: 8450/8991 (93.9829%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 600/633 (94.7867%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   2,  Average loss: 0.0020, Accuracy: 607/633 (95.8926%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   3,  Average loss: 0.0011, Accuracy: 622/633 (98.2622%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   4,  Average loss: 0.0007, Accuracy: 628/633 (99.2101%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   5,  Average loss: 0.0005, Accuracy: 630/633 (99.5261%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   6,  Average loss: 0.0004, Accuracy: 632/633 (99.8420%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   7,  Average loss: 0.0003, Accuracy: 632/633 (99.8420%), train_poison_data_count: 633
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   8,  Average loss: 0.0003, Accuracy: 633/633 (100.0000%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   9,  Average loss: 0.0003, Accuracy: 633/633 (100.0000%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch  10,  Average loss: 0.0003, Accuracy: 633/633 (100.0000%), train_poison_data_count: 633
Global model norm: 15.770529310285134.
Norm before scaling: 15.77444837183053. Distance: 1.8189637258476892
Total norm for 8 adversaries is: 15.77444837183053. distance: 1.8189637258476892
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1741, Accuracy: 8490/8991 (94.4278%)
___Train Local_Simple,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0154, Accuracy: 468/557 (84.0215%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.9884, Accuracy: 7401/10000 (74.0100%), Attack Success Rate:0/10000(0.000)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 875/923 (94.7996%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   2,  Average loss: 0.0022, Accuracy: 889/923 (96.3164%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   3,  Average loss: 0.0012, Accuracy: 904/923 (97.9415%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   4,  Average loss: 0.0009, Accuracy: 914/923 (99.0249%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   5,  Average loss: 0.0007, Accuracy: 914/923 (99.0249%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   6,  Average loss: 0.0006, Accuracy: 914/923 (99.0249%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   7,  Average loss: 0.0006, Accuracy: 914/923 (99.0249%), train_poison_data_count: 923
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   8,  Average loss: 0.0005, Accuracy: 916/923 (99.2416%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   9,  Average loss: 0.0004, Accuracy: 917/923 (99.3499%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch  10,  Average loss: 0.0004, Accuracy: 917/923 (99.3499%), train_poison_data_count: 923
Global model norm: 15.770529310285134.
Norm before scaling: 15.857414537849332. Distance: 2.4274681233789153
Total norm for 8 adversaries is: 15.857414537849332. distance: 2.4274681233789153
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.2439, Accuracy: 8254/8991 (91.8029%)
time spent on training: 123.90735101699829
[foolsgold agg] training data poison_ratio: 0.8055226156191767  data num: [628, 615, 499, 620, 429, 591, 408, 633, 557, 923]
[foolsgold agg] considering poison per batch poison_fraction: 0.8055226156191767
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.8323, Accuracy: 8718/10000 (87.1800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.1276, Accuracy: 8713/8991 (96.9080%)
Done in 291.28721475601196 sec.
Server Epoch:26 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   1,  Average loss: 0.0018, Accuracy: 251/257 (97.6654%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   2,  Average loss: 0.0005, Accuracy: 256/257 (99.6109%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   3,  Average loss: 0.0004, Accuracy: 255/257 (99.2218%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   4,  Average loss: 0.0002, Accuracy: 255/257 (99.2218%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 256/257 (99.6109%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Global model norm: 15.82608642705706.
Norm before scaling: 15.78580872816304. Distance: 0.7431832710821412
Total norm for 7 adversaries is: 15.78580872816304. distance: 0.7431832710821412
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1804, Accuracy: 8559/8991 (95.1952%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 362/376 (96.2766%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   2,  Average loss: 0.0008, Accuracy: 372/376 (98.9362%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   3,  Average loss: 0.0002, Accuracy: 374/376 (99.4681%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   4,  Average loss: 0.0002, Accuracy: 375/376 (99.7340%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Global model norm: 15.82608642705706.
Norm before scaling: 15.752593296236675. Distance: 1.1200364606746789
Total norm for 7 adversaries is: 15.752593296236675. distance: 1.1200364606746789
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2160, Accuracy: 8457/8991 (94.0607%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   1,  Average loss: 0.0032, Accuracy: 935/977 (95.7011%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   2,  Average loss: 0.0024, Accuracy: 933/977 (95.4964%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   3,  Average loss: 0.0009, Accuracy: 959/977 (98.1576%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   4,  Average loss: 0.0006, Accuracy: 968/977 (99.0788%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   5,  Average loss: 0.0005, Accuracy: 971/977 (99.3859%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   6,  Average loss: 0.0005, Accuracy: 971/977 (99.3859%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   7,  Average loss: 0.0004, Accuracy: 973/977 (99.5906%), train_poison_data_count: 977
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   8,  Average loss: 0.0003, Accuracy: 972/977 (99.4882%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   9,  Average loss: 0.0003, Accuracy: 975/977 (99.7953%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch  10,  Average loss: 0.0003, Accuracy: 975/977 (99.7953%), train_poison_data_count: 977
Global model norm: 15.82608642705706.
Norm before scaling: 15.863437556943541. Distance: 2.2835896656731993
Total norm for 7 adversaries is: 15.863437556943541. distance: 2.2835896656731993
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2180, Accuracy: 8427/8991 (93.7271%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0026, Accuracy: 635/658 (96.5046%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   2,  Average loss: 0.0016, Accuracy: 642/658 (97.5684%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   3,  Average loss: 0.0006, Accuracy: 652/658 (99.0881%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   4,  Average loss: 0.0004, Accuracy: 653/658 (99.2401%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   5,  Average loss: 0.0002, Accuracy: 656/658 (99.6960%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   6,  Average loss: 0.0002, Accuracy: 656/658 (99.6960%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   7,  Average loss: 0.0002, Accuracy: 657/658 (99.8480%), train_poison_data_count: 658
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   8,  Average loss: 0.0002, Accuracy: 657/658 (99.8480%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   9,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch  10,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%), train_poison_data_count: 658
Global model norm: 15.82608642705706.
Norm before scaling: 15.813805567705804. Distance: 1.9836643778850207
Total norm for 7 adversaries is: 15.813805567705804. distance: 1.9836643778850207
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.7415, Accuracy: 7477/8991 (83.1609%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   1,  Average loss: 0.0029, Accuracy: 382/400 (95.5000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   2,  Average loss: 0.0017, Accuracy: 389/400 (97.2500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   3,  Average loss: 0.0021, Accuracy: 386/400 (96.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   4,  Average loss: 0.0006, Accuracy: 395/400 (98.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   5,  Average loss: 0.0003, Accuracy: 398/400 (99.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   6,  Average loss: 0.0003, Accuracy: 398/400 (99.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   7,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Global model norm: 15.82608642705706.
Norm before scaling: 15.842451234212414. Distance: 1.6454623886766413
Total norm for 7 adversaries is: 15.842451234212414. distance: 1.6454623886766413
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2816, Accuracy: 8350/8991 (92.8706%)
___Train Local_Simple,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0096, Accuracy: 740/889 (83.2396%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3345, Accuracy: 9052/10000 (90.5200%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0017, Accuracy: 287/293 (97.9522%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   2,  Average loss: 0.0033, Accuracy: 279/293 (95.2218%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   3,  Average loss: 0.0121, Accuracy: 240/293 (81.9113%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   4,  Average loss: 0.0017, Accuracy: 284/293 (96.9283%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   5,  Average loss: 0.0004, Accuracy: 291/293 (99.3174%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   6,  Average loss: 0.0009, Accuracy: 289/293 (98.6348%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   7,  Average loss: 0.0010, Accuracy: 290/293 (98.9761%), train_poison_data_count: 293
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   8,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   9,  Average loss: 0.0004, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch  10,  Average loss: 0.0004, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Global model norm: 15.82608642705706.
Norm before scaling: 15.826197786485329. Distance: 1.2647427439046972
Total norm for 7 adversaries is: 15.826197786485329. distance: 1.2647427439046972
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1882, Accuracy: 8491/8991 (94.4389%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0024, Accuracy: 893/923 (96.7497%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   2,  Average loss: 0.0012, Accuracy: 901/923 (97.6165%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   3,  Average loss: 0.0006, Accuracy: 914/923 (99.0249%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   4,  Average loss: 0.0004, Accuracy: 919/923 (99.5666%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   5,  Average loss: 0.0003, Accuracy: 920/923 (99.6750%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   6,  Average loss: 0.0003, Accuracy: 921/923 (99.7833%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 921/923 (99.7833%), train_poison_data_count: 923
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 921/923 (99.7833%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 921/923 (99.7833%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 921/923 (99.7833%), train_poison_data_count: 923
Global model norm: 15.82608642705706.
Norm before scaling: 15.817631910246453. Distance: 2.014029766139335
Total norm for 7 adversaries is: 15.817631910246453. distance: 2.014029766139335
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1710, Accuracy: 8524/8991 (94.8059%)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0039, Accuracy: 145/150 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.5745, Accuracy: 7408/10000 (74.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 1144/1246 (91.8138%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6951, Accuracy: 7992/10000 (79.9200%), Attack Success Rate:1/10000(0.010)
time spent on training: 112.1845178604126
[foolsgold agg] training data poison_ratio: 0.6295996109580159  data num: [257, 376, 977, 658, 400, 889, 293, 923, 150, 1246]
[foolsgold agg] considering poison per batch poison_fraction: 0.6295996109580159
[foolsgold agg] wv: [1. 1. 1. 1. 1. 0. 1. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.8987, Accuracy: 8706/10000 (87.0600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.1329, Accuracy: 8708/8991 (96.8524%)
Done in 273.62756299972534 sec.
Server Epoch:27 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
___Train Local_Simple,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.0051, Accuracy: 242/256 (94.5312%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.3015, Accuracy: 8238/10000 (82.3800%), Attack Success Rate:0/10000(0.000)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 519/548 (94.7080%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   2,  Average loss: 0.0029, Accuracy: 522/548 (95.2555%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   3,  Average loss: 0.0016, Accuracy: 530/548 (96.7153%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   4,  Average loss: 0.0011, Accuracy: 543/548 (99.0876%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   5,  Average loss: 0.0010, Accuracy: 545/548 (99.4526%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   6,  Average loss: 0.0008, Accuracy: 545/548 (99.4526%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   7,  Average loss: 0.0006, Accuracy: 545/548 (99.4526%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   8,  Average loss: 0.0005, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   9,  Average loss: 0.0004, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch  10,  Average loss: 0.0004, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Global model norm: 15.860916739254712.
Norm before scaling: 15.905768906188419. Distance: 2.3130896564000545
Total norm for 7 adversaries is: 15.905768906188419. distance: 2.3130896564000545
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2583, Accuracy: 8217/8991 (91.3914%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   1,  Average loss: 0.0030, Accuracy: 227/236 (96.1864%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   2,  Average loss: 0.0014, Accuracy: 229/236 (97.0339%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   3,  Average loss: 0.0011, Accuracy: 232/236 (98.3051%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   4,  Average loss: 0.0006, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   5,  Average loss: 0.0004, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Global model norm: 15.860916739254712.
Norm before scaling: 15.851966307541462. Distance: 1.0427447589275205
Total norm for 7 adversaries is: 15.851966307541462. distance: 1.0427447589275205
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.3064, Accuracy: 8298/8991 (92.2923%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0021, Accuracy: 628/647 (97.0634%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   2,  Average loss: 0.0008, Accuracy: 631/647 (97.5270%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   3,  Average loss: 0.0002, Accuracy: 644/647 (99.5363%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   4,  Average loss: 0.0002, Accuracy: 644/647 (99.5363%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   5,  Average loss: 0.0002, Accuracy: 644/647 (99.5363%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Global model norm: 15.860916739254712.
Norm before scaling: 15.847709687640988. Distance: 1.6654014394428422
Total norm for 7 adversaries is: 15.847709687640988. distance: 1.6654014394428422
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2955, Accuracy: 8211/8991 (91.3247%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0032, Accuracy: 595/620 (95.9677%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   2,  Average loss: 0.0017, Accuracy: 596/620 (96.1290%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   3,  Average loss: 0.0010, Accuracy: 610/620 (98.3871%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 616/620 (99.3548%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 617/620 (99.5161%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   6,  Average loss: 0.0003, Accuracy: 618/620 (99.6774%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   7,  Average loss: 0.0002, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   8,  Average loss: 0.0002, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   9,  Average loss: 0.0002, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch  10,  Average loss: 0.0002, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Global model norm: 15.860916739254712.
Norm before scaling: 15.834105195087645. Distance: 1.7514373462348731
Total norm for 7 adversaries is: 15.834105195087645. distance: 1.7514373462348731
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2752, Accuracy: 8311/8991 (92.4369%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0017, Accuracy: 837/860 (97.3256%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   2,  Average loss: 0.0009, Accuracy: 845/860 (98.2558%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   3,  Average loss: 0.0003, Accuracy: 854/860 (99.3023%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   4,  Average loss: 0.0002, Accuracy: 858/860 (99.7674%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   5,  Average loss: 0.0002, Accuracy: 857/860 (99.6512%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   8,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Global model norm: 15.860916739254712.
Norm before scaling: 15.807108687504927. Distance: 1.743226908771689
Total norm for 7 adversaries is: 15.807108687504927. distance: 1.743226908771689
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2093, Accuracy: 8396/8991 (93.3823%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   1,  Average loss: 0.0025, Accuracy: 603/628 (96.0191%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   2,  Average loss: 0.0012, Accuracy: 611/628 (97.2930%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   3,  Average loss: 0.0009, Accuracy: 615/628 (97.9299%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   4,  Average loss: 0.0005, Accuracy: 622/628 (99.0446%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   5,  Average loss: 0.0003, Accuracy: 626/628 (99.6815%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   6,  Average loss: 0.0003, Accuracy: 627/628 (99.8408%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   7,  Average loss: 0.0002, Accuracy: 627/628 (99.8408%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   8,  Average loss: 0.0002, Accuracy: 627/628 (99.8408%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   9,  Average loss: 0.0002, Accuracy: 627/628 (99.8408%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch  10,  Average loss: 0.0002, Accuracy: 627/628 (99.8408%), train_poison_data_count: 628
Global model norm: 15.860916739254712.
Norm before scaling: 15.849604441042054. Distance: 1.79382137728111
Total norm for 7 adversaries is: 15.849604441042054. distance: 1.79382137728111
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.4796, Accuracy: 7819/8991 (86.9647%)
___Train Local_Simple,  epoch  27, local model 54, internal_epoch   1,  Average loss: 0.0036, Accuracy: 488/519 (94.0270%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.0755, Accuracy: 7848/10000 (78.4800%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   1,  Average loss: 0.0025, Accuracy: 383/400 (95.7500%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   2,  Average loss: 0.0015, Accuracy: 388/400 (97.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   3,  Average loss: 0.0006, Accuracy: 398/400 (99.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   4,  Average loss: 0.0002, Accuracy: 398/400 (99.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Global model norm: 15.860916739254712.
Norm before scaling: 15.842145428487385. Distance: 1.3509200228377485
Total norm for 7 adversaries is: 15.842145428487385. distance: 1.3509200228377485
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.3637, Accuracy: 8258/8991 (91.8474%)
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0063, Accuracy: 399/435 (91.7241%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.2058, Accuracy: 7751/10000 (77.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 109.01411509513855
[foolsgold agg] training data poison_ratio: 0.7650029131870266  data num: [256, 548, 236, 647, 620, 860, 628, 519, 400, 435]
[foolsgold agg] considering poison per batch poison_fraction: 0.7650029131870266
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.88457398
 0.88457398 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.9069, Accuracy: 8726/10000 (87.2600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.1252, Accuracy: 8719/8991 (96.9748%)
Done in 271.5968132019043 sec.
Server Epoch:28 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   1,  Average loss: 0.0018, Accuracy: 600/623 (96.3082%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   2,  Average loss: 0.0012, Accuracy: 610/623 (97.9133%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   3,  Average loss: 0.0008, Accuracy: 613/623 (98.3949%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   4,  Average loss: 0.0003, Accuracy: 619/623 (99.3579%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   5,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   7,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   8,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   9,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch  10,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Global model norm: 15.899348772255923.
Norm before scaling: 15.861602175820208. Distance: 1.5271784310006233
Total norm for 5 adversaries is: 15.861602175820208. distance: 1.5271784310006233
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.3566, Accuracy: 8063/8991 (89.6786%)
___Train Local_Simple,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 516/568 (90.8451%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.2624, Accuracy: 6918/10000 (69.1800%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0022, Accuracy: 601/620 (96.9355%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   2,  Average loss: 0.0014, Accuracy: 602/620 (97.0968%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 616/620 (99.3548%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   4,  Average loss: 0.0003, Accuracy: 618/620 (99.6774%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   5,  Average loss: 0.0002, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   6,  Average loss: 0.0002, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Global model norm: 15.899348772255923.
Norm before scaling: 15.841657090255248. Distance: 1.430399816280285
Total norm for 5 adversaries is: 15.841657090255248. distance: 1.430399816280285
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.2071, Accuracy: 8458/8991 (94.0718%)
___Train Local_Simple,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0092, Accuracy: 754/889 (84.8144%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.4042, Accuracy: 8808/10000 (88.0800%), Attack Success Rate:0/10000(0.000)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0025, Accuracy: 594/615 (96.5854%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   2,  Average loss: 0.0016, Accuracy: 598/615 (97.2358%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   3,  Average loss: 0.0006, Accuracy: 611/615 (99.3496%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   4,  Average loss: 0.0003, Accuracy: 614/615 (99.8374%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   5,  Average loss: 0.0002, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   6,  Average loss: 0.0002, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   8,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Global model norm: 15.899348772255923.
Norm before scaling: 15.863656384077105. Distance: 1.5701028864247562
Total norm for 5 adversaries is: 15.863656384077105. distance: 1.5701028864247562
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1628, Accuracy: 8526/8991 (94.8282%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.0026, Accuracy: 366/379 (96.5699%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   2,  Average loss: 0.0013, Accuracy: 370/379 (97.6253%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   3,  Average loss: 0.0003, Accuracy: 377/379 (99.4723%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   4,  Average loss: 0.0002, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   5,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   6,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   7,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   8,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   9,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch  10,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Global model norm: 15.899348772255923.
Norm before scaling: 15.851551911344417. Distance: 1.0576201180851594
Total norm for 5 adversaries is: 15.851551911344417. distance: 1.0576201180851594
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1979, Accuracy: 8462/8991 (94.1163%)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0027, Accuracy: 683/713 (95.7924%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.0090, Accuracy: 6796/10000 (67.9600%), Attack Success Rate:0/10000(0.000)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 494/499 (98.9980%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   2,  Average loss: 0.0007, Accuracy: 491/499 (98.3968%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   3,  Average loss: 0.0002, Accuracy: 495/499 (99.1984%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   4,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   5,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%), train_poison_data_count: 499
Global model norm: 15.899348772255923.
Norm before scaling: 15.856676475313906. Distance: 0.8500375304631869
Total norm for 5 adversaries is: 15.856676475313906. distance: 0.8500375304631869
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.2505, Accuracy: 8464/8991 (94.1386%)
___Train Local_Simple,  epoch  28, local model 80, internal_epoch   1,  Average loss: 0.0030, Accuracy: 418/431 (96.9838%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.5413, Accuracy: 7516/10000 (75.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 81, internal_epoch   1,  Average loss: 0.0036, Accuracy: 1157/1227 (94.2950%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.7794, Accuracy: 6899/10000 (68.9900%), Attack Success Rate:0/10000(0.000)
time spent on training: 91.13259291648865
[foolsgold agg] training data poison_ratio: 0.41681901279707495  data num: [623, 568, 620, 889, 615, 379, 713, 499, 431, 1227]
[foolsgold agg] considering poison per batch poison_fraction: 0.41681901279707495
[foolsgold agg] wv: [1.         1.         1.         0.33866372 1.         1.
 1.         1.         1.         0.33866372]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.7975, Accuracy: 8744/10000 (87.4400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.1143, Accuracy: 8739/8991 (97.1972%)
Done in 248.25287675857544 sec.
Server Epoch:29 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
___Train Local_Simple,  epoch  29, local model 58, internal_epoch   1,  Average loss: 0.0032, Accuracy: 266/276 (96.3768%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.1610, Accuracy: 8114/10000 (81.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 90, internal_epoch   1,  Average loss: 0.0043, Accuracy: 642/683 (93.9971%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.5050, Accuracy: 8172/10000 (81.7200%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0023, Accuracy: 384/400 (96.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   2,  Average loss: 0.0008, Accuracy: 392/400 (98.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   3,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   4,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Global model norm: 15.910752773926436.
Norm before scaling: 15.876668526980874. Distance: 1.2174270981693296
Total norm for 5 adversaries is: 15.876668526980874. distance: 1.2174270981693296
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.4073, Accuracy: 8221/8991 (91.4359%)
___Train Local_Simple,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.0068, Accuracy: 673/731 (92.0657%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.1350, Accuracy: 6212/10000 (62.1200%), Attack Success Rate:0/10000(0.000)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0032, Accuracy: 585/606 (96.5347%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0015, Accuracy: 590/606 (97.3597%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0007, Accuracy: 597/606 (98.5149%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 15.910752773926436.
Norm before scaling: 15.842185400279721. Distance: 1.762952892472533
Total norm for 5 adversaries is: 15.842185400279721. distance: 1.762952892472533
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.6154, Accuracy: 7457/8991 (82.9385%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0023, Accuracy: 621/647 (95.9815%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   2,  Average loss: 0.0013, Accuracy: 631/647 (97.5270%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   3,  Average loss: 0.0006, Accuracy: 643/647 (99.3818%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   4,  Average loss: 0.0003, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   5,  Average loss: 0.0003, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   6,  Average loss: 0.0005, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   7,  Average loss: 0.0002, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   8,  Average loss: 0.0002, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   9,  Average loss: 0.0002, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch  10,  Average loss: 0.0003, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Global model norm: 15.910752773926436.
Norm before scaling: 15.919454014295882. Distance: 1.7700596035334615
Total norm for 5 adversaries is: 15.919454014295882. distance: 1.7700596035334615
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.3048, Accuracy: 8129/8991 (90.4126%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0014, Accuracy: 888/915 (97.0492%), train_poison_data_count: 915
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   2,  Average loss: 0.0014, Accuracy: 896/915 (97.9235%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   3,  Average loss: 0.0004, Accuracy: 910/915 (99.4536%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   4,  Average loss: 0.0003, Accuracy: 911/915 (99.5628%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   5,  Average loss: 0.0002, Accuracy: 913/915 (99.7814%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   6,  Average loss: 0.0002, Accuracy: 914/915 (99.8907%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   7,  Average loss: 0.0001, Accuracy: 915/915 (100.0000%), train_poison_data_count: 915
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   8,  Average loss: 0.0001, Accuracy: 915/915 (100.0000%), train_poison_data_count: 915
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   9,  Average loss: 0.0001, Accuracy: 915/915 (100.0000%), train_poison_data_count: 915
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch  10,  Average loss: 0.0001, Accuracy: 915/915 (100.0000%), train_poison_data_count: 915
Global model norm: 15.910752773926436.
Norm before scaling: 15.874740478316685. Distance: 1.596624213605326
Total norm for 5 adversaries is: 15.874740478316685. distance: 1.596624213605326
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0983, Accuracy: 8723/8991 (97.0192%)
___Train Local_Simple,  epoch  29, local model 91, internal_epoch   1,  Average loss: 0.0120, Accuracy: 220/256 (85.9375%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4021, Accuracy: 8899/10000 (88.9900%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0028, Accuracy: 453/474 (95.5696%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0013, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   3,  Average loss: 0.0005, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   4,  Average loss: 0.0003, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   5,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 15.910752773926436.
Norm before scaling: 15.87686939196305. Distance: 1.4557207774931107
Total norm for 5 adversaries is: 15.87686939196305. distance: 1.4557207774931107
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.3451, Accuracy: 8092/8991 (90.0011%)
___Train Local_Simple,  epoch  29, local model 57, internal_epoch   1,  Average loss: 0.0164, Accuracy: 273/343 (79.5918%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.5019, Accuracy: 9100/10000 (91.0000%), Attack Success Rate:0/10000(0.000)
time spent on training: 94.83236813545227
[foolsgold agg] training data poison_ratio: 0.5706246482836241  data num: [276, 683, 400, 731, 606, 647, 915, 256, 474, 343]
[foolsgold agg] considering poison per batch poison_fraction: 0.5706246482836241
[foolsgold agg] wv: [1. 1. 1. 0. 1. 1. 1. 0. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.8839, Accuracy: 8754/10000 (87.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.1076, Accuracy: 8748/8991 (97.2973%)
Done in 256.26757311820984 sec.
Server Epoch:30 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   1,  Average loss: 0.0020, Accuracy: 459/474 (96.8354%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   2,  Average loss: 0.0017, Accuracy: 456/474 (96.2025%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   3,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   4,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 15.935149374753383.
Norm before scaling: 15.911770745023556. Distance: 1.3340067603270254
Total norm for 7 adversaries is: 15.911770745023556. distance: 1.3340067603270254
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2039, Accuracy: 8443/8991 (93.9050%)
___Train Local_Simple,  epoch  30, local model 77, internal_epoch   1,  Average loss: 0.0071, Accuracy: 535/589 (90.8319%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4797, Accuracy: 8411/10000 (84.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0035, Accuracy: 561/591 (94.9239%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3493, Accuracy: 8897/10000 (88.9700%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   1,  Average loss: 0.0019, Accuracy: 303/312 (97.1154%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   2,  Average loss: 0.0007, Accuracy: 308/312 (98.7179%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   3,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   4,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   5,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   6,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   9,  Average loss: 0.0000, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch  10,  Average loss: 0.0000, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Global model norm: 15.935149374753383.
Norm before scaling: 15.911219332118002. Distance: 0.8692602868161278
Total norm for 7 adversaries is: 15.911219332118002. distance: 0.8692602868161278
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2466, Accuracy: 8407/8991 (93.5046%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0020, Accuracy: 867/892 (97.1973%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   2,  Average loss: 0.0006, Accuracy: 883/892 (98.9910%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   3,  Average loss: 0.0002, Accuracy: 891/892 (99.8879%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 891/892 (99.8879%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Global model norm: 15.935149374753383.
Norm before scaling: 15.854912491782171. Distance: 1.7556710317246118
Total norm for 7 adversaries is: 15.854912491782171. distance: 1.7556710317246118
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.7864, Accuracy: 6994/8991 (77.7889%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0027, Accuracy: 607/633 (95.8926%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   2,  Average loss: 0.0013, Accuracy: 616/633 (97.3144%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   3,  Average loss: 0.0005, Accuracy: 629/633 (99.3681%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   4,  Average loss: 0.0004, Accuracy: 631/633 (99.6840%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   5,  Average loss: 0.0003, Accuracy: 633/633 (100.0000%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   6,  Average loss: 0.0003, Accuracy: 633/633 (100.0000%), train_poison_data_count: 633
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   7,  Average loss: 0.0002, Accuracy: 633/633 (100.0000%), train_poison_data_count: 633
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   8,  Average loss: 0.0002, Accuracy: 633/633 (100.0000%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   9,  Average loss: 0.0002, Accuracy: 633/633 (100.0000%), train_poison_data_count: 633
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch  10,  Average loss: 0.0002, Accuracy: 633/633 (100.0000%), train_poison_data_count: 633
Global model norm: 15.935149374753383.
Norm before scaling: 15.917389751739732. Distance: 1.5600663114783668
Total norm for 7 adversaries is: 15.917389751739732. distance: 1.5600663114783668
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1510, Accuracy: 8573/8991 (95.3509%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0021, Accuracy: 756/772 (97.9275%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   2,  Average loss: 0.0063, Accuracy: 683/772 (88.4715%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   3,  Average loss: 0.0030, Accuracy: 737/772 (95.4663%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   4,  Average loss: 0.0018, Accuracy: 751/772 (97.2798%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   5,  Average loss: 0.0013, Accuracy: 753/772 (97.5389%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   6,  Average loss: 0.0010, Accuracy: 759/772 (98.3161%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   7,  Average loss: 0.0009, Accuracy: 762/772 (98.7047%), train_poison_data_count: 772
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   8,  Average loss: 0.0007, Accuracy: 765/772 (99.0933%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   9,  Average loss: 0.0007, Accuracy: 768/772 (99.4819%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch  10,  Average loss: 0.0006, Accuracy: 768/772 (99.4819%), train_poison_data_count: 772
Global model norm: 15.935149374753383.
Norm before scaling: 17.32951890104849. Distance: 6.546540536280522
Total norm for 7 adversaries is: 17.32951890104849. distance: 6.546540536280522
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.3049, Accuracy: 8080/8991 (89.8676%)
___Train Local_Simple,  epoch  30, local model 52, internal_epoch   1,  Average loss: 0.0163, Accuracy: 217/253 (85.7708%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5677, Accuracy: 8570/10000 (85.7000%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 615/628 (97.9299%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   2,  Average loss: 0.0011, Accuracy: 615/628 (97.9299%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   3,  Average loss: 0.0003, Accuracy: 625/628 (99.5223%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   4,  Average loss: 0.0002, Accuracy: 626/628 (99.6815%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   5,  Average loss: 0.0001, Accuracy: 627/628 (99.8408%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Global model norm: 15.935149374753383.
Norm before scaling: 15.8715177306155. Distance: 1.2399524278129124
Total norm for 7 adversaries is: 15.8715177306155. distance: 1.2399524278129124
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2984, Accuracy: 8244/8991 (91.6917%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   1,  Average loss: 0.0031, Accuracy: 386/400 (96.5000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   2,  Average loss: 0.0053, Accuracy: 371/400 (92.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   3,  Average loss: 0.0009, Accuracy: 392/400 (98.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   4,  Average loss: 0.0008, Accuracy: 394/400 (98.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   5,  Average loss: 0.0005, Accuracy: 395/400 (98.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   6,  Average loss: 0.0005, Accuracy: 398/400 (99.5000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   7,  Average loss: 0.0003, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   8,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   9,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch  10,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Global model norm: 15.935149374753383.
Norm before scaling: 15.966403975479361. Distance: 2.0566058468391386
Total norm for 7 adversaries is: 15.966403975479361. distance: 2.0566058468391386
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2075, Accuracy: 8460/8991 (94.0941%)
time spent on training: 117.77395415306091
[foolsgold agg] training data poison_ratio: 0.7415223665223665  data num: [474, 589, 591, 312, 892, 633, 772, 253, 628, 400]
[foolsgold agg] considering poison per batch poison_fraction: 0.7415223665223665
[foolsgold agg] wv: [1. 0. 1. 1. 1. 1. 1. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 1.0563, Accuracy: 8757/10000 (87.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.1123, Accuracy: 8743/8991 (97.2417%)
Done in 323.0314779281616 sec.
Server Epoch:31 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
___Train Local_Simple,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0118, Accuracy: 482/557 (86.5350%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.0612, Accuracy: 7341/10000 (73.4100%), Attack Success Rate:0/10000(0.000)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0044, Accuracy: 413/436 (94.7248%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   2,  Average loss: 0.0023, Accuracy: 415/436 (95.1835%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   3,  Average loss: 0.0018, Accuracy: 418/436 (95.8716%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   4,  Average loss: 0.0009, Accuracy: 426/436 (97.7064%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   5,  Average loss: 0.0005, Accuracy: 432/436 (99.0826%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   6,  Average loss: 0.0004, Accuracy: 433/436 (99.3119%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   7,  Average loss: 0.0003, Accuracy: 435/436 (99.7706%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   8,  Average loss: 0.0003, Accuracy: 435/436 (99.7706%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   9,  Average loss: 0.0003, Accuracy: 435/436 (99.7706%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch  10,  Average loss: 0.0003, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Global model norm: 15.98683864964445.
Norm before scaling: 15.968926296268766. Distance: 1.5928871960832005
Total norm for 7 adversaries is: 15.968926296268766. distance: 1.5928871960832005
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1600, Accuracy: 8524/8991 (94.8059%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0123, Accuracy: 322/377 (85.4111%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.5453, Accuracy: 8508/10000 (85.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 85, internal_epoch   1,  Average loss: 0.0059, Accuracy: 400/431 (92.8074%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.5820, Accuracy: 8056/10000 (80.5600%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 643/658 (97.7204%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   2,  Average loss: 0.0011, Accuracy: 647/658 (98.3283%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   3,  Average loss: 0.0004, Accuracy: 655/658 (99.5441%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   4,  Average loss: 0.0002, Accuracy: 656/658 (99.6960%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   5,  Average loss: 0.0002, Accuracy: 657/658 (99.8480%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   6,  Average loss: 0.0001, Accuracy: 657/658 (99.8480%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   7,  Average loss: 0.0001, Accuracy: 657/658 (99.8480%), train_poison_data_count: 658
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   8,  Average loss: 0.0001, Accuracy: 657/658 (99.8480%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   9,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch  10,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%), train_poison_data_count: 658
Global model norm: 15.98683864964445.
Norm before scaling: 15.944191399374345. Distance: 1.392827122752541
Total norm for 7 adversaries is: 15.944191399374345. distance: 1.392827122752541
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.7918, Accuracy: 7771/8991 (86.4309%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0024, Accuracy: 622/645 (96.4341%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   2,  Average loss: 0.0017, Accuracy: 619/645 (95.9690%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   3,  Average loss: 0.0006, Accuracy: 639/645 (99.0698%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   7,  Average loss: 0.0002, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   8,  Average loss: 0.0002, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   9,  Average loss: 0.0002, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch  10,  Average loss: 0.0002, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Global model norm: 15.98683864964445.
Norm before scaling: 15.937400428610527. Distance: 1.5503851627360317
Total norm for 7 adversaries is: 15.937400428610527. distance: 1.5503851627360317
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.2528, Accuracy: 8314/8991 (92.4702%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   1,  Average loss: 0.0020, Accuracy: 368/379 (97.0976%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   2,  Average loss: 0.0015, Accuracy: 372/379 (98.1530%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   3,  Average loss: 0.0002, Accuracy: 378/379 (99.7361%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   4,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   5,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   6,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   7,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   8,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   9,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch  10,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%), train_poison_data_count: 379
Global model norm: 15.98683864964445.
Norm before scaling: 15.943915777417503. Distance: 0.9578288588752623
Total norm for 7 adversaries is: 15.943915777417503. distance: 0.9578288588752623
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1333, Accuracy: 8639/8991 (96.0850%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0012, Accuracy: 231/236 (97.8814%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   2,  Average loss: 0.0008, Accuracy: 232/236 (98.3051%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   3,  Average loss: 0.0003, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   7,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Global model norm: 15.98683864964445.
Norm before scaling: 15.983602704644591. Distance: 0.7234917424672548
Total norm for 7 adversaries is: 15.983602704644591. distance: 0.7234917424672548
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.2923, Accuracy: 8373/8991 (93.1265%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0011, Accuracy: 286/293 (97.6109%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 291/293 (99.3174%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   3,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   4,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   5,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Global model norm: 15.98683864964445.
Norm before scaling: 15.960910253739593. Distance: 0.6955688946797012
Total norm for 7 adversaries is: 15.960910253739593. distance: 0.6955688946797012
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1623, Accuracy: 8605/8991 (95.7068%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   1,  Average loss: 0.0020, Accuracy: 630/647 (97.3725%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   2,  Average loss: 0.0008, Accuracy: 636/647 (98.2998%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   3,  Average loss: 0.0006, Accuracy: 642/647 (99.2272%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   4,  Average loss: 0.0004, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   5,  Average loss: 0.0002, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   6,  Average loss: 0.0002, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Global model norm: 15.98683864964445.
Norm before scaling: 15.931521741810029. Distance: 1.429993893670336
Total norm for 7 adversaries is: 15.931521741810029. distance: 1.429993893670336
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.2734, Accuracy: 8274/8991 (92.0254%)
time spent on training: 132.68804597854614
[foolsgold agg] training data poison_ratio: 0.7070186735350934  data num: [557, 436, 377, 431, 658, 645, 379, 236, 293, 647]
[foolsgold agg] considering poison per batch poison_fraction: 0.7070186735350934
[foolsgold agg] wv: [0.         1.         0.18625694 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 1.0001, Accuracy: 8751/10000 (87.5100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.1111, Accuracy: 8741/8991 (97.2194%)
Done in 305.06861877441406 sec.
Server Epoch:32 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0029, Accuracy: 598/623 (95.9872%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.5368, Accuracy: 7655/10000 (76.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.0043, Accuracy: 434/470 (92.3404%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.8536, Accuracy: 7798/10000 (77.9800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  32, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 347/354 (98.0226%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.9919, Accuracy: 7509/10000 (75.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 70, internal_epoch   1,  Average loss: 0.0045, Accuracy: 677/724 (93.5083%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5421, Accuracy: 8251/10000 (82.5100%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0016, Accuracy: 390/401 (97.2569%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   2,  Average loss: 0.0004, Accuracy: 397/401 (99.0025%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   3,  Average loss: 0.0004, Accuracy: 397/401 (99.0025%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   5,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   6,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   7,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   8,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   9,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch  10,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Global model norm: 16.00628824642785.
Norm before scaling: 15.9687519110811. Distance: 1.0681581743600854
Total norm for 2 adversaries is: 15.9687519110811. distance: 1.0681581743600854
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.3117, Accuracy: 8300/8991 (92.3145%)
___Train Local_Simple,  epoch  32, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 633/683 (92.6794%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.7814, Accuracy: 6778/10000 (67.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 91, internal_epoch   1,  Average loss: 0.0091, Accuracy: 231/256 (90.2344%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5504, Accuracy: 8659/10000 (86.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 86, internal_epoch   1,  Average loss: 0.0090, Accuracy: 227/250 (90.8000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.0950, Accuracy: 8526/10000 (85.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 923/998 (92.4850%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.7943, Accuracy: 7595/10000 (75.9500%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0025, Accuracy: 412/429 (96.0373%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   2,  Average loss: 0.0012, Accuracy: 424/429 (98.8345%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   3,  Average loss: 0.0007, Accuracy: 420/429 (97.9021%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   4,  Average loss: 0.0003, Accuracy: 426/429 (99.3007%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   5,  Average loss: 0.0002, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Global model norm: 16.00628824642785.
Norm before scaling: 15.994796383591105. Distance: 1.5367307087481907
Total norm for 2 adversaries is: 15.994796383591105. distance: 1.5367307087481907
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.4391, Accuracy: 7957/8991 (88.4996%)
time spent on training: 59.59747910499573
[foolsgold agg] training data poison_ratio: 0.1599845797995374  data num: [623, 470, 354, 724, 401, 683, 256, 250, 998, 429]
[foolsgold agg] considering poison per batch poison_fraction: 0.1599845797995374
[foolsgold agg] wv: [0. 1. 1. 1. 1. 1. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.9009, Accuracy: 8768/10000 (87.6800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.1060, Accuracy: 8749/8991 (97.3084%)
Done in 250.58101606369019 sec.
Server Epoch:33 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
___Train Local_Simple,  epoch  33, local model 77, internal_epoch   1,  Average loss: 0.0090, Accuracy: 517/589 (87.7759%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4228, Accuracy: 8697/10000 (86.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0137, Accuracy: 277/343 (80.7580%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5747, Accuracy: 8087/10000 (80.8700%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   1,  Average loss: 0.0018, Accuracy: 304/312 (97.4359%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   2,  Average loss: 0.0004, Accuracy: 310/312 (99.3590%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   3,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   4,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   5,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   6,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   9,  Average loss: 0.0000, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Global model norm: 16.00149624504153.
Norm before scaling: 15.971541845600921. Distance: 0.8182729889425554
Total norm for 4 adversaries is: 15.971541845600921. distance: 0.8182729889425554
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.2658, Accuracy: 8423/8991 (93.6826%)
___Train Local_Simple,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.0060, Accuracy: 921/998 (92.2846%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.3837, Accuracy: 6672/10000 (66.7200%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 364/376 (96.8085%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   2,  Average loss: 0.0023, Accuracy: 356/376 (94.6809%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   3,  Average loss: 0.0012, Accuracy: 368/376 (97.8723%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   4,  Average loss: 0.0003, Accuracy: 373/376 (99.2021%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 375/376 (99.7340%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 375/376 (99.7340%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Global model norm: 16.00149624504153.
Norm before scaling: 15.961801708125911. Distance: 1.1254214980694812
Total norm for 4 adversaries is: 15.961801708125911. distance: 1.1254214980694812
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.1317, Accuracy: 8645/8991 (96.1517%)
___Train Local_Simple,  epoch  33, local model 97, internal_epoch   1,  Average loss: 0.0018, Accuracy: 475/487 (97.5359%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.7311, Accuracy: 8396/10000 (83.9600%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0029, Accuracy: 481/501 (96.0080%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   2,  Average loss: 0.0011, Accuracy: 487/501 (97.2056%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   3,  Average loss: 0.0006, Accuracy: 496/501 (99.0020%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   4,  Average loss: 0.0003, Accuracy: 500/501 (99.8004%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   5,  Average loss: 0.0002, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   6,  Average loss: 0.0002, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   7,  Average loss: 0.0002, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   8,  Average loss: 0.0002, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Global model norm: 16.00149624504153.
Norm before scaling: 15.952662536912186. Distance: 1.2336254016760766
Total norm for 4 adversaries is: 15.952662536912186. distance: 1.2336254016760766
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.1104, Accuracy: 8676/8991 (96.4965%)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   1,  Average loss: 0.0021, Accuracy: 565/583 (96.9125%), train_poison_data_count: 583
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   2,  Average loss: 0.0015, Accuracy: 567/583 (97.2556%), train_poison_data_count: 583
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   3,  Average loss: 0.0009, Accuracy: 570/583 (97.7702%), train_poison_data_count: 583
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   4,  Average loss: 0.0003, Accuracy: 582/583 (99.8285%), train_poison_data_count: 583
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   5,  Average loss: 0.0004, Accuracy: 581/583 (99.6569%), train_poison_data_count: 583
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   6,  Average loss: 0.0002, Accuracy: 582/583 (99.8285%), train_poison_data_count: 583
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   7,  Average loss: 0.0002, Accuracy: 582/583 (99.8285%), train_poison_data_count: 583
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   8,  Average loss: 0.0002, Accuracy: 582/583 (99.8285%), train_poison_data_count: 583
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   9,  Average loss: 0.0001, Accuracy: 583/583 (100.0000%), train_poison_data_count: 583
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch  10,  Average loss: 0.0001, Accuracy: 583/583 (100.0000%), train_poison_data_count: 583
Global model norm: 16.00149624504153.
Norm before scaling: 15.948106534970892. Distance: 1.3442870109419232
Total norm for 4 adversaries is: 15.948106534970892. distance: 1.3442870109419232
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.1258, Accuracy: 8673/8991 (96.4631%)
___Train Local_Simple,  epoch  33, local model 70, internal_epoch   1,  Average loss: 0.0039, Accuracy: 683/724 (94.3370%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.7919, Accuracy: 7089/10000 (70.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0018, Accuracy: 604/623 (96.9502%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.2400, Accuracy: 7886/10000 (78.8600%), Attack Success Rate:0/10000(0.000)
time spent on training: 94.8360710144043
[foolsgold agg] training data poison_ratio: 0.32008670520231214  data num: [589, 343, 312, 998, 376, 487, 501, 583, 724, 623]
[foolsgold agg] considering poison per batch poison_fraction: 0.32008670520231214
[foolsgold agg] wv: [0.         0.         1.         0.         1.         1.
 0.45753858 0.45753858 1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.9104, Accuracy: 8775/10000 (87.7500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.1038, Accuracy: 8757/8991 (97.3974%)
Done in 290.60814595222473 sec.
Server Epoch:34 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0017, Accuracy: 844/860 (98.1395%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   2,  Average loss: 0.0008, Accuracy: 849/860 (98.7209%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   3,  Average loss: 0.0004, Accuracy: 855/860 (99.4186%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   4,  Average loss: 0.0002, Accuracy: 857/860 (99.6512%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   5,  Average loss: 0.0002, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   8,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Global model norm: 16.005015540790254.
Norm before scaling: 15.934660535200313. Distance: 1.5751943286720036
Total norm for 7 adversaries is: 15.934660535200313. distance: 1.5751943286720036
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2013, Accuracy: 8388/8991 (93.2933%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 497/506 (98.2213%), train_poison_data_count: 506
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 503/506 (99.4071%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   3,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   4,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   5,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   6,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%), train_poison_data_count: 506
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   7,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%), train_poison_data_count: 506
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   8,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%), train_poison_data_count: 506
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   9,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%), train_poison_data_count: 506
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch  10,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%), train_poison_data_count: 506
Global model norm: 16.005015540790254.
Norm before scaling: 15.976029082629495. Distance: 0.8441219922665586
Total norm for 7 adversaries is: 15.976029082629495. distance: 0.8441219922665586
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1821, Accuracy: 8571/8991 (95.3287%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0025, Accuracy: 590/606 (97.3597%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0007, Accuracy: 596/606 (98.3498%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 16.005015540790254.
Norm before scaling: 15.941992511732673. Distance: 1.4072055537120187
Total norm for 7 adversaries is: 15.941992511732673. distance: 1.4072055537120187
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.4483, Accuracy: 7740/8991 (86.0861%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0022, Accuracy: 459/474 (96.8354%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0015, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   3,  Average loss: 0.0014, Accuracy: 464/474 (97.8903%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   4,  Average loss: 0.0003, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 16.005015540790254.
Norm before scaling: 15.968092574529683. Distance: 1.2733006784153118
Total norm for 7 adversaries is: 15.968092574529683. distance: 1.2733006784153118
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2328, Accuracy: 8373/8991 (93.1265%)
___Train Local_Simple,  epoch  34, local model 71, internal_epoch   1,  Average loss: 0.0031, Accuracy: 1315/1384 (95.0145%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.8749, Accuracy: 6948/10000 (69.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 60, internal_epoch   1,  Average loss: 0.0026, Accuracy: 326/338 (96.4497%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.8721, Accuracy: 8263/10000 (82.6300%), Attack Success Rate:0/10000(0.000)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0011, Accuracy: 231/236 (97.8814%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   3,  Average loss: 0.0003, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   4,  Average loss: 0.0003, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   5,  Average loss: 0.0002, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 235/236 (99.5763%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Global model norm: 16.005015540790254.
Norm before scaling: 15.9984025157714. Distance: 0.6475448899191848
Total norm for 7 adversaries is: 15.9984025157714. distance: 0.6475448899191848
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2313, Accuracy: 8487/8991 (94.3944%)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0034, Accuracy: 412/433 (95.1501%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1698, Accuracy: 9492/10000 (94.9200%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.0017, Accuracy: 539/554 (97.2924%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   2,  Average loss: 0.0006, Accuracy: 546/554 (98.5560%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   3,  Average loss: 0.0013, Accuracy: 541/554 (97.6534%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 16.005015540790254.
Norm before scaling: 15.990597346291068. Distance: 1.184749630582051
Total norm for 7 adversaries is: 15.990597346291068. distance: 1.184749630582051
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1233, Accuracy: 8693/8991 (96.6856%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   1,  Average loss: 0.0016, Accuracy: 436/448 (97.3214%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   2,  Average loss: 0.0012, Accuracy: 436/448 (97.3214%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   3,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   7,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Global model norm: 16.005015540790254.
Norm before scaling: 15.972133210897054. Distance: 0.976932150498541
Total norm for 7 adversaries is: 15.972133210897054. distance: 0.976932150498541
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1331, Accuracy: 8625/8991 (95.9293%)
time spent on training: 130.6837658882141
[foolsgold agg] training data poison_ratio: 0.6309299537592054  data num: [860, 506, 606, 474, 1384, 338, 236, 433, 554, 448]
[foolsgold agg] considering poison per batch poison_fraction: 0.6309299537592054
[foolsgold agg] wv: [0.91243188 1.         0.92427249 1.         1.         1.
 1.         1.         0.91243188 1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.7708, Accuracy: 8773/10000 (87.7300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.0973, Accuracy: 8754/8991 (97.3640%)
Done in 329.9258723258972 sec.
Server Epoch:35 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 460/474 (97.0464%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   3,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   4,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 16.02254042771659.
Norm before scaling: 15.980223354263495. Distance: 1.0943155733767234
Total norm for 6 adversaries is: 15.980223354263495. distance: 1.0943155733767234
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.3547, Accuracy: 8134/8991 (90.4682%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 975/1005 (97.0149%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   2,  Average loss: 0.0011, Accuracy: 982/1005 (97.7114%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   3,  Average loss: 0.0005, Accuracy: 992/1005 (98.7065%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1003/1005 (99.8010%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1003/1005 (99.8010%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1005/1005 (100.0000%), train_poison_data_count: 1005
Global model norm: 16.02254042771659.
Norm before scaling: 16.067605242612288. Distance: 2.0058092150039166
Total norm for 6 adversaries is: 16.067605242612288. distance: 2.0058092150039166
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.2141, Accuracy: 8411/8991 (93.5491%)
___Train Local_Simple,  epoch  35, local model 53, internal_epoch   1,  Average loss: 0.0040, Accuracy: 685/739 (92.6928%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.5275, Accuracy: 8521/10000 (85.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.0129, Accuracy: 147/182 (80.7692%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4703, Accuracy: 8604/10000 (86.0400%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 606/623 (97.2713%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   2,  Average loss: 0.0007, Accuracy: 614/623 (98.5554%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   3,  Average loss: 0.0004, Accuracy: 618/623 (99.1974%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   4,  Average loss: 0.0002, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   7,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   8,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   9,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch  10,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Global model norm: 16.02254042771659.
Norm before scaling: 15.969776695376655. Distance: 1.1799381318279833
Total norm for 6 adversaries is: 15.969776695376655. distance: 1.1799381318279833
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.2320, Accuracy: 8393/8991 (93.3489%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   1,  Average loss: 0.0018, Accuracy: 628/647 (97.0634%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   2,  Average loss: 0.0004, Accuracy: 640/647 (98.9181%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   3,  Average loss: 0.0002, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   4,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Global model norm: 16.02254042771659.
Norm before scaling: 15.99579803603341. Distance: 1.4478178836780873
Total norm for 6 adversaries is: 15.99579803603341. distance: 1.4478178836780873
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.3159, Accuracy: 8143/8991 (90.5683%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0013, Accuracy: 389/401 (97.0075%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   2,  Average loss: 0.0006, Accuracy: 396/401 (98.7531%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   3,  Average loss: 0.0004, Accuracy: 398/401 (99.2519%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   4,  Average loss: 0.0002, Accuracy: 399/401 (99.5012%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   6,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   7,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   8,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   9,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch  10,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Global model norm: 16.02254042771659.
Norm before scaling: 15.990807753743633. Distance: 1.0584456561900304
Total norm for 6 adversaries is: 15.990807753743633. distance: 1.0584456561900304
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.2394, Accuracy: 8402/8991 (93.4490%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 714/760 (93.9474%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   2,  Average loss: 0.0015, Accuracy: 740/760 (97.3684%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   3,  Average loss: 0.0010, Accuracy: 753/760 (99.0789%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   4,  Average loss: 0.0006, Accuracy: 754/760 (99.2105%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   5,  Average loss: 0.0005, Accuracy: 755/760 (99.3421%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   6,  Average loss: 0.0004, Accuracy: 756/760 (99.4737%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   7,  Average loss: 0.0003, Accuracy: 756/760 (99.4737%), train_poison_data_count: 760
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   8,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   9,  Average loss: 0.0003, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch  10,  Average loss: 0.0003, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Global model norm: 16.02254042771659.
Norm before scaling: 16.07944316298424. Distance: 1.9871121249996329
Total norm for 6 adversaries is: 16.07944316298424. distance: 1.9871121249996329
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.2407, Accuracy: 8210/8991 (91.3135%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0010, Accuracy: 361/371 (97.3046%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.9228, Accuracy: 8649/10000 (86.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 98, internal_epoch   1,  Average loss: 0.0104, Accuracy: 705/818 (86.1858%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.5017, Accuracy: 6463/10000 (64.6300%), Attack Success Rate:0/10000(0.000)
time spent on training: 122.61370015144348
[foolsgold agg] training data poison_ratio: 0.6495016611295681  data num: [474, 1005, 739, 182, 623, 647, 401, 760, 371, 818]
[foolsgold agg] considering poison per batch poison_fraction: 0.6495016611295681
[foolsgold agg] wv: [1. 1. 1. 0. 1. 1. 1. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.8925, Accuracy: 8773/10000 (87.7300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.0965, Accuracy: 8757/8991 (97.3974%)
Done in 282.59958600997925 sec.
Server Epoch:36 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  36, local model 82, internal_epoch   1,  Average loss: 0.0040, Accuracy: 678/713 (95.0912%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.0168, Accuracy: 6760/10000 (67.6000%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 642/658 (97.5684%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   2,  Average loss: 0.0011, Accuracy: 641/658 (97.4164%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   3,  Average loss: 0.0004, Accuracy: 653/658 (99.2401%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   4,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   5,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   6,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%), train_poison_data_count: 658
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   7,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%), train_poison_data_count: 658
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   8,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   9,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%), train_poison_data_count: 658
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch  10,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%), train_poison_data_count: 658
Global model norm: 16.057271499777855.
Norm before scaling: 16.039835930268172. Distance: 1.7059271622299301
Total norm for 5 adversaries is: 16.039835930268172. distance: 1.7059271622299301
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 1.0300, Accuracy: 7713/8991 (85.7858%)
___Train Local_Simple,  epoch  36, local model 79, internal_epoch   1,  Average loss: 0.0246, Accuracy: 135/182 (74.1758%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5161, Accuracy: 8476/10000 (84.7600%), Attack Success Rate:0/10000(0.000)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0025, Accuracy: 940/977 (96.2129%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   2,  Average loss: 0.0014, Accuracy: 953/977 (97.5435%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   3,  Average loss: 0.0006, Accuracy: 967/977 (98.9765%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   4,  Average loss: 0.0004, Accuracy: 973/977 (99.5906%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   5,  Average loss: 0.0003, Accuracy: 974/977 (99.6929%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   6,  Average loss: 0.0003, Accuracy: 975/977 (99.7953%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   7,  Average loss: 0.0002, Accuracy: 975/977 (99.7953%), train_poison_data_count: 977
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   8,  Average loss: 0.0002, Accuracy: 976/977 (99.8976%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   9,  Average loss: 0.0002, Accuracy: 976/977 (99.8976%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch  10,  Average loss: 0.0002, Accuracy: 976/977 (99.8976%), train_poison_data_count: 977
Global model norm: 16.057271499777855.
Norm before scaling: 16.016081357827417. Distance: 1.781661872762161
Total norm for 5 adversaries is: 16.016081357827417. distance: 1.781661872762161
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.2026, Accuracy: 8460/8991 (94.0941%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   1,  Average loss: 0.0007, Accuracy: 766/776 (98.7113%), train_poison_data_count: 776
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 770/776 (99.2268%), train_poison_data_count: 776
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   3,  Average loss: 0.0003, Accuracy: 770/776 (99.2268%), train_poison_data_count: 776
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   4,  Average loss: 0.0001, Accuracy: 775/776 (99.8711%), train_poison_data_count: 776
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   5,  Average loss: 0.0001, Accuracy: 775/776 (99.8711%), train_poison_data_count: 776
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   6,  Average loss: 0.0000, Accuracy: 776/776 (100.0000%), train_poison_data_count: 776
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   7,  Average loss: 0.0000, Accuracy: 776/776 (100.0000%), train_poison_data_count: 776
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   8,  Average loss: 0.0000, Accuracy: 776/776 (100.0000%), train_poison_data_count: 776
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   9,  Average loss: 0.0000, Accuracy: 776/776 (100.0000%), train_poison_data_count: 776
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch  10,  Average loss: 0.0000, Accuracy: 776/776 (100.0000%), train_poison_data_count: 776
Global model norm: 16.057271499777855.
Norm before scaling: 15.996070856210723. Distance: 0.9142145861744535
Total norm for 5 adversaries is: 15.996070856210723. distance: 0.9142145861744535
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1197, Accuracy: 8704/8991 (96.8079%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   1,  Average loss: 0.0025, Accuracy: 502/517 (97.0986%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   2,  Average loss: 0.0009, Accuracy: 507/517 (98.0658%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   3,  Average loss: 0.0004, Accuracy: 514/517 (99.4197%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   4,  Average loss: 0.0003, Accuracy: 516/517 (99.8066%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   5,  Average loss: 0.0002, Accuracy: 517/517 (100.0000%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   6,  Average loss: 0.0002, Accuracy: 517/517 (100.0000%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   7,  Average loss: 0.0002, Accuracy: 517/517 (100.0000%), train_poison_data_count: 517
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   8,  Average loss: 0.0001, Accuracy: 517/517 (100.0000%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   9,  Average loss: 0.0001, Accuracy: 517/517 (100.0000%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch  10,  Average loss: 0.0001, Accuracy: 517/517 (100.0000%), train_poison_data_count: 517
Global model norm: 16.057271499777855.
Norm before scaling: 15.982629406609647. Distance: 1.2611120318289453
Total norm for 5 adversaries is: 15.982629406609647. distance: 1.2611120318289453
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1067, Accuracy: 8701/8991 (96.7746%)
___Train Local_Simple,  epoch  36, local model 89, internal_epoch   1,  Average loss: 0.0026, Accuracy: 476/492 (96.7480%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.0527, Accuracy: 7846/10000 (78.4600%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   1,  Average loss: 0.0013, Accuracy: 439/448 (97.9911%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   2,  Average loss: 0.0006, Accuracy: 442/448 (98.6607%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   3,  Average loss: 0.0004, Accuracy: 443/448 (98.8839%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   4,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Global model norm: 16.057271499777855.
Norm before scaling: 16.0216604481441. Distance: 0.8873765161063116
Total norm for 5 adversaries is: 16.0216604481441. distance: 0.8873765161063116
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1357, Accuracy: 8657/8991 (96.2852%)
___Train Local_Simple,  epoch  36, local model 70, internal_epoch   1,  Average loss: 0.0034, Accuracy: 687/724 (94.8895%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.7550, Accuracy: 7885/10000 (78.8500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  36, local model 77, internal_epoch   1,  Average loss: 0.0090, Accuracy: 520/589 (88.2852%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.7234, Accuracy: 7751/10000 (77.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 101.57639288902283
[foolsgold agg] training data poison_ratio: 0.5556287030941409  data num: [713, 658, 182, 977, 776, 517, 492, 448, 724, 589]
[foolsgold agg] considering poison per batch poison_fraction: 0.5556287030941409
[foolsgold agg] wv: [1. 1. 0. 1. 1. 1. 1. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.9594, Accuracy: 8772/10000 (87.7200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.0951, Accuracy: 8754/8991 (97.3640%)
Done in 285.8503041267395 sec.
Server Epoch:37 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0031, Accuracy: 456/471 (96.8153%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   2,  Average loss: 0.0020, Accuracy: 458/471 (97.2399%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   3,  Average loss: 0.0013, Accuracy: 459/471 (97.4522%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   4,  Average loss: 0.0008, Accuracy: 466/471 (98.9384%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   5,  Average loss: 0.0005, Accuracy: 469/471 (99.5754%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   6,  Average loss: 0.0005, Accuracy: 468/471 (99.3631%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   7,  Average loss: 0.0004, Accuracy: 469/471 (99.5754%), train_poison_data_count: 471
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   8,  Average loss: 0.0004, Accuracy: 469/471 (99.5754%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   9,  Average loss: 0.0003, Accuracy: 470/471 (99.7877%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch  10,  Average loss: 0.0003, Accuracy: 470/471 (99.7877%), train_poison_data_count: 471
Global model norm: 16.073497762536494.
Norm before scaling: 16.06016767022384. Distance: 1.9500547156849315
Total norm for 7 adversaries is: 16.06016767022384. distance: 1.9500547156849315
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.7389, Accuracy: 7855/8991 (87.3651%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 390/400 (97.5000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0003, Accuracy: 397/400 (99.2500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   3,  Average loss: 0.0002, Accuracy: 399/400 (99.7500%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   6,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   7,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   8,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%), train_poison_data_count: 400
Global model norm: 16.073497762536494.
Norm before scaling: 16.044358751720377. Distance: 1.0191635111720678
Total norm for 7 adversaries is: 16.044358751720377. distance: 1.0191635111720678
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.3487, Accuracy: 8337/8991 (92.7261%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   1,  Average loss: 0.0017, Accuracy: 605/623 (97.1108%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   2,  Average loss: 0.0025, Accuracy: 600/623 (96.3082%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   3,  Average loss: 0.0022, Accuracy: 595/623 (95.5056%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   4,  Average loss: 0.0006, Accuracy: 616/623 (98.8764%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   5,  Average loss: 0.0005, Accuracy: 620/623 (99.5185%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   6,  Average loss: 0.0003, Accuracy: 621/623 (99.6790%), train_poison_data_count: 623
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   8,  Average loss: 0.0002, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch  10,  Average loss: 0.0002, Accuracy: 623/623 (100.0000%), train_poison_data_count: 623
Global model norm: 16.073497762536494.
Norm before scaling: 16.053045080222514. Distance: 1.5104891880207834
Total norm for 7 adversaries is: 16.053045080222514. distance: 1.5104891880207834
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1810, Accuracy: 8455/8991 (94.0385%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0028, Accuracy: 587/606 (96.8647%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0019, Accuracy: 581/606 (95.8746%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0006, Accuracy: 599/606 (98.8449%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 16.073497762536494.
Norm before scaling: 16.035209062793662. Distance: 1.8278255380396033
Total norm for 7 adversaries is: 16.035209062793662. distance: 1.8278255380396033
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.6289, Accuracy: 7486/8991 (83.2610%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 417/434 (96.0829%), train_poison_data_count: 434
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   2,  Average loss: 0.0009, Accuracy: 426/434 (98.1567%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   3,  Average loss: 0.0002, Accuracy: 433/434 (99.7696%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   4,  Average loss: 0.0002, Accuracy: 433/434 (99.7696%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   5,  Average loss: 0.0002, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   7,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   8,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   9,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch  10,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Global model norm: 16.073497762536494.
Norm before scaling: 16.006561841090555. Distance: 1.1343597894494766
Total norm for 7 adversaries is: 16.006561841090555. distance: 1.1343597894494766
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.2802, Accuracy: 8159/8991 (90.7463%)
___Train Local_Simple,  epoch  37, local model 52, internal_epoch   1,  Average loss: 0.0177, Accuracy: 215/253 (84.9802%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4908, Accuracy: 8630/10000 (86.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 1164/1246 (93.4189%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2772, Accuracy: 9108/10000 (91.0800%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 401/408 (98.2843%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 406/408 (99.5098%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   3,  Average loss: 0.0001, Accuracy: 407/408 (99.7549%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   4,  Average loss: 0.0001, Accuracy: 407/408 (99.7549%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   5,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   6,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   7,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Global model norm: 16.073497762536494.
Norm before scaling: 16.053427185933305. Distance: 0.764212180612266
Total norm for 7 adversaries is: 16.053427185933305. distance: 0.764212180612266
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.2764, Accuracy: 8423/8991 (93.6826%)
___Train Local_Simple,  epoch  37, local model 62, internal_epoch   1,  Average loss: 0.0065, Accuracy: 377/423 (89.1253%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6249, Accuracy: 8004/10000 (80.0400%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0028, Accuracy: 441/459 (96.0784%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   2,  Average loss: 0.0013, Accuracy: 449/459 (97.8214%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   3,  Average loss: 0.0014, Accuracy: 444/459 (96.7320%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   4,  Average loss: 0.0005, Accuracy: 455/459 (99.1285%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   5,  Average loss: 0.0003, Accuracy: 457/459 (99.5643%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   6,  Average loss: 0.0002, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Global model norm: 16.073497762536494.
Norm before scaling: 16.054744525446168. Distance: 1.6175025964683671
Total norm for 7 adversaries is: 16.054744525446168. distance: 1.6175025964683671
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1165, Accuracy: 8701/8991 (96.7746%)
time spent on training: 118.04673099517822
[foolsgold agg] training data poison_ratio: 0.6389254179973699  data num: [471, 400, 623, 606, 434, 253, 1246, 408, 423, 459]
[foolsgold agg] considering poison per batch poison_fraction: 0.6389254179973699
[foolsgold agg] wv: [1.         1.         1.         0.86441111 1.         0.
 0.         1.         1.         0.86441111]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 1.0614, Accuracy: 8764/10000 (87.6400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.0989, Accuracy: 8745/8991 (97.2639%)
Done in 291.85023403167725 sec.
Server Epoch:38 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 254/257 (98.8327%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 256/257 (99.6109%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Global model norm: 16.094871585614527.
Norm before scaling: 16.066720133543416. Distance: 0.5292604159364968
Total norm for 5 adversaries is: 16.066720133543416. distance: 0.5292604159364968
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.1315, Accuracy: 8661/8991 (96.3297%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   1,  Average loss: 0.0016, Accuracy: 975/1002 (97.3054%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   2,  Average loss: 0.0006, Accuracy: 988/1002 (98.6028%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Global model norm: 16.094871585614527.
Norm before scaling: 16.02016799133839. Distance: 1.6338447337860729
Total norm for 5 adversaries is: 16.02016799133839. distance: 1.6338447337860729
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.1633, Accuracy: 8549/8991 (95.0840%)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 439/470 (93.4043%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1995, Accuracy: 9340/10000 (93.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0015, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0509, Accuracy: 7848/10000 (78.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0037, Accuracy: 696/739 (94.1813%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4191, Accuracy: 8619/10000 (86.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 83, internal_epoch   1,  Average loss: 0.0044, Accuracy: 406/433 (93.7644%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1657, Accuracy: 9481/10000 (94.8100%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0023, Accuracy: 196/205 (95.6098%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   2,  Average loss: 0.0005, Accuracy: 204/205 (99.5122%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   3,  Average loss: 0.0007, Accuracy: 202/205 (98.5366%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   4,  Average loss: 0.0004, Accuracy: 203/205 (99.0244%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   5,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   6,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   7,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   8,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   9,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch  10,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Global model norm: 16.094871585614527.
Norm before scaling: 16.08254691986588. Distance: 0.8346704524279877
Total norm for 5 adversaries is: 16.08254691986588. distance: 0.8346704524279877
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.2829, Accuracy: 8350/8991 (92.8706%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 614/628 (97.7707%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   2,  Average loss: 0.0006, Accuracy: 622/628 (99.0446%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   3,  Average loss: 0.0004, Accuracy: 623/628 (99.2038%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   4,  Average loss: 0.0002, Accuracy: 626/628 (99.6815%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   5,  Average loss: 0.0001, Accuracy: 627/628 (99.8408%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 627/628 (99.8408%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Global model norm: 16.094871585614527.
Norm before scaling: 16.029321506202898. Distance: 1.180914487066894
Total norm for 5 adversaries is: 16.029321506202898. distance: 1.180914487066894
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.2758, Accuracy: 8275/8991 (92.0365%)
___Train Local_Simple,  epoch  38, local model 52, internal_epoch   1,  Average loss: 0.0203, Accuracy: 210/253 (83.0040%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.5987, Accuracy: 8573/10000 (85.7300%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 604/620 (97.4194%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   2,  Average loss: 0.0013, Accuracy: 602/620 (97.0968%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 612/620 (98.7097%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   4,  Average loss: 0.0003, Accuracy: 617/620 (99.5161%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   5,  Average loss: 0.0002, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Global model norm: 16.094871585614527.
Norm before scaling: 16.038346116185988. Distance: 1.3073443925212431
Total norm for 5 adversaries is: 16.038346116185988. distance: 1.3073443925212431
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.1251, Accuracy: 8656/8991 (96.2741%)
time spent on training: 104.28806924819946
[foolsgold agg] training data poison_ratio: 0.5523421588594705  data num: [257, 1002, 470, 303, 739, 433, 205, 628, 253, 620]
[foolsgold agg] considering poison per batch poison_fraction: 0.5523421588594705
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.5419, Accuracy: 8802/10000 (88.0200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.0855, Accuracy: 8777/8991 (97.6198%)
Done in 399.3038721084595 sec.
Server Epoch:39 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 896/923 (97.0748%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   2,  Average loss: 0.0009, Accuracy: 907/923 (98.2665%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   3,  Average loss: 0.0003, Accuracy: 920/923 (99.6750%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   4,  Average loss: 0.0002, Accuracy: 922/923 (99.8917%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   5,  Average loss: 0.0001, Accuracy: 922/923 (99.8917%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   6,  Average loss: 0.0001, Accuracy: 923/923 (100.0000%), train_poison_data_count: 923
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   7,  Average loss: 0.0001, Accuracy: 923/923 (100.0000%), train_poison_data_count: 923
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   8,  Average loss: 0.0001, Accuracy: 923/923 (100.0000%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 923/923 (100.0000%), train_poison_data_count: 923
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 923/923 (100.0000%), train_poison_data_count: 923
Global model norm: 16.09129228806686.
Norm before scaling: 16.060188572442787. Distance: 1.657073194232808
Total norm for 7 adversaries is: 16.060188572442787. distance: 1.657073194232808
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1345, Accuracy: 8631/8991 (95.9960%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   1,  Average loss: 0.0010, Accuracy: 405/413 (98.0630%), train_poison_data_count: 413
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   2,  Average loss: 0.0003, Accuracy: 412/413 (99.7579%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   3,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   4,  Average loss: 0.0001, Accuracy: 413/413 (100.0000%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   5,  Average loss: 0.0001, Accuracy: 413/413 (100.0000%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   6,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%), train_poison_data_count: 413
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   7,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%), train_poison_data_count: 413
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   8,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%), train_poison_data_count: 413
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   9,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%), train_poison_data_count: 413
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch  10,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%), train_poison_data_count: 413
Global model norm: 16.09129228806686.
Norm before scaling: 16.077754870010807. Distance: 0.9024454034791696
Total norm for 7 adversaries is: 16.077754870010807. distance: 0.9024454034791696
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.3094, Accuracy: 8380/8991 (93.2043%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   1,  Average loss: 0.0017, Accuracy: 947/977 (96.9294%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   2,  Average loss: 0.0011, Accuracy: 958/977 (98.0553%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   3,  Average loss: 0.0004, Accuracy: 973/977 (99.5906%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   4,  Average loss: 0.0003, Accuracy: 975/977 (99.7953%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   5,  Average loss: 0.0002, Accuracy: 976/977 (99.8976%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   6,  Average loss: 0.0002, Accuracy: 976/977 (99.8976%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   7,  Average loss: 0.0002, Accuracy: 976/977 (99.8976%), train_poison_data_count: 977
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   8,  Average loss: 0.0002, Accuracy: 976/977 (99.8976%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   9,  Average loss: 0.0002, Accuracy: 976/977 (99.8976%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch  10,  Average loss: 0.0002, Accuracy: 976/977 (99.8976%), train_poison_data_count: 977
Global model norm: 16.09129228806686.
Norm before scaling: 16.023833643323506. Distance: 1.5173492062603828
Total norm for 7 adversaries is: 16.023833643323506. distance: 1.5173492062603828
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1668, Accuracy: 8541/8991 (94.9950%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 420/434 (96.7742%), train_poison_data_count: 434
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   2,  Average loss: 0.0008, Accuracy: 429/434 (98.8479%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   3,  Average loss: 0.0004, Accuracy: 433/434 (99.7696%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   4,  Average loss: 0.0003, Accuracy: 433/434 (99.7696%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   5,  Average loss: 0.0002, Accuracy: 433/434 (99.7696%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   6,  Average loss: 0.0002, Accuracy: 433/434 (99.7696%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   7,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   8,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   9,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch  10,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Global model norm: 16.09129228806686.
Norm before scaling: 16.042886477905675. Distance: 1.1298427195512
Total norm for 7 adversaries is: 16.042886477905675. distance: 1.1298427195512
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.5435, Accuracy: 7778/8991 (86.5087%)
___Train Local_Simple,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0027, Accuracy: 569/591 (96.2775%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3038, Accuracy: 8840/10000 (88.4000%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0018, Accuracy: 368/376 (97.8723%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   2,  Average loss: 0.0014, Accuracy: 365/376 (97.0745%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   3,  Average loss: 0.0005, Accuracy: 373/376 (99.2021%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   4,  Average loss: 0.0002, Accuracy: 375/376 (99.7340%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Global model norm: 16.09129228806686.
Norm before scaling: 16.05290440219756. Distance: 0.8936114183771298
Total norm for 7 adversaries is: 16.05290440219756. distance: 0.8936114183771298
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1165, Accuracy: 8685/8991 (96.5966%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   1,  Average loss: 0.0012, Accuracy: 755/772 (97.7979%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   2,  Average loss: 0.0007, Accuracy: 759/772 (98.3161%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   3,  Average loss: 0.0002, Accuracy: 770/772 (99.7409%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   4,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 771/772 (99.8705%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   7,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   8,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch  10,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Global model norm: 16.09129228806686.
Norm before scaling: 16.061603209401294. Distance: 1.3842373850603995
Total norm for 7 adversaries is: 16.061603209401294. distance: 1.3842373850603995
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.2057, Accuracy: 8503/8991 (94.5724%)
___Train Local_Simple,  epoch  39, local model 88, internal_epoch   1,  Average loss: 0.0028, Accuracy: 510/530 (96.2264%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2826, Accuracy: 9027/10000 (90.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0054, Accuracy: 676/731 (92.4761%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.8541, Accuracy: 7020/10000 (70.2000%), Attack Success Rate:1/10000(0.010)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 713/734 (97.1390%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   2,  Average loss: 0.0006, Accuracy: 725/734 (98.7738%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   3,  Average loss: 0.0005, Accuracy: 727/734 (99.0463%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   4,  Average loss: 0.0002, Accuracy: 731/734 (99.5913%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 733/734 (99.8638%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   7,  Average loss: 0.0001, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   8,  Average loss: 0.0001, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   9,  Average loss: 0.0001, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch  10,  Average loss: 0.0001, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Global model norm: 16.09129228806686.
Norm before scaling: 16.09043977637857. Distance: 1.4028302042305585
Total norm for 7 adversaries is: 16.09043977637857. distance: 1.4028302042305585
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1661, Accuracy: 8534/8991 (94.9171%)
time spent on training: 117.29905200004578
[foolsgold agg] training data poison_ratio: 0.7142416293781824  data num: [923, 413, 977, 434, 591, 376, 772, 530, 731, 734]
[foolsgold agg] considering poison per batch poison_fraction: 0.7142416293781824
[foolsgold agg] wv: [1.         0.95621748 1.         1.         1.         1.
 1.         1.         1.         0.95621748]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.3977, Accuracy: 8814/10000 (88.1400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.0933, Accuracy: 8775/8991 (97.5976%)
Done in 281.18961000442505 sec.
Server Epoch:40 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1131/1160 (97.5000%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1138/1160 (98.1034%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1151/1160 (99.2241%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1160/1160 (100.0000%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1160/1160 (100.0000%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1160/1160 (100.0000%), train_poison_data_count: 1160
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1160/1160 (100.0000%), train_poison_data_count: 1160
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1160/1160 (100.0000%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1160/1160 (100.0000%), train_poison_data_count: 1160
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1160/1160 (100.0000%), train_poison_data_count: 1160
Global model norm: 16.115228575512532.
Norm before scaling: 16.119380947749573. Distance: 1.8756907144517503
Total norm for 3 adversaries is: 16.119380947749573. distance: 1.8756907144517503
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.3792, Accuracy: 8276/8991 (92.0476%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 289/293 (98.6348%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   2,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   3,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   4,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   5,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%), train_poison_data_count: 293
Global model norm: 16.115228575512532.
Norm before scaling: 16.090637972780748. Distance: 0.47241827593581065
Total norm for 3 adversaries is: 16.090637972780748. distance: 0.47241827593581065
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.1342, Accuracy: 8673/8991 (96.4631%)
___Train Local_Simple,  epoch  40, local model 87, internal_epoch   1,  Average loss: 0.0023, Accuracy: 453/470 (96.3830%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4317, Accuracy: 8598/10000 (85.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 98, internal_epoch   1,  Average loss: 0.0084, Accuracy: 710/818 (86.7971%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.1675, Accuracy: 7421/10000 (74.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 540/568 (95.0704%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5266, Accuracy: 8529/10000 (85.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 83, internal_epoch   1,  Average loss: 0.0027, Accuracy: 419/433 (96.7667%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1347, Accuracy: 9587/10000 (95.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0092, Accuracy: 219/253 (86.5613%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.7007, Accuracy: 8435/10000 (84.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 90, internal_epoch   1,  Average loss: 0.0028, Accuracy: 655/683 (95.9004%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6381, Accuracy: 7778/10000 (77.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 71, internal_epoch   1,  Average loss: 0.0018, Accuracy: 1336/1384 (96.5318%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.6899, Accuracy: 7922/10000 (79.2200%), Attack Success Rate:0/10000(0.000)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0020, Accuracy: 625/645 (96.8992%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   2,  Average loss: 0.0016, Accuracy: 627/645 (97.2093%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 640/645 (99.2248%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   4,  Average loss: 0.0004, Accuracy: 640/645 (99.2248%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 642/645 (99.5349%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   7,  Average loss: 0.0002, Accuracy: 643/645 (99.6899%), train_poison_data_count: 645
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   8,  Average loss: 0.0002, Accuracy: 644/645 (99.8450%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   9,  Average loss: 0.0002, Accuracy: 644/645 (99.8450%), train_poison_data_count: 645
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch  10,  Average loss: 0.0002, Accuracy: 644/645 (99.8450%), train_poison_data_count: 645
Global model norm: 16.115228575512532.
Norm before scaling: 16.074041709991025. Distance: 1.3959585627087014
Total norm for 3 adversaries is: 16.074041709991025. distance: 1.3959585627087014
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.1776, Accuracy: 8477/8991 (94.2832%)
time spent on training: 77.7851619720459
[foolsgold agg] training data poison_ratio: 0.31280751453705086  data num: [1160, 293, 470, 818, 568, 433, 253, 683, 1384, 645]
[foolsgold agg] considering poison per batch poison_fraction: 0.31280751453705086
[foolsgold agg] wv: [1. 1. 1. 0. 1. 1. 0. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.4234, Accuracy: 8816/10000 (88.1600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.0887, Accuracy: 8791/8991 (97.7756%)
Done in 237.59506130218506 sec.
Server Epoch:41 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
___Train Local_Simple,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0027, Accuracy: 542/568 (95.4225%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4615, Accuracy: 8481/10000 (84.8100%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 487/501 (97.2056%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   2,  Average loss: 0.0005, Accuracy: 494/501 (98.6028%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   3,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   4,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   5,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   6,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%), train_poison_data_count: 501
Global model norm: 16.125798641801822.
Norm before scaling: 16.084580025590018. Distance: 0.9429848758864124
Total norm for 6 adversaries is: 16.084580025590018. distance: 0.9429848758864124
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1048, Accuracy: 8709/8991 (96.8635%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   1,  Average loss: 0.0015, Accuracy: 421/429 (98.1352%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   2,  Average loss: 0.0007, Accuracy: 422/429 (98.3683%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   3,  Average loss: 0.0002, Accuracy: 427/429 (99.5338%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 428/429 (99.7669%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 429/429 (100.0000%), train_poison_data_count: 429
Global model norm: 16.125798641801822.
Norm before scaling: 16.102918542789165. Distance: 1.1366966743554157
Total norm for 6 adversaries is: 16.102918542789165. distance: 1.1366966743554157
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.3645, Accuracy: 8210/8991 (91.3135%)
___Train Local_Simple,  epoch  41, local model 95, internal_epoch   1,  Average loss: 0.0330, Accuracy: 413/602 (68.6047%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 4.9921, Accuracy: 2159/10000 (21.5900%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  41, local model 83, internal_epoch   1,  Average loss: 0.0024, Accuracy: 415/433 (95.8430%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1387, Accuracy: 9541/10000 (95.4100%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0019, Accuracy: 442/459 (96.2963%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   2,  Average loss: 0.0004, Accuracy: 455/459 (99.1285%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   3,  Average loss: 0.0005, Accuracy: 452/459 (98.4749%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   4,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Global model norm: 16.125798641801822.
Norm before scaling: 16.08184196132833. Distance: 1.0221883124333986
Total norm for 6 adversaries is: 16.08184196132833. distance: 1.0221883124333986
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1023, Accuracy: 8726/8991 (97.0526%)
___Train Local_Simple,  epoch  41, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 347/354 (98.0226%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.5092, Accuracy: 7635/10000 (76.3500%), Attack Success Rate:0/10000(0.000)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0008, Accuracy: 233/236 (98.7288%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 234/236 (99.1525%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   4,  Average loss: 0.0002, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   7,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%), train_poison_data_count: 236
Global model norm: 16.125798641801822.
Norm before scaling: 16.120634212465383. Distance: 0.5432856341742716
Total norm for 6 adversaries is: 16.120634212465383. distance: 0.5432856341742716
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1905, Accuracy: 8536/8991 (94.9394%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   1,  Average loss: 0.0013, Accuracy: 980/1002 (97.8044%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   2,  Average loss: 0.0005, Accuracy: 990/1002 (98.8024%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1001/1002 (99.9002%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Global model norm: 16.125798641801822.
Norm before scaling: 16.043627387106948. Distance: 1.47017284220559
Total norm for 6 adversaries is: 16.043627387106948. distance: 1.47017284220559
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1715, Accuracy: 8525/8991 (94.8170%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   1,  Average loss: 0.0016, Accuracy: 691/710 (97.3239%), train_poison_data_count: 710
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   2,  Average loss: 0.0010, Accuracy: 698/710 (98.3099%), train_poison_data_count: 710
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   3,  Average loss: 0.0006, Accuracy: 705/710 (99.2958%), train_poison_data_count: 710
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   4,  Average loss: 0.0003, Accuracy: 705/710 (99.2958%), train_poison_data_count: 710
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   5,  Average loss: 0.0002, Accuracy: 707/710 (99.5775%), train_poison_data_count: 710
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   6,  Average loss: 0.0002, Accuracy: 708/710 (99.7183%), train_poison_data_count: 710
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   7,  Average loss: 0.0001, Accuracy: 710/710 (100.0000%), train_poison_data_count: 710
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   8,  Average loss: 0.0001, Accuracy: 710/710 (100.0000%), train_poison_data_count: 710
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   9,  Average loss: 0.0001, Accuracy: 710/710 (100.0000%), train_poison_data_count: 710
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch  10,  Average loss: 0.0001, Accuracy: 710/710 (100.0000%), train_poison_data_count: 710
Global model norm: 16.125798641801822.
Norm before scaling: 16.077905770189044. Distance: 1.406760949452363
Total norm for 6 adversaries is: 16.077905770189044. distance: 1.406760949452363
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.3512, Accuracy: 8063/8991 (89.6786%)
time spent on training: 102.27108311653137
[foolsgold agg] training data poison_ratio: 0.6303362296939932  data num: [568, 501, 429, 602, 433, 459, 354, 236, 1002, 710]
[foolsgold agg] considering poison per batch poison_fraction: 0.6303362296939932
[foolsgold agg] wv: [1.         0.70735675 1.         1.         1.         0.70735675
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.2570, Accuracy: 8904/10000 (89.0400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.1054, Accuracy: 8702/8991 (96.7857%)
Done in 265.7571897506714 sec.
Server Epoch:42 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0018, Accuracy: 451/470 (95.9574%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5292, Accuracy: 8373/10000 (83.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0017, Accuracy: 573/591 (96.9543%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4418, Accuracy: 8675/10000 (86.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 89, internal_epoch   1,  Average loss: 0.0013, Accuracy: 481/492 (97.7642%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2695, Accuracy: 9089/10000 (90.8900%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0009, Accuracy: 440/448 (98.2143%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   2,  Average loss: 0.0005, Accuracy: 444/448 (99.1071%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   3,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Global model norm: 16.128349488604297.
Norm before scaling: 16.11659577652266. Distance: 0.7978645613135561
Total norm for 4 adversaries is: 16.11659577652266. distance: 0.7978645613135561
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1113, Accuracy: 8716/8991 (96.9414%)
___Train Local_Simple,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0020, Accuracy: 1177/1227 (95.9250%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6525, Accuracy: 8045/10000 (80.4500%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 870/892 (97.5336%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   2,  Average loss: 0.0004, Accuracy: 883/892 (98.9910%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   3,  Average loss: 0.0002, Accuracy: 891/892 (99.8879%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Global model norm: 16.128349488604297.
Norm before scaling: 16.082095294534852. Distance: 1.655273149428441
Total norm for 4 adversaries is: 16.082095294534852. distance: 1.655273149428441
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.8096, Accuracy: 7424/8991 (82.5715%)
___Train Local_Simple,  epoch  42, local model 92, internal_epoch   1,  Average loss: 0.0018, Accuracy: 906/937 (96.6916%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6040, Accuracy: 7810/10000 (78.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 62, internal_epoch   1,  Average loss: 0.0026, Accuracy: 398/423 (94.0898%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1771, Accuracy: 9398/10000 (93.9800%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 543/554 (98.0144%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 552/554 (99.6390%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 16.128349488604297.
Norm before scaling: 16.106407151142037. Distance: 0.9137565557242078
Total norm for 4 adversaries is: 16.106407151142037. distance: 0.9137565557242078
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1043, Accuracy: 8728/8991 (97.0749%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0013, Accuracy: 980/1002 (97.8044%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   2,  Average loss: 0.0005, Accuracy: 992/1002 (99.0020%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   3,  Average loss: 0.0004, Accuracy: 995/1002 (99.3014%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Global model norm: 16.128349488604297.
Norm before scaling: 16.057415940600563. Distance: 1.3809673261734172
Total norm for 4 adversaries is: 16.057415940600563. distance: 1.3809673261734172
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.2281, Accuracy: 8385/8991 (93.2599%)
time spent on training: 90.46134924888611
[foolsgold agg] training data poison_ratio: 0.4115974985787379  data num: [470, 591, 492, 448, 1227, 892, 937, 423, 554, 1002]
[foolsgold agg] considering poison per batch poison_fraction: 0.4115974985787379
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.2796, Accuracy: 8881/10000 (88.8100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.0958, Accuracy: 8741/8991 (97.2194%)
Done in 3520.3955211639404 sec.
Server Epoch:43 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   1,  Average loss: 0.0012, Accuracy: 872/895 (97.4302%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   2,  Average loss: 0.0004, Accuracy: 887/895 (99.1061%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   3,  Average loss: 0.0001, Accuracy: 894/895 (99.8883%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   4,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   5,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   6,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   7,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   8,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Global model norm: 16.141489986200448.
Norm before scaling: 16.103202814010032. Distance: 1.3090471535532362
Total norm for 5 adversaries is: 16.103202814010032. distance: 1.3090471535532362
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.2299, Accuracy: 8322/8991 (92.5592%)
___Train Local_Simple,  epoch  43, local model 78, internal_epoch   1,  Average loss: 0.0008, Accuracy: 296/303 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2112, Accuracy: 9344/10000 (93.4400%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 545/554 (98.3755%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   2,  Average loss: 0.0005, Accuracy: 547/554 (98.7365%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 16.141489986200448.
Norm before scaling: 16.11659767007244. Distance: 0.881826542226563
Total norm for 5 adversaries is: 16.11659767007244. distance: 0.881826542226563
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1017, Accuracy: 8747/8991 (97.2862%)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0020, Accuracy: 443/459 (96.5142%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   2,  Average loss: 0.0005, Accuracy: 456/459 (99.3464%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   3,  Average loss: 0.0003, Accuracy: 456/459 (99.3464%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   4,  Average loss: 0.0002, Accuracy: 458/459 (99.7821%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   5,  Average loss: 0.0002, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%), train_poison_data_count: 459
Global model norm: 16.141489986200448.
Norm before scaling: 16.104988870033605. Distance: 0.9868710977913242
Total norm for 5 adversaries is: 16.104988870033605. distance: 0.9868710977913242
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1134, Accuracy: 8688/8991 (96.6300%)
___Train Local_Simple,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0046, Accuracy: 674/731 (92.2025%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.9636, Accuracy: 7147/10000 (71.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 75, internal_epoch   1,  Average loss: 0.0023, Accuracy: 651/686 (94.8980%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1614, Accuracy: 9526/10000 (95.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0008, Accuracy: 610/623 (97.9133%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.5328, Accuracy: 8334/10000 (83.3400%), Attack Success Rate:0/10000(0.000)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 250/257 (97.2763%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 256/257 (99.6109%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Global model norm: 16.141489986200448.
Norm before scaling: 16.12176528541365. Distance: 0.6242780568925846
Total norm for 5 adversaries is: 16.12176528541365. distance: 0.6242780568925846
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1367, Accuracy: 8623/8991 (95.9070%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   1,  Average loss: 0.0022, Accuracy: 500/517 (96.7118%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 514/517 (99.4197%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   3,  Average loss: 0.0006, Accuracy: 516/517 (99.8066%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   4,  Average loss: 0.0003, Accuracy: 516/517 (99.8066%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   5,  Average loss: 0.0003, Accuracy: 516/517 (99.8066%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   6,  Average loss: 0.0003, Accuracy: 516/517 (99.8066%), train_poison_data_count: 517
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   7,  Average loss: 0.0002, Accuracy: 516/517 (99.8066%), train_poison_data_count: 517
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   8,  Average loss: 0.0002, Accuracy: 516/517 (99.8066%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   9,  Average loss: 0.0002, Accuracy: 516/517 (99.8066%), train_poison_data_count: 517
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch  10,  Average loss: 0.0002, Accuracy: 516/517 (99.8066%), train_poison_data_count: 517
Global model norm: 16.141489986200448.
Norm before scaling: 16.090695819117315. Distance: 1.1463526271524913
Total norm for 5 adversaries is: 16.090695819117315. distance: 1.1463526271524913
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1006, Accuracy: 8711/8991 (96.8858%)
___Train Local_Simple,  epoch  43, local model 90, internal_epoch   1,  Average loss: 0.0024, Accuracy: 657/683 (96.1933%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.0047, Accuracy: 7414/10000 (74.1400%), Attack Success Rate:0/10000(0.000)
time spent on training: 101.62070488929749
[foolsgold agg] training data poison_ratio: 0.4698668535388928  data num: [895, 303, 554, 459, 731, 686, 623, 257, 517, 683]
[foolsgold agg] considering poison per batch poison_fraction: 0.4698668535388928
[foolsgold agg] wv: [1. 1. 1. 1. 0. 1. 0. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.3423, Accuracy: 8849/10000 (88.4900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.0842, Accuracy: 8779/8991 (97.6421%)
Done in 273.3430347442627 sec.
Server Epoch:44 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   1,  Average loss: 0.0013, Accuracy: 819/835 (98.0838%), train_poison_data_count: 835
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   2,  Average loss: 0.0020, Accuracy: 805/835 (96.4072%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   3,  Average loss: 0.0014, Accuracy: 815/835 (97.6048%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   4,  Average loss: 0.0006, Accuracy: 826/835 (98.9222%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   5,  Average loss: 0.0006, Accuracy: 825/835 (98.8024%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   6,  Average loss: 0.0003, Accuracy: 831/835 (99.5210%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   7,  Average loss: 0.0002, Accuracy: 833/835 (99.7605%), train_poison_data_count: 835
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   8,  Average loss: 0.0002, Accuracy: 833/835 (99.7605%), train_poison_data_count: 835
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   9,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%), train_poison_data_count: 835
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch  10,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%), train_poison_data_count: 835
Global model norm: 16.156808160994295.
Norm before scaling: 16.391677866267514. Distance: 2.889923670463626
Total norm for 7 adversaries is: 16.391677866267514. distance: 2.889923670463626
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1864, Accuracy: 8500/8991 (94.5390%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0017, Accuracy: 736/760 (96.8421%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   2,  Average loss: 0.0007, Accuracy: 753/760 (99.0789%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   3,  Average loss: 0.0003, Accuracy: 758/760 (99.7368%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   4,  Average loss: 0.0002, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Global model norm: 16.156808160994295.
Norm before scaling: 16.13355022526331. Distance: 1.3734876812305028
Total norm for 7 adversaries is: 16.13355022526331. distance: 1.3734876812305028
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1634, Accuracy: 8538/8991 (94.9616%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0009, Accuracy: 880/895 (98.3240%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   2,  Average loss: 0.0004, Accuracy: 886/895 (98.9944%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   3,  Average loss: 0.0001, Accuracy: 893/895 (99.7765%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   4,  Average loss: 0.0001, Accuracy: 894/895 (99.8883%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   5,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   6,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   7,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   8,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   9,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch  10,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%), train_poison_data_count: 895
Global model norm: 16.156808160994295.
Norm before scaling: 16.106177885036946. Distance: 1.2144738520402276
Total norm for 7 adversaries is: 16.106177885036946. distance: 1.2144738520402276
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.2144, Accuracy: 8364/8991 (93.0264%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0015, Accuracy: 421/436 (96.5596%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   2,  Average loss: 0.0012, Accuracy: 427/436 (97.9358%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   3,  Average loss: 0.0009, Accuracy: 427/436 (97.9358%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   4,  Average loss: 0.0004, Accuracy: 433/436 (99.3119%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   5,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   6,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   7,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   8,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   9,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch  10,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Global model norm: 16.156808160994295.
Norm before scaling: 16.1496573302583. Distance: 0.9643415928095853
Total norm for 7 adversaries is: 16.1496573302583. distance: 0.9643415928095853
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1080, Accuracy: 8680/8991 (96.5410%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 603/615 (98.0488%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   2,  Average loss: 0.0008, Accuracy: 602/615 (97.8862%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   3,  Average loss: 0.0003, Accuracy: 614/615 (99.8374%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   4,  Average loss: 0.0002, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   5,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   6,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   8,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%), train_poison_data_count: 615
Global model norm: 16.156808160994295.
Norm before scaling: 16.12441991901133. Distance: 1.106776027293266
Total norm for 7 adversaries is: 16.12441991901133. distance: 1.106776027293266
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1636, Accuracy: 8537/8991 (94.9505%)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0012, Accuracy: 201/205 (98.0488%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   2,  Average loss: 0.0024, Accuracy: 200/205 (97.5610%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   3,  Average loss: 0.0030, Accuracy: 194/205 (94.6341%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   4,  Average loss: 0.0007, Accuracy: 201/205 (98.0488%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   5,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   6,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   7,  Average loss: 0.0001, Accuracy: 204/205 (99.5122%), train_poison_data_count: 205
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   8,  Average loss: 0.0002, Accuracy: 204/205 (99.5122%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   9,  Average loss: 0.0002, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch  10,  Average loss: 0.0002, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Global model norm: 16.156808160994295.
Norm before scaling: 16.149964399269003. Distance: 0.7252408383989698
Total norm for 7 adversaries is: 16.149964399269003. distance: 0.7252408383989698
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.2243, Accuracy: 8444/8991 (93.9161%)
___Train Local_Simple,  epoch  44, local model 65, internal_epoch   1,  Average loss: 0.0005, Accuracy: 365/371 (98.3827%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.5333, Accuracy: 8698/10000 (86.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 66, internal_epoch   1,  Average loss: 0.0021, Accuracy: 643/660 (97.4242%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6483, Accuracy: 8066/10000 (80.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0018, Accuracy: 570/591 (96.4467%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3847, Accuracy: 8646/10000 (86.4600%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0017, Accuracy: 393/401 (98.0050%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 399/401 (99.5012%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   3,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   6,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   7,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   8,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   9,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch  10,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%), train_poison_data_count: 401
Global model norm: 16.156808160994295.
Norm before scaling: 16.12917256152749. Distance: 1.0632309362880694
Total norm for 7 adversaries is: 16.12917256152749. distance: 1.0632309362880694
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.4341, Accuracy: 8083/8991 (89.9010%)
time spent on training: 114.98321580886841
[foolsgold agg] training data poison_ratio: 0.718842087016814  data num: [835, 760, 895, 436, 615, 205, 371, 660, 591, 401]
[foolsgold agg] considering poison per batch poison_fraction: 0.718842087016814
[foolsgold agg] wv: [0.95898732 0.9626734  1.         0.95898732 0.9626734  1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.4828, Accuracy: 8823/10000 (88.2300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.0767, Accuracy: 8794/8991 (97.8089%)
Done in 274.41760182380676 sec.
Server Epoch:45 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0020, Accuracy: 715/739 (96.7524%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.8032, Accuracy: 7863/10000 (78.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 75, internal_epoch   1,  Average loss: 0.0041, Accuracy: 627/686 (91.3994%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1943, Accuracy: 9408/10000 (94.0800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 737/760 (96.9737%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0007, Accuracy: 748/760 (98.4211%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   3,  Average loss: 0.0004, Accuracy: 756/760 (99.4737%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   4,  Average loss: 0.0002, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   5,  Average loss: 0.0002, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 759/760 (99.8684%), train_poison_data_count: 760
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 760/760 (100.0000%), train_poison_data_count: 760
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 760/760 (100.0000%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 760/760 (100.0000%), train_poison_data_count: 760
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 760/760 (100.0000%), train_poison_data_count: 760
Global model norm: 16.18736991682771.
Norm before scaling: 16.157745941382107. Distance: 1.374707060733488
Total norm for 5 adversaries is: 16.157745941382107. distance: 1.374707060733488
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1756, Accuracy: 8482/8991 (94.3388%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 844/860 (98.1395%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   2,  Average loss: 0.0006, Accuracy: 853/860 (99.1860%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   3,  Average loss: 0.0002, Accuracy: 859/860 (99.8837%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   4,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%), train_poison_data_count: 860
Global model norm: 16.18736991682771.
Norm before scaling: 16.114099884507688. Distance: 1.3084333179116407
Total norm for 5 adversaries is: 16.114099884507688. distance: 1.3084333179116407
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1935, Accuracy: 8440/8991 (93.8716%)
___Train Local_Simple,  epoch  45, local model 94, internal_epoch   1,  Average loss: 0.0029, Accuracy: 146/150 (97.3333%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.6077, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0025, Accuracy: 545/568 (95.9507%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2719, Accuracy: 9173/10000 (91.7300%), Attack Success Rate:0/10000(0.000)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   1,  Average loss: 0.0009, Accuracy: 983/1002 (98.1038%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   2,  Average loss: 0.0006, Accuracy: 993/1002 (99.1018%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   3,  Average loss: 0.0002, Accuracy: 999/1002 (99.7006%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Global model norm: 16.18736991682771.
Norm before scaling: 16.10683630578178. Distance: 1.3224056738835004
Total norm for 5 adversaries is: 16.10683630578178. distance: 1.3224056738835004
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1544, Accuracy: 8608/8991 (95.7402%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0009, Accuracy: 251/257 (97.6654%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 256/257 (99.6109%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   8,  Average loss: 0.0009, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Global model norm: 16.18736991682771.
Norm before scaling: 16.168863887850257. Distance: 0.5487026193275731
Total norm for 5 adversaries is: 16.168863887850257. distance: 0.5487026193275731
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1203, Accuracy: 8692/8991 (96.6745%)
___Train Local_Simple,  epoch  45, local model 60, internal_epoch   1,  Average loss: 0.0034, Accuracy: 327/338 (96.7456%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4193, Accuracy: 8578/10000 (85.7800%), Attack Success Rate:0/10000(0.000)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0024, Accuracy: 421/434 (97.0046%), train_poison_data_count: 434
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   2,  Average loss: 0.0011, Accuracy: 422/434 (97.2350%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   3,  Average loss: 0.0002, Accuracy: 433/434 (99.7696%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   4,  Average loss: 0.0002, Accuracy: 433/434 (99.7696%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   5,  Average loss: 0.0002, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   7,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   8,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   9,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch  10,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%), train_poison_data_count: 434
Global model norm: 16.18736991682771.
Norm before scaling: 16.138365418433995. Distance: 1.0316210570496347
Total norm for 5 adversaries is: 16.138365418433995. distance: 1.0316210570496347
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.2935, Accuracy: 8095/8991 (90.0345%)
time spent on training: 97.87724781036377
[foolsgold agg] training data poison_ratio: 0.5717984121505005  data num: [739, 686, 760, 860, 150, 568, 1002, 257, 338, 434]
[foolsgold agg] considering poison per batch poison_fraction: 0.5717984121505005
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.4674, Accuracy: 8827/10000 (88.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.0782, Accuracy: 8785/8991 (97.7088%)
Done in 256.8902130126953 sec.
Server Epoch:46 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
___Train Local_Simple,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 646/686 (94.1691%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2314, Accuracy: 9213/10000 (92.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 78, internal_epoch   1,  Average loss: 0.0012, Accuracy: 295/303 (97.3597%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2220, Accuracy: 9286/10000 (92.8600%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 368/376 (97.8723%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 375/376 (99.7340%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   3,  Average loss: 0.0002, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%), train_poison_data_count: 376
Global model norm: 16.203062846433347.
Norm before scaling: 16.17215805911699. Distance: 0.7966475068532356
Total norm for 6 adversaries is: 16.17215805911699. distance: 0.7966475068532356
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1183, Accuracy: 8687/8991 (96.6188%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 251/257 (97.6654%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%), train_poison_data_count: 257
Global model norm: 16.203062846433347.
Norm before scaling: 16.1852158514554. Distance: 0.5538481419567857
Total norm for 6 adversaries is: 16.1852158514554. distance: 0.5538481419567857
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1449, Accuracy: 8629/8991 (95.9738%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0015, Accuracy: 408/418 (97.6077%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 416/418 (99.5215%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   3,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   4,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   6,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   7,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Global model norm: 16.203062846433347.
Norm before scaling: 16.18277108773788. Distance: 0.8633501189366278
Total norm for 6 adversaries is: 16.18277108773788. distance: 0.8633501189366278
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1004, Accuracy: 8727/8991 (97.0637%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 868/892 (97.3094%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   2,  Average loss: 0.0005, Accuracy: 884/892 (99.1031%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   3,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Global model norm: 16.203062846433347.
Norm before scaling: 16.142920184102767. Distance: 1.4189546378683158
Total norm for 6 adversaries is: 16.142920184102767. distance: 1.4189546378683158
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.4471, Accuracy: 7767/8991 (86.3864%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   1,  Average loss: 0.0007, Accuracy: 761/772 (98.5751%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 769/772 (99.6114%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   3,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 772/772 (100.0000%), train_poison_data_count: 772
Global model norm: 16.203062846433347.
Norm before scaling: 16.149183015265724. Distance: 0.9500619730059889
Total norm for 6 adversaries is: 16.149183015265724. distance: 0.9500619730059889
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1024, Accuracy: 8723/8991 (97.0192%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0016, Accuracy: 538/548 (98.1752%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   2,  Average loss: 0.0007, Accuracy: 541/548 (98.7226%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   3,  Average loss: 0.0002, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   4,  Average loss: 0.0002, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   5,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   6,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   7,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   8,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   9,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch  10,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Global model norm: 16.203062846433347.
Norm before scaling: 16.142586514100966. Distance: 1.0759753482221093
Total norm for 6 adversaries is: 16.142586514100966. distance: 1.0759753482221093
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1319, Accuracy: 8598/8991 (95.6290%)
___Train Local_Simple,  epoch  46, local model 68, internal_epoch   1,  Average loss: 0.0054, Accuracy: 446/494 (90.2834%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3643, Accuracy: 8711/10000 (87.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 54, internal_epoch   1,  Average loss: 0.0026, Accuracy: 501/519 (96.5318%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.1598, Accuracy: 6562/10000 (65.6200%), Attack Success Rate:0/10000(0.000)
time spent on training: 102.56978106498718
[foolsgold agg] training data poison_ratio: 0.6197530864197531  data num: [686, 303, 376, 257, 418, 892, 772, 548, 494, 519]
[foolsgold agg] considering poison per batch poison_fraction: 0.6197530864197531
[foolsgold agg] wv: [0.55504903 1.         1.         1.         1.         1.
 1.         1.         0.55504903 1.        ]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.5215, Accuracy: 8812/10000 (88.1200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.0851, Accuracy: 8779/8991 (97.6421%)
Done in 263.9961199760437 sec.
Server Epoch:47 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  47, local model 94, internal_epoch   1,  Average loss: 0.0017, Accuracy: 147/150 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.7216, Accuracy: 8250/10000 (82.5000%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   1,  Average loss: 0.0009, Accuracy: 439/448 (97.9911%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 447/448 (99.7768%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   3,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%), train_poison_data_count: 448
Global model norm: 16.21572500842402.
Norm before scaling: 16.19618681310994. Distance: 0.7476069100262152
Total norm for 6 adversaries is: 16.19618681310994. distance: 0.7476069100262152
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0943, Accuracy: 8762/8991 (97.4530%)
___Train Local_Simple,  epoch  47, local model 82, internal_epoch   1,  Average loss: 0.0021, Accuracy: 688/713 (96.4937%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3321, Accuracy: 8794/10000 (87.9400%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 635/647 (98.1453%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   2,  Average loss: 0.0003, Accuracy: 642/647 (99.2272%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   3,  Average loss: 0.0001, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   4,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   8,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   9,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch  10,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Global model norm: 16.21572500842402.
Norm before scaling: 16.168692130924175. Distance: 0.9799590590741778
Total norm for 6 adversaries is: 16.168692130924175. distance: 0.9799590590741778
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.2029, Accuracy: 8471/8991 (94.2164%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0009, Accuracy: 546/554 (98.5560%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 550/554 (99.2780%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 16.21572500842402.
Norm before scaling: 16.188899741906972. Distance: 0.8945087613273216
Total norm for 6 adversaries is: 16.188899741906972. distance: 0.8945087613273216
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1097, Accuracy: 8729/8991 (97.0860%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0009, Accuracy: 898/915 (98.1421%), train_poison_data_count: 915
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   2,  Average loss: 0.0003, Accuracy: 911/915 (99.5628%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   3,  Average loss: 0.0002, Accuracy: 913/915 (99.7814%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   4,  Average loss: 0.0001, Accuracy: 915/915 (100.0000%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   5,  Average loss: 0.0001, Accuracy: 915/915 (100.0000%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   6,  Average loss: 0.0001, Accuracy: 915/915 (100.0000%), train_poison_data_count: 915
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   7,  Average loss: 0.0000, Accuracy: 915/915 (100.0000%), train_poison_data_count: 915
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   8,  Average loss: 0.0000, Accuracy: 915/915 (100.0000%), train_poison_data_count: 915
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   9,  Average loss: 0.0000, Accuracy: 915/915 (100.0000%), train_poison_data_count: 915
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch  10,  Average loss: 0.0000, Accuracy: 915/915 (100.0000%), train_poison_data_count: 915
Global model norm: 16.21572500842402.
Norm before scaling: 16.17346101069444. Distance: 1.1773776246319134
Total norm for 6 adversaries is: 16.17346101069444. distance: 1.1773776246319134
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0896, Accuracy: 8755/8991 (97.3752%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0010, Accuracy: 411/418 (98.3254%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 417/418 (99.7608%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   3,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   4,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Global model norm: 16.21572500842402.
Norm before scaling: 16.197055426594908. Distance: 0.805033637108171
Total norm for 6 adversaries is: 16.197055426594908. distance: 0.805033637108171
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1080, Accuracy: 8704/8991 (96.8079%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0023, Accuracy: 660/683 (96.6325%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4876, Accuracy: 8374/10000 (83.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 68, internal_epoch   1,  Average loss: 0.0053, Accuracy: 441/494 (89.2713%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4292, Accuracy: 8572/10000 (85.7200%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 403/408 (98.7745%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   2,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   3,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   4,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   5,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   6,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   7,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%), train_poison_data_count: 408
Global model norm: 16.21572500842402.
Norm before scaling: 16.200143243603783. Distance: 0.6102023010850053
Total norm for 6 adversaries is: 16.200143243603783. distance: 0.6102023010850053
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1345, Accuracy: 8656/8991 (96.2741%)
time spent on training: 104.34916925430298
[foolsgold agg] training data poison_ratio: 0.6243093922651933  data num: [150, 448, 713, 647, 554, 915, 418, 683, 494, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.6243093922651933
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.5361, Accuracy: 8817/10000 (88.1700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.0795, Accuracy: 8789/8991 (97.7533%)
Done in 263.2294132709503 sec.
Server Epoch:48 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
___Train Local_Simple,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0092, Accuracy: 491/557 (88.1508%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.8766, Accuracy: 7796/10000 (77.9600%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   1,  Average loss: 0.0018, Accuracy: 459/471 (97.4522%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   2,  Average loss: 0.0011, Accuracy: 461/471 (97.8769%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   3,  Average loss: 0.0002, Accuracy: 470/471 (99.7877%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   4,  Average loss: 0.0002, Accuracy: 470/471 (99.7877%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   5,  Average loss: 0.0002, Accuracy: 470/471 (99.7877%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 470/471 (99.7877%), train_poison_data_count: 471
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 471/471 (100.0000%), train_poison_data_count: 471
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 471/471 (100.0000%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 471/471 (100.0000%), train_poison_data_count: 471
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 471/471 (100.0000%), train_poison_data_count: 471
Global model norm: 16.226822036922965.
Norm before scaling: 16.193712610917856. Distance: 1.090294912059185
Total norm for 3 adversaries is: 16.193712610917856. distance: 1.090294912059185
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.1202, Accuracy: 8646/8991 (96.1628%)
___Train Local_Simple,  epoch  48, local model 75, internal_epoch   1,  Average loss: 0.0027, Accuracy: 648/686 (94.4606%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4627, Accuracy: 8524/10000 (85.2400%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0015, Accuracy: 201/205 (98.0488%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   2,  Average loss: 0.0003, Accuracy: 203/205 (99.0244%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   3,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   4,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   5,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   6,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   7,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   8,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   9,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch  10,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%), train_poison_data_count: 205
Global model norm: 16.226822036922965.
Norm before scaling: 16.212332394806353. Distance: 0.6412801184097031
Total norm for 3 adversaries is: 16.212332394806353. distance: 0.6412801184097031
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.2376, Accuracy: 8454/8991 (94.0274%)
___Train Local_Simple,  epoch  48, local model 58, internal_epoch   1,  Average loss: 0.0023, Accuracy: 268/276 (97.1014%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4986, Accuracy: 8692/10000 (86.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0024, Accuracy: 420/433 (96.9977%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1817, Accuracy: 9292/10000 (92.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0079, Accuracy: 228/256 (89.0625%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2595, Accuracy: 9092/10000 (90.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 96, internal_epoch   1,  Average loss: 0.0015, Accuracy: 654/672 (97.3214%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2581, Accuracy: 8994/10000 (89.9400%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0020, Accuracy: 602/620 (97.0968%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 609/620 (98.2258%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   3,  Average loss: 0.0002, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   4,  Average loss: 0.0002, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Global model norm: 16.226822036922965.
Norm before scaling: 16.173059097652857. Distance: 1.2094798020485567
Total norm for 3 adversaries is: 16.173059097652857. distance: 1.2094798020485567
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.1116, Accuracy: 8659/8991 (96.3074%)
___Train Local_Simple,  epoch  48, local model 57, internal_epoch   1,  Average loss: 0.0100, Accuracy: 288/343 (83.9650%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3488, Accuracy: 8968/10000 (89.6800%), Attack Success Rate:0/10000(0.000)
time spent on training: 67.76395797729492
[foolsgold agg] training data poison_ratio: 0.28678911263553886  data num: [557, 471, 686, 205, 276, 433, 256, 672, 620, 343]
[foolsgold agg] considering poison per batch poison_fraction: 0.28678911263553886
[foolsgold agg] wv: [0.         1.         0.43869729 1.         1.         1.
 0.         1.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.5215, Accuracy: 8830/10000 (88.3000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.0776, Accuracy: 8798/8991 (97.8534%)
Done in 228.41029381752014 sec.
Server Epoch:49 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
___Train Local_Simple,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0057, Accuracy: 537/589 (91.1715%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2769, Accuracy: 9111/10000 (91.1100%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0009, Accuracy: 876/892 (98.2063%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   2,  Average loss: 0.0003, Accuracy: 888/892 (99.5516%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   3,  Average loss: 0.0002, Accuracy: 889/892 (99.6637%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   5,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   6,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   7,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%), train_poison_data_count: 892
Global model norm: 16.230739975922713.
Norm before scaling: 16.149918103084243. Distance: 1.191940137966554
Total norm for 3 adversaries is: 16.149918103084243. distance: 1.191940137966554
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.6032, Accuracy: 7724/8991 (85.9081%)
___Train Local_Simple,  epoch  49, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 297/303 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2241, Accuracy: 9295/10000 (92.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0064, Accuracy: 668/731 (91.3817%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.2788, Accuracy: 6492/10000 (64.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 91, internal_epoch   1,  Average loss: 0.0082, Accuracy: 231/256 (90.2344%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2193, Accuracy: 9181/10000 (91.8100%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   2,  Average loss: 0.0003, Accuracy: 730/734 (99.4550%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   3,  Average loss: 0.0002, Accuracy: 730/734 (99.4550%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   4,  Average loss: 0.0001, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   5,  Average loss: 0.0000, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   6,  Average loss: 0.0000, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   7,  Average loss: 0.0000, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   8,  Average loss: 0.0000, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   9,  Average loss: 0.0000, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch  10,  Average loss: 0.0000, Accuracy: 734/734 (100.0000%), train_poison_data_count: 734
Global model norm: 16.230739975922713.
Norm before scaling: 16.180752205733803. Distance: 0.8442163591423402
Total norm for 3 adversaries is: 16.180752205733803. distance: 0.8442163591423402
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.1448, Accuracy: 8624/8991 (95.9181%)
___Train Local_Simple,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0057, Accuracy: 736/818 (89.9756%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6201, Accuracy: 8013/10000 (80.1300%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 306/312 (98.0769%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   2,  Average loss: 0.0004, Accuracy: 311/312 (99.6795%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   3,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   4,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   5,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   6,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   7,  Average loss: 0.0000, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   8,  Average loss: 0.0000, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   9,  Average loss: 0.0000, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch  10,  Average loss: 0.0000, Accuracy: 312/312 (100.0000%), train_poison_data_count: 312
Global model norm: 16.230739975922713.
Norm before scaling: 16.21103915630777. Distance: 0.6208215272877515
Total norm for 3 adversaries is: 16.21103915630777. distance: 0.6208215272877515
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.1431, Accuracy: 8615/8991 (95.8180%)
___Train Local_Simple,  epoch  49, local model 82, internal_epoch   1,  Average loss: 0.0019, Accuracy: 692/713 (97.0547%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6999, Accuracy: 7756/10000 (77.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0091, Accuracy: 480/557 (86.1759%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.0855, Accuracy: 7009/10000 (70.0900%), Attack Success Rate:0/10000(0.000)
time spent on training: 75.98114609718323
[foolsgold agg] training data poison_ratio: 0.32819644369178663  data num: [589, 892, 303, 731, 256, 734, 818, 312, 713, 557]
[foolsgold agg] considering poison per batch poison_fraction: 0.32819644369178663
[foolsgold agg] wv: [0. 1. 1. 0. 0. 1. 0. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.5492, Accuracy: 8823/10000 (88.2300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.0773, Accuracy: 8796/8991 (97.8312%)
Done in 236.56658387184143 sec.
Server Epoch:50 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
___Train Local_Simple,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0037, Accuracy: 635/686 (92.5656%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2966, Accuracy: 9004/10000 (90.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 86, internal_epoch   1,  Average loss: 0.0084, Accuracy: 222/250 (88.8000%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.8287, Accuracy: 8493/10000 (84.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0012, Accuracy: 554/568 (97.5352%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6017, Accuracy: 8359/10000 (83.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0037, Accuracy: 407/435 (93.5632%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.0287, Accuracy: 8527/10000 (85.2700%), Attack Success Rate:0/10000(0.000)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 822/835 (98.4431%), train_poison_data_count: 835
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   2,  Average loss: 0.0007, Accuracy: 828/835 (99.1617%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   3,  Average loss: 0.0022, Accuracy: 800/835 (95.8084%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   4,  Average loss: 0.0005, Accuracy: 830/835 (99.4012%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   5,  Average loss: 0.0002, Accuracy: 833/835 (99.7605%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   6,  Average loss: 0.0003, Accuracy: 830/835 (99.4012%), train_poison_data_count: 835
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   7,  Average loss: 0.0001, Accuracy: 834/835 (99.8802%), train_poison_data_count: 835
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   8,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%), train_poison_data_count: 835
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   9,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%), train_poison_data_count: 835
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch  10,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%), train_poison_data_count: 835
Global model norm: 16.23483930700328.
Norm before scaling: 16.22226919460609. Distance: 1.2744408615626959
Total norm for 5 adversaries is: 16.22226919460609. distance: 1.2744408615626959
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.1386, Accuracy: 8655/8991 (96.2629%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   1,  Average loss: 0.0019, Accuracy: 950/977 (97.2364%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   2,  Average loss: 0.0011, Accuracy: 953/977 (97.5435%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   3,  Average loss: 0.0006, Accuracy: 968/977 (99.0788%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   4,  Average loss: 0.0004, Accuracy: 971/977 (99.3859%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   5,  Average loss: 0.0003, Accuracy: 973/977 (99.5906%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   6,  Average loss: 0.0003, Accuracy: 972/977 (99.4882%), train_poison_data_count: 977
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   7,  Average loss: 0.0002, Accuracy: 973/977 (99.5906%), train_poison_data_count: 977
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   8,  Average loss: 0.0002, Accuracy: 974/977 (99.6929%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   9,  Average loss: 0.0002, Accuracy: 976/977 (99.8976%), train_poison_data_count: 977
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch  10,  Average loss: 0.0002, Accuracy: 976/977 (99.8976%), train_poison_data_count: 977
Global model norm: 16.23483930700328.
Norm before scaling: 16.224671328467547. Distance: 1.8202641689449566
Total norm for 5 adversaries is: 16.224671328467547. distance: 1.8202641689449566
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.1918, Accuracy: 8501/8991 (94.5501%)
___Train Local_Simple,  epoch  50, local model 67, internal_epoch   1,  Average loss: 0.0032, Accuracy: 951/998 (95.2906%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6360, Accuracy: 8222/10000 (82.2200%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 601/620 (96.9355%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 610/620 (98.3871%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   3,  Average loss: 0.0003, Accuracy: 615/620 (99.1935%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   4,  Average loss: 0.0002, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Global model norm: 16.23483930700328.
Norm before scaling: 16.197043179656955. Distance: 1.1944633908703592
Total norm for 5 adversaries is: 16.197043179656955. distance: 1.1944633908703592
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.1107, Accuracy: 8684/8991 (96.5855%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0010, Accuracy: 988/1002 (98.6028%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   2,  Average loss: 0.0002, Accuracy: 996/1002 (99.4012%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   3,  Average loss: 0.0002, Accuracy: 999/1002 (99.7006%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%), train_poison_data_count: 1002
Global model norm: 16.23483930700328.
Norm before scaling: 16.13246348744754. Distance: 1.1759578534183772
Total norm for 5 adversaries is: 16.13246348744754. distance: 1.1759578534183772
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.1514, Accuracy: 8584/8991 (95.4733%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 410/418 (98.0861%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   2,  Average loss: 0.0004, Accuracy: 415/418 (99.2823%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   3,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   4,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   6,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 418/418 (100.0000%), train_poison_data_count: 418
Global model norm: 16.23483930700328.
Norm before scaling: 16.218071660609713. Distance: 0.8420123114467322
Total norm for 5 adversaries is: 16.218071660609713. distance: 0.8420123114467322
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0907, Accuracy: 8749/8991 (97.3084%)
time spent on training: 104.45313310623169
[foolsgold agg] training data poison_ratio: 0.5673884224480777  data num: [686, 250, 568, 435, 835, 977, 998, 620, 1002, 418]
[foolsgold agg] considering poison per batch poison_fraction: 0.5673884224480777
[foolsgold agg] wv: [0.95969602 0.         1.         0.         1.         1.
 0.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.6520, Accuracy: 8803/10000 (88.0300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.0852, Accuracy: 8777/8991 (97.6198%)
Done in 265.11275601387024 sec.
Saving all the graphs.
This run has a label: Mar.03_15.55.20. Visdom environment: mnist_DBA
