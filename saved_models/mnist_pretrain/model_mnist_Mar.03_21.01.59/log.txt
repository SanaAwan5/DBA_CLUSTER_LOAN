current path: saved_models/mnist_pretrain/model_mnist_Mar.03_21.01.59
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   1,  Average loss: 0.0376, Accuracy: 115/588 (19.5578%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   2,  Average loss: 0.0325, Accuracy: 177/588 (30.1020%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   3,  Average loss: 0.0220, Accuracy: 353/588 (60.0340%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   4,  Average loss: 0.0155, Accuracy: 466/588 (79.2517%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   5,  Average loss: 0.0123, Accuracy: 471/588 (80.1020%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   6,  Average loss: 0.0115, Accuracy: 481/588 (81.8027%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   7,  Average loss: 0.0095, Accuracy: 499/588 (84.8639%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   8,  Average loss: 0.0086, Accuracy: 509/588 (86.5646%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   9,  Average loss: 0.0072, Accuracy: 516/588 (87.7551%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch  10,  Average loss: 0.0077, Accuracy: 517/588 (87.9252%), train_poison_data_count: 588
Global model norm: 13.89800383141575.
Norm before scaling: 14.290957300730033. Distance: 2.845655368883342
Total norm for 7 adversaries is: 14.290957300730033. distance: 2.845655368883342
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4173, Accuracy: 7898/8991 (87.8434%)
___Train Local_Simple,  epoch   1, local model 72, internal_epoch   1,  Average loss: 0.0385, Accuracy: 89/529 (16.8242%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.2009, Accuracy: 1939/10000 (19.3900%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   1, local model 61, internal_epoch   1,  Average loss: 0.0378, Accuracy: 85/537 (15.8287%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.2137, Accuracy: 1950/10000 (19.5000%), Attack Success Rate:8/10000(0.080)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0358, Accuracy: 143/644 (22.2050%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   2,  Average loss: 0.0299, Accuracy: 249/644 (38.6646%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   3,  Average loss: 0.0182, Accuracy: 439/644 (68.1677%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   4,  Average loss: 0.0155, Accuracy: 480/644 (74.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   5,  Average loss: 0.0098, Accuracy: 546/644 (84.7826%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   6,  Average loss: 0.0089, Accuracy: 553/644 (85.8696%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   7,  Average loss: 0.0081, Accuracy: 551/644 (85.5590%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   8,  Average loss: 0.0081, Accuracy: 542/644 (84.1615%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   9,  Average loss: 0.0057, Accuracy: 571/644 (88.6646%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch  10,  Average loss: 0.0056, Accuracy: 581/644 (90.2174%), train_poison_data_count: 644
Global model norm: 13.89800383141575.
Norm before scaling: 14.321404098636604. Distance: 3.0440920909731353
Total norm for 7 adversaries is: 14.321404098636604. distance: 3.0440920909731353
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5697, Accuracy: 7304/8991 (81.2368%)
___Train Local_Simple,  epoch   1, local model 71, internal_epoch   1,  Average loss: 0.0353, Accuracy: 118/638 (18.4953%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1425, Accuracy: 2385/10000 (23.8500%), Attack Success Rate:6/10000(0.060)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   1,  Average loss: 0.0359, Accuracy: 166/665 (24.9624%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   2,  Average loss: 0.0275, Accuracy: 282/665 (42.4060%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   3,  Average loss: 0.0132, Accuracy: 489/665 (73.5338%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   4,  Average loss: 0.0109, Accuracy: 526/665 (79.0977%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   5,  Average loss: 0.0088, Accuracy: 558/665 (83.9098%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   6,  Average loss: 0.0073, Accuracy: 582/665 (87.5188%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   7,  Average loss: 0.0063, Accuracy: 584/665 (87.8195%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   8,  Average loss: 0.0065, Accuracy: 588/665 (88.4211%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   9,  Average loss: 0.0054, Accuracy: 609/665 (91.5789%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch  10,  Average loss: 0.0048, Accuracy: 612/665 (92.0301%), train_poison_data_count: 665
Global model norm: 13.89800383141575.
Norm before scaling: 14.341986653764458. Distance: 3.070606634984612
Total norm for 7 adversaries is: 14.341986653764458. distance: 3.070606634984612
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4108, Accuracy: 7852/8991 (87.3318%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   1,  Average loss: 0.0341, Accuracy: 189/750 (25.2000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   2,  Average loss: 0.0230, Accuracy: 395/750 (52.6667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   3,  Average loss: 0.0110, Accuracy: 599/750 (79.8667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   4,  Average loss: 0.0091, Accuracy: 627/750 (83.6000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   5,  Average loss: 0.0079, Accuracy: 648/750 (86.4000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   6,  Average loss: 0.0068, Accuracy: 660/750 (88.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   7,  Average loss: 0.0060, Accuracy: 672/750 (89.6000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   8,  Average loss: 0.0060, Accuracy: 657/750 (87.6000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   9,  Average loss: 0.0056, Accuracy: 680/750 (90.6667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch  10,  Average loss: 0.0050, Accuracy: 685/750 (91.3333%), train_poison_data_count: 750
Global model norm: 13.89800383141575.
Norm before scaling: 14.369969292105488. Distance: 3.2454151679132797
Total norm for 7 adversaries is: 14.369969292105488. distance: 3.2454151679132797
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4294, Accuracy: 7829/8991 (87.0760%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   1,  Average loss: 0.0367, Accuracy: 122/641 (19.0328%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   2,  Average loss: 0.0398, Accuracy: 133/641 (20.7488%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   3,  Average loss: 0.0371, Accuracy: 168/641 (26.2090%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   4,  Average loss: 0.0365, Accuracy: 198/641 (30.8892%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   5,  Average loss: 0.0356, Accuracy: 154/641 (24.0250%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   6,  Average loss: 0.0339, Accuracy: 253/641 (39.4696%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   7,  Average loss: 0.0319, Accuracy: 223/641 (34.7894%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   8,  Average loss: 0.0260, Accuracy: 311/641 (48.5179%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   9,  Average loss: 0.0250, Accuracy: 361/641 (56.3183%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch  10,  Average loss: 0.0242, Accuracy: 364/641 (56.7863%), train_poison_data_count: 641
Global model norm: 13.89800383141575.
Norm before scaling: 14.19771796143662. Distance: 3.20908289158537
Total norm for 7 adversaries is: 14.19771796143662. distance: 3.20908289158537
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 1.6138, Accuracy: 4000/8991 (44.4889%)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   1,  Average loss: 0.0349, Accuracy: 138/625 (22.0800%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   2,  Average loss: 0.0282, Accuracy: 240/625 (38.4000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   3,  Average loss: 0.0150, Accuracy: 457/625 (73.1200%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   4,  Average loss: 0.0116, Accuracy: 506/625 (80.9600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   5,  Average loss: 0.0094, Accuracy: 528/625 (84.4800%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   6,  Average loss: 0.0080, Accuracy: 551/625 (88.1600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   7,  Average loss: 0.0073, Accuracy: 551/625 (88.1600%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   8,  Average loss: 0.0065, Accuracy: 556/625 (88.9600%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   9,  Average loss: 0.0061, Accuracy: 555/625 (88.8000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch  10,  Average loss: 0.0056, Accuracy: 569/625 (91.0400%), train_poison_data_count: 625
Global model norm: 13.89800383141575.
Norm before scaling: 14.303629829310646. Distance: 2.890334985979438
Total norm for 7 adversaries is: 14.303629829310646. distance: 2.890334985979438
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4282, Accuracy: 7837/8991 (87.1649%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   1,  Average loss: 0.0356, Accuracy: 125/493 (25.3550%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   2,  Average loss: 0.0316, Accuracy: 163/493 (33.0629%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   3,  Average loss: 0.0251, Accuracy: 236/493 (47.8702%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   4,  Average loss: 0.0217, Accuracy: 307/493 (62.2718%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   5,  Average loss: 0.0169, Accuracy: 356/493 (72.2110%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   6,  Average loss: 0.0133, Accuracy: 379/493 (76.8763%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   7,  Average loss: 0.0109, Accuracy: 387/493 (78.4990%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   8,  Average loss: 0.0097, Accuracy: 395/493 (80.1217%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   9,  Average loss: 0.0080, Accuracy: 429/493 (87.0183%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch  10,  Average loss: 0.0076, Accuracy: 427/493 (86.6126%), train_poison_data_count: 493
Global model norm: 13.89800383141575.
Norm before scaling: 14.22591251604137. Distance: 2.5350732069712247
Total norm for 7 adversaries is: 14.22591251604137. distance: 2.5350732069712247
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.6442, Accuracy: 6991/8991 (77.7555%)
time spent on training: 112.32451009750366
[foolsgold agg] training data poison_ratio: 0.7211129296235679  data num: [588, 529, 537, 644, 638, 665, 750, 641, 625, 493]
[foolsgold agg] considering poison per batch poison_fraction: 0.7211129296235679
[foolsgold agg] wv: [0.36062068 1.         0.31464338 1.         0.31464338 0.10863229
 0.96630257 1.         0.36062068 0.10863229]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.1007, Accuracy: 1901/10000 (19.0100%), Attack Success Rate:13/10000(0.130)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.0233, Accuracy: 1982/8991 (22.0443%)
Done in 274.91419291496277 sec.
Server Epoch:2 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0233, Accuracy: 335/644 (52.0186%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   2,  Average loss: 0.0078, Accuracy: 549/644 (85.2484%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   3,  Average loss: 0.0051, Accuracy: 584/644 (90.6832%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   4,  Average loss: 0.0039, Accuracy: 593/644 (92.0807%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   5,  Average loss: 0.0035, Accuracy: 602/644 (93.4783%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   6,  Average loss: 0.0029, Accuracy: 605/644 (93.9441%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   7,  Average loss: 0.0026, Accuracy: 611/644 (94.8758%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   8,  Average loss: 0.0050, Accuracy: 613/644 (95.1863%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   9,  Average loss: 0.0024, Accuracy: 614/644 (95.3416%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch  10,  Average loss: 0.0023, Accuracy: 615/644 (95.4969%), train_poison_data_count: 644
Global model norm: 14.029643691113804.
Norm before scaling: 14.914271213835551. Distance: 4.102768144974319
Total norm for 4 adversaries is: 14.914271213835551. distance: 4.102768144974319
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.4326, Accuracy: 7821/8991 (86.9870%)
___Train Local_Simple,  epoch   2, local model 59, internal_epoch   1,  Average loss: 0.0282, Accuracy: 340/652 (52.1472%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.2456, Accuracy: 5468/10000 (54.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 62, internal_epoch   1,  Average loss: 0.0316, Accuracy: 260/617 (42.1394%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.5767, Accuracy: 6337/10000 (63.3700%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   1,  Average loss: 0.0222, Accuracy: 362/665 (54.4361%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   2,  Average loss: 0.0109, Accuracy: 531/665 (79.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   3,  Average loss: 0.0055, Accuracy: 598/665 (89.9248%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   4,  Average loss: 0.0043, Accuracy: 613/665 (92.1805%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   5,  Average loss: 0.0034, Accuracy: 624/665 (93.8346%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   6,  Average loss: 0.0032, Accuracy: 629/665 (94.5865%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   7,  Average loss: 0.0026, Accuracy: 632/665 (95.0376%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   8,  Average loss: 0.0024, Accuracy: 633/665 (95.1880%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   9,  Average loss: 0.0021, Accuracy: 641/665 (96.3910%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch  10,  Average loss: 0.0022, Accuracy: 641/665 (96.3910%), train_poison_data_count: 665
Global model norm: 14.029643691113804.
Norm before scaling: 15.033935814490453. Distance: 4.320293516148391
Total norm for 4 adversaries is: 15.033935814490453. distance: 4.320293516148391
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.2560, Accuracy: 8289/8991 (92.1922%)
___Train Local_Simple,  epoch   2, local model 65, internal_epoch   1,  Average loss: 0.0301, Accuracy: 245/573 (42.7574%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.8414, Accuracy: 5029/10000 (50.2900%), Attack Success Rate:0/10000(0.000)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   1,  Average loss: 0.0251, Accuracy: 279/531 (52.5424%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   2,  Average loss: 0.0203, Accuracy: 361/531 (67.9849%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   3,  Average loss: 0.0108, Accuracy: 423/531 (79.6610%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   4,  Average loss: 0.0077, Accuracy: 465/531 (87.5706%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   5,  Average loss: 0.0058, Accuracy: 470/531 (88.5122%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   6,  Average loss: 0.0046, Accuracy: 480/531 (90.3955%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   7,  Average loss: 0.0039, Accuracy: 487/531 (91.7137%), train_poison_data_count: 531
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   8,  Average loss: 0.0036, Accuracy: 499/531 (93.9736%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   9,  Average loss: 0.0030, Accuracy: 497/531 (93.5970%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch  10,  Average loss: 0.0032, Accuracy: 499/531 (93.9736%), train_poison_data_count: 531
Global model norm: 14.029643691113804.
Norm before scaling: 15.028863729341523. Distance: 4.403642897677294
Total norm for 4 adversaries is: 15.028863729341523. distance: 4.403642897677294
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.2805, Accuracy: 8264/8991 (91.9141%)
___Train Local_Simple,  epoch   2, local model 78, internal_epoch   1,  Average loss: 0.0280, Accuracy: 300/624 (48.0769%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.3444, Accuracy: 6653/10000 (66.5300%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   2, local model 58, internal_epoch   1,  Average loss: 0.0278, Accuracy: 243/510 (47.6471%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.7042, Accuracy: 5109/10000 (51.0900%), Attack Success Rate:1/10000(0.010)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   1,  Average loss: 0.0237, Accuracy: 349/652 (53.5276%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   2,  Average loss: 0.0123, Accuracy: 527/652 (80.8282%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   3,  Average loss: 0.0057, Accuracy: 573/652 (87.8834%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   4,  Average loss: 0.0043, Accuracy: 601/652 (92.1779%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   5,  Average loss: 0.0034, Accuracy: 613/652 (94.0184%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   6,  Average loss: 0.0029, Accuracy: 624/652 (95.7055%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   7,  Average loss: 0.0028, Accuracy: 625/652 (95.8589%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   8,  Average loss: 0.0021, Accuracy: 634/652 (97.2393%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   9,  Average loss: 0.0019, Accuracy: 636/652 (97.5460%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch  10,  Average loss: 0.0019, Accuracy: 638/652 (97.8528%), train_poison_data_count: 652
Global model norm: 14.029643691113804.
Norm before scaling: 15.233018769759452. Distance: 4.9771787540341945
Total norm for 4 adversaries is: 15.233018769759452. distance: 4.9771787540341945
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.2862, Accuracy: 8221/8991 (91.4359%)
___Train Local_Simple,  epoch   2, local model 81, internal_epoch   1,  Average loss: 0.0311, Accuracy: 273/586 (46.5870%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.5787, Accuracy: 4151/10000 (41.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 82.16159296035767
[foolsgold agg] training data poison_ratio: 0.4116286752560291  data num: [644, 652, 617, 665, 573, 531, 624, 510, 652, 586]
[foolsgold agg] considering poison per batch poison_fraction: 0.4116286752560291
[foolsgold agg] wv: [0.89743125 1.         1.         0.89743125 1.         0.7309689
 0.64258843 0.64258843 0.7309689  1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 1.8153, Accuracy: 5673/10000 (56.7300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 1.7358, Accuracy: 5704/8991 (63.4412%)
Done in 239.7602138519287 sec.
Server Epoch:3 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
___Train Local_Simple,  epoch   3, local model 54, internal_epoch   1,  Average loss: 0.0253, Accuracy: 314/523 (60.0382%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.2314, Accuracy: 6129/10000 (61.2900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   3, local model 55, internal_epoch   1,  Average loss: 0.0244, Accuracy: 367/592 (61.9932%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.2173, Accuracy: 6242/10000 (62.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 61, internal_epoch   1,  Average loss: 0.0278, Accuracy: 303/537 (56.4246%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.2156, Accuracy: 6207/10000 (62.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 73, internal_epoch   1,  Average loss: 0.0287, Accuracy: 345/626 (55.1118%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.6498, Accuracy: 4769/10000 (47.6900%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   1,  Average loss: 0.0254, Accuracy: 356/516 (68.9922%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   2,  Average loss: 0.0402, Accuracy: 239/516 (46.3178%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   3,  Average loss: 0.0294, Accuracy: 225/516 (43.6047%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   4,  Average loss: 0.0250, Accuracy: 289/516 (56.0078%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   5,  Average loss: 0.0216, Accuracy: 329/516 (63.7597%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   6,  Average loss: 0.0148, Accuracy: 385/516 (74.6124%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   7,  Average loss: 0.0109, Accuracy: 401/516 (77.7132%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   8,  Average loss: 0.0085, Accuracy: 440/516 (85.2713%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   9,  Average loss: 0.0072, Accuracy: 457/516 (88.5659%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch  10,  Average loss: 0.0073, Accuracy: 464/516 (89.9225%), train_poison_data_count: 516
Global model norm: 14.131649106517136.
Norm before scaling: 17.276578468383686. Distance: 9.552609982769638
Total norm for 5 adversaries is: 17.276578468383686. distance: 9.552609982769638
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.4741, Accuracy: 7858/8991 (87.3985%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   1,  Average loss: 0.0161, Accuracy: 503/665 (75.6391%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   2,  Average loss: 0.0361, Accuracy: 300/665 (45.1128%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   3,  Average loss: 0.0175, Accuracy: 498/665 (74.8872%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   4,  Average loss: 0.0114, Accuracy: 528/665 (79.3985%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   5,  Average loss: 0.0079, Accuracy: 584/665 (87.8195%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   6,  Average loss: 0.0062, Accuracy: 597/665 (89.7744%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   7,  Average loss: 0.0049, Accuracy: 609/665 (91.5789%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   8,  Average loss: 0.0040, Accuracy: 616/665 (92.6316%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   9,  Average loss: 0.0035, Accuracy: 628/665 (94.4361%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch  10,  Average loss: 0.0035, Accuracy: 631/665 (94.8872%), train_poison_data_count: 665
Global model norm: 14.131649106517136.
Norm before scaling: 17.35397889523016. Distance: 9.40924490968897
Total norm for 5 adversaries is: 17.35397889523016. distance: 9.40924490968897
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.3301, Accuracy: 8056/8991 (89.6007%)
___Train Local_Simple,  epoch   3, local model 87, internal_epoch   1,  Average loss: 0.0245, Accuracy: 389/575 (67.6522%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.3513, Accuracy: 6273/10000 (62.7300%), Attack Success Rate:0/10000(0.000)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   1,  Average loss: 0.0175, Accuracy: 494/652 (75.7669%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   2,  Average loss: 0.0233, Accuracy: 454/652 (69.6319%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   3,  Average loss: 0.0105, Accuracy: 531/652 (81.4417%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   4,  Average loss: 0.0073, Accuracy: 571/652 (87.5767%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   5,  Average loss: 0.0052, Accuracy: 590/652 (90.4908%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   6,  Average loss: 0.0041, Accuracy: 605/652 (92.7914%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   7,  Average loss: 0.0033, Accuracy: 607/652 (93.0982%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   8,  Average loss: 0.0030, Accuracy: 615/652 (94.3252%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   9,  Average loss: 0.0027, Accuracy: 618/652 (94.7853%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch  10,  Average loss: 0.0024, Accuracy: 619/652 (94.9387%), train_poison_data_count: 652
Global model norm: 14.131649106517136.
Norm before scaling: 16.908073059054143. Distance: 8.538314186246978
Total norm for 5 adversaries is: 16.908073059054143. distance: 8.538314186246978
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.3087, Accuracy: 8137/8991 (90.5016%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   1,  Average loss: 0.0224, Accuracy: 336/474 (70.8861%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   2,  Average loss: 0.0250, Accuracy: 310/474 (65.4008%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   3,  Average loss: 0.0137, Accuracy: 365/474 (77.0042%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   4,  Average loss: 0.0089, Accuracy: 420/474 (88.6076%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   5,  Average loss: 0.0061, Accuracy: 434/474 (91.5612%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   6,  Average loss: 0.0040, Accuracy: 443/474 (93.4599%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   7,  Average loss: 0.0036, Accuracy: 444/474 (93.6709%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   8,  Average loss: 0.0032, Accuracy: 448/474 (94.5148%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   9,  Average loss: 0.0027, Accuracy: 453/474 (95.5696%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch  10,  Average loss: 0.0027, Accuracy: 454/474 (95.7806%), train_poison_data_count: 474
Global model norm: 14.131649106517136.
Norm before scaling: 15.71697490520674. Distance: 5.9427887501291945
Total norm for 5 adversaries is: 15.71697490520674. distance: 5.9427887501291945
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2926, Accuracy: 8181/8991 (90.9910%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   1,  Average loss: 0.0280, Accuracy: 441/665 (66.3158%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   2,  Average loss: 0.0269, Accuracy: 355/665 (53.3835%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   3,  Average loss: 0.0160, Accuracy: 520/665 (78.1955%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   4,  Average loss: 0.0114, Accuracy: 550/665 (82.7068%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   5,  Average loss: 0.0087, Accuracy: 577/665 (86.7669%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   6,  Average loss: 0.0063, Accuracy: 596/665 (89.6241%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   7,  Average loss: 0.0055, Accuracy: 600/665 (90.2256%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   8,  Average loss: 0.0047, Accuracy: 611/665 (91.8797%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   9,  Average loss: 0.0039, Accuracy: 619/665 (93.0827%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch  10,  Average loss: 0.0039, Accuracy: 615/665 (92.4812%), train_poison_data_count: 665
Global model norm: 14.131649106517136.
Norm before scaling: 17.586725326644633. Distance: 9.87985071725846
Total norm for 5 adversaries is: 17.586725326644633. distance: 9.87985071725846
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.3145, Accuracy: 8153/8991 (90.6796%)
time spent on training: 88.8875720500946
[foolsgold agg] training data poison_ratio: 0.5102145922746781  data num: [523, 592, 537, 626, 516, 665, 575, 652, 474, 665]
[foolsgold agg] considering poison per batch poison_fraction: 0.5102145922746781
[foolsgold agg] wv: [1.         0.87745371 0.87745371 1.         0.61563459 1.
 1.         0.81024101 0.81024101 0.61563459]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 1.3878, Accuracy: 6942/10000 (69.4200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 1.2552, Accuracy: 7120/8991 (79.1903%)
Done in 247.06811380386353 sec.
Server Epoch:4 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   1,  Average loss: 0.0241, Accuracy: 484/641 (75.5070%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   2,  Average loss: 0.0248, Accuracy: 354/641 (55.2262%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   3,  Average loss: 0.0183, Accuracy: 375/641 (58.5023%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   4,  Average loss: 0.0139, Accuracy: 529/641 (82.5273%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   5,  Average loss: 0.0086, Accuracy: 549/641 (85.6474%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   6,  Average loss: 0.0058, Accuracy: 563/641 (87.8315%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   7,  Average loss: 0.0040, Accuracy: 580/641 (90.4836%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   8,  Average loss: 0.0032, Accuracy: 598/641 (93.2917%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   9,  Average loss: 0.0027, Accuracy: 605/641 (94.3838%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch  10,  Average loss: 0.0026, Accuracy: 608/641 (94.8518%), train_poison_data_count: 641
Global model norm: 14.352765476766304.
Norm before scaling: 17.688157355827972. Distance: 9.702184560907211
Total norm for 4 adversaries is: 17.688157355827972. distance: 9.702184560907211
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.3210, Accuracy: 8105/8991 (90.1457%)
___Train Local_Simple,  epoch   4, local model 92, internal_epoch   1,  Average loss: 0.0178, Accuracy: 412/571 (72.1541%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.3226, Accuracy: 5072/10000 (50.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 95, internal_epoch   1,  Average loss: 0.0262, Accuracy: 335/532 (62.9699%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.7477, Accuracy: 4432/10000 (44.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 76, internal_epoch   1,  Average loss: 0.0268, Accuracy: 344/518 (66.4093%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.5745, Accuracy: 4613/10000 (46.1300%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0115, Accuracy: 434/521 (83.3013%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   2,  Average loss: 0.0068, Accuracy: 461/521 (88.4837%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   3,  Average loss: 0.0046, Accuracy: 476/521 (91.3628%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   4,  Average loss: 0.0033, Accuracy: 492/521 (94.4338%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   5,  Average loss: 0.0028, Accuracy: 500/521 (95.9693%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   6,  Average loss: 0.0025, Accuracy: 503/521 (96.5451%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   7,  Average loss: 0.0020, Accuracy: 506/521 (97.1209%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   8,  Average loss: 0.0018, Accuracy: 510/521 (97.8887%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   9,  Average loss: 0.0021, Accuracy: 511/521 (98.0806%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch  10,  Average loss: 0.0016, Accuracy: 512/521 (98.2726%), train_poison_data_count: 521
Global model norm: 14.352765476766304.
Norm before scaling: 14.984262475952635. Distance: 2.919454296017604
Total norm for 4 adversaries is: 14.984262475952635. distance: 2.919454296017604
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2802, Accuracy: 8247/8991 (91.7251%)
___Train Local_Simple,  epoch   4, local model 99, internal_epoch   1,  Average loss: 0.0380, Accuracy: 256/410 (62.4390%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.0733, Accuracy: 3686/10000 (36.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 94, internal_epoch   1,  Average loss: 0.0143, Accuracy: 421/555 (75.8559%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.8331, Accuracy: 7400/10000 (74.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 74, internal_epoch   1,  Average loss: 0.0223, Accuracy: 403/626 (64.3770%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.2918, Accuracy: 6182/10000 (61.8200%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   1,  Average loss: 0.0098, Accuracy: 619/750 (82.5333%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   2,  Average loss: 0.0067, Accuracy: 656/750 (87.4667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   3,  Average loss: 0.0033, Accuracy: 708/750 (94.4000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   4,  Average loss: 0.0026, Accuracy: 720/750 (96.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   5,  Average loss: 0.0021, Accuracy: 721/750 (96.1333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   6,  Average loss: 0.0019, Accuracy: 727/750 (96.9333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   7,  Average loss: 0.0017, Accuracy: 732/750 (97.6000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   8,  Average loss: 0.0015, Accuracy: 733/750 (97.7333%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   9,  Average loss: 0.0014, Accuracy: 733/750 (97.7333%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch  10,  Average loss: 0.0014, Accuracy: 733/750 (97.7333%), train_poison_data_count: 750
Global model norm: 14.352765476766304.
Norm before scaling: 15.075962745707518. Distance: 3.230821952284855
Total norm for 4 adversaries is: 15.075962745707518. distance: 3.230821952284855
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2215, Accuracy: 8415/8991 (93.5936%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   1,  Average loss: 0.0126, Accuracy: 411/518 (79.3436%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   2,  Average loss: 0.0138, Accuracy: 428/518 (82.6255%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   3,  Average loss: 0.0052, Accuracy: 468/518 (90.3475%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   4,  Average loss: 0.0046, Accuracy: 489/518 (94.4015%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   5,  Average loss: 0.0029, Accuracy: 488/518 (94.2085%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   6,  Average loss: 0.0027, Accuracy: 491/518 (94.7876%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   7,  Average loss: 0.0022, Accuracy: 495/518 (95.5598%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   8,  Average loss: 0.0018, Accuracy: 500/518 (96.5251%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   9,  Average loss: 0.0015, Accuracy: 503/518 (97.1042%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch  10,  Average loss: 0.0018, Accuracy: 503/518 (97.1042%), train_poison_data_count: 518
Global model norm: 14.352765476766304.
Norm before scaling: 15.23214927651483. Distance: 3.739644693847032
Total norm for 4 adversaries is: 15.23214927651483. distance: 3.739644693847032
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2356, Accuracy: 8405/8991 (93.4824%)
time spent on training: 82.0898060798645
[foolsgold agg] training data poison_ratio: 0.43069833392414036  data num: [641, 571, 532, 518, 521, 410, 555, 626, 750, 518]
[foolsgold agg] considering poison per batch poison_fraction: 0.43069833392414036
[foolsgold agg] wv: [1.         1.         1.         1.         0.62863204 1.
 1.         1.         1.         0.62863204]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 1.3327, Accuracy: 7119/10000 (71.1900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 1.2360, Accuracy: 7176/8991 (79.8131%)
Done in 242.40501809120178 sec.
Server Epoch:5 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
___Train Local_Simple,  epoch   5, local model 60, internal_epoch   1,  Average loss: 0.0139, Accuracy: 488/644 (75.7764%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.9117, Accuracy: 6545/10000 (65.4500%), Attack Success Rate:0/10000(0.000)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   1,  Average loss: 0.0107, Accuracy: 432/516 (83.7209%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   2,  Average loss: 0.0064, Accuracy: 459/516 (88.9535%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   3,  Average loss: 0.0040, Accuracy: 471/516 (91.2791%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   4,  Average loss: 0.0025, Accuracy: 493/516 (95.5426%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   5,  Average loss: 0.0020, Accuracy: 496/516 (96.1240%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   6,  Average loss: 0.0020, Accuracy: 500/516 (96.8992%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   7,  Average loss: 0.0018, Accuracy: 501/516 (97.0930%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   8,  Average loss: 0.0015, Accuracy: 497/516 (96.3178%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   9,  Average loss: 0.0014, Accuracy: 503/516 (97.4806%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch  10,  Average loss: 0.0016, Accuracy: 504/516 (97.6744%), train_poison_data_count: 516
Global model norm: 14.509929019851642.
Norm before scaling: 15.021842312444933. Distance: 2.53100283322577
Total norm for 7 adversaries is: 15.021842312444933. distance: 2.53100283322577
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2060, Accuracy: 8463/8991 (94.1275%)
___Train Local_Simple,  epoch   5, local model 65, internal_epoch   1,  Average loss: 0.0157, Accuracy: 419/573 (73.1239%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.4444, Accuracy: 5168/10000 (51.6800%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0120, Accuracy: 441/535 (82.4299%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   2,  Average loss: 0.0068, Accuracy: 461/535 (86.1682%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   3,  Average loss: 0.0057, Accuracy: 471/535 (88.0374%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   4,  Average loss: 0.0034, Accuracy: 505/535 (94.3925%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   5,  Average loss: 0.0029, Accuracy: 514/535 (96.0748%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   6,  Average loss: 0.0021, Accuracy: 521/535 (97.3832%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   7,  Average loss: 0.0016, Accuracy: 524/535 (97.9439%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   8,  Average loss: 0.0015, Accuracy: 525/535 (98.1308%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   9,  Average loss: 0.0014, Accuracy: 527/535 (98.5047%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch  10,  Average loss: 0.0013, Accuracy: 527/535 (98.5047%), train_poison_data_count: 535
Global model norm: 14.509929019851642.
Norm before scaling: 15.031873789194007. Distance: 2.5765289915183414
Total norm for 7 adversaries is: 15.031873789194007. distance: 2.5765289915183414
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2553, Accuracy: 8317/8991 (92.5036%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   1,  Average loss: 0.0105, Accuracy: 432/520 (83.0769%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   2,  Average loss: 0.0067, Accuracy: 458/520 (88.0769%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   3,  Average loss: 0.0039, Accuracy: 479/520 (92.1154%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   4,  Average loss: 0.0024, Accuracy: 497/520 (95.5769%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   5,  Average loss: 0.0023, Accuracy: 495/520 (95.1923%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   6,  Average loss: 0.0021, Accuracy: 498/520 (95.7692%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   7,  Average loss: 0.0020, Accuracy: 501/520 (96.3462%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   8,  Average loss: 0.0022, Accuracy: 504/520 (96.9231%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   9,  Average loss: 0.0016, Accuracy: 506/520 (97.3077%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch  10,  Average loss: 0.0017, Accuracy: 506/520 (97.3077%), train_poison_data_count: 520
Global model norm: 14.509929019851642.
Norm before scaling: 14.994925085518517. Distance: 2.417284053558282
Total norm for 7 adversaries is: 14.994925085518517. distance: 2.417284053558282
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2080, Accuracy: 8428/8991 (93.7382%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   1,  Average loss: 0.0107, Accuracy: 482/578 (83.3910%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   2,  Average loss: 0.0098, Accuracy: 485/578 (83.9100%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   3,  Average loss: 0.0036, Accuracy: 548/578 (94.8097%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   4,  Average loss: 0.0027, Accuracy: 551/578 (95.3287%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   5,  Average loss: 0.0023, Accuracy: 556/578 (96.1938%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   6,  Average loss: 0.0019, Accuracy: 557/578 (96.3668%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   7,  Average loss: 0.0017, Accuracy: 557/578 (96.3668%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   8,  Average loss: 0.0015, Accuracy: 561/578 (97.0588%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   9,  Average loss: 0.0014, Accuracy: 563/578 (97.4048%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch  10,  Average loss: 0.0014, Accuracy: 564/578 (97.5779%), train_poison_data_count: 578
Global model norm: 14.509929019851642.
Norm before scaling: 15.332776156267434. Distance: 3.499248832748773
Total norm for 7 adversaries is: 15.332776156267434. distance: 3.499248832748773
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2305, Accuracy: 8405/8991 (93.4824%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0112, Accuracy: 458/550 (83.2727%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   2,  Average loss: 0.0067, Accuracy: 477/550 (86.7273%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   3,  Average loss: 0.0042, Accuracy: 509/550 (92.5455%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   4,  Average loss: 0.0027, Accuracy: 527/550 (95.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   5,  Average loss: 0.0023, Accuracy: 533/550 (96.9091%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   6,  Average loss: 0.0018, Accuracy: 529/550 (96.1818%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   7,  Average loss: 0.0016, Accuracy: 535/550 (97.2727%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   8,  Average loss: 0.0015, Accuracy: 540/550 (98.1818%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   9,  Average loss: 0.0014, Accuracy: 540/550 (98.1818%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch  10,  Average loss: 0.0013, Accuracy: 540/550 (98.1818%), train_poison_data_count: 550
Global model norm: 14.509929019851642.
Norm before scaling: 15.014945658897618. Distance: 2.505615698249281
Total norm for 7 adversaries is: 15.014945658897618. distance: 2.505615698249281
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2210, Accuracy: 8403/8991 (93.4601%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0103, Accuracy: 492/587 (83.8160%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   2,  Average loss: 0.0136, Accuracy: 456/587 (77.6831%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   3,  Average loss: 0.0060, Accuracy: 538/587 (91.6525%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   4,  Average loss: 0.0044, Accuracy: 554/587 (94.3782%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   5,  Average loss: 0.0033, Accuracy: 558/587 (95.0596%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   6,  Average loss: 0.0026, Accuracy: 563/587 (95.9114%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   7,  Average loss: 0.0022, Accuracy: 567/587 (96.5928%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   8,  Average loss: 0.0020, Accuracy: 567/587 (96.5928%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   9,  Average loss: 0.0017, Accuracy: 570/587 (97.1039%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch  10,  Average loss: 0.0025, Accuracy: 573/587 (97.6150%), train_poison_data_count: 587
Global model norm: 14.509929019851642.
Norm before scaling: 15.40870161068571. Distance: 3.6732382982794984
Total norm for 7 adversaries is: 15.40870161068571. distance: 3.6732382982794984
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2225, Accuracy: 8409/8991 (93.5269%)
___Train Local_Simple,  epoch   5, local model 76, internal_epoch   1,  Average loss: 0.0199, Accuracy: 376/518 (72.5869%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.0066, Accuracy: 6254/10000 (62.5400%), Attack Success Rate:1/10000(0.010)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   1,  Average loss: 0.0115, Accuracy: 408/503 (81.1133%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   2,  Average loss: 0.0094, Accuracy: 424/503 (84.2942%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   3,  Average loss: 0.0056, Accuracy: 451/503 (89.6620%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   4,  Average loss: 0.0038, Accuracy: 464/503 (92.2465%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   5,  Average loss: 0.0031, Accuracy: 467/503 (92.8429%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   6,  Average loss: 0.0026, Accuracy: 474/503 (94.2346%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   7,  Average loss: 0.0020, Accuracy: 482/503 (95.8250%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   8,  Average loss: 0.0017, Accuracy: 486/503 (96.6203%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   9,  Average loss: 0.0015, Accuracy: 488/503 (97.0179%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch  10,  Average loss: 0.0015, Accuracy: 488/503 (97.0179%), train_poison_data_count: 503
Global model norm: 14.509929019851642.
Norm before scaling: 15.030827189187258. Distance: 2.503878255559673
Total norm for 7 adversaries is: 15.030827189187258. distance: 2.503878255559673
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2136, Accuracy: 8425/8991 (93.7048%)
time spent on training: 109.27248907089233
[foolsgold agg] training data poison_ratio: 0.6859160028964518  data num: [644, 516, 573, 535, 520, 578, 550, 587, 518, 503]
[foolsgold agg] considering poison per batch poison_fraction: 0.6859160028964518
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.76973994
 0.76973994 0.90188284 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 0.8649, Accuracy: 7379/10000 (73.7900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 0.6453, Accuracy: 7380/8991 (82.0821%)
Done in 270.39565896987915 sec.
Server Epoch:6 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   1,  Average loss: 0.0054, Accuracy: 484/526 (92.0152%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   2,  Average loss: 0.0030, Accuracy: 495/526 (94.1065%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   3,  Average loss: 0.0015, Accuracy: 508/526 (96.5779%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   4,  Average loss: 0.0008, Accuracy: 519/526 (98.6692%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   5,  Average loss: 0.0010, Accuracy: 521/526 (99.0494%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   6,  Average loss: 0.0009, Accuracy: 521/526 (99.0494%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   7,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   8,  Average loss: 0.0007, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   9,  Average loss: 0.0004, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch  10,  Average loss: 0.0004, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Global model norm: 14.694674423780148.
Norm before scaling: 15.021993154049582. Distance: 1.8610167107751676
Total norm for 6 adversaries is: 15.021993154049582. distance: 1.8610167107751676
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.2183, Accuracy: 8471/8991 (94.2164%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   1,  Average loss: 0.0068, Accuracy: 532/605 (87.9339%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   2,  Average loss: 0.0046, Accuracy: 553/605 (91.4050%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   3,  Average loss: 0.0025, Accuracy: 583/605 (96.3636%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   4,  Average loss: 0.0016, Accuracy: 591/605 (97.6860%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   5,  Average loss: 0.0014, Accuracy: 589/605 (97.3554%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   6,  Average loss: 0.0013, Accuracy: 592/605 (97.8512%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   7,  Average loss: 0.0010, Accuracy: 594/605 (98.1818%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   8,  Average loss: 0.0009, Accuracy: 595/605 (98.3471%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   9,  Average loss: 0.0009, Accuracy: 597/605 (98.6777%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch  10,  Average loss: 0.0008, Accuracy: 597/605 (98.6777%), train_poison_data_count: 605
Global model norm: 14.694674423780148.
Norm before scaling: 15.07635797612337. Distance: 2.0973819716735713
Total norm for 6 adversaries is: 15.07635797612337. distance: 2.0973819716735713
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.2006, Accuracy: 8487/8991 (94.3944%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 521/587 (88.7564%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   2,  Average loss: 0.0050, Accuracy: 523/587 (89.0971%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   3,  Average loss: 0.0039, Accuracy: 546/587 (93.0153%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   4,  Average loss: 0.0014, Accuracy: 575/587 (97.9557%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   5,  Average loss: 0.0014, Accuracy: 577/587 (98.2964%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   6,  Average loss: 0.0014, Accuracy: 580/587 (98.8075%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   7,  Average loss: 0.0008, Accuracy: 581/587 (98.9779%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   8,  Average loss: 0.0006, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   9,  Average loss: 0.0006, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch  10,  Average loss: 0.0006, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Global model norm: 14.694674423780148.
Norm before scaling: 15.121232501462348. Distance: 2.181519972044202
Total norm for 6 adversaries is: 15.121232501462348. distance: 2.181519972044202
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1761, Accuracy: 8528/8991 (94.8504%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   1,  Average loss: 0.0065, Accuracy: 580/652 (88.9571%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   2,  Average loss: 0.0053, Accuracy: 596/652 (91.4110%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   3,  Average loss: 0.0044, Accuracy: 588/652 (90.1840%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   4,  Average loss: 0.0021, Accuracy: 630/652 (96.6258%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   5,  Average loss: 0.0017, Accuracy: 634/652 (97.2393%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   6,  Average loss: 0.0013, Accuracy: 640/652 (98.1595%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   7,  Average loss: 0.0011, Accuracy: 643/652 (98.6196%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   8,  Average loss: 0.0011, Accuracy: 645/652 (98.9264%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   9,  Average loss: 0.0010, Accuracy: 644/652 (98.7730%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch  10,  Average loss: 0.0012, Accuracy: 644/652 (98.7730%), train_poison_data_count: 652
Global model norm: 14.694674423780148.
Norm before scaling: 15.131031693747373. Distance: 2.333849838401517
Total norm for 6 adversaries is: 15.131031693747373. distance: 2.333849838401517
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1999, Accuracy: 8452/8991 (94.0051%)
___Train Local_Simple,  epoch   6, local model 99, internal_epoch   1,  Average loss: 0.0036, Accuracy: 385/410 (93.9024%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 3.0102, Accuracy: 6652/10000 (66.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 67, internal_epoch   1,  Average loss: 0.0151, Accuracy: 509/643 (79.1602%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.8404, Accuracy: 7509/10000 (75.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 91, internal_epoch   1,  Average loss: 0.0090, Accuracy: 522/627 (83.2536%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.3732, Accuracy: 6261/10000 (62.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 76, internal_epoch   1,  Average loss: 0.0092, Accuracy: 424/518 (81.8533%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 10.5383, Accuracy: 2701/10000 (27.0100%), Attack Success Rate:1/10000(0.010)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0055, Accuracy: 617/683 (90.3367%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   2,  Average loss: 0.0042, Accuracy: 620/683 (90.7760%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   3,  Average loss: 0.0021, Accuracy: 653/683 (95.6076%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   4,  Average loss: 0.0015, Accuracy: 666/683 (97.5110%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   5,  Average loss: 0.0012, Accuracy: 671/683 (98.2430%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   6,  Average loss: 0.0010, Accuracy: 675/683 (98.8287%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   7,  Average loss: 0.0009, Accuracy: 676/683 (98.9751%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   8,  Average loss: 0.0008, Accuracy: 674/683 (98.6823%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   9,  Average loss: 0.0007, Accuracy: 678/683 (99.2679%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch  10,  Average loss: 0.0006, Accuracy: 678/683 (99.2679%), train_poison_data_count: 683
Global model norm: 14.694674423780148.
Norm before scaling: 15.078257063055077. Distance: 2.0826924546281878
Total norm for 6 adversaries is: 15.078257063055077. distance: 2.0826924546281878
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1534, Accuracy: 8571/8991 (95.3287%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   1,  Average loss: 0.0070, Accuracy: 512/582 (87.9725%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   2,  Average loss: 0.0052, Accuracy: 520/582 (89.3471%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   3,  Average loss: 0.0038, Accuracy: 537/582 (92.2680%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   4,  Average loss: 0.0020, Accuracy: 559/582 (96.0481%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   5,  Average loss: 0.0017, Accuracy: 564/582 (96.9072%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   6,  Average loss: 0.0013, Accuracy: 570/582 (97.9381%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   7,  Average loss: 0.0012, Accuracy: 575/582 (98.7973%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   8,  Average loss: 0.0010, Accuracy: 573/582 (98.4536%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   9,  Average loss: 0.0009, Accuracy: 575/582 (98.7973%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch  10,  Average loss: 0.0008, Accuracy: 578/582 (99.3127%), train_poison_data_count: 582
Global model norm: 14.694674423780148.
Norm before scaling: 15.121015544069266. Distance: 2.204990868408948
Total norm for 6 adversaries is: 15.121015544069266. distance: 2.204990868408948
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1674, Accuracy: 8552/8991 (95.1173%)
time spent on training: 102.9583580493927
[foolsgold agg] training data poison_ratio: 0.6231784673409909  data num: [526, 605, 587, 652, 410, 643, 627, 518, 683, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.6231784673409909
[foolsgold agg] wv: [1.         0.72627786 1.         1.         1.         1.
 1.         1.         0.72627786 1.        ]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 0.7560, Accuracy: 7636/10000 (76.3600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 0.4614, Accuracy: 7633/8991 (84.8960%)
Done in 265.2460370063782 sec.
Server Epoch:7 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
___Train Local_Simple,  epoch   7, local model 66, internal_epoch   1,  Average loss: 0.0096, Accuracy: 511/629 (81.2401%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.5458, Accuracy: 7986/10000 (79.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 68, internal_epoch   1,  Average loss: 0.0076, Accuracy: 532/632 (84.1772%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.4548, Accuracy: 8634/10000 (86.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 59, internal_epoch   1,  Average loss: 0.0068, Accuracy: 567/652 (86.9632%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6796, Accuracy: 7959/10000 (79.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 62, internal_epoch   1,  Average loss: 0.0089, Accuracy: 501/617 (81.1994%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6121, Accuracy: 8050/10000 (80.5000%), Attack Success Rate:0/10000(0.000)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   1,  Average loss: 0.0047, Accuracy: 467/511 (91.3894%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   2,  Average loss: 0.0028, Accuracy: 484/511 (94.7162%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   3,  Average loss: 0.0022, Accuracy: 489/511 (95.6947%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   4,  Average loss: 0.0010, Accuracy: 501/511 (98.0431%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   5,  Average loss: 0.0009, Accuracy: 502/511 (98.2387%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   6,  Average loss: 0.0007, Accuracy: 505/511 (98.8258%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   7,  Average loss: 0.0006, Accuracy: 508/511 (99.4129%), train_poison_data_count: 511
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   8,  Average loss: 0.0005, Accuracy: 509/511 (99.6086%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   9,  Average loss: 0.0004, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch  10,  Average loss: 0.0004, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Global model norm: 14.819961921756233.
Norm before scaling: 15.03176568112301. Distance: 1.4714711730705057
Total norm for 5 adversaries is: 15.03176568112301. distance: 1.4714711730705057
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1635, Accuracy: 8541/8991 (94.9950%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 517/572 (90.3846%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   2,  Average loss: 0.0031, Accuracy: 539/572 (94.2308%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   3,  Average loss: 0.0021, Accuracy: 548/572 (95.8042%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   4,  Average loss: 0.0012, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   5,  Average loss: 0.0009, Accuracy: 566/572 (98.9510%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   6,  Average loss: 0.0008, Accuracy: 567/572 (99.1259%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   7,  Average loss: 0.0007, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   8,  Average loss: 0.0006, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   9,  Average loss: 0.0005, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch  10,  Average loss: 0.0005, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Global model norm: 14.819961921756233.
Norm before scaling: 15.07293921914706. Distance: 1.7249198452667924
Total norm for 5 adversaries is: 15.07293921914706. distance: 1.7249198452667924
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1698, Accuracy: 8514/8991 (94.6947%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   1,  Average loss: 0.0063, Accuracy: 523/588 (88.9456%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   2,  Average loss: 0.0046, Accuracy: 536/588 (91.1565%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   3,  Average loss: 0.0023, Accuracy: 563/588 (95.7483%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   4,  Average loss: 0.0015, Accuracy: 571/588 (97.1088%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   5,  Average loss: 0.0018, Accuracy: 576/588 (97.9592%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   6,  Average loss: 0.0011, Accuracy: 574/588 (97.6190%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   7,  Average loss: 0.0012, Accuracy: 578/588 (98.2993%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   8,  Average loss: 0.0009, Accuracy: 581/588 (98.8095%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   9,  Average loss: 0.0008, Accuracy: 582/588 (98.9796%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch  10,  Average loss: 0.0010, Accuracy: 583/588 (99.1497%), train_poison_data_count: 588
Global model norm: 14.819961921756233.
Norm before scaling: 15.158183873079192. Distance: 2.0393027679249487
Total norm for 5 adversaries is: 15.158183873079192. distance: 2.0393027679249487
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1703, Accuracy: 8518/8991 (94.7392%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 490/550 (89.0909%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   2,  Average loss: 0.0032, Accuracy: 512/550 (93.0909%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   3,  Average loss: 0.0022, Accuracy: 523/550 (95.0909%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   4,  Average loss: 0.0013, Accuracy: 540/550 (98.1818%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   5,  Average loss: 0.0011, Accuracy: 540/550 (98.1818%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   6,  Average loss: 0.0009, Accuracy: 541/550 (98.3636%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   7,  Average loss: 0.0007, Accuracy: 543/550 (98.7273%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   8,  Average loss: 0.0007, Accuracy: 544/550 (98.9091%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   9,  Average loss: 0.0006, Accuracy: 545/550 (99.0909%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch  10,  Average loss: 0.0006, Accuracy: 546/550 (99.2727%), train_poison_data_count: 550
Global model norm: 14.819961921756233.
Norm before scaling: 15.09646765211283. Distance: 1.6611312336945026
Total norm for 5 adversaries is: 15.09646765211283. distance: 1.6611312336945026
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1802, Accuracy: 8512/8991 (94.6725%)
___Train Local_Simple,  epoch   7, local model 99, internal_epoch   1,  Average loss: 0.0025, Accuracy: 392/410 (95.6098%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.7447, Accuracy: 6957/10000 (69.5700%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   1,  Average loss: 0.0042, Accuracy: 692/750 (92.2667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   2,  Average loss: 0.0034, Accuracy: 706/750 (94.1333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   3,  Average loss: 0.0019, Accuracy: 719/750 (95.8667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   4,  Average loss: 0.0012, Accuracy: 737/750 (98.2667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   5,  Average loss: 0.0010, Accuracy: 739/750 (98.5333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   6,  Average loss: 0.0008, Accuracy: 743/750 (99.0667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   7,  Average loss: 0.0007, Accuracy: 743/750 (99.0667%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   8,  Average loss: 0.0006, Accuracy: 746/750 (99.4667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   9,  Average loss: 0.0006, Accuracy: 746/750 (99.4667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch  10,  Average loss: 0.0006, Accuracy: 746/750 (99.4667%), train_poison_data_count: 750
Global model norm: 14.819961921756233.
Norm before scaling: 15.118102463428622. Distance: 1.8757160091215834
Total norm for 5 adversaries is: 15.118102463428622. distance: 1.8757160091215834
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1626, Accuracy: 8569/8991 (95.3064%)
time spent on training: 92.6046552658081
[foolsgold agg] training data poison_ratio: 0.5026222297411606  data num: [629, 632, 652, 617, 511, 572, 588, 550, 410, 750]
[foolsgold agg] considering poison per batch poison_fraction: 0.5026222297411606
[foolsgold agg] wv: [6.45034776e-01 6.45034776e-01 1.00000000e+00 1.00000000e+00
 1.00000000e+00 1.00000000e+00 2.94107504e-04 1.00000000e+00
 1.00000000e+00 2.94107504e-04]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 0.7875, Accuracy: 7831/10000 (78.3100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 0.3842, Accuracy: 7824/8991 (87.0204%)
Done in 253.86011385917664 sec.
Server Epoch:8 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
___Train Local_Simple,  epoch   8, local model 63, internal_epoch   1,  Average loss: 0.0108, Accuracy: 485/616 (78.7338%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.4762, Accuracy: 8336/10000 (83.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 55, internal_epoch   1,  Average loss: 0.0073, Accuracy: 500/592 (84.4595%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6088, Accuracy: 8124/10000 (81.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 79, internal_epoch   1,  Average loss: 0.0057, Accuracy: 558/635 (87.8740%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.2974, Accuracy: 9042/10000 (90.4200%), Attack Success Rate:0/10000(0.000)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 501/548 (91.4234%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   2,  Average loss: 0.0032, Accuracy: 516/548 (94.1606%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   3,  Average loss: 0.0018, Accuracy: 530/548 (96.7153%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   4,  Average loss: 0.0014, Accuracy: 537/548 (97.9927%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   5,  Average loss: 0.0012, Accuracy: 538/548 (98.1752%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   6,  Average loss: 0.0010, Accuracy: 540/548 (98.5401%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   7,  Average loss: 0.0009, Accuracy: 541/548 (98.7226%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   8,  Average loss: 0.0009, Accuracy: 542/548 (98.9051%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   9,  Average loss: 0.0008, Accuracy: 542/548 (98.9051%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch  10,  Average loss: 0.0008, Accuracy: 542/548 (98.9051%), train_poison_data_count: 548
Global model norm: 14.880417294137159.
Norm before scaling: 15.050806595488652. Distance: 1.4311395994026983
Total norm for 2 adversaries is: 15.050806595488652. distance: 1.4311395994026983
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1370, Accuracy: 8593/8991 (95.5734%)
___Train Local_Simple,  epoch   8, local model 62, internal_epoch   1,  Average loss: 0.0094, Accuracy: 495/617 (80.2269%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.4037, Accuracy: 8645/10000 (86.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 56, internal_epoch   1,  Average loss: 0.0073, Accuracy: 527/626 (84.1853%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.3854, Accuracy: 8775/10000 (87.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 96, internal_epoch   1,  Average loss: 0.0085, Accuracy: 501/608 (82.4013%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.5952, Accuracy: 7925/10000 (79.2500%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 542/597 (90.7873%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   2,  Average loss: 0.0044, Accuracy: 549/597 (91.9598%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   3,  Average loss: 0.0016, Accuracy: 583/597 (97.6549%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   4,  Average loss: 0.0013, Accuracy: 582/597 (97.4874%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   5,  Average loss: 0.0011, Accuracy: 587/597 (98.3250%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   6,  Average loss: 0.0009, Accuracy: 588/597 (98.4925%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   7,  Average loss: 0.0009, Accuracy: 588/597 (98.4925%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   8,  Average loss: 0.0008, Accuracy: 590/597 (98.8275%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   9,  Average loss: 0.0006, Accuracy: 591/597 (98.9950%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch  10,  Average loss: 0.0007, Accuracy: 592/597 (99.1625%), train_poison_data_count: 597
Global model norm: 14.880417294137159.
Norm before scaling: 15.143581105737661. Distance: 1.738018641833908
Total norm for 2 adversaries is: 15.143581105737661. distance: 1.738018641833908
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1432, Accuracy: 8592/8991 (95.5622%)
___Train Local_Simple,  epoch   8, local model 92, internal_epoch   1,  Average loss: 0.0063, Accuracy: 495/571 (86.6900%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.3189, Accuracy: 8903/10000 (89.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 86, internal_epoch   1,  Average loss: 0.0096, Accuracy: 491/587 (83.6457%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.8293, Accuracy: 7244/10000 (72.4400%), Attack Success Rate:0/10000(0.000)
time spent on training: 62.697625160217285
[foolsgold agg] training data poison_ratio: 0.19092879773219942  data num: [616, 592, 635, 548, 617, 626, 608, 597, 571, 587]
[foolsgold agg] considering poison per batch poison_fraction: 0.19092879773219942
[foolsgold agg] wv: [1.         1.         0.91903354 1.         1.         1.
 0.91903354 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 0.6711, Accuracy: 8143/10000 (81.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 0.3012, Accuracy: 8128/8991 (90.4015%)
Done in 224.66948294639587 sec.
Server Epoch:9 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   1,  Average loss: 0.0041, Accuracy: 606/665 (91.1278%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   2,  Average loss: 0.0028, Accuracy: 636/665 (95.6391%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   3,  Average loss: 0.0015, Accuracy: 643/665 (96.6917%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   4,  Average loss: 0.0010, Accuracy: 655/665 (98.4962%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   5,  Average loss: 0.0010, Accuracy: 656/665 (98.6466%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   6,  Average loss: 0.0008, Accuracy: 656/665 (98.6466%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   7,  Average loss: 0.0006, Accuracy: 660/665 (99.2481%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   8,  Average loss: 0.0006, Accuracy: 659/665 (99.0977%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   9,  Average loss: 0.0005, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch  10,  Average loss: 0.0005, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Global model norm: 14.95226321233339.
Norm before scaling: 15.130542590792865. Distance: 1.530865679409384
Total norm for 6 adversaries is: 15.130542590792865. distance: 1.530865679409384
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1475, Accuracy: 8591/8991 (95.5511%)
___Train Local_Simple,  epoch   9, local model 63, internal_epoch   1,  Average loss: 0.0075, Accuracy: 520/616 (84.4156%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.4145, Accuracy: 8711/10000 (87.1100%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   1,  Average loss: 0.0028, Accuracy: 599/638 (93.8871%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   2,  Average loss: 0.0018, Accuracy: 618/638 (96.8652%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   3,  Average loss: 0.0007, Accuracy: 629/638 (98.5893%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   4,  Average loss: 0.0005, Accuracy: 631/638 (98.9028%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   5,  Average loss: 0.0004, Accuracy: 634/638 (99.3730%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   6,  Average loss: 0.0004, Accuracy: 635/638 (99.5298%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   7,  Average loss: 0.0003, Accuracy: 636/638 (99.6865%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   8,  Average loss: 0.0003, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   9,  Average loss: 0.0003, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch  10,  Average loss: 0.0003, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 14.95226321233339.
Norm before scaling: 15.102675932181688. Distance: 1.2975344073046169
Total norm for 6 adversaries is: 15.102675932181688. distance: 1.2975344073046169
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1476, Accuracy: 8587/8991 (95.5066%)
___Train Local_Simple,  epoch   9, local model 71, internal_epoch   1,  Average loss: 0.0067, Accuracy: 542/638 (84.9530%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.4342, Accuracy: 8512/10000 (85.1200%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 488/521 (93.6660%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   2,  Average loss: 0.0023, Accuracy: 506/521 (97.1209%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   3,  Average loss: 0.0020, Accuracy: 497/521 (95.3935%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   4,  Average loss: 0.0010, Accuracy: 513/521 (98.4645%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   5,  Average loss: 0.0008, Accuracy: 516/521 (99.0403%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   6,  Average loss: 0.0007, Accuracy: 517/521 (99.2322%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   7,  Average loss: 0.0007, Accuracy: 516/521 (99.0403%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   8,  Average loss: 0.0006, Accuracy: 516/521 (99.0403%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   9,  Average loss: 0.0006, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch  10,  Average loss: 0.0005, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Global model norm: 14.95226321233339.
Norm before scaling: 15.049353216220373. Distance: 1.2029677944771653
Total norm for 6 adversaries is: 15.049353216220373. distance: 1.2029677944771653
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1631, Accuracy: 8535/8991 (94.9283%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   1,  Average loss: 0.0031, Accuracy: 571/609 (93.7603%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   2,  Average loss: 0.0024, Accuracy: 589/609 (96.7159%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   3,  Average loss: 0.0012, Accuracy: 596/609 (97.8654%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   4,  Average loss: 0.0008, Accuracy: 602/609 (98.8506%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   5,  Average loss: 0.0006, Accuracy: 606/609 (99.5074%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   6,  Average loss: 0.0005, Accuracy: 606/609 (99.5074%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   7,  Average loss: 0.0004, Accuracy: 607/609 (99.6716%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   8,  Average loss: 0.0004, Accuracy: 607/609 (99.6716%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   9,  Average loss: 0.0003, Accuracy: 607/609 (99.6716%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch  10,  Average loss: 0.0004, Accuracy: 607/609 (99.6716%), train_poison_data_count: 609
Global model norm: 14.95226321233339.
Norm before scaling: 15.10511418319321. Distance: 1.3080801795830241
Total norm for 6 adversaries is: 15.10511418319321. distance: 1.3080801795830241
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1555, Accuracy: 8557/8991 (95.1730%)
___Train Local_Simple,  epoch   9, local model 76, internal_epoch   1,  Average loss: 0.0068, Accuracy: 452/518 (87.2587%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.3897, Accuracy: 8795/10000 (87.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 97, internal_epoch   1,  Average loss: 0.0093, Accuracy: 482/588 (81.9728%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.8204, Accuracy: 8162/10000 (81.6200%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   1,  Average loss: 0.0053, Accuracy: 526/588 (89.4558%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   2,  Average loss: 0.0030, Accuracy: 561/588 (95.4082%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   3,  Average loss: 0.0018, Accuracy: 564/588 (95.9184%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   4,  Average loss: 0.0010, Accuracy: 578/588 (98.2993%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   5,  Average loss: 0.0010, Accuracy: 579/588 (98.4694%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   6,  Average loss: 0.0007, Accuracy: 582/588 (98.9796%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   7,  Average loss: 0.0006, Accuracy: 585/588 (99.4898%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   8,  Average loss: 0.0005, Accuracy: 586/588 (99.6599%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   9,  Average loss: 0.0005, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch  10,  Average loss: 0.0004, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Global model norm: 14.95226321233339.
Norm before scaling: 15.180909284817798. Distance: 1.6772403367122812
Total norm for 6 adversaries is: 15.180909284817798. distance: 1.6772403367122812
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1533, Accuracy: 8573/8991 (95.3509%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   1,  Average loss: 0.0044, Accuracy: 533/582 (91.5808%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   2,  Average loss: 0.0029, Accuracy: 551/582 (94.6735%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   3,  Average loss: 0.0026, Accuracy: 550/582 (94.5017%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   4,  Average loss: 0.0011, Accuracy: 571/582 (98.1100%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   5,  Average loss: 0.0010, Accuracy: 576/582 (98.9691%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   6,  Average loss: 0.0007, Accuracy: 575/582 (98.7973%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   7,  Average loss: 0.0006, Accuracy: 578/582 (99.3127%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   8,  Average loss: 0.0005, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   9,  Average loss: 0.0005, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch  10,  Average loss: 0.0005, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Global model norm: 14.95226321233339.
Norm before scaling: 15.165112985252327. Distance: 1.5674500448002597
Total norm for 6 adversaries is: 15.165112985252327. distance: 1.5674500448002597
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1327, Accuracy: 8605/8991 (95.7068%)
time spent on training: 103.91743922233582
[foolsgold agg] training data poison_ratio: 0.6042260607076975  data num: [665, 616, 638, 638, 521, 609, 518, 588, 588, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.6042260607076975
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 0.8201, Accuracy: 8196/10000 (81.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 0.2980, Accuracy: 8187/8991 (91.0577%)
Done in 264.76640582084656 sec.
Server Epoch:10 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 553/597 (92.6298%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   2,  Average loss: 0.0026, Accuracy: 563/597 (94.3049%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   3,  Average loss: 0.0015, Accuracy: 577/597 (96.6499%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   4,  Average loss: 0.0008, Accuracy: 591/597 (98.9950%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   5,  Average loss: 0.0007, Accuracy: 590/597 (98.8275%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   6,  Average loss: 0.0006, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   7,  Average loss: 0.0005, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   8,  Average loss: 0.0004, Accuracy: 594/597 (99.4975%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   9,  Average loss: 0.0004, Accuracy: 595/597 (99.6650%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch  10,  Average loss: 0.0004, Accuracy: 595/597 (99.6650%), train_poison_data_count: 597
Global model norm: 15.057925974169041.
Norm before scaling: 15.228787036065734. Distance: 1.532638543044474
Total norm for 7 adversaries is: 15.228787036065734. distance: 1.532638543044474
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1416, Accuracy: 8602/8991 (95.6735%)
___Train Local_Simple,  epoch  10, local model 56, internal_epoch   1,  Average loss: 0.0072, Accuracy: 537/626 (85.7827%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.3091, Accuracy: 8992/10000 (89.9200%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   1,  Average loss: 0.0034, Accuracy: 519/552 (94.0217%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   2,  Average loss: 0.0017, Accuracy: 540/552 (97.8261%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   3,  Average loss: 0.0009, Accuracy: 546/552 (98.9130%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   4,  Average loss: 0.0006, Accuracy: 546/552 (98.9130%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   5,  Average loss: 0.0005, Accuracy: 548/552 (99.2754%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   6,  Average loss: 0.0004, Accuracy: 550/552 (99.6377%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   7,  Average loss: 0.0004, Accuracy: 551/552 (99.8188%), train_poison_data_count: 552
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   8,  Average loss: 0.0003, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   9,  Average loss: 0.0003, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch  10,  Average loss: 0.0003, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Global model norm: 15.057925974169041.
Norm before scaling: 15.184934799762786. Distance: 1.340858631183836
Total norm for 7 adversaries is: 15.184934799762786. distance: 1.340858631183836
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1715, Accuracy: 8502/8991 (94.5612%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0035, Accuracy: 600/644 (93.1677%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   2,  Average loss: 0.0039, Accuracy: 599/644 (93.0124%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 618/644 (95.9627%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   4,  Average loss: 0.0019, Accuracy: 620/644 (96.2733%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 630/644 (97.8261%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   6,  Average loss: 0.0011, Accuracy: 633/644 (98.2919%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   7,  Average loss: 0.0012, Accuracy: 635/644 (98.6025%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   8,  Average loss: 0.0008, Accuracy: 634/644 (98.4472%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   9,  Average loss: 0.0009, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch  10,  Average loss: 0.0007, Accuracy: 637/644 (98.9130%), train_poison_data_count: 644
Global model norm: 15.057925974169041.
Norm before scaling: 15.333744430559639. Distance: 2.215537956475689
Total norm for 7 adversaries is: 15.333744430559639. distance: 2.215537956475689
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1970, Accuracy: 8424/8991 (93.6937%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 488/521 (93.6660%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   2,  Average loss: 0.0031, Accuracy: 487/521 (93.4741%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   3,  Average loss: 0.0025, Accuracy: 504/521 (96.7370%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   4,  Average loss: 0.0017, Accuracy: 513/521 (98.4645%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   5,  Average loss: 0.0012, Accuracy: 512/521 (98.2726%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   6,  Average loss: 0.0011, Accuracy: 515/521 (98.8484%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   7,  Average loss: 0.0007, Accuracy: 515/521 (98.8484%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   8,  Average loss: 0.0006, Accuracy: 516/521 (99.0403%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   9,  Average loss: 0.0005, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch  10,  Average loss: 0.0006, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Global model norm: 15.057925974169041.
Norm before scaling: 15.190211929138725. Distance: 1.6704484076024462
Total norm for 7 adversaries is: 15.190211929138725. distance: 1.6704484076024462
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1610, Accuracy: 8528/8991 (94.8504%)
___Train Local_Simple,  epoch  10, local model 78, internal_epoch   1,  Average loss: 0.0088, Accuracy: 527/624 (84.4551%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.3045, Accuracy: 9067/10000 (90.6700%), Attack Success Rate:0/10000(0.000)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   1,  Average loss: 0.0033, Accuracy: 480/516 (93.0233%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   2,  Average loss: 0.0051, Accuracy: 468/516 (90.6977%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   3,  Average loss: 0.0023, Accuracy: 496/516 (96.1240%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   4,  Average loss: 0.0015, Accuracy: 503/516 (97.4806%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   5,  Average loss: 0.0012, Accuracy: 502/516 (97.2868%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   6,  Average loss: 0.0009, Accuracy: 507/516 (98.2558%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   7,  Average loss: 0.0007, Accuracy: 511/516 (99.0310%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   8,  Average loss: 0.0006, Accuracy: 513/516 (99.4186%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   9,  Average loss: 0.0006, Accuracy: 514/516 (99.6124%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch  10,  Average loss: 0.0006, Accuracy: 514/516 (99.6124%), train_poison_data_count: 516
Global model norm: 15.057925974169041.
Norm before scaling: 15.277548499650711. Distance: 1.7834398294302962
Total norm for 7 adversaries is: 15.277548499650711. distance: 1.7834398294302962
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1624, Accuracy: 8571/8991 (95.3287%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   1,  Average loss: 0.0040, Accuracy: 490/528 (92.8030%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   2,  Average loss: 0.0029, Accuracy: 504/528 (95.4545%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   3,  Average loss: 0.0022, Accuracy: 505/528 (95.6439%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   4,  Average loss: 0.0014, Accuracy: 516/528 (97.7273%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   5,  Average loss: 0.0011, Accuracy: 516/528 (97.7273%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   6,  Average loss: 0.0009, Accuracy: 518/528 (98.1061%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   7,  Average loss: 0.0007, Accuracy: 522/528 (98.8636%), train_poison_data_count: 528
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   8,  Average loss: 0.0006, Accuracy: 524/528 (99.2424%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   9,  Average loss: 0.0005, Accuracy: 524/528 (99.2424%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch  10,  Average loss: 0.0006, Accuracy: 524/528 (99.2424%), train_poison_data_count: 528
Global model norm: 15.057925974169041.
Norm before scaling: 15.193467212024107. Distance: 1.4281194039867455
Total norm for 7 adversaries is: 15.193467212024107. distance: 1.4281194039867455
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1532, Accuracy: 8582/8991 (95.4510%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0040, Accuracy: 496/535 (92.7103%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 509/535 (95.1402%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   3,  Average loss: 0.0014, Accuracy: 519/535 (97.0093%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   4,  Average loss: 0.0009, Accuracy: 530/535 (99.0654%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   5,  Average loss: 0.0008, Accuracy: 531/535 (99.2523%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   6,  Average loss: 0.0008, Accuracy: 532/535 (99.4393%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   7,  Average loss: 0.0006, Accuracy: 532/535 (99.4393%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   8,  Average loss: 0.0005, Accuracy: 532/535 (99.4393%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   9,  Average loss: 0.0004, Accuracy: 532/535 (99.4393%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch  10,  Average loss: 0.0004, Accuracy: 532/535 (99.4393%), train_poison_data_count: 535
Global model norm: 15.057925974169041.
Norm before scaling: 15.17349463950857. Distance: 1.3854464429748352
Total norm for 7 adversaries is: 15.17349463950857. distance: 1.3854464429748352
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1682, Accuracy: 8537/8991 (94.9505%)
___Train Local_Simple,  epoch  10, local model 99, internal_epoch   1,  Average loss: 0.0023, Accuracy: 389/410 (94.8780%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.0171, Accuracy: 7386/10000 (73.8600%), Attack Success Rate:0/10000(0.000)
time spent on training: 111.19565844535828
[foolsgold agg] training data poison_ratio: 0.7010624887448226  data num: [597, 626, 552, 644, 521, 624, 516, 528, 535, 410]
[foolsgold agg] considering poison per batch poison_fraction: 0.7010624887448226
[foolsgold agg] wv: [0.70910883 0.57435373 0.92968996 1.         0.92968996 0.57435373
 0.70910883 1.         0.95823609 1.        ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 1.1358, Accuracy: 8114/10000 (81.1400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 0.3915, Accuracy: 8107/8991 (90.1679%)
Done in 272.75998091697693 sec.
Server Epoch:11 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
___Train Local_Simple,  epoch  11, local model 53, internal_epoch   1,  Average loss: 0.0089, Accuracy: 534/617 (86.5478%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.4349, Accuracy: 8369/10000 (83.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 56, internal_epoch   1,  Average loss: 0.0081, Accuracy: 531/626 (84.8243%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.5543, Accuracy: 8161/10000 (81.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0137, Accuracy: 507/647 (78.3617%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3859, Accuracy: 8808/10000 (88.0800%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0058, Accuracy: 495/535 (92.5234%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 494/535 (92.3364%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   3,  Average loss: 0.0027, Accuracy: 508/535 (94.9533%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   4,  Average loss: 0.0014, Accuracy: 525/535 (98.1308%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   5,  Average loss: 0.0012, Accuracy: 527/535 (98.5047%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   6,  Average loss: 0.0009, Accuracy: 528/535 (98.6916%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   7,  Average loss: 0.0007, Accuracy: 531/535 (99.2523%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   8,  Average loss: 0.0006, Accuracy: 531/535 (99.2523%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   9,  Average loss: 0.0006, Accuracy: 531/535 (99.2523%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch  10,  Average loss: 0.0005, Accuracy: 531/535 (99.2523%), train_poison_data_count: 535
Global model norm: 15.176326204822935.
Norm before scaling: 15.345547386292903. Distance: 2.0154021383880054
Total norm for 5 adversaries is: 15.345547386292903. distance: 2.0154021383880054
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1696, Accuracy: 8515/8991 (94.7058%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   1,  Average loss: 0.0049, Accuracy: 482/520 (92.6923%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   2,  Average loss: 0.0030, Accuracy: 492/520 (94.6154%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   3,  Average loss: 0.0018, Accuracy: 500/520 (96.1538%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   4,  Average loss: 0.0012, Accuracy: 510/520 (98.0769%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   5,  Average loss: 0.0009, Accuracy: 513/520 (98.6538%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   6,  Average loss: 0.0008, Accuracy: 515/520 (99.0385%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   7,  Average loss: 0.0007, Accuracy: 516/520 (99.2308%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   8,  Average loss: 0.0006, Accuracy: 517/520 (99.4231%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   9,  Average loss: 0.0005, Accuracy: 517/520 (99.4231%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch  10,  Average loss: 0.0005, Accuracy: 517/520 (99.4231%), train_poison_data_count: 520
Global model norm: 15.176326204822935.
Norm before scaling: 15.298103883222751. Distance: 1.6652210482932754
Total norm for 5 adversaries is: 15.298103883222751. distance: 1.6652210482932754
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1477, Accuracy: 8573/8991 (95.3509%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0059, Accuracy: 630/708 (88.9831%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   2,  Average loss: 0.0033, Accuracy: 664/708 (93.7853%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   3,  Average loss: 0.0021, Accuracy: 676/708 (95.4802%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   4,  Average loss: 0.0010, Accuracy: 695/708 (98.1638%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   5,  Average loss: 0.0008, Accuracy: 698/708 (98.5876%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   6,  Average loss: 0.0007, Accuracy: 702/708 (99.1525%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   7,  Average loss: 0.0006, Accuracy: 701/708 (99.0113%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   8,  Average loss: 0.0005, Accuracy: 702/708 (99.1525%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   9,  Average loss: 0.0004, Accuracy: 704/708 (99.4350%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch  10,  Average loss: 0.0010, Accuracy: 704/708 (99.4350%), train_poison_data_count: 708
Global model norm: 15.176326204822935.
Norm before scaling: 15.541555504831736. Distance: 2.5811957365155975
Total norm for 5 adversaries is: 15.541555504831736. distance: 2.5811957365155975
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1273, Accuracy: 8628/8991 (95.9626%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0045, Accuracy: 444/478 (92.8870%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   2,  Average loss: 0.0025, Accuracy: 459/478 (96.0251%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   3,  Average loss: 0.0025, Accuracy: 459/478 (96.0251%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   4,  Average loss: 0.0009, Accuracy: 474/478 (99.1632%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   5,  Average loss: 0.0006, Accuracy: 473/478 (98.9540%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   6,  Average loss: 0.0006, Accuracy: 475/478 (99.3724%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   7,  Average loss: 0.0005, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   8,  Average loss: 0.0004, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   9,  Average loss: 0.0003, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch  10,  Average loss: 0.0003, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 15.176326204822935.
Norm before scaling: 15.307440470720389. Distance: 1.6768840015808162
Total norm for 5 adversaries is: 15.307440470720389. distance: 1.6768840015808162
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1643, Accuracy: 8540/8991 (94.9839%)
___Train Local_Simple,  epoch  11, local model 99, internal_epoch   1,  Average loss: 0.0046, Accuracy: 380/410 (92.6829%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.8420, Accuracy: 6311/10000 (63.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 88, internal_epoch   1,  Average loss: 0.0077, Accuracy: 584/679 (86.0088%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.4332, Accuracy: 8533/10000 (85.3300%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0048, Accuracy: 580/641 (90.4836%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   2,  Average loss: 0.0033, Accuracy: 596/641 (92.9797%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   3,  Average loss: 0.0011, Accuracy: 625/641 (97.5039%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   4,  Average loss: 0.0007, Accuracy: 634/641 (98.9080%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   5,  Average loss: 0.0006, Accuracy: 635/641 (99.0640%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   6,  Average loss: 0.0005, Accuracy: 636/641 (99.2200%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   7,  Average loss: 0.0004, Accuracy: 639/641 (99.6880%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   8,  Average loss: 0.0004, Accuracy: 639/641 (99.6880%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   9,  Average loss: 0.0003, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch  10,  Average loss: 0.0003, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Global model norm: 15.176326204822935.
Norm before scaling: 15.473804611354979. Distance: 2.389567122422439
Total norm for 5 adversaries is: 15.473804611354979. distance: 2.389567122422439
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.2054, Accuracy: 8424/8991 (93.6937%)
time spent on training: 93.83632731437683
[foolsgold agg] training data poison_ratio: 0.49172496161064666  data num: [617, 626, 647, 535, 520, 708, 478, 410, 679, 641]
[foolsgold agg] considering poison per batch poison_fraction: 0.49172496161064666
[foolsgold agg] wv: [0.21438126 0.29839007 0.21438126 0.84079443 0.84079443 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 1.2770, Accuracy: 8178/10000 (81.7800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 0.3886, Accuracy: 8178/8991 (90.9576%)
Done in 272.0401060581207 sec.
Server Epoch:12 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0077, Accuracy: 585/665 (87.9699%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   2,  Average loss: 0.0028, Accuracy: 639/665 (96.0902%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   3,  Average loss: 0.0017, Accuracy: 643/665 (96.6917%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   4,  Average loss: 0.0009, Accuracy: 653/665 (98.1955%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   5,  Average loss: 0.0006, Accuracy: 657/665 (98.7970%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   6,  Average loss: 0.0005, Accuracy: 659/665 (99.0977%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   7,  Average loss: 0.0004, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   8,  Average loss: 0.0004, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   9,  Average loss: 0.0003, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch  10,  Average loss: 0.0003, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Global model norm: 15.26801524195961.
Norm before scaling: 15.773266757836412. Distance: 3.3047700335069057
Total norm for 8 adversaries is: 15.773266757836412. distance: 3.3047700335069057
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1729, Accuracy: 8540/8991 (94.9839%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   1,  Average loss: 0.0026, Accuracy: 622/648 (95.9877%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   2,  Average loss: 0.0017, Accuracy: 629/648 (97.0679%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   3,  Average loss: 0.0007, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   5,  Average loss: 0.0005, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   8,  Average loss: 0.0003, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   9,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch  10,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Global model norm: 15.26801524195961.
Norm before scaling: 15.31088908538498. Distance: 1.5317399934242901
Total norm for 8 adversaries is: 15.31088908538498. distance: 1.5317399934242901
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1613, Accuracy: 8567/8991 (95.2842%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 533/580 (91.8966%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   2,  Average loss: 0.0030, Accuracy: 556/580 (95.8621%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   3,  Average loss: 0.0018, Accuracy: 563/580 (97.0690%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   4,  Average loss: 0.0011, Accuracy: 572/580 (98.6207%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   5,  Average loss: 0.0007, Accuracy: 574/580 (98.9655%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   6,  Average loss: 0.0006, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   7,  Average loss: 0.0005, Accuracy: 577/580 (99.4828%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   8,  Average loss: 0.0005, Accuracy: 578/580 (99.6552%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   9,  Average loss: 0.0004, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch  10,  Average loss: 0.0004, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Global model norm: 15.26801524195961.
Norm before scaling: 15.429083750054989. Distance: 2.0057071081979374
Total norm for 8 adversaries is: 15.429083750054989. distance: 2.0057071081979374
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1528, Accuracy: 8589/8991 (95.5289%)
___Train Local_Simple,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0108, Accuracy: 480/566 (84.8057%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4490, Accuracy: 8509/10000 (85.0900%), Attack Success Rate:0/10000(0.000)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 651/708 (91.9492%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   2,  Average loss: 0.0049, Accuracy: 643/708 (90.8192%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   3,  Average loss: 0.0020, Accuracy: 675/708 (95.3390%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   4,  Average loss: 0.0014, Accuracy: 691/708 (97.5989%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   5,  Average loss: 0.0011, Accuracy: 693/708 (97.8814%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   6,  Average loss: 0.0009, Accuracy: 698/708 (98.5876%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   7,  Average loss: 0.0007, Accuracy: 700/708 (98.8701%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   8,  Average loss: 0.0007, Accuracy: 702/708 (99.1525%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   9,  Average loss: 0.0005, Accuracy: 706/708 (99.7175%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch  10,  Average loss: 0.0006, Accuracy: 706/708 (99.7175%), train_poison_data_count: 708
Global model norm: 15.26801524195961.
Norm before scaling: 15.67068516482787. Distance: 2.8454004884759785
Total norm for 8 adversaries is: 15.67068516482787. distance: 2.8454004884759785
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1327, Accuracy: 8620/8991 (95.8737%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   1,  Average loss: 0.0054, Accuracy: 720/774 (93.0233%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   2,  Average loss: 0.0036, Accuracy: 721/774 (93.1525%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   3,  Average loss: 0.0012, Accuracy: 752/774 (97.1576%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   4,  Average loss: 0.0008, Accuracy: 761/774 (98.3204%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   5,  Average loss: 0.0006, Accuracy: 766/774 (98.9664%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   6,  Average loss: 0.0005, Accuracy: 766/774 (98.9664%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   7,  Average loss: 0.0004, Accuracy: 769/774 (99.3540%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   8,  Average loss: 0.0005, Accuracy: 771/774 (99.6124%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   9,  Average loss: 0.0003, Accuracy: 772/774 (99.7416%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch  10,  Average loss: 0.0004, Accuracy: 773/774 (99.8708%), train_poison_data_count: 774
Global model norm: 15.26801524195961.
Norm before scaling: 15.492238224040763. Distance: 2.3164963085557657
Total norm for 8 adversaries is: 15.492238224040763. distance: 2.3164963085557657
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1359, Accuracy: 8616/8991 (95.8292%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0058, Accuracy: 577/641 (90.0156%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   2,  Average loss: 0.0032, Accuracy: 603/641 (94.0718%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   3,  Average loss: 0.0013, Accuracy: 622/641 (97.0359%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   4,  Average loss: 0.0008, Accuracy: 633/641 (98.7520%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   5,  Average loss: 0.0007, Accuracy: 634/641 (98.9080%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   6,  Average loss: 0.0006, Accuracy: 636/641 (99.2200%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   7,  Average loss: 0.0005, Accuracy: 636/641 (99.2200%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   8,  Average loss: 0.0004, Accuracy: 638/641 (99.5320%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   9,  Average loss: 0.0005, Accuracy: 638/641 (99.5320%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch  10,  Average loss: 0.0004, Accuracy: 638/641 (99.5320%), train_poison_data_count: 641
Global model norm: 15.26801524195961.
Norm before scaling: 15.642390712644639. Distance: 2.7136600246475453
Total norm for 8 adversaries is: 15.642390712644639. distance: 2.7136600246475453
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.2052, Accuracy: 8458/8991 (94.0718%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   1,  Average loss: 0.0053, Accuracy: 481/518 (92.8571%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   2,  Average loss: 0.0029, Accuracy: 491/518 (94.7876%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   3,  Average loss: 0.0014, Accuracy: 505/518 (97.4903%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   4,  Average loss: 0.0010, Accuracy: 512/518 (98.8417%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   5,  Average loss: 0.0007, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   6,  Average loss: 0.0006, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   7,  Average loss: 0.0005, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   8,  Average loss: 0.0004, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   9,  Average loss: 0.0004, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch  10,  Average loss: 0.0004, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Global model norm: 15.26801524195961.
Norm before scaling: 15.431530744332568. Distance: 2.0092497553733266
Total norm for 8 adversaries is: 15.431530744332568. distance: 2.0092497553733266
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1403, Accuracy: 8591/8991 (95.5511%)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0133, Accuracy: 415/519 (79.9615%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.5744, Accuracy: 8329/10000 (83.2900%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0052, Accuracy: 532/587 (90.6303%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   2,  Average loss: 0.0030, Accuracy: 545/587 (92.8450%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   3,  Average loss: 0.0015, Accuracy: 576/587 (98.1261%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   4,  Average loss: 0.0008, Accuracy: 581/587 (98.9779%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   5,  Average loss: 0.0007, Accuracy: 582/587 (99.1482%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   6,  Average loss: 0.0006, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   7,  Average loss: 0.0005, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   8,  Average loss: 0.0004, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   9,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch  10,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Global model norm: 15.26801524195961.
Norm before scaling: 15.485187959549542. Distance: 2.1183584430966165
Total norm for 8 adversaries is: 15.485187959549542. distance: 2.1183584430966165
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1361, Accuracy: 8629/8991 (95.9738%)
time spent on training: 125.36614179611206
[foolsgold agg] training data poison_ratio: 0.8251691911053819  data num: [665, 648, 580, 566, 708, 774, 641, 518, 519, 587]
[foolsgold agg] considering poison per batch poison_fraction: 0.8251691911053819
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.5750, Accuracy: 8340/10000 (83.4000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 0.3618, Accuracy: 8330/8991 (92.6482%)
Done in 299.05736088752747 sec.
Server Epoch:13 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0051, Accuracy: 530/578 (91.6955%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   2,  Average loss: 0.0028, Accuracy: 548/578 (94.8097%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   3,  Average loss: 0.0025, Accuracy: 551/578 (95.3287%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   4,  Average loss: 0.0014, Accuracy: 563/578 (97.4048%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   5,  Average loss: 0.0009, Accuracy: 570/578 (98.6159%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   6,  Average loss: 0.0007, Accuracy: 571/578 (98.7889%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   7,  Average loss: 0.0006, Accuracy: 572/578 (98.9619%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   8,  Average loss: 0.0005, Accuracy: 572/578 (98.9619%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   9,  Average loss: 0.0005, Accuracy: 573/578 (99.1349%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch  10,  Average loss: 0.0005, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Global model norm: 15.419297332388703.
Norm before scaling: 15.581562669220432. Distance: 2.3745526344183334
Total norm for 6 adversaries is: 15.581562669220432. distance: 2.3745526344183334
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1463, Accuracy: 8574/8991 (95.3620%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   1,  Average loss: 0.0065, Accuracy: 716/774 (92.5065%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   2,  Average loss: 0.0035, Accuracy: 712/774 (91.9897%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   3,  Average loss: 0.0013, Accuracy: 756/774 (97.6744%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   4,  Average loss: 0.0009, Accuracy: 762/774 (98.4496%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   5,  Average loss: 0.0007, Accuracy: 765/774 (98.8372%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   6,  Average loss: 0.0009, Accuracy: 767/774 (99.0956%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   7,  Average loss: 0.0005, Accuracy: 771/774 (99.6124%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   8,  Average loss: 0.0004, Accuracy: 771/774 (99.6124%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   9,  Average loss: 0.0004, Accuracy: 772/774 (99.7416%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch  10,  Average loss: 0.0004, Accuracy: 772/774 (99.7416%), train_poison_data_count: 774
Global model norm: 15.419297332388703.
Norm before scaling: 15.763456378816034. Distance: 2.97806108852469
Total norm for 6 adversaries is: 15.763456378816034. distance: 2.97806108852469
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1463, Accuracy: 8603/8991 (95.6846%)
___Train Local_Simple,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0116, Accuracy: 501/618 (81.0680%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4502, Accuracy: 8690/10000 (86.9000%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 536/572 (93.7063%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   2,  Average loss: 0.0023, Accuracy: 543/572 (94.9301%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   3,  Average loss: 0.0018, Accuracy: 556/572 (97.2028%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   4,  Average loss: 0.0013, Accuracy: 560/572 (97.9021%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   5,  Average loss: 0.0010, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   6,  Average loss: 0.0008, Accuracy: 567/572 (99.1259%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   7,  Average loss: 0.0006, Accuracy: 568/572 (99.3007%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   8,  Average loss: 0.0005, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   9,  Average loss: 0.0004, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch  10,  Average loss: 0.0004, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Global model norm: 15.419297332388703.
Norm before scaling: 15.468260231356368. Distance: 1.918628524762124
Total norm for 6 adversaries is: 15.468260231356368. distance: 1.918628524762124
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1324, Accuracy: 8612/8991 (95.7847%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 589/644 (91.4596%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 577/644 (89.5963%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   3,  Average loss: 0.0020, Accuracy: 624/644 (96.8944%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 630/644 (97.8261%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 633/644 (98.2919%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   6,  Average loss: 0.0011, Accuracy: 632/644 (98.1366%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   7,  Average loss: 0.0009, Accuracy: 637/644 (98.9130%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   8,  Average loss: 0.0008, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   9,  Average loss: 0.0007, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch  10,  Average loss: 0.0007, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Global model norm: 15.419297332388703.
Norm before scaling: 15.686389169460933. Distance: 2.9540174639372214
Total norm for 6 adversaries is: 15.686389169460933. distance: 2.9540174639372214
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1859, Accuracy: 8484/8991 (94.3610%)
___Train Local_Simple,  epoch  13, local model 76, internal_epoch   1,  Average loss: 0.0129, Accuracy: 417/518 (80.5019%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5874, Accuracy: 8093/10000 (80.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 97, internal_epoch   1,  Average loss: 0.0200, Accuracy: 452/588 (76.8707%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1737, Accuracy: 7056/10000 (70.5600%), Attack Success Rate:0/10000(0.000)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 509/550 (92.5455%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   2,  Average loss: 0.0035, Accuracy: 511/550 (92.9091%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   3,  Average loss: 0.0027, Accuracy: 524/550 (95.2727%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   4,  Average loss: 0.0014, Accuracy: 544/550 (98.9091%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   5,  Average loss: 0.0010, Accuracy: 544/550 (98.9091%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   6,  Average loss: 0.0008, Accuracy: 547/550 (99.4545%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   7,  Average loss: 0.0006, Accuracy: 547/550 (99.4545%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   8,  Average loss: 0.0005, Accuracy: 548/550 (99.6364%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   9,  Average loss: 0.0005, Accuracy: 548/550 (99.6364%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch  10,  Average loss: 0.0005, Accuracy: 548/550 (99.6364%), train_poison_data_count: 550
Global model norm: 15.419297332388703.
Norm before scaling: 15.548922701987518. Distance: 1.971439945936462
Total norm for 6 adversaries is: 15.548922701987518. distance: 1.971439945936462
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1393, Accuracy: 8597/8991 (95.6178%)
___Train Local_Simple,  epoch  13, local model 70, internal_epoch   1,  Average loss: 0.0162, Accuracy: 439/549 (79.9636%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7488, Accuracy: 7775/10000 (77.7500%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 495/535 (92.5234%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   2,  Average loss: 0.0040, Accuracy: 495/535 (92.5234%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   3,  Average loss: 0.0035, Accuracy: 507/535 (94.7664%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   4,  Average loss: 0.0020, Accuracy: 520/535 (97.1963%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   5,  Average loss: 0.0015, Accuracy: 524/535 (97.9439%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   6,  Average loss: 0.0010, Accuracy: 527/535 (98.5047%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   7,  Average loss: 0.0008, Accuracy: 527/535 (98.5047%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   8,  Average loss: 0.0007, Accuracy: 528/535 (98.6916%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   9,  Average loss: 0.0006, Accuracy: 530/535 (99.0654%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch  10,  Average loss: 0.0006, Accuracy: 530/535 (99.0654%), train_poison_data_count: 535
Global model norm: 15.419297332388703.
Norm before scaling: 15.58845971524914. Distance: 2.288060616757303
Total norm for 6 adversaries is: 15.58845971524914. distance: 2.288060616757303
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1652, Accuracy: 8551/8991 (95.1062%)
time spent on training: 107.47724795341492
[foolsgold agg] training data poison_ratio: 0.6164360445494431  data num: [578, 774, 618, 572, 644, 518, 588, 550, 549, 535]
[foolsgold agg] considering poison per batch poison_fraction: 0.6164360445494431
[foolsgold agg] wv: [0.7920554  1.         1.         1.         0.83615451 1.
 0.         0.7920554  0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.9540, Accuracy: 8329/10000 (83.2900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 0.4158, Accuracy: 8317/8991 (92.5036%)
Done in 278.28646183013916 sec.
Server Epoch:14 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0223, Accuracy: 399/532 (75.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2552, Accuracy: 6466/10000 (64.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 97, internal_epoch   1,  Average loss: 0.0225, Accuracy: 403/588 (68.5374%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0711, Accuracy: 7053/10000 (70.5300%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0073, Accuracy: 540/597 (90.4523%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   2,  Average loss: 0.0038, Accuracy: 554/597 (92.7973%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   3,  Average loss: 0.0022, Accuracy: 579/597 (96.9849%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   4,  Average loss: 0.0012, Accuracy: 584/597 (97.8224%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   5,  Average loss: 0.0010, Accuracy: 583/597 (97.6549%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   6,  Average loss: 0.0008, Accuracy: 586/597 (98.1575%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   7,  Average loss: 0.0007, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   8,  Average loss: 0.0006, Accuracy: 594/597 (99.4975%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   9,  Average loss: 0.0006, Accuracy: 594/597 (99.4975%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch  10,  Average loss: 0.0006, Accuracy: 594/597 (99.4975%), train_poison_data_count: 597
Global model norm: 15.539104724364451.
Norm before scaling: 15.829415783683691. Distance: 2.9707583410384646
Total norm for 4 adversaries is: 15.829415783683691. distance: 2.9707583410384646
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1306, Accuracy: 8622/8991 (95.8959%)
___Train Local_Simple,  epoch  14, local model 89, internal_epoch   1,  Average loss: 0.0136, Accuracy: 549/664 (82.6807%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3848, Accuracy: 8918/10000 (89.1800%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0064, Accuracy: 536/582 (92.0962%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   2,  Average loss: 0.0040, Accuracy: 539/582 (92.6117%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   3,  Average loss: 0.0023, Accuracy: 557/582 (95.7045%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   4,  Average loss: 0.0016, Accuracy: 570/582 (97.9381%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   5,  Average loss: 0.0015, Accuracy: 574/582 (98.6254%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   6,  Average loss: 0.0012, Accuracy: 575/582 (98.7973%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   7,  Average loss: 0.0010, Accuracy: 579/582 (99.4845%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   8,  Average loss: 0.0006, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   9,  Average loss: 0.0006, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch  10,  Average loss: 0.0006, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Global model norm: 15.539104724364451.
Norm before scaling: 15.738772795749068. Distance: 2.6658421274819006
Total norm for 4 adversaries is: 15.738772795749068. distance: 2.6658421274819006
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1306, Accuracy: 8618/8991 (95.8514%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   1,  Average loss: 0.0051, Accuracy: 499/528 (94.5076%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   2,  Average loss: 0.0036, Accuracy: 494/528 (93.5606%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   3,  Average loss: 0.0029, Accuracy: 510/528 (96.5909%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   4,  Average loss: 0.0016, Accuracy: 515/528 (97.5379%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   5,  Average loss: 0.0012, Accuracy: 520/528 (98.4848%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   6,  Average loss: 0.0010, Accuracy: 522/528 (98.8636%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   7,  Average loss: 0.0008, Accuracy: 524/528 (99.2424%), train_poison_data_count: 528
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   8,  Average loss: 0.0006, Accuracy: 526/528 (99.6212%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   9,  Average loss: 0.0005, Accuracy: 526/528 (99.6212%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch  10,  Average loss: 0.0006, Accuracy: 526/528 (99.6212%), train_poison_data_count: 528
Global model norm: 15.539104724364451.
Norm before scaling: 15.592116765359647. Distance: 2.2423579453603857
Total norm for 4 adversaries is: 15.592116765359647. distance: 2.2423579453603857
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1307, Accuracy: 8623/8991 (95.9070%)
___Train Local_Simple,  epoch  14, local model 55, internal_epoch   1,  Average loss: 0.0132, Accuracy: 490/592 (82.7703%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.5523, Accuracy: 8466/10000 (84.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 67, internal_epoch   1,  Average loss: 0.0145, Accuracy: 530/643 (82.4261%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.7788, Accuracy: 7717/10000 (77.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0155, Accuracy: 489/626 (78.1150%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4528, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 518/580 (89.3103%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   2,  Average loss: 0.0052, Accuracy: 520/580 (89.6552%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   3,  Average loss: 0.0028, Accuracy: 551/580 (95.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   4,  Average loss: 0.0015, Accuracy: 570/580 (98.2759%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   5,  Average loss: 0.0014, Accuracy: 570/580 (98.2759%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   6,  Average loss: 0.0008, Accuracy: 573/580 (98.7931%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   7,  Average loss: 0.0007, Accuracy: 575/580 (99.1379%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   8,  Average loss: 0.0006, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   9,  Average loss: 0.0008, Accuracy: 577/580 (99.4828%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch  10,  Average loss: 0.0005, Accuracy: 577/580 (99.4828%), train_poison_data_count: 580
Global model norm: 15.539104724364451.
Norm before scaling: 15.991710422781352. Distance: 3.4635067739617327
Total norm for 4 adversaries is: 15.991710422781352. distance: 3.4635067739617327
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1536, Accuracy: 8572/8991 (95.3398%)
time spent on training: 83.6117651462555
[foolsgold agg] training data poison_ratio: 0.38553607552258934  data num: [532, 588, 597, 664, 582, 528, 592, 643, 626, 580]
[foolsgold agg] considering poison per batch poison_fraction: 0.38553607552258934
[foolsgold agg] wv: [1.         0.57050678 0.83412108 0.         0.83412108 1.
 1.         0.         0.85463866 1.        ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.8194, Accuracy: 8420/10000 (84.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.3679, Accuracy: 8410/8991 (93.5380%)
Done in 252.1576759815216 sec.
Server Epoch:15 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 549/587 (93.5264%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   2,  Average loss: 0.0037, Accuracy: 541/587 (92.1635%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   3,  Average loss: 0.0021, Accuracy: 563/587 (95.9114%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   4,  Average loss: 0.0012, Accuracy: 578/587 (98.4668%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   5,  Average loss: 0.0009, Accuracy: 580/587 (98.8075%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   6,  Average loss: 0.0008, Accuracy: 582/587 (99.1482%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   7,  Average loss: 0.0005, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   8,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   9,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch  10,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Global model norm: 15.630576641552958.
Norm before scaling: 15.791514588012083. Distance: 2.4808702038874135
Total norm for 7 adversaries is: 15.791514588012083. distance: 2.4808702038874135
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1437, Accuracy: 8612/8991 (95.7847%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0089, Accuracy: 543/606 (89.6040%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   2,  Average loss: 0.0048, Accuracy: 562/606 (92.7393%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   3,  Average loss: 0.0019, Accuracy: 580/606 (95.7096%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   4,  Average loss: 0.0014, Accuracy: 593/606 (97.8548%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   5,  Average loss: 0.0012, Accuracy: 597/606 (98.5149%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   6,  Average loss: 0.0009, Accuracy: 599/606 (98.8449%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   7,  Average loss: 0.0008, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   8,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   9,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch  10,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Global model norm: 15.630576641552958.
Norm before scaling: 16.01178116982832. Distance: 3.479206854003765
Total norm for 7 adversaries is: 16.01178116982832. distance: 3.479206854003765
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1477, Accuracy: 8554/8991 (95.1396%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   1,  Average loss: 0.0077, Accuracy: 486/553 (87.8843%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   2,  Average loss: 0.0036, Accuracy: 521/553 (94.2134%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   3,  Average loss: 0.0022, Accuracy: 536/553 (96.9259%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   4,  Average loss: 0.0016, Accuracy: 541/553 (97.8300%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   5,  Average loss: 0.0013, Accuracy: 546/553 (98.7342%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   6,  Average loss: 0.0011, Accuracy: 546/553 (98.7342%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   7,  Average loss: 0.0010, Accuracy: 547/553 (98.9150%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   8,  Average loss: 0.0008, Accuracy: 548/553 (99.0958%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   9,  Average loss: 0.0007, Accuracy: 548/553 (99.0958%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch  10,  Average loss: 0.0007, Accuracy: 548/553 (99.0958%), train_poison_data_count: 553
Global model norm: 15.630576641552958.
Norm before scaling: 15.801491022377396. Distance: 2.580071009612397
Total norm for 7 adversaries is: 15.801491022377396. distance: 2.580071009612397
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1240, Accuracy: 8658/8991 (96.2963%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   1,  Average loss: 0.0057, Accuracy: 547/589 (92.8693%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   2,  Average loss: 0.0041, Accuracy: 550/589 (93.3786%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   3,  Average loss: 0.0023, Accuracy: 572/589 (97.1138%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   4,  Average loss: 0.0018, Accuracy: 576/589 (97.7929%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   5,  Average loss: 0.0012, Accuracy: 581/589 (98.6418%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   6,  Average loss: 0.0011, Accuracy: 581/589 (98.6418%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   7,  Average loss: 0.0010, Accuracy: 582/589 (98.8115%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   8,  Average loss: 0.0008, Accuracy: 583/589 (98.9813%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   9,  Average loss: 0.0008, Accuracy: 585/589 (99.3209%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch  10,  Average loss: 0.0006, Accuracy: 585/589 (99.3209%), train_poison_data_count: 589
Global model norm: 15.630576641552958.
Norm before scaling: 15.783212671889515. Distance: 2.9178657973178317
Total norm for 7 adversaries is: 15.783212671889515. distance: 2.9178657973178317
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1679, Accuracy: 8514/8991 (94.6947%)
___Train Local_Simple,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0108, Accuracy: 503/592 (84.9662%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4821, Accuracy: 8544/10000 (85.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 98, internal_epoch   1,  Average loss: 0.0109, Accuracy: 490/568 (86.2676%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8996, Accuracy: 7822/10000 (78.2200%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   1,  Average loss: 0.0065, Accuracy: 607/650 (93.3846%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   2,  Average loss: 0.0065, Accuracy: 572/650 (88.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   3,  Average loss: 0.0035, Accuracy: 613/650 (94.3077%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   4,  Average loss: 0.0021, Accuracy: 623/650 (95.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   5,  Average loss: 0.0016, Accuracy: 631/650 (97.0769%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   6,  Average loss: 0.0014, Accuracy: 635/650 (97.6923%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   7,  Average loss: 0.0011, Accuracy: 639/650 (98.3077%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   8,  Average loss: 0.0010, Accuracy: 642/650 (98.7692%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   9,  Average loss: 0.0008, Accuracy: 644/650 (99.0769%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch  10,  Average loss: 0.0008, Accuracy: 644/650 (99.0769%), train_poison_data_count: 650
Global model norm: 15.630576641552958.
Norm before scaling: 16.001053775418296. Distance: 3.5499785033099007
Total norm for 7 adversaries is: 16.001053775418296. distance: 3.5499785033099007
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1381, Accuracy: 8591/8991 (95.5511%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0056, Accuracy: 612/665 (92.0301%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   2,  Average loss: 0.0025, Accuracy: 641/665 (96.3910%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   3,  Average loss: 0.0021, Accuracy: 643/665 (96.6917%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   4,  Average loss: 0.0011, Accuracy: 654/665 (98.3459%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   5,  Average loss: 0.0007, Accuracy: 660/665 (99.2481%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   6,  Average loss: 0.0005, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   7,  Average loss: 0.0004, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   8,  Average loss: 0.0003, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   9,  Average loss: 0.0003, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch  10,  Average loss: 0.0003, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 15.630576641552958.
Norm before scaling: 15.821812236012683. Distance: 2.570383644858602
Total norm for 7 adversaries is: 15.821812236012683. distance: 2.570383644858602
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1393, Accuracy: 8610/8991 (95.7624%)
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0130, Accuracy: 507/609 (83.2512%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5236, Accuracy: 8369/10000 (83.6900%), Attack Success Rate:0/10000(0.000)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   1,  Average loss: 0.0055, Accuracy: 475/518 (91.6988%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   2,  Average loss: 0.0069, Accuracy: 467/518 (90.1544%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   3,  Average loss: 0.0042, Accuracy: 488/518 (94.2085%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   4,  Average loss: 0.0026, Accuracy: 496/518 (95.7529%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   5,  Average loss: 0.0018, Accuracy: 504/518 (97.2973%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   6,  Average loss: 0.0013, Accuracy: 511/518 (98.6486%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   7,  Average loss: 0.0009, Accuracy: 512/518 (98.8417%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   8,  Average loss: 0.0007, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   9,  Average loss: 0.0006, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch  10,  Average loss: 0.0006, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Global model norm: 15.630576641552958.
Norm before scaling: 15.924518399464482. Distance: 3.1034868934026405
Total norm for 7 adversaries is: 15.924518399464482. distance: 3.1034868934026405
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1339, Accuracy: 8598/8991 (95.6290%)
time spent on training: 115.65871596336365
[foolsgold agg] training data poison_ratio: 0.7020380663634832  data num: [587, 606, 553, 589, 592, 568, 650, 665, 609, 518]
[foolsgold agg] considering poison per batch poison_fraction: 0.7020380663634832
[foolsgold agg] wv: [1.         1.         1.         1.         0.60418276 0.60418276
 1.         0.7669762  1.         0.7669762 ]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 2.0668, Accuracy: 8465/10000 (84.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.3868, Accuracy: 8455/8991 (94.0385%)
Done in 282.6330189704895 sec.
Server Epoch:16 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0086, Accuracy: 520/582 (89.3471%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   2,  Average loss: 0.0033, Accuracy: 548/582 (94.1581%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   3,  Average loss: 0.0026, Accuracy: 561/582 (96.3918%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   4,  Average loss: 0.0014, Accuracy: 571/582 (98.1100%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   5,  Average loss: 0.0012, Accuracy: 570/582 (97.9381%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   6,  Average loss: 0.0010, Accuracy: 574/582 (98.6254%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   7,  Average loss: 0.0009, Accuracy: 576/582 (98.9691%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   8,  Average loss: 0.0006, Accuracy: 577/582 (99.1409%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   9,  Average loss: 0.0006, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch  10,  Average loss: 0.0005, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Global model norm: 15.790881188551117.
Norm before scaling: 16.1465230027435. Distance: 3.55377252561533
Total norm for 4 adversaries is: 16.1465230027435. distance: 3.55377252561533
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1159, Accuracy: 8659/8991 (96.3074%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0083, Accuracy: 614/683 (89.8975%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   2,  Average loss: 0.0040, Accuracy: 643/683 (94.1435%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   3,  Average loss: 0.0020, Accuracy: 663/683 (97.0717%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   4,  Average loss: 0.0015, Accuracy: 666/683 (97.5110%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   5,  Average loss: 0.0012, Accuracy: 665/683 (97.3646%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   6,  Average loss: 0.0010, Accuracy: 670/683 (98.0966%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   7,  Average loss: 0.0009, Accuracy: 674/683 (98.6823%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   8,  Average loss: 0.0008, Accuracy: 676/683 (98.9751%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   9,  Average loss: 0.0007, Accuracy: 678/683 (99.2679%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch  10,  Average loss: 0.0007, Accuracy: 678/683 (99.2679%), train_poison_data_count: 683
Global model norm: 15.790881188551117.
Norm before scaling: 16.168230643113247. Distance: 3.6201723772178975
Total norm for 4 adversaries is: 16.168230643113247. distance: 3.6201723772178975
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1338, Accuracy: 8605/8991 (95.7068%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0099, Accuracy: 527/597 (88.2747%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   2,  Average loss: 0.0071, Accuracy: 524/597 (87.7722%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   3,  Average loss: 0.0038, Accuracy: 560/597 (93.8023%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   4,  Average loss: 0.0025, Accuracy: 572/597 (95.8124%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   5,  Average loss: 0.0021, Accuracy: 578/597 (96.8174%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   6,  Average loss: 0.0020, Accuracy: 579/597 (96.9849%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   7,  Average loss: 0.0015, Accuracy: 582/597 (97.4874%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   8,  Average loss: 0.0014, Accuracy: 584/597 (97.8224%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   9,  Average loss: 0.0012, Accuracy: 585/597 (97.9899%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch  10,  Average loss: 0.0011, Accuracy: 585/597 (97.9899%), train_poison_data_count: 597
Global model norm: 15.790881188551117.
Norm before scaling: 16.629208598525704. Distance: 5.122975763779245
Total norm for 4 adversaries is: 16.629208598525704. distance: 5.122975763779245
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1553, Accuracy: 8568/8991 (95.2953%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0203, Accuracy: 341/410 (83.1707%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.4405, Accuracy: 5965/10000 (59.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0124, Accuracy: 518/617 (83.9546%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6190, Accuracy: 8258/10000 (82.5800%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 493/526 (93.7262%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   2,  Average loss: 0.0057, Accuracy: 489/526 (92.9658%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   3,  Average loss: 0.0024, Accuracy: 511/526 (97.1483%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   4,  Average loss: 0.0016, Accuracy: 516/526 (98.0989%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   5,  Average loss: 0.0013, Accuracy: 518/526 (98.4791%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   6,  Average loss: 0.0010, Accuracy: 521/526 (99.0494%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   7,  Average loss: 0.0009, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   8,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   9,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch  10,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Global model norm: 15.790881188551117.
Norm before scaling: 15.936542078289316. Distance: 2.742315305682191
Total norm for 4 adversaries is: 15.936542078289316. distance: 2.742315305682191
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1492, Accuracy: 8575/8991 (95.3732%)
___Train Local_Simple,  epoch  16, local model 60, internal_epoch   1,  Average loss: 0.0325, Accuracy: 421/644 (65.3727%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.2426, Accuracy: 5559/10000 (55.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 63, internal_epoch   1,  Average loss: 0.0322, Accuracy: 369/616 (59.9026%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.5127, Accuracy: 5216/10000 (52.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 52, internal_epoch   1,  Average loss: 0.0157, Accuracy: 508/618 (82.2006%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4225, Accuracy: 9042/10000 (90.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 90, internal_epoch   1,  Average loss: 0.0207, Accuracy: 428/577 (74.1768%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.1672, Accuracy: 5520/10000 (55.2000%), Attack Success Rate:1/10000(0.010)
time spent on training: 84.95953512191772
[foolsgold agg] training data poison_ratio: 0.40681431005110735  data num: [582, 683, 597, 410, 617, 526, 644, 616, 618, 577]
[foolsgold agg] considering poison per batch poison_fraction: 0.40681431005110735
[foolsgold agg] wv: [0.69485033 1.         0.69485033 1.         0.         1.
 0.80123689 1.         0.         0.57126498]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 1.3664, Accuracy: 8571/10000 (85.7100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.3045, Accuracy: 8553/8991 (95.1285%)
Done in 253.90711998939514 sec.
Server Epoch:17 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0146, Accuracy: 504/629 (80.1272%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6145, Accuracy: 8244/10000 (82.4400%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   1,  Average loss: 0.0035, Accuracy: 604/638 (94.6708%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   2,  Average loss: 0.0017, Accuracy: 615/638 (96.3950%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   3,  Average loss: 0.0011, Accuracy: 625/638 (97.9624%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   4,  Average loss: 0.0005, Accuracy: 636/638 (99.6865%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   5,  Average loss: 0.0003, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   6,  Average loss: 0.0003, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   8,  Average loss: 0.0002, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch  10,  Average loss: 0.0002, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 15.86482838044634.
Norm before scaling: 15.890006114269543. Distance: 2.0687429560515462
Total norm for 4 adversaries is: 15.890006114269543. distance: 2.0687429560515462
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1127, Accuracy: 8679/8991 (96.5299%)
___Train Local_Simple,  epoch  17, local model 56, internal_epoch   1,  Average loss: 0.0081, Accuracy: 551/626 (88.0192%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3488, Accuracy: 8810/10000 (88.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 97, internal_epoch   1,  Average loss: 0.0112, Accuracy: 488/588 (82.9932%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8061, Accuracy: 7690/10000 (76.9000%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0044, Accuracy: 543/572 (94.9301%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0035, Accuracy: 532/572 (93.0070%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   3,  Average loss: 0.0017, Accuracy: 554/572 (96.8531%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   4,  Average loss: 0.0011, Accuracy: 563/572 (98.4266%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   5,  Average loss: 0.0008, Accuracy: 567/572 (99.1259%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   6,  Average loss: 0.0006, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   7,  Average loss: 0.0005, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   8,  Average loss: 0.0004, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   9,  Average loss: 0.0004, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch  10,  Average loss: 0.0004, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Global model norm: 15.86482838044634.
Norm before scaling: 15.885453754652744. Distance: 2.298500990622811
Total norm for 4 adversaries is: 15.885453754652744. distance: 2.298500990622811
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1306, Accuracy: 8628/8991 (95.9626%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 497/521 (95.3935%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   2,  Average loss: 0.0019, Accuracy: 500/521 (95.9693%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   3,  Average loss: 0.0010, Accuracy: 513/521 (98.4645%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   4,  Average loss: 0.0007, Accuracy: 519/521 (99.6161%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   5,  Average loss: 0.0005, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   6,  Average loss: 0.0003, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   7,  Average loss: 0.0003, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   8,  Average loss: 0.0002, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   9,  Average loss: 0.0002, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch  10,  Average loss: 0.0002, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 15.86482838044634.
Norm before scaling: 15.830246206117234. Distance: 2.0795303984701983
Total norm for 4 adversaries is: 15.830246206117234. distance: 2.0795303984701983
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1176, Accuracy: 8657/8991 (96.2852%)
___Train Local_Simple,  epoch  17, local model 77, internal_epoch   1,  Average loss: 0.0145, Accuracy: 427/519 (82.2736%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6864, Accuracy: 7780/10000 (77.8000%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0046, Accuracy: 597/641 (93.1357%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   2,  Average loss: 0.0033, Accuracy: 601/641 (93.7598%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   3,  Average loss: 0.0051, Accuracy: 577/641 (90.0156%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   4,  Average loss: 0.0012, Accuracy: 628/641 (97.9719%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   5,  Average loss: 0.0014, Accuracy: 634/641 (98.9080%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   6,  Average loss: 0.0007, Accuracy: 635/641 (99.0640%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   7,  Average loss: 0.0006, Accuracy: 637/641 (99.3760%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   8,  Average loss: 0.0004, Accuracy: 639/641 (99.6880%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   9,  Average loss: 0.0003, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch  10,  Average loss: 0.0003, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Global model norm: 15.86482838044634.
Norm before scaling: 16.054230338685755. Distance: 2.7973876994674143
Total norm for 4 adversaries is: 16.054230338685755. distance: 2.7973876994674143
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1505, Accuracy: 8574/8991 (95.3620%)
___Train Local_Simple,  epoch  17, local model 90, internal_epoch   1,  Average loss: 0.0221, Accuracy: 433/577 (75.0433%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.2374, Accuracy: 6938/10000 (69.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0064, Accuracy: 586/652 (89.8773%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2901, Accuracy: 9099/10000 (90.9900%), Attack Success Rate:0/10000(0.000)
time spent on training: 87.4050178527832
[foolsgold agg] training data poison_ratio: 0.39778634915311084  data num: [629, 638, 626, 588, 572, 521, 519, 641, 577, 652]
[foolsgold agg] considering poison per batch poison_fraction: 0.39778634915311084
[foolsgold agg] wv: [0.76718555 1.         1.         1.         1.         1.
 0.76718555 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.7468, Accuracy: 8633/10000 (86.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.2413, Accuracy: 8605/8991 (95.7068%)
Done in 254.8459939956665 sec.
Server Epoch:18 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0064, Accuracy: 532/592 (89.8649%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5192, Accuracy: 8334/10000 (83.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0075, Accuracy: 441/510 (86.4706%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4932, Accuracy: 8449/10000 (84.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 88, internal_epoch   1,  Average loss: 0.0068, Accuracy: 598/679 (88.0707%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3906, Accuracy: 8773/10000 (87.7300%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0051, Accuracy: 555/588 (94.3878%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   2,  Average loss: 0.0028, Accuracy: 555/588 (94.3878%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   3,  Average loss: 0.0013, Accuracy: 574/588 (97.6190%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   4,  Average loss: 0.0011, Accuracy: 580/588 (98.6395%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   5,  Average loss: 0.0009, Accuracy: 581/588 (98.8095%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   6,  Average loss: 0.0007, Accuracy: 582/588 (98.9796%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   7,  Average loss: 0.0006, Accuracy: 584/588 (99.3197%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   8,  Average loss: 0.0005, Accuracy: 585/588 (99.4898%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   9,  Average loss: 0.0004, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch  10,  Average loss: 0.0004, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Global model norm: 15.909891067793723.
Norm before scaling: 15.97546078490505. Distance: 2.375594315705803
Total norm for 2 adversaries is: 15.97546078490505. distance: 2.375594315705803
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1251, Accuracy: 8620/8991 (95.8737%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   1,  Average loss: 0.0028, Accuracy: 478/503 (95.0298%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   2,  Average loss: 0.0021, Accuracy: 473/503 (94.0358%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   3,  Average loss: 0.0012, Accuracy: 486/503 (96.6203%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   4,  Average loss: 0.0004, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   5,  Average loss: 0.0003, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   6,  Average loss: 0.0002, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 15.909891067793723.
Norm before scaling: 15.929272251974949. Distance: 1.6204588600499112
Total norm for 2 adversaries is: 15.929272251974949. distance: 1.6204588600499112
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1267, Accuracy: 8668/8991 (96.4075%)
___Train Local_Simple,  epoch  18, local model 75, internal_epoch   1,  Average loss: 0.0070, Accuracy: 495/554 (89.3502%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2900, Accuracy: 9142/10000 (91.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 82, internal_epoch   1,  Average loss: 0.0082, Accuracy: 537/621 (86.4734%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3457, Accuracy: 8913/10000 (89.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0074, Accuracy: 473/537 (88.0819%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2971, Accuracy: 9087/10000 (90.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 95, internal_epoch   1,  Average loss: 0.0085, Accuracy: 464/532 (87.2180%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6725, Accuracy: 7954/10000 (79.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0062, Accuracy: 475/529 (89.7921%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6000, Accuracy: 8124/10000 (81.2400%), Attack Success Rate:0/10000(0.000)
time spent on training: 64.50148892402649
[foolsgold agg] training data poison_ratio: 0.19326837909654562  data num: [592, 510, 679, 588, 503, 554, 621, 537, 532, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.19326837909654562
[foolsgold agg] wv: [0.61706121 1.         1.         1.         1.         1.
 0.07836587 0.61706121 1.         0.07836587]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.5355, Accuracy: 8694/10000 (86.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.2170, Accuracy: 8588/8991 (95.5177%)
Done in 231.88311100006104 sec.
Server Epoch:19 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0025, Accuracy: 615/641 (95.9438%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   2,  Average loss: 0.0048, Accuracy: 618/641 (96.4119%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   3,  Average loss: 0.0813, Accuracy: 433/641 (67.5507%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   4,  Average loss: 0.0152, Accuracy: 493/641 (76.9111%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   5,  Average loss: 0.0129, Accuracy: 518/641 (80.8112%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   6,  Average loss: 0.0070, Accuracy: 567/641 (88.4555%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   7,  Average loss: 0.0079, Accuracy: 601/641 (93.7598%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   8,  Average loss: 0.0121, Accuracy: 506/641 (78.9392%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   9,  Average loss: 0.0062, Accuracy: 566/641 (88.2995%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch  10,  Average loss: 0.0054, Accuracy: 575/641 (89.7036%), train_poison_data_count: 641
Global model norm: 15.916309346021212.
Norm before scaling: 16.85085711464099. Distance: 6.262719905441538
Total norm for 9 adversaries is: 16.85085711464099. distance: 6.262719905441538
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.4094, Accuracy: 8053/8991 (89.5673%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.0043, Accuracy: 484/518 (93.4363%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   2,  Average loss: 0.0017, Accuracy: 503/518 (97.1042%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   3,  Average loss: 0.0008, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   4,  Average loss: 0.0005, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   5,  Average loss: 0.0003, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   6,  Average loss: 0.0003, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   7,  Average loss: 0.0002, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   8,  Average loss: 0.0002, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   9,  Average loss: 0.0002, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch  10,  Average loss: 0.0002, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 15.916309346021212.
Norm before scaling: 15.921938251223727. Distance: 1.9083963411526774
Total norm for 9 adversaries is: 15.921938251223727. distance: 1.9083963411526774
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1072, Accuracy: 8693/8991 (96.6856%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 453/474 (95.5696%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   2,  Average loss: 0.0016, Accuracy: 461/474 (97.2574%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   3,  Average loss: 0.0018, Accuracy: 456/474 (96.2025%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   4,  Average loss: 0.0006, Accuracy: 469/474 (98.9451%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   5,  Average loss: 0.0003, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   6,  Average loss: 0.0003, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   7,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   8,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   9,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch  10,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 15.916309346021212.
Norm before scaling: 15.876137039435061. Distance: 1.5121132978951632
Total norm for 9 adversaries is: 15.876137039435061. distance: 1.5121132978951632
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1298, Accuracy: 8619/8991 (95.8625%)
___Train Local_Simple,  epoch  19, local model 84, internal_epoch   1,  Average loss: 0.0051, Accuracy: 503/560 (89.8214%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3364, Accuracy: 8942/10000 (89.4200%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0036, Accuracy: 553/582 (95.0172%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   2,  Average loss: 0.0066, Accuracy: 514/582 (88.3162%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   3,  Average loss: 0.0026, Accuracy: 550/582 (94.5017%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   4,  Average loss: 0.0017, Accuracy: 568/582 (97.5945%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   5,  Average loss: 0.0013, Accuracy: 576/582 (98.9691%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   6,  Average loss: 0.0009, Accuracy: 576/582 (98.9691%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   7,  Average loss: 0.0009, Accuracy: 577/582 (99.1409%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   8,  Average loss: 0.0006, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   9,  Average loss: 0.0008, Accuracy: 578/582 (99.3127%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch  10,  Average loss: 0.0005, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Global model norm: 15.916309346021212.
Norm before scaling: 16.198121816760885. Distance: 3.192185492381894
Total norm for 9 adversaries is: 16.198121816760885. distance: 3.192185492381894
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1071, Accuracy: 8683/8991 (96.5744%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0048, Accuracy: 622/665 (93.5338%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   2,  Average loss: 0.0032, Accuracy: 629/665 (94.5865%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   3,  Average loss: 0.0018, Accuracy: 642/665 (96.5414%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   4,  Average loss: 0.0011, Accuracy: 655/665 (98.4962%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   5,  Average loss: 0.0008, Accuracy: 656/665 (98.6466%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   6,  Average loss: 0.0007, Accuracy: 659/665 (99.0977%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   7,  Average loss: 0.0006, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   8,  Average loss: 0.0005, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   9,  Average loss: 0.0005, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch  10,  Average loss: 0.0005, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Global model norm: 15.916309346021212.
Norm before scaling: 16.02054611894422. Distance: 2.4369438710720472
Total norm for 9 adversaries is: 16.02054611894422. distance: 2.4369438710720472
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1212, Accuracy: 8652/8991 (96.2296%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0031, Accuracy: 649/683 (95.0220%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   2,  Average loss: 0.0014, Accuracy: 664/683 (97.2182%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   3,  Average loss: 0.0008, Accuracy: 676/683 (98.9751%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   4,  Average loss: 0.0005, Accuracy: 676/683 (98.9751%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   5,  Average loss: 0.0003, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   6,  Average loss: 0.0003, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   7,  Average loss: 0.0003, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   8,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   9,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch  10,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Global model norm: 15.916309346021212.
Norm before scaling: 15.944779951144817. Distance: 1.8699626649607655
Total norm for 9 adversaries is: 15.944779951144817. distance: 1.8699626649607655
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1034, Accuracy: 8701/8991 (96.7746%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0033, Accuracy: 554/581 (95.3528%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   2,  Average loss: 0.0016, Accuracy: 565/581 (97.2461%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   3,  Average loss: 0.0008, Accuracy: 576/581 (99.1394%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   4,  Average loss: 0.0004, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   5,  Average loss: 0.0004, Accuracy: 580/581 (99.8279%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   6,  Average loss: 0.0003, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   7,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   8,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   9,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch  10,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 15.916309346021212.
Norm before scaling: 15.921907104819201. Distance: 1.807898567017087
Total norm for 9 adversaries is: 15.921907104819201. distance: 1.807898567017087
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1189, Accuracy: 8667/8991 (96.3964%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 669/708 (94.4915%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   2,  Average loss: 0.0027, Accuracy: 670/708 (94.6328%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   3,  Average loss: 0.0017, Accuracy: 688/708 (97.1751%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   4,  Average loss: 0.0010, Accuracy: 696/708 (98.3051%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   5,  Average loss: 0.0007, Accuracy: 699/708 (98.7288%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   6,  Average loss: 0.0006, Accuracy: 701/708 (99.0113%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   7,  Average loss: 0.0005, Accuracy: 704/708 (99.4350%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   8,  Average loss: 0.0004, Accuracy: 705/708 (99.5763%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   9,  Average loss: 0.0003, Accuracy: 705/708 (99.5763%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch  10,  Average loss: 0.0004, Accuracy: 705/708 (99.5763%), train_poison_data_count: 708
Global model norm: 15.916309346021212.
Norm before scaling: 16.068678324482793. Distance: 2.535963967232781
Total norm for 9 adversaries is: 16.068678324482793. distance: 2.535963967232781
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1086, Accuracy: 8697/8991 (96.7301%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 472/505 (93.4653%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   2,  Average loss: 0.0028, Accuracy: 478/505 (94.6535%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   3,  Average loss: 0.0010, Accuracy: 497/505 (98.4158%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   4,  Average loss: 0.0006, Accuracy: 503/505 (99.6040%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   5,  Average loss: 0.0004, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   6,  Average loss: 0.0003, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Global model norm: 15.916309346021212.
Norm before scaling: 15.983204609521952. Distance: 1.9781751725762855
Total norm for 9 adversaries is: 15.983204609521952. distance: 1.9781751725762855
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1288, Accuracy: 8621/8991 (95.8848%)
time spent on training: 137.93496990203857
[foolsgold agg] training data poison_ratio: 0.9053574446510055  data num: [641, 518, 474, 560, 582, 665, 683, 581, 708, 505]
[foolsgold agg] considering poison per batch poison_fraction: 0.9053574446510055
[foolsgold agg] wv: [1.         1.         1.         1.         0.60785196 1.
 0.60785196 0.82892433 1.         0.82892433]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.9517, Accuracy: 8193/10000 (81.9300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.3386, Accuracy: 8201/8991 (91.2134%)
Done in 305.6083650588989 sec.
Server Epoch:20 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0045, Accuracy: 547/588 (93.0272%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   2,  Average loss: 0.0024, Accuracy: 567/588 (96.4286%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   3,  Average loss: 0.0009, Accuracy: 582/588 (98.9796%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   4,  Average loss: 0.0006, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   5,  Average loss: 0.0005, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   6,  Average loss: 0.0004, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   7,  Average loss: 0.0003, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   8,  Average loss: 0.0003, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   9,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch  10,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.0177856774216.
Norm before scaling: 16.109125884652403. Distance: 2.194231846593802
Total norm for 9 adversaries is: 16.109125884652403. distance: 2.194231846593802
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1194, Accuracy: 8667/8991 (96.3964%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0052, Accuracy: 479/518 (92.4710%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   2,  Average loss: 0.0023, Accuracy: 496/518 (95.7529%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   3,  Average loss: 0.0010, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   4,  Average loss: 0.0010, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   5,  Average loss: 0.0006, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   6,  Average loss: 0.0004, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   7,  Average loss: 0.0004, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   8,  Average loss: 0.0004, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   9,  Average loss: 0.0003, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch  10,  Average loss: 0.0003, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 16.0177856774216.
Norm before scaling: 16.07400753582375. Distance: 2.1067310859190562
Total norm for 9 adversaries is: 16.07400753582375. distance: 2.1067310859190562
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1002, Accuracy: 8710/8991 (96.8747%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   1,  Average loss: 0.0048, Accuracy: 597/650 (91.8462%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   2,  Average loss: 0.0025, Accuracy: 622/650 (95.6923%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   3,  Average loss: 0.0012, Accuracy: 636/650 (97.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   4,  Average loss: 0.0009, Accuracy: 641/650 (98.6154%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   5,  Average loss: 0.0007, Accuracy: 644/650 (99.0769%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   6,  Average loss: 0.0005, Accuracy: 646/650 (99.3846%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   7,  Average loss: 0.0006, Accuracy: 646/650 (99.3846%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   8,  Average loss: 0.0004, Accuracy: 648/650 (99.6923%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   9,  Average loss: 0.0004, Accuracy: 648/650 (99.6923%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch  10,  Average loss: 0.0004, Accuracy: 648/650 (99.6923%), train_poison_data_count: 650
Global model norm: 16.0177856774216.
Norm before scaling: 16.19587025691754. Distance: 2.543227503396659
Total norm for 9 adversaries is: 16.19587025691754. distance: 2.543227503396659
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1089, Accuracy: 8685/8991 (96.5966%)
___Train Local_Simple,  epoch  20, local model 82, internal_epoch   1,  Average loss: 0.0068, Accuracy: 551/621 (88.7279%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2722, Accuracy: 9319/10000 (93.1900%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 605/641 (94.3838%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   2,  Average loss: 0.0019, Accuracy: 614/641 (95.7878%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   3,  Average loss: 0.0012, Accuracy: 624/641 (97.3479%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   4,  Average loss: 0.0005, Accuracy: 637/641 (99.3760%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   5,  Average loss: 0.0003, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   6,  Average loss: 0.0003, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   7,  Average loss: 0.0002, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   8,  Average loss: 0.0002, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   9,  Average loss: 0.0002, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch  10,  Average loss: 0.0002, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Global model norm: 16.0177856774216.
Norm before scaling: 16.12758787221982. Distance: 2.240975401226298
Total norm for 9 adversaries is: 16.12758787221982. distance: 2.240975401226298
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1562, Accuracy: 8583/8991 (95.4621%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0055, Accuracy: 455/493 (92.2921%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   2,  Average loss: 0.0021, Accuracy: 474/493 (96.1460%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   3,  Average loss: 0.0013, Accuracy: 482/493 (97.7688%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   4,  Average loss: 0.0009, Accuracy: 491/493 (99.5943%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   5,  Average loss: 0.0007, Accuracy: 492/493 (99.7972%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   6,  Average loss: 0.0005, Accuracy: 491/493 (99.5943%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   7,  Average loss: 0.0004, Accuracy: 492/493 (99.7972%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   8,  Average loss: 0.0004, Accuracy: 492/493 (99.7972%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   9,  Average loss: 0.0003, Accuracy: 492/493 (99.7972%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch  10,  Average loss: 0.0003, Accuracy: 492/493 (99.7972%), train_poison_data_count: 493
Global model norm: 16.0177856774216.
Norm before scaling: 16.08354310737279. Distance: 2.046434544355092
Total norm for 9 adversaries is: 16.08354310737279. distance: 2.046434544355092
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1199, Accuracy: 8651/8991 (96.2184%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   1,  Average loss: 0.0043, Accuracy: 562/605 (92.8926%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   2,  Average loss: 0.0027, Accuracy: 573/605 (94.7107%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   3,  Average loss: 0.0019, Accuracy: 588/605 (97.1901%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   4,  Average loss: 0.0012, Accuracy: 594/605 (98.1818%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   5,  Average loss: 0.0008, Accuracy: 597/605 (98.6777%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   6,  Average loss: 0.0007, Accuracy: 598/605 (98.8430%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   7,  Average loss: 0.0006, Accuracy: 600/605 (99.1736%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   8,  Average loss: 0.0005, Accuracy: 601/605 (99.3388%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   9,  Average loss: 0.0005, Accuracy: 602/605 (99.5041%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch  10,  Average loss: 0.0004, Accuracy: 602/605 (99.5041%), train_poison_data_count: 605
Global model norm: 16.0177856774216.
Norm before scaling: 16.092060363368056. Distance: 2.000334592487736
Total norm for 9 adversaries is: 16.092060363368056. distance: 2.000334592487736
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1268, Accuracy: 8660/8991 (96.3185%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   1,  Average loss: 0.0029, Accuracy: 578/602 (96.0133%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   2,  Average loss: 0.0025, Accuracy: 570/602 (94.6844%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   3,  Average loss: 0.0013, Accuracy: 586/602 (97.3422%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   4,  Average loss: 0.0007, Accuracy: 596/602 (99.0033%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   5,  Average loss: 0.0005, Accuracy: 600/602 (99.6678%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   6,  Average loss: 0.0004, Accuracy: 601/602 (99.8339%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   7,  Average loss: 0.0003, Accuracy: 601/602 (99.8339%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   8,  Average loss: 0.0003, Accuracy: 601/602 (99.8339%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   9,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch  10,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 16.0177856774216.
Norm before scaling: 16.04338295742983. Distance: 1.75342551526937
Total norm for 9 adversaries is: 16.04338295742983. distance: 1.75342551526937
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1256, Accuracy: 8676/8991 (96.4965%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 611/644 (94.8758%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   2,  Average loss: 0.0073, Accuracy: 579/644 (89.9068%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   3,  Average loss: 0.0044, Accuracy: 594/644 (92.2360%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   4,  Average loss: 0.0022, Accuracy: 623/644 (96.7391%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   5,  Average loss: 0.0016, Accuracy: 630/644 (97.8261%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   6,  Average loss: 0.0011, Accuracy: 633/644 (98.2919%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   7,  Average loss: 0.0009, Accuracy: 634/644 (98.4472%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   8,  Average loss: 0.0008, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   9,  Average loss: 0.0007, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch  10,  Average loss: 0.0007, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Global model norm: 16.0177856774216.
Norm before scaling: 16.635686437067207. Distance: 5.293073792488585
Total norm for 9 adversaries is: 16.635686437067207. distance: 5.293073792488585
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1823, Accuracy: 8488/8991 (94.4055%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 613/665 (92.1805%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   2,  Average loss: 0.0018, Accuracy: 650/665 (97.7444%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   3,  Average loss: 0.0013, Accuracy: 653/665 (98.1955%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   4,  Average loss: 0.0007, Accuracy: 658/665 (98.9474%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   5,  Average loss: 0.0005, Accuracy: 660/665 (99.2481%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   6,  Average loss: 0.0004, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   7,  Average loss: 0.0004, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   8,  Average loss: 0.0003, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   9,  Average loss: 0.0003, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch  10,  Average loss: 0.0003, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.0177856774216.
Norm before scaling: 16.167385963614663. Distance: 2.3114743406805345
Total norm for 9 adversaries is: 16.167385963614663. distance: 2.3114743406805345
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1173, Accuracy: 8660/8991 (96.3185%)
time spent on training: 138.4593117237091
[foolsgold agg] training data poison_ratio: 0.8969636635141862  data num: [588, 518, 650, 621, 641, 493, 605, 602, 644, 665]
[foolsgold agg] considering poison per batch poison_fraction: 0.8969636635141862
[foolsgold agg] wv: [0.0329439  1.         1.         1.         1.         0.01042848
 1.         1.         0.41171291 0.01042848]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 1.0704, Accuracy: 8373/10000 (83.7300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.2880, Accuracy: 8389/8991 (93.3044%)
Done in 305.4235489368439 sec.
Server Epoch:21 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   1,  Average loss: 0.0034, Accuracy: 609/638 (95.4545%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   2,  Average loss: 0.0017, Accuracy: 613/638 (96.0815%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   3,  Average loss: 0.0006, Accuracy: 633/638 (99.2163%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   4,  Average loss: 0.0004, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   5,  Average loss: 0.0003, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   6,  Average loss: 0.0003, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   8,  Average loss: 0.0002, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch  10,  Average loss: 0.0002, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 16.094480983095863.
Norm before scaling: 16.11435271058847. Distance: 1.8805691345578563
Total norm for 5 adversaries is: 16.11435271058847. distance: 1.8805691345578563
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1175, Accuracy: 8664/8991 (96.3630%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 558/597 (93.4673%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   2,  Average loss: 0.0024, Accuracy: 570/597 (95.4774%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   3,  Average loss: 0.0015, Accuracy: 581/597 (97.3199%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   4,  Average loss: 0.0010, Accuracy: 588/597 (98.4925%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   5,  Average loss: 0.0006, Accuracy: 590/597 (98.8275%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   6,  Average loss: 0.0005, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   7,  Average loss: 0.0004, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   8,  Average loss: 0.0004, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   9,  Average loss: 0.0004, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch  10,  Average loss: 0.0003, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Global model norm: 16.094480983095863.
Norm before scaling: 16.179046190815182. Distance: 2.2859342375580147
Total norm for 5 adversaries is: 16.179046190815182. distance: 2.2859342375580147
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1126, Accuracy: 8666/8991 (96.3853%)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0077, Accuracy: 461/529 (87.1456%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.5265, Accuracy: 8327/10000 (83.2700%), Attack Success Rate:1/10000(0.010)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   1,  Average loss: 0.0033, Accuracy: 542/572 (94.7552%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   2,  Average loss: 0.0014, Accuracy: 556/572 (97.2028%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   3,  Average loss: 0.0010, Accuracy: 560/572 (97.9021%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   4,  Average loss: 0.0006, Accuracy: 566/572 (98.9510%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   5,  Average loss: 0.0004, Accuracy: 568/572 (99.3007%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   6,  Average loss: 0.0003, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   7,  Average loss: 0.0003, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   8,  Average loss: 0.0003, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   9,  Average loss: 0.0002, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch  10,  Average loss: 0.0002, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Global model norm: 16.094480983095863.
Norm before scaling: 16.06737827186657. Distance: 1.6876424093555686
Total norm for 5 adversaries is: 16.06737827186657. distance: 1.6876424093555686
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0945, Accuracy: 8751/8991 (97.3307%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0038, Accuracy: 623/652 (95.5521%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0034, Accuracy: 613/652 (94.0184%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0021, Accuracy: 625/652 (95.8589%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0009, Accuracy: 642/652 (98.4663%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0007, Accuracy: 645/652 (98.9264%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0006, Accuracy: 646/652 (99.0798%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0005, Accuracy: 647/652 (99.2331%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0004, Accuracy: 649/652 (99.5399%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0004, Accuracy: 650/652 (99.6933%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0004, Accuracy: 650/652 (99.6933%), train_poison_data_count: 652
Global model norm: 16.094480983095863.
Norm before scaling: 16.191059914118597. Distance: 2.6468130885858607
Total norm for 5 adversaries is: 16.191059914118597. distance: 2.6468130885858607
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1191, Accuracy: 8654/8991 (96.2518%)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0084, Accuracy: 506/588 (86.0544%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8356, Accuracy: 7655/10000 (76.5500%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   1,  Average loss: 0.0039, Accuracy: 524/553 (94.7559%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   2,  Average loss: 0.0022, Accuracy: 527/553 (95.2984%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   3,  Average loss: 0.0009, Accuracy: 546/553 (98.7342%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   4,  Average loss: 0.0007, Accuracy: 549/553 (99.2767%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   5,  Average loss: 0.0006, Accuracy: 549/553 (99.2767%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   6,  Average loss: 0.0005, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   7,  Average loss: 0.0004, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   8,  Average loss: 0.0004, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   9,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch  10,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Global model norm: 16.094480983095863.
Norm before scaling: 16.06335209467744. Distance: 1.7494560486232438
Total norm for 5 adversaries is: 16.06335209467744. distance: 1.7494560486232438
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0991, Accuracy: 8720/8991 (96.9859%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0069, Accuracy: 521/587 (88.7564%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4875, Accuracy: 8274/10000 (82.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0071, Accuracy: 468/523 (89.4837%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3353, Accuracy: 8852/10000 (88.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0068, Accuracy: 542/618 (87.7023%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2308, Accuracy: 9291/10000 (92.9100%), Attack Success Rate:0/10000(0.000)
time spent on training: 96.46239590644836
[foolsgold agg] training data poison_ratio: 0.5142564452791532  data num: [638, 597, 529, 572, 652, 588, 553, 587, 523, 618]
[foolsgold agg] considering poison per batch poison_fraction: 0.5142564452791532
[foolsgold agg] wv: [1.         1.         0.53435537 1.         1.         0.14366417
 1.         0.74810457 1.         0.14366417]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 1.1431, Accuracy: 8516/10000 (85.1600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.2288, Accuracy: 8528/8991 (94.8504%)
Done in 263.2302179336548 sec.
Server Epoch:22 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.0029, Accuracy: 548/578 (94.8097%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   2,  Average loss: 0.0018, Accuracy: 561/578 (97.0588%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   3,  Average loss: 0.0006, Accuracy: 569/578 (98.4429%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   4,  Average loss: 0.0004, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   5,  Average loss: 0.0003, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   6,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   7,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   8,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   9,  Average loss: 0.0002, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch  10,  Average loss: 0.0002, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 16.14773541803492.
Norm before scaling: 16.13165098724302. Distance: 1.7889344281994286
Total norm for 7 adversaries is: 16.13165098724302. distance: 1.7889344281994286
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1107, Accuracy: 8682/8991 (96.5632%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0035, Accuracy: 732/774 (94.5736%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   2,  Average loss: 0.0018, Accuracy: 746/774 (96.3824%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   3,  Average loss: 0.0013, Accuracy: 755/774 (97.5452%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   4,  Average loss: 0.0007, Accuracy: 767/774 (99.0956%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   5,  Average loss: 0.0004, Accuracy: 771/774 (99.6124%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   6,  Average loss: 0.0003, Accuracy: 772/774 (99.7416%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   7,  Average loss: 0.0003, Accuracy: 773/774 (99.8708%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   8,  Average loss: 0.0002, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   9,  Average loss: 0.0002, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch  10,  Average loss: 0.0002, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Global model norm: 16.14773541803492.
Norm before scaling: 16.18830404162649. Distance: 2.1555702133051766
Total norm for 7 adversaries is: 16.18830404162649. distance: 2.1555702133051766
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1082, Accuracy: 8701/8991 (96.7746%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0040, Accuracy: 627/665 (94.2857%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   2,  Average loss: 0.0013, Accuracy: 651/665 (97.8947%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   3,  Average loss: 0.0006, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   4,  Average loss: 0.0004, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   5,  Average loss: 0.0003, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   6,  Average loss: 0.0003, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   7,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   8,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.14773541803492.
Norm before scaling: 16.19654764193833. Distance: 2.186584499063645
Total norm for 7 adversaries is: 16.19654764193833. distance: 2.186584499063645
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1208, Accuracy: 8639/8991 (96.0850%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0028, Accuracy: 584/609 (95.8949%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   2,  Average loss: 0.0017, Accuracy: 587/609 (96.3875%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   3,  Average loss: 0.0007, Accuracy: 603/609 (99.0148%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   4,  Average loss: 0.0004, Accuracy: 606/609 (99.5074%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   5,  Average loss: 0.0003, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   6,  Average loss: 0.0003, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   7,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   8,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   9,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch  10,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Global model norm: 16.14773541803492.
Norm before scaling: 16.131319921874805. Distance: 1.6967760088798707
Total norm for 7 adversaries is: 16.131319921874805. distance: 1.6967760088798707
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1044, Accuracy: 8694/8991 (96.6967%)
___Train Local_Simple,  epoch  22, local model 60, internal_epoch   1,  Average loss: 0.0072, Accuracy: 583/644 (90.5280%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.8545, Accuracy: 7758/10000 (77.5800%), Attack Success Rate:0/10000(0.000)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 646/683 (94.5827%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   2,  Average loss: 0.0022, Accuracy: 648/683 (94.8755%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   3,  Average loss: 0.0010, Accuracy: 674/683 (98.6823%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   4,  Average loss: 0.0008, Accuracy: 674/683 (98.6823%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   5,  Average loss: 0.0005, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   6,  Average loss: 0.0004, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   7,  Average loss: 0.0004, Accuracy: 680/683 (99.5608%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   8,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   9,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch  10,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Global model norm: 16.14773541803492.
Norm before scaling: 16.155858992488028. Distance: 1.9478206780866492
Total norm for 7 adversaries is: 16.155858992488028. distance: 1.9478206780866492
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0933, Accuracy: 8722/8991 (97.0081%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 464/493 (94.1176%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   2,  Average loss: 0.0012, Accuracy: 480/493 (97.3631%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   3,  Average loss: 0.0008, Accuracy: 485/493 (98.3773%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   4,  Average loss: 0.0005, Accuracy: 491/493 (99.5943%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   5,  Average loss: 0.0003, Accuracy: 491/493 (99.5943%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   6,  Average loss: 0.0003, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   7,  Average loss: 0.0002, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   8,  Average loss: 0.0002, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   9,  Average loss: 0.0002, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch  10,  Average loss: 0.0002, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.14773541803492.
Norm before scaling: 16.150345156733977. Distance: 1.762647024745452
Total norm for 7 adversaries is: 16.150345156733977. distance: 1.762647024745452
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1219, Accuracy: 8667/8991 (96.3964%)
___Train Local_Simple,  epoch  22, local model 92, internal_epoch   1,  Average loss: 0.0070, Accuracy: 505/571 (88.4413%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3503, Accuracy: 8865/10000 (88.6500%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   1,  Average loss: 0.0030, Accuracy: 619/650 (95.2308%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   2,  Average loss: 0.0014, Accuracy: 636/650 (97.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   3,  Average loss: 0.0007, Accuracy: 644/650 (99.0769%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   4,  Average loss: 0.0005, Accuracy: 645/650 (99.2308%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   5,  Average loss: 0.0003, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   6,  Average loss: 0.0003, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   7,  Average loss: 0.0002, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   8,  Average loss: 0.0002, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   9,  Average loss: 0.0002, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch  10,  Average loss: 0.0002, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 16.14773541803492.
Norm before scaling: 16.160744962234105. Distance: 1.8537876584735211
Total norm for 7 adversaries is: 16.160744962234105. distance: 1.8537876584735211
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1033, Accuracy: 8710/8991 (96.8747%)
___Train Local_Simple,  epoch  22, local model 96, internal_epoch   1,  Average loss: 0.0074, Accuracy: 532/608 (87.5000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5602, Accuracy: 8105/10000 (81.0500%), Attack Success Rate:0/10000(0.000)
time spent on training: 121.73419404029846
[foolsgold agg] training data poison_ratio: 0.7094820717131474  data num: [578, 774, 665, 609, 644, 683, 493, 571, 650, 608]
[foolsgold agg] considering poison per batch poison_fraction: 0.7094820717131474
[foolsgold agg] wv: [1.         1.         0.30378125 1.         1.         1.
 0.30378125 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 1.1211, Accuracy: 8458/10000 (84.5800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.2602, Accuracy: 8479/8991 (94.3054%)
Done in 288.9758520126343 sec.
Server Epoch:23 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0084, Accuracy: 546/626 (87.2204%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2682, Accuracy: 9207/10000 (92.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0093, Accuracy: 529/621 (85.1852%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4340, Accuracy: 8699/10000 (86.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 85, internal_epoch   1,  Average loss: 0.0092, Accuracy: 501/570 (87.8947%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3024, Accuracy: 8982/10000 (89.8200%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0031, Accuracy: 616/648 (95.0617%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   2,  Average loss: 0.0012, Accuracy: 632/648 (97.5309%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   3,  Average loss: 0.0007, Accuracy: 641/648 (98.9198%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   5,  Average loss: 0.0003, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   6,  Average loss: 0.0003, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   8,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   9,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch  10,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Global model norm: 16.195767563252154.
Norm before scaling: 16.197205215317528. Distance: 1.9732214995969302
Total norm for 2 adversaries is: 16.197205215317528. distance: 1.9732214995969302
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1135, Accuracy: 8684/8991 (96.5855%)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0078, Accuracy: 453/518 (87.4517%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.9923, Accuracy: 7358/10000 (73.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 61, internal_epoch   1,  Average loss: 0.0081, Accuracy: 464/537 (86.4060%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.5550, Accuracy: 8095/10000 (80.9500%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0029, Accuracy: 503/526 (95.6274%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   2,  Average loss: 0.0024, Accuracy: 501/526 (95.2471%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   3,  Average loss: 0.0010, Accuracy: 515/526 (97.9087%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   4,  Average loss: 0.0006, Accuracy: 521/526 (99.0494%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   5,  Average loss: 0.0003, Accuracy: 524/526 (99.6198%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   6,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   7,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   8,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   9,  Average loss: 0.0002, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch  10,  Average loss: 0.0002, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 16.195767563252154.
Norm before scaling: 16.210533692259816. Distance: 1.8771803576436898
Total norm for 2 adversaries is: 16.210533692259816. distance: 1.8771803576436898
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1261, Accuracy: 8644/8991 (96.1406%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0073, Accuracy: 519/587 (88.4157%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2359, Accuracy: 9252/10000 (92.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0068, Accuracy: 598/664 (90.0602%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3212, Accuracy: 8955/10000 (89.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 75, internal_epoch   1,  Average loss: 0.0072, Accuracy: 483/554 (87.1841%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3251, Accuracy: 9044/10000 (90.4400%), Attack Success Rate:0/10000(0.000)
time spent on training: 64.7551863193512
[foolsgold agg] training data poison_ratio: 0.20064946163049052  data num: [626, 621, 570, 648, 518, 537, 526, 587, 664, 554]
[foolsgold agg] considering poison per batch poison_fraction: 0.20064946163049052
[foolsgold agg] wv: [0.69090445 0.         0.         1.         1.         1.
 1.         0.31238584 0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.7877, Accuracy: 8406/10000 (84.0600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.2791, Accuracy: 8428/8991 (93.7382%)
Done in 232.40691018104553 sec.
Server Epoch:24 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   1,  Average loss: 0.0036, Accuracy: 493/520 (94.8077%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   2,  Average loss: 0.0015, Accuracy: 506/520 (97.3077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   3,  Average loss: 0.0011, Accuracy: 509/520 (97.8846%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   4,  Average loss: 0.0006, Accuracy: 516/520 (99.2308%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   5,  Average loss: 0.0004, Accuracy: 517/520 (99.4231%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   6,  Average loss: 0.0003, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   7,  Average loss: 0.0003, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   8,  Average loss: 0.0002, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   9,  Average loss: 0.0003, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch  10,  Average loss: 0.0002, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Global model norm: 16.202981858094823.
Norm before scaling: 16.209495417785796. Distance: 1.7941624609151834
Total norm for 4 adversaries is: 16.209495417785796. distance: 1.7941624609151834
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1114, Accuracy: 8713/8991 (96.9080%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0079, Accuracy: 494/573 (86.2129%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3506, Accuracy: 8856/10000 (88.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 543/608 (89.3092%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2986, Accuracy: 9107/10000 (91.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 83, internal_epoch   1,  Average loss: 0.0076, Accuracy: 470/555 (84.6847%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3434, Accuracy: 8796/10000 (87.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 63, internal_epoch   1,  Average loss: 0.0063, Accuracy: 540/616 (87.6623%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2269, Accuracy: 9283/10000 (92.8300%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 628/668 (94.0120%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   2,  Average loss: 0.0022, Accuracy: 639/668 (95.6587%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   3,  Average loss: 0.0012, Accuracy: 654/668 (97.9042%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   4,  Average loss: 0.0008, Accuracy: 659/668 (98.6527%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   5,  Average loss: 0.0005, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   6,  Average loss: 0.0004, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   7,  Average loss: 0.0003, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   8,  Average loss: 0.0003, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   9,  Average loss: 0.0003, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch  10,  Average loss: 0.0003, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Global model norm: 16.202981858094823.
Norm before scaling: 16.25387761728432. Distance: 2.121098021332601
Total norm for 4 adversaries is: 16.25387761728432. distance: 2.121098021332601
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0956, Accuracy: 8724/8991 (97.0304%)
___Train Local_Simple,  epoch  24, local model 94, internal_epoch   1,  Average loss: 0.0058, Accuracy: 498/555 (89.7297%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5733, Accuracy: 8392/10000 (83.9200%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0040, Accuracy: 549/582 (94.3299%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   2,  Average loss: 0.0039, Accuracy: 535/582 (91.9244%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   3,  Average loss: 0.0019, Accuracy: 563/582 (96.7354%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   4,  Average loss: 0.0011, Accuracy: 568/582 (97.5945%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   5,  Average loss: 0.0007, Accuracy: 577/582 (99.1409%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   6,  Average loss: 0.0007, Accuracy: 579/582 (99.4845%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   7,  Average loss: 0.0006, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   8,  Average loss: 0.0004, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   9,  Average loss: 0.0004, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch  10,  Average loss: 0.0004, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Global model norm: 16.202981858094823.
Norm before scaling: 16.356674539830923. Distance: 2.666452627731511
Total norm for 4 adversaries is: 16.356674539830923. distance: 2.666452627731511
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1084, Accuracy: 8682/8991 (96.5632%)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0084, Accuracy: 532/618 (86.0841%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3702, Accuracy: 9138/10000 (91.3800%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   1,  Average loss: 0.0040, Accuracy: 448/474 (94.5148%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   2,  Average loss: 0.0011, Accuracy: 463/474 (97.6793%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   3,  Average loss: 0.0004, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   4,  Average loss: 0.0004, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   5,  Average loss: 0.0003, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   6,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   7,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   8,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   9,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch  10,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 16.202981858094823.
Norm before scaling: 16.17332704079032. Distance: 1.6378022388179756
Total norm for 4 adversaries is: 16.17332704079032. distance: 1.6378022388179756
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1096, Accuracy: 8698/8991 (96.7412%)
time spent on training: 84.7874801158905
[foolsgold agg] training data poison_ratio: 0.3889755590223609  data num: [520, 573, 608, 555, 616, 668, 555, 582, 618, 474]
[foolsgold agg] considering poison per batch poison_fraction: 0.3889755590223609
[foolsgold agg] wv: [1.         1.         0.72105708 0.51628808 0.93595708 1.
 0.72105708 1.         0.51628808 1.        ]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.5923, Accuracy: 8543/10000 (85.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.2268, Accuracy: 8505/8991 (94.5946%)
Done in 251.5254991054535 sec.
Server Epoch:25 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0024, Accuracy: 723/750 (96.4000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   2,  Average loss: 0.0013, Accuracy: 724/750 (96.5333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   3,  Average loss: 0.0005, Accuracy: 744/750 (99.2000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   4,  Average loss: 0.0003, Accuracy: 748/750 (99.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   5,  Average loss: 0.0002, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   6,  Average loss: 0.0002, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   7,  Average loss: 0.0002, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 16.24038552714536.
Norm before scaling: 16.198886710637325. Distance: 1.6660953337193103
Total norm for 8 adversaries is: 16.198886710637325. distance: 1.6660953337193103
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0960, Accuracy: 8716/8991 (96.9414%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 674/708 (95.1977%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   2,  Average loss: 0.0014, Accuracy: 690/708 (97.4576%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   3,  Average loss: 0.0010, Accuracy: 696/708 (98.3051%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   4,  Average loss: 0.0006, Accuracy: 703/708 (99.2938%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   5,  Average loss: 0.0004, Accuracy: 707/708 (99.8588%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   6,  Average loss: 0.0003, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   7,  Average loss: 0.0002, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   8,  Average loss: 0.0002, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   9,  Average loss: 0.0002, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch  10,  Average loss: 0.0002, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 16.24038552714536.
Norm before scaling: 16.256973413594316. Distance: 1.7688015070987735
Total norm for 8 adversaries is: 16.256973413594316. distance: 1.7688015070987735
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0908, Accuracy: 8734/8991 (97.1416%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.0034, Accuracy: 468/493 (94.9290%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   2,  Average loss: 0.0011, Accuracy: 482/493 (97.7688%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   3,  Average loss: 0.0006, Accuracy: 488/493 (98.9858%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   4,  Average loss: 0.0004, Accuracy: 490/493 (99.3915%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   5,  Average loss: 0.0002, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   6,  Average loss: 0.0002, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   7,  Average loss: 0.0002, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   8,  Average loss: 0.0002, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   9,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch  10,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.24038552714536.
Norm before scaling: 16.239959901656835. Distance: 1.678928931408346
Total norm for 8 adversaries is: 16.239959901656835. distance: 1.678928931408346
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1263, Accuracy: 8674/8991 (96.4743%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0026, Accuracy: 619/648 (95.5247%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   2,  Average loss: 0.0009, Accuracy: 637/648 (98.3025%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   4,  Average loss: 0.0003, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   5,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   6,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   8,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.24038552714536.
Norm before scaling: 16.2410093818761. Distance: 1.8013975863645861
Total norm for 8 adversaries is: 16.2410093818761. distance: 1.8013975863645861
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1452, Accuracy: 8627/8991 (95.9515%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0040, Accuracy: 520/553 (94.0325%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0016, Accuracy: 533/553 (96.3834%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   3,  Average loss: 0.0008, Accuracy: 546/553 (98.7342%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   4,  Average loss: 0.0006, Accuracy: 550/553 (99.4575%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   5,  Average loss: 0.0004, Accuracy: 551/553 (99.6383%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   6,  Average loss: 0.0004, Accuracy: 551/553 (99.6383%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   7,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   8,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   9,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch  10,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Global model norm: 16.24038552714536.
Norm before scaling: 16.245764547187562. Distance: 1.8820366744948613
Total norm for 8 adversaries is: 16.245764547187562. distance: 1.8820366744948613
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1010, Accuracy: 8733/8991 (97.1305%)
___Train Local_Simple,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0081, Accuracy: 545/626 (87.0607%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4202, Accuracy: 8517/10000 (85.1700%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0054, Accuracy: 481/518 (92.8571%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   2,  Average loss: 0.0016, Accuracy: 501/518 (96.7181%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   3,  Average loss: 0.0006, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   4,  Average loss: 0.0006, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   5,  Average loss: 0.0004, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   6,  Average loss: 0.0004, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   7,  Average loss: 0.0003, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   8,  Average loss: 0.0002, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   9,  Average loss: 0.0002, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch  10,  Average loss: 0.0002, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 16.24038552714536.
Norm before scaling: 16.262947441120758. Distance: 2.03845568283746
Total norm for 8 adversaries is: 16.262947441120758. distance: 2.03845568283746
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0992, Accuracy: 8719/8991 (96.9748%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0021, Accuracy: 660/683 (96.6325%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   2,  Average loss: 0.0011, Accuracy: 667/683 (97.6574%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   3,  Average loss: 0.0004, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   4,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   5,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   6,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   7,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   8,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   9,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Global model norm: 16.24038552714536.
Norm before scaling: 16.193061491840126. Distance: 1.4348517363246158
Total norm for 8 adversaries is: 16.193061491840126. distance: 1.4348517363246158
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0936, Accuracy: 8752/8991 (97.3418%)
___Train Local_Simple,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 565/626 (90.2556%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2424, Accuracy: 9230/10000 (92.3000%), Attack Success Rate:0/10000(0.000)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0024, Accuracy: 483/505 (95.6436%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   2,  Average loss: 0.0019, Accuracy: 485/505 (96.0396%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   3,  Average loss: 0.0005, Accuracy: 501/505 (99.2079%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   4,  Average loss: 0.0003, Accuracy: 504/505 (99.8020%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   5,  Average loss: 0.0002, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   6,  Average loss: 0.0002, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   7,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   8,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Global model norm: 16.24038552714536.
Norm before scaling: 16.278051021801087. Distance: 1.6903719305422293
Total norm for 8 adversaries is: 16.278051021801087. distance: 1.6903719305422293
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1296, Accuracy: 8648/8991 (96.1851%)
time spent on training: 129.69642114639282
[foolsgold agg] training data poison_ratio: 0.7950900163666121  data num: [750, 708, 493, 648, 553, 626, 518, 683, 626, 505]
[foolsgold agg] considering poison per batch poison_fraction: 0.7950900163666121
[foolsgold agg] wv: [0.88317696 1.         0.88317696 1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.6369, Accuracy: 8647/10000 (86.4700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.1667, Accuracy: 8645/8991 (96.1517%)
Done in 296.3986699581146 sec.
Server Epoch:26 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 475/503 (94.4334%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   2,  Average loss: 0.0014, Accuracy: 494/503 (98.2107%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   3,  Average loss: 0.0004, Accuracy: 501/503 (99.6024%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   4,  Average loss: 0.0003, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   5,  Average loss: 0.0002, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   6,  Average loss: 0.0002, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 16.301175801749125.
Norm before scaling: 16.302314004291883. Distance: 1.5525566335229193
Total norm for 7 adversaries is: 16.302314004291883. distance: 1.5525566335229193
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1038, Accuracy: 8712/8991 (96.8969%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0034, Accuracy: 516/535 (96.4486%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   2,  Average loss: 0.0023, Accuracy: 511/535 (95.5140%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   3,  Average loss: 0.0014, Accuracy: 521/535 (97.3832%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   4,  Average loss: 0.0006, Accuracy: 530/535 (99.0654%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   5,  Average loss: 0.0004, Accuracy: 533/535 (99.6262%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   6,  Average loss: 0.0002, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   7,  Average loss: 0.0002, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   8,  Average loss: 0.0002, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   9,  Average loss: 0.0002, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch  10,  Average loss: 0.0002, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 16.301175801749125.
Norm before scaling: 16.252424323365382. Distance: 1.629617878641924
Total norm for 7 adversaries is: 16.252424323365382. distance: 1.629617878641924
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1042, Accuracy: 8700/8991 (96.7634%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   1,  Average loss: 0.0030, Accuracy: 591/609 (97.0443%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   2,  Average loss: 0.0011, Accuracy: 591/609 (97.0443%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   3,  Average loss: 0.0009, Accuracy: 598/609 (98.1938%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   4,  Average loss: 0.0005, Accuracy: 605/609 (99.3432%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   5,  Average loss: 0.0003, Accuracy: 607/609 (99.6716%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   6,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   7,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   8,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   9,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch  10,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Global model norm: 16.301175801749125.
Norm before scaling: 16.274779221872816. Distance: 1.7353510816377007
Total norm for 7 adversaries is: 16.274779221872816. distance: 1.7353510816377007
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1107, Accuracy: 8678/8991 (96.5187%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0022, Accuracy: 568/587 (96.7632%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   2,  Average loss: 0.0009, Accuracy: 574/587 (97.7853%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   3,  Average loss: 0.0005, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   4,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   5,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   6,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   7,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   8,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   9,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch  10,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 16.301175801749125.
Norm before scaling: 16.263239235756608. Distance: 1.432984100349424
Total norm for 7 adversaries is: 16.263239235756608. distance: 1.432984100349424
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1119, Accuracy: 8718/8991 (96.9636%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   1,  Average loss: 0.0027, Accuracy: 642/668 (96.1078%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   2,  Average loss: 0.0014, Accuracy: 648/668 (97.0060%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   3,  Average loss: 0.0005, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   4,  Average loss: 0.0003, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   5,  Average loss: 0.0003, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   6,  Average loss: 0.0002, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   7,  Average loss: 0.0002, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   8,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   9,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch  10,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.301175801749125.
Norm before scaling: 16.272841143657697. Distance: 1.6549779217448832
Total norm for 7 adversaries is: 16.272841143657697. distance: 1.6549779217448832
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0987, Accuracy: 8730/8991 (97.0971%)
___Train Local_Simple,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0054, Accuracy: 554/616 (89.9351%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2071, Accuracy: 9338/10000 (93.3800%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0047, Accuracy: 559/588 (95.0680%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   2,  Average loss: 0.0055, Accuracy: 534/588 (90.8163%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   3,  Average loss: 0.0026, Accuracy: 563/588 (95.7483%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   4,  Average loss: 0.0026, Accuracy: 573/588 (97.4490%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   5,  Average loss: 0.0012, Accuracy: 576/588 (97.9592%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   6,  Average loss: 0.0009, Accuracy: 578/588 (98.2993%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   7,  Average loss: 0.0007, Accuracy: 582/588 (98.9796%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   8,  Average loss: 0.0006, Accuracy: 583/588 (99.1497%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   9,  Average loss: 0.0005, Accuracy: 584/588 (99.3197%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch  10,  Average loss: 0.0005, Accuracy: 585/588 (99.4898%), train_poison_data_count: 588
Global model norm: 16.301175801749125.
Norm before scaling: 16.502041777080194. Distance: 3.0620481196633387
Total norm for 7 adversaries is: 16.502041777080194. distance: 3.0620481196633387
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1147, Accuracy: 8662/8991 (96.3408%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0021, Accuracy: 485/505 (96.0396%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   2,  Average loss: 0.0010, Accuracy: 494/505 (97.8218%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   3,  Average loss: 0.0005, Accuracy: 499/505 (98.8119%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   4,  Average loss: 0.0002, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   5,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   6,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   7,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   8,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Global model norm: 16.301175801749125.
Norm before scaling: 16.30284095766795. Distance: 1.470928038158826
Total norm for 7 adversaries is: 16.30284095766795. distance: 1.470928038158826
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1102, Accuracy: 8696/8991 (96.7189%)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 490/555 (88.2883%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.5702, Accuracy: 8167/10000 (81.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 84, internal_epoch   1,  Average loss: 0.0050, Accuracy: 514/560 (91.7857%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2488, Accuracy: 9279/10000 (92.7900%), Attack Success Rate:0/10000(0.000)
time spent on training: 117.57668924331665
[foolsgold agg] training data poison_ratio: 0.6976947258120852  data num: [503, 535, 609, 587, 668, 616, 588, 505, 555, 560]
[foolsgold agg] considering poison per batch poison_fraction: 0.6976947258120852
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.88484961
 1.         1.         0.88484961 1.        ]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.6761, Accuracy: 8684/10000 (86.8400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.1526, Accuracy: 8685/8991 (96.5966%)
Done in 287.00952887535095 sec.
Server Epoch:27 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
___Train Local_Simple,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.0070, Accuracy: 579/646 (89.6285%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4251, Accuracy: 8485/10000 (84.8500%), Attack Success Rate:0/10000(0.000)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0026, Accuracy: 559/580 (96.3793%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   2,  Average loss: 0.0020, Accuracy: 565/580 (97.4138%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   3,  Average loss: 0.0028, Accuracy: 546/580 (94.1379%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   4,  Average loss: 0.0003, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   5,  Average loss: 0.0003, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   6,  Average loss: 0.0002, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   7,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   8,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   9,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch  10,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Global model norm: 16.351259216907902.
Norm before scaling: 16.405705906156456. Distance: 2.0016390521547796
Total norm for 7 adversaries is: 16.405705906156456. distance: 2.0016390521547796
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1141, Accuracy: 8719/8991 (96.9748%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   1,  Average loss: 0.0026, Accuracy: 639/665 (96.0902%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   2,  Average loss: 0.0011, Accuracy: 652/665 (98.0451%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   3,  Average loss: 0.0004, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   4,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   5,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.351259216907902.
Norm before scaling: 16.335344359449447. Distance: 1.7481130917756933
Total norm for 7 adversaries is: 16.335344359449447. distance: 1.7481130917756933
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1167, Accuracy: 8681/8991 (96.5521%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0023, Accuracy: 558/582 (95.8763%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   2,  Average loss: 0.0015, Accuracy: 560/582 (96.2199%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   3,  Average loss: 0.0017, Accuracy: 571/582 (98.1100%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   4,  Average loss: 0.0004, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   5,  Average loss: 0.0003, Accuracy: 579/582 (99.4845%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   6,  Average loss: 0.0002, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   7,  Average loss: 0.0002, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   9,  Average loss: 0.0002, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 16.351259216907902.
Norm before scaling: 16.31288070526775. Distance: 1.5925094413776877
Total norm for 7 adversaries is: 16.31288070526775. distance: 1.5925094413776877
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1067, Accuracy: 8706/8991 (96.8302%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0019, Accuracy: 626/648 (96.6049%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   2,  Average loss: 0.0012, Accuracy: 633/648 (97.6852%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   3,  Average loss: 0.0003, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   4,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   5,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.351259216907902.
Norm before scaling: 16.333852539114318. Distance: 1.5943903665015187
Total norm for 7 adversaries is: 16.333852539114318. distance: 1.5943903665015187
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1137, Accuracy: 8704/8991 (96.8079%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0021, Accuracy: 620/641 (96.7239%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   2,  Average loss: 0.0010, Accuracy: 624/641 (97.3479%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   3,  Average loss: 0.0004, Accuracy: 634/641 (98.9080%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   4,  Average loss: 0.0002, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   8,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 16.351259216907902.
Norm before scaling: 16.31769534574305. Distance: 1.672265051859682
Total norm for 7 adversaries is: 16.31769534574305. distance: 1.672265051859682
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1482, Accuracy: 8617/8991 (95.8403%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   1,  Average loss: 0.0024, Accuracy: 727/750 (96.9333%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   2,  Average loss: 0.0016, Accuracy: 728/750 (97.0667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   3,  Average loss: 0.0007, Accuracy: 741/750 (98.8000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   4,  Average loss: 0.0004, Accuracy: 747/750 (99.6000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   5,  Average loss: 0.0003, Accuracy: 746/750 (99.4667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   6,  Average loss: 0.0002, Accuracy: 748/750 (99.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   7,  Average loss: 0.0002, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   8,  Average loss: 0.0002, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   9,  Average loss: 0.0002, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch  10,  Average loss: 0.0002, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 16.351259216907902.
Norm before scaling: 16.29065021488793. Distance: 1.6772974086946373
Total norm for 7 adversaries is: 16.29065021488793. distance: 1.6772974086946373
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0932, Accuracy: 8726/8991 (97.0526%)
___Train Local_Simple,  epoch  27, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 480/523 (91.7782%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2544, Accuracy: 9222/10000 (92.2200%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   1,  Average loss: 0.0025, Accuracy: 643/668 (96.2575%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   2,  Average loss: 0.0018, Accuracy: 641/668 (95.9581%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   3,  Average loss: 0.0009, Accuracy: 657/668 (98.3533%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   4,  Average loss: 0.0004, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   5,  Average loss: 0.0003, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   6,  Average loss: 0.0002, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   7,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   8,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.351259216907902.
Norm before scaling: 16.321387665039392. Distance: 1.6955162664210823
Total norm for 7 adversaries is: 16.321387665039392. distance: 1.6955162664210823
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0998, Accuracy: 8722/8991 (97.0081%)
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0104, Accuracy: 509/609 (83.5796%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4171, Accuracy: 9008/10000 (90.0800%), Attack Success Rate:0/10000(0.000)
time spent on training: 121.76285910606384
[foolsgold agg] training data poison_ratio: 0.7183143219264893  data num: [646, 580, 665, 582, 648, 641, 750, 523, 668, 609]
[foolsgold agg] considering poison per batch poison_fraction: 0.7183143219264893
[foolsgold agg] wv: [0.69027356 1.         0.60519946 1.         1.         1.
 0.60519946 1.         1.         0.69027356]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.7243, Accuracy: 8760/10000 (87.6000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.1138, Accuracy: 8757/8991 (97.3974%)
Done in 287.94901299476624 sec.
Server Epoch:28 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 623/638 (97.6489%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 629/638 (98.5893%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   3,  Average loss: 0.0002, Accuracy: 636/638 (99.6865%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   7,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   8,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 16.38470590662171.
Norm before scaling: 16.331241292035088. Distance: 1.1383072807566434
Total norm for 5 adversaries is: 16.331241292035088. distance: 1.1383072807566434
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0983, Accuracy: 8754/8991 (97.3640%)
___Train Local_Simple,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0048, Accuracy: 598/647 (92.4266%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.2604, Accuracy: 7303/10000 (73.0300%), Attack Success Rate:1/10000(0.010)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 629/648 (97.0679%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   2,  Average loss: 0.0046, Accuracy: 614/648 (94.7531%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   3,  Average loss: 0.0038, Accuracy: 607/648 (93.6728%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   4,  Average loss: 0.0012, Accuracy: 636/648 (98.1481%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   5,  Average loss: 0.0013, Accuracy: 638/648 (98.4568%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   6,  Average loss: 0.0007, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   7,  Average loss: 0.0005, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   8,  Average loss: 0.0004, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   9,  Average loss: 0.0004, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch  10,  Average loss: 0.0003, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Global model norm: 16.38470590662171.
Norm before scaling: 16.621925930254275. Distance: 3.2461541235642377
Total norm for 5 adversaries is: 16.621925930254275. distance: 3.2461541235642377
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1312, Accuracy: 8683/8991 (96.5744%)
___Train Local_Simple,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0051, Accuracy: 559/616 (90.7468%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2890, Accuracy: 9119/10000 (91.1900%), Attack Success Rate:0/10000(0.000)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0020, Accuracy: 687/708 (97.0339%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   2,  Average loss: 0.0010, Accuracy: 694/708 (98.0226%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   3,  Average loss: 0.0015, Accuracy: 691/708 (97.5989%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   4,  Average loss: 0.0004, Accuracy: 704/708 (99.4350%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   5,  Average loss: 0.0006, Accuracy: 700/708 (98.8701%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   6,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   8,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 16.38470590662171.
Norm before scaling: 16.391001097925272. Distance: 1.5847589783673703
Total norm for 5 adversaries is: 16.391001097925272. distance: 1.5847589783673703
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0863, Accuracy: 8756/8991 (97.3863%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.0019, Accuracy: 560/578 (96.8858%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   2,  Average loss: 0.0006, Accuracy: 570/578 (98.6159%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   3,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   4,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   5,  Average loss: 0.0004, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   6,  Average loss: 0.0001, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   7,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   8,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   9,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch  10,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 16.38470590662171.
Norm before scaling: 16.343328933689293. Distance: 1.3116993505646282
Total norm for 5 adversaries is: 16.343328933689293. distance: 1.3116993505646282
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1056, Accuracy: 8723/8991 (97.0192%)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0058, Accuracy: 564/621 (90.8213%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2497, Accuracy: 9232/10000 (92.3200%), Attack Success Rate:0/10000(0.000)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   1,  Average loss: 0.0020, Accuracy: 476/493 (96.5517%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   2,  Average loss: 0.0007, Accuracy: 487/493 (98.7830%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   3,  Average loss: 0.0003, Accuracy: 491/493 (99.5943%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   4,  Average loss: 0.0002, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   5,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   6,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   7,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   8,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   9,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch  10,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.38470590662171.
Norm before scaling: 16.3516296881085. Distance: 1.306327748152297
Total norm for 5 adversaries is: 16.3516296881085. distance: 1.306327748152297
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1142, Accuracy: 8708/8991 (96.8524%)
___Train Local_Simple,  epoch  28, local model 80, internal_epoch   1,  Average loss: 0.0045, Accuracy: 552/593 (93.0860%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3172, Accuracy: 8991/10000 (89.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 81, internal_epoch   1,  Average loss: 0.0028, Accuracy: 553/586 (94.3686%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6935, Accuracy: 8317/10000 (83.1700%), Attack Success Rate:0/10000(0.000)
time spent on training: 98.71857690811157
[foolsgold agg] training data poison_ratio: 0.5001631853785901  data num: [638, 647, 648, 616, 708, 578, 621, 493, 593, 586]
[foolsgold agg] considering poison per batch poison_fraction: 0.5001631853785901
[foolsgold agg] wv: [0.91258057 1.         1.         0.56275776 1.         0.91258057
 0.         1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.6875, Accuracy: 8734/10000 (87.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.1209, Accuracy: 8731/8991 (97.1082%)
Done in 262.74183797836304 sec.
Server Epoch:29 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
___Train Local_Simple,  epoch  29, local model 58, internal_epoch   1,  Average loss: 0.0077, Accuracy: 450/510 (88.2353%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2714, Accuracy: 9139/10000 (91.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 90, internal_epoch   1,  Average loss: 0.0084, Accuracy: 500/577 (86.6551%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4304, Accuracy: 8667/10000 (86.6700%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0019, Accuracy: 648/668 (97.0060%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   2,  Average loss: 0.0017, Accuracy: 645/668 (96.5569%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   3,  Average loss: 0.0012, Accuracy: 656/668 (98.2036%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   4,  Average loss: 0.0004, Accuracy: 663/668 (99.2515%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   5,  Average loss: 0.0003, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   6,  Average loss: 0.0002, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   7,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.410811307891.
Norm before scaling: 16.368967124311688. Distance: 1.5555471219485106
Total norm for 5 adversaries is: 16.368967124311688. distance: 1.5555471219485106
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0884, Accuracy: 8758/8991 (97.4085%)
___Train Local_Simple,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.0053, Accuracy: 478/529 (90.3592%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2853, Accuracy: 9090/10000 (90.9000%), Attack Success Rate:0/10000(0.000)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0023, Accuracy: 634/652 (97.2393%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0012, Accuracy: 631/652 (96.7791%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0006, Accuracy: 645/652 (98.9264%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 650/652 (99.6933%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 16.410811307891.
Norm before scaling: 16.35229875462612. Distance: 1.5507426605419912
Total norm for 5 adversaries is: 16.35229875462612. distance: 1.5507426605419912
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1083, Accuracy: 8696/8991 (96.7189%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0021, Accuracy: 561/582 (96.3918%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   2,  Average loss: 0.0008, Accuracy: 573/582 (98.4536%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   3,  Average loss: 0.0003, Accuracy: 579/582 (99.4845%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   4,  Average loss: 0.0002, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   5,  Average loss: 0.0002, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 16.410811307891.
Norm before scaling: 16.358536459227967. Distance: 1.3440452960930405
Total norm for 5 adversaries is: 16.358536459227967. distance: 1.3440452960930405
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0969, Accuracy: 8737/8991 (97.1750%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0021, Accuracy: 562/581 (96.7298%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   2,  Average loss: 0.0014, Accuracy: 567/581 (97.5904%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   3,  Average loss: 0.0005, Accuracy: 575/581 (98.9673%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   4,  Average loss: 0.0003, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   5,  Average loss: 0.0003, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   7,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   8,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   9,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch  10,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.410811307891.
Norm before scaling: 16.39343528547279. Distance: 1.50255121394512
Total norm for 5 adversaries is: 16.39343528547279. distance: 1.50255121394512
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1207, Accuracy: 8681/8991 (96.5521%)
___Train Local_Simple,  epoch  29, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 580/627 (92.5040%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2268, Accuracy: 9270/10000 (92.7000%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0019, Accuracy: 461/474 (97.2574%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0016, Accuracy: 462/474 (97.4684%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   3,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   4,  Average loss: 0.0002, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 16.410811307891.
Norm before scaling: 16.353660131818543. Distance: 1.2960361847329518
Total norm for 5 adversaries is: 16.353660131818543. distance: 1.2960361847329518
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1078, Accuracy: 8714/8991 (96.9191%)
___Train Local_Simple,  epoch  29, local model 57, internal_epoch   1,  Average loss: 0.0048, Accuracy: 517/568 (91.0211%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2356, Accuracy: 9263/10000 (92.6300%), Attack Success Rate:0/10000(0.000)
time spent on training: 97.95425605773926
[foolsgold agg] training data poison_ratio: 0.5126560332871013  data num: [510, 577, 668, 529, 652, 582, 581, 627, 474, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.5126560332871013
[foolsgold agg] wv: [0.29140009 1.         1.         0.         1.         1.
 1.         1.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.5963, Accuracy: 8759/10000 (87.5900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.1124, Accuracy: 8763/8991 (97.4641%)
Done in 262.0989828109741 sec.
Server Epoch:30 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   1,  Average loss: 0.0024, Accuracy: 460/474 (97.0464%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   2,  Average loss: 0.0010, Accuracy: 466/474 (98.3122%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   3,  Average loss: 0.0004, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   4,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 16.42983423912122.
Norm before scaling: 16.37167114899812. Distance: 1.1892405352854363
Total norm for 7 adversaries is: 16.37167114899812. distance: 1.1892405352854363
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1140, Accuracy: 8715/8991 (96.9303%)
___Train Local_Simple,  epoch  30, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 482/519 (92.8709%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2752, Accuracy: 9148/10000 (91.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0067, Accuracy: 568/626 (90.7348%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2272, Accuracy: 9425/10000 (94.2500%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   1,  Average loss: 0.0032, Accuracy: 600/625 (96.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   2,  Average loss: 0.0016, Accuracy: 604/625 (96.6400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   3,  Average loss: 0.0009, Accuracy: 613/625 (98.0800%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   4,  Average loss: 0.0006, Accuracy: 618/625 (98.8800%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   5,  Average loss: 0.0004, Accuracy: 620/625 (99.2000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   6,  Average loss: 0.0004, Accuracy: 622/625 (99.5200%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   7,  Average loss: 0.0003, Accuracy: 622/625 (99.5200%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   8,  Average loss: 0.0003, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   9,  Average loss: 0.0003, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch  10,  Average loss: 0.0003, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Global model norm: 16.42983423912122.
Norm before scaling: 16.346770902698566. Distance: 1.6199487526169916
Total norm for 7 adversaries is: 16.346770902698566. distance: 1.6199487526169916
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1011, Accuracy: 8736/8991 (97.1638%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 550/572 (96.1538%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   2,  Average loss: 0.0007, Accuracy: 560/572 (97.9021%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   3,  Average loss: 0.0006, Accuracy: 567/572 (99.1259%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.42983423912122.
Norm before scaling: 16.37800116372998. Distance: 1.4281026258322815
Total norm for 7 adversaries is: 16.37800116372998. distance: 1.4281026258322815
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1075, Accuracy: 8711/8991 (96.8858%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0022, Accuracy: 659/683 (96.4861%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   2,  Average loss: 0.0011, Accuracy: 667/683 (97.6574%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   3,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   4,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   5,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   6,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   7,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   8,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   9,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Global model norm: 16.42983423912122.
Norm before scaling: 16.39011110967525. Distance: 1.6702615671269754
Total norm for 7 adversaries is: 16.39011110967525. distance: 1.6702615671269754
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0926, Accuracy: 8759/8991 (97.4196%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0019, Accuracy: 543/563 (96.4476%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   2,  Average loss: 0.0005, Accuracy: 559/563 (99.2895%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   3,  Average loss: 0.0002, Accuracy: 561/563 (99.6448%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   7,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   8,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch  10,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 16.42983423912122.
Norm before scaling: 16.399327966830587. Distance: 1.3120288911639024
Total norm for 7 adversaries is: 16.399327966830587. distance: 1.3120288911639024
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1088, Accuracy: 8738/8991 (97.1861%)
___Train Local_Simple,  epoch  30, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 558/618 (90.2913%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2656, Accuracy: 9144/10000 (91.4400%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   1,  Average loss: 0.0022, Accuracy: 730/750 (97.3333%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   2,  Average loss: 0.0015, Accuracy: 727/750 (96.9333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   3,  Average loss: 0.0008, Accuracy: 739/750 (98.5333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   4,  Average loss: 0.0003, Accuracy: 745/750 (99.3333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   5,  Average loss: 0.0002, Accuracy: 748/750 (99.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   6,  Average loss: 0.0002, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 16.42983423912122.
Norm before scaling: 16.3683201800789. Distance: 1.65822728008025
Total norm for 7 adversaries is: 16.3683201800789. distance: 1.65822728008025
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0857, Accuracy: 8750/8991 (97.3195%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   1,  Average loss: 0.0016, Accuracy: 650/668 (97.3054%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   2,  Average loss: 0.0013, Accuracy: 650/668 (97.3054%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   3,  Average loss: 0.0009, Accuracy: 652/668 (97.6048%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   4,  Average loss: 0.0004, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   5,  Average loss: 0.0002, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.42983423912122.
Norm before scaling: 16.38962140933726. Distance: 1.3531057995145357
Total norm for 7 adversaries is: 16.38962140933726. distance: 1.3531057995145357
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0907, Accuracy: 8764/8991 (97.4753%)
time spent on training: 120.68793988227844
[foolsgold agg] training data poison_ratio: 0.7108888160052477  data num: [474, 519, 626, 625, 572, 683, 563, 618, 750, 668]
[foolsgold agg] considering poison per batch poison_fraction: 0.7108888160052477
[foolsgold agg] wv: [1.         0.         1.         0.84336766 1.         1.
 1.         0.         0.84336766 1.        ]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.6505, Accuracy: 8788/10000 (87.8800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.1041, Accuracy: 8780/8991 (97.6532%)
Done in 285.05957889556885 sec.
Server Epoch:31 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
___Train Local_Simple,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 575/626 (91.8530%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6180, Accuracy: 8694/10000 (86.9400%), Attack Success Rate:0/10000(0.000)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0029, Accuracy: 528/548 (96.3504%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   2,  Average loss: 0.0017, Accuracy: 532/548 (97.0803%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   3,  Average loss: 0.0008, Accuracy: 539/548 (98.3577%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   4,  Average loss: 0.0005, Accuracy: 544/548 (99.2701%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   5,  Average loss: 0.0003, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   6,  Average loss: 0.0002, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   7,  Average loss: 0.0002, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   8,  Average loss: 0.0002, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   9,  Average loss: 0.0002, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch  10,  Average loss: 0.0002, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Global model norm: 16.45578088725585.
Norm before scaling: 16.37999200804426. Distance: 1.416417305635459
Total norm for 7 adversaries is: 16.37999200804426. distance: 1.416417305635459
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0903, Accuracy: 8734/8991 (97.1416%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0007, Accuracy: 404/410 (98.5366%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.8515, Accuracy: 8680/10000 (86.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 85, internal_epoch   1,  Average loss: 0.0056, Accuracy: 515/570 (90.3509%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2683, Accuracy: 9181/10000 (91.8100%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0012, Accuracy: 576/587 (98.1261%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   2,  Average loss: 0.0003, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   3,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   4,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   5,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   6,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   7,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   9,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 16.45578088725585.
Norm before scaling: 16.409565327226545. Distance: 1.0906050562742946
Total norm for 7 adversaries is: 16.409565327226545. distance: 1.0906050562742946
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0986, Accuracy: 8746/8991 (97.2751%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0021, Accuracy: 624/644 (96.8944%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   2,  Average loss: 0.0006, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   3,  Average loss: 0.0003, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   4,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   5,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   6,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   7,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   8,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   9,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 16.45578088725585.
Norm before scaling: 16.393730342153674. Distance: 1.3530906020939528
Total norm for 7 adversaries is: 16.393730342153674. distance: 1.3530906020939528
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1155, Accuracy: 8709/8991 (96.8635%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   1,  Average loss: 0.0016, Accuracy: 562/578 (97.2318%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   2,  Average loss: 0.0010, Accuracy: 567/578 (98.0969%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   3,  Average loss: 0.0009, Accuracy: 569/578 (98.4429%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   4,  Average loss: 0.0002, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   5,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   6,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   7,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   8,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   9,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch  10,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 16.45578088725585.
Norm before scaling: 16.419290762114525. Distance: 1.3772907681804345
Total norm for 7 adversaries is: 16.419290762114525. distance: 1.3772907681804345
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1283, Accuracy: 8697/8991 (96.7301%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0016, Accuracy: 647/665 (97.2932%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   2,  Average loss: 0.0007, Accuracy: 652/665 (98.0451%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   3,  Average loss: 0.0004, Accuracy: 661/665 (99.3985%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   4,  Average loss: 0.0002, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.45578088725585.
Norm before scaling: 16.41042450610901. Distance: 1.3534131472327124
Total norm for 7 adversaries is: 16.41042450610901. distance: 1.3534131472327124
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0869, Accuracy: 8754/8991 (97.3640%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0028, Accuracy: 563/588 (95.7483%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   2,  Average loss: 0.0018, Accuracy: 566/588 (96.2585%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   3,  Average loss: 0.0005, Accuracy: 585/588 (99.4898%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   4,  Average loss: 0.0004, Accuracy: 586/588 (99.6599%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   5,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   6,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   7,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   8,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   9,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch  10,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.45578088725585.
Norm before scaling: 16.436836258284032. Distance: 1.71304706829051
Total norm for 7 adversaries is: 16.436836258284032. distance: 1.71304706829051
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1011, Accuracy: 8707/8991 (96.8413%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 568/582 (97.5945%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   2,  Average loss: 0.0012, Accuracy: 572/582 (98.2818%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   3,  Average loss: 0.0006, Accuracy: 576/582 (98.9691%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   4,  Average loss: 0.0003, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   5,  Average loss: 0.0002, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 16.45578088725585.
Norm before scaling: 16.420860309993277. Distance: 1.266525983945226
Total norm for 7 adversaries is: 16.420860309993277. distance: 1.266525983945226
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0991, Accuracy: 8754/8991 (97.3640%)
time spent on training: 120.265789270401
[foolsgold agg] training data poison_ratio: 0.7230079337702656  data num: [626, 548, 410, 570, 587, 644, 578, 665, 588, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.7230079337702656
[foolsgold agg] wv: [0.63072221 1.         1.         0.63072221 0.66030478 0.55214834
 0.78918563 0.11248994 0.11248994 1.        ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.7070, Accuracy: 8793/10000 (87.9300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.1011, Accuracy: 8784/8991 (97.6977%)
Done in 284.5351896286011 sec.
Server Epoch:32 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0056, Accuracy: 484/529 (91.4934%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4307, Accuracy: 8763/10000 (87.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.0043, Accuracy: 533/575 (92.6957%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2961, Accuracy: 8972/10000 (89.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 561/592 (94.7635%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2539, Accuracy: 9263/10000 (92.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 70, internal_epoch   1,  Average loss: 0.0060, Accuracy: 494/549 (89.9818%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4125, Accuracy: 8785/10000 (87.8500%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0020, Accuracy: 556/572 (97.2028%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   2,  Average loss: 0.0007, Accuracy: 562/572 (98.2517%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   3,  Average loss: 0.0003, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   4,  Average loss: 0.0002, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   5,  Average loss: 0.0002, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.46849056958849.
Norm before scaling: 16.400348641015988. Distance: 1.2365530089736427
Total norm for 2 adversaries is: 16.400348641015988. distance: 1.2365530089736427
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0888, Accuracy: 8767/8991 (97.5086%)
___Train Local_Simple,  epoch  32, local model 90, internal_epoch   1,  Average loss: 0.0049, Accuracy: 528/577 (91.5078%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5730, Accuracy: 8359/10000 (83.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 91, internal_epoch   1,  Average loss: 0.0066, Accuracy: 569/627 (90.7496%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3018, Accuracy: 9173/10000 (91.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 545/587 (92.8450%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3522, Accuracy: 8891/10000 (88.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 67, internal_epoch   1,  Average loss: 0.0081, Accuracy: 589/643 (91.6019%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.5131, Accuracy: 6590/10000 (65.9000%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0029, Accuracy: 532/553 (96.2025%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   2,  Average loss: 0.0010, Accuracy: 542/553 (98.0108%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   3,  Average loss: 0.0006, Accuracy: 548/553 (99.0958%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   4,  Average loss: 0.0004, Accuracy: 550/553 (99.4575%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   5,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   6,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   7,  Average loss: 0.0002, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   8,  Average loss: 0.0002, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Global model norm: 16.46849056958849.
Norm before scaling: 16.41364416708703. Distance: 1.4184385419943866
Total norm for 2 adversaries is: 16.41364416708703. distance: 1.4184385419943866
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0912, Accuracy: 8750/8991 (97.3195%)
time spent on training: 65.09996604919434
[foolsgold agg] training data poison_ratio: 0.19383184011026877  data num: [529, 575, 592, 549, 572, 577, 627, 587, 643, 553]
[foolsgold agg] considering poison per batch poison_fraction: 0.19383184011026877
[foolsgold agg] wv: [0.         1.         0.33773312 0.         1.         0.49445118
 0.5356323  0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.6279, Accuracy: 8800/10000 (88.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.0987, Accuracy: 8783/8991 (97.6866%)
Done in 229.39632415771484 sec.
Server Epoch:33 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
___Train Local_Simple,  epoch  33, local model 77, internal_epoch   1,  Average loss: 0.0038, Accuracy: 487/519 (93.8343%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2680, Accuracy: 9241/10000 (92.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0041, Accuracy: 529/568 (93.1338%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2954, Accuracy: 8994/10000 (89.9400%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   1,  Average loss: 0.0024, Accuracy: 608/625 (97.2800%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   2,  Average loss: 0.0015, Accuracy: 607/625 (97.1200%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   3,  Average loss: 0.0006, Accuracy: 621/625 (99.3600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   4,  Average loss: 0.0004, Accuracy: 622/625 (99.5200%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   5,  Average loss: 0.0003, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   6,  Average loss: 0.0003, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   7,  Average loss: 0.0002, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   8,  Average loss: 0.0002, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   9,  Average loss: 0.0002, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch  10,  Average loss: 0.0002, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Global model norm: 16.467643686156766.
Norm before scaling: 16.389616754320876. Distance: 1.4131484897690891
Total norm for 4 adversaries is: 16.389616754320876. distance: 1.4131484897690891
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0906, Accuracy: 8740/8991 (97.2083%)
___Train Local_Simple,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.0099, Accuracy: 546/643 (84.9145%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.8206, Accuracy: 7812/10000 (78.1200%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0023, Accuracy: 521/535 (97.3832%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   2,  Average loss: 0.0006, Accuracy: 530/535 (99.0654%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   3,  Average loss: 0.0003, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   4,  Average loss: 0.0002, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 16.467643686156766.
Norm before scaling: 16.405309682874496. Distance: 1.2041597251736016
Total norm for 4 adversaries is: 16.405309682874496. distance: 1.2041597251736016
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.1015, Accuracy: 8719/8991 (96.9748%)
___Train Local_Simple,  epoch  33, local model 97, internal_epoch   1,  Average loss: 0.0057, Accuracy: 527/588 (89.6259%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5146, Accuracy: 8287/10000 (82.8700%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0031, Accuracy: 639/665 (96.0902%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   2,  Average loss: 0.0013, Accuracy: 653/665 (98.1955%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   3,  Average loss: 0.0010, Accuracy: 655/665 (98.4962%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   4,  Average loss: 0.0005, Accuracy: 661/665 (99.3985%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   5,  Average loss: 0.0003, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   6,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   7,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   8,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   9,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch  10,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.467643686156766.
Norm before scaling: 16.40642485025874. Distance: 1.6233076673328612
Total norm for 4 adversaries is: 16.40642485025874. distance: 1.6233076673328612
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.1042, Accuracy: 8696/8991 (96.7189%)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   1,  Average loss: 0.0021, Accuracy: 510/531 (96.0452%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   2,  Average loss: 0.0015, Accuracy: 519/531 (97.7401%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   3,  Average loss: 0.0004, Accuracy: 529/531 (99.6234%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   4,  Average loss: 0.0002, Accuracy: 530/531 (99.8117%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   5,  Average loss: 0.0002, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   6,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   7,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   8,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   9,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch  10,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Global model norm: 16.467643686156766.
Norm before scaling: 16.440839653013278. Distance: 1.3687690524512761
Total norm for 4 adversaries is: 16.440839653013278. distance: 1.3687690524512761
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0981, Accuracy: 8765/8991 (97.4864%)
___Train Local_Simple,  epoch  33, local model 70, internal_epoch   1,  Average loss: 0.0050, Accuracy: 498/549 (90.7104%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3138, Accuracy: 9072/10000 (90.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0035, Accuracy: 495/529 (93.5728%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1481, Accuracy: 9561/10000 (95.6100%), Attack Success Rate:0/10000(0.000)
time spent on training: 86.96243524551392
[foolsgold agg] training data poison_ratio: 0.4095966620305981  data num: [519, 568, 625, 643, 535, 588, 665, 531, 549, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.4095966620305981
[foolsgold agg] wv: [0.01195772 0.         1.         0.64962783 1.         0.6012459
 1.         1.         0.01195772 0.        ]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.6163, Accuracy: 8804/10000 (88.0400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.0967, Accuracy: 8791/8991 (97.7756%)
Done in 251.2619321346283 sec.
Server Epoch:34 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 629/641 (98.1279%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   2,  Average loss: 0.0006, Accuracy: 631/641 (98.4399%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   3,  Average loss: 0.0004, Accuracy: 635/641 (99.0640%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   4,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   6,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 16.483977890655197.
Norm before scaling: 16.43875685843614. Distance: 1.1767372984305022
Total norm for 7 adversaries is: 16.43875685843614. distance: 1.1767372984305022
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1064, Accuracy: 8748/8991 (97.2973%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0016, Accuracy: 500/516 (96.8992%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   2,  Average loss: 0.0004, Accuracy: 512/516 (99.2248%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   3,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   4,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   5,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   6,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   7,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   8,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   9,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch  10,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 16.483977890655197.
Norm before scaling: 16.43314666538858. Distance: 1.086371575192667
Total norm for 7 adversaries is: 16.43314666538858. distance: 1.086371575192667
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0995, Accuracy: 8760/8991 (97.4308%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0019, Accuracy: 634/652 (97.2393%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0009, Accuracy: 642/652 (98.4663%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0006, Accuracy: 646/652 (99.0798%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 16.483977890655197.
Norm before scaling: 16.400440749781982. Distance: 1.3431008567432985
Total norm for 7 adversaries is: 16.400440749781982. distance: 1.3431008567432985
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0943, Accuracy: 8741/8991 (97.2194%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0007, Accuracy: 468/474 (98.7342%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   3,  Average loss: 0.0002, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   4,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 16.483977890655197.
Norm before scaling: 16.426723646420164. Distance: 0.9636911465280014
Total norm for 7 adversaries is: 16.426723646420164. distance: 0.9636911465280014
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0987, Accuracy: 8763/8991 (97.4641%)
___Train Local_Simple,  epoch  34, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 582/638 (91.2226%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2047, Accuracy: 9363/10000 (93.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 60, internal_epoch   1,  Average loss: 0.0046, Accuracy: 592/644 (91.9255%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2620, Accuracy: 9214/10000 (92.1400%), Attack Success Rate:0/10000(0.000)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0017, Accuracy: 644/665 (96.8421%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   2,  Average loss: 0.0015, Accuracy: 646/665 (97.1429%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   3,  Average loss: 0.0007, Accuracy: 653/665 (98.1955%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   4,  Average loss: 0.0003, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   5,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.483977890655197.
Norm before scaling: 16.471371870873227. Distance: 1.563852868908473
Total norm for 7 adversaries is: 16.471371870873227. distance: 1.563852868908473
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0968, Accuracy: 8731/8991 (97.1082%)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0045, Accuracy: 514/555 (92.6126%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2289, Accuracy: 9281/10000 (92.8100%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 516/526 (98.0989%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   2,  Average loss: 0.0005, Accuracy: 517/526 (98.2890%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   3,  Average loss: 0.0003, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   4,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 16.483977890655197.
Norm before scaling: 16.437338476511528. Distance: 1.000590507680064
Total norm for 7 adversaries is: 16.437338476511528. distance: 1.000590507680064
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0984, Accuracy: 8769/8991 (97.5309%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   1,  Average loss: 0.0028, Accuracy: 572/589 (97.1138%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   2,  Average loss: 0.0013, Accuracy: 574/589 (97.4533%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   3,  Average loss: 0.0007, Accuracy: 583/589 (98.9813%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   4,  Average loss: 0.0002, Accuracy: 588/589 (99.8302%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   5,  Average loss: 0.0002, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   6,  Average loss: 0.0002, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   7,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   8,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   9,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch  10,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 16.483977890655197.
Norm before scaling: 16.476275409423923. Distance: 1.8002237048480803
Total norm for 7 adversaries is: 16.476275409423923. distance: 1.8002237048480803
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0943, Accuracy: 8726/8991 (97.0526%)
time spent on training: 118.74713897705078
[foolsgold agg] training data poison_ratio: 0.6886440677966101  data num: [641, 516, 652, 474, 638, 644, 665, 555, 526, 589]
[foolsgold agg] considering poison per batch poison_fraction: 0.6886440677966101
[foolsgold agg] wv: [1.         1.         0.84612568 0.84612568 0.41129372 0.83080808
 1.         0.41129372 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.6773, Accuracy: 8803/10000 (88.0300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.0926, Accuracy: 8791/8991 (97.7756%)
Done in 282.9120891094208 sec.
Server Epoch:35 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   1,  Average loss: 0.0018, Accuracy: 464/474 (97.8903%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   3,  Average loss: 0.0003, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   4,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 16.50558284753128.
Norm before scaling: 16.4481357063009. Distance: 0.966945320832054
Total norm for 6 adversaries is: 16.4481357063009. distance: 0.966945320832054
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1046, Accuracy: 8738/8991 (97.1861%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0035, Accuracy: 508/520 (97.6923%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   2,  Average loss: 0.0046, Accuracy: 491/520 (94.4231%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   3,  Average loss: 0.0028, Accuracy: 490/520 (94.2308%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   4,  Average loss: 0.0012, Accuracy: 512/520 (98.4615%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   5,  Average loss: 0.0007, Accuracy: 517/520 (99.4231%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   6,  Average loss: 0.0006, Accuracy: 517/520 (99.4231%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   7,  Average loss: 0.0009, Accuracy: 517/520 (99.4231%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   8,  Average loss: 0.0004, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   9,  Average loss: 0.0004, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch  10,  Average loss: 0.0004, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Global model norm: 16.50558284753128.
Norm before scaling: 16.590358351596116. Distance: 2.7397865152377054
Total norm for 6 adversaries is: 16.590358351596116. distance: 2.7397865152377054
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1172, Accuracy: 8683/8991 (96.5744%)
___Train Local_Simple,  epoch  35, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 570/617 (92.3825%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2471, Accuracy: 9232/10000 (92.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.0040, Accuracy: 593/635 (93.3858%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1741, Accuracy: 9504/10000 (95.0400%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0008, Accuracy: 629/638 (98.5893%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   2,  Average loss: 0.0007, Accuracy: 633/638 (99.2163%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   3,  Average loss: 0.0002, Accuracy: 634/638 (99.3730%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 16.50558284753128.
Norm before scaling: 16.44818580154387. Distance: 0.9663138984584688
Total norm for 6 adversaries is: 16.44818580154387. distance: 0.9663138984584688
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0917, Accuracy: 8773/8991 (97.5754%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 563/582 (96.7354%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   2,  Average loss: 0.0026, Accuracy: 559/582 (96.0481%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   3,  Average loss: 0.0006, Accuracy: 576/582 (98.9691%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   4,  Average loss: 0.0004, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   5,  Average loss: 0.0002, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 16.50558284753128.
Norm before scaling: 16.581888158245977. Distance: 1.955089100321966
Total norm for 6 adversaries is: 16.581888158245977. distance: 1.955089100321966
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0885, Accuracy: 8764/8991 (97.4753%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0023, Accuracy: 554/572 (96.8531%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   2,  Average loss: 0.0006, Accuracy: 565/572 (98.7762%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   3,  Average loss: 0.0004, Accuracy: 568/572 (99.3007%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   4,  Average loss: 0.0003, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   5,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.50558284753128.
Norm before scaling: 16.43865475387775. Distance: 1.2484736660527809
Total norm for 6 adversaries is: 16.43865475387775. distance: 1.2484736660527809
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0853, Accuracy: 8780/8991 (97.6532%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 586/606 (96.6997%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   2,  Average loss: 0.0016, Accuracy: 588/606 (97.0297%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   3,  Average loss: 0.0014, Accuracy: 590/606 (97.3597%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   4,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   5,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   7,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 16.50558284753128.
Norm before scaling: 16.437653167359098. Distance: 1.5040730173364232
Total norm for 6 adversaries is: 16.437653167359098. distance: 1.5040730173364232
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0994, Accuracy: 8714/8991 (96.9191%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0066, Accuracy: 499/573 (87.0855%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3623, Accuracy: 8877/10000 (88.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 98, internal_epoch   1,  Average loss: 0.0027, Accuracy: 538/568 (94.7183%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1817, Accuracy: 9480/10000 (94.8000%), Attack Success Rate:0/10000(0.000)
time spent on training: 106.79613089561462
[foolsgold agg] training data poison_ratio: 0.5863439930855662  data num: [474, 520, 617, 635, 638, 582, 572, 606, 573, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.5863439930855662
[foolsgold agg] wv: [1.         1.         0.         0.06708783 1.         1.
 1.         1.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.7212, Accuracy: 8799/10000 (87.9900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.0958, Accuracy: 8792/8991 (97.7867%)
Done in 271.0086569786072 sec.
Server Epoch:36 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  36, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 567/621 (91.3043%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2538, Accuracy: 9231/10000 (92.3100%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 576/587 (98.1261%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   2,  Average loss: 0.0014, Accuracy: 574/587 (97.7853%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   3,  Average loss: 0.0007, Accuracy: 579/587 (98.6371%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   4,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   5,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   6,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   7,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   8,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   9,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch  10,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 16.535179781609763.
Norm before scaling: 16.568212826660915. Distance: 1.7702645304578752
Total norm for 5 adversaries is: 16.568212826660915. distance: 1.7702645304578752
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0941, Accuracy: 8750/8991 (97.3195%)
___Train Local_Simple,  epoch  36, local model 79, internal_epoch   1,  Average loss: 0.0032, Accuracy: 600/635 (94.4882%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2038, Accuracy: 9402/10000 (94.0200%), Attack Success Rate:0/10000(0.000)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0014, Accuracy: 599/609 (98.3580%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   2,  Average loss: 0.0008, Accuracy: 598/609 (98.1938%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   3,  Average loss: 0.0012, Accuracy: 595/609 (97.7011%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   4,  Average loss: 0.0003, Accuracy: 603/609 (99.0148%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   8,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   9,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch  10,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 16.535179781609763.
Norm before scaling: 16.47096981600317. Distance: 1.1126825697177405
Total norm for 5 adversaries is: 16.47096981600317. distance: 1.1126825697177405
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0927, Accuracy: 8744/8991 (97.2528%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   1,  Average loss: 0.0026, Accuracy: 584/602 (97.0100%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   2,  Average loss: 0.0008, Accuracy: 591/602 (98.1728%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   3,  Average loss: 0.0004, Accuracy: 599/602 (99.5017%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   4,  Average loss: 0.0004, Accuracy: 601/602 (99.8339%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   5,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   6,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   7,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   8,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   9,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch  10,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 16.535179781609763.
Norm before scaling: 16.45408576848202. Distance: 1.3715073268776723
Total norm for 5 adversaries is: 16.45408576848202. distance: 1.3715073268776723
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0821, Accuracy: 8774/8991 (97.5865%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   1,  Average loss: 0.0017, Accuracy: 504/518 (97.2973%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   2,  Average loss: 0.0019, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   3,  Average loss: 0.0034, Accuracy: 488/518 (94.2085%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   4,  Average loss: 0.0006, Accuracy: 510/518 (98.4556%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   5,  Average loss: 0.0002, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   6,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   7,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   8,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   9,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch  10,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 16.535179781609763.
Norm before scaling: 16.515955752955797. Distance: 1.4199923953000455
Total norm for 5 adversaries is: 16.515955752955797. distance: 1.4199923953000455
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0865, Accuracy: 8778/8991 (97.6310%)
___Train Local_Simple,  epoch  36, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 626/664 (94.2771%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2935, Accuracy: 9100/10000 (91.0000%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   1,  Average loss: 0.0017, Accuracy: 572/589 (97.1138%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 584/589 (99.1511%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   3,  Average loss: 0.0005, Accuracy: 585/589 (99.3209%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 16.535179781609763.
Norm before scaling: 16.48711192474718. Distance: 1.2665273487287276
Total norm for 5 adversaries is: 16.48711192474718. distance: 1.2665273487287276
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0905, Accuracy: 8764/8991 (97.4753%)
___Train Local_Simple,  epoch  36, local model 70, internal_epoch   1,  Average loss: 0.0056, Accuracy: 500/549 (91.0747%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3923, Accuracy: 8776/10000 (87.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 77, internal_epoch   1,  Average loss: 0.0031, Accuracy: 490/519 (94.4123%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2030, Accuracy: 9373/10000 (93.7300%), Attack Success Rate:0/10000(0.000)
time spent on training: 97.25263905525208
[foolsgold agg] training data poison_ratio: 0.49295774647887325  data num: [621, 587, 635, 609, 602, 518, 664, 589, 549, 519]
[foolsgold agg] considering poison per batch poison_fraction: 0.49295774647887325
[foolsgold agg] wv: [0. 1. 0. 1. 1. 1. 0. 1. 0. 0.]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.7714, Accuracy: 8791/10000 (87.9100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.0969, Accuracy: 8778/8991 (97.6310%)
Done in 261.8330810070038 sec.
Server Epoch:37 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0015, Accuracy: 635/650 (97.6923%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   2,  Average loss: 0.0007, Accuracy: 641/650 (98.6154%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   3,  Average loss: 0.0006, Accuracy: 645/650 (99.2308%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   4,  Average loss: 0.0003, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 16.55256740789684.
Norm before scaling: 16.515478099216597. Distance: 1.3604996074183864
Total norm for 7 adversaries is: 16.515478099216597. distance: 1.3604996074183864
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0888, Accuracy: 8756/8991 (97.3863%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0023, Accuracy: 645/668 (96.5569%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0013, Accuracy: 649/668 (97.1557%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   3,  Average loss: 0.0008, Accuracy: 660/668 (98.8024%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   4,  Average loss: 0.0004, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   5,  Average loss: 0.0003, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   6,  Average loss: 0.0002, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   7,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.55256740789684.
Norm before scaling: 16.523079192332577. Distance: 1.589005307769073
Total norm for 7 adversaries is: 16.523079192332577. distance: 1.589005307769073
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0908, Accuracy: 8766/8991 (97.4975%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   1,  Average loss: 0.0011, Accuracy: 626/638 (98.1191%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   2,  Average loss: 0.0005, Accuracy: 631/638 (98.9028%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   3,  Average loss: 0.0002, Accuracy: 636/638 (99.6865%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   6,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 16.55256740789684.
Norm before scaling: 16.490549791376726. Distance: 1.0282286687373183
Total norm for 7 adversaries is: 16.490549791376726. distance: 1.0282286687373183
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0864, Accuracy: 8773/8991 (97.5754%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0022, Accuracy: 633/652 (97.0859%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0008, Accuracy: 641/652 (98.3129%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 646/652 (99.0798%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0004, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 16.55256740789684.
Norm before scaling: 16.476205951274952. Distance: 1.3764613362267966
Total norm for 7 adversaries is: 16.476205951274952. distance: 1.3764613362267966
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0998, Accuracy: 8732/8991 (97.1193%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0017, Accuracy: 496/512 (96.8750%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   2,  Average loss: 0.0007, Accuracy: 506/512 (98.8281%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   3,  Average loss: 0.0002, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   4,  Average loss: 0.0002, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   5,  Average loss: 0.0002, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   7,  Average loss: 0.0001, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   8,  Average loss: 0.0001, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   9,  Average loss: 0.0001, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch  10,  Average loss: 0.0001, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Global model norm: 16.55256740789684.
Norm before scaling: 16.511076937047253. Distance: 1.1500416665199813
Total norm for 7 adversaries is: 16.511076937047253. distance: 1.1500416665199813
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1006, Accuracy: 8746/8991 (97.2751%)
___Train Local_Simple,  epoch  37, local model 52, internal_epoch   1,  Average loss: 0.0046, Accuracy: 572/618 (92.5566%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1768, Accuracy: 9455/10000 (94.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.0042, Accuracy: 520/560 (92.8571%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2108, Accuracy: 9350/10000 (93.5000%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0026, Accuracy: 504/518 (97.2973%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   2,  Average loss: 0.0049, Accuracy: 473/518 (91.3127%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   3,  Average loss: 0.0015, Accuracy: 502/518 (96.9112%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   4,  Average loss: 0.0009, Accuracy: 512/518 (98.8417%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   5,  Average loss: 0.0006, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   6,  Average loss: 0.0004, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   7,  Average loss: 0.0003, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   8,  Average loss: 0.0003, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   9,  Average loss: 0.0002, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch  10,  Average loss: 0.0003, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Global model norm: 16.55256740789684.
Norm before scaling: 16.75329557423423. Distance: 3.1458646423263916
Total norm for 7 adversaries is: 16.75329557423423. distance: 3.1458646423263916
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1207, Accuracy: 8665/8991 (96.3742%)
___Train Local_Simple,  epoch  37, local model 62, internal_epoch   1,  Average loss: 0.0058, Accuracy: 557/617 (90.2755%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2604, Accuracy: 9161/10000 (91.6100%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0018, Accuracy: 506/516 (98.0620%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   2,  Average loss: 0.0005, Accuracy: 512/516 (99.2248%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   3,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   4,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 16.55256740789684.
Norm before scaling: 16.489498611332152. Distance: 1.0484854992767443
Total norm for 7 adversaries is: 16.489498611332152. distance: 1.0484854992767443
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0922, Accuracy: 8763/8991 (97.4641%)
time spent on training: 118.77259612083435
[foolsgold agg] training data poison_ratio: 0.6982686165742141  data num: [650, 668, 638, 652, 512, 618, 560, 518, 617, 516]
[foolsgold agg] considering poison per batch poison_fraction: 0.6982686165742141
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.15985577
 0.15985577 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.8200, Accuracy: 8792/10000 (87.9200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.0966, Accuracy: 8784/8991 (97.6977%)
Done in 285.0085480213165 sec.
Server Epoch:38 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0013, Accuracy: 488/503 (97.0179%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   2,  Average loss: 0.0005, Accuracy: 499/503 (99.2048%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 16.583000652612036.
Norm before scaling: 16.54974449859423. Distance: 1.034524228029398
Total norm for 5 adversaries is: 16.54974449859423. distance: 1.034524228029398
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.1007, Accuracy: 8764/8991 (97.4753%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   1,  Average loss: 0.0028, Accuracy: 581/605 (96.0331%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   2,  Average loss: 0.0017, Accuracy: 589/605 (97.3554%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   3,  Average loss: 0.0008, Accuracy: 596/605 (98.5124%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   4,  Average loss: 0.0004, Accuracy: 600/605 (99.1736%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   5,  Average loss: 0.0002, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   8,  Average loss: 0.0002, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 16.583000652612036.
Norm before scaling: 16.56660197582445. Distance: 1.6452777101727565
Total norm for 5 adversaries is: 16.56660197582445. distance: 1.6452777101727565
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0949, Accuracy: 8750/8991 (97.3195%)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0043, Accuracy: 531/575 (92.3478%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2078, Accuracy: 9392/10000 (93.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0066, Accuracy: 560/624 (89.7436%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3257, Accuracy: 8880/10000 (88.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0050, Accuracy: 568/617 (92.0583%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1747, Accuracy: 9469/10000 (94.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 83, internal_epoch   1,  Average loss: 0.0059, Accuracy: 507/555 (91.3514%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2497, Accuracy: 9200/10000 (92.0000%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0012, Accuracy: 537/552 (97.2826%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   2,  Average loss: 0.0004, Accuracy: 547/552 (99.0942%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   3,  Average loss: 0.0005, Accuracy: 547/552 (99.0942%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   4,  Average loss: 0.0002, Accuracy: 550/552 (99.6377%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   5,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   6,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   7,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   8,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   9,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch  10,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Global model norm: 16.583000652612036.
Norm before scaling: 16.557467174609805. Distance: 1.1547525348854364
Total norm for 5 adversaries is: 16.557467174609805. distance: 1.1547525348854364
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.1172, Accuracy: 8727/8991 (97.0637%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   1,  Average loss: 0.0020, Accuracy: 730/750 (97.3333%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   2,  Average loss: 0.0008, Accuracy: 738/750 (98.4000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   3,  Average loss: 0.0004, Accuracy: 746/750 (99.4667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   4,  Average loss: 0.0002, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   5,  Average loss: 0.0002, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 16.583000652612036.
Norm before scaling: 16.504160038729157. Distance: 1.4585171810703559
Total norm for 5 adversaries is: 16.504160038729157. distance: 1.4585171810703559
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0859, Accuracy: 8757/8991 (97.3974%)
___Train Local_Simple,  epoch  38, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 559/618 (90.4531%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2847, Accuracy: 9059/10000 (90.5900%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0011, Accuracy: 630/648 (97.2222%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 640/648 (98.7654%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   3,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.583000652612036.
Norm before scaling: 16.532945513534955. Distance: 1.2419825450788664
Total norm for 5 adversaries is: 16.532945513534955. distance: 1.2419825450788664
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.1123, Accuracy: 8727/8991 (97.0637%)
time spent on training: 99.91200518608093
[foolsgold agg] training data poison_ratio: 0.505705308417397  data num: [503, 605, 575, 624, 617, 555, 552, 750, 618, 648]
[foolsgold agg] considering poison per batch poison_fraction: 0.505705308417397
[foolsgold agg] wv: [1.         1.         0.03193597 0.03193597 0.         0.
 1.         1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.9393, Accuracy: 8793/10000 (87.9300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.1000, Accuracy: 8782/8991 (97.6755%)
Done in 266.0601351261139 sec.
Server Epoch:39 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0013, Accuracy: 492/505 (97.4257%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   2,  Average loss: 0.0006, Accuracy: 501/505 (99.2079%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   3,  Average loss: 0.0003, Accuracy: 502/505 (99.4059%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   4,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   5,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   6,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   7,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   8,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   9,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch  10,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Global model norm: 16.60099171812909.
Norm before scaling: 16.575819194912263. Distance: 1.1342534864513751
Total norm for 7 adversaries is: 16.575819194912263. distance: 1.1342534864513751
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1371, Accuracy: 8686/8991 (96.6077%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   1,  Average loss: 0.0028, Accuracy: 509/528 (96.4015%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   2,  Average loss: 0.0017, Accuracy: 509/528 (96.4015%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   3,  Average loss: 0.0008, Accuracy: 519/528 (98.2955%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   4,  Average loss: 0.0003, Accuracy: 527/528 (99.8106%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   5,  Average loss: 0.0002, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   6,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   7,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   8,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   9,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch  10,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Global model norm: 16.60099171812909.
Norm before scaling: 16.554969543963605. Distance: 1.4994450973274387
Total norm for 7 adversaries is: 16.554969543963605. distance: 1.4994450973274387
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0961, Accuracy: 8735/8991 (97.1527%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   1,  Average loss: 0.0013, Accuracy: 600/609 (98.5222%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   2,  Average loss: 0.0003, Accuracy: 604/609 (99.1790%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   3,  Average loss: 0.0001, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 16.60099171812909.
Norm before scaling: 16.530976781768675. Distance: 1.0897979726714069
Total norm for 7 adversaries is: 16.530976781768675. distance: 1.0897979726714069
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0945, Accuracy: 8765/8991 (97.4864%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0013, Accuracy: 500/512 (97.6562%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   2,  Average loss: 0.0009, Accuracy: 505/512 (98.6328%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   3,  Average loss: 0.0004, Accuracy: 504/512 (98.4375%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   4,  Average loss: 0.0002, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   7,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   8,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   9,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch  10,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Global model norm: 16.60099171812909.
Norm before scaling: 16.55939589868232. Distance: 1.1421680203510542
Total norm for 7 adversaries is: 16.55939589868232. distance: 1.1421680203510542
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0944, Accuracy: 8761/8991 (97.4419%)
___Train Local_Simple,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0080, Accuracy: 553/626 (88.3387%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3637, Accuracy: 9038/10000 (90.3800%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 518/535 (96.8224%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   2,  Average loss: 0.0009, Accuracy: 525/535 (98.1308%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   3,  Average loss: 0.0004, Accuracy: 531/535 (99.2523%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   4,  Average loss: 0.0002, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 16.60099171812909.
Norm before scaling: 16.53272308535976. Distance: 1.2895010000064517
Total norm for 7 adversaries is: 16.53272308535976. distance: 1.2895010000064517
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0963, Accuracy: 8727/8991 (97.0637%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   1,  Average loss: 0.0018, Accuracy: 547/563 (97.1581%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   2,  Average loss: 0.0006, Accuracy: 554/563 (98.4014%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   3,  Average loss: 0.0003, Accuracy: 560/563 (99.4671%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   4,  Average loss: 0.0002, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   7,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   8,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch  10,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 16.60099171812909.
Norm before scaling: 16.546604806280786. Distance: 1.2323686252703452
Total norm for 7 adversaries is: 16.546604806280786. distance: 1.2323686252703452
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0931, Accuracy: 8757/8991 (97.3974%)
___Train Local_Simple,  epoch  39, local model 88, internal_epoch   1,  Average loss: 0.0053, Accuracy: 614/679 (90.4271%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3318, Accuracy: 9054/10000 (90.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0056, Accuracy: 487/529 (92.0605%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4258, Accuracy: 8690/10000 (86.9000%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 501/521 (96.1612%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   2,  Average loss: 0.0042, Accuracy: 500/521 (95.9693%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   3,  Average loss: 0.0016, Accuracy: 506/521 (97.1209%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   4,  Average loss: 0.0007, Accuracy: 516/521 (99.0403%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   5,  Average loss: 0.0004, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   6,  Average loss: 0.0003, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   7,  Average loss: 0.0002, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   8,  Average loss: 0.0002, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   9,  Average loss: 0.0002, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch  10,  Average loss: 0.0002, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 16.60099171812909.
Norm before scaling: 16.688878834655505. Distance: 2.659907437198312
Total norm for 7 adversaries is: 16.688878834655505. distance: 2.659907437198312
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1104, Accuracy: 8703/8991 (96.7968%)
time spent on training: 115.33290529251099
[foolsgold agg] training data poison_ratio: 0.6729088639200999  data num: [505, 528, 609, 512, 626, 535, 563, 679, 529, 521]
[foolsgold agg] considering poison per batch poison_fraction: 0.6729088639200999
[foolsgold agg] wv: [1.         1.         1.         1.         0.         0.96000518
 1.         1.         0.         0.96000518]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.9138, Accuracy: 8805/10000 (88.0500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.0925, Accuracy: 8798/8991 (97.8534%)
Done in 282.23993706703186 sec.
Server Epoch:40 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0022, Accuracy: 573/597 (95.9799%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   2,  Average loss: 0.0013, Accuracy: 582/597 (97.4874%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   3,  Average loss: 0.0010, Accuracy: 580/597 (97.1524%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   4,  Average loss: 0.0003, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   5,  Average loss: 0.0002, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   6,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   8,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   9,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch  10,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Global model norm: 16.622021401110768.
Norm before scaling: 16.589495614577732. Distance: 1.5439025371110382
Total norm for 3 adversaries is: 16.589495614577732. distance: 1.5439025371110382
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0839, Accuracy: 8770/8991 (97.5420%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   1,  Average loss: 0.0024, Accuracy: 570/588 (96.9388%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   2,  Average loss: 0.0020, Accuracy: 562/588 (95.5782%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   3,  Average loss: 0.0017, Accuracy: 572/588 (97.2789%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   4,  Average loss: 0.0008, Accuracy: 582/588 (98.9796%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   5,  Average loss: 0.0004, Accuracy: 586/588 (99.6599%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   6,  Average loss: 0.0003, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   7,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   8,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   9,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch  10,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Global model norm: 16.622021401110768.
Norm before scaling: 16.59680998151452. Distance: 1.751870790245831
Total norm for 3 adversaries is: 16.59680998151452. distance: 1.751870790245831
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0805, Accuracy: 8768/8991 (97.5197%)
___Train Local_Simple,  epoch  40, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 531/575 (92.3478%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2073, Accuracy: 9350/10000 (93.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 98, internal_epoch   1,  Average loss: 0.0055, Accuracy: 515/568 (90.6690%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3393, Accuracy: 9025/10000 (90.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0051, Accuracy: 599/647 (92.5811%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2350, Accuracy: 9284/10000 (92.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 83, internal_epoch   1,  Average loss: 0.0071, Accuracy: 499/555 (89.9099%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3249, Accuracy: 8893/10000 (88.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0050, Accuracy: 574/618 (92.8803%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1934, Accuracy: 9362/10000 (93.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 90, internal_epoch   1,  Average loss: 0.0057, Accuracy: 523/577 (90.6412%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4954, Accuracy: 8411/10000 (84.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 584/638 (91.5361%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2163, Accuracy: 9333/10000 (93.3300%), Attack Success Rate:0/10000(0.000)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0020, Accuracy: 624/644 (96.8944%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   2,  Average loss: 0.0011, Accuracy: 629/644 (97.6708%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   4,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   5,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   6,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   7,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   8,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   9,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 16.622021401110768.
Norm before scaling: 16.567208941441372. Distance: 1.4619213198352345
Total norm for 3 adversaries is: 16.567208941441372. distance: 1.4619213198352345
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.1051, Accuracy: 8701/8991 (96.7746%)
time spent on training: 79.49596691131592
[foolsgold agg] training data poison_ratio: 0.30447810887298155  data num: [597, 588, 575, 568, 647, 555, 618, 577, 638, 644]
[foolsgold agg] considering poison per batch poison_fraction: 0.30447810887298155
[foolsgold agg] wv: [1.         1.         0.37900766 0.         1.         0.
 0.0641369  0.94236117 0.67532127 1.        ]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.7374, Accuracy: 8802/10000 (88.0200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.0898, Accuracy: 8802/8991 (97.8979%)
Done in 245.03707098960876 sec.
Server Epoch:41 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
___Train Local_Simple,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0046, Accuracy: 603/647 (93.1994%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3391, Accuracy: 8927/10000 (89.2700%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   1,  Average loss: 0.0025, Accuracy: 645/665 (96.9925%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   2,  Average loss: 0.0018, Accuracy: 644/665 (96.8421%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   3,  Average loss: 0.0010, Accuracy: 656/665 (98.6466%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   4,  Average loss: 0.0005, Accuracy: 660/665 (99.2481%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   5,  Average loss: 0.0003, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   6,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   7,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   8,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.62987750789928.
Norm before scaling: 16.564297330249836. Distance: 1.565059549094511
Total norm for 6 adversaries is: 16.564297330249836. distance: 1.565059549094511
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0976, Accuracy: 8734/8991 (97.1416%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   1,  Average loss: 0.0023, Accuracy: 534/553 (96.5642%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   2,  Average loss: 0.0012, Accuracy: 539/553 (97.4684%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   3,  Average loss: 0.0005, Accuracy: 550/553 (99.4575%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   4,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   5,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   6,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   7,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   8,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Global model norm: 16.62987750789928.
Norm before scaling: 16.56388739766895. Distance: 1.3246260835161319
Total norm for 6 adversaries is: 16.56388739766895. distance: 1.3246260835161319
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0758, Accuracy: 8785/8991 (97.7088%)
___Train Local_Simple,  epoch  41, local model 95, internal_epoch   1,  Average loss: 0.0063, Accuracy: 483/532 (90.7895%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3585, Accuracy: 8755/10000 (87.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 503/555 (90.6306%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1771, Accuracy: 9444/10000 (94.4400%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0017, Accuracy: 506/516 (98.0620%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   2,  Average loss: 0.0011, Accuracy: 510/516 (98.8372%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   3,  Average loss: 0.0026, Accuracy: 500/516 (96.8992%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   4,  Average loss: 0.0007, Accuracy: 514/516 (99.6124%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 16.62987750789928.
Norm before scaling: 16.593635975361533. Distance: 1.2750831221618204
Total norm for 6 adversaries is: 16.593635975361533. distance: 1.2750831221618204
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0885, Accuracy: 8767/8991 (97.5086%)
___Train Local_Simple,  epoch  41, local model 55, internal_epoch   1,  Average loss: 0.0032, Accuracy: 568/592 (95.9459%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2067, Accuracy: 9356/10000 (93.5600%), Attack Success Rate:0/10000(0.000)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0012, Accuracy: 650/665 (97.7444%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   2,  Average loss: 0.0004, Accuracy: 657/665 (98.7970%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   3,  Average loss: 0.0005, Accuracy: 661/665 (99.3985%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   4,  Average loss: 0.0002, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.62987750789928.
Norm before scaling: 16.577052679445444. Distance: 1.201106917943192
Total norm for 6 adversaries is: 16.577052679445444. distance: 1.201106917943192
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0882, Accuracy: 8772/8991 (97.5642%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   1,  Average loss: 0.0015, Accuracy: 586/605 (96.8595%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   2,  Average loss: 0.0007, Accuracy: 598/605 (98.8430%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   3,  Average loss: 0.0004, Accuracy: 601/605 (99.3388%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 16.62987750789928.
Norm before scaling: 16.578722339909916. Distance: 1.159658305880795
Total norm for 6 adversaries is: 16.578722339909916. distance: 1.159658305880795
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0941, Accuracy: 8767/8991 (97.5086%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   1,  Average loss: 0.0021, Accuracy: 461/478 (96.4435%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   2,  Average loss: 0.0005, Accuracy: 474/478 (99.1632%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   3,  Average loss: 0.0002, Accuracy: 477/478 (99.7908%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   4,  Average loss: 0.0001, Accuracy: 477/478 (99.7908%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   5,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   6,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   7,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   8,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 16.62987750789928.
Norm before scaling: 16.602788557667804. Distance: 1.300447117502841
Total norm for 6 adversaries is: 16.602788557667804. distance: 1.300447117502841
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0921, Accuracy: 8757/8991 (97.3974%)
time spent on training: 108.4795458316803
[foolsgold agg] training data poison_ratio: 0.5995179063360881  data num: [647, 665, 553, 532, 555, 516, 592, 665, 605, 478]
[foolsgold agg] considering poison per batch poison_fraction: 0.5995179063360881
[foolsgold agg] wv: [0.49481079 0.93883073 1.         1.         0.01275913 0.93883073
 0.01275913 0.98244677 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.8159, Accuracy: 8809/10000 (88.0900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.0928, Accuracy: 8799/8991 (97.8645%)
Done in 274.1620581150055 sec.
Server Epoch:42 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0040, Accuracy: 537/575 (93.3913%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2071, Accuracy: 9348/10000 (93.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0074, Accuracy: 563/626 (89.9361%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2437, Accuracy: 9427/10000 (94.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 89, internal_epoch   1,  Average loss: 0.0041, Accuracy: 628/664 (94.5783%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2525, Accuracy: 9217/10000 (92.1700%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0018, Accuracy: 575/589 (97.6231%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   2,  Average loss: 0.0011, Accuracy: 578/589 (98.1324%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   3,  Average loss: 0.0008, Accuracy: 578/589 (98.1324%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   4,  Average loss: 0.0002, Accuracy: 587/589 (99.6604%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   7,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   8,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   9,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch  10,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 16.64770059373347.
Norm before scaling: 16.61476037898747. Distance: 1.333354974610811
Total norm for 4 adversaries is: 16.61476037898747. distance: 1.333354974610811
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0938, Accuracy: 8743/8991 (97.2417%)
___Train Local_Simple,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0031, Accuracy: 556/586 (94.8805%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3688, Accuracy: 8880/10000 (88.8000%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 556/572 (97.2028%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   2,  Average loss: 0.0009, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   3,  Average loss: 0.0010, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   4,  Average loss: 0.0004, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   5,  Average loss: 0.0002, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.64770059373347.
Norm before scaling: 16.591610068290635. Distance: 1.4005762293783304
Total norm for 4 adversaries is: 16.591610068290635. distance: 1.4005762293783304
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0988, Accuracy: 8744/8991 (97.2528%)
___Train Local_Simple,  epoch  42, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 539/571 (94.3958%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1467, Accuracy: 9540/10000 (95.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 62, internal_epoch   1,  Average loss: 0.0047, Accuracy: 578/617 (93.6791%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1926, Accuracy: 9379/10000 (93.7900%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 515/526 (97.9087%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   2,  Average loss: 0.0007, Accuracy: 519/526 (98.6692%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 524/526 (99.6198%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 16.64770059373347.
Norm before scaling: 16.60092186263923. Distance: 1.0897335420622867
Total norm for 4 adversaries is: 16.60092186263923. distance: 1.0897335420622867
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0978, Accuracy: 8774/8991 (97.5865%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0016, Accuracy: 589/605 (97.3554%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   2,  Average loss: 0.0018, Accuracy: 587/605 (97.0248%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   3,  Average loss: 0.0005, Accuracy: 600/605 (99.1736%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   4,  Average loss: 0.0003, Accuracy: 603/605 (99.6694%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   5,  Average loss: 0.0002, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 16.64770059373347.
Norm before scaling: 16.608911976142508. Distance: 1.3238872011746396
Total norm for 4 adversaries is: 16.608911976142508. distance: 1.3238872011746396
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0907, Accuracy: 8764/8991 (97.4753%)
time spent on training: 87.01769304275513
[foolsgold agg] training data poison_ratio: 0.38644410723318157  data num: [575, 626, 664, 589, 586, 572, 571, 617, 526, 605]
[foolsgold agg] considering poison per batch poison_fraction: 0.38644410723318157
[foolsgold agg] wv: [0. 0. 0. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.8099, Accuracy: 8811/10000 (88.1100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.0921, Accuracy: 8798/8991 (97.8534%)
Done in 253.6240689754486 sec.
Server Epoch:43 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   1,  Average loss: 0.0024, Accuracy: 750/774 (96.8992%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   2,  Average loss: 0.0035, Accuracy: 721/774 (93.1525%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   3,  Average loss: 0.0014, Accuracy: 756/774 (97.6744%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   4,  Average loss: 0.0013, Accuracy: 765/774 (98.8372%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   5,  Average loss: 0.0007, Accuracy: 763/774 (98.5788%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   6,  Average loss: 0.0005, Accuracy: 766/774 (98.9664%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   7,  Average loss: 0.0005, Accuracy: 770/774 (99.4832%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   8,  Average loss: 0.0003, Accuracy: 772/774 (99.7416%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   9,  Average loss: 0.0003, Accuracy: 772/774 (99.7416%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch  10,  Average loss: 0.0003, Accuracy: 772/774 (99.7416%), train_poison_data_count: 774
Global model norm: 16.65471362960001.
Norm before scaling: 16.96577329150977. Distance: 3.4261866887452666
Total norm for 5 adversaries is: 16.96577329150977. distance: 3.4261866887452666
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1174, Accuracy: 8672/8991 (96.4520%)
___Train Local_Simple,  epoch  43, local model 78, internal_epoch   1,  Average loss: 0.0041, Accuracy: 577/624 (92.4679%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2074, Accuracy: 9288/10000 (92.8800%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 517/526 (98.2890%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   2,  Average loss: 0.0005, Accuracy: 522/526 (99.2395%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 16.65471362960001.
Norm before scaling: 16.608267028543533. Distance: 0.96468688678135
Total norm for 5 adversaries is: 16.608267028543533. distance: 0.96468688678135
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0883, Accuracy: 8795/8991 (97.8200%)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0015, Accuracy: 505/516 (97.8682%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   2,  Average loss: 0.0005, Accuracy: 513/516 (99.4186%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   3,  Average loss: 0.0003, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   4,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch  10,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 16.65471362960001.
Norm before scaling: 16.607044131781002. Distance: 1.037696801329395
Total norm for 5 adversaries is: 16.607044131781002. distance: 1.037696801329395
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0938, Accuracy: 8758/8991 (97.4085%)
___Train Local_Simple,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 488/529 (92.2495%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2286, Accuracy: 9224/10000 (92.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 75, internal_epoch   1,  Average loss: 0.0050, Accuracy: 516/554 (93.1408%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2101, Accuracy: 9375/10000 (93.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0061, Accuracy: 482/529 (91.1153%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3379, Accuracy: 8939/10000 (89.3900%), Attack Success Rate:0/10000(0.000)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 491/503 (97.6143%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   2,  Average loss: 0.0004, Accuracy: 498/503 (99.0060%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   3,  Average loss: 0.0002, Accuracy: 501/503 (99.6024%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   5,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 16.65471362960001.
Norm before scaling: 16.62486783312126. Distance: 0.9065822123948885
Total norm for 5 adversaries is: 16.62486783312126. distance: 0.9065822123948885
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0870, Accuracy: 8786/8991 (97.7199%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   1,  Average loss: 0.0016, Accuracy: 507/518 (97.8764%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   2,  Average loss: 0.0003, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   3,  Average loss: 0.0001, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   4,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   5,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   6,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   7,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   8,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 16.65471362960001.
Norm before scaling: 16.599352794118023. Distance: 1.03911974756388
Total norm for 5 adversaries is: 16.599352794118023. distance: 1.03911974756388
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0753, Accuracy: 8804/8991 (97.9201%)
___Train Local_Simple,  epoch  43, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 532/577 (92.2010%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3258, Accuracy: 8970/10000 (89.7000%), Attack Success Rate:0/10000(0.000)
time spent on training: 98.39811301231384
[foolsgold agg] training data poison_ratio: 0.5021238938053098  data num: [774, 624, 526, 516, 529, 554, 529, 503, 518, 577]
[foolsgold agg] considering poison per batch poison_fraction: 0.5021238938053098
[foolsgold agg] wv: [1.         0.60484724 1.         1.         0.         0.43456485
 0.         1.         1.         0.28529257]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.7771, Accuracy: 8813/10000 (88.1300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.0901, Accuracy: 8803/8991 (97.9090%)
Done in 264.3403949737549 sec.
Server Epoch:44 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   1,  Average loss: 0.0019, Accuracy: 494/511 (96.6732%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   2,  Average loss: 0.0008, Accuracy: 501/511 (98.0431%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   3,  Average loss: 0.0002, Accuracy: 510/511 (99.8043%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   4,  Average loss: 0.0001, Accuracy: 510/511 (99.8043%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   5,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   6,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   7,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   8,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   9,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch  10,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Global model norm: 16.676857744446814.
Norm before scaling: 16.639071597095832. Distance: 1.3065027184120508
Total norm for 7 adversaries is: 16.639071597095832. distance: 1.3065027184120508
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1034, Accuracy: 8731/8991 (97.1082%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 587/606 (96.8647%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   2,  Average loss: 0.0006, Accuracy: 599/606 (98.8449%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   3,  Average loss: 0.0011, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   4,  Average loss: 0.0005, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   5,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 16.676857744446814.
Norm before scaling: 16.59322768716578. Distance: 1.562521514744455
Total norm for 7 adversaries is: 16.59322768716578. distance: 1.562521514744455
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0854, Accuracy: 8762/8991 (97.4530%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0013, Accuracy: 757/774 (97.8036%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   2,  Average loss: 0.0009, Accuracy: 760/774 (98.1912%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   3,  Average loss: 0.0003, Accuracy: 771/774 (99.6124%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   4,  Average loss: 0.0002, Accuracy: 773/774 (99.8708%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   5,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   6,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   7,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   8,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   9,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch  10,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Global model norm: 16.676857744446814.
Norm before scaling: 16.619310366281184. Distance: 1.4423975236745556
Total norm for 7 adversaries is: 16.619310366281184. distance: 1.4423975236745556
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0866, Accuracy: 8755/8991 (97.3752%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0021, Accuracy: 533/548 (97.2628%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   2,  Average loss: 0.0009, Accuracy: 542/548 (98.9051%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   3,  Average loss: 0.0007, Accuracy: 543/548 (99.0876%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   4,  Average loss: 0.0004, Accuracy: 544/548 (99.2701%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   5,  Average loss: 0.0002, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   6,  Average loss: 0.0002, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   7,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   8,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   9,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch  10,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Global model norm: 16.676857744446814.
Norm before scaling: 16.600781231616782. Distance: 1.1939737140279654
Total norm for 7 adversaries is: 16.600781231616782. distance: 1.1939737140279654
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0803, Accuracy: 8769/8991 (97.5309%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 688/708 (97.1751%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   2,  Average loss: 0.0008, Accuracy: 700/708 (98.8701%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   3,  Average loss: 0.0010, Accuracy: 692/708 (97.7401%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   4,  Average loss: 0.0001, Accuracy: 707/708 (99.8588%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   5,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   6,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   8,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   9,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 16.676857744446814.
Norm before scaling: 16.64822119756248. Distance: 1.343717086743766
Total norm for 7 adversaries is: 16.64822119756248. distance: 1.343717086743766
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0723, Accuracy: 8791/8991 (97.7756%)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0008, Accuracy: 543/552 (98.3696%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   2,  Average loss: 0.0003, Accuracy: 549/552 (99.4565%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   3,  Average loss: 0.0002, Accuracy: 551/552 (99.8188%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   4,  Average loss: 0.0001, Accuracy: 551/552 (99.8188%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   5,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   6,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   7,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   8,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   9,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch  10,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Global model norm: 16.676857744446814.
Norm before scaling: 16.63977128825365. Distance: 0.8874159437321043
Total norm for 7 adversaries is: 16.63977128825365. distance: 0.8874159437321043
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1029, Accuracy: 8760/8991 (97.4308%)
___Train Local_Simple,  epoch  44, local model 65, internal_epoch   1,  Average loss: 0.0051, Accuracy: 527/573 (91.9721%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2195, Accuracy: 9257/10000 (92.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 66, internal_epoch   1,  Average loss: 0.0063, Accuracy: 572/629 (90.9380%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2257, Accuracy: 9338/10000 (93.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0066, Accuracy: 571/626 (91.2141%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2738, Accuracy: 9192/10000 (91.9200%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0016, Accuracy: 560/572 (97.9021%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   2,  Average loss: 0.0005, Accuracy: 568/572 (99.3007%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   3,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.676857744446814.
Norm before scaling: 16.600812483058057. Distance: 1.0887569902022647
Total norm for 7 adversaries is: 16.600812483058057. distance: 1.0887569902022647
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0801, Accuracy: 8803/8991 (97.9090%)
time spent on training: 122.02795624732971
[foolsgold agg] training data poison_ratio: 0.7002787342187243  data num: [511, 606, 774, 548, 708, 552, 573, 629, 626, 572]
[foolsgold agg] considering poison per batch poison_fraction: 0.7002787342187243
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         0.04387894 0.04387894 1.        ]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.8124, Accuracy: 8812/10000 (88.1200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.0954, Accuracy: 8800/8991 (97.8757%)
Done in 288.9192976951599 sec.
Server Epoch:45 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 575/617 (93.1929%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1265, Accuracy: 9636/10000 (96.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 75, internal_epoch   1,  Average loss: 0.0067, Accuracy: 488/554 (88.0866%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5540, Accuracy: 8556/10000 (85.5600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0025, Accuracy: 590/606 (97.3597%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   3,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   5,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 16.7008510715374.
Norm before scaling: 16.622125133246726. Distance: 1.429194547790881
Total norm for 5 adversaries is: 16.622125133246726. distance: 1.429194547790881
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0841, Accuracy: 8768/8991 (97.5197%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 627/641 (97.8159%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   2,  Average loss: 0.0004, Accuracy: 634/641 (98.9080%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   3,  Average loss: 0.0008, Accuracy: 635/641 (99.0640%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   4,  Average loss: 0.0004, Accuracy: 637/641 (99.3760%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 639/641 (99.6880%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 16.7008510715374.
Norm before scaling: 16.657532490494354. Distance: 1.1470084609041387
Total norm for 5 adversaries is: 16.657532490494354. distance: 1.1470084609041387
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0925, Accuracy: 8764/8991 (97.4753%)
___Train Local_Simple,  epoch  45, local model 94, internal_epoch   1,  Average loss: 0.0042, Accuracy: 518/555 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1419, Accuracy: 9556/10000 (95.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0068, Accuracy: 595/647 (91.9629%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4634, Accuracy: 8558/10000 (85.5800%), Attack Success Rate:0/10000(0.000)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   1,  Average loss: 0.0013, Accuracy: 591/605 (97.6860%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   2,  Average loss: 0.0008, Accuracy: 596/605 (98.5124%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   3,  Average loss: 0.0008, Accuracy: 596/605 (98.5124%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 16.7008510715374.
Norm before scaling: 16.669226081151194. Distance: 1.2204375687712128
Total norm for 5 adversaries is: 16.669226081151194. distance: 1.2204375687712128
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1029, Accuracy: 8753/8991 (97.3529%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 493/503 (98.0119%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   2,  Average loss: 0.0004, Accuracy: 498/503 (99.0060%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   3,  Average loss: 0.0002, Accuracy: 501/503 (99.6024%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 16.7008510715374.
Norm before scaling: 16.680228145511922. Distance: 0.957097140788179
Total norm for 5 adversaries is: 16.680228145511922. distance: 0.957097140788179
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0918, Accuracy: 8775/8991 (97.5976%)
___Train Local_Simple,  epoch  45, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 583/644 (90.5280%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2727, Accuracy: 9199/10000 (91.9900%), Attack Success Rate:0/10000(0.000)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0013, Accuracy: 499/512 (97.4609%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   2,  Average loss: 0.0009, Accuracy: 503/512 (98.2422%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   3,  Average loss: 0.0002, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   7,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   8,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   9,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch  10,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Global model norm: 16.7008510715374.
Norm before scaling: 16.667845620736916. Distance: 1.1902014972889527
Total norm for 5 adversaries is: 16.667845620736916. distance: 1.1902014972889527
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1026, Accuracy: 8746/8991 (97.2751%)
time spent on training: 97.7432267665863
[foolsgold agg] training data poison_ratio: 0.4872535690006798  data num: [617, 554, 606, 641, 555, 647, 605, 503, 644, 512]
[foolsgold agg] considering poison per batch poison_fraction: 0.4872535690006798
[foolsgold agg] wv: [0.         0.15416044 1.         1.         0.         0.63848724
 1.         1.         0.22616856 1.        ]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.7931, Accuracy: 8828/10000 (88.2800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.0866, Accuracy: 8813/8991 (98.0202%)
Done in 263.85564494132996 sec.
Server Epoch:46 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
___Train Local_Simple,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 508/554 (91.6968%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1768, Accuracy: 9487/10000 (94.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 576/624 (92.3077%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2241, Accuracy: 9259/10000 (92.5900%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0017, Accuracy: 523/535 (97.7570%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   2,  Average loss: 0.0017, Accuracy: 524/535 (97.9439%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   3,  Average loss: 0.0004, Accuracy: 530/535 (99.0654%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   4,  Average loss: 0.0002, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 16.710270922306286.
Norm before scaling: 16.659699675015716. Distance: 1.2483944117972559
Total norm for 6 adversaries is: 16.659699675015716. distance: 1.2483944117972559
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0915, Accuracy: 8758/8991 (97.4085%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 491/503 (97.6143%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 498/503 (99.0060%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   3,  Average loss: 0.0007, Accuracy: 498/503 (99.0060%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   4,  Average loss: 0.0002, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 16.710270922306286.
Norm before scaling: 16.6810331351232. Distance: 1.002472324702804
Total norm for 6 adversaries is: 16.6810331351232. distance: 1.002472324702804
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0917, Accuracy: 8776/8991 (97.6087%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0020, Accuracy: 533/550 (96.9091%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   2,  Average loss: 0.0012, Accuracy: 538/550 (97.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   3,  Average loss: 0.0002, Accuracy: 548/550 (99.6364%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   4,  Average loss: 0.0002, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   5,  Average loss: 0.0002, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   6,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   7,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   8,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   9,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch  10,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Global model norm: 16.710270922306286.
Norm before scaling: 16.675114639551584. Distance: 1.35016886573339
Total norm for 6 adversaries is: 16.675114639551584. distance: 1.35016886573339
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0841, Accuracy: 8765/8991 (97.4864%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   2,  Average loss: 0.0004, Accuracy: 566/572 (98.9510%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   3,  Average loss: 0.0003, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.710270922306286.
Norm before scaling: 16.647442118883085. Distance: 1.0910068444685046
Total norm for 6 adversaries is: 16.647442118883085. distance: 1.0910068444685046
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0860, Accuracy: 8773/8991 (97.5754%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   1,  Average loss: 0.0014, Accuracy: 549/563 (97.5133%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   2,  Average loss: 0.0006, Accuracy: 557/563 (98.9343%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   3,  Average loss: 0.0003, Accuracy: 560/563 (99.4671%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   7,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   8,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch  10,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 16.710270922306286.
Norm before scaling: 16.669342334865917. Distance: 1.1823420184780513
Total norm for 6 adversaries is: 16.669342334865917. distance: 1.1823420184780513
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0903, Accuracy: 8769/8991 (97.5309%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0011, Accuracy: 572/580 (98.6207%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   2,  Average loss: 0.0002, Accuracy: 577/580 (99.4828%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   3,  Average loss: 0.0002, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   4,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   5,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   6,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   7,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   8,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   9,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch  10,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Global model norm: 16.710270922306286.
Norm before scaling: 16.65487670962744. Distance: 0.9942672738753734
Total norm for 6 adversaries is: 16.65487670962744. distance: 0.9942672738753734
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0940, Accuracy: 8767/8991 (97.5086%)
___Train Local_Simple,  epoch  46, local model 68, internal_epoch   1,  Average loss: 0.0029, Accuracy: 598/632 (94.6203%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1490, Accuracy: 9547/10000 (95.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 54, internal_epoch   1,  Average loss: 0.0056, Accuracy: 479/523 (91.5870%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3180, Accuracy: 9021/10000 (90.2100%), Attack Success Rate:0/10000(0.000)
time spent on training: 106.77879023551941
[foolsgold agg] training data poison_ratio: 0.5860539389638041  data num: [554, 624, 535, 503, 550, 572, 563, 580, 632, 523]
[foolsgold agg] considering poison per batch poison_fraction: 0.5860539389638041
[foolsgold agg] wv: [0.         0.         0.87214468 0.9714419  0.87214468 1.
 1.         1.         0.6419934  1.        ]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.7916, Accuracy: 8819/10000 (88.1900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.0858, Accuracy: 8805/8991 (97.9313%)
Done in 273.7529032230377 sec.
Server Epoch:47 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  47, local model 94, internal_epoch   1,  Average loss: 0.0048, Accuracy: 513/555 (92.4324%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2616, Accuracy: 9157/10000 (91.5700%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   1,  Average loss: 0.0026, Accuracy: 575/589 (97.6231%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   2,  Average loss: 0.0007, Accuracy: 578/589 (98.1324%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   3,  Average loss: 0.0003, Accuracy: 585/589 (99.3209%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   4,  Average loss: 0.0002, Accuracy: 587/589 (99.6604%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   7,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   8,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   9,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch  10,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 16.720763240350117.
Norm before scaling: 16.712233141392733. Distance: 1.7548988439202353
Total norm for 6 adversaries is: 16.712233141392733. distance: 1.7548988439202353
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0797, Accuracy: 8775/8991 (97.5976%)
___Train Local_Simple,  epoch  47, local model 82, internal_epoch   1,  Average loss: 0.0060, Accuracy: 569/621 (91.6264%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2464, Accuracy: 9208/10000 (92.0800%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   1,  Average loss: 0.0015, Accuracy: 563/582 (96.7354%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   2,  Average loss: 0.0006, Accuracy: 573/582 (98.4536%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   3,  Average loss: 0.0006, Accuracy: 575/582 (98.7973%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   4,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   9,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch  10,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 16.720763240350117.
Norm before scaling: 16.67910932838685. Distance: 1.1801062844789134
Total norm for 6 adversaries is: 16.67910932838685. distance: 1.1801062844789134
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0758, Accuracy: 8798/8991 (97.8534%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0008, Accuracy: 518/526 (98.4791%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   2,  Average loss: 0.0007, Accuracy: 518/526 (98.4791%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   3,  Average loss: 0.0009, Accuracy: 519/526 (98.6692%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   4,  Average loss: 0.0004, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   5,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   6,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 16.720763240350117.
Norm before scaling: 16.67523268232757. Distance: 0.9204257306063789
Total norm for 6 adversaries is: 16.67523268232757. distance: 0.9204257306063789
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0758, Accuracy: 8799/8991 (97.8645%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0014, Accuracy: 565/581 (97.2461%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   2,  Average loss: 0.0010, Accuracy: 567/581 (97.5904%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   3,  Average loss: 0.0007, Accuracy: 575/581 (98.9673%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   4,  Average loss: 0.0003, Accuracy: 576/581 (99.1394%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   5,  Average loss: 0.0001, Accuracy: 580/581 (99.8279%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   7,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   8,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   9,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch  10,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.720763240350117.
Norm before scaling: 16.68572234211408. Distance: 1.2329067721178804
Total norm for 6 adversaries is: 16.68572234211408. distance: 1.2329067721178804
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0833, Accuracy: 8774/8991 (97.5865%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0014, Accuracy: 536/550 (97.4545%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   2,  Average loss: 0.0006, Accuracy: 541/550 (98.3636%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   3,  Average loss: 0.0004, Accuracy: 547/550 (99.4545%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   4,  Average loss: 0.0002, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   6,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   7,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Global model norm: 16.720763240350117.
Norm before scaling: 16.683696642008872. Distance: 1.0989633291893288
Total norm for 6 adversaries is: 16.683696642008872. distance: 1.0989633291893288
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0937, Accuracy: 8766/8991 (97.4975%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0065, Accuracy: 527/577 (91.3345%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 16.0482, Accuracy: 2879/10000 (28.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 68, internal_epoch   1,  Average loss: 0.0022, Accuracy: 609/632 (96.3608%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1558, Accuracy: 9501/10000 (95.0100%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 504/518 (97.2973%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   3,  Average loss: 0.0002, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   4,  Average loss: 0.0001, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   5,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   6,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   7,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 16.720763240350117.
Norm before scaling: 16.69022555720535. Distance: 1.0936745753848636
Total norm for 6 adversaries is: 16.69022555720535. distance: 1.0936745753848636
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0734, Accuracy: 8793/8991 (97.7978%)
time spent on training: 107.56007599830627
[foolsgold agg] training data poison_ratio: 0.5838422613854476  data num: [555, 589, 621, 582, 526, 581, 550, 577, 632, 518]
[foolsgold agg] considering poison per batch poison_fraction: 0.5838422613854476
[foolsgold agg] wv: [0.         1.         0.         0.92884944 1.         1.
 0.92884944 0.98112522 0.0251839  1.        ]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.7840, Accuracy: 8782/10000 (87.8200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.1032, Accuracy: 8796/8991 (97.8312%)
Done in 273.64946699142456 sec.
Server Epoch:48 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
___Train Local_Simple,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0053, Accuracy: 576/626 (92.0128%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1848, Accuracy: 9413/10000 (94.1300%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   1,  Average loss: 0.0015, Accuracy: 634/650 (97.5385%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   2,  Average loss: 0.0004, Accuracy: 645/650 (99.2308%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   3,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 16.743688504517998.
Norm before scaling: 16.70403850401902. Distance: 1.2692786332199795
Total norm for 3 adversaries is: 16.70403850401902. distance: 1.2692786332199795
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0832, Accuracy: 8791/8991 (97.7756%)
___Train Local_Simple,  epoch  48, local model 75, internal_epoch   1,  Average loss: 0.0051, Accuracy: 506/554 (91.3357%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1625, Accuracy: 9543/10000 (95.4300%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0010, Accuracy: 543/552 (98.3696%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   2,  Average loss: 0.0002, Accuracy: 551/552 (99.8188%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   3,  Average loss: 0.0001, Accuracy: 551/552 (99.8188%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   4,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   5,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   6,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   7,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   8,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   9,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch  10,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Global model norm: 16.743688504517998.
Norm before scaling: 16.700217897741073. Distance: 0.9298972846805742
Total norm for 3 adversaries is: 16.700217897741073. distance: 0.9298972846805742
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.1115, Accuracy: 8729/8991 (97.0860%)
___Train Local_Simple,  epoch  48, local model 58, internal_epoch   1,  Average loss: 0.0048, Accuracy: 474/510 (92.9412%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1614, Accuracy: 9496/10000 (94.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0055, Accuracy: 506/555 (91.1712%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1382, Accuracy: 9602/10000 (96.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0054, Accuracy: 580/627 (92.5040%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2708, Accuracy: 9113/10000 (91.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 559/608 (91.9408%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2174, Accuracy: 9299/10000 (92.9900%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 632/648 (97.5309%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   2,  Average loss: 0.0009, Accuracy: 638/648 (98.4568%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   3,  Average loss: 0.0013, Accuracy: 630/648 (97.2222%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   4,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   5,  Average loss: 0.0002, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.743688504517998.
Norm before scaling: 16.77029601316389. Distance: 1.7790078222522017
Total norm for 3 adversaries is: 16.77029601316389. distance: 1.7790078222522017
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.1207, Accuracy: 8711/8991 (96.8858%)
___Train Local_Simple,  epoch  48, local model 57, internal_epoch   1,  Average loss: 0.0045, Accuracy: 530/568 (93.3099%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2225, Accuracy: 9318/10000 (93.1800%), Attack Success Rate:0/10000(0.000)
time spent on training: 78.23033118247986
[foolsgold agg] training data poison_ratio: 0.3136656493726687  data num: [626, 650, 554, 552, 510, 555, 627, 608, 648, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.3136656493726687
[foolsgold agg] wv: [0.29720177 1.         0.         1.         0.09010926 0.
 0.09555822 0.51442356 1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.7649, Accuracy: 8761/10000 (87.6100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.1089, Accuracy: 8783/8991 (97.6866%)
Done in 243.9716899394989 sec.
Server Epoch:49 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
___Train Local_Simple,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0033, Accuracy: 488/519 (94.0270%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1745, Accuracy: 9493/10000 (94.9300%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0020, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   2,  Average loss: 0.0006, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   3,  Average loss: 0.0003, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.752765484157756.
Norm before scaling: 16.686820598587772. Distance: 1.222925662257281
Total norm for 3 adversaries is: 16.686820598587772. distance: 1.222925662257281
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0916, Accuracy: 8753/8991 (97.3529%)
___Train Local_Simple,  epoch  49, local model 78, internal_epoch   1,  Average loss: 0.0047, Accuracy: 581/624 (93.1090%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1408, Accuracy: 9578/10000 (95.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0053, Accuracy: 487/529 (92.0605%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2326, Accuracy: 9230/10000 (92.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 91, internal_epoch   1,  Average loss: 0.0042, Accuracy: 582/627 (92.8230%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2299, Accuracy: 9329/10000 (93.2900%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 509/521 (97.6967%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   2,  Average loss: 0.0012, Accuracy: 509/521 (97.6967%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   3,  Average loss: 0.0003, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   4,  Average loss: 0.0002, Accuracy: 519/521 (99.6161%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   7,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   8,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   9,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch  10,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 16.752765484157756.
Norm before scaling: 16.686987022487667. Distance: 1.3203771902635157
Total norm for 3 adversaries is: 16.686987022487667. distance: 1.3203771902635157
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0841, Accuracy: 8766/8991 (97.4975%)
___Train Local_Simple,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0041, Accuracy: 524/568 (92.2535%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2216, Accuracy: 9357/10000 (93.5700%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   1,  Average loss: 0.0025, Accuracy: 608/625 (97.2800%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   2,  Average loss: 0.0011, Accuracy: 611/625 (97.7600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   3,  Average loss: 0.0006, Accuracy: 616/625 (98.5600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   4,  Average loss: 0.0004, Accuracy: 621/625 (99.3600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   5,  Average loss: 0.0003, Accuracy: 621/625 (99.3600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   6,  Average loss: 0.0003, Accuracy: 621/625 (99.3600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   7,  Average loss: 0.0002, Accuracy: 622/625 (99.5200%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   8,  Average loss: 0.0002, Accuracy: 622/625 (99.5200%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   9,  Average loss: 0.0002, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch  10,  Average loss: 0.0002, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Global model norm: 16.752765484157756.
Norm before scaling: 16.66104692446248. Distance: 1.3642637980390573
Total norm for 3 adversaries is: 16.66104692446248. distance: 1.3642637980390573
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0773, Accuracy: 8798/8991 (97.8534%)
___Train Local_Simple,  epoch  49, local model 82, internal_epoch   1,  Average loss: 0.0056, Accuracy: 555/621 (89.3720%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3857, Accuracy: 8673/10000 (86.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0033, Accuracy: 591/626 (94.4089%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1435, Accuracy: 9544/10000 (95.4400%), Attack Success Rate:0/10000(0.000)
time spent on training: 76.94568800926208
[foolsgold agg] training data poison_ratio: 0.2945816186556927  data num: [519, 572, 624, 529, 627, 521, 568, 625, 621, 626]
[foolsgold agg] considering poison per batch poison_fraction: 0.2945816186556927
[foolsgold agg] wv: [0.         1.         0.08447821 0.         0.11465421 1.
 0.         1.         0.         0.21161911]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.7786, Accuracy: 8781/10000 (87.8100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.0997, Accuracy: 8796/8991 (97.8312%)
Done in 243.0939211845398 sec.
Server Epoch:50 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
___Train Local_Simple,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0065, Accuracy: 496/554 (89.5307%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3426, Accuracy: 8937/10000 (89.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 86, internal_epoch   1,  Average loss: 0.0037, Accuracy: 554/587 (94.3782%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2153, Accuracy: 9290/10000 (92.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0052, Accuracy: 589/647 (91.0355%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3196, Accuracy: 9025/10000 (90.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0064, Accuracy: 552/609 (90.6404%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.5186, Accuracy: 8510/10000 (85.1000%), Attack Success Rate:0/10000(0.000)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   1,  Average loss: 0.0020, Accuracy: 494/511 (96.6732%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   2,  Average loss: 0.0007, Accuracy: 501/511 (98.0431%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   3,  Average loss: 0.0003, Accuracy: 509/511 (99.6086%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   4,  Average loss: 0.0002, Accuracy: 510/511 (99.8043%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   5,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   6,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   7,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   8,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   9,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch  10,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Global model norm: 16.758198567813942.
Norm before scaling: 16.724710532108247. Distance: 1.310231564562959
Total norm for 5 adversaries is: 16.724710532108247. distance: 1.310231564562959
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0984, Accuracy: 8744/8991 (97.2528%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   1,  Average loss: 0.0013, Accuracy: 598/609 (98.1938%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   2,  Average loss: 0.0009, Accuracy: 593/609 (97.3727%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   3,  Average loss: 0.0004, Accuracy: 604/609 (99.1790%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 16.758198567813942.
Norm before scaling: 16.70924908926051. Distance: 1.164763169344576
Total norm for 5 adversaries is: 16.70924908926051. distance: 1.164763169344576
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0724, Accuracy: 8795/8991 (97.8200%)
___Train Local_Simple,  epoch  50, local model 67, internal_epoch   1,  Average loss: 0.0044, Accuracy: 589/643 (91.6019%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1933, Accuracy: 9414/10000 (94.1400%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0011, Accuracy: 635/648 (97.9938%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 641/648 (98.9198%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.758198567813942.
Norm before scaling: 16.715613753735234. Distance: 1.1895964337288427
Total norm for 5 adversaries is: 16.715613753735234. distance: 1.1895964337288427
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0961, Accuracy: 8754/8991 (97.3640%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0026, Accuracy: 587/605 (97.0248%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   2,  Average loss: 0.0013, Accuracy: 587/605 (97.0248%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   3,  Average loss: 0.0008, Accuracy: 593/605 (98.0165%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   4,  Average loss: 0.0006, Accuracy: 599/605 (99.0083%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   5,  Average loss: 0.0003, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 16.758198567813942.
Norm before scaling: 16.74160146110347. Distance: 1.5526798646583522
Total norm for 5 adversaries is: 16.74160146110347. distance: 1.5526798646583522
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0790, Accuracy: 8791/8991 (97.7756%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0015, Accuracy: 535/550 (97.2727%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   2,  Average loss: 0.0006, Accuracy: 542/550 (98.5455%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   3,  Average loss: 0.0003, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   4,  Average loss: 0.0002, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   6,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   7,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   8,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   9,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch  10,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Global model norm: 16.758198567813942.
Norm before scaling: 16.724081911168827. Distance: 1.1423514899428753
Total norm for 5 adversaries is: 16.724081911168827. distance: 1.1423514899428753
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.1021, Accuracy: 8733/8991 (97.1305%)
time spent on training: 99.12047004699707
[foolsgold agg] training data poison_ratio: 0.4901895019285594  data num: [554, 587, 647, 609, 511, 609, 643, 648, 605, 550]
[foolsgold agg] considering poison per batch poison_fraction: 0.4901895019285594
[foolsgold agg] wv: [0.         0.         0.18093005 0.         1.         1.
 0.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.8243, Accuracy: 8810/10000 (88.1000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.0904, Accuracy: 8804/8991 (97.9201%)
Done in 265.3267960548401 sec.
Server Epoch:51 choose agents : [36, 9, 6, 79, 4, 52, 48, 5, 87, 73].
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 36, internal_epoch   1,  Average loss: 0.0029, Accuracy: 504/520 (96.9231%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 36, internal_epoch   2,  Average loss: 0.0013, Accuracy: 509/520 (97.8846%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 36, internal_epoch   3,  Average loss: 0.0013, Accuracy: 509/520 (97.8846%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 36, internal_epoch   4,  Average loss: 0.0006, Accuracy: 514/520 (98.8462%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 36, internal_epoch   5,  Average loss: 0.0004, Accuracy: 515/520 (99.0385%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 36, internal_epoch   6,  Average loss: 0.0003, Accuracy: 517/520 (99.4231%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 36, internal_epoch   7,  Average loss: 0.0002, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 36, internal_epoch   8,  Average loss: 0.0002, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Global model norm: 16.77517493621527.
Norm before scaling: 16.795977446949536. Distance: 2.1441781286572508
Total norm for 6 adversaries is: 16.795977446949536. distance: 2.1441781286572508
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.1117, Accuracy: 8727/8991 (97.0637%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 9, internal_epoch   1,  Average loss: 0.0022, Accuracy: 533/548 (97.2628%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 9, internal_epoch   2,  Average loss: 0.0013, Accuracy: 537/548 (97.9927%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 9, internal_epoch   3,  Average loss: 0.0002, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 9, internal_epoch   4,  Average loss: 0.0002, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 9, internal_epoch   5,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 9, internal_epoch   6,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 9, internal_epoch   7,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 9, internal_epoch   8,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 9, internal_epoch   9,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 9, internal_epoch  10,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Global model norm: 16.77517493621527.
Norm before scaling: 16.71146982993875. Distance: 1.2847923064948075
Total norm for 6 adversaries is: 16.71146982993875. distance: 1.2847923064948075
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0768, Accuracy: 8784/8991 (97.6977%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 6, internal_epoch   1,  Average loss: 0.0017, Accuracy: 688/708 (97.1751%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 6, internal_epoch   2,  Average loss: 0.0006, Accuracy: 700/708 (98.8701%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 6, internal_epoch   3,  Average loss: 0.0004, Accuracy: 704/708 (99.4350%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 6, internal_epoch   4,  Average loss: 0.0002, Accuracy: 706/708 (99.7175%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 6, internal_epoch   5,  Average loss: 0.0001, Accuracy: 706/708 (99.7175%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 6, internal_epoch   6,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 6, internal_epoch   8,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 16.77517493621527.
Norm before scaling: 16.747718769563065. Distance: 1.4568726808716894
Total norm for 6 adversaries is: 16.747718769563065. distance: 1.4568726808716894
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0762, Accuracy: 8799/8991 (97.8645%)
___Train Local_Simple,  epoch  51, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 592/635 (93.2283%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1353, Accuracy: 9573/10000 (95.7300%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 576/587 (98.1261%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   2,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   3,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   4,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   5,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   6,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   7,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 16.77517493621527.
Norm before scaling: 16.73130187410244. Distance: 1.0920566529575
Total norm for 6 adversaries is: 16.73130187410244. distance: 1.0920566529575
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0826, Accuracy: 8796/8991 (97.8312%)
___Train Local_Simple,  epoch  51, local model 52, internal_epoch   1,  Average loss: 0.0044, Accuracy: 578/618 (93.5275%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1412, Accuracy: 9542/10000 (95.4200%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 48, internal_epoch   1,  Average loss: 0.0017, Accuracy: 574/589 (97.4533%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 48, internal_epoch   2,  Average loss: 0.0006, Accuracy: 584/589 (99.1511%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 48, internal_epoch   3,  Average loss: 0.0003, Accuracy: 586/589 (99.4907%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 48, internal_epoch   4,  Average loss: 0.0002, Accuracy: 588/589 (99.8302%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 16.77517493621527.
Norm before scaling: 16.750460034785704. Distance: 1.4177846237310976
Total norm for 6 adversaries is: 16.750460034785704. distance: 1.4177846237310976
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0840, Accuracy: 8766/8991 (97.4975%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   1,  Average loss: 0.0012, Accuracy: 502/512 (98.0469%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   2,  Average loss: 0.0004, Accuracy: 507/512 (99.0234%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   3,  Average loss: 0.0003, Accuracy: 508/512 (99.2188%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   4,  Average loss: 0.0002, Accuracy: 510/512 (99.6094%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   7,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   8,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Global model norm: 16.77517493621527.
Norm before scaling: 16.7322129278494. Distance: 1.0818738030967505
Total norm for 6 adversaries is: 16.7322129278494. distance: 1.0818738030967505
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0848, Accuracy: 8785/8991 (97.7088%)
___Train Local_Simple,  epoch  51, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 525/575 (91.3043%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3391, Accuracy: 8920/10000 (89.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 73, internal_epoch   1,  Average loss: 0.0055, Accuracy: 571/626 (91.2141%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3026, Accuracy: 9008/10000 (90.0800%), Attack Success Rate:0/10000(0.000)
time spent on training: 108.94906187057495
[foolsgold agg] training data poison_ratio: 0.5853328827306522  data num: [520, 548, 708, 635, 587, 618, 589, 512, 575, 626]
[foolsgold agg] considering poison per batch poison_fraction: 0.5853328827306522
[foolsgold agg] wv: [1. 1. 1. 0. 1. 0. 1. 1. 0. 0.]
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 0.9925, Accuracy: 8802/10000 (88.0200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 0.0923, Accuracy: 8791/8991 (97.7756%)
Done in 276.20994997024536 sec.
Server Epoch:52 choose agents : [10, 31, 95, 82, 33, 30, 68, 11, 28, 70].
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 10, internal_epoch   2,  Average loss: 0.0005, Accuracy: 568/572 (99.3007%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 10, internal_epoch   3,  Average loss: 0.0002, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 10, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 10, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.793880547036323.
Norm before scaling: 16.72592482582942. Distance: 1.1106413477358368
Total norm for 6 adversaries is: 16.72592482582942. distance: 1.1106413477358368
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0852, Accuracy: 8782/8991 (97.6755%)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 31, internal_epoch   1,  Average loss: 0.0015, Accuracy: 499/511 (97.6517%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 31, internal_epoch   2,  Average loss: 0.0007, Accuracy: 501/511 (98.0431%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 31, internal_epoch   3,  Average loss: 0.0002, Accuracy: 509/511 (99.6086%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 31, internal_epoch   4,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 31, internal_epoch   5,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 31, internal_epoch   6,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 31, internal_epoch   7,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 31, internal_epoch   8,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 31, internal_epoch   9,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 31, internal_epoch  10,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Global model norm: 16.793880547036323.
Norm before scaling: 16.75934032953714. Distance: 1.291096925700406
Total norm for 6 adversaries is: 16.75934032953714. distance: 1.291096925700406
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.1044, Accuracy: 8737/8991 (97.1750%)
___Train Local_Simple,  epoch  52, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 496/532 (93.2331%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2321, Accuracy: 9203/10000 (92.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 82, internal_epoch   1,  Average loss: 0.0048, Accuracy: 581/621 (93.5588%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2044, Accuracy: 9356/10000 (93.5600%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   1,  Average loss: 0.0009, Accuracy: 629/638 (98.5893%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   2,  Average loss: 0.0003, Accuracy: 634/638 (99.3730%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   3,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   4,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   5,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   6,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 16.793880547036323.
Norm before scaling: 16.7184688936648. Distance: 0.9385857335004375
Total norm for 6 adversaries is: 16.7184688936648. distance: 0.9385857335004375
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0747, Accuracy: 8802/8991 (97.8979%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 652/668 (97.6048%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 30, internal_epoch   2,  Average loss: 0.0008, Accuracy: 656/668 (98.2036%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 30, internal_epoch   3,  Average loss: 0.0004, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.793880547036323.
Norm before scaling: 16.741523077984965. Distance: 1.3151794965968477
Total norm for 6 adversaries is: 16.741523077984965. distance: 1.3151794965968477
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0826, Accuracy: 8792/8991 (97.7867%)
___Train Local_Simple,  epoch  52, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 600/632 (94.9367%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1735, Accuracy: 9444/10000 (94.4400%), Attack Success Rate:0/10000(0.000)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 626/644 (97.2050%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 11, internal_epoch   2,  Average loss: 0.0023, Accuracy: 622/644 (96.5839%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 11, internal_epoch   3,  Average loss: 0.0015, Accuracy: 626/644 (97.2050%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 637/644 (98.9130%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 11, internal_epoch   7,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 11, internal_epoch   8,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 11, internal_epoch   9,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 16.793880547036323.
Norm before scaling: 16.762564885570725. Distance: 1.6402444307255688
Total norm for 6 adversaries is: 16.762564885570725. distance: 1.6402444307255688
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.1273, Accuracy: 8662/8991 (96.3408%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  52, local model 28, internal_epoch   1,  Average loss: 0.0026, Accuracy: 644/665 (96.8421%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 28, internal_epoch   2,  Average loss: 0.0012, Accuracy: 650/665 (97.7444%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 28, internal_epoch   3,  Average loss: 0.0003, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 28, internal_epoch   4,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 28, internal_epoch   5,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 28, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  52, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  52, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.793880547036323.
Norm before scaling: 16.720658295006192. Distance: 1.6333662490382597
Total norm for 6 adversaries is: 16.720658295006192. distance: 1.6333662490382597
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0885, Accuracy: 8744/8991 (97.2528%)
___Train Local_Simple,  epoch  52, local model 70, internal_epoch   1,  Average loss: 0.0051, Accuracy: 501/549 (91.2568%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1566, Accuracy: 9511/10000 (95.1100%), Attack Success Rate:0/10000(0.000)
time spent on training: 111.87194490432739
[foolsgold agg] training data poison_ratio: 0.6130636604774535  data num: [572, 511, 532, 621, 638, 668, 632, 644, 665, 549]
[foolsgold agg] considering poison per batch poison_fraction: 0.6130636604774535
[foolsgold agg] wv: [1. 1. 1. 0. 1. 1. 0. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 0.9655, Accuracy: 8820/10000 (88.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 0.0852, Accuracy: 8811/8991 (97.9980%)
Done in 277.6547691822052 sec.
Server Epoch:53 choose agents : [63, 99, 35, 31, 85, 62, 21, 81, 52, 26].
___Train Local_Simple,  epoch  53, local model 63, internal_epoch   1,  Average loss: 0.0043, Accuracy: 575/616 (93.3442%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1644, Accuracy: 9530/10000 (95.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 99, internal_epoch   1,  Average loss: 0.0004, Accuracy: 406/410 (99.0244%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.9447, Accuracy: 8677/10000 (86.7700%), Attack Success Rate:0/10000(0.000)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 35, internal_epoch   1,  Average loss: 0.0010, Accuracy: 482/493 (97.7688%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 35, internal_epoch   2,  Average loss: 0.0004, Accuracy: 487/493 (98.7830%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 35, internal_epoch   3,  Average loss: 0.0002, Accuracy: 492/493 (99.7972%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 35, internal_epoch   4,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 35, internal_epoch   5,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.80832004701048.
Norm before scaling: 16.780552570761134. Distance: 1.053410130962574
Total norm for 4 adversaries is: 16.780552570761134. distance: 1.053410130962574
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0946, Accuracy: 8782/8991 (97.6755%)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 31, internal_epoch   1,  Average loss: 0.0014, Accuracy: 498/511 (97.4560%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 31, internal_epoch   2,  Average loss: 0.0007, Accuracy: 506/511 (99.0215%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 31, internal_epoch   3,  Average loss: 0.0002, Accuracy: 509/511 (99.6086%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 31, internal_epoch   4,  Average loss: 0.0002, Accuracy: 510/511 (99.8043%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 31, internal_epoch   5,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 31, internal_epoch   6,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 31, internal_epoch   7,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 31, internal_epoch   8,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 31, internal_epoch   9,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 31, internal_epoch  10,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Global model norm: 16.80832004701048.
Norm before scaling: 16.77982055713611. Distance: 1.2223684441394274
Total norm for 4 adversaries is: 16.77982055713611. distance: 1.2223684441394274
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.1099, Accuracy: 8732/8991 (97.1193%)
___Train Local_Simple,  epoch  53, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 525/570 (92.1053%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3269, Accuracy: 8935/10000 (89.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 566/617 (91.7342%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2155, Accuracy: 9357/10000 (93.5700%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 21, internal_epoch   1,  Average loss: 0.0021, Accuracy: 609/625 (97.4400%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 21, internal_epoch   2,  Average loss: 0.0009, Accuracy: 615/625 (98.4000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 21, internal_epoch   3,  Average loss: 0.0005, Accuracy: 620/625 (99.2000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 21, internal_epoch   4,  Average loss: 0.0003, Accuracy: 622/625 (99.5200%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 21, internal_epoch   5,  Average loss: 0.0002, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 21, internal_epoch   6,  Average loss: 0.0002, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 21, internal_epoch   9,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Global model norm: 16.80832004701048.
Norm before scaling: 16.70993671033141. Distance: 1.2195723766794382
Total norm for 4 adversaries is: 16.70993671033141. distance: 1.2195723766794382
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0702, Accuracy: 8810/8991 (97.9869%)
___Train Local_Simple,  epoch  53, local model 81, internal_epoch   1,  Average loss: 0.0032, Accuracy: 554/586 (94.5392%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3537, Accuracy: 8817/10000 (88.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 563/618 (91.1003%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2905, Accuracy: 9076/10000 (90.7600%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 518/526 (98.4791%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   2,  Average loss: 0.0004, Accuracy: 521/526 (99.0494%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 522/526 (99.2395%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 16.80832004701048.
Norm before scaling: 16.755158042970585. Distance: 0.9497887740468026
Total norm for 4 adversaries is: 16.755158042970585. distance: 0.9497887740468026
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0824, Accuracy: 8803/8991 (97.9090%)
time spent on training: 86.07862091064453
[foolsgold agg] training data poison_ratio: 0.38675520459440055  data num: [616, 410, 493, 511, 570, 617, 625, 586, 618, 526]
[foolsgold agg] considering poison per batch poison_fraction: 0.38675520459440055
[foolsgold agg] wv: [0.         1.         0.2941111  1.         0.         1.
 0.2941111  0.95549589 0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 0.8535, Accuracy: 8825/10000 (88.2500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 0.0804, Accuracy: 8818/8991 (98.0759%)
Done in 253.8901560306549 sec.
Server Epoch:54 choose agents : [27, 54, 48, 85, 16, 43, 52, 29, 93, 78].
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 635/650 (97.6923%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 27, internal_epoch   2,  Average loss: 0.0004, Accuracy: 646/650 (99.3846%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 27, internal_epoch   3,  Average loss: 0.0002, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 27, internal_epoch   4,  Average loss: 0.0002, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 27, internal_epoch   7,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 16.808869264096856.
Norm before scaling: 16.763680863514136. Distance: 1.16016709036852
Total norm for 5 adversaries is: 16.763680863514136. distance: 1.16016709036852
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0768, Accuracy: 8806/8991 (97.9424%)
___Train Local_Simple,  epoch  54, local model 54, internal_epoch   1,  Average loss: 0.0053, Accuracy: 482/523 (92.1606%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2650, Accuracy: 9137/10000 (91.3700%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 48, internal_epoch   1,  Average loss: 0.0015, Accuracy: 575/589 (97.6231%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 584/589 (99.1511%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 48, internal_epoch   3,  Average loss: 0.0002, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 48, internal_epoch   6,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 16.808869264096856.
Norm before scaling: 16.766233861556106. Distance: 1.1588461829206933
Total norm for 5 adversaries is: 16.766233861556106. distance: 1.1588461829206933
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0800, Accuracy: 8791/8991 (97.7756%)
___Train Local_Simple,  epoch  54, local model 85, internal_epoch   1,  Average loss: 0.0041, Accuracy: 535/570 (93.8596%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1512, Accuracy: 9519/10000 (95.1900%), Attack Success Rate:0/10000(0.000)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 16, internal_epoch   1,  Average loss: 0.0014, Accuracy: 570/581 (98.1067%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 16, internal_epoch   2,  Average loss: 0.0006, Accuracy: 576/581 (99.1394%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 16, internal_epoch   3,  Average loss: 0.0002, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 16, internal_epoch   4,  Average loss: 0.0001, Accuracy: 580/581 (99.8279%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 16, internal_epoch   5,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 16, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 16, internal_epoch   7,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 16, internal_epoch   8,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 16, internal_epoch   9,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 16, internal_epoch  10,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.808869264096856.
Norm before scaling: 16.753015047554687. Distance: 1.0397116562124158
Total norm for 5 adversaries is: 16.753015047554687. distance: 1.0397116562124158
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0779, Accuracy: 8789/8991 (97.7533%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 43, internal_epoch   1,  Average loss: 0.0010, Accuracy: 506/518 (97.6834%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 43, internal_epoch   3,  Average loss: 0.0002, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 43, internal_epoch   4,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 43, internal_epoch   5,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 43, internal_epoch   6,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 43, internal_epoch   7,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 16.808869264096856.
Norm before scaling: 16.779119430916307. Distance: 0.981861326194071
Total norm for 5 adversaries is: 16.779119430916307. distance: 0.981861326194071
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0686, Accuracy: 8816/8991 (98.0536%)
___Train Local_Simple,  epoch  54, local model 52, internal_epoch   1,  Average loss: 0.0049, Accuracy: 572/618 (92.5566%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.2038, Accuracy: 9340/10000 (93.4000%), Attack Success Rate:0/10000(0.000)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   1,  Average loss: 0.0014, Accuracy: 595/605 (98.3471%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   2,  Average loss: 0.0008, Accuracy: 595/605 (98.3471%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   3,  Average loss: 0.0003, Accuracy: 602/605 (99.5041%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 602/605 (99.5041%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  54, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 16.808869264096856.
Norm before scaling: 16.762230805945755. Distance: 1.1741760550710898
Total norm for 5 adversaries is: 16.762230805945755. distance: 1.1741760550710898
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0823, Accuracy: 8793/8991 (97.7978%)
___Train Local_Simple,  epoch  54, local model 93, internal_epoch   1,  Average loss: 0.0050, Accuracy: 484/529 (91.4934%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1953, Accuracy: 9421/10000 (94.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 78, internal_epoch   1,  Average loss: 0.0063, Accuracy: 565/624 (90.5449%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1896, Accuracy: 9420/10000 (94.2000%), Attack Success Rate:0/10000(0.000)
time spent on training: 98.89908003807068
[foolsgold agg] training data poison_ratio: 0.5068021353538833  data num: [650, 523, 589, 570, 581, 518, 618, 605, 529, 624]
[foolsgold agg] considering poison per batch poison_fraction: 0.5068021353538833
[foolsgold agg] wv: [1.         0.67322261 1.         0.         1.         1.
 0.         1.         0.         0.        ]
___Test Target_Simple poisoned: False, epoch: 54: Average loss: 0.8807, Accuracy: 8824/10000 (88.2400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 54: Average loss: 0.0800, Accuracy: 8814/8991 (98.0314%)
Done in 265.3840420246124 sec.
Server Epoch:55 choose agents : [5, 85, 24, 0, 35, 65, 46, 29, 45, 69].
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 500/512 (97.6562%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch   3,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch   6,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch   7,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch   8,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Global model norm: 16.82037418706756.
Norm before scaling: 16.778123617642894. Distance: 0.9256962926327404
Total norm for 6 adversaries is: 16.778123617642894. distance: 0.9256962926327404
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0855, Accuracy: 8795/8991 (97.8200%)
___Train Local_Simple,  epoch  55, local model 85, internal_epoch   1,  Average loss: 0.0046, Accuracy: 529/570 (92.8070%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1879, Accuracy: 9376/10000 (93.7600%), Attack Success Rate:0/10000(0.000)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 24, internal_epoch   1,  Average loss: 0.0009, Accuracy: 569/578 (98.4429%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 575/578 (99.4810%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 24, internal_epoch   3,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 24, internal_epoch   4,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 24, internal_epoch   5,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 24, internal_epoch   6,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 24, internal_epoch   7,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 24, internal_epoch   8,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 24, internal_epoch   9,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 24, internal_epoch  10,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 16.82037418706756.
Norm before scaling: 16.762364620654846. Distance: 0.8780861991916893
Total norm for 6 adversaries is: 16.762364620654846. distance: 0.8780861991916893
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0719, Accuracy: 8818/8991 (98.0759%)
___Train Local_Simple,  epoch  55, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 562/609 (92.2824%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2194, Accuracy: 9291/10000 (92.9100%), Attack Success Rate:0/10000(0.000)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 35, internal_epoch   1,  Average loss: 0.0017, Accuracy: 477/493 (96.7546%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 35, internal_epoch   2,  Average loss: 0.0002, Accuracy: 492/493 (99.7972%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 35, internal_epoch   3,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 35, internal_epoch   4,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 35, internal_epoch   5,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 35, internal_epoch   6,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 35, internal_epoch   7,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.82037418706756.
Norm before scaling: 16.786421165539576. Distance: 1.1044412967145374
Total norm for 6 adversaries is: 16.786421165539576. distance: 1.1044412967145374
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0994, Accuracy: 8771/8991 (97.5531%)
___Train Local_Simple,  epoch  55, local model 65, internal_epoch   1,  Average loss: 0.0039, Accuracy: 539/573 (94.0663%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2511, Accuracy: 9213/10000 (92.1300%), Attack Success Rate:0/10000(0.000)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 46, internal_epoch   1,  Average loss: 0.0014, Accuracy: 471/478 (98.5356%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 474/478 (99.1632%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 46, internal_epoch   3,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 46, internal_epoch   4,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 46, internal_epoch   5,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 46, internal_epoch   6,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 46, internal_epoch   7,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 16.82037418706756.
Norm before scaling: 16.776230045253016. Distance: 0.9593216250604032
Total norm for 6 adversaries is: 16.776230045253016. distance: 0.9593216250604032
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0748, Accuracy: 8804/8991 (97.9201%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   1,  Average loss: 0.0013, Accuracy: 595/605 (98.3471%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   2,  Average loss: 0.0011, Accuracy: 591/605 (97.6860%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   3,  Average loss: 0.0004, Accuracy: 600/605 (99.1736%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 16.82037418706756.
Norm before scaling: 16.791664344402495. Distance: 1.2886622876900207
Total norm for 6 adversaries is: 16.791664344402495. distance: 1.2886622876900207
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0898, Accuracy: 8790/8991 (97.7644%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  55, local model 45, internal_epoch   1,  Average loss: 0.0017, Accuracy: 730/750 (97.3333%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 45, internal_epoch   2,  Average loss: 0.0007, Accuracy: 739/750 (98.5333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 45, internal_epoch   3,  Average loss: 0.0002, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 45, internal_epoch   4,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 45, internal_epoch   5,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  55, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  55, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 16.82037418706756.
Norm before scaling: 16.73630065951329. Distance: 1.3201409403377948
Total norm for 6 adversaries is: 16.73630065951329. distance: 1.3201409403377948
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.0732, Accuracy: 8792/8991 (97.7867%)
___Train Local_Simple,  epoch  55, local model 69, internal_epoch   1,  Average loss: 0.0047, Accuracy: 607/646 (93.9628%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3276, Accuracy: 8932/10000 (89.3200%), Attack Success Rate:0/10000(0.000)
time spent on training: 108.75992321968079
[foolsgold agg] training data poison_ratio: 0.587547299621603  data num: [512, 570, 578, 609, 493, 573, 478, 605, 750, 646]
[foolsgold agg] considering poison per batch poison_fraction: 0.587547299621603
[foolsgold agg] wv: [1.         0.         1.         0.         0.69426548 0.07863241
 1.         1.         0.69426548 0.        ]
___Test Target_Simple poisoned: False, epoch: 55: Average loss: 0.9924, Accuracy: 8829/10000 (88.2900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 55: Average loss: 0.0819, Accuracy: 8816/8991 (98.0536%)
Done in 274.71538496017456 sec.
Server Epoch:56 choose agents : [10, 16, 41, 45, 65, 81, 24, 64, 48, 29].
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 562/572 (98.2517%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 10, internal_epoch   2,  Average loss: 0.0005, Accuracy: 563/572 (98.4266%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 10, internal_epoch   3,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 10, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 10, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.8328711317205.
Norm before scaling: 16.76757892126527. Distance: 1.0148887313024733
Total norm for 7 adversaries is: 16.76757892126527. distance: 1.0148887313024733
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0782, Accuracy: 8799/8991 (97.8645%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 16, internal_epoch   1,  Average loss: 0.0015, Accuracy: 568/581 (97.7625%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 16, internal_epoch   2,  Average loss: 0.0007, Accuracy: 574/581 (98.7952%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 16, internal_epoch   3,  Average loss: 0.0001, Accuracy: 580/581 (99.8279%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 16, internal_epoch   4,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 16, internal_epoch   5,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 16, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 16, internal_epoch   7,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 16, internal_epoch   8,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 16, internal_epoch   9,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 16, internal_epoch  10,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.8328711317205.
Norm before scaling: 16.778278222665982. Distance: 1.1874476973409347
Total norm for 7 adversaries is: 16.778278222665982. distance: 1.1874476973409347
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0841, Accuracy: 8774/8991 (97.5865%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   1,  Average loss: 0.0020, Accuracy: 635/652 (97.3926%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   2,  Average loss: 0.0008, Accuracy: 642/652 (98.4663%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   3,  Average loss: 0.0007, Accuracy: 645/652 (98.9264%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 648/652 (99.3865%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 16.8328711317205.
Norm before scaling: 16.745808091073027. Distance: 1.3992185063364573
Total norm for 7 adversaries is: 16.745808091073027. distance: 1.3992185063364573
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0842, Accuracy: 8761/8991 (97.4419%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 736/750 (98.1333%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 45, internal_epoch   2,  Average loss: 0.0008, Accuracy: 737/750 (98.2667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 45, internal_epoch   3,  Average loss: 0.0002, Accuracy: 748/750 (99.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 45, internal_epoch   4,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 45, internal_epoch   5,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 45, internal_epoch   9,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 45, internal_epoch  10,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 16.8328711317205.
Norm before scaling: 16.752422100706344. Distance: 1.2507701408660115
Total norm for 7 adversaries is: 16.752422100706344. distance: 1.2507701408660115
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0797, Accuracy: 8784/8991 (97.6977%)
___Train Local_Simple,  epoch  56, local model 65, internal_epoch   1,  Average loss: 0.0066, Accuracy: 516/573 (90.0524%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2038, Accuracy: 9340/10000 (93.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 81, internal_epoch   1,  Average loss: 0.0041, Accuracy: 547/586 (93.3447%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2436, Accuracy: 9118/10000 (91.1800%), Attack Success Rate:0/10000(0.000)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 24, internal_epoch   1,  Average loss: 0.0008, Accuracy: 568/578 (98.2699%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 24, internal_epoch   3,  Average loss: 0.0001, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 24, internal_epoch   4,  Average loss: 0.0001, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 24, internal_epoch   5,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 24, internal_epoch   6,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 24, internal_epoch   7,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 24, internal_epoch   8,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 24, internal_epoch   9,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 24, internal_epoch  10,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 16.8328711317205.
Norm before scaling: 16.78331120226606. Distance: 0.9518879539024093
Total norm for 7 adversaries is: 16.78331120226606. distance: 0.9518879539024093
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0783, Accuracy: 8792/8991 (97.7867%)
___Train Local_Simple,  epoch  56, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 515/566 (90.9894%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2046, Accuracy: 9429/10000 (94.2900%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 48, internal_epoch   1,  Average loss: 0.0015, Accuracy: 575/589 (97.6231%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 48, internal_epoch   2,  Average loss: 0.0005, Accuracy: 584/589 (99.1511%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 48, internal_epoch   3,  Average loss: 0.0003, Accuracy: 587/589 (99.6604%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 48, internal_epoch   4,  Average loss: 0.0002, Accuracy: 587/589 (99.6604%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 588/589 (99.8302%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 48, internal_epoch   7,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 48, internal_epoch   8,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 48, internal_epoch   9,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 48, internal_epoch  10,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 16.8328711317205.
Norm before scaling: 16.80181795002497. Distance: 1.2900031616852332
Total norm for 7 adversaries is: 16.80181795002497. distance: 1.2900031616852332
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0747, Accuracy: 8798/8991 (97.8534%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   1,  Average loss: 0.0013, Accuracy: 596/605 (98.5124%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   2,  Average loss: 0.0006, Accuracy: 598/605 (98.8430%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  56, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 16.8328711317205.
Norm before scaling: 16.778156357649035. Distance: 1.0192683673894438
Total norm for 7 adversaries is: 16.778156357649035. distance: 1.0192683673894438
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.0821, Accuracy: 8788/8991 (97.7422%)
time spent on training: 123.58227777481079
[foolsgold agg] training data poison_ratio: 0.7149702577660277  data num: [572, 581, 652, 750, 573, 586, 578, 566, 589, 605]
[foolsgold agg] considering poison per batch poison_fraction: 0.7149702577660277
[foolsgold agg] wv: [1.         1.         1.         1.         0.02569636 0.72240834
 1.         0.02569636 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 56: Average loss: 1.0165, Accuracy: 8839/10000 (88.3900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 56: Average loss: 0.0776, Accuracy: 8825/8991 (98.1537%)
Done in 289.6880052089691 sec.
Server Epoch:57 choose agents : [43, 96, 61, 70, 67, 8, 68, 93, 30, 71].
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 43, internal_epoch   1,  Average loss: 0.0010, Accuracy: 510/518 (98.4556%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 43, internal_epoch   2,  Average loss: 0.0014, Accuracy: 509/518 (98.2625%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 43, internal_epoch   3,  Average loss: 0.0015, Accuracy: 505/518 (97.4903%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 43, internal_epoch   4,  Average loss: 0.0004, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 43, internal_epoch   5,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 43, internal_epoch   6,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 43, internal_epoch   7,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 16.84914016114537.
Norm before scaling: 16.85606757699305. Distance: 1.3681692032101405
Total norm for 3 adversaries is: 16.85606757699305. distance: 1.3681692032101405
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0678, Accuracy: 8813/8991 (98.0202%)
___Train Local_Simple,  epoch  57, local model 96, internal_epoch   1,  Average loss: 0.0049, Accuracy: 566/608 (93.0921%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1973, Accuracy: 9343/10000 (93.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 61, internal_epoch   1,  Average loss: 0.0062, Accuracy: 494/537 (91.9926%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1706, Accuracy: 9463/10000 (94.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 70, internal_epoch   1,  Average loss: 0.0061, Accuracy: 485/549 (88.3424%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.3445, Accuracy: 8779/10000 (87.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 67, internal_epoch   1,  Average loss: 0.0066, Accuracy: 595/643 (92.5350%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.4596, Accuracy: 8383/10000 (83.8300%), Attack Success Rate:0/10000(0.000)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 8, internal_epoch   1,  Average loss: 0.0019, Accuracy: 662/683 (96.9253%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 8, internal_epoch   2,  Average loss: 0.0008, Accuracy: 671/683 (98.2430%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 8, internal_epoch   3,  Average loss: 0.0007, Accuracy: 676/683 (98.9751%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 8, internal_epoch   4,  Average loss: 0.0003, Accuracy: 681/683 (99.7072%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 8, internal_epoch   5,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 8, internal_epoch   6,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 8, internal_epoch   7,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 8, internal_epoch   8,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 8, internal_epoch   9,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Global model norm: 16.84914016114537.
Norm before scaling: 16.78168371908092. Distance: 1.5097289876699518
Total norm for 3 adversaries is: 16.78168371908092. distance: 1.5097289876699518
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0695, Accuracy: 8800/8991 (97.8757%)
___Train Local_Simple,  epoch  57, local model 68, internal_epoch   1,  Average loss: 0.0039, Accuracy: 602/632 (95.2532%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1506, Accuracy: 9494/10000 (94.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 486/529 (91.8715%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1587, Accuracy: 9498/10000 (94.9800%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  57, local model 30, internal_epoch   1,  Average loss: 0.0018, Accuracy: 652/668 (97.6048%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 30, internal_epoch   2,  Average loss: 0.0008, Accuracy: 660/668 (98.8024%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 30, internal_epoch   3,  Average loss: 0.0004, Accuracy: 662/668 (99.1018%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 30, internal_epoch   4,  Average loss: 0.0003, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 30, internal_epoch   5,  Average loss: 0.0002, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  57, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  57, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.84914016114537.
Norm before scaling: 16.81479240586525. Distance: 1.4477435312655231
Total norm for 3 adversaries is: 16.81479240586525. distance: 1.4477435312655231
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.0817, Accuracy: 8799/8991 (97.8645%)
___Train Local_Simple,  epoch  57, local model 71, internal_epoch   1,  Average loss: 0.0038, Accuracy: 598/638 (93.7304%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1250, Accuracy: 9622/10000 (96.2200%), Attack Success Rate:0/10000(0.000)
time spent on training: 80.27558493614197
[foolsgold agg] training data poison_ratio: 0.311240632805995  data num: [518, 608, 537, 549, 643, 683, 632, 529, 668, 638]
[foolsgold agg] considering poison per batch poison_fraction: 0.311240632805995
[foolsgold agg] wv: [1.         0.         0.29943536 0.         0.         1.
 0.         0.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 57: Average loss: 1.0382, Accuracy: 8831/10000 (88.3100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 57: Average loss: 0.0789, Accuracy: 8815/8991 (98.0425%)
Done in 246.06947779655457 sec.
Server Epoch:58 choose agents : [77, 32, 80, 30, 53, 41, 13, 49, 17, 31].
___Train Local_Simple,  epoch  58, local model 77, internal_epoch   1,  Average loss: 0.0050, Accuracy: 481/519 (92.6782%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.2173, Accuracy: 9468/10000 (94.6800%), Attack Success Rate:0/10000(0.000)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 599/609 (98.3580%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 32, internal_epoch   2,  Average loss: 0.0004, Accuracy: 602/609 (98.8506%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 32, internal_epoch   3,  Average loss: 0.0004, Accuracy: 604/609 (99.1790%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 16.859460980723757.
Norm before scaling: 16.801494640893374. Distance: 1.0393915444145208
Total norm for 7 adversaries is: 16.801494640893374. distance: 1.0393915444145208
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0805, Accuracy: 8793/8991 (97.7978%)
___Train Local_Simple,  epoch  58, local model 80, internal_epoch   1,  Average loss: 0.0052, Accuracy: 547/593 (92.2428%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.2817, Accuracy: 9436/10000 (94.3600%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 30, internal_epoch   1,  Average loss: 0.0016, Accuracy: 650/668 (97.3054%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 30, internal_epoch   2,  Average loss: 0.0009, Accuracy: 654/668 (97.9042%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 30, internal_epoch   3,  Average loss: 0.0003, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 30, internal_epoch   4,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.859460980723757.
Norm before scaling: 16.80914795086248. Distance: 1.3071117606622054
Total norm for 7 adversaries is: 16.80914795086248. distance: 1.3071117606622054
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0845, Accuracy: 8785/8991 (97.7088%)
___Train Local_Simple,  epoch  58, local model 53, internal_epoch   1,  Average loss: 0.0047, Accuracy: 570/617 (92.3825%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1554, Accuracy: 9597/10000 (95.9700%), Attack Success Rate:0/10000(0.000)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   1,  Average loss: 0.0019, Accuracy: 638/652 (97.8528%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   2,  Average loss: 0.0008, Accuracy: 642/652 (98.4663%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 650/652 (99.6933%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 16.859460980723757.
Norm before scaling: 16.77611180357635. Distance: 1.4126082049759519
Total norm for 7 adversaries is: 16.77611180357635. distance: 1.4126082049759519
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0872, Accuracy: 8748/8991 (97.2973%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 507/521 (97.3129%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 13, internal_epoch   2,  Average loss: 0.0009, Accuracy: 512/521 (98.2726%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 13, internal_epoch   3,  Average loss: 0.0008, Accuracy: 515/521 (98.8484%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 13, internal_epoch   4,  Average loss: 0.0003, Accuracy: 519/521 (99.6161%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 13, internal_epoch   7,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 13, internal_epoch   8,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 13, internal_epoch   9,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 13, internal_epoch  10,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 16.859460980723757.
Norm before scaling: 16.839257032083633. Distance: 1.6264048152715325
Total norm for 7 adversaries is: 16.839257032083633. distance: 1.6264048152715325
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0930, Accuracy: 8757/8991 (97.3974%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 49, internal_epoch   1,  Average loss: 0.0011, Accuracy: 506/516 (98.0620%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 49, internal_epoch   2,  Average loss: 0.0005, Accuracy: 512/516 (99.2248%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 49, internal_epoch   3,  Average loss: 0.0008, Accuracy: 507/516 (98.2558%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 49, internal_epoch   4,  Average loss: 0.0003, Accuracy: 514/516 (99.6124%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 49, internal_epoch   5,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 49, internal_epoch   6,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 49, internal_epoch   7,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 49, internal_epoch   8,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 49, internal_epoch   9,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 49, internal_epoch  10,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 16.859460980723757.
Norm before scaling: 16.8167850748562. Distance: 1.0455549087335485
Total norm for 7 adversaries is: 16.8167850748562. distance: 1.0455549087335485
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0784, Accuracy: 8817/8991 (98.0647%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 640/648 (98.7654%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 638/648 (98.4568%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.859460980723757.
Norm before scaling: 16.794530177902697. Distance: 1.047764698989495
Total norm for 7 adversaries is: 16.794530177902697. distance: 1.047764698989495
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0948, Accuracy: 8756/8991 (97.3863%)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  58, local model 31, internal_epoch   1,  Average loss: 0.0012, Accuracy: 501/511 (98.0431%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 31, internal_epoch   2,  Average loss: 0.0004, Accuracy: 506/511 (99.0215%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 31, internal_epoch   3,  Average loss: 0.0001, Accuracy: 510/511 (99.8043%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 31, internal_epoch   4,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 31, internal_epoch   5,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 31, internal_epoch   6,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 31, internal_epoch   7,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  58, local model 31, internal_epoch   8,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 31, internal_epoch   9,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  58, local model 31, internal_epoch  10,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Global model norm: 16.859460980723757.
Norm before scaling: 16.815465729360948. Distance: 1.0489437103514954
Total norm for 7 adversaries is: 16.815465729360948. distance: 1.0489437103514954
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.0983, Accuracy: 8765/8991 (97.4864%)
time spent on training: 121.6092836856842
[foolsgold agg] training data poison_ratio: 0.7046463956269218  data num: [519, 609, 593, 668, 617, 652, 521, 516, 648, 511]
[foolsgold agg] considering poison per batch poison_fraction: 0.7046463956269218
[foolsgold agg] wv: [0. 1. 0. 1. 0. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 58: Average loss: 1.0913, Accuracy: 8839/10000 (88.3900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 58: Average loss: 0.0765, Accuracy: 8823/8991 (98.1315%)
Done in 287.40541911125183 sec.
Server Epoch:59 choose agents : [46, 56, 12, 72, 79, 17, 71, 70, 74, 27].
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 46, internal_epoch   1,  Average loss: 0.0014, Accuracy: 465/478 (97.2803%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 46, internal_epoch   2,  Average loss: 0.0010, Accuracy: 466/478 (97.4895%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 46, internal_epoch   3,  Average loss: 0.0004, Accuracy: 475/478 (99.3724%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 46, internal_epoch   4,  Average loss: 0.0004, Accuracy: 477/478 (99.7908%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 46, internal_epoch   5,  Average loss: 0.0001, Accuracy: 477/478 (99.7908%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 46, internal_epoch   6,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 46, internal_epoch   7,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 16.876961149062147.
Norm before scaling: 16.862773167438515. Distance: 1.267624582341551
Total norm for 4 adversaries is: 16.862773167438515. distance: 1.267624582341551
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0797, Accuracy: 8796/8991 (97.8312%)
___Train Local_Simple,  epoch  59, local model 56, internal_epoch   1,  Average loss: 0.0059, Accuracy: 581/626 (92.8115%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1438, Accuracy: 9533/10000 (95.3300%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 12, internal_epoch   1,  Average loss: 0.0017, Accuracy: 584/597 (97.8224%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 12, internal_epoch   2,  Average loss: 0.0010, Accuracy: 586/597 (98.1575%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 12, internal_epoch   3,  Average loss: 0.0007, Accuracy: 590/597 (98.8275%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 12, internal_epoch   4,  Average loss: 0.0002, Accuracy: 595/597 (99.6650%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 12, internal_epoch   5,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 12, internal_epoch   6,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 12, internal_epoch   8,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 12, internal_epoch   9,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 12, internal_epoch  10,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Global model norm: 16.876961149062147.
Norm before scaling: 16.83540457393195. Distance: 1.5362664399225718
Total norm for 4 adversaries is: 16.83540457393195. distance: 1.5362664399225718
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0712, Accuracy: 8799/8991 (97.8645%)
___Train Local_Simple,  epoch  59, local model 72, internal_epoch   1,  Average loss: 0.0043, Accuracy: 494/529 (93.3837%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1540, Accuracy: 9506/10000 (95.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 591/635 (93.0709%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1448, Accuracy: 9536/10000 (95.3600%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 641/648 (98.9198%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 641/648 (98.9198%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 17, internal_epoch   3,  Average loss: 0.0002, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 17, internal_epoch   5,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.876961149062147.
Norm before scaling: 16.80692105100883. Distance: 0.9115823861124853
Total norm for 4 adversaries is: 16.80692105100883. distance: 0.9115823861124853
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0861, Accuracy: 8791/8991 (97.7756%)
___Train Local_Simple,  epoch  59, local model 71, internal_epoch   1,  Average loss: 0.0051, Accuracy: 587/638 (92.0063%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2147, Accuracy: 9298/10000 (92.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 70, internal_epoch   1,  Average loss: 0.0078, Accuracy: 490/549 (89.2532%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2284, Accuracy: 9354/10000 (93.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 74, internal_epoch   1,  Average loss: 0.0059, Accuracy: 566/626 (90.4153%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1649, Accuracy: 9534/10000 (95.3400%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  59, local model 27, internal_epoch   1,  Average loss: 0.0014, Accuracy: 640/650 (98.4615%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 27, internal_epoch   2,  Average loss: 0.0014, Accuracy: 633/650 (97.3846%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 27, internal_epoch   3,  Average loss: 0.0009, Accuracy: 640/650 (98.4615%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 27, internal_epoch   4,  Average loss: 0.0003, Accuracy: 645/650 (99.2308%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 27, internal_epoch   5,  Average loss: 0.0002, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  59, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  59, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 16.876961149062147.
Norm before scaling: 16.898979273562095. Distance: 1.9971584757625471
Total norm for 4 adversaries is: 16.898979273562095. distance: 1.9971584757625471
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.0768, Accuracy: 8789/8991 (97.7533%)
time spent on training: 89.45611763000488
[foolsgold agg] training data poison_ratio: 0.3970883534136546  data num: [478, 626, 597, 529, 635, 648, 638, 549, 626, 650]
[foolsgold agg] considering poison per batch poison_fraction: 0.3970883534136546
[foolsgold agg] wv: [1.         0.43780282 1.         0.         0.         1.
 0.         0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 59: Average loss: 1.0030, Accuracy: 8833/10000 (88.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 59: Average loss: 0.0763, Accuracy: 8822/8991 (98.1203%)
Done in 255.3678159713745 sec.
Server Epoch:60 choose agents : [4, 49, 74, 6, 16, 59, 46, 66, 84, 63].
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 578/587 (98.4668%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch   2,  Average loss: 0.0003, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch   3,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch   4,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch   5,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch   6,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch   7,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 16.88759747525764.
Norm before scaling: 16.839326805014913. Distance: 1.020041151899571
Total norm for 5 adversaries is: 16.839326805014913. distance: 1.020041151899571
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0714, Accuracy: 8817/8991 (98.0647%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 49, internal_epoch   1,  Average loss: 0.0010, Accuracy: 506/516 (98.0620%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 513/516 (99.4186%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 49, internal_epoch   3,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 49, internal_epoch   4,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 49, internal_epoch   5,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 49, internal_epoch   6,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 49, internal_epoch   7,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 49, internal_epoch   8,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 49, internal_epoch   9,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 49, internal_epoch  10,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 16.88759747525764.
Norm before scaling: 16.847184830669782. Distance: 1.0653918685284824
Total norm for 5 adversaries is: 16.847184830669782. distance: 1.0653918685284824
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0824, Accuracy: 8820/8991 (98.0981%)
___Train Local_Simple,  epoch  60, local model 74, internal_epoch   1,  Average loss: 0.0042, Accuracy: 575/626 (91.8530%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1194, Accuracy: 9652/10000 (96.5200%), Attack Success Rate:0/10000(0.000)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 6, internal_epoch   1,  Average loss: 0.0010, Accuracy: 695/708 (98.1638%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 6, internal_epoch   2,  Average loss: 0.0003, Accuracy: 705/708 (99.5763%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 6, internal_epoch   3,  Average loss: 0.0001, Accuracy: 707/708 (99.8588%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 6, internal_epoch   4,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 6, internal_epoch   5,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 6, internal_epoch   6,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 6, internal_epoch   7,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 6, internal_epoch   8,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 6, internal_epoch   9,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 6, internal_epoch  10,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 16.88759747525764.
Norm before scaling: 16.83520880093543. Distance: 1.1393988825585817
Total norm for 5 adversaries is: 16.83520880093543. distance: 1.1393988825585817
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0704, Accuracy: 8804/8991 (97.9201%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 16, internal_epoch   1,  Average loss: 0.0013, Accuracy: 568/581 (97.7625%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 16, internal_epoch   2,  Average loss: 0.0006, Accuracy: 573/581 (98.6231%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 16, internal_epoch   3,  Average loss: 0.0002, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 16, internal_epoch   4,  Average loss: 0.0002, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 16, internal_epoch   5,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 16, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 16, internal_epoch   7,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 16, internal_epoch   8,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 16, internal_epoch   9,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 16, internal_epoch  10,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.88759747525764.
Norm before scaling: 16.845580728722016. Distance: 1.1339952805402396
Total norm for 5 adversaries is: 16.845580728722016. distance: 1.1339952805402396
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0974, Accuracy: 8753/8991 (97.3529%)
___Train Local_Simple,  epoch  60, local model 59, internal_epoch   1,  Average loss: 0.0041, Accuracy: 598/652 (91.7178%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.4258, Accuracy: 8763/10000 (87.6300%), Attack Success Rate:0/10000(0.000)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  60, local model 46, internal_epoch   1,  Average loss: 0.0011, Accuracy: 467/478 (97.6987%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 474/478 (99.1632%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 46, internal_epoch   3,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 46, internal_epoch   4,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 46, internal_epoch   5,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 46, internal_epoch   6,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 46, internal_epoch   7,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  60, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  60, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 16.88759747525764.
Norm before scaling: 16.8657635312543. Distance: 1.0676202815275053
Total norm for 5 adversaries is: 16.8657635312543. distance: 1.0676202815275053
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.0937, Accuracy: 8766/8991 (97.4975%)
___Train Local_Simple,  epoch  60, local model 66, internal_epoch   1,  Average loss: 0.0052, Accuracy: 579/629 (92.0509%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2853, Accuracy: 9012/10000 (90.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 84, internal_epoch   1,  Average loss: 0.0059, Accuracy: 504/560 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1612, Accuracy: 9535/10000 (95.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 63, internal_epoch   1,  Average loss: 0.0050, Accuracy: 562/616 (91.2338%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1943, Accuracy: 9448/10000 (94.4800%), Attack Success Rate:0/10000(0.000)
time spent on training: 99.20289421081543
[foolsgold agg] training data poison_ratio: 0.4821098605745002  data num: [587, 516, 626, 708, 581, 652, 478, 629, 560, 616]
[foolsgold agg] considering poison per batch poison_fraction: 0.4821098605745002
[foolsgold agg] wv: [1. 1. 0. 1. 1. 1. 1. 0. 0. 0.]
___Test Target_Simple poisoned: False, epoch: 60: Average loss: 0.9338, Accuracy: 8845/10000 (88.4500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 60: Average loss: 0.0735, Accuracy: 8833/8991 (98.2427%)
Done in 265.72908329963684 sec.
Server Epoch:61 choose agents : [23, 92, 22, 91, 70, 58, 35, 12, 55, 94].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 23, internal_epoch   1,  Average loss: 0.0041, Accuracy: 571/588 (97.1088%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 23, internal_epoch   2,  Average loss: 0.0026, Accuracy: 558/588 (94.8980%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 23, internal_epoch   3,  Average loss: 0.0034, Accuracy: 552/588 (93.8776%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 23, internal_epoch   4,  Average loss: 0.0015, Accuracy: 581/588 (98.8095%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 23, internal_epoch   5,  Average loss: 0.0010, Accuracy: 585/588 (99.4898%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 23, internal_epoch   6,  Average loss: 0.0009, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 23, internal_epoch   7,  Average loss: 0.0008, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 23, internal_epoch   8,  Average loss: 0.0006, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 23, internal_epoch   9,  Average loss: 0.0006, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 23, internal_epoch  10,  Average loss: 0.0006, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Global model norm: 16.897637449276377.
Norm before scaling: 16.97350265798043. Distance: 2.6794390771783836
Total norm for 4 adversaries is: 16.97350265798043. distance: 2.6794390771783836
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0849, Accuracy: 8752/8991 (97.3418%)
___Train Local_Simple,  epoch  61, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 541/571 (94.7461%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1761, Accuracy: 9435/10000 (94.3500%), Attack Success Rate:0/10000(0.000)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 22, internal_epoch   1,  Average loss: 0.0013, Accuracy: 520/531 (97.9284%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 22, internal_epoch   2,  Average loss: 0.0007, Accuracy: 522/531 (98.3051%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 22, internal_epoch   3,  Average loss: 0.0003, Accuracy: 528/531 (99.4350%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 22, internal_epoch   4,  Average loss: 0.0002, Accuracy: 530/531 (99.8117%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 22, internal_epoch   5,  Average loss: 0.0001, Accuracy: 530/531 (99.8117%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 22, internal_epoch   6,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 22, internal_epoch   7,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 22, internal_epoch   8,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 22, internal_epoch   9,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 22, internal_epoch  10,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Global model norm: 16.897637449276377.
Norm before scaling: 16.862936949954033. Distance: 1.1537948007037657
Total norm for 4 adversaries is: 16.862936949954033. distance: 1.1537948007037657
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0755, Accuracy: 8824/8991 (98.1426%)
___Train Local_Simple,  epoch  61, local model 91, internal_epoch   1,  Average loss: 0.0055, Accuracy: 579/627 (92.3445%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1945, Accuracy: 9492/10000 (94.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 70, internal_epoch   1,  Average loss: 0.0060, Accuracy: 502/549 (91.4390%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1914, Accuracy: 9416/10000 (94.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 58, internal_epoch   1,  Average loss: 0.0067, Accuracy: 463/510 (90.7843%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2199, Accuracy: 9264/10000 (92.6400%), Attack Success Rate:0/10000(0.000)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 35, internal_epoch   1,  Average loss: 0.0010, Accuracy: 484/493 (98.1744%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 35, internal_epoch   2,  Average loss: 0.0003, Accuracy: 488/493 (98.9858%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 35, internal_epoch   3,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 35, internal_epoch   4,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 35, internal_epoch   5,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.897637449276377.
Norm before scaling: 16.860599505172647. Distance: 0.951791706260606
Total norm for 4 adversaries is: 16.860599505172647. distance: 0.951791706260606
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0879, Accuracy: 8793/8991 (97.7978%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  61, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 581/597 (97.3199%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 12, internal_epoch   2,  Average loss: 0.0004, Accuracy: 587/597 (98.3250%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 12, internal_epoch   3,  Average loss: 0.0004, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 12, internal_epoch   4,  Average loss: 0.0002, Accuracy: 595/597 (99.6650%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 12, internal_epoch   5,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 12, internal_epoch   6,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  61, local model 12, internal_epoch   8,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 12, internal_epoch   9,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  61, local model 12, internal_epoch  10,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Global model norm: 16.897637449276377.
Norm before scaling: 16.86423448559573. Distance: 1.3277741810330066
Total norm for 4 adversaries is: 16.86423448559573. distance: 1.3277741810330066
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.0685, Accuracy: 8809/8991 (97.9758%)
___Train Local_Simple,  epoch  61, local model 55, internal_epoch   1,  Average loss: 0.0048, Accuracy: 556/592 (93.9189%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2215, Accuracy: 9271/10000 (92.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 512/555 (92.2523%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1784, Accuracy: 9388/10000 (93.8800%), Attack Success Rate:0/10000(0.000)
time spent on training: 87.41329884529114
[foolsgold agg] training data poison_ratio: 0.39355068590771425  data num: [588, 571, 531, 627, 549, 510, 493, 597, 592, 555]
[foolsgold agg] considering poison per batch poison_fraction: 0.39355068590771425
[foolsgold agg] wv: [1.         1.         1.         0.         0.         0.
 1.         1.         0.44907272 0.        ]
___Test Target_Simple poisoned: False, epoch: 61: Average loss: 0.9497, Accuracy: 8839/10000 (88.3900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 61: Average loss: 0.0755, Accuracy: 8824/8991 (98.1426%)
Done in 254.4740240573883 sec.
Server Epoch:62 choose agents : [60, 54, 79, 77, 63, 99, 67, 88, 28, 37].
___Train Local_Simple,  epoch  62, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 602/644 (93.4783%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.4817, Accuracy: 8639/10000 (86.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 54, internal_epoch   1,  Average loss: 0.0041, Accuracy: 494/523 (94.4551%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1904, Accuracy: 9404/10000 (94.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 79, internal_epoch   1,  Average loss: 0.0047, Accuracy: 582/635 (91.6535%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2683, Accuracy: 9135/10000 (91.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 77, internal_epoch   1,  Average loss: 0.0033, Accuracy: 487/519 (93.8343%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2897, Accuracy: 9075/10000 (90.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 63, internal_epoch   1,  Average loss: 0.0053, Accuracy: 560/616 (90.9091%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2282, Accuracy: 9344/10000 (93.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 99, internal_epoch   1,  Average loss: 0.0003, Accuracy: 408/410 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.9579, Accuracy: 8803/10000 (88.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 67, internal_epoch   1,  Average loss: 0.0055, Accuracy: 582/643 (90.5132%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.5967, Accuracy: 8246/10000 (82.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 636/679 (93.6672%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1612, Accuracy: 9493/10000 (94.9300%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 28, internal_epoch   1,  Average loss: 0.0025, Accuracy: 644/665 (96.8421%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 28, internal_epoch   2,  Average loss: 0.0017, Accuracy: 649/665 (97.5940%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 28, internal_epoch   3,  Average loss: 0.0005, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 28, internal_epoch   4,  Average loss: 0.0004, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 28, internal_epoch   5,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 28, internal_epoch   6,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 28, internal_epoch   7,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.90703520299963.
Norm before scaling: 16.836418750372378. Distance: 1.6854662472568502
Total norm for 2 adversaries is: 16.836418750372378. distance: 1.6854662472568502
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0744, Accuracy: 8789/8991 (97.7533%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  62, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 632/641 (98.5959%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 37, internal_epoch   2,  Average loss: 0.0002, Accuracy: 639/641 (99.6880%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 37, internal_epoch   3,  Average loss: 0.0001, Accuracy: 639/641 (99.6880%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 37, internal_epoch   4,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 37, internal_epoch   5,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 37, internal_epoch   6,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  62, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  62, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 16.90703520299963.
Norm before scaling: 16.840977711327735. Distance: 0.9931555103395152
Total norm for 2 adversaries is: 16.840977711327735. distance: 0.9931555103395152
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.0904, Accuracy: 8778/8991 (97.6310%)
time spent on training: 69.48830008506775
[foolsgold agg] training data poison_ratio: 0.21857740585774058  data num: [644, 523, 635, 519, 616, 410, 643, 679, 665, 641]
[foolsgold agg] considering poison per batch poison_fraction: 0.21857740585774058
[foolsgold agg] wv: [0.18511571 0.         0.         0.         0.         1.
 0.         0.05775931 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 62: Average loss: 0.9662, Accuracy: 8842/10000 (88.4200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 62: Average loss: 0.0747, Accuracy: 8825/8991 (98.1537%)
Done in 235.8995749950409 sec.
Server Epoch:63 choose agents : [4, 88, 6, 99, 49, 69, 66, 79, 36, 64].
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch   1,  Average loss: 0.0012, Accuracy: 582/587 (99.1482%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch   2,  Average loss: 0.0013, Accuracy: 576/587 (98.1261%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch   3,  Average loss: 0.0004, Accuracy: 582/587 (99.1482%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch   4,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch   5,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch   6,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch   7,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 16.91337054733575.
Norm before scaling: 16.907596555662856. Distance: 1.6610579611157936
Total norm for 4 adversaries is: 16.907596555662856. distance: 1.6610579611157936
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0781, Accuracy: 8797/8991 (97.8423%)
___Train Local_Simple,  epoch  63, local model 88, internal_epoch   1,  Average loss: 0.0036, Accuracy: 644/679 (94.8454%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2059, Accuracy: 9351/10000 (93.5100%), Attack Success Rate:0/10000(0.000)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 6, internal_epoch   1,  Average loss: 0.0011, Accuracy: 694/708 (98.0226%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 6, internal_epoch   2,  Average loss: 0.0003, Accuracy: 704/708 (99.4350%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 6, internal_epoch   3,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 6, internal_epoch   4,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 6, internal_epoch   5,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 6, internal_epoch   6,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 6, internal_epoch   7,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 6, internal_epoch   8,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 6, internal_epoch   9,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 6, internal_epoch  10,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 16.91337054733575.
Norm before scaling: 16.86040402472471. Distance: 1.1734985295056108
Total norm for 4 adversaries is: 16.86040402472471. distance: 1.1734985295056108
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0700, Accuracy: 8807/8991 (97.9535%)
___Train Local_Simple,  epoch  63, local model 99, internal_epoch   1,  Average loss: 0.0003, Accuracy: 407/410 (99.2683%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.9509, Accuracy: 8766/10000 (87.6600%), Attack Success Rate:0/10000(0.000)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 49, internal_epoch   1,  Average loss: 0.0009, Accuracy: 506/516 (98.0620%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 514/516 (99.6124%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 49, internal_epoch   3,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 49, internal_epoch   4,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 49, internal_epoch   5,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 49, internal_epoch   6,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 49, internal_epoch   7,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 49, internal_epoch   8,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 49, internal_epoch   9,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 49, internal_epoch  10,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 16.91337054733575.
Norm before scaling: 16.871562692458184. Distance: 1.0047907513709147
Total norm for 4 adversaries is: 16.871562692458184. distance: 1.0047907513709147
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0792, Accuracy: 8814/8991 (98.0314%)
___Train Local_Simple,  epoch  63, local model 69, internal_epoch   1,  Average loss: 0.0060, Accuracy: 589/646 (91.1765%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2771, Accuracy: 9105/10000 (91.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 66, internal_epoch   1,  Average loss: 0.0077, Accuracy: 568/629 (90.3021%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2245, Accuracy: 9291/10000 (92.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 79, internal_epoch   1,  Average loss: 0.0036, Accuracy: 603/635 (94.9606%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2886, Accuracy: 9157/10000 (91.5700%), Attack Success Rate:0/10000(0.000)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  63, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 508/520 (97.6923%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 36, internal_epoch   2,  Average loss: 0.0010, Accuracy: 508/520 (97.6923%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 36, internal_epoch   3,  Average loss: 0.0006, Accuracy: 516/520 (99.2308%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 36, internal_epoch   4,  Average loss: 0.0004, Accuracy: 518/520 (99.6154%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 36, internal_epoch   5,  Average loss: 0.0003, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 36, internal_epoch   6,  Average loss: 0.0001, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 36, internal_epoch   7,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  63, local model 36, internal_epoch   8,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  63, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Global model norm: 16.91337054733575.
Norm before scaling: 16.87031365772896. Distance: 1.221915657557286
Total norm for 4 adversaries is: 16.87031365772896. distance: 1.221915657557286
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.0700, Accuracy: 8804/8991 (97.9201%)
___Train Local_Simple,  epoch  63, local model 64, internal_epoch   1,  Average loss: 0.0049, Accuracy: 518/566 (91.5194%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.2289, Accuracy: 9343/10000 (93.4300%), Attack Success Rate:0/10000(0.000)
time spent on training: 88.95010280609131
[foolsgold agg] training data poison_ratio: 0.3953527815468114  data num: [587, 679, 708, 410, 516, 646, 629, 635, 520, 566]
[foolsgold agg] considering poison per batch poison_fraction: 0.3953527815468114
[foolsgold agg] wv: [1.         0.         1.         1.         0.98235464 0.
 0.         0.         0.98235464 0.        ]
___Test Target_Simple poisoned: False, epoch: 63: Average loss: 1.0248, Accuracy: 8846/10000 (88.4600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 63: Average loss: 0.0734, Accuracy: 8832/8991 (98.2316%)
Done in 255.43456888198853 sec.
Server Epoch:64 choose agents : [33, 90, 7, 26, 13, 51, 24, 40, 35, 98].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 33, internal_epoch   1,  Average loss: 0.0007, Accuracy: 630/638 (98.7461%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 33, internal_epoch   2,  Average loss: 0.0003, Accuracy: 634/638 (99.3730%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 33, internal_epoch   3,  Average loss: 0.0001, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 33, internal_epoch   5,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 33, internal_epoch   6,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 16.923149983708523.
Norm before scaling: 16.856237761281246. Distance: 0.8331957981737125
Total norm for 7 adversaries is: 16.856237761281246. distance: 0.8331957981737125
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0688, Accuracy: 8820/8991 (98.0981%)
___Train Local_Simple,  epoch  64, local model 90, internal_epoch   1,  Average loss: 0.0055, Accuracy: 532/577 (92.2010%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.3374, Accuracy: 8908/10000 (89.0800%), Attack Success Rate:0/10000(0.000)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 537/550 (97.6364%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 546/550 (99.2727%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 7, internal_epoch   3,  Average loss: 0.0003, Accuracy: 546/550 (99.2727%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 7, internal_epoch   4,  Average loss: 0.0002, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Global model norm: 16.923149983708523.
Norm before scaling: 16.897262694657545. Distance: 1.12754660702482
Total norm for 7 adversaries is: 16.897262694657545. distance: 1.12754660702482
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0978, Accuracy: 8765/8991 (97.4864%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 26, internal_epoch   1,  Average loss: 0.0006, Accuracy: 519/526 (98.6692%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 26, internal_epoch   2,  Average loss: 0.0005, Accuracy: 519/526 (98.6692%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 26, internal_epoch   4,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 16.923149983708523.
Norm before scaling: 16.875027126714308. Distance: 0.7799336597156415
Total norm for 7 adversaries is: 16.875027126714308. distance: 0.7799336597156415
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0773, Accuracy: 8820/8991 (98.0981%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 508/521 (97.5048%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 13, internal_epoch   2,  Average loss: 0.0009, Accuracy: 512/521 (98.2726%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 13, internal_epoch   3,  Average loss: 0.0004, Accuracy: 517/521 (99.2322%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 13, internal_epoch   4,  Average loss: 0.0002, Accuracy: 519/521 (99.6161%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 13, internal_epoch   7,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 13, internal_epoch   8,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 13, internal_epoch   9,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 13, internal_epoch  10,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 16.923149983708523.
Norm before scaling: 16.876551577975356. Distance: 1.2579182645508122
Total norm for 7 adversaries is: 16.876551577975356. distance: 1.2579182645508122
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0804, Accuracy: 8793/8991 (97.7978%)
___Train Local_Simple,  epoch  64, local model 51, internal_epoch   1,  Average loss: 0.0043, Accuracy: 606/647 (93.6631%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.3720, Accuracy: 8932/10000 (89.3200%), Attack Success Rate:0/10000(0.000)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 569/578 (98.4429%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 24, internal_epoch   2,  Average loss: 0.0067, Accuracy: 519/578 (89.7924%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 24, internal_epoch   3,  Average loss: 0.0017, Accuracy: 557/578 (96.3668%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 24, internal_epoch   4,  Average loss: 0.0011, Accuracy: 566/578 (97.9239%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 24, internal_epoch   5,  Average loss: 0.0007, Accuracy: 571/578 (98.7889%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 24, internal_epoch   6,  Average loss: 0.0005, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 24, internal_epoch   7,  Average loss: 0.0004, Accuracy: 575/578 (99.4810%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 24, internal_epoch   8,  Average loss: 0.0003, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 24, internal_epoch   9,  Average loss: 0.0002, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 24, internal_epoch  10,  Average loss: 0.0002, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 16.923149983708523.
Norm before scaling: 17.684255133837894. Distance: 5.051630478321029
Total norm for 7 adversaries is: 17.684255133837894. distance: 5.051630478321029
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.1112, Accuracy: 8698/8991 (96.7412%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 40, internal_epoch   1,  Average loss: 0.0013, Accuracy: 552/563 (98.0462%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 40, internal_epoch   2,  Average loss: 0.0005, Accuracy: 556/563 (98.7567%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 40, internal_epoch   3,  Average loss: 0.0001, Accuracy: 562/563 (99.8224%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 16.923149983708523.
Norm before scaling: 16.8775976371625. Distance: 1.1191903680794573
Total norm for 7 adversaries is: 16.8775976371625. distance: 1.1191903680794573
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.0761, Accuracy: 8811/8991 (97.9980%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  64, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 483/493 (97.9716%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 35, internal_epoch   2,  Average loss: 0.0006, Accuracy: 487/493 (98.7830%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 35, internal_epoch   3,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 35, internal_epoch   4,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 35, internal_epoch   5,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  64, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  64, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.923149983708523.
Norm before scaling: 16.893669143466326. Distance: 1.02056960507448
Total norm for 7 adversaries is: 16.893669143466326. distance: 1.02056960507448
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.1068, Accuracy: 8760/8991 (97.4308%)
___Train Local_Simple,  epoch  64, local model 98, internal_epoch   1,  Average loss: 0.0039, Accuracy: 533/568 (93.8380%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1531, Accuracy: 9530/10000 (95.3000%), Attack Success Rate:0/10000(0.000)
time spent on training: 119.31662702560425
[foolsgold agg] training data poison_ratio: 0.6834481540363894  data num: [638, 577, 550, 526, 521, 647, 578, 563, 493, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.6834481540363894
[foolsgold agg] wv: [1. 0. 1. 1. 1. 0. 1. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 64: Average loss: 1.0684, Accuracy: 8848/10000 (88.4800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 64: Average loss: 0.0719, Accuracy: 8832/8991 (98.2316%)
Done in 285.18925285339355 sec.
Server Epoch:65 choose agents : [46, 27, 26, 85, 41, 77, 52, 61, 3, 82].
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 471/478 (98.5356%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 46, internal_epoch   2,  Average loss: 0.0005, Accuracy: 473/478 (98.9540%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 46, internal_epoch   3,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 46, internal_epoch   4,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 46, internal_epoch   5,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 46, internal_epoch   6,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 46, internal_epoch   7,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 16.944484945502456.
Norm before scaling: 16.92125911419613. Distance: 0.992150253437819
Total norm for 5 adversaries is: 16.92125911419613. distance: 0.992150253437819
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0761, Accuracy: 8804/8991 (97.9201%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 638/650 (98.1538%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 27, internal_epoch   2,  Average loss: 0.0002, Accuracy: 647/650 (99.5385%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 27, internal_epoch   3,  Average loss: 0.0002, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 27, internal_epoch   6,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 27, internal_epoch   7,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 16.944484945502456.
Norm before scaling: 16.89732590686273. Distance: 1.1527813613917608
Total norm for 5 adversaries is: 16.89732590686273. distance: 1.1527813613917608
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0806, Accuracy: 8807/8991 (97.9535%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 26, internal_epoch   1,  Average loss: 0.0005, Accuracy: 519/526 (98.6692%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 26, internal_epoch   3,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 26, internal_epoch   4,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 16.944484945502456.
Norm before scaling: 16.89817021864442. Distance: 0.7683566661141162
Total norm for 5 adversaries is: 16.89817021864442. distance: 0.7683566661141162
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0835, Accuracy: 8818/8991 (98.0759%)
___Train Local_Simple,  epoch  65, local model 85, internal_epoch   1,  Average loss: 0.0062, Accuracy: 526/570 (92.2807%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2501, Accuracy: 9156/10000 (91.5600%), Attack Success Rate:0/10000(0.000)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   1,  Average loss: 0.0017, Accuracy: 637/652 (97.6994%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   2,  Average loss: 0.0011, Accuracy: 641/652 (98.3129%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 648/652 (99.3865%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 650/652 (99.6933%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 16.944484945502456.
Norm before scaling: 16.88287486250629. Distance: 1.5130885027549412
Total norm for 5 adversaries is: 16.88287486250629. distance: 1.5130885027549412
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0837, Accuracy: 8764/8991 (97.4753%)
___Train Local_Simple,  epoch  65, local model 77, internal_epoch   1,  Average loss: 0.0042, Accuracy: 485/519 (93.4489%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2388, Accuracy: 9398/10000 (93.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 52, internal_epoch   1,  Average loss: 0.0071, Accuracy: 553/618 (89.4822%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1685, Accuracy: 9546/10000 (95.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 61, internal_epoch   1,  Average loss: 0.0062, Accuracy: 487/537 (90.6890%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1599, Accuracy: 9485/10000 (94.8500%), Attack Success Rate:0/10000(0.000)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch   1,  Average loss: 0.0007, Accuracy: 496/505 (98.2178%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch   2,  Average loss: 0.0002, Accuracy: 504/505 (99.8020%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch   3,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch   4,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch   5,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch   6,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch   7,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch   8,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch   9,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch  10,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Global model norm: 16.944484945502456.
Norm before scaling: 16.911389259014822. Distance: 0.8891919301623084
Total norm for 5 adversaries is: 16.911389259014822. distance: 0.8891919301623084
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.0858, Accuracy: 8785/8991 (97.7088%)
___Train Local_Simple,  epoch  65, local model 82, internal_epoch   1,  Average loss: 0.0058, Accuracy: 569/621 (91.6264%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1818, Accuracy: 9596/10000 (95.9600%), Attack Success Rate:0/10000(0.000)
time spent on training: 99.50460076332092
[foolsgold agg] training data poison_ratio: 0.4952431289640592  data num: [478, 650, 526, 570, 652, 519, 618, 537, 505, 621]
[foolsgold agg] considering poison per batch poison_fraction: 0.4952431289640592
[foolsgold agg] wv: [1. 1. 1. 0. 1. 0. 0. 0. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 65: Average loss: 1.1134, Accuracy: 8852/10000 (88.5200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 65: Average loss: 0.0721, Accuracy: 8836/8991 (98.2761%)
Done in 265.10959124565125 sec.
Server Epoch:66 choose agents : [78, 9, 54, 62, 26, 53, 28, 22, 94, 70].
___Train Local_Simple,  epoch  66, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 574/624 (91.9872%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1684, Accuracy: 9530/10000 (95.3000%), Attack Success Rate:0/10000(0.000)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 9, internal_epoch   1,  Average loss: 0.0022, Accuracy: 531/548 (96.8978%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 9, internal_epoch   2,  Average loss: 0.0006, Accuracy: 544/548 (99.2701%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 9, internal_epoch   3,  Average loss: 0.0003, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 9, internal_epoch   4,  Average loss: 0.0002, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 9, internal_epoch   5,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 9, internal_epoch   6,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 9, internal_epoch   7,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 9, internal_epoch   8,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 9, internal_epoch   9,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 9, internal_epoch  10,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Global model norm: 16.954395833704528.
Norm before scaling: 16.885366462885475. Distance: 1.2690161496330454
Total norm for 4 adversaries is: 16.885366462885475. distance: 1.2690161496330454
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0749, Accuracy: 8787/8991 (97.7311%)
___Train Local_Simple,  epoch  66, local model 54, internal_epoch   1,  Average loss: 0.0055, Accuracy: 481/523 (91.9694%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1541, Accuracy: 9566/10000 (95.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 62, internal_epoch   1,  Average loss: 0.0061, Accuracy: 563/617 (91.2480%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2032, Accuracy: 9406/10000 (94.0600%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 26, internal_epoch   1,  Average loss: 0.0006, Accuracy: 520/526 (98.8593%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 26, internal_epoch   2,  Average loss: 0.0005, Accuracy: 520/526 (98.8593%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 524/526 (99.6198%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 16.954395833704528.
Norm before scaling: 16.9111808313132. Distance: 0.8334479292913243
Total norm for 4 adversaries is: 16.9111808313132. distance: 0.8334479292913243
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0800, Accuracy: 8821/8991 (98.1092%)
___Train Local_Simple,  epoch  66, local model 53, internal_epoch   1,  Average loss: 0.0058, Accuracy: 570/617 (92.3825%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2920, Accuracy: 9174/10000 (91.7400%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 28, internal_epoch   1,  Average loss: 0.0021, Accuracy: 647/665 (97.2932%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 28, internal_epoch   2,  Average loss: 0.0009, Accuracy: 654/665 (98.3459%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 28, internal_epoch   3,  Average loss: 0.0003, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 28, internal_epoch   4,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 28, internal_epoch   5,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 28, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.954395833704528.
Norm before scaling: 16.875570556037413. Distance: 1.4963905299072886
Total norm for 4 adversaries is: 16.875570556037413. distance: 1.4963905299072886
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0719, Accuracy: 8796/8991 (97.8312%)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  66, local model 22, internal_epoch   1,  Average loss: 0.0018, Accuracy: 515/531 (96.9868%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 22, internal_epoch   2,  Average loss: 0.0018, Accuracy: 514/531 (96.7985%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 22, internal_epoch   3,  Average loss: 0.0017, Accuracy: 512/531 (96.4218%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 22, internal_epoch   4,  Average loss: 0.0005, Accuracy: 526/531 (99.0584%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 22, internal_epoch   5,  Average loss: 0.0002, Accuracy: 530/531 (99.8117%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 22, internal_epoch   6,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 22, internal_epoch   7,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  66, local model 22, internal_epoch   8,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 22, internal_epoch   9,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  66, local model 22, internal_epoch  10,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Global model norm: 16.954395833704528.
Norm before scaling: 16.93228846252405. Distance: 1.3773124496529885
Total norm for 4 adversaries is: 16.93228846252405. distance: 1.3773124496529885
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.0777, Accuracy: 8798/8991 (97.8534%)
___Train Local_Simple,  epoch  66, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 510/555 (91.8919%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2276, Accuracy: 9253/10000 (92.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 70, internal_epoch   1,  Average loss: 0.0067, Accuracy: 497/549 (90.5282%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2234, Accuracy: 9296/10000 (92.9600%), Attack Success Rate:0/10000(0.000)
time spent on training: 90.07815504074097
[foolsgold agg] training data poison_ratio: 0.3944396177237185  data num: [624, 548, 523, 617, 526, 617, 665, 531, 555, 549]
[foolsgold agg] considering poison per batch poison_fraction: 0.3944396177237185
[foolsgold agg] wv: [0. 1. 0. 1. 1. 0. 1. 1. 0. 0.]
___Test Target_Simple poisoned: False, epoch: 66: Average loss: 1.0140, Accuracy: 8842/10000 (88.4200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 66: Average loss: 0.0721, Accuracy: 8828/8991 (98.1871%)
Done in 255.76354312896729 sec.
Server Epoch:67 choose agents : [68, 69, 90, 8, 66, 70, 0, 14, 40, 45].
___Train Local_Simple,  epoch  67, local model 68, internal_epoch   1,  Average loss: 0.0032, Accuracy: 601/632 (95.0949%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1210, Accuracy: 9603/10000 (96.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 69, internal_epoch   1,  Average loss: 0.0055, Accuracy: 593/646 (91.7957%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2501, Accuracy: 9157/10000 (91.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 90, internal_epoch   1,  Average loss: 0.0073, Accuracy: 528/577 (91.5078%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 2.9319, Accuracy: 5576/10000 (55.7600%), Attack Success Rate:1/10000(0.010)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 668/683 (97.8038%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 8, internal_epoch   2,  Average loss: 0.0007, Accuracy: 673/683 (98.5359%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 8, internal_epoch   3,  Average loss: 0.0003, Accuracy: 680/683 (99.5608%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 8, internal_epoch   4,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 8, internal_epoch   5,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 8, internal_epoch   6,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 8, internal_epoch   7,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 8, internal_epoch   8,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 8, internal_epoch   9,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Global model norm: 16.960278948523186.
Norm before scaling: 16.88134103953145. Distance: 1.2713923970368244
Total norm for 4 adversaries is: 16.88134103953145. distance: 1.2713923970368244
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0726, Accuracy: 8805/8991 (97.9313%)
___Train Local_Simple,  epoch  67, local model 66, internal_epoch   1,  Average loss: 0.0049, Accuracy: 579/629 (92.0509%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2166, Accuracy: 9280/10000 (92.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 70, internal_epoch   1,  Average loss: 0.0054, Accuracy: 497/549 (90.5282%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2638, Accuracy: 9239/10000 (92.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 559/609 (91.7898%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2295, Accuracy: 9272/10000 (92.7200%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 525/535 (98.1308%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 531/535 (99.2523%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 14, internal_epoch   3,  Average loss: 0.0002, Accuracy: 533/535 (99.6262%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 14, internal_epoch   6,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 16.960278948523186.
Norm before scaling: 16.896356025008117. Distance: 0.9853784200223547
Total norm for 4 adversaries is: 16.896356025008117. distance: 0.9853784200223547
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0857, Accuracy: 8783/8991 (97.6866%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 40, internal_epoch   1,  Average loss: 0.0014, Accuracy: 549/563 (97.5133%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 40, internal_epoch   2,  Average loss: 0.0007, Accuracy: 554/563 (98.4014%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 40, internal_epoch   3,  Average loss: 0.0002, Accuracy: 561/563 (99.6448%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 562/563 (99.8224%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 40, internal_epoch   6,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 16.960278948523186.
Norm before scaling: 16.91888012365688. Distance: 1.1692271008487058
Total norm for 4 adversaries is: 16.91888012365688. distance: 1.1692271008487058
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0803, Accuracy: 8791/8991 (97.7756%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  67, local model 45, internal_epoch   1,  Average loss: 0.0016, Accuracy: 732/750 (97.6000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 45, internal_epoch   2,  Average loss: 0.0006, Accuracy: 739/750 (98.5333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 45, internal_epoch   3,  Average loss: 0.0003, Accuracy: 748/750 (99.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 45, internal_epoch   4,  Average loss: 0.0002, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 45, internal_epoch   5,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  67, local model 45, internal_epoch   8,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 45, internal_epoch   9,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  67, local model 45, internal_epoch  10,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 16.960278948523186.
Norm before scaling: 16.894821619614508. Distance: 1.376487447574026
Total norm for 4 adversaries is: 16.894821619614508. distance: 1.376487447574026
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0795, Accuracy: 8788/8991 (97.7422%)
time spent on training: 91.78363394737244
[foolsgold agg] training data poison_ratio: 0.4100113397051677  data num: [632, 646, 577, 683, 629, 549, 609, 535, 563, 750]
[foolsgold agg] considering poison per batch poison_fraction: 0.4100113397051677
[foolsgold agg] wv: [0.         0.         0.17595477 1.         0.         0.
 0.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 67: Average loss: 1.0556, Accuracy: 8841/10000 (88.4100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 67: Average loss: 0.0753, Accuracy: 8827/8991 (98.1760%)
Done in 259.0512342453003 sec.
Server Epoch:68 choose agents : [23, 19, 72, 15, 37, 80, 27, 95, 1, 46].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 23, internal_epoch   1,  Average loss: 0.0020, Accuracy: 567/588 (96.4286%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 23, internal_epoch   2,  Average loss: 0.0005, Accuracy: 582/588 (98.9796%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 23, internal_epoch   3,  Average loss: 0.0005, Accuracy: 581/588 (98.8095%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 23, internal_epoch   4,  Average loss: 0.0003, Accuracy: 585/588 (99.4898%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 23, internal_epoch   5,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 23, internal_epoch   6,  Average loss: 0.0001, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 23, internal_epoch   7,  Average loss: 0.0001, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 23, internal_epoch   8,  Average loss: 0.0001, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 23, internal_epoch   9,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 23, internal_epoch  10,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.97021567967961.
Norm before scaling: 16.923777521743446. Distance: 1.3985061202448943
Total norm for 7 adversaries is: 16.923777521743446. distance: 1.3985061202448943
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0758, Accuracy: 8805/8991 (97.9313%)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 19, internal_epoch   1,  Average loss: 0.0008, Accuracy: 546/552 (98.9130%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 19, internal_epoch   2,  Average loss: 0.0002, Accuracy: 551/552 (99.8188%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 19, internal_epoch   3,  Average loss: 0.0001, Accuracy: 551/552 (99.8188%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 19, internal_epoch   4,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 19, internal_epoch   5,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 19, internal_epoch   6,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 19, internal_epoch   7,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 19, internal_epoch   8,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 19, internal_epoch   9,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 19, internal_epoch  10,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Global model norm: 16.97021567967961.
Norm before scaling: 16.913924472589237. Distance: 0.8112783785001761
Total norm for 7 adversaries is: 16.913924472589237. distance: 0.8112783785001761
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0895, Accuracy: 8787/8991 (97.7311%)
___Train Local_Simple,  epoch  68, local model 72, internal_epoch   1,  Average loss: 0.0054, Accuracy: 489/529 (92.4386%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1573, Accuracy: 9511/10000 (95.1100%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 15, internal_epoch   1,  Average loss: 0.0014, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 15, internal_epoch   2,  Average loss: 0.0003, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 15, internal_epoch   3,  Average loss: 0.0002, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 15, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 15, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 15, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.97021567967961.
Norm before scaling: 16.898467297997307. Distance: 1.0435096966631547
Total norm for 7 adversaries is: 16.898467297997307. distance: 1.0435096966631547
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0733, Accuracy: 8819/8991 (98.0870%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 631/641 (98.4399%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 37, internal_epoch   2,  Average loss: 0.0004, Accuracy: 633/641 (98.7520%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 37, internal_epoch   3,  Average loss: 0.0004, Accuracy: 634/641 (98.9080%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 37, internal_epoch   4,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 37, internal_epoch   5,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 37, internal_epoch   6,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 16.97021567967961.
Norm before scaling: 16.917683287391924. Distance: 1.083337484253976
Total norm for 7 adversaries is: 16.917683287391924. distance: 1.083337484253976
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0912, Accuracy: 8784/8991 (97.6977%)
___Train Local_Simple,  epoch  68, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 552/593 (93.0860%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2284, Accuracy: 9316/10000 (93.1600%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 642/650 (98.7692%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 27, internal_epoch   2,  Average loss: 0.0002, Accuracy: 646/650 (99.3846%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 27, internal_epoch   3,  Average loss: 0.0002, Accuracy: 646/650 (99.3846%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 27, internal_epoch   6,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 16.97021567967961.
Norm before scaling: 16.911626556690777. Distance: 1.0385190646901552
Total norm for 7 adversaries is: 16.911626556690777. distance: 1.0385190646901552
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0731, Accuracy: 8817/8991 (98.0647%)
___Train Local_Simple,  epoch  68, local model 95, internal_epoch   1,  Average loss: 0.0068, Accuracy: 481/532 (90.4135%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1681, Accuracy: 9496/10000 (94.9600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 589/606 (97.1947%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch   2,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch   3,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch   4,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 16.97021567967961.
Norm before scaling: 16.908863591878372. Distance: 1.4764193510874555
Total norm for 7 adversaries is: 16.908863591878372. distance: 1.4764193510874555
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0823, Accuracy: 8787/8991 (97.7311%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  68, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 470/478 (98.3264%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 474/478 (99.1632%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 46, internal_epoch   3,  Average loss: 0.0001, Accuracy: 476/478 (99.5816%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 46, internal_epoch   4,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 46, internal_epoch   5,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 46, internal_epoch   6,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 46, internal_epoch   7,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  68, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  68, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 16.97021567967961.
Norm before scaling: 16.942888254437133. Distance: 0.9960990756023381
Total norm for 7 adversaries is: 16.942888254437133. distance: 0.9960990756023381
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.0858, Accuracy: 8777/8991 (97.6198%)
time spent on training: 121.4450011253357
[foolsgold agg] training data poison_ratio: 0.7118968820762933  data num: [588, 552, 529, 572, 641, 593, 650, 532, 606, 478]
[foolsgold agg] considering poison per batch poison_fraction: 0.7118968820762933
[foolsgold agg] wv: [1. 1. 0. 1. 1. 0. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 68: Average loss: 0.9792, Accuracy: 8845/10000 (88.4500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 68: Average loss: 0.0722, Accuracy: 8833/8991 (98.2427%)
Done in 285.1841628551483 sec.
Server Epoch:69 choose agents : [54, 97, 77, 68, 98, 52, 78, 88, 45, 95].
___Train Local_Simple,  epoch  69, local model 54, internal_epoch   1,  Average loss: 0.0050, Accuracy: 486/523 (92.9254%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1780, Accuracy: 9395/10000 (93.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 97, internal_epoch   1,  Average loss: 0.0048, Accuracy: 545/588 (92.6871%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.3937, Accuracy: 8882/10000 (88.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 77, internal_epoch   1,  Average loss: 0.0052, Accuracy: 477/519 (91.9075%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2781, Accuracy: 9246/10000 (92.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 68, internal_epoch   1,  Average loss: 0.0033, Accuracy: 601/632 (95.0949%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1590, Accuracy: 9509/10000 (95.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 98, internal_epoch   1,  Average loss: 0.0046, Accuracy: 531/568 (93.4859%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2998, Accuracy: 9119/10000 (91.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 52, internal_epoch   1,  Average loss: 0.0062, Accuracy: 560/618 (90.6149%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2475, Accuracy: 9204/10000 (92.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 78, internal_epoch   1,  Average loss: 0.0064, Accuracy: 560/624 (89.7436%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1742, Accuracy: 9464/10000 (94.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 88, internal_epoch   1,  Average loss: 0.0039, Accuracy: 638/679 (93.9617%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1845, Accuracy: 9429/10000 (94.2900%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  69, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 734/750 (97.8667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 45, internal_epoch   2,  Average loss: 0.0008, Accuracy: 739/750 (98.5333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 45, internal_epoch   3,  Average loss: 0.0002, Accuracy: 747/750 (99.6000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 45, internal_epoch   4,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 45, internal_epoch   5,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  69, local model 45, internal_epoch   8,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 45, internal_epoch   9,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  69, local model 45, internal_epoch  10,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 16.982512511438696.
Norm before scaling: 16.913957851870265. Distance: 1.3691204249133964
Total norm for 1 adversaries is: 16.913957851870265. distance: 1.3691204249133964
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0809, Accuracy: 8776/8991 (97.6087%)
___Train Local_Simple,  epoch  69, local model 95, internal_epoch   1,  Average loss: 0.0057, Accuracy: 491/532 (92.2932%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.3551, Accuracy: 8758/10000 (87.5800%), Attack Success Rate:0/10000(0.000)
time spent on training: 59.157273292541504
[foolsgold agg] training data poison_ratio: 0.12431626056688215  data num: [523, 588, 519, 632, 568, 618, 624, 679, 750, 532]
[foolsgold agg] considering poison per batch poison_fraction: 0.12431626056688215
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 69: Average loss: 0.9461, Accuracy: 8846/10000 (88.4600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 69: Average loss: 0.0700, Accuracy: 8833/8991 (98.2427%)
Done in 223.79530000686646 sec.
Server Epoch:70 choose agents : [42, 38, 63, 31, 47, 12, 77, 37, 23, 83].
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 653/665 (98.1955%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 42, internal_epoch   2,  Average loss: 0.0004, Accuracy: 659/665 (99.0977%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 42, internal_epoch   3,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 42, internal_epoch   5,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 42, internal_epoch   6,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 42, internal_epoch   7,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.98214681796371.
Norm before scaling: 16.925815056653292. Distance: 1.130712259108503
Total norm for 7 adversaries is: 16.925815056653292. distance: 1.130712259108503
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0769, Accuracy: 8810/8991 (97.9869%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 757/774 (97.8036%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 38, internal_epoch   2,  Average loss: 0.0003, Accuracy: 768/774 (99.2248%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 38, internal_epoch   3,  Average loss: 0.0001, Accuracy: 773/774 (99.8708%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 38, internal_epoch   4,  Average loss: 0.0001, Accuracy: 773/774 (99.8708%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 38, internal_epoch   5,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 38, internal_epoch   6,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 38, internal_epoch   7,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Global model norm: 16.98214681796371.
Norm before scaling: 16.922344789473712. Distance: 1.2087392234913592
Total norm for 7 adversaries is: 16.922344789473712. distance: 1.2087392234913592
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0763, Accuracy: 8800/8991 (97.8757%)
___Train Local_Simple,  epoch  70, local model 63, internal_epoch   1,  Average loss: 0.0030, Accuracy: 584/616 (94.8052%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1517, Accuracy: 9548/10000 (95.4800%), Attack Success Rate:0/10000(0.000)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 31, internal_epoch   1,  Average loss: 0.0011, Accuracy: 502/511 (98.2387%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 31, internal_epoch   2,  Average loss: 0.0002, Accuracy: 509/511 (99.6086%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 31, internal_epoch   3,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 31, internal_epoch   4,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 31, internal_epoch   5,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 31, internal_epoch   6,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 31, internal_epoch   7,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 31, internal_epoch   8,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 31, internal_epoch   9,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 31, internal_epoch  10,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Global model norm: 16.98214681796371.
Norm before scaling: 16.936932431103966. Distance: 1.005349809774251
Total norm for 7 adversaries is: 16.936932431103966. distance: 1.005349809774251
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0899, Accuracy: 8784/8991 (97.6977%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 47, internal_epoch   1,  Average loss: 0.0017, Accuracy: 588/602 (97.6744%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 47, internal_epoch   2,  Average loss: 0.0012, Accuracy: 593/602 (98.5050%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 47, internal_epoch   3,  Average loss: 0.0004, Accuracy: 599/602 (99.5017%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 47, internal_epoch   4,  Average loss: 0.0003, Accuracy: 601/602 (99.8339%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 47, internal_epoch   5,  Average loss: 0.0002, Accuracy: 601/602 (99.8339%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 47, internal_epoch   6,  Average loss: 0.0001, Accuracy: 601/602 (99.8339%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 47, internal_epoch   7,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 47, internal_epoch   8,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 47, internal_epoch   9,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 47, internal_epoch  10,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 16.98214681796371.
Norm before scaling: 16.911447004763428. Distance: 1.3793767715256053
Total norm for 7 adversaries is: 16.911447004763428. distance: 1.3793767715256053
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0769, Accuracy: 8787/8991 (97.7311%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 584/597 (97.8224%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 12, internal_epoch   2,  Average loss: 0.0006, Accuracy: 592/597 (99.1625%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 12, internal_epoch   3,  Average loss: 0.0004, Accuracy: 592/597 (99.1625%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 12, internal_epoch   4,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 12, internal_epoch   5,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 12, internal_epoch   6,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 12, internal_epoch   8,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 12, internal_epoch   9,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 12, internal_epoch  10,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Global model norm: 16.98214681796371.
Norm before scaling: 16.940873489288506. Distance: 1.1498897997259006
Total norm for 7 adversaries is: 16.940873489288506. distance: 1.1498897997259006
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0641, Accuracy: 8826/8991 (98.1648%)
___Train Local_Simple,  epoch  70, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 494/519 (95.1830%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1555, Accuracy: 9528/10000 (95.2800%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 634/641 (98.9080%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 37, internal_epoch   2,  Average loss: 0.0002, Accuracy: 639/641 (99.6880%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 37, internal_epoch   3,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 37, internal_epoch   4,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 37, internal_epoch   5,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 16.98214681796371.
Norm before scaling: 16.91761473957137. Distance: 0.9213374558840527
Total norm for 7 adversaries is: 16.91761473957137. distance: 0.9213374558840527
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0802, Accuracy: 8808/8991 (97.9646%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  70, local model 23, internal_epoch   1,  Average loss: 0.0022, Accuracy: 569/588 (96.7687%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 23, internal_epoch   2,  Average loss: 0.0010, Accuracy: 576/588 (97.9592%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 23, internal_epoch   3,  Average loss: 0.0004, Accuracy: 582/588 (98.9796%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 23, internal_epoch   4,  Average loss: 0.0003, Accuracy: 586/588 (99.6599%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 23, internal_epoch   5,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 23, internal_epoch   6,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 23, internal_epoch   7,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  70, local model 23, internal_epoch   8,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 23, internal_epoch   9,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  70, local model 23, internal_epoch  10,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.98214681796371.
Norm before scaling: 16.991752868004635. Distance: 1.7109728247771367
Total norm for 7 adversaries is: 16.991752868004635. distance: 1.7109728247771367
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.0862, Accuracy: 8778/8991 (97.6310%)
___Train Local_Simple,  epoch  70, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 512/555 (92.2523%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1939, Accuracy: 9396/10000 (93.9600%), Attack Success Rate:0/10000(0.000)
time spent on training: 124.66208410263062
[foolsgold agg] training data poison_ratio: 0.7214897824653922  data num: [665, 774, 616, 511, 602, 597, 519, 641, 588, 555]
[foolsgold agg] considering poison per batch poison_fraction: 0.7214897824653922
[foolsgold agg] wv: [0.44619858 1.         0.         1.         1.         1.
 0.         1.         0.44619858 0.        ]
___Test Target_Simple poisoned: False, epoch: 70: Average loss: 0.9606, Accuracy: 8847/10000 (88.4700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 70: Average loss: 0.0667, Accuracy: 8836/8991 (98.2761%)
Done in 291.3421959877014 sec.
Server Epoch:71 choose agents : [94, 48, 35, 79, 29, 17, 27, 1, 41, 25].
___Train Local_Simple,  epoch  71, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 511/555 (92.0721%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.1576, Accuracy: 9486/10000 (94.8600%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  71, local model 48, internal_epoch   1,  Average loss: 0.0009, Accuracy: 580/589 (98.4720%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 584/589 (99.1511%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 48, internal_epoch   3,  Average loss: 0.0005, Accuracy: 582/589 (98.8115%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 48, internal_epoch   5,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 48, internal_epoch   6,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  71, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 16.99532119092818.
Norm before scaling: 16.948641220138693. Distance: 1.0364403587329027
Total norm for 8 adversaries is: 16.948641220138693. distance: 1.0364403587329027
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.0692, Accuracy: 8807/8991 (97.9535%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  71, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 487/493 (98.7830%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 35, internal_epoch   2,  Average loss: 0.0004, Accuracy: 489/493 (99.1886%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 35, internal_epoch   3,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 35, internal_epoch   4,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 35, internal_epoch   5,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  71, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.99532119092818.
Norm before scaling: 16.9670971369267. Distance: 0.8990161193510025
Total norm for 8 adversaries is: 16.9670971369267. distance: 0.8990161193510025
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.0816, Accuracy: 8817/8991 (98.0647%)
___Train Local_Simple,  epoch  71, local model 79, internal_epoch   1,  Average loss: 0.0037, Accuracy: 601/635 (94.6457%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.1726, Accuracy: 9474/10000 (94.7400%), Attack Success Rate:0/10000(0.000)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  71, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 593/605 (98.0165%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 29, internal_epoch   2,  Average loss: 0.0003, Accuracy: 600/605 (99.1736%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 29, internal_epoch   3,  Average loss: 0.0001, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 29, internal_epoch   6,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 29, internal_epoch   7,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  71, local model 29, internal_epoch   8,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 16.99532119092818.
Norm before scaling: 16.94837473051205. Distance: 1.018809563703397
Total norm for 8 adversaries is: 16.94837473051205. distance: 1.018809563703397
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.0831, Accuracy: 8807/8991 (97.9535%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  71, local model 17, internal_epoch   1,  Average loss: 0.0007, Accuracy: 639/648 (98.6111%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 642/648 (99.0741%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 17, internal_epoch   3,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 17, internal_epoch   4,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 17, internal_epoch   5,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  71, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.99532119092818.
Norm before scaling: 16.93479441749709. Distance: 0.9606153366804075
Total norm for 8 adversaries is: 16.93479441749709. distance: 0.9606153366804075
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.0748, Accuracy: 8822/8991 (98.1203%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  71, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 640/650 (98.4615%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 644/650 (99.0769%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 27, internal_epoch   3,  Average loss: 0.0003, Accuracy: 645/650 (99.2308%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 27, internal_epoch   5,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 27, internal_epoch   6,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 27, internal_epoch   7,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  71, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 16.99532119092818.
Norm before scaling: 16.98290874535705. Distance: 1.6107377143946695
Total norm for 8 adversaries is: 16.98290874535705. distance: 1.6107377143946695
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.0735, Accuracy: 8821/8991 (98.1092%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 589/606 (97.1947%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch   2,  Average loss: 0.0007, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch   3,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch   4,  Average loss: 0.0002, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 16.99532119092818.
Norm before scaling: 16.92458986041787. Distance: 1.341622020539352
Total norm for 8 adversaries is: 16.92458986041787. distance: 1.341622020539352
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.0696, Accuracy: 8806/8991 (97.9424%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  71, local model 41, internal_epoch   1,  Average loss: 0.0017, Accuracy: 636/652 (97.5460%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 647/652 (99.2331%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  71, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 41, internal_epoch   9,  Average loss: 0.0000, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 41, internal_epoch  10,  Average loss: 0.0000, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 16.99532119092818.
Norm before scaling: 16.902818144631052. Distance: 1.242976915487326
Total norm for 8 adversaries is: 16.902818144631052. distance: 1.242976915487326
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.0793, Accuracy: 8788/8991 (97.7422%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  71, local model 25, internal_epoch   1,  Average loss: 0.0010, Accuracy: 571/582 (98.1100%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 25, internal_epoch   2,  Average loss: 0.0003, Accuracy: 578/582 (99.3127%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 25, internal_epoch   3,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 25, internal_epoch   4,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 25, internal_epoch   5,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 25, internal_epoch   6,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  71, local model 25, internal_epoch   8,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 25, internal_epoch   9,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  71, local model 25, internal_epoch  10,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 16.99532119092818.
Norm before scaling: 16.933806857799745. Distance: 0.9674648558963586
Total norm for 8 adversaries is: 16.933806857799745. distance: 0.9674648558963586
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.0666, Accuracy: 8827/8991 (98.1760%)
time spent on training: 134.03456830978394
[foolsgold agg] training data poison_ratio: 0.802161263507897  data num: [555, 589, 493, 635, 605, 648, 650, 606, 652, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.802161263507897
[foolsgold agg] wv: [0. 1. 1. 0. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 71: Average loss: 1.0849, Accuracy: 8845/10000 (88.4500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 71: Average loss: 0.0695, Accuracy: 8833/8991 (98.2427%)
Done in 301.60990476608276 sec.
Server Epoch:72 choose agents : [26, 77, 17, 61, 14, 0, 73, 94, 96, 25].
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  72, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 521/526 (99.0494%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 26, internal_epoch   2,  Average loss: 0.0004, Accuracy: 521/526 (99.0494%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 26, internal_epoch   3,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 26, internal_epoch   4,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  72, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 17.011320047710143.
Norm before scaling: 16.965085246813253. Distance: 0.7200862239495177
Total norm for 4 adversaries is: 16.965085246813253. distance: 0.7200862239495177
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.0730, Accuracy: 8841/8991 (98.3317%)
___Train Local_Simple,  epoch  72, local model 77, internal_epoch   1,  Average loss: 0.0039, Accuracy: 486/519 (93.6416%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.1296, Accuracy: 9615/10000 (96.1500%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  72, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 640/648 (98.7654%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 17, internal_epoch   2,  Average loss: 0.0003, Accuracy: 641/648 (98.9198%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 17, internal_epoch   3,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 17, internal_epoch   5,  Average loss: 0.0000, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  72, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 17.011320047710143.
Norm before scaling: 16.94331063123392. Distance: 0.9524824446714906
Total norm for 4 adversaries is: 16.94331063123392. distance: 0.9524824446714906
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.0821, Accuracy: 8810/8991 (97.9869%)
___Train Local_Simple,  epoch  72, local model 61, internal_epoch   1,  Average loss: 0.0068, Accuracy: 490/537 (91.2477%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.1510, Accuracy: 9599/10000 (95.9900%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  72, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 528/535 (98.6916%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 530/535 (99.0654%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 14, internal_epoch   3,  Average loss: 0.0002, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 14, internal_epoch   6,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  72, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 17.011320047710143.
Norm before scaling: 16.948706041306203. Distance: 0.9705396549116277
Total norm for 4 adversaries is: 16.948706041306203. distance: 0.9705396549116277
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.0890, Accuracy: 8770/8991 (97.5420%)
___Train Local_Simple,  epoch  72, local model 0, internal_epoch   1,  Average loss: 0.0054, Accuracy: 556/609 (91.2972%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.3956, Accuracy: 8737/10000 (87.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 73, internal_epoch   1,  Average loss: 0.0061, Accuracy: 577/626 (92.1725%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.2161, Accuracy: 9323/10000 (93.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 511/555 (92.0721%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.5714, Accuracy: 8146/10000 (81.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 96, internal_epoch   1,  Average loss: 0.0034, Accuracy: 579/608 (95.2303%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.2548, Accuracy: 9245/10000 (92.4500%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  72, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 569/582 (97.7663%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 25, internal_epoch   2,  Average loss: 0.0004, Accuracy: 578/582 (99.3127%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 25, internal_epoch   3,  Average loss: 0.0002, Accuracy: 578/582 (99.3127%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 25, internal_epoch   4,  Average loss: 0.0001, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 25, internal_epoch   5,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 25, internal_epoch   6,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 25, internal_epoch   7,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  72, local model 25, internal_epoch   8,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 25, internal_epoch   9,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  72, local model 25, internal_epoch  10,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 17.011320047710143.
Norm before scaling: 16.957191872511554. Distance: 1.0729464678035978
Total norm for 4 adversaries is: 16.957191872511554. distance: 1.0729464678035978
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.0696, Accuracy: 8815/8991 (98.0425%)
time spent on training: 89.05584001541138
[foolsgold agg] training data poison_ratio: 0.3987815491731941  data num: [526, 519, 648, 537, 535, 609, 626, 555, 608, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.3987815491731941
[foolsgold agg] wv: [1. 0. 1. 0. 1. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 72: Average loss: 1.0855, Accuracy: 8848/10000 (88.4800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 72: Average loss: 0.0678, Accuracy: 8836/8991 (98.2761%)
Done in 255.47290802001953 sec.
Server Epoch:73 choose agents : [55, 99, 45, 50, 70, 11, 57, 98, 58, 43].
___Train Local_Simple,  epoch  73, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 556/592 (93.9189%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.1444, Accuracy: 9543/10000 (95.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 99, internal_epoch   1,  Average loss: 0.0003, Accuracy: 408/410 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 1.0481, Accuracy: 8709/10000 (87.0900%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  73, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 737/750 (98.2667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 45, internal_epoch   2,  Average loss: 0.0006, Accuracy: 741/750 (98.8000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 45, internal_epoch   3,  Average loss: 0.0003, Accuracy: 745/750 (99.3333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 45, internal_epoch   4,  Average loss: 0.0001, Accuracy: 748/750 (99.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 45, internal_epoch   5,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 45, internal_epoch   7,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  73, local model 45, internal_epoch   8,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 45, internal_epoch   9,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 45, internal_epoch  10,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 17.015595407171237.
Norm before scaling: 16.939651183733464. Distance: 1.2329062403248456
Total norm for 4 adversaries is: 16.939651183733464. distance: 1.2329062403248456
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.0817, Accuracy: 8795/8991 (97.8200%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  73, local model 50, internal_epoch   1,  Average loss: 0.0012, Accuracy: 466/474 (98.3122%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 50, internal_epoch   3,  Average loss: 0.0001, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 50, internal_epoch   4,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  73, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 17.015595407171237.
Norm before scaling: 16.96443495146998. Distance: 0.8819899989467199
Total norm for 4 adversaries is: 16.96443495146998. distance: 0.8819899989467199
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.0921, Accuracy: 8778/8991 (97.6310%)
___Train Local_Simple,  epoch  73, local model 70, internal_epoch   1,  Average loss: 0.0048, Accuracy: 503/549 (91.6211%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.1701, Accuracy: 9458/10000 (94.5800%), Attack Success Rate:0/10000(0.000)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  73, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 631/644 (97.9814%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 11, internal_epoch   3,  Average loss: 0.0004, Accuracy: 637/644 (98.9130%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 11, internal_epoch   4,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 11, internal_epoch   5,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 11, internal_epoch   6,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 11, internal_epoch   7,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  73, local model 11, internal_epoch   8,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 11, internal_epoch   9,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 11, internal_epoch  10,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 17.015595407171237.
Norm before scaling: 16.961454786849156. Distance: 1.1645576908698319
Total norm for 4 adversaries is: 16.961454786849156. distance: 1.1645576908698319
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.0892, Accuracy: 8781/8991 (97.6643%)
___Train Local_Simple,  epoch  73, local model 57, internal_epoch   1,  Average loss: 0.0052, Accuracy: 527/568 (92.7817%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.2417, Accuracy: 9281/10000 (92.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 98, internal_epoch   1,  Average loss: 0.0047, Accuracy: 529/568 (93.1338%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.2177, Accuracy: 9339/10000 (93.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 58, internal_epoch   1,  Average loss: 0.0058, Accuracy: 468/510 (91.7647%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.1654, Accuracy: 9489/10000 (94.8900%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  73, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 43, internal_epoch   3,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 43, internal_epoch   4,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 43, internal_epoch   5,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 43, internal_epoch   6,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 43, internal_epoch   7,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  73, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  73, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 17.015595407171237.
Norm before scaling: 16.96777790579977. Distance: 0.706693389424052
Total norm for 4 adversaries is: 16.96777790579977. distance: 0.706693389424052
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.0656, Accuracy: 8826/8991 (98.1648%)
time spent on training: 89.80300307273865
[foolsgold agg] training data poison_ratio: 0.42736879813720224  data num: [592, 410, 750, 474, 549, 644, 568, 568, 510, 518]
[foolsgold agg] considering poison per batch poison_fraction: 0.42736879813720224
[foolsgold agg] wv: [0. 1. 1. 1. 0. 1. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 73: Average loss: 1.1226, Accuracy: 8857/10000 (88.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 73: Average loss: 0.0660, Accuracy: 8845/8991 (98.3762%)
Done in 255.9143579006195 sec.
Server Epoch:74 choose agents : [42, 11, 89, 50, 55, 83, 51, 21, 0, 79].
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  74, local model 42, internal_epoch   1,  Average loss: 0.0009, Accuracy: 656/665 (98.6466%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 42, internal_epoch   2,  Average loss: 0.0006, Accuracy: 659/665 (99.0977%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 42, internal_epoch   7,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  74, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 17.022602986945678.
Norm before scaling: 16.973174528191628. Distance: 1.233272929688509
Total norm for 4 adversaries is: 16.973174528191628. distance: 1.233272929688509
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.0808, Accuracy: 8800/8991 (97.8757%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 632/644 (98.1366%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 11, internal_epoch   2,  Average loss: 0.0003, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 11, internal_epoch   3,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 11, internal_epoch   4,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 11, internal_epoch   5,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 11, internal_epoch   6,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 11, internal_epoch   7,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  74, local model 11, internal_epoch   8,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 11, internal_epoch   9,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 11, internal_epoch  10,  Average loss: 0.0000, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 17.022602986945678.
Norm before scaling: 16.963390649114142. Distance: 1.119098922192168
Total norm for 4 adversaries is: 16.963390649114142. distance: 1.119098922192168
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.0837, Accuracy: 8784/8991 (97.6977%)
___Train Local_Simple,  epoch  74, local model 89, internal_epoch   1,  Average loss: 0.0036, Accuracy: 633/664 (95.3313%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1839, Accuracy: 9456/10000 (94.5600%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  74, local model 50, internal_epoch   1,  Average loss: 0.0011, Accuracy: 467/474 (98.5232%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 50, internal_epoch   3,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 50, internal_epoch   4,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  74, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 17.022602986945678.
Norm before scaling: 16.962616150809033. Distance: 0.7883433851511216
Total norm for 4 adversaries is: 16.962616150809033. distance: 0.7883433851511216
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.0789, Accuracy: 8799/8991 (97.8645%)
___Train Local_Simple,  epoch  74, local model 55, internal_epoch   1,  Average loss: 0.0065, Accuracy: 537/592 (90.7095%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.2983, Accuracy: 9331/10000 (93.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 83, internal_epoch   1,  Average loss: 0.0064, Accuracy: 510/555 (91.8919%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1246, Accuracy: 9679/10000 (96.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 51, internal_epoch   1,  Average loss: 0.0059, Accuracy: 590/647 (91.1901%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.2205, Accuracy: 9331/10000 (93.3100%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  74, local model 21, internal_epoch   1,  Average loss: 0.0023, Accuracy: 607/625 (97.1200%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 21, internal_epoch   2,  Average loss: 0.0012, Accuracy: 611/625 (97.7600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 21, internal_epoch   3,  Average loss: 0.0003, Accuracy: 620/625 (99.2000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 21, internal_epoch   4,  Average loss: 0.0003, Accuracy: 621/625 (99.3600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 21, internal_epoch   5,  Average loss: 0.0002, Accuracy: 621/625 (99.3600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 21, internal_epoch   6,  Average loss: 0.0002, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  74, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 21, internal_epoch   9,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  74, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Global model norm: 17.022602986945678.
Norm before scaling: 16.943964438944125. Distance: 1.3387451116221534
Total norm for 4 adversaries is: 16.943964438944125. distance: 1.3387451116221534
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.0700, Accuracy: 8809/8991 (97.9758%)
___Train Local_Simple,  epoch  74, local model 0, internal_epoch   1,  Average loss: 0.0071, Accuracy: 543/609 (89.1626%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.2788, Accuracy: 9137/10000 (91.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 79, internal_epoch   1,  Average loss: 0.0051, Accuracy: 583/635 (91.8110%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1986, Accuracy: 9330/10000 (93.3000%), Attack Success Rate:0/10000(0.000)
time spent on training: 91.93865203857422
[foolsgold agg] training data poison_ratio: 0.3941080196399345  data num: [665, 644, 664, 474, 592, 555, 647, 625, 609, 635]
[foolsgold agg] considering poison per batch poison_fraction: 0.3941080196399345
[foolsgold agg] wv: [1. 1. 0. 1. 0. 0. 0. 1. 0. 0.]
___Test Target_Simple poisoned: False, epoch: 74: Average loss: 1.1911, Accuracy: 8857/10000 (88.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 74: Average loss: 0.0674, Accuracy: 8840/8991 (98.3205%)
Done in 257.82837867736816 sec.
Server Epoch:75 choose agents : [7, 65, 20, 13, 16, 67, 55, 61, 24, 46].
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  75, local model 7, internal_epoch   1,  Average loss: 0.0008, Accuracy: 541/550 (98.3636%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 7, internal_epoch   2,  Average loss: 0.0007, Accuracy: 544/550 (98.9091%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 7, internal_epoch   3,  Average loss: 0.0002, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 7, internal_epoch   4,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  75, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Global model norm: 17.03037375899583.
Norm before scaling: 16.985441369180236. Distance: 0.9545801030513257
Total norm for 6 adversaries is: 16.985441369180236. distance: 0.9545801030513257
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.0849, Accuracy: 8803/8991 (97.9090%)
___Train Local_Simple,  epoch  75, local model 65, internal_epoch   1,  Average loss: 0.0063, Accuracy: 515/573 (89.8778%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.2382, Accuracy: 9173/10000 (91.7300%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  75, local model 20, internal_epoch   1,  Average loss: 0.0015, Accuracy: 541/553 (97.8300%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 550/553 (99.4575%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 20, internal_epoch   3,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  75, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Global model norm: 17.03037375899583.
Norm before scaling: 16.972297086965074. Distance: 0.9940068242953657
Total norm for 6 adversaries is: 16.972297086965074. distance: 0.9940068242953657
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.0670, Accuracy: 8832/8991 (98.2316%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 511/521 (98.0806%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 13, internal_epoch   2,  Average loss: 0.0009, Accuracy: 512/521 (98.2726%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 13, internal_epoch   3,  Average loss: 0.0003, Accuracy: 517/521 (99.2322%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 13, internal_epoch   4,  Average loss: 0.0003, Accuracy: 519/521 (99.6161%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 13, internal_epoch   6,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 13, internal_epoch   7,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  75, local model 13, internal_epoch   8,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 13, internal_epoch   9,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 13, internal_epoch  10,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 17.03037375899583.
Norm before scaling: 17.000833827494407. Distance: 1.1084366711983649
Total norm for 6 adversaries is: 17.000833827494407. distance: 1.1084366711983649
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.0695, Accuracy: 8814/8991 (98.0314%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  75, local model 16, internal_epoch   1,  Average loss: 0.0010, Accuracy: 571/581 (98.2788%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 16, internal_epoch   2,  Average loss: 0.0007, Accuracy: 569/581 (97.9346%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 16, internal_epoch   3,  Average loss: 0.0003, Accuracy: 576/581 (99.1394%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 16, internal_epoch   4,  Average loss: 0.0002, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 16, internal_epoch   5,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 16, internal_epoch   6,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 16, internal_epoch   7,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  75, local model 16, internal_epoch   8,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 16, internal_epoch   9,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 16, internal_epoch  10,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 17.03037375899583.
Norm before scaling: 16.976955277612262. Distance: 1.0607726698014428
Total norm for 6 adversaries is: 16.976955277612262. distance: 1.0607726698014428
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.0587, Accuracy: 8843/8991 (98.3539%)
___Train Local_Simple,  epoch  75, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 590/643 (91.7574%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.5188, Accuracy: 8332/10000 (83.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 55, internal_epoch   1,  Average loss: 0.0066, Accuracy: 545/592 (92.0608%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.2926, Accuracy: 9054/10000 (90.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 61, internal_epoch   1,  Average loss: 0.0064, Accuracy: 492/537 (91.6201%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.1965, Accuracy: 9398/10000 (93.9800%), Attack Success Rate:0/10000(0.000)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  75, local model 24, internal_epoch   1,  Average loss: 0.0004, Accuracy: 573/578 (99.1349%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 575/578 (99.4810%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 24, internal_epoch   3,  Average loss: 0.0001, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 24, internal_epoch   4,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 24, internal_epoch   5,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 24, internal_epoch   6,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 24, internal_epoch   7,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  75, local model 24, internal_epoch   8,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 24, internal_epoch   9,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 24, internal_epoch  10,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 17.03037375899583.
Norm before scaling: 16.97847417187652. Distance: 0.7538873936958388
Total norm for 6 adversaries is: 16.97847417187652. distance: 0.7538873936958388
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.0709, Accuracy: 8821/8991 (98.1092%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0010, Accuracy: 469/478 (98.1172%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 471/478 (98.5356%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 46, internal_epoch   3,  Average loss: 0.0003, Accuracy: 476/478 (99.5816%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 46, internal_epoch   4,  Average loss: 0.0001, Accuracy: 477/478 (99.7908%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 46, internal_epoch   5,  Average loss: 0.0001, Accuracy: 477/478 (99.7908%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 46, internal_epoch   6,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 46, internal_epoch   7,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  75, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  75, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 17.03037375899583.
Norm before scaling: 17.02057165958713. Distance: 1.1101493819129673
Total norm for 6 adversaries is: 17.02057165958713. distance: 1.1101493819129673
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.0894, Accuracy: 8775/8991 (97.5976%)
time spent on training: 109.67048287391663
[foolsgold agg] training data poison_ratio: 0.5816981805208705  data num: [550, 573, 553, 521, 581, 643, 592, 537, 578, 478]
[foolsgold agg] considering poison per batch poison_fraction: 0.5816981805208705
[foolsgold agg] wv: [1. 0. 1. 1. 1. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 75: Average loss: 1.1682, Accuracy: 8866/10000 (88.6600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 75: Average loss: 0.0617, Accuracy: 8850/8991 (98.4318%)
Done in 275.9010601043701 sec.
Server Epoch:76 choose agents : [85, 65, 12, 51, 68, 15, 75, 90, 26, 71].
___Train Local_Simple,  epoch  76, local model 85, internal_epoch   1,  Average loss: 0.0058, Accuracy: 530/570 (92.9825%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.2330, Accuracy: 9188/10000 (91.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 65, internal_epoch   1,  Average loss: 0.0053, Accuracy: 529/573 (92.3211%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.1750, Accuracy: 9438/10000 (94.3800%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  76, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 586/597 (98.1575%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 12, internal_epoch   2,  Average loss: 0.0004, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 12, internal_epoch   3,  Average loss: 0.0003, Accuracy: 595/597 (99.6650%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 12, internal_epoch   4,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 12, internal_epoch   5,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 12, internal_epoch   6,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 12, internal_epoch   7,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  76, local model 12, internal_epoch   8,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 12, internal_epoch   9,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 12, internal_epoch  10,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Global model norm: 17.040886572756328.
Norm before scaling: 16.995322088751088. Distance: 1.1813920697553264
Total norm for 3 adversaries is: 16.995322088751088. distance: 1.1813920697553264
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.0589, Accuracy: 8836/8991 (98.2761%)
___Train Local_Simple,  epoch  76, local model 51, internal_epoch   1,  Average loss: 0.0057, Accuracy: 591/647 (91.3447%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.1898, Accuracy: 9444/10000 (94.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 68, internal_epoch   1,  Average loss: 0.0035, Accuracy: 593/632 (93.8291%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.1007, Accuracy: 9676/10000 (96.7600%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  76, local model 15, internal_epoch   1,  Average loss: 0.0013, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 15, internal_epoch   2,  Average loss: 0.0003, Accuracy: 567/572 (99.1259%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 15, internal_epoch   3,  Average loss: 0.0001, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 15, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 15, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  76, local model 15, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 15, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 15, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.040886572756328.
Norm before scaling: 16.96259186283388. Distance: 0.944715074647179
Total norm for 3 adversaries is: 16.96259186283388. distance: 0.944715074647179
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.0704, Accuracy: 8819/8991 (98.0870%)
___Train Local_Simple,  epoch  76, local model 75, internal_epoch   1,  Average loss: 0.0069, Accuracy: 507/554 (91.5162%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.2290, Accuracy: 9368/10000 (93.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 90, internal_epoch   1,  Average loss: 0.0067, Accuracy: 530/577 (91.8544%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 1.4766, Accuracy: 7813/10000 (78.1300%), Attack Success Rate:1/10000(0.010)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  76, local model 26, internal_epoch   1,  Average loss: 0.0005, Accuracy: 521/526 (99.0494%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 26, internal_epoch   2,  Average loss: 0.0007, Accuracy: 518/526 (98.4791%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 524/526 (99.6198%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  76, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  76, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 17.040886572756328.
Norm before scaling: 17.002857641254014. Distance: 0.8754777285380815
Total norm for 3 adversaries is: 17.002857641254014. distance: 0.8754777285380815
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.0810, Accuracy: 8809/8991 (97.9758%)
___Train Local_Simple,  epoch  76, local model 71, internal_epoch   1,  Average loss: 0.0041, Accuracy: 595/638 (93.2602%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.2282, Accuracy: 9351/10000 (93.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 79.72047019004822
[foolsgold agg] training data poison_ratio: 0.28797145769622834  data num: [570, 573, 597, 647, 632, 572, 554, 577, 526, 638]
[foolsgold agg] considering poison per batch poison_fraction: 0.28797145769622834
[foolsgold agg] wv: [0.        0.        1.        0.        0.        1.        0.
 0.5117236 1.        0.       ]
___Test Target_Simple poisoned: False, epoch: 76: Average loss: 1.1074, Accuracy: 8861/10000 (88.6100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 76: Average loss: 0.0631, Accuracy: 8845/8991 (98.3762%)
Done in 246.17032504081726 sec.
Server Epoch:77 choose agents : [57, 55, 95, 96, 74, 18, 53, 39, 52, 60].
___Train Local_Simple,  epoch  77, local model 57, internal_epoch   1,  Average loss: 0.0046, Accuracy: 522/568 (91.9014%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1322, Accuracy: 9628/10000 (96.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 55, internal_epoch   1,  Average loss: 0.0054, Accuracy: 554/592 (93.5811%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1811, Accuracy: 9459/10000 (94.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 95, internal_epoch   1,  Average loss: 0.0059, Accuracy: 488/532 (91.7293%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.2499, Accuracy: 9154/10000 (91.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 96, internal_epoch   1,  Average loss: 0.0058, Accuracy: 560/608 (92.1053%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.2221, Accuracy: 9282/10000 (92.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 74, internal_epoch   1,  Average loss: 0.0050, Accuracy: 580/626 (92.6518%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1652, Accuracy: 9480/10000 (94.8000%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  77, local model 18, internal_epoch   1,  Average loss: 0.0014, Accuracy: 507/516 (98.2558%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 18, internal_epoch   2,  Average loss: 0.0005, Accuracy: 511/516 (99.0310%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 18, internal_epoch   3,  Average loss: 0.0002, Accuracy: 514/516 (99.6124%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 18, internal_epoch   4,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  77, local model 18, internal_epoch   8,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 18, internal_epoch   9,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 18, internal_epoch  10,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 17.043729301302978.
Norm before scaling: 16.97615802843064. Distance: 1.0979240335196816
Total norm for 2 adversaries is: 16.97615802843064. distance: 1.0979240335196816
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.0740, Accuracy: 8807/8991 (97.9535%)
___Train Local_Simple,  epoch  77, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 587/617 (95.1378%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.2115, Accuracy: 9493/10000 (94.9300%), Attack Success Rate:0/10000(0.000)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  77, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 495/503 (98.4095%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 39, internal_epoch   5,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  77, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  77, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 17.043729301302978.
Norm before scaling: 16.99957723652865. Distance: 0.8536377564087503
Total norm for 2 adversaries is: 16.99957723652865. distance: 0.8536377564087503
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.0748, Accuracy: 8805/8991 (97.9313%)
___Train Local_Simple,  epoch  77, local model 52, internal_epoch   1,  Average loss: 0.0075, Accuracy: 549/618 (88.8350%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1889, Accuracy: 9484/10000 (94.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 60, internal_epoch   1,  Average loss: 0.0054, Accuracy: 590/644 (91.6149%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.3310, Accuracy: 9002/10000 (90.0200%), Attack Success Rate:0/10000(0.000)
time spent on training: 67.64230108261108
[foolsgold agg] training data poison_ratio: 0.17496565934065933  data num: [568, 592, 532, 608, 626, 516, 617, 503, 618, 644]
[foolsgold agg] considering poison per batch poison_fraction: 0.17496565934065933
[foolsgold agg] wv: [0.         0.         1.         0.         0.         1.
 0.         1.         0.         0.24604464]
___Test Target_Simple poisoned: False, epoch: 77: Average loss: 1.0426, Accuracy: 8860/10000 (88.6000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 77: Average loss: 0.0618, Accuracy: 8847/8991 (98.3984%)
Done in 235.10278344154358 sec.
Server Epoch:78 choose agents : [43, 49, 84, 46, 1, 11, 5, 7, 3, 45].
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  78, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 511/518 (98.6486%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 512/518 (98.8417%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 43, internal_epoch   3,  Average loss: 0.0001, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 43, internal_epoch   4,  Average loss: 0.0001, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 43, internal_epoch   5,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 43, internal_epoch   6,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 43, internal_epoch   7,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  78, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 17.04256093011378.
Norm before scaling: 17.003228273728364. Distance: 0.8757602250147208
Total norm for 9 adversaries is: 17.003228273728364. distance: 0.8757602250147208
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.0682, Accuracy: 8817/8991 (98.0647%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  78, local model 49, internal_epoch   1,  Average loss: 0.0007, Accuracy: 507/516 (98.2558%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 514/516 (99.6124%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 49, internal_epoch   3,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 49, internal_epoch   4,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 49, internal_epoch   5,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 49, internal_epoch   6,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 49, internal_epoch   7,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  78, local model 49, internal_epoch   8,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 49, internal_epoch   9,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 49, internal_epoch  10,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 17.04256093011378.
Norm before scaling: 17.004764562388555. Distance: 0.9590540780958975
Total norm for 9 adversaries is: 17.004764562388555. distance: 0.9590540780958975
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.0715, Accuracy: 8827/8991 (98.1760%)
___Train Local_Simple,  epoch  78, local model 84, internal_epoch   1,  Average loss: 0.0057, Accuracy: 513/560 (91.6071%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.3713, Accuracy: 8832/10000 (88.3200%), Attack Success Rate:0/10000(0.000)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  78, local model 46, internal_epoch   1,  Average loss: 0.0008, Accuracy: 467/478 (97.6987%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 46, internal_epoch   2,  Average loss: 0.0003, Accuracy: 476/478 (99.5816%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 46, internal_epoch   3,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 46, internal_epoch   4,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 46, internal_epoch   5,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 46, internal_epoch   6,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 46, internal_epoch   7,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  78, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 17.04256093011378.
Norm before scaling: 17.031178325537255. Distance: 0.9646357261869088
Total norm for 9 adversaries is: 17.031178325537255. distance: 0.9646357261869088
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.0870, Accuracy: 8790/8991 (97.7644%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 592/606 (97.6898%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch   2,  Average loss: 0.0006, Accuracy: 598/606 (98.6799%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch   3,  Average loss: 0.0004, Accuracy: 599/606 (98.8449%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch   9,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch  10,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 17.04256093011378.
Norm before scaling: 16.980260720919176. Distance: 1.341286419163378
Total norm for 9 adversaries is: 16.980260720919176. distance: 1.341286419163378
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.0778, Accuracy: 8786/8991 (97.7199%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  78, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 624/644 (96.8944%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 11, internal_epoch   2,  Average loss: 0.0007, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 11, internal_epoch   3,  Average loss: 0.0011, Accuracy: 635/644 (98.6025%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 11, internal_epoch   7,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  78, local model 11, internal_epoch   8,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 11, internal_epoch   9,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Global model norm: 17.04256093011378.
Norm before scaling: 17.011379248190938. Distance: 1.457424816332088
Total norm for 9 adversaries is: 17.011379248190938. distance: 1.457424816332088
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.1055, Accuracy: 8735/8991 (97.1527%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 505/512 (98.6328%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch   2,  Average loss: 0.0005, Accuracy: 508/512 (99.2188%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch   3,  Average loss: 0.0001, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch   6,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch   7,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch   8,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Global model norm: 17.04256093011378.
Norm before scaling: 16.99011122372456. Distance: 0.8564900959620307
Total norm for 9 adversaries is: 16.99011122372456. distance: 0.8564900959620307
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.0795, Accuracy: 8795/8991 (97.8200%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  78, local model 7, internal_epoch   1,  Average loss: 0.0009, Accuracy: 540/550 (98.1818%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 7, internal_epoch   2,  Average loss: 0.0006, Accuracy: 542/550 (98.5455%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 7, internal_epoch   3,  Average loss: 0.0002, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 7, internal_epoch   4,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  78, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Global model norm: 17.04256093011378.
Norm before scaling: 17.00751822781711. Distance: 1.0596762889830371
Total norm for 9 adversaries is: 17.00751822781711. distance: 1.0596762889830371
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.0791, Accuracy: 8804/8991 (97.9201%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch   1,  Average loss: 0.0004, Accuracy: 501/505 (99.2079%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch   2,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch   3,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch   4,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch   5,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch   6,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch   7,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch   8,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch   9,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch  10,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Global model norm: 17.04256093011378.
Norm before scaling: 17.00411578451762. Distance: 0.6019295402525784
Total norm for 9 adversaries is: 17.00411578451762. distance: 0.6019295402525784
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.0655, Accuracy: 8831/8991 (98.2204%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  78, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 737/750 (98.2667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 744/750 (99.2000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 45, internal_epoch   3,  Average loss: 0.0001, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 45, internal_epoch   4,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 45, internal_epoch   5,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 45, internal_epoch   6,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 45, internal_epoch   7,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  78, local model 45, internal_epoch   8,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 45, internal_epoch   9,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  78, local model 45, internal_epoch  10,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 17.04256093011378.
Norm before scaling: 16.96557362651091. Distance: 1.2568447109766865
Total norm for 9 adversaries is: 16.96557362651091. distance: 1.2568447109766865
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.0823, Accuracy: 8787/8991 (97.7311%)
time spent on training: 141.55648517608643
[foolsgold agg] training data poison_ratio: 0.9006916119879411  data num: [518, 516, 560, 478, 606, 644, 512, 550, 505, 750]
[foolsgold agg] considering poison per batch poison_fraction: 0.9006916119879411
[foolsgold agg] wv: [1.         0.93453817 1.         1.         1.         0.72591993
 1.         0.72591993 1.         0.86230762]
___Test Target_Simple poisoned: False, epoch: 78: Average loss: 0.9375, Accuracy: 8852/10000 (88.5200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 78: Average loss: 0.0650, Accuracy: 8840/8991 (98.3205%)
Done in 308.6164391040802 sec.
Server Epoch:79 choose agents : [54, 29, 4, 38, 52, 86, 28, 34, 15, 75].
___Train Local_Simple,  epoch  79, local model 54, internal_epoch   1,  Average loss: 0.0057, Accuracy: 490/523 (93.6902%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.1838, Accuracy: 9323/10000 (93.2300%), Attack Success Rate:0/10000(0.000)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  79, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 595/605 (98.3471%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 601/605 (99.3388%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 29, internal_epoch   3,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 29, internal_epoch   6,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 29, internal_epoch   7,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  79, local model 29, internal_epoch   8,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 17.054278618266242.
Norm before scaling: 16.998623062917662. Distance: 0.9810183986762224
Total norm for 6 adversaries is: 16.998623062917662. distance: 0.9810183986762224
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.0796, Accuracy: 8815/8991 (98.0425%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 580/587 (98.8075%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch   2,  Average loss: 0.0003, Accuracy: 582/587 (99.1482%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch   3,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch   4,  Average loss: 0.0001, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch   5,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch   6,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch   7,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 17.054278618266242.
Norm before scaling: 17.027634543140913. Distance: 1.0138240398645975
Total norm for 6 adversaries is: 17.027634543140913. distance: 1.0138240398645975
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.0685, Accuracy: 8829/8991 (98.1982%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  79, local model 38, internal_epoch   1,  Average loss: 0.0010, Accuracy: 761/774 (98.3204%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 38, internal_epoch   2,  Average loss: 0.0005, Accuracy: 766/774 (98.9664%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 38, internal_epoch   3,  Average loss: 0.0004, Accuracy: 767/774 (99.0956%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 38, internal_epoch   4,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 38, internal_epoch   5,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 38, internal_epoch   6,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 38, internal_epoch   7,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  79, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Global model norm: 17.054278618266242.
Norm before scaling: 17.002817257082263. Distance: 1.318782936154954
Total norm for 6 adversaries is: 17.002817257082263. distance: 1.318782936154954
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.0674, Accuracy: 8816/8991 (98.0536%)
___Train Local_Simple,  epoch  79, local model 52, internal_epoch   1,  Average loss: 0.0063, Accuracy: 561/618 (90.7767%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.1833, Accuracy: 9428/10000 (94.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 86, internal_epoch   1,  Average loss: 0.0044, Accuracy: 548/587 (93.3560%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.1706, Accuracy: 9545/10000 (95.4500%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  79, local model 28, internal_epoch   1,  Average loss: 0.0018, Accuracy: 653/665 (98.1955%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 28, internal_epoch   2,  Average loss: 0.0011, Accuracy: 651/665 (97.8947%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 28, internal_epoch   3,  Average loss: 0.0007, Accuracy: 658/665 (98.9474%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 28, internal_epoch   4,  Average loss: 0.0004, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 28, internal_epoch   5,  Average loss: 0.0002, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 28, internal_epoch   6,  Average loss: 0.0001, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  79, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 17.054278618266242.
Norm before scaling: 16.967030587381075. Distance: 1.35537006997381
Total norm for 6 adversaries is: 16.967030587381075. distance: 1.35537006997381
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.0687, Accuracy: 8809/8991 (97.9758%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  79, local model 34, internal_epoch   1,  Average loss: 0.0029, Accuracy: 513/528 (97.1591%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 34, internal_epoch   2,  Average loss: 0.0012, Accuracy: 517/528 (97.9167%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 34, internal_epoch   3,  Average loss: 0.0008, Accuracy: 519/528 (98.2955%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 34, internal_epoch   4,  Average loss: 0.0004, Accuracy: 523/528 (99.0530%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 34, internal_epoch   5,  Average loss: 0.0002, Accuracy: 527/528 (99.8106%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 34, internal_epoch   6,  Average loss: 0.0002, Accuracy: 527/528 (99.8106%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 34, internal_epoch   7,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  79, local model 34, internal_epoch   8,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 34, internal_epoch   9,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 34, internal_epoch  10,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Global model norm: 17.054278618266242.
Norm before scaling: 17.028496587923488. Distance: 1.693867221168356
Total norm for 6 adversaries is: 17.028496587923488. distance: 1.693867221168356
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.0846, Accuracy: 8765/8991 (97.4864%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  79, local model 15, internal_epoch   1,  Average loss: 0.0012, Accuracy: 562/572 (98.2517%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 15, internal_epoch   2,  Average loss: 0.0003, Accuracy: 567/572 (99.1259%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 15, internal_epoch   3,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 15, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 15, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  79, local model 15, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 15, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  79, local model 15, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.054278618266242.
Norm before scaling: 16.98352149706904. Distance: 0.9618538000138929
Total norm for 6 adversaries is: 16.98352149706904. distance: 0.9618538000138929
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.0704, Accuracy: 8822/8991 (98.1203%)
___Train Local_Simple,  epoch  79, local model 75, internal_epoch   1,  Average loss: 0.0046, Accuracy: 511/554 (92.2383%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.1527, Accuracy: 9540/10000 (95.4000%), Attack Success Rate:0/10000(0.000)
time spent on training: 113.7279531955719
[foolsgold agg] training data poison_ratio: 0.6204889406286379  data num: [523, 605, 587, 774, 618, 587, 665, 528, 572, 554]
[foolsgold agg] considering poison per batch poison_fraction: 0.6204889406286379
[foolsgold agg] wv: [0. 1. 1. 1. 0. 0. 1. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 79: Average loss: 1.0503, Accuracy: 8846/10000 (88.4600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 79: Average loss: 0.0681, Accuracy: 8834/8991 (98.2538%)
Done in 280.17998790740967 sec.
Server Epoch:80 choose agents : [66, 24, 28, 36, 54, 92, 27, 46, 29, 52].
___Train Local_Simple,  epoch  80, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 573/629 (91.0970%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.2072, Accuracy: 9334/10000 (93.3400%), Attack Success Rate:0/10000(0.000)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  80, local model 24, internal_epoch   1,  Average loss: 0.0004, Accuracy: 573/578 (99.1349%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 24, internal_epoch   2,  Average loss: 0.0001, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 24, internal_epoch   3,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 24, internal_epoch   4,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 24, internal_epoch   5,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 24, internal_epoch   6,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 24, internal_epoch   7,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  80, local model 24, internal_epoch   8,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 24, internal_epoch   9,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 24, internal_epoch  10,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 17.07039205502057.
Norm before scaling: 17.0183769081511. Distance: 0.7004369640605282
Total norm for 6 adversaries is: 17.0183769081511. distance: 0.7004369640605282
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.0745, Accuracy: 8814/8991 (98.0314%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  80, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 651/665 (97.8947%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 28, internal_epoch   2,  Average loss: 0.0011, Accuracy: 648/665 (97.4436%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 28, internal_epoch   3,  Average loss: 0.0004, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 28, internal_epoch   4,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 28, internal_epoch   5,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 28, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  80, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 17.07039205502057.
Norm before scaling: 16.985506948250396. Distance: 1.2964460743680015
Total norm for 6 adversaries is: 16.985506948250396. distance: 1.2964460743680015
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.0683, Accuracy: 8816/8991 (98.0536%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  80, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 510/520 (98.0769%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 36, internal_epoch   2,  Average loss: 0.0016, Accuracy: 506/520 (97.3077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 36, internal_epoch   3,  Average loss: 0.0014, Accuracy: 506/520 (97.3077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 36, internal_epoch   4,  Average loss: 0.0005, Accuracy: 516/520 (99.2308%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 36, internal_epoch   5,  Average loss: 0.0003, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 36, internal_epoch   6,  Average loss: 0.0002, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 36, internal_epoch   7,  Average loss: 0.0002, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  80, local model 36, internal_epoch   8,  Average loss: 0.0002, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Global model norm: 17.07039205502057.
Norm before scaling: 17.139220187988244. Distance: 2.4400707284650807
Total norm for 6 adversaries is: 17.139220187988244. distance: 2.4400707284650807
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.0863, Accuracy: 8773/8991 (97.5754%)
___Train Local_Simple,  epoch  80, local model 54, internal_epoch   1,  Average loss: 0.0054, Accuracy: 478/523 (91.3958%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.1930, Accuracy: 9348/10000 (93.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 92, internal_epoch   1,  Average loss: 0.0038, Accuracy: 542/571 (94.9212%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.1516, Accuracy: 9514/10000 (95.1400%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  80, local model 27, internal_epoch   1,  Average loss: 0.0009, Accuracy: 640/650 (98.4615%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 27, internal_epoch   2,  Average loss: 0.0002, Accuracy: 647/650 (99.5385%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 27, internal_epoch   3,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 27, internal_epoch   4,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 27, internal_epoch   5,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 27, internal_epoch   6,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 27, internal_epoch   7,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  80, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 17.07039205502057.
Norm before scaling: 17.01288520326441. Distance: 1.0979301138144253
Total norm for 6 adversaries is: 17.01288520326441. distance: 1.0979301138144253
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.0708, Accuracy: 8828/8991 (98.1871%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  80, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 472/478 (98.7448%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 46, internal_epoch   2,  Average loss: 0.0003, Accuracy: 476/478 (99.5816%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 46, internal_epoch   3,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 46, internal_epoch   4,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 46, internal_epoch   5,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 46, internal_epoch   6,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 46, internal_epoch   7,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  80, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 17.07039205502057.
Norm before scaling: 17.040917912506394. Distance: 0.860260316684347
Total norm for 6 adversaries is: 17.040917912506394. distance: 0.860260316684347
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.0794, Accuracy: 8803/8991 (97.9090%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  80, local model 29, internal_epoch   1,  Average loss: 0.0008, Accuracy: 593/605 (98.0165%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 600/605 (99.1736%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 29, internal_epoch   3,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 29, internal_epoch   4,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 29, internal_epoch   5,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 29, internal_epoch   6,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 29, internal_epoch   7,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  80, local model 29, internal_epoch   8,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  80, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 17.07039205502057.
Norm before scaling: 17.02832454089133. Distance: 0.9437822930072025
Total norm for 6 adversaries is: 17.02832454089133. distance: 0.9437822930072025
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.0804, Accuracy: 8803/8991 (97.9090%)
___Train Local_Simple,  epoch  80, local model 52, internal_epoch   1,  Average loss: 0.0059, Accuracy: 561/618 (90.7767%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.2261, Accuracy: 9285/10000 (92.8500%), Attack Success Rate:0/10000(0.000)
time spent on training: 111.97113585472107
[foolsgold agg] training data poison_ratio: 0.5989378105191023  data num: [629, 578, 665, 520, 523, 571, 650, 478, 605, 618]
[foolsgold agg] considering poison per batch poison_fraction: 0.5989378105191023
[foolsgold agg] wv: [0. 1. 1. 1. 0. 1. 1. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 80: Average loss: 1.0267, Accuracy: 8856/10000 (88.5600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 80: Average loss: 0.0645, Accuracy: 8843/8991 (98.3539%)
Done in 280.2753412723541 sec.
Server Epoch:81 choose agents : [18, 22, 59, 69, 37, 56, 36, 68, 39, 46].
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  81, local model 18, internal_epoch   1,  Average loss: 0.0013, Accuracy: 509/516 (98.6434%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 18, internal_epoch   2,  Average loss: 0.0016, Accuracy: 514/516 (99.6124%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 18, internal_epoch   3,  Average loss: 0.0009, Accuracy: 504/516 (97.6744%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 18, internal_epoch   4,  Average loss: 0.0005, Accuracy: 514/516 (99.6124%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 18, internal_epoch   5,  Average loss: 0.0004, Accuracy: 513/516 (99.4186%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 18, internal_epoch   6,  Average loss: 0.0002, Accuracy: 513/516 (99.4186%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 514/516 (99.6124%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  81, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 17.08280167411392.
Norm before scaling: 17.036040753951973. Distance: 1.3798371109680176
Total norm for 6 adversaries is: 17.036040753951973. distance: 1.3798371109680176
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.0718, Accuracy: 8821/8991 (98.1092%)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  81, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 521/531 (98.1168%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 529/531 (99.6234%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 22, internal_epoch   3,  Average loss: 0.0001, Accuracy: 530/531 (99.8117%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 22, internal_epoch   4,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 22, internal_epoch   5,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 22, internal_epoch   6,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 22, internal_epoch   7,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  81, local model 22, internal_epoch   8,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 22, internal_epoch   9,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 22, internal_epoch  10,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Global model norm: 17.08280167411392.
Norm before scaling: 17.051441227920257. Distance: 1.00211004326027
Total norm for 6 adversaries is: 17.051441227920257. distance: 1.00211004326027
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.0905, Accuracy: 8792/8991 (97.7867%)
___Train Local_Simple,  epoch  81, local model 59, internal_epoch   1,  Average loss: 0.0041, Accuracy: 613/652 (94.0184%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.3296, Accuracy: 8901/10000 (89.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 69, internal_epoch   1,  Average loss: 0.0066, Accuracy: 597/646 (92.4149%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.2512, Accuracy: 9158/10000 (91.5800%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  81, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 632/641 (98.5959%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 37, internal_epoch   2,  Average loss: 0.0003, Accuracy: 637/641 (99.3760%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 37, internal_epoch   3,  Average loss: 0.0001, Accuracy: 638/641 (99.5320%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 37, internal_epoch   4,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 37, internal_epoch   5,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 37, internal_epoch   6,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  81, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 17.08280167411392.
Norm before scaling: 17.02088811796314. Distance: 1.002836733840554
Total norm for 6 adversaries is: 17.02088811796314. distance: 1.002836733840554
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.0789, Accuracy: 8796/8991 (97.8312%)
___Train Local_Simple,  epoch  81, local model 56, internal_epoch   1,  Average loss: 0.0044, Accuracy: 585/626 (93.4505%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1715, Accuracy: 9445/10000 (94.4500%), Attack Success Rate:0/10000(0.000)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  81, local model 36, internal_epoch   1,  Average loss: 0.0017, Accuracy: 510/520 (98.0769%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 36, internal_epoch   2,  Average loss: 0.0011, Accuracy: 509/520 (97.8846%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 36, internal_epoch   3,  Average loss: 0.0019, Accuracy: 507/520 (97.5000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 36, internal_epoch   4,  Average loss: 0.0007, Accuracy: 516/520 (99.2308%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 36, internal_epoch   5,  Average loss: 0.0004, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 36, internal_epoch   6,  Average loss: 0.0002, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 36, internal_epoch   7,  Average loss: 0.0001, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  81, local model 36, internal_epoch   8,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Global model norm: 17.08280167411392.
Norm before scaling: 17.075411316593794. Distance: 1.5623249718863041
Total norm for 6 adversaries is: 17.075411316593794. distance: 1.5623249718863041
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.0901, Accuracy: 8752/8991 (97.3418%)
___Train Local_Simple,  epoch  81, local model 68, internal_epoch   1,  Average loss: 0.0037, Accuracy: 604/632 (95.5696%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1140, Accuracy: 9632/10000 (96.3200%), Attack Success Rate:0/10000(0.000)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  81, local model 39, internal_epoch   1,  Average loss: 0.0009, Accuracy: 495/503 (98.4095%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 498/503 (99.0060%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 39, internal_epoch   3,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 39, internal_epoch   4,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 39, internal_epoch   5,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  81, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 17.08280167411392.
Norm before scaling: 17.044903858883856. Distance: 0.9222479243763135
Total norm for 6 adversaries is: 17.044903858883856. distance: 0.9222479243763135
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.0766, Accuracy: 8810/8991 (97.9869%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  81, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 472/478 (98.7448%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 46, internal_epoch   2,  Average loss: 0.0005, Accuracy: 472/478 (98.7448%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 46, internal_epoch   3,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 46, internal_epoch   4,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 46, internal_epoch   5,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 46, internal_epoch   6,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 46, internal_epoch   7,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  81, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  81, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 17.08280167411392.
Norm before scaling: 17.058947518228887. Distance: 0.8814085540443822
Total norm for 6 adversaries is: 17.058947518228887. distance: 0.8814085540443822
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.0727, Accuracy: 8813/8991 (98.0202%)
time spent on training: 108.91136002540588
[foolsgold agg] training data poison_ratio: 0.5550913838120104  data num: [516, 531, 652, 646, 641, 626, 520, 632, 503, 478]
[foolsgold agg] considering poison per batch poison_fraction: 0.5550913838120104
[foolsgold agg] wv: [1.         1.         0.29109717 0.         1.         0.
 1.         0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 81: Average loss: 1.0260, Accuracy: 8858/10000 (88.5800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 81: Average loss: 0.0659, Accuracy: 8844/8991 (98.3650%)
Done in 275.25446796417236 sec.
Server Epoch:82 choose agents : [72, 95, 79, 51, 47, 29, 10, 16, 84, 27].
___Train Local_Simple,  epoch  82, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 487/529 (92.0605%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.2472, Accuracy: 9240/10000 (92.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 95, internal_epoch   1,  Average loss: 0.0053, Accuracy: 490/532 (92.1053%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.3226, Accuracy: 8949/10000 (89.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 79, internal_epoch   1,  Average loss: 0.0035, Accuracy: 606/635 (95.4331%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1875, Accuracy: 9392/10000 (93.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 51, internal_epoch   1,  Average loss: 0.0060, Accuracy: 592/647 (91.4992%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.4473, Accuracy: 8438/10000 (84.3800%), Attack Success Rate:0/10000(0.000)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  82, local model 47, internal_epoch   1,  Average loss: 0.0013, Accuracy: 592/602 (98.3389%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 47, internal_epoch   2,  Average loss: 0.0008, Accuracy: 593/602 (98.5050%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 47, internal_epoch   3,  Average loss: 0.0003, Accuracy: 598/602 (99.3355%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 47, internal_epoch   4,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 47, internal_epoch   5,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 47, internal_epoch   6,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 47, internal_epoch   7,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  82, local model 47, internal_epoch   8,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 47, internal_epoch   9,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 47, internal_epoch  10,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 17.092084228136684.
Norm before scaling: 17.020156579199522. Distance: 1.1747021459918214
Total norm for 5 adversaries is: 17.020156579199522. distance: 1.1747021459918214
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.0655, Accuracy: 8815/8991 (98.0425%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  82, local model 29, internal_epoch   1,  Average loss: 0.0008, Accuracy: 598/605 (98.8430%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 29, internal_epoch   2,  Average loss: 0.0006, Accuracy: 600/605 (99.1736%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 29, internal_epoch   3,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 29, internal_epoch   6,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 29, internal_epoch   7,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  82, local model 29, internal_epoch   8,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 17.092084228136684.
Norm before scaling: 17.03779708592093. Distance: 0.8924546438066958
Total norm for 5 adversaries is: 17.03779708592093. distance: 0.8924546438066958
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.0755, Accuracy: 8815/8991 (98.0425%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  82, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 10, internal_epoch   2,  Average loss: 0.0005, Accuracy: 565/572 (98.7762%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 10, internal_epoch   3,  Average loss: 0.0003, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 10, internal_epoch   5,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 10, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 10, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  82, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.092084228136684.
Norm before scaling: 17.047463970691688. Distance: 1.0319072478515887
Total norm for 5 adversaries is: 17.047463970691688. distance: 1.0319072478515887
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.0805, Accuracy: 8806/8991 (97.9424%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  82, local model 16, internal_epoch   1,  Average loss: 0.0010, Accuracy: 571/581 (98.2788%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 16, internal_epoch   2,  Average loss: 0.0003, Accuracy: 577/581 (99.3115%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 16, internal_epoch   3,  Average loss: 0.0002, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 16, internal_epoch   4,  Average loss: 0.0001, Accuracy: 580/581 (99.8279%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 16, internal_epoch   5,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 16, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 16, internal_epoch   7,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  82, local model 16, internal_epoch   8,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 16, internal_epoch   9,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 16, internal_epoch  10,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 17.092084228136684.
Norm before scaling: 17.03331140764372. Distance: 0.9457515296066543
Total norm for 5 adversaries is: 17.03331140764372. distance: 0.9457515296066543
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.0639, Accuracy: 8834/8991 (98.2538%)
___Train Local_Simple,  epoch  82, local model 84, internal_epoch   1,  Average loss: 0.0058, Accuracy: 511/560 (91.2500%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1447, Accuracy: 9544/10000 (95.4400%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  82, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 641/650 (98.6154%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 27, internal_epoch   2,  Average loss: 0.0005, Accuracy: 644/650 (99.0769%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 27, internal_epoch   3,  Average loss: 0.0002, Accuracy: 647/650 (99.5385%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 27, internal_epoch   6,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 27, internal_epoch   7,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  82, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  82, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 17.092084228136684.
Norm before scaling: 17.046115036623355. Distance: 1.1652722313230721
Total norm for 5 adversaries is: 17.046115036623355. distance: 1.1652722313230721
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.0659, Accuracy: 8833/8991 (98.2427%)
time spent on training: 101.93224000930786
[foolsgold agg] training data poison_ratio: 0.5090478606460341  data num: [529, 532, 635, 647, 602, 605, 572, 581, 560, 650]
[foolsgold agg] considering poison per batch poison_fraction: 0.5090478606460341
[foolsgold agg] wv: [0. 1. 0. 0. 1. 1. 1. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 82: Average loss: 1.0508, Accuracy: 8871/10000 (88.7100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 82: Average loss: 0.0624, Accuracy: 8854/8991 (98.4763%)
Done in 267.89936900138855 sec.
Server Epoch:83 choose agents : [47, 97, 40, 98, 33, 92, 96, 76, 73, 72].
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  83, local model 47, internal_epoch   1,  Average loss: 0.0012, Accuracy: 590/602 (98.0066%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 47, internal_epoch   2,  Average loss: 0.0007, Accuracy: 593/602 (98.5050%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 47, internal_epoch   3,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 47, internal_epoch   4,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 47, internal_epoch   5,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 47, internal_epoch   6,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 47, internal_epoch   7,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  83, local model 47, internal_epoch   8,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 47, internal_epoch   9,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 47, internal_epoch  10,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 17.099433470147485.
Norm before scaling: 17.034086274727027. Distance: 1.1995277627941712
Total norm for 3 adversaries is: 17.034086274727027. distance: 1.1995277627941712
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.0821, Accuracy: 8793/8991 (97.7978%)
___Train Local_Simple,  epoch  83, local model 97, internal_epoch   1,  Average loss: 0.0076, Accuracy: 520/588 (88.4354%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.4499, Accuracy: 8523/10000 (85.2300%), Attack Success Rate:0/10000(0.000)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  83, local model 40, internal_epoch   1,  Average loss: 0.0007, Accuracy: 556/563 (98.7567%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 40, internal_epoch   2,  Average loss: 0.0009, Accuracy: 554/563 (98.4014%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 40, internal_epoch   3,  Average loss: 0.0004, Accuracy: 560/563 (99.4671%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 40, internal_epoch   5,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 40, internal_epoch   6,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  83, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 17.099433470147485.
Norm before scaling: 17.04586081280759. Distance: 0.9373298808561513
Total norm for 3 adversaries is: 17.04586081280759. distance: 0.9373298808561513
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.0672, Accuracy: 8827/8991 (98.1760%)
___Train Local_Simple,  epoch  83, local model 98, internal_epoch   1,  Average loss: 0.0045, Accuracy: 523/568 (92.0775%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.2877, Accuracy: 9119/10000 (91.1900%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  83, local model 33, internal_epoch   1,  Average loss: 0.0008, Accuracy: 628/638 (98.4326%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 33, internal_epoch   2,  Average loss: 0.0003, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 33, internal_epoch   3,  Average loss: 0.0001, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 33, internal_epoch   4,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 33, internal_epoch   5,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 33, internal_epoch   6,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  83, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  83, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 17.099433470147485.
Norm before scaling: 17.0366202470842. Distance: 0.9570219701200279
Total norm for 3 adversaries is: 17.0366202470842. distance: 0.9570219701200279
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.0623, Accuracy: 8830/8991 (98.2093%)
___Train Local_Simple,  epoch  83, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 546/571 (95.6217%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.1716, Accuracy: 9479/10000 (94.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 96, internal_epoch   1,  Average loss: 0.0056, Accuracy: 563/608 (92.5987%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.2618, Accuracy: 9148/10000 (91.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 76, internal_epoch   1,  Average loss: 0.0073, Accuracy: 466/518 (89.9614%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.1850, Accuracy: 9442/10000 (94.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 73, internal_epoch   1,  Average loss: 0.0059, Accuracy: 573/626 (91.5335%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.2595, Accuracy: 9386/10000 (93.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 72, internal_epoch   1,  Average loss: 0.0052, Accuracy: 494/529 (93.3837%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.1839, Accuracy: 9431/10000 (94.3100%), Attack Success Rate:0/10000(0.000)
time spent on training: 80.59459090232849
[foolsgold agg] training data poison_ratio: 0.31027361899845124  data num: [602, 588, 563, 568, 638, 571, 608, 518, 626, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.31027361899845124
[foolsgold agg] wv: [1.         0.         1.         0.         1.         0.63536965
 0.         0.66355985 0.         0.        ]
___Test Target_Simple poisoned: False, epoch: 83: Average loss: 0.9613, Accuracy: 8876/10000 (88.7600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 83: Average loss: 0.0600, Accuracy: 8858/8991 (98.5207%)
Done in 246.63459300994873 sec.
Server Epoch:84 choose agents : [68, 38, 40, 13, 30, 2, 83, 51, 27, 88].
___Train Local_Simple,  epoch  84, local model 68, internal_epoch   1,  Average loss: 0.0038, Accuracy: 600/632 (94.9367%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.2103, Accuracy: 9312/10000 (93.1200%), Attack Success Rate:0/10000(0.000)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  84, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 761/774 (98.3204%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 38, internal_epoch   2,  Average loss: 0.0003, Accuracy: 770/774 (99.4832%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 38, internal_epoch   3,  Average loss: 0.0002, Accuracy: 771/774 (99.6124%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 38, internal_epoch   4,  Average loss: 0.0001, Accuracy: 773/774 (99.8708%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 38, internal_epoch   5,  Average loss: 0.0001, Accuracy: 773/774 (99.8708%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 38, internal_epoch   6,  Average loss: 0.0001, Accuracy: 773/774 (99.8708%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 38, internal_epoch   7,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  84, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Global model norm: 17.099585170064252.
Norm before scaling: 17.04047377809758. Distance: 1.2531307591332115
Total norm for 6 adversaries is: 17.04047377809758. distance: 1.2531307591332115
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.0662, Accuracy: 8826/8991 (98.1648%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  84, local model 40, internal_epoch   1,  Average loss: 0.0009, Accuracy: 555/563 (98.5790%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 40, internal_epoch   2,  Average loss: 0.0007, Accuracy: 557/563 (98.9343%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 40, internal_epoch   3,  Average loss: 0.0004, Accuracy: 559/563 (99.2895%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 40, internal_epoch   4,  Average loss: 0.0002, Accuracy: 562/563 (99.8224%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 562/563 (99.8224%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 40, internal_epoch   6,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  84, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 17.099585170064252.
Norm before scaling: 17.05269578670041. Distance: 0.8875900222898279
Total norm for 6 adversaries is: 17.05269578670041. distance: 0.8875900222898279
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.0658, Accuracy: 8834/8991 (98.2538%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 515/521 (98.8484%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 13, internal_epoch   2,  Average loss: 0.0004, Accuracy: 517/521 (99.2322%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 13, internal_epoch   3,  Average loss: 0.0004, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 13, internal_epoch   4,  Average loss: 0.0002, Accuracy: 519/521 (99.6161%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 13, internal_epoch   5,  Average loss: 0.0002, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 13, internal_epoch   7,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  84, local model 13, internal_epoch   8,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 13, internal_epoch   9,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 13, internal_epoch  10,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 17.099585170064252.
Norm before scaling: 17.045385475712333. Distance: 0.9582271344317831
Total norm for 6 adversaries is: 17.045385475712333. distance: 0.9582271344317831
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.0588, Accuracy: 8838/8991 (98.2983%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  84, local model 30, internal_epoch   1,  Average loss: 0.0013, Accuracy: 656/668 (98.2036%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 30, internal_epoch   2,  Average loss: 0.0005, Accuracy: 661/668 (98.9521%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 30, internal_epoch   3,  Average loss: 0.0002, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  84, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 17.099585170064252.
Norm before scaling: 17.040701219341738. Distance: 1.1866661959193578
Total norm for 6 adversaries is: 17.040701219341738. distance: 1.1866661959193578
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.0767, Accuracy: 8806/8991 (97.9424%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch   1,  Average loss: 0.0009, Accuracy: 574/580 (98.9655%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch   2,  Average loss: 0.0002, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch   3,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch   4,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch   5,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch   6,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch   7,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch   8,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch   9,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch  10,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Global model norm: 17.099585170064252.
Norm before scaling: 17.02891325712683. Distance: 0.8209604156862179
Total norm for 6 adversaries is: 17.02891325712683. distance: 0.8209604156862179
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.0695, Accuracy: 8835/8991 (98.2649%)
___Train Local_Simple,  epoch  84, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 507/555 (91.3514%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.1269, Accuracy: 9627/10000 (96.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 51, internal_epoch   1,  Average loss: 0.0040, Accuracy: 605/647 (93.5085%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.1516, Accuracy: 9522/10000 (95.2200%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  84, local model 27, internal_epoch   1,  Average loss: 0.0007, Accuracy: 642/650 (98.7692%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 645/650 (99.2308%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 27, internal_epoch   3,  Average loss: 0.0002, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 27, internal_epoch   6,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 27, internal_epoch   7,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  84, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  84, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 17.099585170064252.
Norm before scaling: 17.051584406198703. Distance: 1.045433931467882
Total norm for 6 adversaries is: 17.051584406198703. distance: 1.045433931467882
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.0687, Accuracy: 8836/8991 (98.2761%)
___Train Local_Simple,  epoch  84, local model 88, internal_epoch   1,  Average loss: 0.0044, Accuracy: 625/679 (92.0471%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.2573, Accuracy: 9236/10000 (92.3600%), Attack Success Rate:0/10000(0.000)
time spent on training: 115.71283602714539
[foolsgold agg] training data poison_ratio: 0.5991386185994576  data num: [632, 774, 563, 521, 668, 580, 555, 647, 650, 679]
[foolsgold agg] considering poison per batch poison_fraction: 0.5991386185994576
[foolsgold agg] wv: [0. 1. 1. 1. 1. 1. 0. 0. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 84: Average loss: 1.0452, Accuracy: 8864/10000 (88.6400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 84: Average loss: 0.0620, Accuracy: 8848/8991 (98.4095%)
Done in 281.2019991874695 sec.
Server Epoch:85 choose agents : [6, 49, 50, 32, 22, 78, 64, 66, 82, 47].
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  85, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 696/708 (98.3051%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 6, internal_epoch   2,  Average loss: 0.0004, Accuracy: 702/708 (99.1525%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 6, internal_epoch   3,  Average loss: 0.0002, Accuracy: 704/708 (99.4350%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 6, internal_epoch   4,  Average loss: 0.0001, Accuracy: 706/708 (99.7175%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 6, internal_epoch   5,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 6, internal_epoch   6,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 6, internal_epoch   7,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  85, local model 6, internal_epoch   8,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 6, internal_epoch   9,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 6, internal_epoch  10,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 17.11178725146655.
Norm before scaling: 17.066165292845795. Distance: 1.1105051865402906
Total norm for 6 adversaries is: 17.066165292845795. distance: 1.1105051865402906
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.0607, Accuracy: 8837/8991 (98.2872%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  85, local model 49, internal_epoch   1,  Average loss: 0.0006, Accuracy: 509/516 (98.6434%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 49, internal_epoch   2,  Average loss: 0.0004, Accuracy: 511/516 (99.0310%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 49, internal_epoch   3,  Average loss: 0.0004, Accuracy: 514/516 (99.6124%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 49, internal_epoch   4,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 49, internal_epoch   5,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 49, internal_epoch   6,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 49, internal_epoch   7,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  85, local model 49, internal_epoch   8,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 49, internal_epoch   9,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 49, internal_epoch  10,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 17.11178725146655.
Norm before scaling: 17.07234237788061. Distance: 0.9130624370304671
Total norm for 6 adversaries is: 17.07234237788061. distance: 0.9130624370304671
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.0698, Accuracy: 8833/8991 (98.2427%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  85, local model 50, internal_epoch   1,  Average loss: 0.0011, Accuracy: 467/474 (98.5232%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 50, internal_epoch   3,  Average loss: 0.0006, Accuracy: 468/474 (98.7342%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 50, internal_epoch   4,  Average loss: 0.0002, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  85, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 17.11178725146655.
Norm before scaling: 17.061679023861668. Distance: 0.8927978979618355
Total norm for 6 adversaries is: 17.061679023861668. distance: 0.8927978979618355
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.0822, Accuracy: 8800/8991 (97.8757%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  85, local model 32, internal_epoch   1,  Average loss: 0.0006, Accuracy: 602/609 (98.8506%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 32, internal_epoch   2,  Average loss: 0.0003, Accuracy: 607/609 (99.6716%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 32, internal_epoch   3,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 32, internal_epoch   4,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 32, internal_epoch   5,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 32, internal_epoch   6,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  85, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 17.11178725146655.
Norm before scaling: 17.050307392470504. Distance: 0.8471298692914264
Total norm for 6 adversaries is: 17.050307392470504. distance: 0.8471298692914264
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.0711, Accuracy: 8818/8991 (98.0759%)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  85, local model 22, internal_epoch   1,  Average loss: 0.0008, Accuracy: 522/531 (98.3051%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 22, internal_epoch   2,  Average loss: 0.0003, Accuracy: 528/531 (99.4350%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 22, internal_epoch   3,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 22, internal_epoch   4,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 22, internal_epoch   5,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 22, internal_epoch   6,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 22, internal_epoch   7,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  85, local model 22, internal_epoch   8,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 22, internal_epoch   9,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 22, internal_epoch  10,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Global model norm: 17.11178725146655.
Norm before scaling: 17.07789895064259. Distance: 0.9004675114504154
Total norm for 6 adversaries is: 17.07789895064259. distance: 0.9004675114504154
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.0791, Accuracy: 8817/8991 (98.0647%)
___Train Local_Simple,  epoch  85, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 581/624 (93.1090%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1879, Accuracy: 9464/10000 (94.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 64, internal_epoch   1,  Average loss: 0.0078, Accuracy: 516/566 (91.1661%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1960, Accuracy: 9500/10000 (95.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 66, internal_epoch   1,  Average loss: 0.0048, Accuracy: 586/629 (93.1638%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1376, Accuracy: 9585/10000 (95.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 82, internal_epoch   1,  Average loss: 0.0053, Accuracy: 571/621 (91.9485%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.2007, Accuracy: 9428/10000 (94.2800%), Attack Success Rate:0/10000(0.000)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  85, local model 47, internal_epoch   1,  Average loss: 0.0011, Accuracy: 594/602 (98.6711%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 47, internal_epoch   3,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 47, internal_epoch   4,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 47, internal_epoch   5,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 47, internal_epoch   6,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 47, internal_epoch   7,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  85, local model 47, internal_epoch   8,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 47, internal_epoch   9,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  85, local model 47, internal_epoch  10,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 17.11178725146655.
Norm before scaling: 17.049849183430755. Distance: 1.0201161194134212
Total norm for 6 adversaries is: 17.049849183430755. distance: 1.0201161194134212
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.0705, Accuracy: 8822/8991 (98.1203%)
time spent on training: 111.97460770606995
[foolsgold agg] training data poison_ratio: 0.5850340136054422  data num: [708, 516, 474, 609, 531, 624, 566, 629, 621, 602]
[foolsgold agg] considering poison per batch poison_fraction: 0.5850340136054422
[foolsgold agg] wv: [1. 1. 1. 1. 1. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 85: Average loss: 1.0874, Accuracy: 8860/10000 (88.6000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 85: Average loss: 0.0669, Accuracy: 8845/8991 (98.3762%)
Done in 277.2039740085602 sec.
Server Epoch:86 choose agents : [1, 14, 49, 15, 89, 79, 44, 9, 13, 68].
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch   1,  Average loss: 0.0014, Accuracy: 596/606 (98.3498%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch   2,  Average loss: 0.0009, Accuracy: 596/606 (98.3498%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch   3,  Average loss: 0.0007, Accuracy: 597/606 (98.5149%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch   4,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch   9,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 17.122638623120235.
Norm before scaling: 17.05486733328229. Distance: 1.1910775653650787
Total norm for 7 adversaries is: 17.05486733328229. distance: 1.1910775653650787
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.0684, Accuracy: 8812/8991 (98.0091%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  86, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 525/535 (98.1308%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 14, internal_epoch   2,  Average loss: 0.0005, Accuracy: 532/535 (99.4393%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 14, internal_epoch   3,  Average loss: 0.0002, Accuracy: 532/535 (99.4393%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  86, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 17.122638623120235.
Norm before scaling: 17.071253728341745. Distance: 1.2114407877855549
Total norm for 7 adversaries is: 17.071253728341745. distance: 1.2114407877855549
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.0801, Accuracy: 8788/8991 (97.7422%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  86, local model 49, internal_epoch   1,  Average loss: 0.0007, Accuracy: 506/516 (98.0620%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 49, internal_epoch   2,  Average loss: 0.0004, Accuracy: 511/516 (99.0310%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 49, internal_epoch   3,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 49, internal_epoch   4,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 49, internal_epoch   5,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 49, internal_epoch   6,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 49, internal_epoch   7,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  86, local model 49, internal_epoch   8,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 49, internal_epoch   9,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 49, internal_epoch  10,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 17.122638623120235.
Norm before scaling: 17.09246810207094. Distance: 0.9885677178785344
Total norm for 7 adversaries is: 17.09246810207094. distance: 0.9885677178785344
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.0759, Accuracy: 8815/8991 (98.0425%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  86, local model 15, internal_epoch   1,  Average loss: 0.0011, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 15, internal_epoch   2,  Average loss: 0.0004, Accuracy: 568/572 (99.3007%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 15, internal_epoch   3,  Average loss: 0.0001, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 15, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 15, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  86, local model 15, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 15, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 15, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.122638623120235.
Norm before scaling: 17.046820398342895. Distance: 0.9087152165363522
Total norm for 7 adversaries is: 17.046820398342895. distance: 0.9087152165363522
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.0658, Accuracy: 8830/8991 (98.2093%)
___Train Local_Simple,  epoch  86, local model 89, internal_epoch   1,  Average loss: 0.0037, Accuracy: 631/664 (95.0301%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.1521, Accuracy: 9539/10000 (95.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 601/635 (94.6457%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.2406, Accuracy: 9226/10000 (92.2600%), Attack Success Rate:0/10000(0.000)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  86, local model 44, internal_epoch   1,  Average loss: 0.0011, Accuracy: 507/518 (97.8764%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 44, internal_epoch   2,  Average loss: 0.0004, Accuracy: 512/518 (98.8417%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 44, internal_epoch   3,  Average loss: 0.0002, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 44, internal_epoch   4,  Average loss: 0.0001, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 44, internal_epoch   5,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 44, internal_epoch   6,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 44, internal_epoch   7,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  86, local model 44, internal_epoch   8,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 44, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 44, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 17.122638623120235.
Norm before scaling: 17.06313850968752. Distance: 1.0206208234936303
Total norm for 7 adversaries is: 17.06313850968752. distance: 1.0206208234936303
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.0672, Accuracy: 8837/8991 (98.2872%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  86, local model 9, internal_epoch   1,  Average loss: 0.0013, Accuracy: 538/548 (98.1752%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 9, internal_epoch   2,  Average loss: 0.0006, Accuracy: 539/548 (98.3577%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 9, internal_epoch   3,  Average loss: 0.0003, Accuracy: 544/548 (99.2701%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 9, internal_epoch   4,  Average loss: 0.0002, Accuracy: 545/548 (99.4526%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 9, internal_epoch   5,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 9, internal_epoch   6,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 9, internal_epoch   7,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  86, local model 9, internal_epoch   8,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 9, internal_epoch   9,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 9, internal_epoch  10,  Average loss: 0.0000, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Global model norm: 17.122638623120235.
Norm before scaling: 17.06271015638663. Distance: 1.0372335643371795
Total norm for 7 adversaries is: 17.06271015638663. distance: 1.0372335643371795
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.0635, Accuracy: 8830/8991 (98.2093%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 515/521 (98.8484%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 13, internal_epoch   3,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 13, internal_epoch   4,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 13, internal_epoch   5,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 13, internal_epoch   6,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 13, internal_epoch   7,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  86, local model 13, internal_epoch   8,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 13, internal_epoch   9,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  86, local model 13, internal_epoch  10,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 17.122638623120235.
Norm before scaling: 17.067279300025476. Distance: 0.872411304545457
Total norm for 7 adversaries is: 17.067279300025476. distance: 0.872411304545457
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.0617, Accuracy: 8830/8991 (98.2093%)
___Train Local_Simple,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0029, Accuracy: 606/632 (95.8861%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.1297, Accuracy: 9609/10000 (96.0900%), Attack Success Rate:0/10000(0.000)
time spent on training: 121.70710778236389
[foolsgold agg] training data poison_ratio: 0.6639986079693754  data num: [606, 535, 516, 572, 664, 635, 518, 548, 521, 632]
[foolsgold agg] considering poison per batch poison_fraction: 0.6639986079693754
[foolsgold agg] wv: [1. 1. 1. 1. 0. 0. 1. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 86: Average loss: 1.0936, Accuracy: 8855/10000 (88.5500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 86: Average loss: 0.0689, Accuracy: 8841/8991 (98.3317%)
Done in 288.60878467559814 sec.
Server Epoch:87 choose agents : [90, 51, 82, 94, 53, 48, 52, 72, 54, 36].
___Train Local_Simple,  epoch  87, local model 90, internal_epoch   1,  Average loss: 0.0070, Accuracy: 520/577 (90.1213%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.2588, Accuracy: 9130/10000 (91.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 51, internal_epoch   1,  Average loss: 0.0044, Accuracy: 609/647 (94.1267%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1478, Accuracy: 9557/10000 (95.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 82, internal_epoch   1,  Average loss: 0.0052, Accuracy: 578/621 (93.0757%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1622, Accuracy: 9445/10000 (94.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 94, internal_epoch   1,  Average loss: 0.0054, Accuracy: 513/555 (92.4324%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1904, Accuracy: 9441/10000 (94.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0045, Accuracy: 578/617 (93.6791%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.2066, Accuracy: 9460/10000 (94.6000%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  87, local model 48, internal_epoch   1,  Average loss: 0.0010, Accuracy: 582/589 (98.8115%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 48, internal_epoch   2,  Average loss: 0.0005, Accuracy: 584/589 (99.1511%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 48, internal_epoch   3,  Average loss: 0.0002, Accuracy: 588/589 (99.8302%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 48, internal_epoch   6,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  87, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 17.133698641869206.
Norm before scaling: 17.107913215236923. Distance: 1.3059040724909552
Total norm for 2 adversaries is: 17.107913215236923. distance: 1.3059040724909552
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.0739, Accuracy: 8810/8991 (97.9869%)
___Train Local_Simple,  epoch  87, local model 52, internal_epoch   1,  Average loss: 0.0052, Accuracy: 565/618 (91.4239%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1738, Accuracy: 9540/10000 (95.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 72, internal_epoch   1,  Average loss: 0.0058, Accuracy: 487/529 (92.0605%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1671, Accuracy: 9565/10000 (95.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 54, internal_epoch   1,  Average loss: 0.0066, Accuracy: 471/523 (90.0574%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.3448, Accuracy: 8845/10000 (88.4500%), Attack Success Rate:0/10000(0.000)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  87, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 512/520 (98.4615%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 36, internal_epoch   2,  Average loss: 0.0003, Accuracy: 516/520 (99.2308%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 36, internal_epoch   3,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 36, internal_epoch   4,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 36, internal_epoch   5,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 36, internal_epoch   6,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 36, internal_epoch   7,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  87, local model 36, internal_epoch   8,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 36, internal_epoch   9,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  87, local model 36, internal_epoch  10,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Global model norm: 17.133698641869206.
Norm before scaling: 17.079427629301026. Distance: 1.0602349653376597
Total norm for 2 adversaries is: 17.079427629301026. distance: 1.0602349653376597
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.0888, Accuracy: 8760/8991 (97.4308%)
time spent on training: 68.80300998687744
[foolsgold agg] training data poison_ratio: 0.19133885438233264  data num: [577, 647, 621, 555, 617, 589, 618, 529, 523, 520]
[foolsgold agg] considering poison per batch poison_fraction: 0.19133885438233264
[foolsgold agg] wv: [0.32699714 0.         0.         0.         0.         1.
 0.         0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 87: Average loss: 1.0711, Accuracy: 8852/10000 (88.5200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 87: Average loss: 0.0684, Accuracy: 8839/8991 (98.3094%)
Done in 235.55499386787415 sec.
Server Epoch:88 choose agents : [94, 90, 75, 70, 69, 80, 96, 82, 37, 1].
___Train Local_Simple,  epoch  88, local model 94, internal_epoch   1,  Average loss: 0.0070, Accuracy: 497/555 (89.5495%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.2611, Accuracy: 9029/10000 (90.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 90, internal_epoch   1,  Average loss: 0.0063, Accuracy: 537/577 (93.0676%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 2.6039, Accuracy: 5817/10000 (58.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 75, internal_epoch   1,  Average loss: 0.0042, Accuracy: 517/554 (93.3213%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1340, Accuracy: 9622/10000 (96.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 70, internal_epoch   1,  Average loss: 0.0066, Accuracy: 497/549 (90.5282%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.2415, Accuracy: 9213/10000 (92.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 69, internal_epoch   1,  Average loss: 0.0061, Accuracy: 601/646 (93.0341%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.2613, Accuracy: 9114/10000 (91.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 80, internal_epoch   1,  Average loss: 0.0050, Accuracy: 547/593 (92.2428%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1376, Accuracy: 9562/10000 (95.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 96, internal_epoch   1,  Average loss: 0.0043, Accuracy: 569/608 (93.5855%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1876, Accuracy: 9425/10000 (94.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 82, internal_epoch   1,  Average loss: 0.0047, Accuracy: 581/621 (93.5588%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.2470, Accuracy: 9288/10000 (92.8800%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  88, local model 37, internal_epoch   1,  Average loss: 0.0004, Accuracy: 636/641 (99.2200%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 37, internal_epoch   2,  Average loss: 0.0001, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 37, internal_epoch   3,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 37, internal_epoch   4,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 37, internal_epoch   5,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 37, internal_epoch   6,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  88, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 17.1366150163546.
Norm before scaling: 17.0700970738695. Distance: 0.8223215840704741
Total norm for 2 adversaries is: 17.0700970738695. distance: 0.8223215840704741
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.0738, Accuracy: 8824/8991 (98.1426%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch   1,  Average loss: 0.0013, Accuracy: 596/606 (98.3498%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch   2,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch   3,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch   6,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch   7,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch   8,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch   9,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch  10,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 17.1366150163546.
Norm before scaling: 17.06168617850845. Distance: 1.072010948078987
Total norm for 2 adversaries is: 17.06168617850845. distance: 1.072010948078987
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.0692, Accuracy: 8818/8991 (98.0759%)
time spent on training: 70.5322790145874
[foolsgold agg] training data poison_ratio: 0.2095798319327731  data num: [555, 577, 554, 549, 646, 593, 608, 621, 641, 606]
[foolsgold agg] considering poison per batch poison_fraction: 0.2095798319327731
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 88: Average loss: 1.0679, Accuracy: 8849/10000 (88.4900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 88: Average loss: 0.0714, Accuracy: 8838/8991 (98.2983%)
Done in 237.07888007164001 sec.
Server Epoch:89 choose agents : [82, 36, 17, 29, 79, 33, 64, 19, 15, 66].
___Train Local_Simple,  epoch  89, local model 82, internal_epoch   1,  Average loss: 0.0062, Accuracy: 563/621 (90.6602%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.1814, Accuracy: 9461/10000 (94.6100%), Attack Success Rate:0/10000(0.000)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  89, local model 36, internal_epoch   1,  Average loss: 0.0014, Accuracy: 509/520 (97.8846%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 36, internal_epoch   2,  Average loss: 0.0002, Accuracy: 518/520 (99.6154%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 36, internal_epoch   3,  Average loss: 0.0003, Accuracy: 516/520 (99.2308%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 36, internal_epoch   4,  Average loss: 0.0001, Accuracy: 519/520 (99.8077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 36, internal_epoch   5,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 36, internal_epoch   6,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 36, internal_epoch   7,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  89, local model 36, internal_epoch   8,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 36, internal_epoch   9,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 36, internal_epoch  10,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Global model norm: 17.13939824404488.
Norm before scaling: 17.092090477316273. Distance: 1.1074410357827615
Total norm for 6 adversaries is: 17.092090477316273. distance: 1.1074410357827615
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.0957, Accuracy: 8749/8991 (97.3084%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  89, local model 17, internal_epoch   1,  Average loss: 0.0006, Accuracy: 639/648 (98.6111%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 17, internal_epoch   2,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 17, internal_epoch   3,  Average loss: 0.0001, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 17, internal_epoch   5,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  89, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 17.13939824404488.
Norm before scaling: 17.078021357187797. Distance: 0.9940147395144494
Total norm for 6 adversaries is: 17.078021357187797. distance: 0.9940147395144494
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.0851, Accuracy: 8788/8991 (97.7422%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  89, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 594/605 (98.1818%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 29, internal_epoch   2,  Average loss: 0.0005, Accuracy: 598/605 (98.8430%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 29, internal_epoch   3,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 29, internal_epoch   5,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 29, internal_epoch   6,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 29, internal_epoch   7,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  89, local model 29, internal_epoch   8,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 17.13939824404488.
Norm before scaling: 17.084747900974243. Distance: 0.9872745618742472
Total norm for 6 adversaries is: 17.084747900974243. distance: 0.9872745618742472
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.0770, Accuracy: 8810/8991 (97.9869%)
___Train Local_Simple,  epoch  89, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 591/635 (93.0709%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.1863, Accuracy: 9487/10000 (94.8700%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  89, local model 33, internal_epoch   1,  Average loss: 0.0006, Accuracy: 632/638 (99.0596%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 632/638 (99.0596%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 33, internal_epoch   3,  Average loss: 0.0002, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 33, internal_epoch   5,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 33, internal_epoch   6,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  89, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 17.13939824404488.
Norm before scaling: 17.07560522925359. Distance: 0.888130509361451
Total norm for 6 adversaries is: 17.07560522925359. distance: 0.888130509361451
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.0593, Accuracy: 8842/8991 (98.3428%)
___Train Local_Simple,  epoch  89, local model 64, internal_epoch   1,  Average loss: 0.0058, Accuracy: 520/566 (91.8728%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.1324, Accuracy: 9618/10000 (96.1800%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  89, local model 19, internal_epoch   1,  Average loss: 0.0007, Accuracy: 547/552 (99.0942%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 19, internal_epoch   2,  Average loss: 0.0003, Accuracy: 548/552 (99.2754%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 19, internal_epoch   3,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 19, internal_epoch   4,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 19, internal_epoch   5,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 19, internal_epoch   6,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 19, internal_epoch   7,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  89, local model 19, internal_epoch   8,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 19, internal_epoch   9,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 19, internal_epoch  10,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Global model norm: 17.13939824404488.
Norm before scaling: 17.0867510594489. Distance: 0.8541150814079524
Total norm for 6 adversaries is: 17.0867510594489. distance: 0.8541150814079524
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.0851, Accuracy: 8790/8991 (97.7644%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  89, local model 15, internal_epoch   1,  Average loss: 0.0011, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 15, internal_epoch   3,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 15, internal_epoch   5,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 15, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 15, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  89, local model 15, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 15, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  89, local model 15, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.13939824404488.
Norm before scaling: 17.071117865727096. Distance: 0.8543165974723514
Total norm for 6 adversaries is: 17.071117865727096. distance: 0.8543165974723514
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.0658, Accuracy: 8837/8991 (98.2872%)
___Train Local_Simple,  epoch  89, local model 66, internal_epoch   1,  Average loss: 0.0067, Accuracy: 569/629 (90.4610%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.2303, Accuracy: 9235/10000 (92.3500%), Attack Success Rate:0/10000(0.000)
time spent on training: 113.56572699546814
[foolsgold agg] training data poison_ratio: 0.5905446040761777  data num: [621, 520, 648, 605, 635, 638, 566, 552, 572, 629]
[foolsgold agg] considering poison per batch poison_fraction: 0.5905446040761777
[foolsgold agg] wv: [0. 1. 1. 1. 0. 1. 0. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 89: Average loss: 1.0859, Accuracy: 8836/10000 (88.3600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 89: Average loss: 0.0701, Accuracy: 8831/8991 (98.2204%)
Done in 281.6111979484558 sec.
Server Epoch:90 choose agents : [76, 67, 89, 86, 25, 4, 77, 85, 94, 91].
___Train Local_Simple,  epoch  90, local model 76, internal_epoch   1,  Average loss: 0.0057, Accuracy: 480/518 (92.6641%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.2752, Accuracy: 9159/10000 (91.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 67, internal_epoch   1,  Average loss: 0.0073, Accuracy: 580/643 (90.2022%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.4621, Accuracy: 8591/10000 (85.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 89, internal_epoch   1,  Average loss: 0.0053, Accuracy: 621/664 (93.5241%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1420, Accuracy: 9597/10000 (95.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 86, internal_epoch   1,  Average loss: 0.0059, Accuracy: 540/587 (91.9932%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.2946, Accuracy: 9046/10000 (90.4600%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  90, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 569/582 (97.7663%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 25, internal_epoch   2,  Average loss: 0.0006, Accuracy: 575/582 (98.7973%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 25, internal_epoch   3,  Average loss: 0.0007, Accuracy: 571/582 (98.1100%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 25, internal_epoch   4,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 25, internal_epoch   5,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 25, internal_epoch   6,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 25, internal_epoch   7,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  90, local model 25, internal_epoch   8,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 25, internal_epoch   9,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 25, internal_epoch  10,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 17.148036192627767.
Norm before scaling: 17.10435678405048. Distance: 1.1435772040908776
Total norm for 2 adversaries is: 17.10435678405048. distance: 1.1435772040908776
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.0623, Accuracy: 8837/8991 (98.2872%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 580/587 (98.8075%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch   2,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch   3,  Average loss: 0.0001, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch   4,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch   5,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch   6,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch   7,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 17.148036192627767.
Norm before scaling: 17.10709709436682. Distance: 0.936847109745297
Total norm for 2 adversaries is: 17.10709709436682. distance: 0.936847109745297
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.0663, Accuracy: 8835/8991 (98.2649%)
___Train Local_Simple,  epoch  90, local model 77, internal_epoch   1,  Average loss: 0.0045, Accuracy: 490/519 (94.4123%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1620, Accuracy: 9512/10000 (95.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 85, internal_epoch   1,  Average loss: 0.0057, Accuracy: 520/570 (91.2281%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1731, Accuracy: 9481/10000 (94.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 94, internal_epoch   1,  Average loss: 0.0056, Accuracy: 509/555 (91.7117%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.3856, Accuracy: 8739/10000 (87.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 91, internal_epoch   1,  Average loss: 0.0039, Accuracy: 595/627 (94.8963%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.2038, Accuracy: 9394/10000 (93.9400%), Attack Success Rate:0/10000(0.000)
time spent on training: 69.77981305122375
[foolsgold agg] training data poison_ratio: 0.19976076555023922  data num: [518, 643, 664, 587, 582, 587, 519, 570, 555, 627]
[foolsgold agg] considering poison per batch poison_fraction: 0.19976076555023922
[foolsgold agg] wv: [0.5096418 0.        0.        0.        1.        1.        0.
 0.        0.        0.       ]
___Test Target_Simple poisoned: False, epoch: 90: Average loss: 1.0232, Accuracy: 8856/10000 (88.5600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 90: Average loss: 0.0648, Accuracy: 8845/8991 (98.3762%)
Done in 236.38907480239868 sec.
Server Epoch:91 choose agents : [20, 58, 95, 86, 54, 98, 80, 19, 94, 33].
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  91, local model 20, internal_epoch   1,  Average loss: 0.0012, Accuracy: 543/553 (98.1917%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 20, internal_epoch   2,  Average loss: 0.0006, Accuracy: 545/553 (98.5533%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 20, internal_epoch   3,  Average loss: 0.0002, Accuracy: 551/553 (99.6383%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  91, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Global model norm: 17.149322834492345.
Norm before scaling: 17.09330813100051. Distance: 0.967979155231305
Total norm for 3 adversaries is: 17.09330813100051. distance: 0.967979155231305
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.0667, Accuracy: 8833/8991 (98.2427%)
___Train Local_Simple,  epoch  91, local model 58, internal_epoch   1,  Average loss: 0.0059, Accuracy: 465/510 (91.1765%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.2006, Accuracy: 9397/10000 (93.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 95, internal_epoch   1,  Average loss: 0.0052, Accuracy: 487/532 (91.5414%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.3345, Accuracy: 8869/10000 (88.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 86, internal_epoch   1,  Average loss: 0.0045, Accuracy: 551/587 (93.8671%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1234, Accuracy: 9665/10000 (96.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 54, internal_epoch   1,  Average loss: 0.0052, Accuracy: 492/523 (94.0727%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1503, Accuracy: 9526/10000 (95.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 98, internal_epoch   1,  Average loss: 0.0031, Accuracy: 544/568 (95.7746%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1378, Accuracy: 9554/10000 (95.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 80, internal_epoch   1,  Average loss: 0.0042, Accuracy: 559/593 (94.2664%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1223, Accuracy: 9636/10000 (96.3600%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  91, local model 19, internal_epoch   1,  Average loss: 0.0007, Accuracy: 545/552 (98.7319%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 19, internal_epoch   2,  Average loss: 0.0003, Accuracy: 549/552 (99.4565%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 19, internal_epoch   3,  Average loss: 0.0001, Accuracy: 551/552 (99.8188%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 19, internal_epoch   4,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 19, internal_epoch   5,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 19, internal_epoch   6,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 19, internal_epoch   7,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  91, local model 19, internal_epoch   8,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 19, internal_epoch   9,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 19, internal_epoch  10,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Global model norm: 17.149322834492345.
Norm before scaling: 17.09516836694335. Distance: 0.8313942920245695
Total norm for 3 adversaries is: 17.09516836694335. distance: 0.8313942920245695
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.0902, Accuracy: 8780/8991 (97.6532%)
___Train Local_Simple,  epoch  91, local model 94, internal_epoch   1,  Average loss: 0.0054, Accuracy: 507/555 (91.3514%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1992, Accuracy: 9348/10000 (93.4800%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  91, local model 33, internal_epoch   1,  Average loss: 0.0006, Accuracy: 630/638 (98.7461%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 634/638 (99.3730%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 33, internal_epoch   3,  Average loss: 0.0001, Accuracy: 636/638 (99.6865%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 33, internal_epoch   5,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 33, internal_epoch   6,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  91, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  91, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 17.149322834492345.
Norm before scaling: 17.078963947543315. Distance: 0.9603401746650739
Total norm for 3 adversaries is: 17.078963947543315. distance: 0.9603401746650739
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.0631, Accuracy: 8827/8991 (98.1760%)
time spent on training: 80.21415400505066
[foolsgold agg] training data poison_ratio: 0.31063981464979507  data num: [553, 510, 532, 587, 523, 568, 593, 552, 555, 638]
[foolsgold agg] considering poison per batch poison_fraction: 0.31063981464979507
[foolsgold agg] wv: [1. 0. 1. 0. 0. 0. 0. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 91: Average loss: 0.9817, Accuracy: 8854/10000 (88.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 91: Average loss: 0.0642, Accuracy: 8842/8991 (98.3428%)
Done in 246.23084998130798 sec.
Server Epoch:92 choose agents : [47, 89, 52, 39, 94, 10, 36, 79, 53, 74].
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  92, local model 47, internal_epoch   1,  Average loss: 0.0010, Accuracy: 592/602 (98.3389%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 47, internal_epoch   2,  Average loss: 0.0010, Accuracy: 592/602 (98.3389%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 47, internal_epoch   3,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 47, internal_epoch   4,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 47, internal_epoch   5,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 47, internal_epoch   6,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 47, internal_epoch   7,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  92, local model 47, internal_epoch   8,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 47, internal_epoch   9,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 47, internal_epoch  10,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 17.149887823066074.
Norm before scaling: 17.090558467197702. Distance: 1.0642272149537513
Total norm for 4 adversaries is: 17.090558467197702. distance: 1.0642272149537513
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.0646, Accuracy: 8824/8991 (98.1426%)
___Train Local_Simple,  epoch  92, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 615/664 (92.6205%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1382, Accuracy: 9610/10000 (96.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 52, internal_epoch   1,  Average loss: 0.0063, Accuracy: 562/618 (90.9385%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1883, Accuracy: 9409/10000 (94.0900%), Attack Success Rate:0/10000(0.000)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  92, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 497/503 (98.8072%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 500/503 (99.4036%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 39, internal_epoch   4,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 39, internal_epoch   5,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  92, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 17.149887823066074.
Norm before scaling: 17.104597649234183. Distance: 0.8438269262214384
Total norm for 4 adversaries is: 17.104597649234183. distance: 0.8438269262214384
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.0715, Accuracy: 8821/8991 (98.1092%)
___Train Local_Simple,  epoch  92, local model 94, internal_epoch   1,  Average loss: 0.0061, Accuracy: 501/555 (90.2703%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1884, Accuracy: 9363/10000 (93.6300%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 10, internal_epoch   2,  Average loss: 0.0004, Accuracy: 567/572 (99.1259%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 10, internal_epoch   3,  Average loss: 0.0003, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 10, internal_epoch   5,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 10, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 10, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  92, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.149887823066074.
Norm before scaling: 17.100300818580283. Distance: 0.9077996126661968
Total norm for 4 adversaries is: 17.100300818580283. distance: 0.9077996126661968
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.0756, Accuracy: 8813/8991 (98.0202%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  92, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 510/520 (98.0769%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 36, internal_epoch   2,  Average loss: 0.0004, Accuracy: 516/520 (99.2308%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 36, internal_epoch   3,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 36, internal_epoch   4,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 36, internal_epoch   5,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 36, internal_epoch   6,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 36, internal_epoch   7,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  92, local model 36, internal_epoch   8,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 36, internal_epoch   9,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  92, local model 36, internal_epoch  10,  Average loss: 0.0000, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Global model norm: 17.149887823066074.
Norm before scaling: 17.098424185261653. Distance: 1.0614015847941303
Total norm for 4 adversaries is: 17.098424185261653. distance: 1.0614015847941303
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.0843, Accuracy: 8766/8991 (97.4975%)
___Train Local_Simple,  epoch  92, local model 79, internal_epoch   1,  Average loss: 0.0033, Accuracy: 605/635 (95.2756%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.2281, Accuracy: 9288/10000 (92.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 53, internal_epoch   1,  Average loss: 0.0036, Accuracy: 584/617 (94.6515%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1706, Accuracy: 9579/10000 (95.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 74, internal_epoch   1,  Average loss: 0.0041, Accuracy: 597/626 (95.3674%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1344, Accuracy: 9590/10000 (95.9000%), Attack Success Rate:0/10000(0.000)
time spent on training: 91.19284391403198
[foolsgold agg] training data poison_ratio: 0.371617050067659  data num: [602, 664, 618, 503, 555, 572, 520, 635, 617, 626]
[foolsgold agg] considering poison per batch poison_fraction: 0.371617050067659
[foolsgold agg] wv: [1. 0. 0. 1. 0. 1. 1. 0. 0. 0.]
___Test Target_Simple poisoned: False, epoch: 92: Average loss: 0.9827, Accuracy: 8854/10000 (88.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 92: Average loss: 0.0644, Accuracy: 8846/8991 (98.3873%)
Done in 257.7033932209015 sec.
Server Epoch:93 choose agents : [6, 10, 27, 69, 28, 15, 13, 81, 44, 66].
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  93, local model 6, internal_epoch   1,  Average loss: 0.0007, Accuracy: 700/708 (98.8701%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 707/708 (99.8588%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 6, internal_epoch   3,  Average loss: 0.0001, Accuracy: 707/708 (99.8588%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 6, internal_epoch   4,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 6, internal_epoch   5,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 6, internal_epoch   6,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 6, internal_epoch   7,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  93, local model 6, internal_epoch   8,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 6, internal_epoch   9,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 6, internal_epoch  10,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 17.15541127418192.
Norm before scaling: 17.093182263195246. Distance: 0.9894566237323407
Total norm for 7 adversaries is: 17.093182263195246. distance: 0.9894566237323407
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.0631, Accuracy: 8838/8991 (98.2983%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  93, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 10, internal_epoch   2,  Average loss: 0.0008, Accuracy: 565/572 (98.7762%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 10, internal_epoch   3,  Average loss: 0.0014, Accuracy: 557/572 (97.3776%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 10, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 10, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  93, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.15541127418192.
Norm before scaling: 17.107515416922304. Distance: 1.0573776974308229
Total norm for 7 adversaries is: 17.107515416922304. distance: 1.0573776974308229
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.0739, Accuracy: 8812/8991 (98.0091%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  93, local model 27, internal_epoch   1,  Average loss: 0.0006, Accuracy: 644/650 (99.0769%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 647/650 (99.5385%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 27, internal_epoch   3,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 27, internal_epoch   4,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 27, internal_epoch   5,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 27, internal_epoch   6,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 27, internal_epoch   7,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  93, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 17.15541127418192.
Norm before scaling: 17.09412580282743. Distance: 0.9280779072023847
Total norm for 7 adversaries is: 17.09412580282743. distance: 0.9280779072023847
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.0672, Accuracy: 8845/8991 (98.3762%)
___Train Local_Simple,  epoch  93, local model 69, internal_epoch   1,  Average loss: 0.0055, Accuracy: 596/646 (92.2601%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1855, Accuracy: 9383/10000 (93.8300%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  93, local model 28, internal_epoch   1,  Average loss: 0.0013, Accuracy: 653/665 (98.1955%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 28, internal_epoch   2,  Average loss: 0.0010, Accuracy: 652/665 (98.0451%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 28, internal_epoch   3,  Average loss: 0.0003, Accuracy: 661/665 (99.3985%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 28, internal_epoch   4,  Average loss: 0.0001, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 28, internal_epoch   5,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 28, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  93, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 17.15541127418192.
Norm before scaling: 17.073611487570975. Distance: 1.1522866445066515
Total norm for 7 adversaries is: 17.073611487570975. distance: 1.1522866445066515
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.0695, Accuracy: 8809/8991 (97.9758%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  93, local model 15, internal_epoch   1,  Average loss: 0.0011, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 15, internal_epoch   2,  Average loss: 0.0004, Accuracy: 568/572 (99.3007%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 15, internal_epoch   3,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 15, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 15, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  93, local model 15, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 15, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 15, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.15541127418192.
Norm before scaling: 17.086413495027177. Distance: 0.905992668711661
Total norm for 7 adversaries is: 17.086413495027177. distance: 0.905992668711661
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.0682, Accuracy: 8823/8991 (98.1315%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 515/521 (98.8484%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 13, internal_epoch   2,  Average loss: 0.0006, Accuracy: 516/521 (99.0403%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 13, internal_epoch   3,  Average loss: 0.0002, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 13, internal_epoch   4,  Average loss: 0.0002, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 13, internal_epoch   6,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 13, internal_epoch   7,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  93, local model 13, internal_epoch   8,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 13, internal_epoch   9,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 13, internal_epoch  10,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 17.15541127418192.
Norm before scaling: 17.10332459372163. Distance: 0.9129172755845403
Total norm for 7 adversaries is: 17.10332459372163. distance: 0.9129172755845403
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.0547, Accuracy: 8850/8991 (98.4318%)
___Train Local_Simple,  epoch  93, local model 81, internal_epoch   1,  Average loss: 0.0039, Accuracy: 547/586 (93.3447%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1951, Accuracy: 9383/10000 (93.8300%), Attack Success Rate:0/10000(0.000)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  93, local model 44, internal_epoch   1,  Average loss: 0.0013, Accuracy: 508/518 (98.0695%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 44, internal_epoch   2,  Average loss: 0.0001, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 44, internal_epoch   3,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 44, internal_epoch   4,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 44, internal_epoch   5,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 44, internal_epoch   6,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 44, internal_epoch   7,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  93, local model 44, internal_epoch   8,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 44, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  93, local model 44, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 17.15541127418192.
Norm before scaling: 17.097528183065034. Distance: 0.9898251321753349
Total norm for 7 adversaries is: 17.097528183065034. distance: 0.9898251321753349
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.0636, Accuracy: 8840/8991 (98.3205%)
___Train Local_Simple,  epoch  93, local model 66, internal_epoch   1,  Average loss: 0.0062, Accuracy: 574/629 (91.2560%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1487, Accuracy: 9545/10000 (95.4500%), Attack Success Rate:0/10000(0.000)
time spent on training: 125.58178496360779
[foolsgold agg] training data poison_ratio: 0.6932586121641668  data num: [708, 572, 650, 646, 665, 572, 521, 586, 518, 629]
[foolsgold agg] considering poison per batch poison_fraction: 0.6932586121641668
[foolsgold agg] wv: [1.         1.         1.         0.         1.         1.
 1.         0.44336289 1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 93: Average loss: 1.0155, Accuracy: 8858/10000 (88.5800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 93: Average loss: 0.0637, Accuracy: 8846/8991 (98.3873%)
Done in 293.56747817993164 sec.
Server Epoch:94 choose agents : [29, 45, 66, 74, 73, 21, 79, 80, 25, 96].
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  94, local model 29, internal_epoch   1,  Average loss: 0.0008, Accuracy: 598/605 (98.8430%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 29, internal_epoch   2,  Average loss: 0.0003, Accuracy: 602/605 (99.5041%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 29, internal_epoch   3,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 29, internal_epoch   4,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 29, internal_epoch   5,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 29, internal_epoch   6,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 29, internal_epoch   7,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  94, local model 29, internal_epoch   8,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 17.16665906196105.
Norm before scaling: 17.116817552198025. Distance: 0.8876482423361731
Total norm for 4 adversaries is: 17.116817552198025. distance: 0.8876482423361731
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.0827, Accuracy: 8814/8991 (98.0314%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  94, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 740/750 (98.6667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 45, internal_epoch   2,  Average loss: 0.0003, Accuracy: 744/750 (99.2000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 45, internal_epoch   3,  Average loss: 0.0001, Accuracy: 748/750 (99.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 45, internal_epoch   4,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 45, internal_epoch   5,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 45, internal_epoch   6,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 45, internal_epoch   7,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  94, local model 45, internal_epoch   8,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 45, internal_epoch   9,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 45, internal_epoch  10,  Average loss: 0.0000, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 17.16665906196105.
Norm before scaling: 17.087018069968718. Distance: 1.1808361499154243
Total norm for 4 adversaries is: 17.087018069968718. distance: 1.1808361499154243
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.0789, Accuracy: 8796/8991 (97.8312%)
___Train Local_Simple,  epoch  94, local model 66, internal_epoch   1,  Average loss: 0.0058, Accuracy: 575/629 (91.4149%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1439, Accuracy: 9577/10000 (95.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 74, internal_epoch   1,  Average loss: 0.0047, Accuracy: 593/626 (94.7284%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1139, Accuracy: 9664/10000 (96.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 73, internal_epoch   1,  Average loss: 0.0060, Accuracy: 575/626 (91.8530%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1769, Accuracy: 9481/10000 (94.8100%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  94, local model 21, internal_epoch   1,  Average loss: 0.0019, Accuracy: 609/625 (97.4400%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 21, internal_epoch   2,  Average loss: 0.0008, Accuracy: 616/625 (98.5600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 21, internal_epoch   3,  Average loss: 0.0003, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 21, internal_epoch   4,  Average loss: 0.0002, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 21, internal_epoch   5,  Average loss: 0.0002, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 21, internal_epoch   6,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  94, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 21, internal_epoch   9,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Global model norm: 17.16665906196105.
Norm before scaling: 17.08286241332002. Distance: 1.2903586604665354
Total norm for 4 adversaries is: 17.08286241332002. distance: 1.2903586604665354
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.0671, Accuracy: 8817/8991 (98.0647%)
___Train Local_Simple,  epoch  94, local model 79, internal_epoch   1,  Average loss: 0.0039, Accuracy: 597/635 (94.0157%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1473, Accuracy: 9547/10000 (95.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 561/593 (94.6037%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1307, Accuracy: 9601/10000 (96.0100%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  94, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 568/582 (97.5945%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 25, internal_epoch   2,  Average loss: 0.0090, Accuracy: 504/582 (86.5979%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 25, internal_epoch   3,  Average loss: 0.0036, Accuracy: 543/582 (93.2990%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 25, internal_epoch   4,  Average loss: 0.0015, Accuracy: 568/582 (97.5945%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 25, internal_epoch   5,  Average loss: 0.0011, Accuracy: 574/582 (98.6254%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 25, internal_epoch   6,  Average loss: 0.0009, Accuracy: 575/582 (98.7973%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 25, internal_epoch   7,  Average loss: 0.0007, Accuracy: 576/582 (98.9691%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  94, local model 25, internal_epoch   8,  Average loss: 0.0006, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 25, internal_epoch   9,  Average loss: 0.0005, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  94, local model 25, internal_epoch  10,  Average loss: 0.0005, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Global model norm: 17.16665906196105.
Norm before scaling: 17.708676658742917. Distance: 4.846409615088944
Total norm for 4 adversaries is: 17.708676658742917. distance: 4.846409615088944
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.0987, Accuracy: 8716/8991 (96.9414%)
___Train Local_Simple,  epoch  94, local model 96, internal_epoch   1,  Average loss: 0.0045, Accuracy: 568/608 (93.4211%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.2300, Accuracy: 9311/10000 (93.1100%), Attack Success Rate:0/10000(0.000)
time spent on training: 94.06136703491211
[foolsgold agg] training data poison_ratio: 0.4080267558528428  data num: [605, 750, 629, 626, 626, 625, 635, 593, 582, 608]
[foolsgold agg] considering poison per batch poison_fraction: 0.4080267558528428
[foolsgold agg] wv: [1. 1. 0. 0. 0. 1. 0. 0. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 94: Average loss: 1.1169, Accuracy: 8862/10000 (88.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 94: Average loss: 0.0668, Accuracy: 8851/8991 (98.4429%)
Done in 262.27935218811035 sec.
Server Epoch:95 choose agents : [59, 53, 27, 94, 48, 51, 20, 52, 93, 89].
___Train Local_Simple,  epoch  95, local model 59, internal_epoch   1,  Average loss: 0.0054, Accuracy: 598/652 (91.7178%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.1970, Accuracy: 9382/10000 (93.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 53, internal_epoch   1,  Average loss: 0.0046, Accuracy: 581/617 (94.1653%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.2369, Accuracy: 9360/10000 (93.6000%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  95, local model 27, internal_epoch   1,  Average loss: 0.0007, Accuracy: 640/650 (98.4615%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 646/650 (99.3846%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 27, internal_epoch   3,  Average loss: 0.0001, Accuracy: 648/650 (99.6923%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 27, internal_epoch   5,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 27, internal_epoch   6,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 27, internal_epoch   7,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  95, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 17.19202799020568.
Norm before scaling: 17.151058669264778. Distance: 1.0835613903227659
Total norm for 3 adversaries is: 17.151058669264778. distance: 1.0835613903227659
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.0795, Accuracy: 8813/8991 (98.0202%)
___Train Local_Simple,  epoch  95, local model 94, internal_epoch   1,  Average loss: 0.0057, Accuracy: 516/555 (92.9730%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.2182, Accuracy: 9311/10000 (93.1100%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  95, local model 48, internal_epoch   1,  Average loss: 0.0010, Accuracy: 579/589 (98.3022%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 48, internal_epoch   3,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 48, internal_epoch   4,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 48, internal_epoch   5,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 48, internal_epoch   6,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  95, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 17.19202799020568.
Norm before scaling: 17.135599016728577. Distance: 1.0622347893419295
Total norm for 3 adversaries is: 17.135599016728577. distance: 1.0622347893419295
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.0708, Accuracy: 8812/8991 (98.0091%)
___Train Local_Simple,  epoch  95, local model 51, internal_epoch   1,  Average loss: 0.0052, Accuracy: 600/647 (92.7357%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.1316, Accuracy: 9596/10000 (95.9600%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  95, local model 20, internal_epoch   1,  Average loss: 0.0013, Accuracy: 541/553 (97.8300%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 20, internal_epoch   2,  Average loss: 0.0006, Accuracy: 546/553 (98.7342%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 20, internal_epoch   3,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  95, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  95, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Global model norm: 17.19202799020568.
Norm before scaling: 17.134244553693673. Distance: 1.0070925958028865
Total norm for 3 adversaries is: 17.134244553693673. distance: 1.0070925958028865
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.0694, Accuracy: 8837/8991 (98.2872%)
___Train Local_Simple,  epoch  95, local model 52, internal_epoch   1,  Average loss: 0.0049, Accuracy: 574/618 (92.8803%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.2505, Accuracy: 9210/10000 (92.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 93, internal_epoch   1,  Average loss: 0.0056, Accuracy: 490/529 (92.6276%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.1671, Accuracy: 9463/10000 (94.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 89, internal_epoch   1,  Average loss: 0.0043, Accuracy: 621/664 (93.5241%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.2146, Accuracy: 9341/10000 (93.4100%), Attack Success Rate:0/10000(0.000)
time spent on training: 81.35284996032715
[foolsgold agg] training data poison_ratio: 0.2950279881461969  data num: [652, 617, 650, 555, 589, 647, 553, 618, 529, 664]
[foolsgold agg] considering poison per batch poison_fraction: 0.2950279881461969
[foolsgold agg] wv: [0. 0. 1. 0. 1. 0. 1. 0. 0. 0.]
___Test Target_Simple poisoned: False, epoch: 95: Average loss: 1.1366, Accuracy: 8862/10000 (88.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 95: Average loss: 0.0662, Accuracy: 8851/8991 (98.4429%)
Done in 248.1620490550995 sec.
Server Epoch:96 choose agents : [46, 20, 0, 79, 78, 82, 87, 33, 62, 76].
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  96, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 471/478 (98.5356%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 46, internal_epoch   2,  Average loss: 0.0003, Accuracy: 476/478 (99.5816%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 46, internal_epoch   3,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 46, internal_epoch   4,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 46, internal_epoch   5,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 46, internal_epoch   6,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 46, internal_epoch   7,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  96, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 17.19760090264455.
Norm before scaling: 17.175802127147875. Distance: 0.9406532663552936
Total norm for 3 adversaries is: 17.175802127147875. distance: 0.9406532663552936
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.0788, Accuracy: 8801/8991 (97.8868%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  96, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 546/553 (98.7342%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 547/553 (98.9150%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 20, internal_epoch   3,  Average loss: 0.0001, Accuracy: 551/553 (99.6383%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  96, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Global model norm: 17.19760090264455.
Norm before scaling: 17.143222441641296. Distance: 0.883098015990527
Total norm for 3 adversaries is: 17.143222441641296. distance: 0.883098015990527
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.0695, Accuracy: 8834/8991 (98.2538%)
___Train Local_Simple,  epoch  96, local model 0, internal_epoch   1,  Average loss: 0.0054, Accuracy: 555/609 (91.1330%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.1646, Accuracy: 9482/10000 (94.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 79, internal_epoch   1,  Average loss: 0.0038, Accuracy: 600/635 (94.4882%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.1982, Accuracy: 9340/10000 (93.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 78, internal_epoch   1,  Average loss: 0.0036, Accuracy: 595/624 (95.3526%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.1576, Accuracy: 9524/10000 (95.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 82, internal_epoch   1,  Average loss: 0.0050, Accuracy: 582/621 (93.7198%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.2142, Accuracy: 9282/10000 (92.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 87, internal_epoch   1,  Average loss: 0.0057, Accuracy: 529/575 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.2425, Accuracy: 9275/10000 (92.7500%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  96, local model 33, internal_epoch   1,  Average loss: 0.0007, Accuracy: 630/638 (98.7461%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 33, internal_epoch   2,  Average loss: 0.0003, Accuracy: 634/638 (99.3730%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 33, internal_epoch   3,  Average loss: 0.0003, Accuracy: 635/638 (99.5298%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 636/638 (99.6865%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 33, internal_epoch   5,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 33, internal_epoch   6,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  96, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  96, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 17.19760090264455.
Norm before scaling: 17.14098019088456. Distance: 0.955407146423616
Total norm for 3 adversaries is: 17.14098019088456. distance: 0.955407146423616
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.0626, Accuracy: 8831/8991 (98.2204%)
___Train Local_Simple,  epoch  96, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 572/617 (92.7066%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.1764, Accuracy: 9439/10000 (94.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 76, internal_epoch   1,  Average loss: 0.0061, Accuracy: 478/518 (92.2780%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.2121, Accuracy: 9293/10000 (92.9300%), Attack Success Rate:0/10000(0.000)
time spent on training: 79.92859101295471
[foolsgold agg] training data poison_ratio: 0.2844239945466939  data num: [478, 553, 609, 635, 624, 621, 575, 638, 617, 518]
[foolsgold agg] considering poison per batch poison_fraction: 0.2844239945466939
[foolsgold agg] wv: [1.        1.        0.        0.        0.        0.        0.
 1.        0.3410236 0.       ]
___Test Target_Simple poisoned: False, epoch: 96: Average loss: 1.1120, Accuracy: 8867/10000 (88.6700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 96: Average loss: 0.0631, Accuracy: 8858/8991 (98.5207%)
Done in 246.8753912448883 sec.
Server Epoch:97 choose agents : [56, 34, 5, 20, 94, 22, 14, 63, 4, 67].
___Train Local_Simple,  epoch  97, local model 56, internal_epoch   1,  Average loss: 0.0055, Accuracy: 575/626 (91.8530%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.1712, Accuracy: 9471/10000 (94.7100%), Attack Success Rate:0/10000(0.000)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  97, local model 34, internal_epoch   1,  Average loss: 0.0020, Accuracy: 518/528 (98.1061%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 34, internal_epoch   2,  Average loss: 0.0014, Accuracy: 513/528 (97.1591%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 34, internal_epoch   3,  Average loss: 0.0004, Accuracy: 524/528 (99.2424%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 34, internal_epoch   4,  Average loss: 0.0002, Accuracy: 526/528 (99.6212%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 34, internal_epoch   5,  Average loss: 0.0002, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 34, internal_epoch   6,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 34, internal_epoch   7,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  97, local model 34, internal_epoch   8,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 34, internal_epoch   9,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 34, internal_epoch  10,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Global model norm: 17.200766364478955.
Norm before scaling: 17.1505506599483. Distance: 1.4157080585963628
Total norm for 6 adversaries is: 17.1505506599483. distance: 1.4157080585963628
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.0771, Accuracy: 8791/8991 (97.7756%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch   1,  Average loss: 0.0008, Accuracy: 504/512 (98.4375%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch   2,  Average loss: 0.0007, Accuracy: 509/512 (99.4141%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch   3,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch   5,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch   6,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch   7,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch   8,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Global model norm: 17.200766364478955.
Norm before scaling: 17.14593785170275. Distance: 0.9561981623443039
Total norm for 6 adversaries is: 17.14593785170275. distance: 0.9561981623443039
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.0868, Accuracy: 8779/8991 (97.6421%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  97, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 545/553 (98.5533%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 548/553 (99.0958%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 20, internal_epoch   3,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 20, internal_epoch   5,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  97, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Global model norm: 17.200766364478955.
Norm before scaling: 17.15138072692236. Distance: 0.9285879926199748
Total norm for 6 adversaries is: 17.15138072692236. distance: 0.9285879926199748
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.0754, Accuracy: 8808/8991 (97.9646%)
___Train Local_Simple,  epoch  97, local model 94, internal_epoch   1,  Average loss: 0.0076, Accuracy: 493/555 (88.8288%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.1730, Accuracy: 9485/10000 (94.8500%), Attack Success Rate:0/10000(0.000)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  97, local model 22, internal_epoch   1,  Average loss: 0.0011, Accuracy: 521/531 (98.1168%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 22, internal_epoch   2,  Average loss: 0.0007, Accuracy: 522/531 (98.3051%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 22, internal_epoch   3,  Average loss: 0.0011, Accuracy: 524/531 (98.6817%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 22, internal_epoch   4,  Average loss: 0.0003, Accuracy: 528/531 (99.4350%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 22, internal_epoch   5,  Average loss: 0.0002, Accuracy: 530/531 (99.8117%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 22, internal_epoch   6,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 22, internal_epoch   7,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  97, local model 22, internal_epoch   8,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 22, internal_epoch   9,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 22, internal_epoch  10,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Global model norm: 17.200766364478955.
Norm before scaling: 17.166376401552125. Distance: 1.171007572843463
Total norm for 6 adversaries is: 17.166376401552125. distance: 1.171007572843463
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.0794, Accuracy: 8812/8991 (98.0091%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 529/535 (98.8785%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 532/535 (99.4393%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 14, internal_epoch   5,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 14, internal_epoch   6,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  97, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 17.200766364478955.
Norm before scaling: 17.14165850490635. Distance: 0.8768316579862057
Total norm for 6 adversaries is: 17.14165850490635. distance: 0.8768316579862057
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.0705, Accuracy: 8798/8991 (97.8534%)
___Train Local_Simple,  epoch  97, local model 63, internal_epoch   1,  Average loss: 0.0044, Accuracy: 576/616 (93.5065%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.1982, Accuracy: 9410/10000 (94.1000%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 582/587 (99.1482%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch   2,  Average loss: 0.0003, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch   3,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch   4,  Average loss: 0.0001, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch   5,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch   6,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch   7,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 17.200766364478955.
Norm before scaling: 17.150604931363755. Distance: 0.9157655614561195
Total norm for 6 adversaries is: 17.150604931363755. distance: 0.9157655614561195
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.0664, Accuracy: 8825/8991 (98.1537%)
___Train Local_Simple,  epoch  97, local model 67, internal_epoch   1,  Average loss: 0.0067, Accuracy: 589/643 (91.6019%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.2966, Accuracy: 9053/10000 (90.5300%), Attack Success Rate:0/10000(0.000)
time spent on training: 110.79016518592834
[foolsgold agg] training data poison_ratio: 0.5708758353851565  data num: [626, 528, 512, 553, 555, 531, 535, 616, 587, 643]
[foolsgold agg] considering poison per batch poison_fraction: 0.5708758353851565
[foolsgold agg] wv: [0. 1. 1. 1. 0. 1. 1. 0. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 97: Average loss: 1.0827, Accuracy: 8857/10000 (88.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 97: Average loss: 0.0642, Accuracy: 8852/8991 (98.4540%)
Done in 277.15144205093384 sec.
Server Epoch:98 choose agents : [91, 64, 77, 14, 67, 90, 75, 97, 92, 40].
___Train Local_Simple,  epoch  98, local model 91, internal_epoch   1,  Average loss: 0.0048, Accuracy: 583/627 (92.9825%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.1532, Accuracy: 9534/10000 (95.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 64, internal_epoch   1,  Average loss: 0.0048, Accuracy: 527/566 (93.1095%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.1483, Accuracy: 9562/10000 (95.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 77, internal_epoch   1,  Average loss: 0.0037, Accuracy: 493/519 (94.9904%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.1524, Accuracy: 9538/10000 (95.3800%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 527/535 (98.5047%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 529/535 (98.8785%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 14, internal_epoch   6,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  98, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 17.209847864678835.
Norm before scaling: 17.161775849048045. Distance: 1.1415377061408531
Total norm for 2 adversaries is: 17.161775849048045. distance: 1.1415377061408531
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.0709, Accuracy: 8806/8991 (97.9424%)
___Train Local_Simple,  epoch  98, local model 67, internal_epoch   1,  Average loss: 0.0070, Accuracy: 559/643 (86.9362%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.3226, Accuracy: 8965/10000 (89.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 90, internal_epoch   1,  Average loss: 0.0062, Accuracy: 521/577 (90.2946%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.3218, Accuracy: 9116/10000 (91.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 75, internal_epoch   1,  Average loss: 0.0056, Accuracy: 506/554 (91.3357%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.1478, Accuracy: 9577/10000 (95.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 97, internal_epoch   1,  Average loss: 0.0072, Accuracy: 529/588 (89.9660%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.3186, Accuracy: 8912/10000 (89.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 92, internal_epoch   1,  Average loss: 0.0037, Accuracy: 540/571 (94.5709%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.1805, Accuracy: 9415/10000 (94.1500%), Attack Success Rate:0/10000(0.000)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  98, local model 40, internal_epoch   1,  Average loss: 0.0009, Accuracy: 553/563 (98.2238%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 40, internal_epoch   2,  Average loss: 0.0005, Accuracy: 558/563 (99.1119%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 40, internal_epoch   3,  Average loss: 0.0002, Accuracy: 561/563 (99.6448%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 40, internal_epoch   6,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  98, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  98, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 17.209847864678835.
Norm before scaling: 17.162571588354428. Distance: 1.0213173607564137
Total norm for 2 adversaries is: 17.162571588354428. distance: 1.0213173607564137
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.0684, Accuracy: 8835/8991 (98.2649%)
time spent on training: 70.24255204200745
[foolsgold agg] training data poison_ratio: 0.19118927389865925  data num: [627, 566, 519, 535, 643, 577, 554, 588, 571, 563]
[foolsgold agg] considering poison per batch poison_fraction: 0.19118927389865925
[foolsgold agg] wv: [0.         0.         0.         1.         0.         0.
 0.         0.         0.22140272 1.        ]
___Test Target_Simple poisoned: False, epoch: 98: Average loss: 1.1078, Accuracy: 8862/10000 (88.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 98: Average loss: 0.0632, Accuracy: 8851/8991 (98.4429%)
Done in 235.687194108963 sec.
Server Epoch:99 choose agents : [76, 6, 8, 88, 2, 82, 12, 27, 61, 21].
___Train Local_Simple,  epoch  99, local model 76, internal_epoch   1,  Average loss: 0.0059, Accuracy: 479/518 (92.4710%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.1356, Accuracy: 9588/10000 (95.8800%), Attack Success Rate:0/10000(0.000)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 697/708 (98.4463%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 6, internal_epoch   2,  Average loss: 0.0002, Accuracy: 705/708 (99.5763%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 6, internal_epoch   3,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 6, internal_epoch   4,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 6, internal_epoch   5,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 6, internal_epoch   6,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 6, internal_epoch   7,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  99, local model 6, internal_epoch   8,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 6, internal_epoch   9,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 6, internal_epoch  10,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 17.212017314628245.
Norm before scaling: 17.157178509710228. Distance: 1.1725321135362838
Total norm for 6 adversaries is: 17.157178509710228. distance: 1.1725321135362838
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.0622, Accuracy: 8834/8991 (98.2538%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  99, local model 8, internal_epoch   1,  Average loss: 0.0013, Accuracy: 670/683 (98.0966%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 8, internal_epoch   2,  Average loss: 0.0009, Accuracy: 675/683 (98.8287%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 8, internal_epoch   3,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 8, internal_epoch   4,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 8, internal_epoch   5,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 8, internal_epoch   6,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 8, internal_epoch   7,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  99, local model 8, internal_epoch   8,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 8, internal_epoch   9,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 8, internal_epoch  10,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Global model norm: 17.212017314628245.
Norm before scaling: 17.125487383290274. Distance: 1.2672769103392292
Total norm for 6 adversaries is: 17.125487383290274. distance: 1.2672769103392292
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.0637, Accuracy: 8834/8991 (98.2538%)
___Train Local_Simple,  epoch  99, local model 88, internal_epoch   1,  Average loss: 0.0040, Accuracy: 633/679 (93.2253%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.1586, Accuracy: 9495/10000 (94.9500%), Attack Success Rate:0/10000(0.000)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 569/580 (98.1034%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch   2,  Average loss: 0.0003, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch   3,  Average loss: 0.0004, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch   4,  Average loss: 0.0001, Accuracy: 578/580 (99.6552%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch   5,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch   6,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch   7,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch   8,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch   9,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch  10,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Global model norm: 17.212017314628245.
Norm before scaling: 17.142528167474488. Distance: 1.1604668301070422
Total norm for 6 adversaries is: 17.142528167474488. distance: 1.1604668301070422
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.0711, Accuracy: 8827/8991 (98.1760%)
___Train Local_Simple,  epoch  99, local model 82, internal_epoch   1,  Average loss: 0.0056, Accuracy: 571/621 (91.9485%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.1650, Accuracy: 9470/10000 (94.7000%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  99, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 582/597 (97.4874%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 12, internal_epoch   2,  Average loss: 0.0006, Accuracy: 586/597 (98.1575%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 12, internal_epoch   3,  Average loss: 0.0002, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 12, internal_epoch   4,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 12, internal_epoch   5,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 12, internal_epoch   6,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 12, internal_epoch   7,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  99, local model 12, internal_epoch   8,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 12, internal_epoch   9,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 12, internal_epoch  10,  Average loss: 0.0000, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Global model norm: 17.212017314628245.
Norm before scaling: 17.18400976636101. Distance: 1.4352352712407386
Total norm for 6 adversaries is: 17.18400976636101. distance: 1.4352352712407386
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.0535, Accuracy: 8847/8991 (98.3984%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  99, local model 27, internal_epoch   1,  Average loss: 0.0006, Accuracy: 643/650 (98.9231%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 27, internal_epoch   2,  Average loss: 0.0002, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 27, internal_epoch   3,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 27, internal_epoch   4,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 27, internal_epoch   5,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 27, internal_epoch   6,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 27, internal_epoch   7,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  99, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 17.212017314628245.
Norm before scaling: 17.147211302971396. Distance: 0.8978661420433798
Total norm for 6 adversaries is: 17.147211302971396. distance: 0.8978661420433798
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.0663, Accuracy: 8839/8991 (98.3094%)
___Train Local_Simple,  epoch  99, local model 61, internal_epoch   1,  Average loss: 0.0056, Accuracy: 493/537 (91.8063%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.1416, Accuracy: 9551/10000 (95.5100%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  99, local model 21, internal_epoch   1,  Average loss: 0.0019, Accuracy: 610/625 (97.6000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 21, internal_epoch   2,  Average loss: 0.0007, Accuracy: 616/625 (98.5600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 21, internal_epoch   3,  Average loss: 0.0003, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 21, internal_epoch   4,  Average loss: 0.0002, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 21, internal_epoch   5,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 21, internal_epoch   6,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  99, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 21, internal_epoch   9,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  99, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Global model norm: 17.212017314628245.
Norm before scaling: 17.128643010377473. Distance: 1.236225238393924
Total norm for 6 adversaries is: 17.128643010377473. distance: 1.236225238393924
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.0640, Accuracy: 8835/8991 (98.2649%)
time spent on training: 117.41766285896301
[foolsgold agg] training data poison_ratio: 0.6200387221684415  data num: [518, 708, 683, 679, 580, 621, 597, 650, 537, 625]
[foolsgold agg] considering poison per batch poison_fraction: 0.6200387221684415
[foolsgold agg] wv: [0. 1. 1. 0. 1. 0. 1. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 99: Average loss: 1.1637, Accuracy: 8857/10000 (88.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 99: Average loss: 0.0630, Accuracy: 8847/8991 (98.3984%)
Done in 282.90292024612427 sec.
Server Epoch:100 choose agents : [35, 57, 43, 34, 76, 26, 92, 3, 13, 16].
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch 100, local model 35, internal_epoch   1,  Average loss: 0.0007, Accuracy: 487/493 (98.7830%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 35, internal_epoch   2,  Average loss: 0.0004, Accuracy: 489/493 (99.1886%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 35, internal_epoch   3,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 35, internal_epoch   4,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 35, internal_epoch   5,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch 100, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 17.222884386247017.
Norm before scaling: 17.18818890664822. Distance: 0.8704898605566872
Total norm for 7 adversaries is: 17.18818890664822. distance: 0.8704898605566872
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.0948, Accuracy: 8804/8991 (97.9201%)
___Train Local_Simple,  epoch 100, local model 57, internal_epoch   1,  Average loss: 0.0050, Accuracy: 533/568 (93.8380%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.1555, Accuracy: 9602/10000 (96.0200%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch 100, local model 43, internal_epoch   1,  Average loss: 0.0015, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 498/518 (96.1390%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 43, internal_epoch   3,  Average loss: 0.0012, Accuracy: 508/518 (98.0695%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 43, internal_epoch   4,  Average loss: 0.0007, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 43, internal_epoch   5,  Average loss: 0.0004, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 43, internal_epoch   6,  Average loss: 0.0002, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 43, internal_epoch   7,  Average loss: 0.0002, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch 100, local model 43, internal_epoch   8,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 43, internal_epoch   9,  Average loss: 0.0002, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 43, internal_epoch  10,  Average loss: 0.0002, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 17.222884386247017.
Norm before scaling: 17.468801535869865. Distance: 3.18030379037863
Total norm for 7 adversaries is: 17.468801535869865. distance: 3.18030379037863
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.1033, Accuracy: 8733/8991 (97.1305%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch 100, local model 34, internal_epoch   1,  Average loss: 0.0027, Accuracy: 519/528 (98.2955%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 34, internal_epoch   2,  Average loss: 0.0020, Accuracy: 508/528 (96.2121%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 34, internal_epoch   3,  Average loss: 0.0016, Accuracy: 515/528 (97.5379%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 34, internal_epoch   4,  Average loss: 0.0005, Accuracy: 523/528 (99.0530%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 34, internal_epoch   5,  Average loss: 0.0002, Accuracy: 527/528 (99.8106%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 34, internal_epoch   6,  Average loss: 0.0001, Accuracy: 527/528 (99.8106%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 34, internal_epoch   7,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch 100, local model 34, internal_epoch   8,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 34, internal_epoch   9,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 34, internal_epoch  10,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Global model norm: 17.222884386247017.
Norm before scaling: 17.19517406804795. Distance: 1.651501885260887
Total norm for 7 adversaries is: 17.19517406804795. distance: 1.651501885260887
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.0607, Accuracy: 8819/8991 (98.0870%)
___Train Local_Simple,  epoch 100, local model 76, internal_epoch   1,  Average loss: 0.0071, Accuracy: 479/518 (92.4710%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.6117, Accuracy: 8306/10000 (83.0600%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch 100, local model 26, internal_epoch   1,  Average loss: 0.0009, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 26, internal_epoch   2,  Average loss: 0.0014, Accuracy: 514/526 (97.7186%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 26, internal_epoch   3,  Average loss: 0.0004, Accuracy: 517/526 (98.2890%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 26, internal_epoch   4,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch 100, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 17.222884386247017.
Norm before scaling: 17.18803177444401. Distance: 1.2780726041989963
Total norm for 7 adversaries is: 17.18803177444401. distance: 1.2780726041989963
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.0630, Accuracy: 8851/8991 (98.4429%)
___Train Local_Simple,  epoch 100, local model 92, internal_epoch   1,  Average loss: 0.0041, Accuracy: 542/571 (94.9212%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.1854, Accuracy: 9389/10000 (93.8900%), Attack Success Rate:0/10000(0.000)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch   1,  Average loss: 0.0003, Accuracy: 502/505 (99.4059%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch   2,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch   3,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch   4,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch   5,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch   6,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch   7,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch   8,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch   9,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch  10,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Global model norm: 17.222884386247017.
Norm before scaling: 17.183748702841935. Distance: 0.6077699553204026
Total norm for 7 adversaries is: 17.183748702841935. distance: 0.6077699553204026
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.0588, Accuracy: 8861/8991 (98.5541%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 512/521 (98.2726%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 13, internal_epoch   3,  Average loss: 0.0002, Accuracy: 519/521 (99.6161%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 13, internal_epoch   4,  Average loss: 0.0001, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 13, internal_epoch   5,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 13, internal_epoch   6,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 13, internal_epoch   7,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch 100, local model 13, internal_epoch   8,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 13, internal_epoch   9,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 13, internal_epoch  10,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 17.222884386247017.
Norm before scaling: 17.174793776338788. Distance: 0.9989306872019248
Total norm for 7 adversaries is: 17.174793776338788. distance: 0.9989306872019248
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.0746, Accuracy: 8804/8991 (97.9201%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch 100, local model 16, internal_epoch   1,  Average loss: 0.0008, Accuracy: 570/581 (98.1067%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 16, internal_epoch   2,  Average loss: 0.0002, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 16, internal_epoch   3,  Average loss: 0.0001, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 16, internal_epoch   4,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 16, internal_epoch   5,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 16, internal_epoch   6,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 16, internal_epoch   7,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch 100, local model 16, internal_epoch   8,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 16, internal_epoch   9,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch 100, local model 16, internal_epoch  10,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 17.222884386247017.
Norm before scaling: 17.17766053583476. Distance: 1.00474323456274
Total norm for 7 adversaries is: 17.17766053583476. distance: 1.00474323456274
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.0766, Accuracy: 8818/8991 (98.0759%)
time spent on training: 119.50340294837952
[foolsgold agg] training data poison_ratio: 0.689059861137174  data num: [493, 568, 518, 528, 518, 526, 571, 505, 521, 581]
[foolsgold agg] considering poison per batch poison_fraction: 0.689059861137174
[foolsgold agg] wv: [1. 0. 1. 1. 0. 1. 0. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 100: Average loss: 1.2035, Accuracy: 8862/10000 (88.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 100: Average loss: 0.0642, Accuracy: 8849/8991 (98.4206%)
Done in 285.6288299560547 sec.
Saving all the graphs.
This run has a label: Mar.03_21.01.59. Visdom environment: mnist_DBA
