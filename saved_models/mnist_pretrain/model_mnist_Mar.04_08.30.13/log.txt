current path: saved_models/mnist_pretrain/model_mnist_Mar.04_08.30.13
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   1,  Average loss: 0.0369, Accuracy: 136/602 (22.5914%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   2,  Average loss: 0.0305, Accuracy: 229/602 (38.0399%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   3,  Average loss: 0.0170, Accuracy: 445/602 (73.9203%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   4,  Average loss: 0.0134, Accuracy: 457/602 (75.9136%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   5,  Average loss: 0.0102, Accuracy: 504/602 (83.7209%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   6,  Average loss: 0.0083, Accuracy: 510/602 (84.7176%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   7,  Average loss: 0.0076, Accuracy: 526/602 (87.3754%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   8,  Average loss: 0.0079, Accuracy: 522/602 (86.7110%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   9,  Average loss: 0.0068, Accuracy: 517/602 (85.8804%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch  10,  Average loss: 0.0057, Accuracy: 542/602 (90.0332%), train_poison_data_count: 602
Global model norm: 13.89800383141575.
Norm before scaling: 14.31255810321858. Distance: 2.912374298919498
Total norm for 7 adversaries is: 14.31255810321858. distance: 2.912374298919498
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.3834, Accuracy: 7969/8991 (88.6331%)
___Train Local_Simple,  epoch   1, local model 72, internal_epoch   1,  Average loss: 0.0374, Accuracy: 92/605 (15.2066%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1170, Accuracy: 1282/10000 (12.8200%), Attack Success Rate:22/10000(0.220)
___Train Local_Simple,  epoch   1, local model 61, internal_epoch   1,  Average loss: 0.0389, Accuracy: 77/585 (13.1624%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1484, Accuracy: 3078/10000 (30.7800%), Attack Success Rate:1/10000(0.010)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0369, Accuracy: 112/577 (19.4107%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   2,  Average loss: 0.0394, Accuracy: 178/577 (30.8492%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   3,  Average loss: 0.0360, Accuracy: 198/577 (34.3154%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   4,  Average loss: 0.0351, Accuracy: 196/577 (33.9688%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   5,  Average loss: 0.0304, Accuracy: 281/577 (48.7002%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   6,  Average loss: 0.0250, Accuracy: 347/577 (60.1386%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   7,  Average loss: 0.0175, Accuracy: 399/577 (69.1508%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   8,  Average loss: 0.0164, Accuracy: 438/577 (75.9099%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   9,  Average loss: 0.0138, Accuracy: 431/577 (74.6967%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch  10,  Average loss: 0.0132, Accuracy: 463/577 (80.2426%), train_poison_data_count: 577
Global model norm: 13.89800383141575.
Norm before scaling: 14.243936955428945. Distance: 2.8350692554875345
Total norm for 7 adversaries is: 14.243936955428945. distance: 2.8350692554875345
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.6040, Accuracy: 7441/8991 (82.7605%)
___Train Local_Simple,  epoch   1, local model 71, internal_epoch   1,  Average loss: 0.0356, Accuracy: 118/637 (18.5243%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.1304, Accuracy: 3768/10000 (37.6800%), Attack Success Rate:0/10000(0.000)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   1,  Average loss: 0.0376, Accuracy: 138/646 (21.3622%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   2,  Average loss: 0.0312, Accuracy: 198/646 (30.6502%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   3,  Average loss: 0.0229, Accuracy: 388/646 (60.0619%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   4,  Average loss: 0.0173, Accuracy: 481/646 (74.4582%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   5,  Average loss: 0.0115, Accuracy: 514/646 (79.5666%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   6,  Average loss: 0.0091, Accuracy: 533/646 (82.5077%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   7,  Average loss: 0.0072, Accuracy: 550/646 (85.1393%), train_poison_data_count: 646
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   8,  Average loss: 0.0064, Accuracy: 567/646 (87.7709%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   9,  Average loss: 0.0054, Accuracy: 582/646 (90.0929%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch  10,  Average loss: 0.0053, Accuracy: 584/646 (90.4025%), train_poison_data_count: 646
Global model norm: 13.89800383141575.
Norm before scaling: 14.349190272437305. Distance: 3.1267801936292967
Total norm for 7 adversaries is: 14.349190272437305. distance: 3.1267801936292967
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.3850, Accuracy: 7982/8991 (88.7777%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   1,  Average loss: 0.0350, Accuracy: 119/571 (20.8406%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   2,  Average loss: 0.0310, Accuracy: 165/571 (28.8967%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   3,  Average loss: 0.0208, Accuracy: 361/571 (63.2224%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   4,  Average loss: 0.0157, Accuracy: 452/571 (79.1594%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   5,  Average loss: 0.0112, Accuracy: 470/571 (82.3117%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   6,  Average loss: 0.0087, Accuracy: 472/571 (82.6620%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   7,  Average loss: 0.0075, Accuracy: 493/571 (86.3398%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   8,  Average loss: 0.0067, Accuracy: 506/571 (88.6165%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   9,  Average loss: 0.0057, Accuracy: 513/571 (89.8424%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch  10,  Average loss: 0.0055, Accuracy: 512/571 (89.6673%), train_poison_data_count: 571
Global model norm: 13.89800383141575.
Norm before scaling: 14.291852558732437. Distance: 2.792166726793442
Total norm for 7 adversaries is: 14.291852558732437. distance: 2.792166726793442
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4710, Accuracy: 7766/8991 (86.3753%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   1,  Average loss: 0.0370, Accuracy: 117/601 (19.4676%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   2,  Average loss: 0.0300, Accuracy: 229/601 (38.1032%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   3,  Average loss: 0.0192, Accuracy: 383/601 (63.7271%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   4,  Average loss: 0.0144, Accuracy: 441/601 (73.3777%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   5,  Average loss: 0.0112, Accuracy: 471/601 (78.3694%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   6,  Average loss: 0.0090, Accuracy: 508/601 (84.5258%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   7,  Average loss: 0.0073, Accuracy: 519/601 (86.3561%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   8,  Average loss: 0.0067, Accuracy: 521/601 (86.6889%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   9,  Average loss: 0.0060, Accuracy: 526/601 (87.5208%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch  10,  Average loss: 0.0055, Accuracy: 536/601 (89.1847%), train_poison_data_count: 601
Global model norm: 13.89800383141575.
Norm before scaling: 14.325229630951547. Distance: 2.9553908279073196
Total norm for 7 adversaries is: 14.325229630951547. distance: 2.9553908279073196
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.3952, Accuracy: 7900/8991 (87.8656%)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   1,  Average loss: 0.0376, Accuracy: 106/590 (17.9661%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   2,  Average loss: 0.0316, Accuracy: 177/590 (30.0000%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   3,  Average loss: 0.0221, Accuracy: 351/590 (59.4915%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   4,  Average loss: 0.0158, Accuracy: 457/590 (77.4576%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   5,  Average loss: 0.0113, Accuracy: 463/590 (78.4746%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   6,  Average loss: 0.0094, Accuracy: 487/590 (82.5424%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   7,  Average loss: 0.0096, Accuracy: 479/590 (81.1864%), train_poison_data_count: 590
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   8,  Average loss: 0.0080, Accuracy: 498/590 (84.4068%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   9,  Average loss: 0.0077, Accuracy: 518/590 (87.7966%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch  10,  Average loss: 0.0064, Accuracy: 522/590 (88.4746%), train_poison_data_count: 590
Global model norm: 13.89800383141575.
Norm before scaling: 14.30525870565584. Distance: 2.890412688835244
Total norm for 7 adversaries is: 14.30525870565584. distance: 2.890412688835244
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.3819, Accuracy: 8029/8991 (89.3004%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   1,  Average loss: 0.0392, Accuracy: 113/577 (19.5841%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   2,  Average loss: 0.0389, Accuracy: 67/577 (11.6118%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   3,  Average loss: 0.0377, Accuracy: 113/577 (19.5841%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   4,  Average loss: 0.0367, Accuracy: 113/577 (19.5841%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   5,  Average loss: 0.0338, Accuracy: 129/577 (22.3570%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   6,  Average loss: 0.0318, Accuracy: 154/577 (26.6898%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   7,  Average loss: 0.0270, Accuracy: 311/577 (53.8995%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   8,  Average loss: 0.0197, Accuracy: 406/577 (70.3640%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   9,  Average loss: 0.0163, Accuracy: 424/577 (73.4835%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch  10,  Average loss: 0.0142, Accuracy: 471/577 (81.6291%), train_poison_data_count: 577
Global model norm: 13.89800383141575.
Norm before scaling: 14.201535982687863. Distance: 2.815059006311394
Total norm for 7 adversaries is: 14.201535982687863. distance: 2.815059006311394
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.8551, Accuracy: 7138/8991 (79.3905%)
time spent on training: 114.84624195098877
[foolsgold agg] training data poison_ratio: 0.6950425638457687  data num: [602, 605, 585, 577, 637, 646, 571, 601, 590, 577]
[foolsgold agg] considering poison per batch poison_fraction: 0.6950425638457687
[foolsgold agg] wv: [0.         0.33290448 0.81527389 1.         0.33290448 0.39065993
 0.         0.         0.40937912 1.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 1.9843, Accuracy: 2871/10000 (28.7100%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 1.8652, Accuracy: 2871/8991 (31.9319%)
Done in 277.96426796913147 sec.
Server Epoch:2 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0214, Accuracy: 362/577 (62.7383%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   2,  Average loss: 0.0316, Accuracy: 325/577 (56.3258%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   3,  Average loss: 0.0205, Accuracy: 366/577 (63.4315%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   4,  Average loss: 0.0139, Accuracy: 444/577 (76.9497%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   5,  Average loss: 0.0119, Accuracy: 468/577 (81.1092%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   6,  Average loss: 0.0086, Accuracy: 480/577 (83.1889%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   7,  Average loss: 0.0069, Accuracy: 511/577 (88.5615%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   8,  Average loss: 0.0060, Accuracy: 515/577 (89.2548%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   9,  Average loss: 0.0053, Accuracy: 529/577 (91.6811%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch  10,  Average loss: 0.0087, Accuracy: 531/577 (92.0277%), train_poison_data_count: 577
Global model norm: 14.036814106789143.
Norm before scaling: 16.37985041176258. Distance: 7.890601069347994
Total norm for 4 adversaries is: 16.37985041176258. distance: 7.890601069347994
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.3371, Accuracy: 8085/8991 (89.9233%)
___Train Local_Simple,  epoch   2, local model 59, internal_epoch   1,  Average loss: 0.0208, Accuracy: 349/607 (57.4959%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.1854, Accuracy: 6737/10000 (67.3700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   2, local model 62, internal_epoch   1,  Average loss: 0.0278, Accuracy: 263/582 (45.1890%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.4730, Accuracy: 4336/10000 (43.3600%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   1,  Average loss: 0.0226, Accuracy: 301/566 (53.1802%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   2,  Average loss: 0.0149, Accuracy: 415/566 (73.3216%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   3,  Average loss: 0.0098, Accuracy: 450/566 (79.5053%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   4,  Average loss: 0.0067, Accuracy: 507/566 (89.5760%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   5,  Average loss: 0.0051, Accuracy: 511/566 (90.2827%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   6,  Average loss: 0.0044, Accuracy: 519/566 (91.6961%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   7,  Average loss: 0.0038, Accuracy: 527/566 (93.1095%), train_poison_data_count: 566
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   8,  Average loss: 0.0033, Accuracy: 528/566 (93.2862%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   9,  Average loss: 0.0030, Accuracy: 535/566 (94.5230%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch  10,  Average loss: 0.0029, Accuracy: 536/566 (94.6996%), train_poison_data_count: 566
Global model norm: 14.036814106789143.
Norm before scaling: 14.942014387133767. Distance: 4.127512080211279
Total norm for 4 adversaries is: 14.942014387133767. distance: 4.127512080211279
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.2777, Accuracy: 8265/8991 (91.9253%)
___Train Local_Simple,  epoch   2, local model 65, internal_epoch   1,  Average loss: 0.0239, Accuracy: 303/569 (53.2513%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.9685, Accuracy: 6850/10000 (68.5000%), Attack Success Rate:0/10000(0.000)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   1,  Average loss: 0.0242, Accuracy: 346/581 (59.5525%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   2,  Average loss: 0.0131, Accuracy: 426/581 (73.3219%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   3,  Average loss: 0.0119, Accuracy: 475/581 (81.7556%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   4,  Average loss: 0.0071, Accuracy: 505/581 (86.9191%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   5,  Average loss: 0.0057, Accuracy: 517/581 (88.9845%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   6,  Average loss: 0.0050, Accuracy: 532/581 (91.5663%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   7,  Average loss: 0.0042, Accuracy: 535/581 (92.0826%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   8,  Average loss: 0.0044, Accuracy: 537/581 (92.4269%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   9,  Average loss: 0.0033, Accuracy: 544/581 (93.6317%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch  10,  Average loss: 0.0040, Accuracy: 546/581 (93.9759%), train_poison_data_count: 581
Global model norm: 14.036814106789143.
Norm before scaling: 15.174396152202709. Distance: 4.793994150322889
Total norm for 4 adversaries is: 15.174396152202709. distance: 4.793994150322889
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.2862, Accuracy: 8242/8991 (91.6694%)
___Train Local_Simple,  epoch   2, local model 78, internal_epoch   1,  Average loss: 0.0324, Accuracy: 304/617 (49.2707%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.0612, Accuracy: 3060/10000 (30.6000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   2, local model 58, internal_epoch   1,  Average loss: 0.0256, Accuracy: 291/575 (50.6087%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.2782, Accuracy: 7078/10000 (70.7800%), Attack Success Rate:0/10000(0.000)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   1,  Average loss: 0.0197, Accuracy: 404/635 (63.6220%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   2,  Average loss: 0.0087, Accuracy: 519/635 (81.7323%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   3,  Average loss: 0.0053, Accuracy: 576/635 (90.7087%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   4,  Average loss: 0.0039, Accuracy: 591/635 (93.0709%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   5,  Average loss: 0.0035, Accuracy: 596/635 (93.8583%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   6,  Average loss: 0.0031, Accuracy: 594/635 (93.5433%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   7,  Average loss: 0.0027, Accuracy: 604/635 (95.1181%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   8,  Average loss: 0.0024, Accuracy: 609/635 (95.9055%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   9,  Average loss: 0.0021, Accuracy: 613/635 (96.5354%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch  10,  Average loss: 0.0021, Accuracy: 614/635 (96.6929%), train_poison_data_count: 635
Global model norm: 14.036814106789143.
Norm before scaling: 14.822710212275938. Distance: 3.6175149394519717
Total norm for 4 adversaries is: 14.822710212275938. distance: 3.6175149394519717
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.2631, Accuracy: 8286/8991 (92.1588%)
___Train Local_Simple,  epoch   2, local model 81, internal_epoch   1,  Average loss: 0.0286, Accuracy: 289/588 (49.1497%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.5479, Accuracy: 5628/10000 (56.2800%), Attack Success Rate:0/10000(0.000)
time spent on training: 81.96386408805847
[foolsgold agg] training data poison_ratio: 0.4000339155502798  data num: [577, 607, 582, 566, 569, 581, 617, 575, 635, 588]
[foolsgold agg] considering poison per batch poison_fraction: 0.4000339155502798
[foolsgold agg] wv: [1. 0. 1. 1. 0. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 1.7300, Accuracy: 4256/10000 (42.5600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 1.5837, Accuracy: 4761/8991 (52.9530%)
Done in 256.18590211868286 sec.
Server Epoch:3 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
___Train Local_Simple,  epoch   3, local model 54, internal_epoch   1,  Average loss: 0.0273, Accuracy: 314/547 (57.4040%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.6043, Accuracy: 5978/10000 (59.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 55, internal_epoch   1,  Average loss: 0.0231, Accuracy: 347/595 (58.3193%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.8936, Accuracy: 7447/10000 (74.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 61, internal_epoch   1,  Average loss: 0.0266, Accuracy: 334/585 (57.0940%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.4333, Accuracy: 5799/10000 (57.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 73, internal_epoch   1,  Average loss: 0.0276, Accuracy: 351/615 (57.0732%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.4305, Accuracy: 6061/10000 (60.6100%), Attack Success Rate:1/10000(0.010)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   1,  Average loss: 0.0190, Accuracy: 407/567 (71.7813%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   2,  Average loss: 0.0120, Accuracy: 448/567 (79.0123%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   3,  Average loss: 0.0052, Accuracy: 510/567 (89.9471%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   4,  Average loss: 0.0045, Accuracy: 518/567 (91.3580%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   5,  Average loss: 0.0037, Accuracy: 530/567 (93.4744%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   6,  Average loss: 0.0031, Accuracy: 536/567 (94.5326%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   7,  Average loss: 0.0028, Accuracy: 538/567 (94.8854%), train_poison_data_count: 567
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   8,  Average loss: 0.0025, Accuracy: 544/567 (95.9436%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   9,  Average loss: 0.0022, Accuracy: 542/567 (95.5908%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch  10,  Average loss: 0.0022, Accuracy: 544/567 (95.9436%), train_poison_data_count: 567
Global model norm: 14.16137925752947.
Norm before scaling: 15.456725222836104. Distance: 4.9075193281759875
Total norm for 5 adversaries is: 15.456725222836104. distance: 4.9075193281759875
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2664, Accuracy: 8320/8991 (92.5370%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   1,  Average loss: 0.0251, Accuracy: 452/646 (69.9690%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   2,  Average loss: 0.0192, Accuracy: 482/646 (74.6130%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   3,  Average loss: 0.0076, Accuracy: 548/646 (84.8297%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   4,  Average loss: 0.0055, Accuracy: 590/646 (91.3313%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   5,  Average loss: 0.0060, Accuracy: 598/646 (92.5697%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   6,  Average loss: 0.0040, Accuracy: 597/646 (92.4149%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   7,  Average loss: 0.0044, Accuracy: 609/646 (94.2724%), train_poison_data_count: 646
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   8,  Average loss: 0.0031, Accuracy: 610/646 (94.4272%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   9,  Average loss: 0.0025, Accuracy: 620/646 (95.9752%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch  10,  Average loss: 0.0028, Accuracy: 622/646 (96.2848%), train_poison_data_count: 646
Global model norm: 14.16137925752947.
Norm before scaling: 16.93586030462617. Distance: 8.540783149491658
Total norm for 5 adversaries is: 16.93586030462617. distance: 8.540783149491658
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2770, Accuracy: 8211/8991 (91.3247%)
___Train Local_Simple,  epoch   3, local model 87, internal_epoch   1,  Average loss: 0.0383, Accuracy: 276/591 (46.7005%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.3020, Accuracy: 2224/10000 (22.2400%), Attack Success Rate:7/10000(0.070)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   1,  Average loss: 0.0192, Accuracy: 412/635 (64.8819%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   2,  Average loss: 0.0095, Accuracy: 525/635 (82.6772%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   3,  Average loss: 0.0048, Accuracy: 577/635 (90.8661%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   4,  Average loss: 0.0036, Accuracy: 594/635 (93.5433%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   5,  Average loss: 0.0030, Accuracy: 595/635 (93.7008%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   6,  Average loss: 0.0028, Accuracy: 603/635 (94.9606%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   7,  Average loss: 0.0024, Accuracy: 604/635 (95.1181%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   8,  Average loss: 0.0022, Accuracy: 609/635 (95.9055%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   9,  Average loss: 0.0019, Accuracy: 613/635 (96.5354%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch  10,  Average loss: 0.0019, Accuracy: 614/635 (96.6929%), train_poison_data_count: 635
Global model norm: 14.16137925752947.
Norm before scaling: 15.373770811986635. Distance: 4.728477102860949
Total norm for 5 adversaries is: 15.373770811986635. distance: 4.728477102860949
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2494, Accuracy: 8350/8991 (92.8706%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   1,  Average loss: 0.0159, Accuracy: 416/567 (73.3686%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   2,  Average loss: 0.0200, Accuracy: 393/567 (69.3122%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   3,  Average loss: 0.0090, Accuracy: 483/567 (85.1852%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   4,  Average loss: 0.0062, Accuracy: 510/567 (89.9471%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   5,  Average loss: 0.0051, Accuracy: 518/567 (91.3580%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   6,  Average loss: 0.0041, Accuracy: 527/567 (92.9453%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   7,  Average loss: 0.0035, Accuracy: 527/567 (92.9453%), train_poison_data_count: 567
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   8,  Average loss: 0.0030, Accuracy: 536/567 (94.5326%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   9,  Average loss: 0.0027, Accuracy: 539/567 (95.0617%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch  10,  Average loss: 0.0027, Accuracy: 541/567 (95.4145%), train_poison_data_count: 567
Global model norm: 14.16137925752947.
Norm before scaling: 15.49161671997577. Distance: 5.165207174749243
Total norm for 5 adversaries is: 15.49161671997577. distance: 5.165207174749243
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2984, Accuracy: 8185/8991 (91.0355%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   1,  Average loss: 0.0164, Accuracy: 375/566 (66.2544%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   2,  Average loss: 0.0101, Accuracy: 449/566 (79.3286%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   3,  Average loss: 0.0062, Accuracy: 506/566 (89.3993%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   4,  Average loss: 0.0041, Accuracy: 527/566 (93.1095%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   5,  Average loss: 0.0034, Accuracy: 532/566 (93.9929%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   6,  Average loss: 0.0028, Accuracy: 535/566 (94.5230%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   7,  Average loss: 0.0025, Accuracy: 539/566 (95.2297%), train_poison_data_count: 566
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   8,  Average loss: 0.0023, Accuracy: 541/566 (95.5830%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   9,  Average loss: 0.0021, Accuracy: 544/566 (96.1131%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch  10,  Average loss: 0.0020, Accuracy: 544/566 (96.1131%), train_poison_data_count: 566
Global model norm: 14.16137925752947.
Norm before scaling: 14.93623123207353. Distance: 3.310878284711523
Total norm for 5 adversaries is: 14.93623123207353. distance: 3.310878284711523
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2462, Accuracy: 8370/8991 (93.0931%)
time spent on training: 100.97911500930786
[foolsgold agg] training data poison_ratio: 0.5040581670612106  data num: [547, 595, 585, 615, 567, 646, 591, 635, 567, 566]
[foolsgold agg] considering poison per batch poison_fraction: 0.5040581670612106
[foolsgold agg] wv: [1.         1.         1.         1.         0.84478434 1.
 1.         0.49151209 1.         0.49151209]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 1.5450, Accuracy: 5274/10000 (52.7400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 1.4002, Accuracy: 5437/8991 (60.4716%)
Done in 337.16893696784973 sec.
Server Epoch:4 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   1,  Average loss: 0.0165, Accuracy: 475/601 (79.0349%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   2,  Average loss: 0.0187, Accuracy: 441/601 (73.3777%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   3,  Average loss: 0.0059, Accuracy: 532/601 (88.5191%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   4,  Average loss: 0.0043, Accuracy: 555/601 (92.3461%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   5,  Average loss: 0.0036, Accuracy: 562/601 (93.5108%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   6,  Average loss: 0.0029, Accuracy: 565/601 (94.0100%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   7,  Average loss: 0.0024, Accuracy: 576/601 (95.8403%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   8,  Average loss: 0.0022, Accuracy: 578/601 (96.1730%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   9,  Average loss: 0.0018, Accuracy: 586/601 (97.5042%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch  10,  Average loss: 0.0019, Accuracy: 586/601 (97.5042%), train_poison_data_count: 601
Global model norm: 14.324490917273902.
Norm before scaling: 15.56144741435972. Distance: 4.934903005093184
Total norm for 4 adversaries is: 15.56144741435972. distance: 4.934903005093184
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2508, Accuracy: 8271/8991 (91.9920%)
___Train Local_Simple,  epoch   4, local model 92, internal_epoch   1,  Average loss: 0.0191, Accuracy: 374/565 (66.1947%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.9226, Accuracy: 6835/10000 (68.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 95, internal_epoch   1,  Average loss: 0.0282, Accuracy: 362/549 (65.9381%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.8879, Accuracy: 4375/10000 (43.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 76, internal_epoch   1,  Average loss: 0.0191, Accuracy: 415/597 (69.5142%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.7249, Accuracy: 8009/10000 (80.0900%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0119, Accuracy: 501/628 (79.7771%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   2,  Average loss: 0.0064, Accuracy: 549/628 (87.4204%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   3,  Average loss: 0.0033, Accuracy: 588/628 (93.6306%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   4,  Average loss: 0.0023, Accuracy: 600/628 (95.5414%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   5,  Average loss: 0.0020, Accuracy: 606/628 (96.4968%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   6,  Average loss: 0.0017, Accuracy: 609/628 (96.9745%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   7,  Average loss: 0.0015, Accuracy: 611/628 (97.2930%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   8,  Average loss: 0.0014, Accuracy: 613/628 (97.6115%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   9,  Average loss: 0.0013, Accuracy: 616/628 (98.0892%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch  10,  Average loss: 0.0013, Accuracy: 617/628 (98.2484%), train_poison_data_count: 628
Global model norm: 14.324490917273902.
Norm before scaling: 15.019006005120177. Distance: 3.0334114155483434
Total norm for 4 adversaries is: 15.019006005120177. distance: 3.0334114155483434
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2409, Accuracy: 8386/8991 (93.2710%)
___Train Local_Simple,  epoch   4, local model 99, internal_epoch   1,  Average loss: 0.0113, Accuracy: 349/408 (85.5392%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 10.3818, Accuracy: 4717/10000 (47.1700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   4, local model 94, internal_epoch   1,  Average loss: 0.0265, Accuracy: 348/541 (64.3253%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.6055, Accuracy: 5239/10000 (52.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 74, internal_epoch   1,  Average loss: 0.0227, Accuracy: 404/597 (67.6717%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.3399, Accuracy: 6477/10000 (64.7700%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   1,  Average loss: 0.0126, Accuracy: 453/571 (79.3345%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   2,  Average loss: 0.0128, Accuracy: 439/571 (76.8827%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   3,  Average loss: 0.0079, Accuracy: 525/571 (91.9440%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   4,  Average loss: 0.0047, Accuracy: 534/571 (93.5201%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   5,  Average loss: 0.0032, Accuracy: 539/571 (94.3958%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   6,  Average loss: 0.0026, Accuracy: 541/571 (94.7461%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   7,  Average loss: 0.0023, Accuracy: 545/571 (95.4466%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   8,  Average loss: 0.0021, Accuracy: 547/571 (95.7968%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   9,  Average loss: 0.0019, Accuracy: 551/571 (96.4974%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch  10,  Average loss: 0.0018, Accuracy: 551/571 (96.4974%), train_poison_data_count: 571
Global model norm: 14.324490917273902.
Norm before scaling: 15.211610595983192. Distance: 3.808919006544125
Total norm for 4 adversaries is: 15.211610595983192. distance: 3.808919006544125
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2520, Accuracy: 8348/8991 (92.8484%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   1,  Average loss: 0.0118, Accuracy: 487/608 (80.0987%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   2,  Average loss: 0.0146, Accuracy: 502/608 (82.5658%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   3,  Average loss: 0.0059, Accuracy: 553/608 (90.9539%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   4,  Average loss: 0.0043, Accuracy: 566/608 (93.0921%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   5,  Average loss: 0.0038, Accuracy: 572/608 (94.0789%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   6,  Average loss: 0.0034, Accuracy: 575/608 (94.5724%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   7,  Average loss: 0.0029, Accuracy: 575/608 (94.5724%), train_poison_data_count: 608
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   8,  Average loss: 0.0029, Accuracy: 580/608 (95.3947%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   9,  Average loss: 0.0024, Accuracy: 583/608 (95.8882%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch  10,  Average loss: 0.0024, Accuracy: 584/608 (96.0526%), train_poison_data_count: 608
Global model norm: 14.324490917273902.
Norm before scaling: 15.193819214864456. Distance: 3.6722680713396674
Total norm for 4 adversaries is: 15.193819214864456. distance: 3.6722680713396674
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2137, Accuracy: 8429/8991 (93.7493%)
time spent on training: 106.50789284706116
[foolsgold agg] training data poison_ratio: 0.42506619593998235  data num: [601, 565, 549, 597, 628, 408, 541, 597, 571, 608]
[foolsgold agg] considering poison per batch poison_fraction: 0.42506619593998235
[foolsgold agg] wv: [0.         0.8899481  1.         1.         0.42372617 1.
 0.8899481  1.         0.         0.42372617]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 1.5114, Accuracy: 6461/10000 (64.6100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 1.4141, Accuracy: 6507/8991 (72.3724%)
Done in 330.15833806991577 sec.
Server Epoch:5 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
___Train Local_Simple,  epoch   5, local model 60, internal_epoch   1,  Average loss: 0.0185, Accuracy: 419/600 (69.8333%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.8074, Accuracy: 7350/10000 (73.5000%), Attack Success Rate:0/10000(0.000)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   1,  Average loss: 0.0136, Accuracy: 509/637 (79.9058%), train_poison_data_count: 637
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   2,  Average loss: 0.0099, Accuracy: 516/637 (81.0047%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   3,  Average loss: 0.0050, Accuracy: 581/637 (91.2088%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   4,  Average loss: 0.0040, Accuracy: 592/637 (92.9356%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   5,  Average loss: 0.0034, Accuracy: 599/637 (94.0345%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   6,  Average loss: 0.0029, Accuracy: 608/637 (95.4474%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   7,  Average loss: 0.0025, Accuracy: 612/637 (96.0754%), train_poison_data_count: 637
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   8,  Average loss: 0.0023, Accuracy: 610/637 (95.7614%), train_poison_data_count: 637
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   9,  Average loss: 0.0020, Accuracy: 616/637 (96.7033%), train_poison_data_count: 637
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch  10,  Average loss: 0.0020, Accuracy: 616/637 (96.7033%), train_poison_data_count: 637
Global model norm: 14.378885556729202.
Norm before scaling: 15.317092642742852. Distance: 3.835710507142646
Total norm for 7 adversaries is: 15.317092642742852. distance: 3.835710507142646
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2312, Accuracy: 8361/8991 (92.9930%)
___Train Local_Simple,  epoch   5, local model 65, internal_epoch   1,  Average loss: 0.0167, Accuracy: 407/569 (71.5290%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.3664, Accuracy: 6290/10000 (62.9000%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0119, Accuracy: 490/594 (82.4916%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   2,  Average loss: 0.0089, Accuracy: 496/594 (83.5017%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   3,  Average loss: 0.0046, Accuracy: 551/594 (92.7609%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   4,  Average loss: 0.0027, Accuracy: 567/594 (95.4545%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   5,  Average loss: 0.0023, Accuracy: 574/594 (96.6330%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   6,  Average loss: 0.0019, Accuracy: 577/594 (97.1380%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   7,  Average loss: 0.0017, Accuracy: 577/594 (97.1380%), train_poison_data_count: 594
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   8,  Average loss: 0.0015, Accuracy: 580/594 (97.6431%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   9,  Average loss: 0.0013, Accuracy: 581/594 (97.8114%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch  10,  Average loss: 0.0014, Accuracy: 582/594 (97.9798%), train_poison_data_count: 594
Global model norm: 14.378885556729202.
Norm before scaling: 15.15117454885795. Distance: 3.2456365784413395
Total norm for 7 adversaries is: 15.15117454885795. distance: 3.2456365784413395
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2186, Accuracy: 8413/8991 (93.5713%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   1,  Average loss: 0.0121, Accuracy: 495/601 (82.3627%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   2,  Average loss: 0.0122, Accuracy: 493/601 (82.0300%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   3,  Average loss: 0.0055, Accuracy: 543/601 (90.3494%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   4,  Average loss: 0.0043, Accuracy: 561/601 (93.3444%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   5,  Average loss: 0.0034, Accuracy: 567/601 (94.3428%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   6,  Average loss: 0.0027, Accuracy: 568/601 (94.5092%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   7,  Average loss: 0.0024, Accuracy: 575/601 (95.6739%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   8,  Average loss: 0.0021, Accuracy: 575/601 (95.6739%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   9,  Average loss: 0.0018, Accuracy: 580/601 (96.5058%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch  10,  Average loss: 0.0019, Accuracy: 580/601 (96.5058%), train_poison_data_count: 601
Global model norm: 14.378885556729202.
Norm before scaling: 15.226766930387546. Distance: 3.4820325701229407
Total norm for 7 adversaries is: 15.226766930387546. distance: 3.4820325701229407
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2224, Accuracy: 8411/8991 (93.5491%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   1,  Average loss: 0.0120, Accuracy: 493/603 (81.7579%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   2,  Average loss: 0.0109, Accuracy: 484/603 (80.2653%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   3,  Average loss: 0.0055, Accuracy: 554/603 (91.8740%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   4,  Average loss: 0.0042, Accuracy: 561/603 (93.0348%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   5,  Average loss: 0.0034, Accuracy: 564/603 (93.5323%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   6,  Average loss: 0.0030, Accuracy: 570/603 (94.5274%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   7,  Average loss: 0.0024, Accuracy: 576/603 (95.5224%), train_poison_data_count: 603
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   8,  Average loss: 0.0023, Accuracy: 579/603 (96.0199%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   9,  Average loss: 0.0020, Accuracy: 580/603 (96.1857%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch  10,  Average loss: 0.0021, Accuracy: 581/603 (96.3516%), train_poison_data_count: 603
Global model norm: 14.378885556729202.
Norm before scaling: 15.19766058737665. Distance: 3.384671235790804
Total norm for 7 adversaries is: 15.19766058737665. distance: 3.384671235790804
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2357, Accuracy: 8381/8991 (93.2154%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0132, Accuracy: 451/570 (79.1228%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   2,  Average loss: 0.0092, Accuracy: 473/570 (82.9825%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   3,  Average loss: 0.0043, Accuracy: 520/570 (91.2281%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   4,  Average loss: 0.0029, Accuracy: 541/570 (94.9123%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   5,  Average loss: 0.0024, Accuracy: 538/570 (94.3860%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   6,  Average loss: 0.0020, Accuracy: 544/570 (95.4386%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   7,  Average loss: 0.0017, Accuracy: 551/570 (96.6667%), train_poison_data_count: 570
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   8,  Average loss: 0.0015, Accuracy: 555/570 (97.3684%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   9,  Average loss: 0.0013, Accuracy: 557/570 (97.7193%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch  10,  Average loss: 0.0013, Accuracy: 557/570 (97.7193%), train_poison_data_count: 570
Global model norm: 14.378885556729202.
Norm before scaling: 15.106086949142027. Distance: 3.1242616925694984
Total norm for 7 adversaries is: 15.106086949142027. distance: 3.1242616925694984
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2536, Accuracy: 8339/8991 (92.7483%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0117, Accuracy: 514/621 (82.7697%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   2,  Average loss: 0.0076, Accuracy: 540/621 (86.9565%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   3,  Average loss: 0.0048, Accuracy: 566/621 (91.1433%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   4,  Average loss: 0.0029, Accuracy: 582/621 (93.7198%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   5,  Average loss: 0.0021, Accuracy: 598/621 (96.2963%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   6,  Average loss: 0.0016, Accuracy: 602/621 (96.9404%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   7,  Average loss: 0.0013, Accuracy: 606/621 (97.5845%), train_poison_data_count: 621
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   8,  Average loss: 0.0010, Accuracy: 613/621 (98.7118%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   9,  Average loss: 0.0009, Accuracy: 615/621 (99.0338%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch  10,  Average loss: 0.0009, Accuracy: 615/621 (99.0338%), train_poison_data_count: 621
Global model norm: 14.378885556729202.
Norm before scaling: 15.136914313252811. Distance: 3.1831268529850996
Total norm for 7 adversaries is: 15.136914313252811. distance: 3.1831268529850996
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2172, Accuracy: 8420/8991 (93.6492%)
___Train Local_Simple,  epoch   5, local model 76, internal_epoch   1,  Average loss: 0.0167, Accuracy: 429/597 (71.8593%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.7396, Accuracy: 7784/10000 (77.8400%), Attack Success Rate:0/10000(0.000)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   1,  Average loss: 0.0121, Accuracy: 450/560 (80.3571%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   2,  Average loss: 0.0096, Accuracy: 458/560 (81.7857%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   3,  Average loss: 0.0057, Accuracy: 495/560 (88.3929%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   4,  Average loss: 0.0033, Accuracy: 530/560 (94.6429%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   5,  Average loss: 0.0026, Accuracy: 535/560 (95.5357%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   6,  Average loss: 0.0022, Accuracy: 537/560 (95.8929%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   7,  Average loss: 0.0018, Accuracy: 543/560 (96.9643%), train_poison_data_count: 560
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   8,  Average loss: 0.0016, Accuracy: 544/560 (97.1429%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   9,  Average loss: 0.0014, Accuracy: 547/560 (97.6786%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch  10,  Average loss: 0.0014, Accuracy: 547/560 (97.6786%), train_poison_data_count: 560
Global model norm: 14.378885556729202.
Norm before scaling: 15.010344943480334. Distance: 2.8252355663017616
Total norm for 7 adversaries is: 15.010344943480334. distance: 2.8252355663017616
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2162, Accuracy: 8423/8991 (93.6826%)
time spent on training: 144.30499601364136
[foolsgold agg] training data poison_ratio: 0.7032930107526881  data num: [600, 637, 569, 594, 601, 603, 570, 621, 597, 560]
[foolsgold agg] considering poison per batch poison_fraction: 0.7032930107526881
[foolsgold agg] wv: [1.         1.         0.92044906 0.44105731 0.66962003 0.6067527
 0.44105731 0.58015409 0.92044906 0.5787705 ]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 1.1229, Accuracy: 6657/10000 (66.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 0.8837, Accuracy: 6700/8991 (74.5190%)
Done in 369.73231196403503 sec.
Server Epoch:6 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   1,  Average loss: 0.0078, Accuracy: 494/573 (86.2129%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   2,  Average loss: 0.0048, Accuracy: 524/573 (91.4485%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   3,  Average loss: 0.0034, Accuracy: 537/573 (93.7173%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   4,  Average loss: 0.0021, Accuracy: 551/573 (96.1606%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   5,  Average loss: 0.0018, Accuracy: 560/573 (97.7312%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   6,  Average loss: 0.0015, Accuracy: 560/573 (97.7312%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   7,  Average loss: 0.0013, Accuracy: 563/573 (98.2548%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   8,  Average loss: 0.0012, Accuracy: 565/573 (98.6038%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   9,  Average loss: 0.0010, Accuracy: 564/573 (98.4293%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch  10,  Average loss: 0.0010, Accuracy: 564/573 (98.4293%), train_poison_data_count: 573
Global model norm: 14.52988484850921.
Norm before scaling: 14.982946238257535. Distance: 2.203925237671884
Total norm for 6 adversaries is: 14.982946238257535. distance: 2.203925237671884
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1849, Accuracy: 8485/8991 (94.3721%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   1,  Average loss: 0.0082, Accuracy: 494/573 (86.2129%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   2,  Average loss: 0.0059, Accuracy: 501/573 (87.4346%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   3,  Average loss: 0.0039, Accuracy: 520/573 (90.7504%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   4,  Average loss: 0.0024, Accuracy: 546/573 (95.2880%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   5,  Average loss: 0.0022, Accuracy: 548/573 (95.6370%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   6,  Average loss: 0.0017, Accuracy: 553/573 (96.5096%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   7,  Average loss: 0.0015, Accuracy: 555/573 (96.8586%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   8,  Average loss: 0.0014, Accuracy: 557/573 (97.2077%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   9,  Average loss: 0.0012, Accuracy: 560/573 (97.7312%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch  10,  Average loss: 0.0012, Accuracy: 560/573 (97.7312%), train_poison_data_count: 573
Global model norm: 14.52988484850921.
Norm before scaling: 14.968558865722564. Distance: 2.22080382804046
Total norm for 6 adversaries is: 14.968558865722564. distance: 2.22080382804046
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1763, Accuracy: 8498/8991 (94.5167%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 560/621 (90.1771%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   2,  Average loss: 0.0055, Accuracy: 554/621 (89.2110%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   3,  Average loss: 0.0028, Accuracy: 580/621 (93.3977%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   4,  Average loss: 0.0014, Accuracy: 603/621 (97.1014%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   5,  Average loss: 0.0011, Accuracy: 611/621 (98.3897%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   6,  Average loss: 0.0008, Accuracy: 614/621 (98.8728%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   7,  Average loss: 0.0006, Accuracy: 615/621 (99.0338%), train_poison_data_count: 621
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   8,  Average loss: 0.0005, Accuracy: 617/621 (99.3559%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   9,  Average loss: 0.0004, Accuracy: 619/621 (99.6779%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch  10,  Average loss: 0.0004, Accuracy: 619/621 (99.6779%), train_poison_data_count: 621
Global model norm: 14.52988484850921.
Norm before scaling: 15.041970599512604. Distance: 2.3259995762635204
Total norm for 6 adversaries is: 15.041970599512604. distance: 2.3259995762635204
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.2132, Accuracy: 8452/8991 (94.0051%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   1,  Average loss: 0.0078, Accuracy: 555/635 (87.4016%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   2,  Average loss: 0.0063, Accuracy: 564/635 (88.8189%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   3,  Average loss: 0.0045, Accuracy: 578/635 (91.0236%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   4,  Average loss: 0.0024, Accuracy: 607/635 (95.5906%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   5,  Average loss: 0.0018, Accuracy: 613/635 (96.5354%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   6,  Average loss: 0.0015, Accuracy: 616/635 (97.0079%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   7,  Average loss: 0.0013, Accuracy: 616/635 (97.0079%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   8,  Average loss: 0.0012, Accuracy: 620/635 (97.6378%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   9,  Average loss: 0.0011, Accuracy: 622/635 (97.9528%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch  10,  Average loss: 0.0010, Accuracy: 622/635 (97.9528%), train_poison_data_count: 635
Global model norm: 14.52988484850921.
Norm before scaling: 15.028046391488369. Distance: 2.3474355584380344
Total norm for 6 adversaries is: 15.028046391488369. distance: 2.3474355584380344
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1735, Accuracy: 8515/8991 (94.7058%)
___Train Local_Simple,  epoch   6, local model 99, internal_epoch   1,  Average loss: 0.0063, Accuracy: 371/408 (90.9314%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 6.8407, Accuracy: 5012/10000 (50.1200%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   6, local model 67, internal_epoch   1,  Average loss: 0.0112, Accuracy: 447/570 (78.4211%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.3049, Accuracy: 6215/10000 (62.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 91, internal_epoch   1,  Average loss: 0.0134, Accuracy: 466/597 (78.0570%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.1371, Accuracy: 6568/10000 (65.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 76, internal_epoch   1,  Average loss: 0.0128, Accuracy: 468/597 (78.3920%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.2721, Accuracy: 6526/10000 (65.2600%), Attack Success Rate:0/10000(0.000)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0073, Accuracy: 513/593 (86.5093%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   2,  Average loss: 0.0076, Accuracy: 517/593 (87.1838%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   3,  Average loss: 0.0051, Accuracy: 540/593 (91.0624%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   4,  Average loss: 0.0028, Accuracy: 565/593 (95.2782%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   5,  Average loss: 0.0021, Accuracy: 573/593 (96.6273%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   6,  Average loss: 0.0019, Accuracy: 576/593 (97.1332%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   7,  Average loss: 0.0016, Accuracy: 581/593 (97.9764%), train_poison_data_count: 593
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   8,  Average loss: 0.0014, Accuracy: 581/593 (97.9764%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   9,  Average loss: 0.0012, Accuracy: 582/593 (98.1450%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch  10,  Average loss: 0.0011, Accuracy: 582/593 (98.1450%), train_poison_data_count: 593
Global model norm: 14.52988484850921.
Norm before scaling: 15.059003622015988. Distance: 2.4385536068625764
Total norm for 6 adversaries is: 15.059003622015988. distance: 2.4385536068625764
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1589, Accuracy: 8545/8991 (95.0395%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   1,  Average loss: 0.0071, Accuracy: 506/581 (87.0912%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   2,  Average loss: 0.0072, Accuracy: 504/581 (86.7470%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   3,  Average loss: 0.0062, Accuracy: 521/581 (89.6730%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   4,  Average loss: 0.0040, Accuracy: 551/581 (94.8365%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   5,  Average loss: 0.0022, Accuracy: 558/581 (96.0413%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   6,  Average loss: 0.0018, Accuracy: 566/581 (97.4182%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   7,  Average loss: 0.0014, Accuracy: 567/581 (97.5904%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   8,  Average loss: 0.0012, Accuracy: 570/581 (98.1067%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   9,  Average loss: 0.0011, Accuracy: 573/581 (98.6231%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch  10,  Average loss: 0.0015, Accuracy: 573/581 (98.6231%), train_poison_data_count: 581
Global model norm: 14.52988484850921.
Norm before scaling: 15.140480379372514. Distance: 2.6788391015867195
Total norm for 6 adversaries is: 15.140480379372514. distance: 2.6788391015867195
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1879, Accuracy: 8487/8991 (94.3944%)
time spent on training: 121.48779606819153
[foolsgold agg] training data poison_ratio: 0.6221294363256785  data num: [573, 573, 621, 635, 408, 570, 597, 597, 593, 581]
[foolsgold agg] considering poison per batch poison_fraction: 0.6221294363256785
[foolsgold agg] wv: [1.         1.         0.83414027 0.83414027 1.         0.87113064
 1.         0.87113064 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 0.9382, Accuracy: 7560/10000 (75.6000%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 0.4834, Accuracy: 7564/8991 (84.1286%)
Done in 328.0045430660248 sec.
Server Epoch:7 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
___Train Local_Simple,  epoch   7, local model 66, internal_epoch   1,  Average loss: 0.0099, Accuracy: 508/622 (81.6720%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.5141, Accuracy: 8465/10000 (84.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 68, internal_epoch   1,  Average loss: 0.0095, Accuracy: 482/583 (82.6758%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.8929, Accuracy: 6446/10000 (64.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 59, internal_epoch   1,  Average loss: 0.0093, Accuracy: 487/607 (80.2306%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.4776, Accuracy: 8563/10000 (85.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 62, internal_epoch   1,  Average loss: 0.0090, Accuracy: 475/582 (81.6151%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.6183, Accuracy: 5780/10000 (57.8000%), Attack Success Rate:1/10000(0.010)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   1,  Average loss: 0.0057, Accuracy: 556/617 (90.1135%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   2,  Average loss: 0.0041, Accuracy: 569/617 (92.2204%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   3,  Average loss: 0.0020, Accuracy: 595/617 (96.4344%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   4,  Average loss: 0.0016, Accuracy: 597/617 (96.7585%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   5,  Average loss: 0.0014, Accuracy: 603/617 (97.7310%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   6,  Average loss: 0.0012, Accuracy: 602/617 (97.5689%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   7,  Average loss: 0.0010, Accuracy: 602/617 (97.5689%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   8,  Average loss: 0.0009, Accuracy: 605/617 (98.0551%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   9,  Average loss: 0.0008, Accuracy: 605/617 (98.0551%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch  10,  Average loss: 0.0008, Accuracy: 606/617 (98.2172%), train_poison_data_count: 617
Global model norm: 14.695749117151456.
Norm before scaling: 15.015009173766137. Distance: 1.881987331538275
Total norm for 5 adversaries is: 15.015009173766137. distance: 1.881987331538275
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1633, Accuracy: 8537/8991 (94.9505%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0053, Accuracy: 580/635 (91.3386%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   2,  Average loss: 0.0031, Accuracy: 593/635 (93.3858%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   3,  Average loss: 0.0018, Accuracy: 614/635 (96.6929%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   4,  Average loss: 0.0012, Accuracy: 625/635 (98.4252%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   5,  Average loss: 0.0010, Accuracy: 624/635 (98.2677%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   6,  Average loss: 0.0009, Accuracy: 631/635 (99.3701%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   7,  Average loss: 0.0008, Accuracy: 630/635 (99.2126%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   8,  Average loss: 0.0007, Accuracy: 632/635 (99.5276%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   9,  Average loss: 0.0006, Accuracy: 633/635 (99.6850%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch  10,  Average loss: 0.0006, Accuracy: 633/635 (99.6850%), train_poison_data_count: 635
Global model norm: 14.695749117151456.
Norm before scaling: 15.024461256070257. Distance: 1.861115418456045
Total norm for 5 adversaries is: 15.024461256070257. distance: 1.861115418456045
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1654, Accuracy: 8540/8991 (94.9839%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   1,  Average loss: 0.0052, Accuracy: 550/602 (91.3621%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   2,  Average loss: 0.0039, Accuracy: 558/602 (92.6910%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   3,  Average loss: 0.0037, Accuracy: 555/602 (92.1927%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   4,  Average loss: 0.0018, Accuracy: 584/602 (97.0100%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   5,  Average loss: 0.0011, Accuracy: 591/602 (98.1728%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   6,  Average loss: 0.0010, Accuracy: 593/602 (98.5050%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   7,  Average loss: 0.0008, Accuracy: 595/602 (98.8372%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   8,  Average loss: 0.0007, Accuracy: 598/602 (99.3355%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   9,  Average loss: 0.0006, Accuracy: 599/602 (99.5017%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch  10,  Average loss: 0.0006, Accuracy: 599/602 (99.5017%), train_poison_data_count: 602
Global model norm: 14.695749117151456.
Norm before scaling: 15.036671380530157. Distance: 1.8870644578462088
Total norm for 5 adversaries is: 15.036671380530157. distance: 1.8870644578462088
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1621, Accuracy: 8557/8991 (95.1730%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 510/570 (89.4737%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   2,  Average loss: 0.0030, Accuracy: 529/570 (92.8070%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   3,  Average loss: 0.0021, Accuracy: 543/570 (95.2632%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   4,  Average loss: 0.0012, Accuracy: 553/570 (97.0175%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   5,  Average loss: 0.0011, Accuracy: 557/570 (97.7193%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   6,  Average loss: 0.0009, Accuracy: 563/570 (98.7719%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   7,  Average loss: 0.0008, Accuracy: 566/570 (99.2982%), train_poison_data_count: 570
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   8,  Average loss: 0.0007, Accuracy: 566/570 (99.2982%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   9,  Average loss: 0.0006, Accuracy: 566/570 (99.2982%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch  10,  Average loss: 0.0006, Accuracy: 566/570 (99.2982%), train_poison_data_count: 570
Global model norm: 14.695749117151456.
Norm before scaling: 15.003018393412905. Distance: 1.754321484593794
Total norm for 5 adversaries is: 15.003018393412905. distance: 1.754321484593794
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1856, Accuracy: 8496/8991 (94.4945%)
___Train Local_Simple,  epoch   7, local model 99, internal_epoch   1,  Average loss: 0.0036, Accuracy: 384/408 (94.1176%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 3.0277, Accuracy: 6239/10000 (62.3900%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   1,  Average loss: 0.0054, Accuracy: 510/571 (89.3170%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   2,  Average loss: 0.0031, Accuracy: 535/571 (93.6953%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   3,  Average loss: 0.0017, Accuracy: 549/571 (96.1471%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   4,  Average loss: 0.0014, Accuracy: 554/571 (97.0228%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   5,  Average loss: 0.0012, Accuracy: 556/571 (97.3730%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   6,  Average loss: 0.0010, Accuracy: 558/571 (97.7233%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   7,  Average loss: 0.0009, Accuracy: 562/571 (98.4238%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   8,  Average loss: 0.0008, Accuracy: 566/571 (99.1243%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   9,  Average loss: 0.0007, Accuracy: 567/571 (99.2995%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch  10,  Average loss: 0.0007, Accuracy: 567/571 (99.2995%), train_poison_data_count: 571
Global model norm: 14.695749117151456.
Norm before scaling: 14.978884776102063. Distance: 1.776123701272431
Total norm for 5 adversaries is: 14.978884776102063. distance: 1.776123701272431
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1811, Accuracy: 8517/8991 (94.7281%)
time spent on training: 110.05038809776306
[foolsgold agg] training data poison_ratio: 0.516646541314473  data num: [622, 583, 607, 582, 617, 635, 602, 570, 408, 571]
[foolsgold agg] considering poison per batch poison_fraction: 0.516646541314473
[foolsgold agg] wv: [1.         1.         0.53782879 0.53782879 1.         1.
 0.05928807 0.99379512 1.         0.05928807]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 0.8767, Accuracy: 8000/10000 (80.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 0.3456, Accuracy: 7993/8991 (88.9000%)
Done in 316.028391122818 sec.
Server Epoch:8 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
___Train Local_Simple,  epoch   8, local model 63, internal_epoch   1,  Average loss: 0.0080, Accuracy: 502/594 (84.5118%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.5629, Accuracy: 7375/10000 (73.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 55, internal_epoch   1,  Average loss: 0.0090, Accuracy: 499/595 (83.8655%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.8387, Accuracy: 6532/10000 (65.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 79, internal_epoch   1,  Average loss: 0.0084, Accuracy: 469/565 (83.0088%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6525, Accuracy: 8169/10000 (81.6900%), Attack Success Rate:0/10000(0.000)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0050, Accuracy: 532/587 (90.6303%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   2,  Average loss: 0.0032, Accuracy: 549/587 (93.5264%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   3,  Average loss: 0.0024, Accuracy: 560/587 (95.4003%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   4,  Average loss: 0.0014, Accuracy: 570/587 (97.1039%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   5,  Average loss: 0.0011, Accuracy: 574/587 (97.7853%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   6,  Average loss: 0.0009, Accuracy: 579/587 (98.6371%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   7,  Average loss: 0.0007, Accuracy: 581/587 (98.9779%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   8,  Average loss: 0.0007, Accuracy: 582/587 (99.1482%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   9,  Average loss: 0.0006, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch  10,  Average loss: 0.0006, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Global model norm: 14.773154495570674.
Norm before scaling: 15.041844304410446. Distance: 1.6975711244674647
Total norm for 2 adversaries is: 15.041844304410446. distance: 1.6975711244674647
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1618, Accuracy: 8555/8991 (95.1507%)
___Train Local_Simple,  epoch   8, local model 62, internal_epoch   1,  Average loss: 0.0090, Accuracy: 474/582 (81.4433%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.4174, Accuracy: 8730/10000 (87.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 56, internal_epoch   1,  Average loss: 0.0077, Accuracy: 498/586 (84.9829%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.4801, Accuracy: 8416/10000 (84.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 96, internal_epoch   1,  Average loss: 0.0084, Accuracy: 450/540 (83.3333%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.2647, Accuracy: 7729/10000 (77.2900%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 510/555 (91.8919%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   2,  Average loss: 0.0044, Accuracy: 507/555 (91.3514%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   3,  Average loss: 0.0028, Accuracy: 522/555 (94.0541%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   4,  Average loss: 0.0018, Accuracy: 538/555 (96.9369%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   5,  Average loss: 0.0016, Accuracy: 539/555 (97.1171%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   6,  Average loss: 0.0012, Accuracy: 544/555 (98.0180%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   7,  Average loss: 0.0011, Accuracy: 548/555 (98.7387%), train_poison_data_count: 555
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   8,  Average loss: 0.0009, Accuracy: 547/555 (98.5586%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   9,  Average loss: 0.0008, Accuracy: 549/555 (98.9189%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch  10,  Average loss: 0.0008, Accuracy: 549/555 (98.9189%), train_poison_data_count: 555
Global model norm: 14.773154495570674.
Norm before scaling: 15.021951507697306. Distance: 1.6193782691819507
Total norm for 2 adversaries is: 15.021951507697306. distance: 1.6193782691819507
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1646, Accuracy: 8555/8991 (95.1507%)
___Train Local_Simple,  epoch   8, local model 92, internal_epoch   1,  Average loss: 0.0092, Accuracy: 467/565 (82.6549%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.3168, Accuracy: 8946/10000 (89.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 86, internal_epoch   1,  Average loss: 0.0074, Accuracy: 528/609 (86.6995%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.5886, Accuracy: 8449/10000 (84.4900%), Attack Success Rate:0/10000(0.000)
time spent on training: 73.06943988800049
[foolsgold agg] training data poison_ratio: 0.19764624437521633  data num: [594, 595, 565, 587, 582, 586, 540, 555, 565, 609]
[foolsgold agg] considering poison per batch poison_fraction: 0.19764624437521633
[foolsgold agg] wv: [0.49516066 0.67875712 0.92248826 1.         0.67875712 0.92248826
 0.57285559 1.         0.3228162  0.3228162 ]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 0.8147, Accuracy: 8164/10000 (81.6400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 0.2876, Accuracy: 8166/8991 (90.8242%)
Done in 278.2902660369873 sec.
Server Epoch:9 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   1,  Average loss: 0.0038, Accuracy: 524/566 (92.5795%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   2,  Average loss: 0.0023, Accuracy: 542/566 (95.7597%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   3,  Average loss: 0.0016, Accuracy: 550/566 (97.1731%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   4,  Average loss: 0.0011, Accuracy: 554/566 (97.8799%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   5,  Average loss: 0.0008, Accuracy: 560/566 (98.9399%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   6,  Average loss: 0.0007, Accuracy: 561/566 (99.1166%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   7,  Average loss: 0.0006, Accuracy: 563/566 (99.4700%), train_poison_data_count: 566
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   8,  Average loss: 0.0006, Accuracy: 564/566 (99.6466%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   9,  Average loss: 0.0005, Accuracy: 565/566 (99.8233%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch  10,  Average loss: 0.0005, Accuracy: 565/566 (99.8233%), train_poison_data_count: 566
Global model norm: 14.836914030361433.
Norm before scaling: 15.037816506826008. Distance: 1.3907656652050717
Total norm for 6 adversaries is: 15.037816506826008. distance: 1.3907656652050717
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1679, Accuracy: 8573/8991 (95.3509%)
___Train Local_Simple,  epoch   9, local model 63, internal_epoch   1,  Average loss: 0.0093, Accuracy: 489/594 (82.3232%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.4972, Accuracy: 8426/10000 (84.2600%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   1,  Average loss: 0.0039, Accuracy: 569/612 (92.9739%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   2,  Average loss: 0.0024, Accuracy: 588/612 (96.0784%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   3,  Average loss: 0.0012, Accuracy: 598/612 (97.7124%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   4,  Average loss: 0.0008, Accuracy: 600/612 (98.0392%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   5,  Average loss: 0.0007, Accuracy: 604/612 (98.6928%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   6,  Average loss: 0.0006, Accuracy: 606/612 (99.0196%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   7,  Average loss: 0.0005, Accuracy: 607/612 (99.1830%), train_poison_data_count: 612
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   8,  Average loss: 0.0005, Accuracy: 609/612 (99.5098%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   9,  Average loss: 0.0004, Accuracy: 609/612 (99.5098%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch  10,  Average loss: 0.0004, Accuracy: 609/612 (99.5098%), train_poison_data_count: 612
Global model norm: 14.836914030361433.
Norm before scaling: 15.054285112357233. Distance: 1.4865367206666167
Total norm for 6 adversaries is: 15.054285112357233. distance: 1.4865367206666167
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1647, Accuracy: 8559/8991 (95.1952%)
___Train Local_Simple,  epoch   9, local model 71, internal_epoch   1,  Average loss: 0.0080, Accuracy: 537/637 (84.3014%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.3845, Accuracy: 8934/10000 (89.3400%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 591/628 (94.1083%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   2,  Average loss: 0.0020, Accuracy: 595/628 (94.7452%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   3,  Average loss: 0.0012, Accuracy: 616/628 (98.0892%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   4,  Average loss: 0.0008, Accuracy: 622/628 (99.0446%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   5,  Average loss: 0.0007, Accuracy: 622/628 (99.0446%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   6,  Average loss: 0.0006, Accuracy: 621/628 (98.8854%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   7,  Average loss: 0.0005, Accuracy: 622/628 (99.0446%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   8,  Average loss: 0.0005, Accuracy: 626/628 (99.6815%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   9,  Average loss: 0.0004, Accuracy: 626/628 (99.6815%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch  10,  Average loss: 0.0004, Accuracy: 626/628 (99.6815%), train_poison_data_count: 628
Global model norm: 14.836914030361433.
Norm before scaling: 15.009188571576694. Distance: 1.3402155146304373
Total norm for 6 adversaries is: 15.009188571576694. distance: 1.3402155146304373
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1566, Accuracy: 8565/8991 (95.2619%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   1,  Average loss: 0.0031, Accuracy: 583/620 (94.0323%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   2,  Average loss: 0.0023, Accuracy: 595/620 (95.9677%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   3,  Average loss: 0.0028, Accuracy: 587/620 (94.6774%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   4,  Average loss: 0.0011, Accuracy: 609/620 (98.2258%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   5,  Average loss: 0.0009, Accuracy: 615/620 (99.1935%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   6,  Average loss: 0.0006, Accuracy: 616/620 (99.3548%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   7,  Average loss: 0.0005, Accuracy: 617/620 (99.5161%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   8,  Average loss: 0.0004, Accuracy: 618/620 (99.6774%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   9,  Average loss: 0.0004, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch  10,  Average loss: 0.0004, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Global model norm: 14.836914030361433.
Norm before scaling: 15.022428910177213. Distance: 1.430192701787282
Total norm for 6 adversaries is: 15.022428910177213. distance: 1.430192701787282
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1574, Accuracy: 8557/8991 (95.1730%)
___Train Local_Simple,  epoch   9, local model 76, internal_epoch   1,  Average loss: 0.0086, Accuracy: 505/597 (84.5896%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.3351, Accuracy: 8693/10000 (86.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 97, internal_epoch   1,  Average loss: 0.0104, Accuracy: 441/539 (81.8182%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.9394, Accuracy: 7492/10000 (74.9200%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   1,  Average loss: 0.0039, Accuracy: 560/602 (93.0233%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   2,  Average loss: 0.0038, Accuracy: 561/602 (93.1894%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   3,  Average loss: 0.0016, Accuracy: 585/602 (97.1761%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   4,  Average loss: 0.0011, Accuracy: 587/602 (97.5083%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   5,  Average loss: 0.0009, Accuracy: 595/602 (98.8372%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   6,  Average loss: 0.0007, Accuracy: 599/602 (99.5017%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   7,  Average loss: 0.0006, Accuracy: 600/602 (99.6678%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   8,  Average loss: 0.0005, Accuracy: 600/602 (99.6678%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   9,  Average loss: 0.0004, Accuracy: 600/602 (99.6678%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch  10,  Average loss: 0.0004, Accuracy: 600/602 (99.6678%), train_poison_data_count: 602
Global model norm: 14.836914030361433.
Norm before scaling: 15.054168549696003. Distance: 1.5898126322632284
Total norm for 6 adversaries is: 15.054168549696003. distance: 1.5898126322632284
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1404, Accuracy: 8621/8991 (95.8848%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 534/581 (91.9105%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   2,  Average loss: 0.0026, Accuracy: 553/581 (95.1807%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   3,  Average loss: 0.0024, Accuracy: 552/581 (95.0086%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   4,  Average loss: 0.0010, Accuracy: 570/581 (98.1067%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   5,  Average loss: 0.0009, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   6,  Average loss: 0.0009, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   7,  Average loss: 0.0007, Accuracy: 575/581 (98.9673%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   8,  Average loss: 0.0006, Accuracy: 575/581 (98.9673%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   9,  Average loss: 0.0006, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch  10,  Average loss: 0.0004, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Global model norm: 14.836914030361433.
Norm before scaling: 15.07592479089695. Distance: 1.5836224877526273
Total norm for 6 adversaries is: 15.07592479089695. distance: 1.5836224877526273
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1624, Accuracy: 8556/8991 (95.1618%)
time spent on training: 120.77423906326294
[foolsgold agg] training data poison_ratio: 0.6039156626506024  data num: [566, 594, 612, 637, 628, 620, 597, 539, 602, 581]
[foolsgold agg] considering poison per batch poison_fraction: 0.6039156626506024
[foolsgold agg] wv: [1.         0.85587106 1.         1.         1.         1.
 1.         0.85587106 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 0.8140, Accuracy: 8359/10000 (83.5900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 0.2301, Accuracy: 8358/8991 (92.9596%)
Done in 328.237272977829 sec.
Server Epoch:10 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0047, Accuracy: 497/555 (89.5495%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   2,  Average loss: 0.0029, Accuracy: 521/555 (93.8739%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   3,  Average loss: 0.0016, Accuracy: 542/555 (97.6577%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   4,  Average loss: 0.0012, Accuracy: 546/555 (98.3784%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   5,  Average loss: 0.0011, Accuracy: 546/555 (98.3784%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   6,  Average loss: 0.0009, Accuracy: 549/555 (98.9189%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   7,  Average loss: 0.0008, Accuracy: 550/555 (99.0991%), train_poison_data_count: 555
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   8,  Average loss: 0.0007, Accuracy: 550/555 (99.0991%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   9,  Average loss: 0.0006, Accuracy: 551/555 (99.2793%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch  10,  Average loss: 0.0006, Accuracy: 551/555 (99.2793%), train_poison_data_count: 555
Global model norm: 14.958358948808732.
Norm before scaling: 15.120735008499608. Distance: 1.6347538846231273
Total norm for 7 adversaries is: 15.120735008499608. distance: 1.6347538846231273
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1647, Accuracy: 8555/8991 (95.1507%)
___Train Local_Simple,  epoch  10, local model 56, internal_epoch   1,  Average loss: 0.0141, Accuracy: 478/586 (81.5700%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.2013, Accuracy: 6965/10000 (69.6500%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   1,  Average loss: 0.0037, Accuracy: 560/601 (93.1780%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   2,  Average loss: 0.0041, Accuracy: 559/601 (93.0116%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   3,  Average loss: 0.0023, Accuracy: 580/601 (96.5058%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   4,  Average loss: 0.0015, Accuracy: 591/601 (98.3361%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   5,  Average loss: 0.0011, Accuracy: 594/601 (98.8353%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   6,  Average loss: 0.0009, Accuracy: 595/601 (99.0017%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   7,  Average loss: 0.0008, Accuracy: 595/601 (99.0017%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   8,  Average loss: 0.0007, Accuracy: 596/601 (99.1681%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   9,  Average loss: 0.0006, Accuracy: 596/601 (99.1681%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch  10,  Average loss: 0.0007, Accuracy: 596/601 (99.1681%), train_poison_data_count: 601
Global model norm: 14.958358948808732.
Norm before scaling: 15.151008879555162. Distance: 1.6841983284947737
Total norm for 7 adversaries is: 15.151008879555162. distance: 1.6841983284947737
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1446, Accuracy: 8594/8991 (95.5845%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0037, Accuracy: 542/577 (93.9341%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   2,  Average loss: 0.0037, Accuracy: 537/577 (93.0676%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   3,  Average loss: 0.0018, Accuracy: 561/577 (97.2270%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 567/577 (98.2669%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 571/577 (98.9601%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 573/577 (99.3068%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   7,  Average loss: 0.0006, Accuracy: 573/577 (99.3068%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   8,  Average loss: 0.0005, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   9,  Average loss: 0.0005, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch  10,  Average loss: 0.0005, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Global model norm: 14.958358948808732.
Norm before scaling: 15.108287310578403. Distance: 1.5712026473916507
Total norm for 7 adversaries is: 15.108287310578403. distance: 1.5712026473916507
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1478, Accuracy: 8562/8991 (95.2286%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 581/628 (92.5159%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   2,  Average loss: 0.0027, Accuracy: 593/628 (94.4268%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   3,  Average loss: 0.0016, Accuracy: 612/628 (97.4522%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   4,  Average loss: 0.0012, Accuracy: 614/628 (97.7707%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   5,  Average loss: 0.0010, Accuracy: 618/628 (98.4076%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   6,  Average loss: 0.0008, Accuracy: 619/628 (98.5669%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   7,  Average loss: 0.0007, Accuracy: 620/628 (98.7261%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   8,  Average loss: 0.0006, Accuracy: 621/628 (98.8854%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   9,  Average loss: 0.0006, Accuracy: 622/628 (99.0446%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch  10,  Average loss: 0.0006, Accuracy: 623/628 (99.2038%), train_poison_data_count: 628
Global model norm: 14.958358948808732.
Norm before scaling: 15.157155055129389. Distance: 1.7320840499738186
Total norm for 7 adversaries is: 15.157155055129389. distance: 1.7320840499738186
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1685, Accuracy: 8533/8991 (94.9060%)
___Train Local_Simple,  epoch  10, local model 78, internal_epoch   1,  Average loss: 0.0079, Accuracy: 530/617 (85.8995%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.5160, Accuracy: 8122/10000 (81.2200%), Attack Success Rate:0/10000(0.000)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 585/637 (91.8367%), train_poison_data_count: 637
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   2,  Average loss: 0.0030, Accuracy: 601/637 (94.3485%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   3,  Average loss: 0.0015, Accuracy: 616/637 (96.7033%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   4,  Average loss: 0.0011, Accuracy: 623/637 (97.8022%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   5,  Average loss: 0.0010, Accuracy: 629/637 (98.7441%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   6,  Average loss: 0.0008, Accuracy: 631/637 (99.0581%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   7,  Average loss: 0.0007, Accuracy: 632/637 (99.2151%), train_poison_data_count: 637
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   8,  Average loss: 0.0006, Accuracy: 634/637 (99.5290%), train_poison_data_count: 637
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   9,  Average loss: 0.0005, Accuracy: 635/637 (99.6860%), train_poison_data_count: 637
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch  10,  Average loss: 0.0005, Accuracy: 635/637 (99.6860%), train_poison_data_count: 637
Global model norm: 14.958358948808732.
Norm before scaling: 15.143426940973486. Distance: 1.7647285548791933
Total norm for 7 adversaries is: 15.143426940973486. distance: 1.7647285548791933
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1570, Accuracy: 8551/8991 (95.1062%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   1,  Average loss: 0.0046, Accuracy: 542/597 (90.7873%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   2,  Average loss: 0.0031, Accuracy: 566/597 (94.8074%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   3,  Average loss: 0.0019, Accuracy: 578/597 (96.8174%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   4,  Average loss: 0.0012, Accuracy: 583/597 (97.6549%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   5,  Average loss: 0.0009, Accuracy: 586/597 (98.1575%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   6,  Average loss: 0.0008, Accuracy: 588/597 (98.4925%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   7,  Average loss: 0.0007, Accuracy: 592/597 (99.1625%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   8,  Average loss: 0.0006, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   9,  Average loss: 0.0005, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch  10,  Average loss: 0.0005, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Global model norm: 14.958358948808732.
Norm before scaling: 15.174418777320342. Distance: 1.7932903857329565
Total norm for 7 adversaries is: 15.174418777320342. distance: 1.7932903857329565
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1594, Accuracy: 8566/8991 (95.2731%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0041, Accuracy: 551/594 (92.7609%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   2,  Average loss: 0.0026, Accuracy: 567/594 (95.4545%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   3,  Average loss: 0.0013, Accuracy: 582/594 (97.9798%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   4,  Average loss: 0.0009, Accuracy: 586/594 (98.6532%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   5,  Average loss: 0.0008, Accuracy: 586/594 (98.6532%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   6,  Average loss: 0.0007, Accuracy: 588/594 (98.9899%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   7,  Average loss: 0.0006, Accuracy: 588/594 (98.9899%), train_poison_data_count: 594
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   8,  Average loss: 0.0006, Accuracy: 589/594 (99.1582%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   9,  Average loss: 0.0005, Accuracy: 589/594 (99.1582%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch  10,  Average loss: 0.0005, Accuracy: 589/594 (99.1582%), train_poison_data_count: 594
Global model norm: 14.958358948808732.
Norm before scaling: 15.186633426762732. Distance: 1.8951851571647937
Total norm for 7 adversaries is: 15.186633426762732. distance: 1.8951851571647937
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1500, Accuracy: 8582/8991 (95.4510%)
___Train Local_Simple,  epoch  10, local model 99, internal_epoch   1,  Average loss: 0.0021, Accuracy: 392/408 (96.0784%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.0901, Accuracy: 6465/10000 (64.6500%), Attack Success Rate:0/10000(0.000)
time spent on training: 195.18352603912354
[foolsgold agg] training data poison_ratio: 0.7222413793103448  data num: [555, 586, 601, 577, 628, 617, 637, 597, 594, 408]
[foolsgold agg] considering poison per batch poison_fraction: 0.7222413793103448
[foolsgold agg] wv: [1.         1.         1.         1.         0.58007195 1.
 1.         1.         0.58007195 1.        ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 1.0804, Accuracy: 8322/10000 (83.2200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 0.2783, Accuracy: 8315/8991 (92.4814%)
Done in 434.34415674209595 sec.
Server Epoch:11 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
___Train Local_Simple,  epoch  11, local model 53, internal_epoch   1,  Average loss: 0.0129, Accuracy: 447/568 (78.6972%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3843, Accuracy: 8791/10000 (87.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 56, internal_epoch   1,  Average loss: 0.0083, Accuracy: 508/586 (86.6894%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3720, Accuracy: 8770/10000 (87.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0105, Accuracy: 498/602 (82.7243%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2628, Accuracy: 9139/10000 (91.3900%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0045, Accuracy: 552/594 (92.9293%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   2,  Average loss: 0.0048, Accuracy: 539/594 (90.7407%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   3,  Average loss: 0.0023, Accuracy: 577/594 (97.1380%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   4,  Average loss: 0.0016, Accuracy: 585/594 (98.4848%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   5,  Average loss: 0.0014, Accuracy: 584/594 (98.3165%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   6,  Average loss: 0.0013, Accuracy: 586/594 (98.6532%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   7,  Average loss: 0.0008, Accuracy: 587/594 (98.8215%), train_poison_data_count: 594
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   8,  Average loss: 0.0008, Accuracy: 587/594 (98.8215%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   9,  Average loss: 0.0008, Accuracy: 587/594 (98.8215%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch  10,  Average loss: 0.0007, Accuracy: 587/594 (98.8215%), train_poison_data_count: 594
Global model norm: 15.086091240801284.
Norm before scaling: 15.307207212661858. Distance: 2.352393019510857
Total norm for 5 adversaries is: 15.307207212661858. distance: 2.352393019510857
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1598, Accuracy: 8538/8991 (94.9616%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   1,  Average loss: 0.0046, Accuracy: 555/601 (92.3461%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   2,  Average loss: 0.0030, Accuracy: 573/601 (95.3411%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   3,  Average loss: 0.0018, Accuracy: 583/601 (97.0050%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   4,  Average loss: 0.0012, Accuracy: 586/601 (97.5042%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   5,  Average loss: 0.0010, Accuracy: 588/601 (97.8369%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   6,  Average loss: 0.0008, Accuracy: 592/601 (98.5025%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   7,  Average loss: 0.0007, Accuracy: 596/601 (99.1681%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   8,  Average loss: 0.0006, Accuracy: 597/601 (99.3344%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   9,  Average loss: 0.0005, Accuracy: 598/601 (99.5008%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch  10,  Average loss: 0.0006, Accuracy: 598/601 (99.5008%), train_poison_data_count: 601
Global model norm: 15.086091240801284.
Norm before scaling: 15.231195581688795. Distance: 1.8311904246563626
Total norm for 5 adversaries is: 15.231195581688795. distance: 1.8311904246563626
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1469, Accuracy: 8582/8991 (95.4510%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 550/609 (90.3120%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   2,  Average loss: 0.0034, Accuracy: 573/609 (94.0887%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   3,  Average loss: 0.0018, Accuracy: 587/609 (96.3875%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   4,  Average loss: 0.0010, Accuracy: 603/609 (99.0148%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   5,  Average loss: 0.0009, Accuracy: 602/609 (98.8506%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   6,  Average loss: 0.0007, Accuracy: 606/609 (99.5074%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   7,  Average loss: 0.0006, Accuracy: 607/609 (99.6716%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   8,  Average loss: 0.0005, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   9,  Average loss: 0.0004, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch  10,  Average loss: 0.0004, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Global model norm: 15.086091240801284.
Norm before scaling: 15.35703772828881. Distance: 2.276772900286179
Total norm for 5 adversaries is: 15.35703772828881. distance: 2.276772900286179
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1503, Accuracy: 8575/8991 (95.3732%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0043, Accuracy: 563/609 (92.4466%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   2,  Average loss: 0.0041, Accuracy: 565/609 (92.7750%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   3,  Average loss: 0.0021, Accuracy: 589/609 (96.7159%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   4,  Average loss: 0.0014, Accuracy: 598/609 (98.1938%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   5,  Average loss: 0.0012, Accuracy: 601/609 (98.6864%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   6,  Average loss: 0.0009, Accuracy: 602/609 (98.8506%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   7,  Average loss: 0.0008, Accuracy: 602/609 (98.8506%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   8,  Average loss: 0.0007, Accuracy: 604/609 (99.1790%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   9,  Average loss: 0.0006, Accuracy: 606/609 (99.5074%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch  10,  Average loss: 0.0006, Accuracy: 606/609 (99.5074%), train_poison_data_count: 609
Global model norm: 15.086091240801284.
Norm before scaling: 15.292828064486992. Distance: 2.1838902799272546
Total norm for 5 adversaries is: 15.292828064486992. distance: 2.1838902799272546
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1436, Accuracy: 8565/8991 (95.2619%)
___Train Local_Simple,  epoch  11, local model 99, internal_epoch   1,  Average loss: 0.0019, Accuracy: 390/408 (95.5882%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.8910, Accuracy: 6716/10000 (67.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 88, internal_epoch   1,  Average loss: 0.0100, Accuracy: 457/560 (81.6071%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3753, Accuracy: 9119/10000 (91.1900%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0042, Accuracy: 550/601 (91.5141%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   2,  Average loss: 0.0026, Accuracy: 570/601 (94.8419%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   3,  Average loss: 0.0011, Accuracy: 589/601 (98.0033%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   4,  Average loss: 0.0008, Accuracy: 595/601 (99.0017%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   5,  Average loss: 0.0006, Accuracy: 597/601 (99.3344%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   6,  Average loss: 0.0005, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   7,  Average loss: 0.0004, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   8,  Average loss: 0.0004, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   9,  Average loss: 0.0003, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch  10,  Average loss: 0.0003, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Global model norm: 15.086091240801284.
Norm before scaling: 15.307639833765146. Distance: 1.9928882637953556
Total norm for 5 adversaries is: 15.307639833765146. distance: 1.9928882637953556
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1415, Accuracy: 8600/8991 (95.6512%)
time spent on training: 135.62106490135193
[foolsgold agg] training data poison_ratio: 0.5252701289647961  data num: [568, 586, 602, 594, 601, 609, 609, 408, 560, 601]
[foolsgold agg] considering poison per batch poison_fraction: 0.5252701289647961
[foolsgold agg] wv: [1.         0.80027779 0.80027779 0.67294626 0.67294626 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 1.1195, Accuracy: 8424/10000 (84.2400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 0.2617, Accuracy: 8410/8991 (93.5380%)
Done in 442.0394642353058 sec.
Server Epoch:12 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 597/646 (92.4149%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   2,  Average loss: 0.0025, Accuracy: 616/646 (95.3560%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   3,  Average loss: 0.0018, Accuracy: 623/646 (96.4396%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   4,  Average loss: 0.0010, Accuracy: 635/646 (98.2972%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   5,  Average loss: 0.0009, Accuracy: 638/646 (98.7616%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   6,  Average loss: 0.0007, Accuracy: 640/646 (99.0712%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   7,  Average loss: 0.0008, Accuracy: 640/646 (99.0712%), train_poison_data_count: 646
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   8,  Average loss: 0.0006, Accuracy: 638/646 (98.7616%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   9,  Average loss: 0.0005, Accuracy: 641/646 (99.2260%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch  10,  Average loss: 0.0005, Accuracy: 641/646 (99.2260%), train_poison_data_count: 646
Global model norm: 15.189567519379255.
Norm before scaling: 15.37649454435751. Distance: 2.112005444483531
Total norm for 8 adversaries is: 15.37649454435751. distance: 2.112005444483531
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1660, Accuracy: 8561/8991 (95.2174%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   1,  Average loss: 0.0028, Accuracy: 541/579 (93.4370%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   2,  Average loss: 0.0021, Accuracy: 549/579 (94.8187%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   3,  Average loss: 0.0016, Accuracy: 561/579 (96.8912%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   4,  Average loss: 0.0009, Accuracy: 573/579 (98.9637%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   5,  Average loss: 0.0006, Accuracy: 575/579 (99.3092%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   6,  Average loss: 0.0005, Accuracy: 575/579 (99.3092%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   7,  Average loss: 0.0004, Accuracy: 576/579 (99.4819%), train_poison_data_count: 579
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   8,  Average loss: 0.0007, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   9,  Average loss: 0.0003, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch  10,  Average loss: 0.0003, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Global model norm: 15.189567519379255.
Norm before scaling: 15.32672131378622. Distance: 1.7711899417017847
Total norm for 8 adversaries is: 15.32672131378622. distance: 1.7711899417017847
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1696, Accuracy: 8537/8991 (94.9505%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0058, Accuracy: 542/585 (92.6496%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   2,  Average loss: 0.0070, Accuracy: 520/585 (88.8889%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   3,  Average loss: 0.0031, Accuracy: 557/585 (95.2137%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   4,  Average loss: 0.0017, Accuracy: 573/585 (97.9487%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   5,  Average loss: 0.0014, Accuracy: 577/585 (98.6325%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   6,  Average loss: 0.0010, Accuracy: 578/585 (98.8034%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   7,  Average loss: 0.0008, Accuracy: 581/585 (99.3162%), train_poison_data_count: 585
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   8,  Average loss: 0.0007, Accuracy: 583/585 (99.6581%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   9,  Average loss: 0.0006, Accuracy: 583/585 (99.6581%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch  10,  Average loss: 0.0006, Accuracy: 583/585 (99.6581%), train_poison_data_count: 585
Global model norm: 15.189567519379255.
Norm before scaling: 15.569560827628838. Distance: 2.991619484475353
Total norm for 8 adversaries is: 15.569560827628838. distance: 2.991619484475353
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1709, Accuracy: 8555/8991 (95.1507%)
___Train Local_Simple,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0098, Accuracy: 497/610 (81.4754%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.5046, Accuracy: 8317/10000 (83.1700%), Attack Success Rate:0/10000(0.000)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 566/609 (92.9392%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   2,  Average loss: 0.0029, Accuracy: 575/609 (94.4171%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   3,  Average loss: 0.0016, Accuracy: 594/609 (97.5369%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   4,  Average loss: 0.0010, Accuracy: 604/609 (99.1790%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   5,  Average loss: 0.0007, Accuracy: 607/609 (99.6716%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   6,  Average loss: 0.0005, Accuracy: 607/609 (99.6716%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   7,  Average loss: 0.0004, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   8,  Average loss: 0.0004, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   9,  Average loss: 0.0003, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch  10,  Average loss: 0.0004, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Global model norm: 15.189567519379255.
Norm before scaling: 15.375103709793768. Distance: 2.0184553515939294
Total norm for 8 adversaries is: 15.375103709793768. distance: 2.0184553515939294
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1449, Accuracy: 8608/8991 (95.7402%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   1,  Average loss: 0.0061, Accuracy: 540/584 (92.4658%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   2,  Average loss: 0.0055, Accuracy: 530/584 (90.7534%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   3,  Average loss: 0.0022, Accuracy: 566/584 (96.9178%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   4,  Average loss: 0.0014, Accuracy: 571/584 (97.7740%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   5,  Average loss: 0.0011, Accuracy: 573/584 (98.1164%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   6,  Average loss: 0.0010, Accuracy: 577/584 (98.8014%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   7,  Average loss: 0.0007, Accuracy: 581/584 (99.4863%), train_poison_data_count: 584
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   8,  Average loss: 0.0007, Accuracy: 581/584 (99.4863%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   9,  Average loss: 0.0009, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch  10,  Average loss: 0.0005, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Global model norm: 15.189567519379255.
Norm before scaling: 15.46567154894869. Distance: 2.715753328827176
Total norm for 8 adversaries is: 15.46567154894869. distance: 2.715753328827176
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1495, Accuracy: 8555/8991 (95.1507%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0035, Accuracy: 562/601 (93.5108%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   2,  Average loss: 0.0027, Accuracy: 572/601 (95.1747%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   3,  Average loss: 0.0023, Accuracy: 577/601 (96.0067%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   4,  Average loss: 0.0012, Accuracy: 590/601 (98.1697%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   5,  Average loss: 0.0008, Accuracy: 597/601 (99.3344%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   6,  Average loss: 0.0006, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   7,  Average loss: 0.0005, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   8,  Average loss: 0.0004, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   9,  Average loss: 0.0004, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch  10,  Average loss: 0.0004, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Global model norm: 15.189567519379255.
Norm before scaling: 15.366180619657491. Distance: 1.8880871850993473
Total norm for 8 adversaries is: 15.366180619657491. distance: 1.8880871850993473
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1432, Accuracy: 8579/8991 (95.4176%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   1,  Average loss: 0.0061, Accuracy: 550/608 (90.4605%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   2,  Average loss: 0.0050, Accuracy: 552/608 (90.7895%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   3,  Average loss: 0.0021, Accuracy: 586/608 (96.3816%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   4,  Average loss: 0.0017, Accuracy: 592/608 (97.3684%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   5,  Average loss: 0.0015, Accuracy: 594/608 (97.6974%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   6,  Average loss: 0.0015, Accuracy: 597/608 (98.1908%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   7,  Average loss: 0.0011, Accuracy: 599/608 (98.5197%), train_poison_data_count: 608
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   8,  Average loss: 0.0011, Accuracy: 601/608 (98.8487%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   9,  Average loss: 0.0009, Accuracy: 603/608 (99.1776%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch  10,  Average loss: 0.0009, Accuracy: 603/608 (99.1776%), train_poison_data_count: 608
Global model norm: 15.189567519379255.
Norm before scaling: 15.45044045422305. Distance: 2.3934193156142167
Total norm for 8 adversaries is: 15.45044045422305. distance: 2.3934193156142167
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1414, Accuracy: 8578/8991 (95.4065%)
___Train Local_Simple,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0084, Accuracy: 482/565 (85.3097%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3841, Accuracy: 8854/10000 (88.5400%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0028, Accuracy: 588/621 (94.6860%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   2,  Average loss: 0.0020, Accuracy: 599/621 (96.4573%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   3,  Average loss: 0.0011, Accuracy: 609/621 (98.0676%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   4,  Average loss: 0.0007, Accuracy: 616/621 (99.1948%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   5,  Average loss: 0.0005, Accuracy: 619/621 (99.6779%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   6,  Average loss: 0.0004, Accuracy: 619/621 (99.6779%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   7,  Average loss: 0.0003, Accuracy: 619/621 (99.6779%), train_poison_data_count: 621
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   8,  Average loss: 0.0002, Accuracy: 620/621 (99.8390%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   9,  Average loss: 0.0002, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch  10,  Average loss: 0.0002, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Global model norm: 15.189567519379255.
Norm before scaling: 15.320387198632273. Distance: 1.7467949673193397
Total norm for 8 adversaries is: 15.320387198632273. distance: 1.7467949673193397
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1493, Accuracy: 8580/8991 (95.4288%)
time spent on training: 175.33434200286865
[foolsgold agg] training data poison_ratio: 0.804427430093209  data num: [646, 579, 585, 610, 609, 584, 601, 608, 565, 621]
[foolsgold agg] considering poison per batch poison_fraction: 0.804427430093209
[foolsgold agg] wv: [0.68681989 1.         1.         1.         1.         1.
 0.68681989 0.8092471  1.         0.8092471 ]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.4941, Accuracy: 8469/10000 (84.6900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 0.2803, Accuracy: 8462/8991 (94.1163%)
Done in 485.5864760875702 sec.
Server Epoch:13 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0078, Accuracy: 535/603 (88.7231%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   2,  Average loss: 0.0053, Accuracy: 558/603 (92.5373%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   3,  Average loss: 0.0031, Accuracy: 572/603 (94.8590%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   4,  Average loss: 0.0021, Accuracy: 584/603 (96.8491%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   5,  Average loss: 0.0017, Accuracy: 583/603 (96.6833%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   6,  Average loss: 0.0015, Accuracy: 585/603 (97.0149%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   7,  Average loss: 0.0012, Accuracy: 589/603 (97.6783%), train_poison_data_count: 603
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   8,  Average loss: 0.0010, Accuracy: 593/603 (98.3416%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   9,  Average loss: 0.0009, Accuracy: 595/603 (98.6733%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch  10,  Average loss: 0.0009, Accuracy: 595/603 (98.6733%), train_poison_data_count: 603
Global model norm: 15.353679978806435.
Norm before scaling: 15.838859209538114. Distance: 3.503658834544516
Total norm for 6 adversaries is: 15.838859209538114. distance: 3.503658834544516
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1848, Accuracy: 8504/8991 (94.5835%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   1,  Average loss: 0.0069, Accuracy: 529/584 (90.5822%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   2,  Average loss: 0.0074, Accuracy: 523/584 (89.5548%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   3,  Average loss: 0.0022, Accuracy: 568/584 (97.2603%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   4,  Average loss: 0.0017, Accuracy: 574/584 (98.2877%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   5,  Average loss: 0.0013, Accuracy: 580/584 (99.3151%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   6,  Average loss: 0.0008, Accuracy: 580/584 (99.3151%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   7,  Average loss: 0.0007, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   8,  Average loss: 0.0006, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   9,  Average loss: 0.0005, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch  10,  Average loss: 0.0005, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Global model norm: 15.353679978806435.
Norm before scaling: 15.791624258717519. Distance: 3.3572649339319183
Total norm for 6 adversaries is: 15.791624258717519. distance: 3.3572649339319183
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1749, Accuracy: 8508/8991 (94.6280%)
___Train Local_Simple,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0114, Accuracy: 488/598 (81.6054%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4633, Accuracy: 8634/10000 (86.3400%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0060, Accuracy: 581/635 (91.4961%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 590/635 (92.9134%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   3,  Average loss: 0.0039, Accuracy: 587/635 (92.4409%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   4,  Average loss: 0.0021, Accuracy: 618/635 (97.3228%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   5,  Average loss: 0.0016, Accuracy: 623/635 (98.1102%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   6,  Average loss: 0.0013, Accuracy: 624/635 (98.2677%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   7,  Average loss: 0.0011, Accuracy: 627/635 (98.7402%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   8,  Average loss: 0.0009, Accuracy: 629/635 (99.0551%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   9,  Average loss: 0.0008, Accuracy: 630/635 (99.2126%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch  10,  Average loss: 0.0008, Accuracy: 630/635 (99.2126%), train_poison_data_count: 635
Global model norm: 15.353679978806435.
Norm before scaling: 15.57548649060264. Distance: 2.7357882961718634
Total norm for 6 adversaries is: 15.57548649060264. distance: 2.7357882961718634
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1417, Accuracy: 8598/8991 (95.6290%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0058, Accuracy: 524/577 (90.8146%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   2,  Average loss: 0.0029, Accuracy: 544/577 (94.2808%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   3,  Average loss: 0.0019, Accuracy: 564/577 (97.7470%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 569/577 (98.6135%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   7,  Average loss: 0.0006, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   8,  Average loss: 0.0005, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   9,  Average loss: 0.0005, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch  10,  Average loss: 0.0004, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Global model norm: 15.353679978806435.
Norm before scaling: 15.600285141124024. Distance: 2.7336436138200515
Total norm for 6 adversaries is: 15.600285141124024. distance: 2.7336436138200515
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1564, Accuracy: 8548/8991 (95.0729%)
___Train Local_Simple,  epoch  13, local model 76, internal_epoch   1,  Average loss: 0.0126, Accuracy: 495/597 (82.9146%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4122, Accuracy: 8860/10000 (88.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 97, internal_epoch   1,  Average loss: 0.0233, Accuracy: 392/539 (72.7273%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.9347, Accuracy: 7473/10000 (74.7300%), Attack Success Rate:0/10000(0.000)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0095, Accuracy: 497/570 (87.1930%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   2,  Average loss: 0.0046, Accuracy: 535/570 (93.8596%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   3,  Average loss: 0.0023, Accuracy: 544/570 (95.4386%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   4,  Average loss: 0.0016, Accuracy: 553/570 (97.0175%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   5,  Average loss: 0.0013, Accuracy: 557/570 (97.7193%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   6,  Average loss: 0.0011, Accuracy: 559/570 (98.0702%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   7,  Average loss: 0.0010, Accuracy: 562/570 (98.5965%), train_poison_data_count: 570
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   8,  Average loss: 0.0009, Accuracy: 562/570 (98.5965%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   9,  Average loss: 0.0008, Accuracy: 563/570 (98.7719%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch  10,  Average loss: 0.0007, Accuracy: 565/570 (99.1228%), train_poison_data_count: 570
Global model norm: 15.353679978806435.
Norm before scaling: 15.849391196318718. Distance: 3.565297283387895
Total norm for 6 adversaries is: 15.849391196318718. distance: 3.565297283387895
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1883, Accuracy: 8476/8991 (94.2720%)
___Train Local_Simple,  epoch  13, local model 70, internal_epoch   1,  Average loss: 0.0137, Accuracy: 498/610 (81.6393%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5618, Accuracy: 8384/10000 (83.8400%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 552/594 (92.9293%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 545/594 (91.7508%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   3,  Average loss: 0.0026, Accuracy: 565/594 (95.1178%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   4,  Average loss: 0.0014, Accuracy: 581/594 (97.8114%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   5,  Average loss: 0.0011, Accuracy: 584/594 (98.3165%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   6,  Average loss: 0.0008, Accuracy: 588/594 (98.9899%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   7,  Average loss: 0.0007, Accuracy: 589/594 (99.1582%), train_poison_data_count: 594
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   8,  Average loss: 0.0006, Accuracy: 589/594 (99.1582%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   9,  Average loss: 0.0006, Accuracy: 590/594 (99.3266%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch  10,  Average loss: 0.0005, Accuracy: 590/594 (99.3266%), train_poison_data_count: 594
Global model norm: 15.353679978806435.
Norm before scaling: 15.512314857281789. Distance: 2.526261299783765
Total norm for 6 adversaries is: 15.512314857281789. distance: 2.526261299783765
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1346, Accuracy: 8609/8991 (95.7513%)
time spent on training: 187.80677914619446
[foolsgold agg] training data poison_ratio: 0.6031826646351786  data num: [603, 584, 598, 635, 577, 597, 539, 570, 610, 594]
[foolsgold agg] considering poison per batch poison_fraction: 0.6031826646351786
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.6527, Accuracy: 8425/10000 (84.2500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 0.3429, Accuracy: 8439/8991 (93.8605%)
Done in 473.0593378543854 sec.
Server Epoch:14 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0123, Accuracy: 442/549 (80.5100%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9992, Accuracy: 7680/10000 (76.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 97, internal_epoch   1,  Average loss: 0.0165, Accuracy: 437/539 (81.0761%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0132, Accuracy: 7370/10000 (73.7000%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0106, Accuracy: 487/555 (87.7477%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   2,  Average loss: 0.0091, Accuracy: 469/555 (84.5045%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   3,  Average loss: 0.0041, Accuracy: 510/555 (91.8919%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   4,  Average loss: 0.0029, Accuracy: 523/555 (94.2342%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   5,  Average loss: 0.0023, Accuracy: 528/555 (95.1351%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   6,  Average loss: 0.0020, Accuracy: 534/555 (96.2162%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   7,  Average loss: 0.0017, Accuracy: 541/555 (97.4775%), train_poison_data_count: 555
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   8,  Average loss: 0.0015, Accuracy: 541/555 (97.4775%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   9,  Average loss: 0.0013, Accuracy: 542/555 (97.6577%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch  10,  Average loss: 0.0013, Accuracy: 542/555 (97.6577%), train_poison_data_count: 555
Global model norm: 15.538145319211605.
Norm before scaling: 16.12951691520762. Distance: 4.205974988180064
Total norm for 4 adversaries is: 16.12951691520762. distance: 4.205974988180064
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1824, Accuracy: 8509/8991 (94.6391%)
___Train Local_Simple,  epoch  14, local model 89, internal_epoch   1,  Average loss: 0.0092, Accuracy: 507/594 (85.3535%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.5562, Accuracy: 8466/10000 (84.6600%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0041, Accuracy: 545/581 (93.8038%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   2,  Average loss: 0.0019, Accuracy: 557/581 (95.8692%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   3,  Average loss: 0.0020, Accuracy: 551/581 (94.8365%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   4,  Average loss: 0.0006, Accuracy: 576/581 (99.1394%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   5,  Average loss: 0.0005, Accuracy: 577/581 (99.3115%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   6,  Average loss: 0.0004, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   7,  Average loss: 0.0003, Accuracy: 580/581 (99.8279%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   8,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   9,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch  10,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 15.538145319211605.
Norm before scaling: 15.613753276577542. Distance: 2.2259832331393534
Total norm for 4 adversaries is: 15.613753276577542. distance: 2.2259832331393534
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1375, Accuracy: 8619/8991 (95.8625%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   1,  Average loss: 0.0088, Accuracy: 533/597 (89.2797%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   2,  Average loss: 0.0056, Accuracy: 544/597 (91.1223%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   3,  Average loss: 0.0021, Accuracy: 577/597 (96.6499%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   4,  Average loss: 0.0016, Accuracy: 581/597 (97.3199%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   5,  Average loss: 0.0013, Accuracy: 584/597 (97.8224%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   6,  Average loss: 0.0010, Accuracy: 586/597 (98.1575%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   7,  Average loss: 0.0009, Accuracy: 587/597 (98.3250%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   8,  Average loss: 0.0007, Accuracy: 589/597 (98.6600%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   9,  Average loss: 0.0007, Accuracy: 590/597 (98.8275%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch  10,  Average loss: 0.0007, Accuracy: 591/597 (98.9950%), train_poison_data_count: 597
Global model norm: 15.538145319211605.
Norm before scaling: 16.01539633983109. Distance: 3.671746304468412
Total norm for 4 adversaries is: 16.01539633983109. distance: 3.671746304468412
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1745, Accuracy: 8534/8991 (94.9171%)
___Train Local_Simple,  epoch  14, local model 55, internal_epoch   1,  Average loss: 0.0133, Accuracy: 482/595 (81.0084%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4848, Accuracy: 8539/10000 (85.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 67, internal_epoch   1,  Average loss: 0.0144, Accuracy: 458/570 (80.3509%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.5355, Accuracy: 8328/10000 (83.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0226, Accuracy: 465/586 (79.3515%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.7238, Accuracy: 7919/10000 (79.1900%), Attack Success Rate:0/10000(0.000)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0078, Accuracy: 537/585 (91.7949%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   2,  Average loss: 0.0058, Accuracy: 534/585 (91.2821%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   3,  Average loss: 0.0038, Accuracy: 546/585 (93.3333%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   4,  Average loss: 0.0019, Accuracy: 573/585 (97.9487%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   5,  Average loss: 0.0013, Accuracy: 578/585 (98.8034%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   6,  Average loss: 0.0011, Accuracy: 582/585 (99.4872%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   7,  Average loss: 0.0009, Accuracy: 583/585 (99.6581%), train_poison_data_count: 585
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   8,  Average loss: 0.0006, Accuracy: 582/585 (99.4872%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   9,  Average loss: 0.0006, Accuracy: 583/585 (99.6581%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch  10,  Average loss: 0.0007, Accuracy: 583/585 (99.6581%), train_poison_data_count: 585
Global model norm: 15.538145319211605.
Norm before scaling: 15.848198802180566. Distance: 3.2224106203739504
Total norm for 4 adversaries is: 15.848198802180566. distance: 3.2224106203739504
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1369, Accuracy: 8611/8991 (95.7736%)
time spent on training: 107.02375912666321
[foolsgold agg] training data poison_ratio: 0.4030603373326378  data num: [549, 539, 555, 594, 581, 597, 595, 570, 586, 585]
[foolsgold agg] considering poison per batch poison_fraction: 0.4030603373326378
[foolsgold agg] wv: [1.         0.8781922  1.         1.         0.86257789 1.
 1.         0.09280426 0.09280426 0.86257789]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.4184, Accuracy: 8522/10000 (85.2200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.2888, Accuracy: 8530/8991 (94.8727%)
Done in 388.70803928375244 sec.
Server Epoch:15 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 572/621 (92.1095%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   2,  Average loss: 0.0023, Accuracy: 593/621 (95.4911%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   3,  Average loss: 0.0014, Accuracy: 607/621 (97.7456%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   4,  Average loss: 0.0010, Accuracy: 615/621 (99.0338%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   5,  Average loss: 0.0007, Accuracy: 620/621 (99.8390%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   6,  Average loss: 0.0005, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   7,  Average loss: 0.0004, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   8,  Average loss: 0.0003, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   9,  Average loss: 0.0003, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch  10,  Average loss: 0.0003, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Global model norm: 15.642806260237084.
Norm before scaling: 15.853616084172593. Distance: 2.7633109028837297
Total norm for 7 adversaries is: 15.853616084172593. distance: 2.7633109028837297
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1368, Accuracy: 8619/8991 (95.8625%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0102, Accuracy: 534/600 (89.0000%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   2,  Average loss: 0.0069, Accuracy: 534/600 (89.0000%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   3,  Average loss: 0.0037, Accuracy: 566/600 (94.3333%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   4,  Average loss: 0.0024, Accuracy: 577/600 (96.1667%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   5,  Average loss: 0.0019, Accuracy: 582/600 (97.0000%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   6,  Average loss: 0.0016, Accuracy: 585/600 (97.5000%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   7,  Average loss: 0.0014, Accuracy: 587/600 (97.8333%), train_poison_data_count: 600
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   8,  Average loss: 0.0012, Accuracy: 590/600 (98.3333%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   9,  Average loss: 0.0011, Accuracy: 590/600 (98.3333%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch  10,  Average loss: 0.0011, Accuracy: 590/600 (98.3333%), train_poison_data_count: 600
Global model norm: 15.642806260237084.
Norm before scaling: 16.03808448065397. Distance: 3.7273835051540685
Total norm for 7 adversaries is: 16.03808448065397. distance: 3.7273835051540685
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1287, Accuracy: 8629/8991 (95.9738%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   1,  Average loss: 0.0059, Accuracy: 547/588 (93.0272%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   2,  Average loss: 0.0039, Accuracy: 547/588 (93.0272%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   3,  Average loss: 0.0022, Accuracy: 564/588 (95.9184%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   4,  Average loss: 0.0013, Accuracy: 580/588 (98.6395%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   5,  Average loss: 0.0009, Accuracy: 584/588 (99.3197%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   6,  Average loss: 0.0007, Accuracy: 585/588 (99.4898%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   7,  Average loss: 0.0005, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   8,  Average loss: 0.0005, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   9,  Average loss: 0.0004, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch  10,  Average loss: 0.0004, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 15.642806260237084.
Norm before scaling: 15.829114063989218. Distance: 2.8165283176671934
Total norm for 7 adversaries is: 15.829114063989218. distance: 2.8165283176671934
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1367, Accuracy: 8627/8991 (95.9515%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   1,  Average loss: 0.0049, Accuracy: 541/573 (94.4154%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 541/573 (94.4154%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   3,  Average loss: 0.0028, Accuracy: 542/573 (94.5899%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   4,  Average loss: 0.0015, Accuracy: 559/573 (97.5567%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   5,  Average loss: 0.0010, Accuracy: 568/573 (99.1274%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   6,  Average loss: 0.0008, Accuracy: 570/573 (99.4764%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   7,  Average loss: 0.0007, Accuracy: 570/573 (99.4764%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   8,  Average loss: 0.0006, Accuracy: 570/573 (99.4764%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   9,  Average loss: 0.0005, Accuracy: 571/573 (99.6510%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch  10,  Average loss: 0.0005, Accuracy: 571/573 (99.6510%), train_poison_data_count: 573
Global model norm: 15.642806260237084.
Norm before scaling: 15.75016179077367. Distance: 2.3079179268364243
Total norm for 7 adversaries is: 15.75016179077367. distance: 2.3079179268364243
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1251, Accuracy: 8637/8991 (96.0627%)
___Train Local_Simple,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0111, Accuracy: 493/595 (82.8571%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3433, Accuracy: 9057/10000 (90.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 98, internal_epoch   1,  Average loss: 0.0075, Accuracy: 442/499 (88.5772%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8869, Accuracy: 8225/10000 (82.2500%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   1,  Average loss: 0.0066, Accuracy: 551/597 (92.2948%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   2,  Average loss: 0.0054, Accuracy: 543/597 (90.9548%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   3,  Average loss: 0.0041, Accuracy: 556/597 (93.1323%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   4,  Average loss: 0.0022, Accuracy: 582/597 (97.4874%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   5,  Average loss: 0.0014, Accuracy: 585/597 (97.9899%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   6,  Average loss: 0.0011, Accuracy: 586/597 (98.1575%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   7,  Average loss: 0.0008, Accuracy: 588/597 (98.4925%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   8,  Average loss: 0.0007, Accuracy: 590/597 (98.8275%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   9,  Average loss: 0.0006, Accuracy: 594/597 (99.4975%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch  10,  Average loss: 0.0006, Accuracy: 594/597 (99.4975%), train_poison_data_count: 597
Global model norm: 15.642806260237084.
Norm before scaling: 15.822715866827153. Distance: 2.9421533291899284
Total norm for 7 adversaries is: 15.822715866827153. distance: 2.9421533291899284
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1567, Accuracy: 8561/8991 (95.2174%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0050, Accuracy: 601/646 (93.0341%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   2,  Average loss: 0.0029, Accuracy: 605/646 (93.6533%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   3,  Average loss: 0.0029, Accuracy: 615/646 (95.2012%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   4,  Average loss: 0.0015, Accuracy: 627/646 (97.0588%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   5,  Average loss: 0.0011, Accuracy: 636/646 (98.4520%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   6,  Average loss: 0.0008, Accuracy: 637/646 (98.6068%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   7,  Average loss: 0.0007, Accuracy: 642/646 (99.3808%), train_poison_data_count: 646
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   8,  Average loss: 0.0006, Accuracy: 643/646 (99.5356%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   9,  Average loss: 0.0005, Accuracy: 643/646 (99.5356%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch  10,  Average loss: 0.0006, Accuracy: 643/646 (99.5356%), train_poison_data_count: 646
Global model norm: 15.642806260237084.
Norm before scaling: 15.834935853404817. Distance: 2.8568806425751165
Total norm for 7 adversaries is: 15.834935853404817. distance: 2.8568806425751165
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1310, Accuracy: 8628/8991 (95.9626%)
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0109, Accuracy: 502/598 (83.9465%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4659, Accuracy: 8960/10000 (89.6000%), Attack Success Rate:0/10000(0.000)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   1,  Average loss: 0.0077, Accuracy: 553/608 (90.9539%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   2,  Average loss: 0.0049, Accuracy: 553/608 (90.9539%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   3,  Average loss: 0.0029, Accuracy: 576/608 (94.7368%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   4,  Average loss: 0.0020, Accuracy: 588/608 (96.7105%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   5,  Average loss: 0.0017, Accuracy: 595/608 (97.8618%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   6,  Average loss: 0.0014, Accuracy: 596/608 (98.0263%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   7,  Average loss: 0.0012, Accuracy: 599/608 (98.5197%), train_poison_data_count: 608
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   8,  Average loss: 0.0010, Accuracy: 600/608 (98.6842%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   9,  Average loss: 0.0009, Accuracy: 600/608 (98.6842%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch  10,  Average loss: 0.0010, Accuracy: 600/608 (98.6842%), train_poison_data_count: 608
Global model norm: 15.642806260237084.
Norm before scaling: 15.879816240837721. Distance: 3.084180114216534
Total norm for 7 adversaries is: 15.879816240837721. distance: 3.084180114216534
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1363, Accuracy: 8599/8991 (95.6401%)
time spent on training: 189.2472312450409
[foolsgold agg] training data poison_ratio: 0.7144303797468354  data num: [621, 600, 588, 573, 595, 499, 597, 646, 598, 608]
[foolsgold agg] considering poison per batch poison_fraction: 0.7144303797468354
[foolsgold agg] wv: [0.74589833 1.         1.         1.         1.         1.
 1.         1.         1.         0.74589833]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 1.8941, Accuracy: 8460/10000 (84.6000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.3631, Accuracy: 8508/8991 (94.6280%)
Done in 488.6180307865143 sec.
Server Epoch:16 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0057, Accuracy: 541/581 (93.1153%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   2,  Average loss: 0.0048, Accuracy: 540/581 (92.9432%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   3,  Average loss: 0.0030, Accuracy: 555/581 (95.5250%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   4,  Average loss: 0.0013, Accuracy: 571/581 (98.2788%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   5,  Average loss: 0.0008, Accuracy: 575/581 (98.9673%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   6,  Average loss: 0.0007, Accuracy: 577/581 (99.3115%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   7,  Average loss: 0.0005, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   8,  Average loss: 0.0004, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   9,  Average loss: 0.0003, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch  10,  Average loss: 0.0004, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 15.80853873229863.
Norm before scaling: 16.021704257794138. Distance: 2.9541532149409906
Total norm for 4 adversaries is: 16.021704257794138. distance: 2.9541532149409906
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1322, Accuracy: 8630/8991 (95.9849%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0088, Accuracy: 535/593 (90.2192%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   2,  Average loss: 0.0045, Accuracy: 546/593 (92.0742%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   3,  Average loss: 0.0028, Accuracy: 568/593 (95.7841%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   4,  Average loss: 0.0019, Accuracy: 577/593 (97.3019%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   5,  Average loss: 0.0016, Accuracy: 580/593 (97.8078%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   6,  Average loss: 0.0012, Accuracy: 586/593 (98.8196%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   7,  Average loss: 0.0011, Accuracy: 588/593 (99.1568%), train_poison_data_count: 593
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   8,  Average loss: 0.0008, Accuracy: 590/593 (99.4941%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   9,  Average loss: 0.0008, Accuracy: 591/593 (99.6627%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch  10,  Average loss: 0.0007, Accuracy: 591/593 (99.6627%), train_poison_data_count: 593
Global model norm: 15.80853873229863.
Norm before scaling: 16.203773831331798. Distance: 3.666448861213271
Total norm for 4 adversaries is: 16.203773831331798. distance: 3.666448861213271
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1284, Accuracy: 8637/8991 (96.0627%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0147, Accuracy: 471/555 (84.8649%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   2,  Average loss: 0.0084, Accuracy: 475/555 (85.5856%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   3,  Average loss: 0.0036, Accuracy: 527/555 (94.9550%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   4,  Average loss: 0.0029, Accuracy: 530/555 (95.4955%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   5,  Average loss: 0.0023, Accuracy: 535/555 (96.3964%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   6,  Average loss: 0.0020, Accuracy: 534/555 (96.2162%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   7,  Average loss: 0.0017, Accuracy: 536/555 (96.5766%), train_poison_data_count: 555
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   8,  Average loss: 0.0016, Accuracy: 541/555 (97.4775%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   9,  Average loss: 0.0014, Accuracy: 542/555 (97.6577%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch  10,  Average loss: 0.0014, Accuracy: 542/555 (97.6577%), train_poison_data_count: 555
Global model norm: 15.80853873229863.
Norm before scaling: 16.7649087175159. Distance: 5.615546356822292
Total norm for 4 adversaries is: 16.7649087175159. distance: 5.615546356822292
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1598, Accuracy: 8523/8991 (94.7948%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0102, Accuracy: 367/408 (89.9510%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.2591, Accuracy: 7152/10000 (71.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0327, Accuracy: 364/568 (64.0845%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.8895, Accuracy: 4768/10000 (47.6800%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0079, Accuracy: 524/573 (91.4485%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   2,  Average loss: 0.0052, Accuracy: 518/573 (90.4014%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   3,  Average loss: 0.0042, Accuracy: 534/573 (93.1937%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   4,  Average loss: 0.0027, Accuracy: 554/573 (96.6841%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   5,  Average loss: 0.0019, Accuracy: 562/573 (98.0803%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   6,  Average loss: 0.0014, Accuracy: 564/573 (98.4293%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   7,  Average loss: 0.0011, Accuracy: 564/573 (98.4293%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   8,  Average loss: 0.0010, Accuracy: 566/573 (98.7784%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   9,  Average loss: 0.0009, Accuracy: 566/573 (98.7784%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch  10,  Average loss: 0.0009, Accuracy: 566/573 (98.7784%), train_poison_data_count: 573
Global model norm: 15.80853873229863.
Norm before scaling: 16.068987890535354. Distance: 3.2330809137453116
Total norm for 4 adversaries is: 16.068987890535354. distance: 3.2330809137453116
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1474, Accuracy: 8573/8991 (95.3509%)
___Train Local_Simple,  epoch  16, local model 60, internal_epoch   1,  Average loss: 0.0122, Accuracy: 502/600 (83.6667%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4088, Accuracy: 8957/10000 (89.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 63, internal_epoch   1,  Average loss: 0.0121, Accuracy: 500/594 (84.1751%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4402, Accuracy: 8764/10000 (87.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 52, internal_epoch   1,  Average loss: 0.0164, Accuracy: 475/598 (79.4314%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4172, Accuracy: 8781/10000 (87.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 90, internal_epoch   1,  Average loss: 0.0095, Accuracy: 497/576 (86.2847%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4622, Accuracy: 8487/10000 (84.8700%), Attack Success Rate:0/10000(0.000)
time spent on training: 121.41684412956238
[foolsgold agg] training data poison_ratio: 0.4077222812610698  data num: [581, 593, 555, 408, 568, 573, 600, 594, 598, 576]
[foolsgold agg] considering poison per batch poison_fraction: 0.4077222812610698
[foolsgold agg] wv: [1.         0.81000989 1.         1.         1.         0.81000989
 0.8685019  0.         0.         0.84548977]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 1.4325, Accuracy: 8290/10000 (82.9000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.4091, Accuracy: 8441/8991 (93.8828%)
Done in 360.2850251197815 sec.
Server Epoch:17 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0101, Accuracy: 525/622 (84.4051%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3649, Accuracy: 8970/10000 (89.7000%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   1,  Average loss: 0.0051, Accuracy: 573/612 (93.6275%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   2,  Average loss: 0.0033, Accuracy: 576/612 (94.1176%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   3,  Average loss: 0.0017, Accuracy: 597/612 (97.5490%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   4,  Average loss: 0.0010, Accuracy: 606/612 (99.0196%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   5,  Average loss: 0.0007, Accuracy: 610/612 (99.6732%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 610/612 (99.6732%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   7,  Average loss: 0.0004, Accuracy: 610/612 (99.6732%), train_poison_data_count: 612
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   8,  Average loss: 0.0003, Accuracy: 610/612 (99.6732%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   9,  Average loss: 0.0003, Accuracy: 611/612 (99.8366%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch  10,  Average loss: 0.0003, Accuracy: 611/612 (99.8366%), train_poison_data_count: 612
Global model norm: 15.907779043035243.
Norm before scaling: 16.045831841397998. Distance: 2.8302093749219326
Total norm for 4 adversaries is: 16.045831841397998. distance: 2.8302093749219326
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1517, Accuracy: 8589/8991 (95.5289%)
___Train Local_Simple,  epoch  17, local model 56, internal_epoch   1,  Average loss: 0.0085, Accuracy: 509/586 (86.8601%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.5265, Accuracy: 8236/10000 (82.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 97, internal_epoch   1,  Average loss: 0.0220, Accuracy: 402/539 (74.5826%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8387, Accuracy: 8125/10000 (81.2500%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0053, Accuracy: 586/635 (92.2835%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0027, Accuracy: 599/635 (94.3307%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   3,  Average loss: 0.0016, Accuracy: 618/635 (97.3228%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   4,  Average loss: 0.0011, Accuracy: 629/635 (99.0551%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   5,  Average loss: 0.0008, Accuracy: 630/635 (99.2126%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   6,  Average loss: 0.0006, Accuracy: 630/635 (99.2126%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   7,  Average loss: 0.0005, Accuracy: 631/635 (99.3701%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   8,  Average loss: 0.0004, Accuracy: 632/635 (99.5276%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   9,  Average loss: 0.0004, Accuracy: 632/635 (99.5276%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch  10,  Average loss: 0.0004, Accuracy: 632/635 (99.5276%), train_poison_data_count: 635
Global model norm: 15.907779043035243.
Norm before scaling: 16.064156650949656. Distance: 2.8620521228343834
Total norm for 4 adversaries is: 16.064156650949656. distance: 2.8620521228343834
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1172, Accuracy: 8676/8991 (96.4965%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0097, Accuracy: 560/628 (89.1720%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   2,  Average loss: 0.0034, Accuracy: 588/628 (93.6306%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   3,  Average loss: 0.0020, Accuracy: 609/628 (96.9745%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   4,  Average loss: 0.0016, Accuracy: 614/628 (97.7707%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   5,  Average loss: 0.0013, Accuracy: 616/628 (98.0892%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   6,  Average loss: 0.0010, Accuracy: 619/628 (98.5669%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   7,  Average loss: 0.0009, Accuracy: 622/628 (99.0446%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   8,  Average loss: 0.0008, Accuracy: 622/628 (99.0446%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   9,  Average loss: 0.0007, Accuracy: 623/628 (99.2038%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch  10,  Average loss: 0.0007, Accuracy: 623/628 (99.2038%), train_poison_data_count: 628
Global model norm: 15.907779043035243.
Norm before scaling: 16.30711398601035. Distance: 3.9657147432698423
Total norm for 4 adversaries is: 16.30711398601035. distance: 3.9657147432698423
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1491, Accuracy: 8569/8991 (95.3064%)
___Train Local_Simple,  epoch  17, local model 77, internal_epoch   1,  Average loss: 0.0133, Accuracy: 457/565 (80.8850%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4958, Accuracy: 8620/10000 (86.2000%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0066, Accuracy: 555/601 (92.3461%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   2,  Average loss: 0.0038, Accuracy: 556/601 (92.5125%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   3,  Average loss: 0.0027, Accuracy: 567/601 (94.3428%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   4,  Average loss: 0.0016, Accuracy: 589/601 (98.0033%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   5,  Average loss: 0.0012, Accuracy: 595/601 (99.0017%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   6,  Average loss: 0.0008, Accuracy: 597/601 (99.3344%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   7,  Average loss: 0.0007, Accuracy: 598/601 (99.5008%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   8,  Average loss: 0.0006, Accuracy: 598/601 (99.5008%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   9,  Average loss: 0.0005, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch  10,  Average loss: 0.0005, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Global model norm: 15.907779043035243.
Norm before scaling: 16.295189570084787. Distance: 3.422185874996404
Total norm for 4 adversaries is: 16.295189570084787. distance: 3.422185874996404
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1298, Accuracy: 8630/8991 (95.9849%)
___Train Local_Simple,  epoch  17, local model 90, internal_epoch   1,  Average loss: 0.0111, Accuracy: 485/576 (84.2014%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4597, Accuracy: 9187/10000 (91.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0106, Accuracy: 508/607 (83.6903%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3961, Accuracy: 9217/10000 (92.1700%), Attack Success Rate:0/10000(0.000)
time spent on training: 117.73595404624939
[foolsgold agg] training data poison_ratio: 0.4146709093954112  data num: [622, 612, 586, 539, 635, 628, 565, 601, 576, 607]
[foolsgold agg] considering poison per batch poison_fraction: 0.4146709093954112
[foolsgold agg] wv: [1.         1.         0.88688166 0.88688166 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.8148, Accuracy: 8347/10000 (83.4700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.3873, Accuracy: 8423/8991 (93.6826%)
Done in 395.25449109077454 sec.
Server Epoch:18 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0104, Accuracy: 501/595 (84.2017%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3827, Accuracy: 8825/10000 (88.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0086, Accuracy: 494/575 (85.9130%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4265, Accuracy: 8784/10000 (87.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 88, internal_epoch   1,  Average loss: 0.0095, Accuracy: 476/560 (85.0000%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3935, Accuracy: 8627/10000 (86.2700%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0066, Accuracy: 558/602 (92.6910%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   2,  Average loss: 0.0043, Accuracy: 556/602 (92.3588%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   3,  Average loss: 0.0022, Accuracy: 581/602 (96.5116%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   4,  Average loss: 0.0014, Accuracy: 586/602 (97.3422%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   5,  Average loss: 0.0011, Accuracy: 593/602 (98.5050%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   6,  Average loss: 0.0008, Accuracy: 598/602 (99.3355%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   7,  Average loss: 0.0007, Accuracy: 598/602 (99.3355%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   8,  Average loss: 0.0006, Accuracy: 599/602 (99.5017%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   9,  Average loss: 0.0005, Accuracy: 600/602 (99.6678%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch  10,  Average loss: 0.0005, Accuracy: 600/602 (99.6678%), train_poison_data_count: 602
Global model norm: 15.992749001653307.
Norm before scaling: 16.18203654935823. Distance: 2.964098689733604
Total norm for 2 adversaries is: 16.18203654935823. distance: 2.964098689733604
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1269, Accuracy: 8633/8991 (96.0182%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   1,  Average loss: 0.0067, Accuracy: 518/560 (92.5000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   2,  Average loss: 0.0032, Accuracy: 528/560 (94.2857%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   3,  Average loss: 0.0015, Accuracy: 544/560 (97.1429%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   4,  Average loss: 0.0011, Accuracy: 551/560 (98.3929%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   5,  Average loss: 0.0009, Accuracy: 555/560 (99.1071%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   6,  Average loss: 0.0007, Accuracy: 555/560 (99.1071%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   7,  Average loss: 0.0006, Accuracy: 555/560 (99.1071%), train_poison_data_count: 560
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   8,  Average loss: 0.0005, Accuracy: 556/560 (99.2857%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   9,  Average loss: 0.0004, Accuracy: 559/560 (99.8214%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch  10,  Average loss: 0.0004, Accuracy: 559/560 (99.8214%), train_poison_data_count: 560
Global model norm: 15.992749001653307.
Norm before scaling: 16.175968496108954. Distance: 3.0821089160643558
Total norm for 2 adversaries is: 16.175968496108954. distance: 3.0821089160643558
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1227, Accuracy: 8650/8991 (96.2073%)
___Train Local_Simple,  epoch  18, local model 75, internal_epoch   1,  Average loss: 0.0085, Accuracy: 518/600 (86.3333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3660, Accuracy: 8951/10000 (89.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 82, internal_epoch   1,  Average loss: 0.0103, Accuracy: 502/589 (85.2292%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3666, Accuracy: 9230/10000 (92.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0100, Accuracy: 492/585 (84.1026%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5034, Accuracy: 8482/10000 (84.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 95, internal_epoch   1,  Average loss: 0.0070, Accuracy: 481/549 (87.6138%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7253, Accuracy: 8300/10000 (83.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0176, Accuracy: 389/508 (76.5748%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9196, Accuracy: 7398/10000 (73.9800%), Attack Success Rate:0/10000(0.000)
time spent on training: 80.4354031085968
[foolsgold agg] training data poison_ratio: 0.20304036344574525  data num: [595, 575, 560, 602, 560, 600, 589, 585, 549, 508]
[foolsgold agg] considering poison per batch poison_fraction: 0.20304036344574525
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.5207, Accuracy: 8519/10000 (85.1900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.3652, Accuracy: 8300/8991 (92.3145%)
Done in 317.0699610710144 sec.
Server Epoch:19 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0032, Accuracy: 566/601 (94.1764%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   2,  Average loss: 0.0017, Accuracy: 582/601 (96.8386%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   3,  Average loss: 0.0007, Accuracy: 592/601 (98.5025%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   4,  Average loss: 0.0003, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   5,  Average loss: 0.0002, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   6,  Average loss: 0.0002, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   7,  Average loss: 0.0002, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   8,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Global model norm: 16.018842093046334.
Norm before scaling: 16.06210576030049. Distance: 1.938339851228487
Total norm for 9 adversaries is: 16.06210576030049. distance: 1.938339851228487
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1202, Accuracy: 8679/8991 (96.5299%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.0044, Accuracy: 536/571 (93.8704%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   2,  Average loss: 0.0029, Accuracy: 544/571 (95.2715%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   3,  Average loss: 0.0017, Accuracy: 555/571 (97.1979%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   4,  Average loss: 0.0010, Accuracy: 565/571 (98.9492%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   5,  Average loss: 0.0006, Accuracy: 567/571 (99.2995%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   6,  Average loss: 0.0005, Accuracy: 568/571 (99.4746%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   7,  Average loss: 0.0004, Accuracy: 569/571 (99.6497%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   8,  Average loss: 0.0003, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   9,  Average loss: 0.0003, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch  10,  Average loss: 0.0003, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Global model norm: 16.018842093046334.
Norm before scaling: 16.093182066738795. Distance: 2.3272836688310083
Total norm for 9 adversaries is: 16.093182066738795. distance: 2.3272836688310083
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1222, Accuracy: 8654/8991 (96.2518%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   1,  Average loss: 0.0035, Accuracy: 530/567 (93.4744%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   2,  Average loss: 0.0022, Accuracy: 540/567 (95.2381%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   3,  Average loss: 0.0013, Accuracy: 550/567 (97.0018%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   4,  Average loss: 0.0006, Accuracy: 562/567 (99.1182%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   5,  Average loss: 0.0004, Accuracy: 564/567 (99.4709%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   6,  Average loss: 0.0003, Accuracy: 565/567 (99.6473%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   7,  Average loss: 0.0003, Accuracy: 565/567 (99.6473%), train_poison_data_count: 567
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   8,  Average loss: 0.0003, Accuracy: 566/567 (99.8236%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   9,  Average loss: 0.0002, Accuracy: 566/567 (99.8236%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch  10,  Average loss: 0.0002, Accuracy: 566/567 (99.8236%), train_poison_data_count: 567
Global model norm: 16.018842093046334.
Norm before scaling: 16.064854786961874. Distance: 1.9247511145472938
Total norm for 9 adversaries is: 16.064854786961874. distance: 1.9247511145472938
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1217, Accuracy: 8657/8991 (96.2852%)
___Train Local_Simple,  epoch  19, local model 84, internal_epoch   1,  Average loss: 0.0061, Accuracy: 537/601 (89.3511%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3146, Accuracy: 9028/10000 (90.2800%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0037, Accuracy: 544/581 (93.6317%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   2,  Average loss: 0.0037, Accuracy: 555/581 (95.5250%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   3,  Average loss: 0.0015, Accuracy: 558/581 (96.0413%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   4,  Average loss: 0.0007, Accuracy: 576/581 (99.1394%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   5,  Average loss: 0.0004, Accuracy: 580/581 (99.8279%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   6,  Average loss: 0.0004, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   7,  Average loss: 0.0003, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   8,  Average loss: 0.0003, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   9,  Average loss: 0.0004, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch  10,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.018842093046334.
Norm before scaling: 16.08653604247052. Distance: 2.1716545596874584
Total norm for 9 adversaries is: 16.08653604247052. distance: 2.1716545596874584
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1236, Accuracy: 8634/8991 (96.0294%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0042, Accuracy: 526/566 (92.9329%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   2,  Average loss: 0.0023, Accuracy: 537/566 (94.8763%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   3,  Average loss: 0.0017, Accuracy: 546/566 (96.4664%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   4,  Average loss: 0.0007, Accuracy: 559/566 (98.7633%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   5,  Average loss: 0.0006, Accuracy: 562/566 (99.2933%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   6,  Average loss: 0.0005, Accuracy: 564/566 (99.6466%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   7,  Average loss: 0.0004, Accuracy: 564/566 (99.6466%), train_poison_data_count: 566
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   8,  Average loss: 0.0003, Accuracy: 565/566 (99.8233%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   9,  Average loss: 0.0003, Accuracy: 565/566 (99.8233%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch  10,  Average loss: 0.0003, Accuracy: 565/566 (99.8233%), train_poison_data_count: 566
Global model norm: 16.018842093046334.
Norm before scaling: 16.11384989526915. Distance: 2.0688325018436884
Total norm for 9 adversaries is: 16.11384989526915. distance: 2.0688325018436884
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1437, Accuracy: 8623/8991 (95.9070%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0048, Accuracy: 553/593 (93.2546%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   2,  Average loss: 0.0024, Accuracy: 563/593 (94.9410%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   3,  Average loss: 0.0020, Accuracy: 568/593 (95.7841%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   4,  Average loss: 0.0009, Accuracy: 586/593 (98.8196%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   5,  Average loss: 0.0007, Accuracy: 586/593 (98.8196%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   6,  Average loss: 0.0006, Accuracy: 588/593 (99.1568%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   7,  Average loss: 0.0005, Accuracy: 590/593 (99.4941%), train_poison_data_count: 593
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   8,  Average loss: 0.0004, Accuracy: 592/593 (99.8314%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   9,  Average loss: 0.0004, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch  10,  Average loss: 0.0004, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Global model norm: 16.018842093046334.
Norm before scaling: 16.078313857916566. Distance: 2.4544438018364345
Total norm for 9 adversaries is: 16.078313857916566. distance: 2.4544438018364345
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1065, Accuracy: 8708/8991 (96.8524%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0063, Accuracy: 547/596 (91.7785%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   2,  Average loss: 0.0040, Accuracy: 549/596 (92.1141%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   3,  Average loss: 0.0027, Accuracy: 562/596 (94.2953%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   4,  Average loss: 0.0015, Accuracy: 582/596 (97.6510%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   5,  Average loss: 0.0012, Accuracy: 587/596 (98.4899%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   6,  Average loss: 0.0011, Accuracy: 588/596 (98.6577%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   7,  Average loss: 0.0008, Accuracy: 589/596 (98.8255%), train_poison_data_count: 596
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   8,  Average loss: 0.0007, Accuracy: 588/596 (98.6577%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   9,  Average loss: 0.0008, Accuracy: 589/596 (98.8255%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch  10,  Average loss: 0.0007, Accuracy: 589/596 (98.8255%), train_poison_data_count: 596
Global model norm: 16.018842093046334.
Norm before scaling: 16.19912502610336. Distance: 2.858382589584953
Total norm for 9 adversaries is: 16.19912502610336. distance: 2.858382589584953
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1241, Accuracy: 8643/8991 (96.1295%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 568/609 (93.2677%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   2,  Average loss: 0.0023, Accuracy: 579/609 (95.0739%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   3,  Average loss: 0.0016, Accuracy: 586/609 (96.2233%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   4,  Average loss: 0.0008, Accuracy: 602/609 (98.8506%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   5,  Average loss: 0.0005, Accuracy: 606/609 (99.5074%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   6,  Average loss: 0.0004, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   7,  Average loss: 0.0003, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   8,  Average loss: 0.0003, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   9,  Average loss: 0.0003, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch  10,  Average loss: 0.0002, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 16.018842093046334.
Norm before scaling: 16.118727772680003. Distance: 2.347793651247722
Total norm for 9 adversaries is: 16.118727772680003. distance: 2.347793651247722
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1173, Accuracy: 8676/8991 (96.4965%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 535/568 (94.1901%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   2,  Average loss: 0.0019, Accuracy: 544/568 (95.7746%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   3,  Average loss: 0.0013, Accuracy: 555/568 (97.7113%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   4,  Average loss: 0.0007, Accuracy: 562/568 (98.9437%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   5,  Average loss: 0.0004, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   6,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   7,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Global model norm: 16.018842093046334.
Norm before scaling: 16.095470743870678. Distance: 2.1348089578458826
Total norm for 9 adversaries is: 16.095470743870678. distance: 2.1348089578458826
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1063, Accuracy: 8703/8991 (96.7968%)
time spent on training: 170.5637228488922
[foolsgold agg] training data poison_ratio: 0.8973176148983427  data num: [601, 571, 567, 601, 581, 566, 593, 596, 609, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.8973176148983427
[foolsgold agg] wv: [0.22155454 1.         0.40349873 1.         0.69540658 0.22155454
 0.59872472 1.         0.6986926  1.        ]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.6530, Accuracy: 8480/10000 (84.8000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.2603, Accuracy: 8541/8991 (94.9950%)
Done in 390.5412950515747 sec.
Server Epoch:20 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0043, Accuracy: 567/602 (94.1860%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   2,  Average loss: 0.0023, Accuracy: 580/602 (96.3455%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   3,  Average loss: 0.0014, Accuracy: 584/602 (97.0100%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   4,  Average loss: 0.0006, Accuracy: 596/602 (99.0033%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   5,  Average loss: 0.0005, Accuracy: 599/602 (99.5017%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   6,  Average loss: 0.0004, Accuracy: 599/602 (99.5017%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   7,  Average loss: 0.0003, Accuracy: 601/602 (99.8339%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   8,  Average loss: 0.0003, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   9,  Average loss: 0.0003, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch  10,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 16.09139375196752.
Norm before scaling: 16.139031035161505. Distance: 2.1690146732704574
Total norm for 9 adversaries is: 16.139031035161505. distance: 2.1690146732704574
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1100, Accuracy: 8701/8991 (96.7746%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0031, Accuracy: 546/571 (95.6217%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   2,  Average loss: 0.0017, Accuracy: 551/571 (96.4974%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   3,  Average loss: 0.0008, Accuracy: 563/571 (98.5989%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   4,  Average loss: 0.0004, Accuracy: 569/571 (99.6497%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   5,  Average loss: 0.0003, Accuracy: 570/571 (99.8249%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   6,  Average loss: 0.0002, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   7,  Average loss: 0.0002, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   8,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   9,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch  10,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Global model norm: 16.09139375196752.
Norm before scaling: 16.093191548259917. Distance: 1.7889279643951692
Total norm for 9 adversaries is: 16.093191548259917. distance: 1.7889279643951692
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1219, Accuracy: 8681/8991 (96.5521%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   1,  Average loss: 0.0043, Accuracy: 566/597 (94.8074%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   2,  Average loss: 0.0031, Accuracy: 553/597 (92.6298%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   3,  Average loss: 0.0016, Accuracy: 574/597 (96.1474%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   4,  Average loss: 0.0011, Accuracy: 588/597 (98.4925%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   5,  Average loss: 0.0008, Accuracy: 591/597 (98.9950%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   6,  Average loss: 0.0006, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   7,  Average loss: 0.0005, Accuracy: 595/597 (99.6650%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   8,  Average loss: 0.0004, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   9,  Average loss: 0.0003, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch  10,  Average loss: 0.0004, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Global model norm: 16.09139375196752.
Norm before scaling: 16.114397215143416. Distance: 2.1927373043028098
Total norm for 9 adversaries is: 16.114397215143416. distance: 2.1927373043028098
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1205, Accuracy: 8665/8991 (96.3742%)
___Train Local_Simple,  epoch  20, local model 82, internal_epoch   1,  Average loss: 0.0072, Accuracy: 528/589 (89.6435%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6226, Accuracy: 8158/10000 (81.5800%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0030, Accuracy: 572/601 (95.1747%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   2,  Average loss: 0.0030, Accuracy: 566/601 (94.1764%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   3,  Average loss: 0.0006, Accuracy: 596/601 (99.1681%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   4,  Average loss: 0.0004, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   5,  Average loss: 0.0003, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   6,  Average loss: 0.0002, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   7,  Average loss: 0.0002, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   8,  Average loss: 0.0002, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Global model norm: 16.09139375196752.
Norm before scaling: 16.141712133645203. Distance: 2.015363691084696
Total norm for 9 adversaries is: 16.141712133645203. distance: 2.015363691084696
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1214, Accuracy: 8671/8991 (96.4409%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0047, Accuracy: 535/577 (92.7210%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   2,  Average loss: 0.0031, Accuracy: 543/577 (94.1075%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   3,  Average loss: 0.0015, Accuracy: 560/577 (97.0537%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   4,  Average loss: 0.0009, Accuracy: 571/577 (98.9601%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   5,  Average loss: 0.0006, Accuracy: 571/577 (98.9601%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   6,  Average loss: 0.0005, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   7,  Average loss: 0.0004, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   8,  Average loss: 0.0004, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   9,  Average loss: 0.0004, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch  10,  Average loss: 0.0003, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Global model norm: 16.09139375196752.
Norm before scaling: 16.13327783832516. Distance: 2.3641919611789097
Total norm for 9 adversaries is: 16.13327783832516. distance: 2.3641919611789097
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1163, Accuracy: 8676/8991 (96.4965%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   1,  Average loss: 0.0057, Accuracy: 531/573 (92.6702%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   2,  Average loss: 0.0023, Accuracy: 553/573 (96.5096%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   3,  Average loss: 0.0016, Accuracy: 558/573 (97.3822%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   4,  Average loss: 0.0011, Accuracy: 566/573 (98.7784%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   5,  Average loss: 0.0008, Accuracy: 570/573 (99.4764%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   6,  Average loss: 0.0006, Accuracy: 571/573 (99.6510%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   7,  Average loss: 0.0005, Accuracy: 571/573 (99.6510%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   8,  Average loss: 0.0004, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   9,  Average loss: 0.0004, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch  10,  Average loss: 0.0004, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Global model norm: 16.09139375196752.
Norm before scaling: 16.073757872341858. Distance: 2.046841919609834
Total norm for 9 adversaries is: 16.073757872341858. distance: 2.046841919609834
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1095, Accuracy: 8687/8991 (96.6188%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   1,  Average loss: 0.0043, Accuracy: 543/574 (94.5993%), train_poison_data_count: 574
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   2,  Average loss: 0.0016, Accuracy: 553/574 (96.3415%), train_poison_data_count: 574
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   3,  Average loss: 0.0008, Accuracy: 562/574 (97.9094%), train_poison_data_count: 574
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   4,  Average loss: 0.0005, Accuracy: 572/574 (99.6516%), train_poison_data_count: 574
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   5,  Average loss: 0.0004, Accuracy: 573/574 (99.8258%), train_poison_data_count: 574
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   6,  Average loss: 0.0003, Accuracy: 574/574 (100.0000%), train_poison_data_count: 574
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   7,  Average loss: 0.0002, Accuracy: 574/574 (100.0000%), train_poison_data_count: 574
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   8,  Average loss: 0.0002, Accuracy: 574/574 (100.0000%), train_poison_data_count: 574
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   9,  Average loss: 0.0002, Accuracy: 574/574 (100.0000%), train_poison_data_count: 574
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch  10,  Average loss: 0.0002, Accuracy: 574/574 (100.0000%), train_poison_data_count: 574
Global model norm: 16.09139375196752.
Norm before scaling: 16.091818565838338. Distance: 1.9429374811948812
Total norm for 9 adversaries is: 16.091818565838338. distance: 1.9429374811948812
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1250, Accuracy: 8656/8991 (96.2741%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 538/577 (93.2409%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   2,  Average loss: 0.0017, Accuracy: 557/577 (96.5338%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   3,  Average loss: 0.0015, Accuracy: 560/577 (97.0537%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   4,  Average loss: 0.0006, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   5,  Average loss: 0.0004, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   7,  Average loss: 0.0003, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   8,  Average loss: 0.0005, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   9,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch  10,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Global model norm: 16.09139375196752.
Norm before scaling: 16.14406292797032. Distance: 2.3306271209257035
Total norm for 9 adversaries is: 16.14406292797032. distance: 2.3306271209257035
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1177, Accuracy: 8669/8991 (96.4186%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0041, Accuracy: 610/646 (94.4272%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   2,  Average loss: 0.0018, Accuracy: 618/646 (95.6656%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   3,  Average loss: 0.0026, Accuracy: 619/646 (95.8204%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   4,  Average loss: 0.0006, Accuracy: 639/646 (98.9164%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   5,  Average loss: 0.0007, Accuracy: 643/646 (99.5356%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   6,  Average loss: 0.0004, Accuracy: 644/646 (99.6904%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   7,  Average loss: 0.0003, Accuracy: 644/646 (99.6904%), train_poison_data_count: 646
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   8,  Average loss: 0.0003, Accuracy: 644/646 (99.6904%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 645/646 (99.8452%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Global model norm: 16.09139375196752.
Norm before scaling: 16.152198741035907. Distance: 2.2508747731527143
Total norm for 9 adversaries is: 16.152198741035907. distance: 2.2508747731527143
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1289, Accuracy: 8657/8991 (96.2852%)
time spent on training: 159.05488896369934
[foolsgold agg] training data poison_ratio: 0.9002877941425428  data num: [602, 571, 597, 589, 601, 577, 573, 574, 577, 646]
[foolsgold agg] considering poison per batch poison_fraction: 0.9002877941425428
[foolsgold agg] wv: [0.         1.         1.         1.         0.         1.
 1.         1.         0.20102881 0.36598038]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.8413, Accuracy: 8557/10000 (85.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.2478, Accuracy: 8611/8991 (95.7736%)
Done in 366.7424120903015 sec.
Server Epoch:21 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   1,  Average loss: 0.0042, Accuracy: 580/612 (94.7712%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   2,  Average loss: 0.0025, Accuracy: 587/612 (95.9150%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   3,  Average loss: 0.0016, Accuracy: 591/612 (96.5686%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   4,  Average loss: 0.0008, Accuracy: 605/612 (98.8562%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   5,  Average loss: 0.0004, Accuracy: 608/612 (99.3464%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   6,  Average loss: 0.0003, Accuracy: 610/612 (99.6732%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   7,  Average loss: 0.0003, Accuracy: 611/612 (99.8366%), train_poison_data_count: 612
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   8,  Average loss: 0.0002, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch  10,  Average loss: 0.0002, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Global model norm: 16.15467080047981.
Norm before scaling: 16.184702981386565. Distance: 2.2777646757022985
Total norm for 5 adversaries is: 16.184702981386565. distance: 2.2777646757022985
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1081, Accuracy: 8701/8991 (96.7746%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 518/555 (93.3333%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   2,  Average loss: 0.0035, Accuracy: 518/555 (93.3333%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   3,  Average loss: 0.0017, Accuracy: 536/555 (96.5766%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   4,  Average loss: 0.0012, Accuracy: 543/555 (97.8378%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   5,  Average loss: 0.0008, Accuracy: 548/555 (98.7387%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   6,  Average loss: 0.0006, Accuracy: 549/555 (98.9189%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   7,  Average loss: 0.0005, Accuracy: 550/555 (99.0991%), train_poison_data_count: 555
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   8,  Average loss: 0.0005, Accuracy: 551/555 (99.2793%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   9,  Average loss: 0.0004, Accuracy: 553/555 (99.6396%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch  10,  Average loss: 0.0004, Accuracy: 554/555 (99.8198%), train_poison_data_count: 555
Global model norm: 16.15467080047981.
Norm before scaling: 16.156600387581058. Distance: 2.2158291355460085
Total norm for 5 adversaries is: 16.156600387581058. distance: 2.2158291355460085
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1128, Accuracy: 8694/8991 (96.6967%)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0087, Accuracy: 436/508 (85.8268%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3866, Accuracy: 8761/10000 (87.6100%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   1,  Average loss: 0.0055, Accuracy: 520/556 (93.5252%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   2,  Average loss: 0.0032, Accuracy: 521/556 (93.7050%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   3,  Average loss: 0.0012, Accuracy: 546/556 (98.2014%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   4,  Average loss: 0.0009, Accuracy: 550/556 (98.9209%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   5,  Average loss: 0.0007, Accuracy: 554/556 (99.6403%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   6,  Average loss: 0.0005, Accuracy: 554/556 (99.6403%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   7,  Average loss: 0.0005, Accuracy: 554/556 (99.6403%), train_poison_data_count: 556
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   8,  Average loss: 0.0004, Accuracy: 554/556 (99.6403%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   9,  Average loss: 0.0004, Accuracy: 554/556 (99.6403%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch  10,  Average loss: 0.0004, Accuracy: 554/556 (99.6403%), train_poison_data_count: 556
Global model norm: 16.15467080047981.
Norm before scaling: 16.174440278122358. Distance: 2.3466937080183534
Total norm for 5 adversaries is: 16.174440278122358. distance: 2.3466937080183534
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1089, Accuracy: 8674/8991 (96.4743%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0046, Accuracy: 599/635 (94.3307%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0029, Accuracy: 590/635 (92.9134%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0013, Accuracy: 623/635 (98.1102%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0009, Accuracy: 626/635 (98.5827%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0006, Accuracy: 631/635 (99.3701%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0004, Accuracy: 632/635 (99.5276%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0004, Accuracy: 633/635 (99.6850%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0003, Accuracy: 634/635 (99.8425%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0003, Accuracy: 634/635 (99.8425%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0003, Accuracy: 634/635 (99.8425%), train_poison_data_count: 635
Global model norm: 16.15467080047981.
Norm before scaling: 16.213149322000955. Distance: 2.45375704064236
Total norm for 5 adversaries is: 16.213149322000955. distance: 2.45375704064236
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1032, Accuracy: 8697/8991 (96.7301%)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0087, Accuracy: 467/539 (86.6419%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4386, Accuracy: 8325/10000 (83.2500%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   1,  Average loss: 0.0024, Accuracy: 571/588 (97.1088%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   2,  Average loss: 0.0023, Accuracy: 566/588 (96.2585%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   3,  Average loss: 0.0010, Accuracy: 577/588 (98.1293%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   4,  Average loss: 0.0004, Accuracy: 585/588 (99.4898%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   5,  Average loss: 0.0003, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   6,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   7,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.15467080047981.
Norm before scaling: 16.182172333034142. Distance: 1.9517214805773881
Total norm for 5 adversaries is: 16.182172333034142. distance: 1.9517214805773881
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1299, Accuracy: 8683/8991 (96.5744%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0051, Accuracy: 557/609 (91.4614%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1876, Accuracy: 9455/10000 (94.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0085, Accuracy: 479/547 (87.5686%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3275, Accuracy: 9026/10000 (90.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0068, Accuracy: 534/598 (89.2977%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3227, Accuracy: 9053/10000 (90.5300%), Attack Success Rate:0/10000(0.000)
time spent on training: 122.67342591285706
[foolsgold agg] training data poison_ratio: 0.5126152775361058  data num: [612, 555, 508, 556, 635, 539, 588, 609, 547, 598]
[foolsgold agg] considering poison per batch poison_fraction: 0.5126152775361058
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.12142142
 1.         0.75620849 1.         0.12142142]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.7732, Accuracy: 8547/10000 (85.4700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.2418, Accuracy: 8623/8991 (95.9070%)
Done in 351.7745449542999 sec.
Server Epoch:22 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.0058, Accuracy: 560/603 (92.8690%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   2,  Average loss: 0.0024, Accuracy: 578/603 (95.8541%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   3,  Average loss: 0.0010, Accuracy: 593/603 (98.3416%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   4,  Average loss: 0.0008, Accuracy: 598/603 (99.1708%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   5,  Average loss: 0.0006, Accuracy: 599/603 (99.3367%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   6,  Average loss: 0.0005, Accuracy: 600/603 (99.5025%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   7,  Average loss: 0.0004, Accuracy: 601/603 (99.6683%), train_poison_data_count: 603
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   8,  Average loss: 0.0004, Accuracy: 602/603 (99.8342%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   9,  Average loss: 0.0004, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch  10,  Average loss: 0.0003, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Global model norm: 16.20547912623806.
Norm before scaling: 16.260643862355494. Distance: 2.556145581488787
Total norm for 7 adversaries is: 16.260643862355494. distance: 2.556145581488787
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1215, Accuracy: 8666/8991 (96.3853%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0055, Accuracy: 538/584 (92.1233%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   2,  Average loss: 0.0027, Accuracy: 554/584 (94.8630%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   3,  Average loss: 0.0014, Accuracy: 570/584 (97.6027%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   4,  Average loss: 0.0011, Accuracy: 575/584 (98.4589%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   5,  Average loss: 0.0006, Accuracy: 582/584 (99.6575%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   6,  Average loss: 0.0005, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   7,  Average loss: 0.0004, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   8,  Average loss: 0.0003, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   9,  Average loss: 0.0003, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch  10,  Average loss: 0.0003, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Global model norm: 16.20547912623806.
Norm before scaling: 16.31188075033904. Distance: 2.5741373376316776
Total norm for 7 adversaries is: 16.31188075033904. distance: 2.5741373376316776
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1261, Accuracy: 8640/8991 (96.0961%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0034, Accuracy: 615/646 (95.2012%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   2,  Average loss: 0.0019, Accuracy: 614/646 (95.0464%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   3,  Average loss: 0.0012, Accuracy: 630/646 (97.5232%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   4,  Average loss: 0.0005, Accuracy: 643/646 (99.5356%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   5,  Average loss: 0.0005, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   6,  Average loss: 0.0003, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   7,  Average loss: 0.0002, Accuracy: 645/646 (99.8452%), train_poison_data_count: 646
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   8,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Global model norm: 16.20547912623806.
Norm before scaling: 16.227106018220333. Distance: 2.0925611850265775
Total norm for 7 adversaries is: 16.227106018220333. distance: 2.0925611850265775
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1305, Accuracy: 8662/8991 (96.3408%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0033, Accuracy: 594/620 (95.8065%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   2,  Average loss: 0.0017, Accuracy: 597/620 (96.2903%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   3,  Average loss: 0.0011, Accuracy: 606/620 (97.7419%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   4,  Average loss: 0.0005, Accuracy: 616/620 (99.3548%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   5,  Average loss: 0.0004, Accuracy: 618/620 (99.6774%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   6,  Average loss: 0.0003, Accuracy: 618/620 (99.6774%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   7,  Average loss: 0.0002, Accuracy: 618/620 (99.6774%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   8,  Average loss: 0.0002, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   9,  Average loss: 0.0002, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch  10,  Average loss: 0.0002, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Global model norm: 16.20547912623806.
Norm before scaling: 16.179067882570617. Distance: 1.9352177745292973
Total norm for 7 adversaries is: 16.179067882570617. distance: 1.9352177745292973
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1138, Accuracy: 8672/8991 (96.4520%)
___Train Local_Simple,  epoch  22, local model 60, internal_epoch   1,  Average loss: 0.0062, Accuracy: 535/600 (89.1667%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2784, Accuracy: 9142/10000 (91.4200%), Attack Success Rate:0/10000(0.000)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 559/593 (94.2664%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   2,  Average loss: 0.0030, Accuracy: 554/593 (93.4233%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   3,  Average loss: 0.0021, Accuracy: 571/593 (96.2901%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   4,  Average loss: 0.0010, Accuracy: 584/593 (98.4823%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   5,  Average loss: 0.0008, Accuracy: 587/593 (98.9882%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   6,  Average loss: 0.0006, Accuracy: 589/593 (99.3255%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   7,  Average loss: 0.0005, Accuracy: 589/593 (99.3255%), train_poison_data_count: 593
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   8,  Average loss: 0.0004, Accuracy: 591/593 (99.6627%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   9,  Average loss: 0.0004, Accuracy: 592/593 (99.8314%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch  10,  Average loss: 0.0004, Accuracy: 592/593 (99.8314%), train_poison_data_count: 593
Global model norm: 16.20547912623806.
Norm before scaling: 16.280666113870407. Distance: 2.5507154470838547
Total norm for 7 adversaries is: 16.280666113870407. distance: 2.5507154470838547
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1142, Accuracy: 8705/8991 (96.8190%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0045, Accuracy: 542/577 (93.9341%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   2,  Average loss: 0.0050, Accuracy: 529/577 (91.6811%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   3,  Average loss: 0.0032, Accuracy: 543/577 (94.1075%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   4,  Average loss: 0.0017, Accuracy: 559/577 (96.8804%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   5,  Average loss: 0.0011, Accuracy: 565/577 (97.9203%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   6,  Average loss: 0.0009, Accuracy: 568/577 (98.4402%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   7,  Average loss: 0.0007, Accuracy: 569/577 (98.6135%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   8,  Average loss: 0.0006, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   9,  Average loss: 0.0005, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch  10,  Average loss: 0.0005, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Global model norm: 16.20547912623806.
Norm before scaling: 16.331970988438215. Distance: 2.750056006121366
Total norm for 7 adversaries is: 16.331970988438215. distance: 2.750056006121366
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1245, Accuracy: 8641/8991 (96.1072%)
___Train Local_Simple,  epoch  22, local model 92, internal_epoch   1,  Average loss: 0.0084, Accuracy: 482/565 (85.3097%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3672, Accuracy: 8898/10000 (88.9800%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   1,  Average loss: 0.0050, Accuracy: 558/597 (93.4673%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   2,  Average loss: 0.0031, Accuracy: 570/597 (95.4774%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   3,  Average loss: 0.0018, Accuracy: 581/597 (97.3199%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   4,  Average loss: 0.0011, Accuracy: 588/597 (98.4925%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   5,  Average loss: 0.0007, Accuracy: 593/597 (99.3300%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   6,  Average loss: 0.0005, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   7,  Average loss: 0.0004, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   8,  Average loss: 0.0004, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   9,  Average loss: 0.0004, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch  10,  Average loss: 0.0003, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Global model norm: 16.20547912623806.
Norm before scaling: 16.228888780649385. Distance: 2.306985620963961
Total norm for 7 adversaries is: 16.228888780649385. distance: 2.306985620963961
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1161, Accuracy: 8669/8991 (96.4186%)
___Train Local_Simple,  epoch  22, local model 96, internal_epoch   1,  Average loss: 0.0071, Accuracy: 486/540 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3221, Accuracy: 8931/10000 (89.3100%), Attack Success Rate:0/10000(0.000)
time spent on training: 147.47614908218384
[foolsgold agg] training data poison_ratio: 0.7122362869198312  data num: [603, 584, 646, 620, 600, 593, 577, 565, 597, 540]
[foolsgold agg] considering poison per batch poison_fraction: 0.7122362869198312
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         0.68377515 1.         0.68377515]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.9523, Accuracy: 8572/10000 (85.7200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.2513, Accuracy: 8650/8991 (96.2073%)
Done in 371.9934480190277 sec.
Server Epoch:23 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
___Train Local_Simple,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0061, Accuracy: 531/586 (90.6143%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2861, Accuracy: 9157/10000 (91.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0083, Accuracy: 515/589 (87.4363%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3587, Accuracy: 8991/10000 (89.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 85, internal_epoch   1,  Average loss: 0.0090, Accuracy: 499/584 (85.4452%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.6158, Accuracy: 8332/10000 (83.3200%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0030, Accuracy: 555/579 (95.8549%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   2,  Average loss: 0.0037, Accuracy: 541/579 (93.4370%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 575/579 (99.3092%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 576/579 (99.4819%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   5,  Average loss: 0.0003, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   6,  Average loss: 0.0003, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   7,  Average loss: 0.0002, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   8,  Average loss: 0.0002, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   9,  Average loss: 0.0002, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch  10,  Average loss: 0.0002, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Global model norm: 16.29941873274598.
Norm before scaling: 16.423234326174057. Distance: 2.5406962141916174
Total norm for 2 adversaries is: 16.423234326174057. distance: 2.5406962141916174
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1286, Accuracy: 8645/8991 (96.1517%)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0084, Accuracy: 520/597 (87.1022%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3958, Accuracy: 8856/10000 (88.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 61, internal_epoch   1,  Average loss: 0.0062, Accuracy: 533/585 (91.1111%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3140, Accuracy: 9019/10000 (90.1900%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 546/573 (95.2880%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   2,  Average loss: 0.0013, Accuracy: 558/573 (97.3822%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   3,  Average loss: 0.0009, Accuracy: 567/573 (98.9529%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   4,  Average loss: 0.0006, Accuracy: 570/573 (99.4764%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   5,  Average loss: 0.0004, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   6,  Average loss: 0.0003, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   7,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   8,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   9,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch  10,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.29941873274598.
Norm before scaling: 16.247995106187812. Distance: 1.9496298071788611
Total norm for 2 adversaries is: 16.247995106187812. distance: 1.9496298071788611
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1011, Accuracy: 8698/8991 (96.7412%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0053, Accuracy: 555/609 (91.1330%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3964, Accuracy: 8708/10000 (87.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0084, Accuracy: 526/594 (88.5522%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4584, Accuracy: 8584/10000 (85.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 75, internal_epoch   1,  Average loss: 0.0089, Accuracy: 519/600 (86.5000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3181, Accuracy: 9108/10000 (91.0800%), Attack Success Rate:0/10000(0.000)
time spent on training: 75.2877790927887
[foolsgold agg] training data poison_ratio: 0.19538670284938942  data num: [586, 589, 584, 579, 597, 585, 573, 609, 594, 600]
[foolsgold agg] considering poison per batch poison_fraction: 0.19538670284938942
[foolsgold agg] wv: [0.53804519 1.         1.         1.         0.90088255 1.
 1.         0.53804519 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.5474, Accuracy: 8660/10000 (86.6000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.2167, Accuracy: 8614/8991 (95.8069%)
Done in 298.1237440109253 sec.
Server Epoch:24 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   1,  Average loss: 0.0051, Accuracy: 555/601 (92.3461%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   2,  Average loss: 0.0020, Accuracy: 576/601 (95.8403%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   3,  Average loss: 0.0011, Accuracy: 593/601 (98.6689%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   4,  Average loss: 0.0008, Accuracy: 597/601 (99.3344%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   5,  Average loss: 0.0006, Accuracy: 597/601 (99.3344%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   6,  Average loss: 0.0006, Accuracy: 598/601 (99.5008%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   7,  Average loss: 0.0004, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   8,  Average loss: 0.0004, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   9,  Average loss: 0.0003, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch  10,  Average loss: 0.0003, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Global model norm: 16.29780378465531.
Norm before scaling: 16.344970190768453. Distance: 2.3017067464570267
Total norm for 4 adversaries is: 16.344970190768453. distance: 2.3017067464570267
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1239, Accuracy: 8625/8991 (95.9293%)
___Train Local_Simple,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0054, Accuracy: 523/569 (91.9156%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3016, Accuracy: 9071/10000 (90.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 96, internal_epoch   1,  Average loss: 0.0065, Accuracy: 481/540 (89.0741%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3928, Accuracy: 8627/10000 (86.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 83, internal_epoch   1,  Average loss: 0.0054, Accuracy: 555/611 (90.8347%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2641, Accuracy: 9238/10000 (92.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 63, internal_epoch   1,  Average loss: 0.0048, Accuracy: 549/594 (92.4242%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2840, Accuracy: 9122/10000 (91.2200%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0040, Accuracy: 565/584 (96.7466%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   2,  Average loss: 0.0042, Accuracy: 545/584 (93.3219%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   3,  Average loss: 0.0013, Accuracy: 567/584 (97.0890%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   4,  Average loss: 0.0008, Accuracy: 576/584 (98.6301%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   5,  Average loss: 0.0006, Accuracy: 580/584 (99.3151%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   6,  Average loss: 0.0008, Accuracy: 581/584 (99.4863%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   7,  Average loss: 0.0004, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   8,  Average loss: 0.0003, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   9,  Average loss: 0.0003, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch  10,  Average loss: 0.0004, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Global model norm: 16.29780378465531.
Norm before scaling: 16.350468788075887. Distance: 2.65611993807843
Total norm for 4 adversaries is: 16.350468788075887. distance: 2.65611993807843
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1215, Accuracy: 8659/8991 (96.3074%)
___Train Local_Simple,  epoch  24, local model 94, internal_epoch   1,  Average loss: 0.0099, Accuracy: 467/541 (86.3216%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.4189, Accuracy: 8649/10000 (86.4900%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0025, Accuracy: 559/581 (96.2134%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   2,  Average loss: 0.0011, Accuracy: 568/581 (97.7625%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   3,  Average loss: 0.0004, Accuracy: 577/581 (99.3115%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   4,  Average loss: 0.0003, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   5,  Average loss: 0.0002, Accuracy: 580/581 (99.8279%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.29780378465531.
Norm before scaling: 16.28218811026955. Distance: 1.6761729531783631
Total norm for 4 adversaries is: 16.28218811026955. distance: 1.6761729531783631
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1226, Accuracy: 8660/8991 (96.3185%)
___Train Local_Simple,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0065, Accuracy: 534/598 (89.2977%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.4037, Accuracy: 8862/10000 (88.6200%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   1,  Average loss: 0.0028, Accuracy: 543/567 (95.7672%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   2,  Average loss: 0.0010, Accuracy: 553/567 (97.5309%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   3,  Average loss: 0.0006, Accuracy: 560/567 (98.7654%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   4,  Average loss: 0.0003, Accuracy: 565/567 (99.6473%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Global model norm: 16.29780378465531.
Norm before scaling: 16.27789635266083. Distance: 1.5859602752703859
Total norm for 4 adversaries is: 16.27789635266083. distance: 1.5859602752703859
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1118, Accuracy: 8711/8991 (96.8858%)
time spent on training: 107.04249501228333
[foolsgold agg] training data poison_ratio: 0.4032146560663671  data num: [601, 569, 540, 611, 594, 584, 541, 581, 598, 567]
[foolsgold agg] considering poison per batch poison_fraction: 0.4032146560663671
[foolsgold agg] wv: [1.         1.         0.19325753 1.         0.         1.
 1.         0.78414335 0.         0.78414335]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.5025, Accuracy: 8706/10000 (87.0600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.1878, Accuracy: 8647/8991 (96.1740%)
Done in 335.940860748291 sec.
Server Epoch:25 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0031, Accuracy: 543/571 (95.0963%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   2,  Average loss: 0.0014, Accuracy: 555/571 (97.1979%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   3,  Average loss: 0.0005, Accuracy: 568/571 (99.4746%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   4,  Average loss: 0.0004, Accuracy: 570/571 (99.8249%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   5,  Average loss: 0.0003, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   6,  Average loss: 0.0002, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   7,  Average loss: 0.0002, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   8,  Average loss: 0.0002, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Global model norm: 16.318910004362078.
Norm before scaling: 16.278512208331474. Distance: 1.684560617612501
Total norm for 8 adversaries is: 16.278512208331474. distance: 1.684560617612501
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1135, Accuracy: 8696/8991 (96.7189%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0019, Accuracy: 591/609 (97.0443%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   2,  Average loss: 0.0018, Accuracy: 591/609 (97.0443%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   3,  Average loss: 0.0006, Accuracy: 604/609 (99.1790%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   4,  Average loss: 0.0002, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   5,  Average loss: 0.0002, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   6,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   8,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 16.318910004362078.
Norm before scaling: 16.29471106348861. Distance: 1.5310486641692496
Total norm for 8 adversaries is: 16.29471106348861. distance: 1.5310486641692496
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1040, Accuracy: 8726/8991 (97.0526%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 549/577 (95.1473%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   2,  Average loss: 0.0027, Accuracy: 545/577 (94.4541%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   3,  Average loss: 0.0022, Accuracy: 556/577 (96.3605%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   4,  Average loss: 0.0010, Accuracy: 569/577 (98.6135%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   5,  Average loss: 0.0006, Accuracy: 572/577 (99.1334%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   6,  Average loss: 0.0005, Accuracy: 573/577 (99.3068%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   7,  Average loss: 0.0004, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   8,  Average loss: 0.0003, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   9,  Average loss: 0.0003, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch  10,  Average loss: 0.0006, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Global model norm: 16.318910004362078.
Norm before scaling: 16.310265165099537. Distance: 1.9745528668657752
Total norm for 8 adversaries is: 16.310265165099537. distance: 1.9745528668657752
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0977, Accuracy: 8721/8991 (96.9970%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 564/579 (97.4093%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 571/579 (98.6183%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   3,  Average loss: 0.0002, Accuracy: 576/579 (99.4819%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Global model norm: 16.318910004362078.
Norm before scaling: 16.286915326108986. Distance: 1.2458790561276638
Total norm for 8 adversaries is: 16.286915326108986. distance: 1.2458790561276638
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1181, Accuracy: 8717/8991 (96.9525%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0018, Accuracy: 574/588 (97.6190%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0014, Accuracy: 573/588 (97.4490%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   3,  Average loss: 0.0003, Accuracy: 584/588 (99.3197%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   4,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.318910004362078.
Norm before scaling: 16.288703720569185. Distance: 1.4164238702989946
Total norm for 8 adversaries is: 16.288703720569185. distance: 1.4164238702989946
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1249, Accuracy: 8711/8991 (96.8858%)
___Train Local_Simple,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0063, Accuracy: 551/615 (89.5935%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2522, Accuracy: 9271/10000 (92.7100%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0023, Accuracy: 549/571 (96.1471%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   2,  Average loss: 0.0006, Accuracy: 562/571 (98.4238%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   3,  Average loss: 0.0004, Accuracy: 565/571 (98.9492%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   4,  Average loss: 0.0002, Accuracy: 569/571 (99.6497%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   5,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   6,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   7,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   8,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   9,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch  10,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Global model norm: 16.318910004362078.
Norm before scaling: 16.28256296439394. Distance: 1.4925313024257492
Total norm for 8 adversaries is: 16.28256296439394. distance: 1.4925313024257492
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1198, Accuracy: 8714/8991 (96.9191%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0029, Accuracy: 566/593 (95.4469%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   2,  Average loss: 0.0009, Accuracy: 583/593 (98.3137%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   3,  Average loss: 0.0006, Accuracy: 587/593 (98.9882%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   4,  Average loss: 0.0004, Accuracy: 591/593 (99.6627%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   5,  Average loss: 0.0003, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   6,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   7,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   8,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   9,  Average loss: 0.0001, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch  10,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Global model norm: 16.318910004362078.
Norm before scaling: 16.276416141525424. Distance: 1.595642536932102
Total norm for 8 adversaries is: 16.276416141525424. distance: 1.595642536932102
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1125, Accuracy: 8711/8991 (96.8858%)
___Train Local_Simple,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0061, Accuracy: 533/597 (89.2797%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2630, Accuracy: 9204/10000 (92.0400%), Attack Success Rate:0/10000(0.000)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0020, Accuracy: 551/568 (97.0070%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   2,  Average loss: 0.0008, Accuracy: 555/568 (97.7113%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   3,  Average loss: 0.0004, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Global model norm: 16.318910004362078.
Norm before scaling: 16.283296716363214. Distance: 1.4062203298193758
Total norm for 8 adversaries is: 16.283296716363214. distance: 1.4062203298193758
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1009, Accuracy: 8732/8991 (97.1193%)
time spent on training: 158.53807711601257
[foolsgold agg] training data poison_ratio: 0.7934560327198364  data num: [571, 609, 577, 579, 588, 615, 571, 593, 597, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.7934560327198364
[foolsgold agg] wv: [0.98971702 1.         0.98971702 1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.7509, Accuracy: 8745/10000 (87.4500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.1467, Accuracy: 8721/8991 (96.9970%)
Done in 367.739324092865 sec.
Server Epoch:26 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   1,  Average loss: 0.0023, Accuracy: 546/560 (97.5000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   2,  Average loss: 0.0009, Accuracy: 549/560 (98.0357%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   3,  Average loss: 0.0006, Accuracy: 554/560 (98.9286%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   4,  Average loss: 0.0002, Accuracy: 558/560 (99.6429%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Global model norm: 16.3569842525415.
Norm before scaling: 16.289422208258532. Distance: 1.3485762841865212
Total norm for 7 adversaries is: 16.289422208258532. distance: 1.3485762841865212
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0983, Accuracy: 8723/8991 (97.0192%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 576/594 (96.9697%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   2,  Average loss: 0.0022, Accuracy: 575/594 (96.8013%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   3,  Average loss: 0.0021, Accuracy: 569/594 (95.7912%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   4,  Average loss: 0.0008, Accuracy: 582/594 (97.9798%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   5,  Average loss: 0.0007, Accuracy: 586/594 (98.6532%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   6,  Average loss: 0.0003, Accuracy: 590/594 (99.3266%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   7,  Average loss: 0.0003, Accuracy: 592/594 (99.6633%), train_poison_data_count: 594
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   8,  Average loss: 0.0002, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   9,  Average loss: 0.0002, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch  10,  Average loss: 0.0002, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Global model norm: 16.3569842525415.
Norm before scaling: 16.28807607175079. Distance: 1.6809998109852573
Total norm for 7 adversaries is: 16.28807607175079. distance: 1.6809998109852573
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1014, Accuracy: 8741/8991 (97.2194%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   1,  Average loss: 0.0018, Accuracy: 600/620 (96.7742%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   2,  Average loss: 0.0008, Accuracy: 608/620 (98.0645%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   3,  Average loss: 0.0005, Accuracy: 610/620 (98.3871%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   4,  Average loss: 0.0002, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   8,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   9,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch  10,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Global model norm: 16.3569842525415.
Norm before scaling: 16.32877540570633. Distance: 1.4266262946848691
Total norm for 7 adversaries is: 16.32877540570633. distance: 1.4266262946848691
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1208, Accuracy: 8688/8991 (96.6300%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 603/621 (97.1014%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   2,  Average loss: 0.0009, Accuracy: 610/621 (98.2287%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   3,  Average loss: 0.0013, Accuracy: 612/621 (98.5507%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   4,  Average loss: 0.0003, Accuracy: 617/621 (99.3559%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   5,  Average loss: 0.0001, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   6,  Average loss: 0.0001, Accuracy: 620/621 (99.8390%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   7,  Average loss: 0.0001, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Global model norm: 16.3569842525415.
Norm before scaling: 16.323534978351137. Distance: 1.4414782829170407
Total norm for 7 adversaries is: 16.323534978351137. distance: 1.4414782829170407
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1249, Accuracy: 8706/8991 (96.8302%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 571/584 (97.7740%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   2,  Average loss: 0.0017, Accuracy: 569/584 (97.4315%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   3,  Average loss: 0.0011, Accuracy: 567/584 (97.0890%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   4,  Average loss: 0.0004, Accuracy: 581/584 (99.4863%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   5,  Average loss: 0.0002, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Global model norm: 16.3569842525415.
Norm before scaling: 16.31928869006273. Distance: 1.5306698225506095
Total norm for 7 adversaries is: 16.31928869006273. distance: 1.5306698225506095
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1086, Accuracy: 8712/8991 (96.8969%)
___Train Local_Simple,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0061, Accuracy: 544/594 (91.5825%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2352, Accuracy: 9297/10000 (92.9700%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0038, Accuracy: 572/602 (95.0166%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   2,  Average loss: 0.0020, Accuracy: 579/602 (96.1794%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   3,  Average loss: 0.0009, Accuracy: 593/602 (98.5050%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   4,  Average loss: 0.0005, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   5,  Average loss: 0.0003, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   6,  Average loss: 0.0003, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   7,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   8,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   9,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch  10,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 16.3569842525415.
Norm before scaling: 16.308058093748087. Distance: 1.8206873822876914
Total norm for 7 adversaries is: 16.308058093748087. distance: 1.8206873822876914
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0932, Accuracy: 8730/8991 (97.0971%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0020, Accuracy: 552/568 (97.1831%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   2,  Average loss: 0.0009, Accuracy: 554/568 (97.5352%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   3,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   4,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Global model norm: 16.3569842525415.
Norm before scaling: 16.315900776974054. Distance: 1.3536451753871837
Total norm for 7 adversaries is: 16.315900776974054. distance: 1.3536451753871837
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1054, Accuracy: 8717/8991 (96.9525%)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0073, Accuracy: 478/541 (88.3549%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3296, Accuracy: 8950/10000 (89.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 84, internal_epoch   1,  Average loss: 0.0055, Accuracy: 549/601 (91.3478%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1778, Accuracy: 9431/10000 (94.3100%), Attack Success Rate:0/10000(0.000)
time spent on training: 145.6551170349121
[foolsgold agg] training data poison_ratio: 0.7050127442650808  data num: [560, 594, 620, 621, 584, 594, 602, 568, 541, 601]
[foolsgold agg] considering poison per batch poison_fraction: 0.7050127442650808
[foolsgold agg] wv: [0.8302613  0.59173468 1.         0.59173468 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.6830, Accuracy: 8757/10000 (87.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.1364, Accuracy: 8744/8991 (97.2528%)
Done in 370.70602011680603 sec.
Server Epoch:27 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
___Train Local_Simple,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.0065, Accuracy: 516/583 (88.5077%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3750, Accuracy: 8802/10000 (88.0200%), Attack Success Rate:0/10000(0.000)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 565/585 (96.5812%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   2,  Average loss: 0.0017, Accuracy: 568/585 (97.0940%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   3,  Average loss: 0.0014, Accuracy: 571/585 (97.6068%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   4,  Average loss: 0.0005, Accuracy: 580/585 (99.1453%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   5,  Average loss: 0.0003, Accuracy: 582/585 (99.4872%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   6,  Average loss: 0.0002, Accuracy: 583/585 (99.6581%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   7,  Average loss: 0.0002, Accuracy: 584/585 (99.8291%), train_poison_data_count: 585
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   8,  Average loss: 0.0001, Accuracy: 585/585 (100.0000%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   9,  Average loss: 0.0001, Accuracy: 585/585 (100.0000%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch  10,  Average loss: 0.0001, Accuracy: 585/585 (100.0000%), train_poison_data_count: 585
Global model norm: 16.37713935213885.
Norm before scaling: 16.381641700832464. Distance: 1.711657925477903
Total norm for 7 adversaries is: 16.381641700832464. distance: 1.711657925477903
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1233, Accuracy: 8701/8991 (96.7746%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   1,  Average loss: 0.0024, Accuracy: 621/646 (96.1300%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   2,  Average loss: 0.0015, Accuracy: 623/646 (96.4396%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   3,  Average loss: 0.0010, Accuracy: 636/646 (98.4520%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   4,  Average loss: 0.0003, Accuracy: 643/646 (99.5356%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   5,  Average loss: 0.0003, Accuracy: 643/646 (99.5356%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   6,  Average loss: 0.0002, Accuracy: 644/646 (99.6904%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   7,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Global model norm: 16.37713935213885.
Norm before scaling: 16.356501023520337. Distance: 1.7144832710124123
Total norm for 7 adversaries is: 16.356501023520337. distance: 1.7144832710124123
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1172, Accuracy: 8711/8991 (96.8858%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 565/581 (97.2461%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   2,  Average loss: 0.0009, Accuracy: 576/581 (99.1394%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   3,  Average loss: 0.0005, Accuracy: 576/581 (99.1394%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   4,  Average loss: 0.0002, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   8,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.37713935213885.
Norm before scaling: 16.335476066534227. Distance: 1.3737307672655537
Total norm for 7 adversaries is: 16.335476066534227. distance: 1.3737307672655537
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1348, Accuracy: 8677/8991 (96.5076%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 567/579 (97.9275%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   2,  Average loss: 0.0003, Accuracy: 576/579 (99.4819%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   3,  Average loss: 0.0004, Accuracy: 575/579 (99.3092%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Global model norm: 16.37713935213885.
Norm before scaling: 16.329633228787436. Distance: 0.9610410494953663
Total norm for 7 adversaries is: 16.329633228787436. distance: 0.9610410494953663
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1080, Accuracy: 8740/8991 (97.2083%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 589/601 (98.0033%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   2,  Average loss: 0.0006, Accuracy: 592/601 (98.5025%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   3,  Average loss: 0.0003, Accuracy: 598/601 (99.5008%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   4,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Global model norm: 16.37713935213885.
Norm before scaling: 16.339307250485906. Distance: 1.1018854844605532
Total norm for 7 adversaries is: 16.339307250485906. distance: 1.1018854844605532
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1125, Accuracy: 8738/8991 (97.1861%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   1,  Average loss: 0.0024, Accuracy: 548/571 (95.9720%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   2,  Average loss: 0.0013, Accuracy: 557/571 (97.5482%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   3,  Average loss: 0.0004, Accuracy: 567/571 (99.2995%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   4,  Average loss: 0.0003, Accuracy: 569/571 (99.6497%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   5,  Average loss: 0.0002, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   6,  Average loss: 0.0002, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Global model norm: 16.37713935213885.
Norm before scaling: 16.34982017861502. Distance: 1.5644216546216358
Total norm for 7 adversaries is: 16.34982017861502. distance: 1.5644216546216358
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1013, Accuracy: 8716/8991 (96.9414%)
___Train Local_Simple,  epoch  27, local model 54, internal_epoch   1,  Average loss: 0.0076, Accuracy: 478/547 (87.3857%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3559, Accuracy: 8854/10000 (88.5400%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   1,  Average loss: 0.0037, Accuracy: 566/584 (96.9178%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   2,  Average loss: 0.0083, Accuracy: 518/584 (88.6986%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   3,  Average loss: 0.0043, Accuracy: 547/584 (93.6644%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   4,  Average loss: 0.0026, Accuracy: 556/584 (95.2055%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   5,  Average loss: 0.0020, Accuracy: 564/584 (96.5753%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   6,  Average loss: 0.0012, Accuracy: 571/584 (97.7740%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   7,  Average loss: 0.0011, Accuracy: 575/584 (98.4589%), train_poison_data_count: 584
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   8,  Average loss: 0.0007, Accuracy: 579/584 (99.1438%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   9,  Average loss: 0.0007, Accuracy: 581/584 (99.4863%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch  10,  Average loss: 0.0010, Accuracy: 581/584 (99.4863%), train_poison_data_count: 584
Global model norm: 16.37713935213885.
Norm before scaling: 17.049330103626414. Distance: 5.096775771063315
Total norm for 7 adversaries is: 17.049330103626414. distance: 5.096775771063315
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1324, Accuracy: 8618/8991 (95.8514%)
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0065, Accuracy: 536/598 (89.6321%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3014, Accuracy: 8976/10000 (89.7600%), Attack Success Rate:0/10000(0.000)
time spent on training: 148.30070614814758
[foolsgold agg] training data poison_ratio: 0.7058723404255319  data num: [583, 585, 646, 581, 579, 601, 571, 547, 584, 598]
[foolsgold agg] considering poison per batch poison_fraction: 0.7058723404255319
[foolsgold agg] wv: [0.45989339 0.84841021 0.31692336 1.         1.         0.
 0.         0.45989339 1.         0.78154762]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.6343, Accuracy: 8715/10000 (87.1500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.1553, Accuracy: 8698/8991 (96.7412%)
Done in 365.5361249446869 sec.
Server Epoch:28 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   1,  Average loss: 0.0018, Accuracy: 594/612 (97.0588%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   2,  Average loss: 0.0011, Accuracy: 600/612 (98.0392%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   3,  Average loss: 0.0004, Accuracy: 610/612 (99.6732%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   4,  Average loss: 0.0002, Accuracy: 611/612 (99.8366%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   7,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   8,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   9,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch  10,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Global model norm: 16.401995356058247.
Norm before scaling: 16.356829396919252. Distance: 1.358599079597641
Total norm for 5 adversaries is: 16.356829396919252. distance: 1.358599079597641
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1222, Accuracy: 8681/8991 (96.5521%)
___Train Local_Simple,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0058, Accuracy: 545/602 (90.5316%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3286, Accuracy: 8950/10000 (89.5000%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 567/579 (97.9275%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 570/579 (98.4456%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   3,  Average loss: 0.0006, Accuracy: 572/579 (98.7910%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   4,  Average loss: 0.0004, Accuracy: 575/579 (99.3092%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   5,  Average loss: 0.0002, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   9,  Average loss: 0.0002, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Global model norm: 16.401995356058247.
Norm before scaling: 16.379088379174604. Distance: 1.2113524187561822
Total norm for 5 adversaries is: 16.379088379174604. distance: 1.2113524187561822
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1113, Accuracy: 8718/8991 (96.9636%)
___Train Local_Simple,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0044, Accuracy: 548/594 (92.2559%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2598, Accuracy: 9190/10000 (91.9000%), Attack Success Rate:0/10000(0.000)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0015, Accuracy: 596/609 (97.8654%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   2,  Average loss: 0.0003, Accuracy: 607/609 (99.6716%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   3,  Average loss: 0.0003, Accuracy: 605/609 (99.3432%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   4,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   5,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   6,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   8,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   9,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch  10,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 16.401995356058247.
Norm before scaling: 16.36888509245275. Distance: 1.191479640013556
Total norm for 5 adversaries is: 16.36888509245275. distance: 1.191479640013556
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0994, Accuracy: 8747/8991 (97.2862%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.0032, Accuracy: 581/603 (96.3516%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   2,  Average loss: 0.0014, Accuracy: 587/603 (97.3466%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   3,  Average loss: 0.0007, Accuracy: 597/603 (99.0050%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   4,  Average loss: 0.0005, Accuracy: 600/603 (99.5025%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   5,  Average loss: 0.0003, Accuracy: 602/603 (99.8342%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   6,  Average loss: 0.0003, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   7,  Average loss: 0.0002, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   8,  Average loss: 0.0002, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   9,  Average loss: 0.0002, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch  10,  Average loss: 0.0002, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Global model norm: 16.401995356058247.
Norm before scaling: 16.325231501995614. Distance: 1.5118170812203777
Total norm for 5 adversaries is: 16.325231501995614. distance: 1.5118170812203777
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0935, Accuracy: 8742/8991 (97.2306%)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0041, Accuracy: 547/589 (92.8693%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3630, Accuracy: 8797/10000 (87.9700%), Attack Success Rate:0/10000(0.000)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   1,  Average loss: 0.0035, Accuracy: 547/577 (94.8007%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   2,  Average loss: 0.0007, Accuracy: 567/577 (98.2669%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   3,  Average loss: 0.0005, Accuracy: 573/577 (99.3068%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   4,  Average loss: 0.0003, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   5,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   6,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   7,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   8,  Average loss: 0.0005, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   9,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch  10,  Average loss: 0.0001, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Global model norm: 16.401995356058247.
Norm before scaling: 16.387335637226368. Distance: 1.8016087416101392
Total norm for 5 adversaries is: 16.387335637226368. distance: 1.8016087416101392
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0981, Accuracy: 8739/8991 (97.1972%)
___Train Local_Simple,  epoch  28, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 534/594 (89.8990%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6142, Accuracy: 8191/10000 (81.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 81, internal_epoch   1,  Average loss: 0.0055, Accuracy: 524/588 (89.1156%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.4995, Accuracy: 8388/10000 (83.8800%), Attack Success Rate:0/10000(0.000)
time spent on training: 112.78054690361023
[foolsgold agg] training data poison_ratio: 0.5010929880612073  data num: [612, 602, 579, 594, 609, 603, 589, 577, 594, 588]
[foolsgold agg] considering poison per batch poison_fraction: 0.5010929880612073
[foolsgold agg] wv: [1.         0.9070359  1.         0.58280736 1.         1.
 0.63535859 1.         0.58280736 1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.5264, Accuracy: 8734/10000 (87.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.1595, Accuracy: 8666/8991 (96.3853%)
Done in 320.65695691108704 sec.
Server Epoch:29 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
___Train Local_Simple,  epoch  29, local model 58, internal_epoch   1,  Average loss: 0.0052, Accuracy: 528/575 (91.8261%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2432, Accuracy: 9280/10000 (92.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 90, internal_epoch   1,  Average loss: 0.0049, Accuracy: 521/576 (90.4514%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2983, Accuracy: 9138/10000 (91.3800%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0023, Accuracy: 570/584 (97.6027%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   2,  Average loss: 0.0012, Accuracy: 576/584 (98.6301%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   3,  Average loss: 0.0004, Accuracy: 578/584 (98.9726%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   4,  Average loss: 0.0003, Accuracy: 582/584 (99.6575%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   5,  Average loss: 0.0002, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   6,  Average loss: 0.0002, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Global model norm: 16.42436685720811.
Norm before scaling: 16.36692832432028. Distance: 1.467080405067238
Total norm for 5 adversaries is: 16.36692832432028. distance: 1.467080405067238
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0938, Accuracy: 8733/8991 (97.1305%)
___Train Local_Simple,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.0055, Accuracy: 559/605 (92.3967%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2360, Accuracy: 9261/10000 (92.6100%), Attack Success Rate:0/10000(0.000)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0026, Accuracy: 611/635 (96.2205%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0013, Accuracy: 620/635 (97.6378%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0006, Accuracy: 630/635 (99.2126%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0004, Accuracy: 634/635 (99.8425%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0003, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0002, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Global model norm: 16.42436685720811.
Norm before scaling: 16.37493197594411. Distance: 1.6239505460143386
Total norm for 5 adversaries is: 16.37493197594411. distance: 1.6239505460143386
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0842, Accuracy: 8754/8991 (97.3640%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 562/581 (96.7298%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   2,  Average loss: 0.0006, Accuracy: 577/581 (99.3115%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   3,  Average loss: 0.0005, Accuracy: 575/581 (98.9673%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   4,  Average loss: 0.0002, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.42436685720811.
Norm before scaling: 16.377030341387734. Distance: 1.2725883882623819
Total norm for 5 adversaries is: 16.377030341387734. distance: 1.2725883882623819
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1059, Accuracy: 8717/8991 (96.9525%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0030, Accuracy: 566/596 (94.9664%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   2,  Average loss: 0.0012, Accuracy: 584/596 (97.9866%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   3,  Average loss: 0.0006, Accuracy: 590/596 (98.9933%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   4,  Average loss: 0.0004, Accuracy: 592/596 (99.3289%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   5,  Average loss: 0.0003, Accuracy: 595/596 (99.8322%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   6,  Average loss: 0.0002, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   7,  Average loss: 0.0002, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   8,  Average loss: 0.0001, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   9,  Average loss: 0.0001, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch  10,  Average loss: 0.0001, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Global model norm: 16.42436685720811.
Norm before scaling: 16.404519998073322. Distance: 1.7142476846813661
Total norm for 5 adversaries is: 16.404519998073322. distance: 1.7142476846813661
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0923, Accuracy: 8740/8991 (97.2083%)
___Train Local_Simple,  epoch  29, local model 91, internal_epoch   1,  Average loss: 0.0047, Accuracy: 549/597 (91.9598%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2449, Accuracy: 9300/10000 (93.0000%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0019, Accuracy: 548/567 (96.6490%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0011, Accuracy: 552/567 (97.3545%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   3,  Average loss: 0.0003, Accuracy: 566/567 (99.8236%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   4,  Average loss: 0.0002, Accuracy: 566/567 (99.8236%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Global model norm: 16.42436685720811.
Norm before scaling: 16.395016615551775. Distance: 1.3185346924807357
Total norm for 5 adversaries is: 16.395016615551775. distance: 1.3185346924807357
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1003, Accuracy: 8746/8991 (97.2751%)
___Train Local_Simple,  epoch  29, local model 57, internal_epoch   1,  Average loss: 0.0042, Accuracy: 569/605 (94.0496%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2116, Accuracy: 9317/10000 (93.1700%), Attack Success Rate:0/10000(0.000)
time spent on training: 113.82485795021057
[foolsgold agg] training data poison_ratio: 0.500422225975342  data num: [575, 576, 584, 605, 635, 581, 596, 597, 567, 605]
[foolsgold agg] considering poison per batch poison_fraction: 0.500422225975342
[foolsgold agg] wv: [1.         1.         1.         1.         0.80910498 1.
 1.         1.         0.80910498 1.        ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.4520, Accuracy: 8773/10000 (87.7300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.1546, Accuracy: 8673/8991 (96.4631%)
Done in 322.27011609077454 sec.
Server Epoch:30 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   1,  Average loss: 0.0021, Accuracy: 544/567 (95.9436%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   2,  Average loss: 0.0005, Accuracy: 560/567 (98.7654%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Global model norm: 16.440352391830842.
Norm before scaling: 16.40653645583255. Distance: 1.2470920115758515
Total norm for 7 adversaries is: 16.40653645583255. distance: 1.2470920115758515
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0943, Accuracy: 8755/8991 (97.3752%)
___Train Local_Simple,  epoch  30, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 526/565 (93.0973%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1802, Accuracy: 9468/10000 (94.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0049, Accuracy: 563/615 (91.5447%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2860, Accuracy: 9098/10000 (90.9800%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   1,  Average loss: 0.0045, Accuracy: 560/590 (94.9153%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   2,  Average loss: 0.0030, Accuracy: 559/590 (94.7458%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   3,  Average loss: 0.0017, Accuracy: 575/590 (97.4576%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   4,  Average loss: 0.0010, Accuracy: 581/590 (98.4746%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   5,  Average loss: 0.0006, Accuracy: 587/590 (99.4915%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   6,  Average loss: 0.0005, Accuracy: 588/590 (99.6610%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   7,  Average loss: 0.0005, Accuracy: 588/590 (99.6610%), train_poison_data_count: 590
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   8,  Average loss: 0.0004, Accuracy: 588/590 (99.6610%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   9,  Average loss: 0.0003, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch  10,  Average loss: 0.0004, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Global model norm: 16.440352391830842.
Norm before scaling: 16.407665489532818. Distance: 2.033620067870185
Total norm for 7 adversaries is: 16.407665489532818. distance: 2.033620067870185
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0756, Accuracy: 8790/8991 (97.7644%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 610/635 (96.0630%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   2,  Average loss: 0.0015, Accuracy: 616/635 (97.0079%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   3,  Average loss: 0.0008, Accuracy: 629/635 (99.0551%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   4,  Average loss: 0.0005, Accuracy: 632/635 (99.5276%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   5,  Average loss: 0.0003, Accuracy: 632/635 (99.5276%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   6,  Average loss: 0.0002, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   7,  Average loss: 0.0002, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   8,  Average loss: 0.0002, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   9,  Average loss: 0.0002, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch  10,  Average loss: 0.0002, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Global model norm: 16.440352391830842.
Norm before scaling: 16.398125778659413. Distance: 1.6947899641588409
Total norm for 7 adversaries is: 16.398125778659413. distance: 1.6947899641588409
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0807, Accuracy: 8781/8991 (97.6643%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0029, Accuracy: 574/593 (96.7960%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   2,  Average loss: 0.0017, Accuracy: 572/593 (96.4587%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   3,  Average loss: 0.0010, Accuracy: 583/593 (98.3137%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   4,  Average loss: 0.0005, Accuracy: 590/593 (99.4941%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   5,  Average loss: 0.0003, Accuracy: 591/593 (99.6627%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   6,  Average loss: 0.0003, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   7,  Average loss: 0.0003, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   8,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   9,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch  10,  Average loss: 0.0002, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Global model norm: 16.440352391830842.
Norm before scaling: 16.41457842924288. Distance: 1.7431350662854457
Total norm for 7 adversaries is: 16.41457842924288. distance: 1.7431350662854457
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0936, Accuracy: 8752/8991 (97.3418%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0029, Accuracy: 527/548 (96.1679%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   2,  Average loss: 0.0009, Accuracy: 537/548 (97.9927%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   3,  Average loss: 0.0006, Accuracy: 543/548 (99.0876%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   4,  Average loss: 0.0003, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   5,  Average loss: 0.0002, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   6,  Average loss: 0.0002, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   7,  Average loss: 0.0002, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   8,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch  10,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Global model norm: 16.440352391830842.
Norm before scaling: 16.375426774615104. Distance: 1.4587824629413326
Total norm for 7 adversaries is: 16.375426774615104. distance: 1.4587824629413326
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1069, Accuracy: 8700/8991 (96.7634%)
___Train Local_Simple,  epoch  30, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 541/598 (90.4682%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5573, Accuracy: 8432/10000 (84.3200%), Attack Success Rate:0/10000(0.000)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   1,  Average loss: 0.0021, Accuracy: 552/571 (96.6725%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   2,  Average loss: 0.0008, Accuracy: 560/571 (98.0736%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   3,  Average loss: 0.0003, Accuracy: 569/571 (99.6497%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   4,  Average loss: 0.0002, Accuracy: 570/571 (99.8249%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   5,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Global model norm: 16.440352391830842.
Norm before scaling: 16.394270179747632. Distance: 1.34247004740172
Total norm for 7 adversaries is: 16.394270179747632. distance: 1.34247004740172
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1018, Accuracy: 8725/8991 (97.0415%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   1,  Average loss: 0.0035, Accuracy: 570/584 (97.6027%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   2,  Average loss: 0.0041, Accuracy: 563/584 (96.4041%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   3,  Average loss: 0.0030, Accuracy: 544/584 (93.1507%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   4,  Average loss: 0.0009, Accuracy: 578/584 (98.9726%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   5,  Average loss: 0.0007, Accuracy: 578/584 (98.9726%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   6,  Average loss: 0.0006, Accuracy: 579/584 (99.1438%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   7,  Average loss: 0.0004, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   8,  Average loss: 0.0004, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   9,  Average loss: 0.0003, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch  10,  Average loss: 0.0003, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Global model norm: 16.440352391830842.
Norm before scaling: 16.529966019666468. Distance: 2.8667096563560834
Total norm for 7 adversaries is: 16.529966019666468. distance: 2.8667096563560834
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1094, Accuracy: 8695/8991 (96.7078%)
time spent on training: 135.7545268535614
[foolsgold agg] training data poison_ratio: 0.6968973747016707  data num: [567, 565, 615, 590, 635, 593, 548, 598, 571, 584]
[foolsgold agg] considering poison per batch poison_fraction: 0.6968973747016707
[foolsgold agg] wv: [1.         0.         1.         0.05021365 1.         1.
 1.         0.         0.05021365 1.        ]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.5485, Accuracy: 8752/10000 (87.5200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.1513, Accuracy: 8716/8991 (96.9414%)
Done in 341.96582889556885 sec.
Server Epoch:31 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
___Train Local_Simple,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0046, Accuracy: 553/597 (92.6298%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4684, Accuracy: 8738/10000 (87.3800%), Attack Success Rate:0/10000(0.000)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 566/587 (96.4225%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   2,  Average loss: 0.0019, Accuracy: 569/587 (96.9336%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   3,  Average loss: 0.0012, Accuracy: 575/587 (97.9557%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   4,  Average loss: 0.0005, Accuracy: 582/587 (99.1482%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   5,  Average loss: 0.0003, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   6,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   7,  Average loss: 0.0003, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   8,  Average loss: 0.0002, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   9,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch  10,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 16.472154645404146.
Norm before scaling: 16.420423565139657. Distance: 1.8301936777737053
Total norm for 7 adversaries is: 16.420423565139657. distance: 1.8301936777737053
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0999, Accuracy: 8715/8991 (96.9303%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0017, Accuracy: 395/408 (96.8137%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.3115, Accuracy: 8090/10000 (80.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 85, internal_epoch   1,  Average loss: 0.0051, Accuracy: 533/584 (91.2671%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3103, Accuracy: 8985/10000 (89.8500%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 602/621 (96.9404%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   2,  Average loss: 0.0004, Accuracy: 618/621 (99.5169%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   3,  Average loss: 0.0001, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   4,  Average loss: 0.0001, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   5,  Average loss: 0.0001, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   6,  Average loss: 0.0001, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   7,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Global model norm: 16.472154645404146.
Norm before scaling: 16.433866266013567. Distance: 1.3550299558108354
Total norm for 7 adversaries is: 16.433866266013567. distance: 1.3550299558108354
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1114, Accuracy: 8729/8991 (97.0860%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0028, Accuracy: 560/577 (97.0537%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   2,  Average loss: 0.0008, Accuracy: 568/577 (98.4402%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 575/577 (99.6534%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 576/577 (99.8267%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   6,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   7,  Average loss: 0.0001, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   8,  Average loss: 0.0001, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   9,  Average loss: 0.0001, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Global model norm: 16.472154645404146.
Norm before scaling: 16.405954238405528. Distance: 1.4473616636383158
Total norm for 7 adversaries is: 16.405954238405528. distance: 1.4473616636383158
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0845, Accuracy: 8774/8991 (97.5865%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   1,  Average loss: 0.0028, Accuracy: 583/603 (96.6833%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   2,  Average loss: 0.0007, Accuracy: 595/603 (98.6733%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   3,  Average loss: 0.0008, Accuracy: 594/603 (98.5075%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   4,  Average loss: 0.0004, Accuracy: 599/603 (99.3367%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   5,  Average loss: 0.0002, Accuracy: 602/603 (99.8342%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   6,  Average loss: 0.0002, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   7,  Average loss: 0.0002, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   8,  Average loss: 0.0001, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   9,  Average loss: 0.0001, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch  10,  Average loss: 0.0001, Accuracy: 603/603 (100.0000%), train_poison_data_count: 603
Global model norm: 16.472154645404146.
Norm before scaling: 16.398181609782892. Distance: 1.441341243611619
Total norm for 7 adversaries is: 16.398181609782892. distance: 1.441341243611619
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0842, Accuracy: 8775/8991 (97.5976%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0022, Accuracy: 626/646 (96.9040%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   2,  Average loss: 0.0006, Accuracy: 636/646 (98.4520%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   4,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Global model norm: 16.472154645404146.
Norm before scaling: 16.41655182515881. Distance: 1.4314401858374988
Total norm for 7 adversaries is: 16.41655182515881. distance: 1.4314401858374988
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1032, Accuracy: 8736/8991 (97.1638%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0031, Accuracy: 576/602 (95.6811%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   2,  Average loss: 0.0023, Accuracy: 572/602 (95.0166%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   3,  Average loss: 0.0014, Accuracy: 591/602 (98.1728%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   4,  Average loss: 0.0008, Accuracy: 595/602 (98.8372%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   5,  Average loss: 0.0004, Accuracy: 601/602 (99.8339%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   6,  Average loss: 0.0003, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   7,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   8,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   9,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch  10,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 16.472154645404146.
Norm before scaling: 16.486287285408782. Distance: 1.8758999889816885
Total norm for 7 adversaries is: 16.486287285408782. distance: 1.8758999889816885
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0891, Accuracy: 8749/8991 (97.3084%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   1,  Average loss: 0.0015, Accuracy: 565/581 (97.2461%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   2,  Average loss: 0.0008, Accuracy: 572/581 (98.4509%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   3,  Average loss: 0.0002, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   4,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch  10,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.472154645404146.
Norm before scaling: 16.429021585113965. Distance: 1.2981901279764645
Total norm for 7 adversaries is: 16.429021585113965. distance: 1.2981901279764645
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1074, Accuracy: 8702/8991 (96.7857%)
time spent on training: 137.68808507919312
[foolsgold agg] training data poison_ratio: 0.726317602480193  data num: [597, 587, 408, 584, 621, 577, 603, 646, 602, 581]
[foolsgold agg] considering poison per batch poison_fraction: 0.726317602480193
[foolsgold agg] wv: [1.         1.         1.         1.         0.90262642 0.46025918
 0.90262642 0.46025918 0.50058127 1.        ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.6138, Accuracy: 8780/10000 (87.8000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.1322, Accuracy: 8745/8991 (97.2639%)
Done in 343.72403621673584 sec.
Server Epoch:32 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 473/508 (93.1102%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2675, Accuracy: 9189/10000 (91.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.0044, Accuracy: 551/591 (93.2318%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2703, Accuracy: 9141/10000 (91.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 55, internal_epoch   1,  Average loss: 0.0059, Accuracy: 533/595 (89.5798%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3615, Accuracy: 8791/10000 (87.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 70, internal_epoch   1,  Average loss: 0.0065, Accuracy: 548/610 (89.8361%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2976, Accuracy: 9055/10000 (90.5500%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0026, Accuracy: 537/556 (96.5827%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   2,  Average loss: 0.0010, Accuracy: 547/556 (98.3813%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   3,  Average loss: 0.0003, Accuracy: 553/556 (99.4604%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Global model norm: 16.494589178514534.
Norm before scaling: 16.420693047379274. Distance: 1.3925535994372364
Total norm for 2 adversaries is: 16.420693047379274. distance: 1.3925535994372364
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0942, Accuracy: 8724/8991 (97.0304%)
___Train Local_Simple,  epoch  32, local model 90, internal_epoch   1,  Average loss: 0.0037, Accuracy: 534/576 (92.7083%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2449, Accuracy: 9229/10000 (92.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 91, internal_epoch   1,  Average loss: 0.0058, Accuracy: 542/597 (90.7873%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3473, Accuracy: 8804/10000 (88.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 86, internal_epoch   1,  Average loss: 0.0047, Accuracy: 557/609 (91.4614%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3005, Accuracy: 9041/10000 (90.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 67, internal_epoch   1,  Average loss: 0.0052, Accuracy: 525/570 (92.1053%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3820, Accuracy: 8665/10000 (86.6500%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 575/588 (97.7891%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 584/588 (99.3197%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   3,  Average loss: 0.0003, Accuracy: 586/588 (99.6599%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   4,  Average loss: 0.0001, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.494589178514534.
Norm before scaling: 16.462803384104173. Distance: 1.1151138481041762
Total norm for 2 adversaries is: 16.462803384104173. distance: 1.1151138481041762
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.1235, Accuracy: 8734/8991 (97.1416%)
time spent on training: 76.7538390159607
[foolsgold agg] training data poison_ratio: 0.19724137931034483  data num: [508, 591, 595, 610, 556, 576, 597, 609, 570, 588]
[foolsgold agg] considering poison per batch poison_fraction: 0.19724137931034483
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.28317415
 0.34602143 0.03877452 0.03877452 1.        ]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.4404, Accuracy: 8821/10000 (88.2100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.1332, Accuracy: 8716/8991 (96.9414%)
Done in 283.24374175071716 sec.
Server Epoch:33 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
___Train Local_Simple,  epoch  33, local model 77, internal_epoch   1,  Average loss: 0.0037, Accuracy: 524/565 (92.7434%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2036, Accuracy: 9391/10000 (93.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0037, Accuracy: 565/605 (93.3884%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2125, Accuracy: 9378/10000 (93.7800%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   1,  Average loss: 0.0023, Accuracy: 568/590 (96.2712%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   2,  Average loss: 0.0012, Accuracy: 576/590 (97.6271%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   3,  Average loss: 0.0008, Accuracy: 583/590 (98.8136%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   4,  Average loss: 0.0005, Accuracy: 587/590 (99.4915%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   5,  Average loss: 0.0003, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   6,  Average loss: 0.0002, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   7,  Average loss: 0.0002, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   8,  Average loss: 0.0002, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   9,  Average loss: 0.0002, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch  10,  Average loss: 0.0002, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Global model norm: 16.491721185970288.
Norm before scaling: 16.443719303765057. Distance: 1.3862084967795734
Total norm for 4 adversaries is: 16.443719303765057. distance: 1.3862084967795734
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0728, Accuracy: 8811/8991 (97.9980%)
___Train Local_Simple,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.0045, Accuracy: 521/570 (91.4035%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2152, Accuracy: 9357/10000 (93.5700%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0020, Accuracy: 578/594 (97.3064%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   2,  Average loss: 0.0012, Accuracy: 581/594 (97.8114%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   3,  Average loss: 0.0005, Accuracy: 588/594 (98.9899%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   4,  Average loss: 0.0004, Accuracy: 592/594 (99.6633%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   5,  Average loss: 0.0002, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Global model norm: 16.491721185970288.
Norm before scaling: 16.437961354326397. Distance: 1.4220528962910814
Total norm for 4 adversaries is: 16.437961354326397. distance: 1.4220528962910814
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0932, Accuracy: 8766/8991 (97.4975%)
___Train Local_Simple,  epoch  33, local model 97, internal_epoch   1,  Average loss: 0.0052, Accuracy: 490/539 (90.9091%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.4155, Accuracy: 8839/10000 (88.3900%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0018, Accuracy: 549/566 (96.9965%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   2,  Average loss: 0.0007, Accuracy: 558/566 (98.5866%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   3,  Average loss: 0.0002, Accuracy: 565/566 (99.8233%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   4,  Average loss: 0.0001, Accuracy: 565/566 (99.8233%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   5,  Average loss: 0.0001, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   6,  Average loss: 0.0001, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Global model norm: 16.491721185970288.
Norm before scaling: 16.457021514505783. Distance: 1.1848509000984775
Total norm for 4 adversaries is: 16.457021514505783. distance: 1.1848509000984775
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0990, Accuracy: 8740/8991 (97.2083%)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   1,  Average loss: 0.0031, Accuracy: 555/581 (95.5250%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   2,  Average loss: 0.0045, Accuracy: 539/581 (92.7711%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   3,  Average loss: 0.0015, Accuracy: 566/581 (97.4182%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   4,  Average loss: 0.0010, Accuracy: 571/581 (98.2788%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   5,  Average loss: 0.0007, Accuracy: 576/581 (99.1394%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   6,  Average loss: 0.0008, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   7,  Average loss: 0.0005, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   8,  Average loss: 0.0006, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   9,  Average loss: 0.0005, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch  10,  Average loss: 0.0004, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Global model norm: 16.491721185970288.
Norm before scaling: 16.618705303566728. Distance: 2.7695070596561235
Total norm for 4 adversaries is: 16.618705303566728. distance: 2.7695070596561235
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0976, Accuracy: 8737/8991 (97.1750%)
___Train Local_Simple,  epoch  33, local model 70, internal_epoch   1,  Average loss: 0.0073, Accuracy: 535/610 (87.7049%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3507, Accuracy: 8892/10000 (88.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0045, Accuracy: 467/508 (91.9291%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1519, Accuracy: 9531/10000 (95.3100%), Attack Success Rate:0/10000(0.000)
time spent on training: 100.64067602157593
[foolsgold agg] training data poison_ratio: 0.4069483240223464  data num: [565, 605, 590, 570, 594, 539, 566, 581, 610, 508]
[foolsgold agg] considering poison per batch poison_fraction: 0.4069483240223464
[foolsgold agg] wv: [1.         1.         1.         0.59011419 1.         0.59011419
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.3693, Accuracy: 8872/10000 (88.7200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.1373, Accuracy: 8669/8991 (96.4186%)
Done in 314.6678819656372 sec.
Server Epoch:34 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0013, Accuracy: 588/601 (97.8369%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   2,  Average loss: 0.0011, Accuracy: 590/601 (98.1697%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   3,  Average loss: 0.0009, Accuracy: 586/601 (97.5042%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   4,  Average loss: 0.0003, Accuracy: 598/601 (99.5008%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Global model norm: 16.508664717117114.
Norm before scaling: 16.477381143721498. Distance: 1.2157232406655254
Total norm for 7 adversaries is: 16.477381143721498. distance: 1.2157232406655254
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0938, Accuracy: 8763/8991 (97.4641%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0036, Accuracy: 605/637 (94.9765%), train_poison_data_count: 637
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   2,  Average loss: 0.0011, Accuracy: 623/637 (97.8022%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   3,  Average loss: 0.0008, Accuracy: 625/637 (98.1162%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   4,  Average loss: 0.0004, Accuracy: 634/637 (99.5290%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   5,  Average loss: 0.0003, Accuracy: 636/637 (99.8430%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   6,  Average loss: 0.0002, Accuracy: 636/637 (99.8430%), train_poison_data_count: 637
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   7,  Average loss: 0.0002, Accuracy: 637/637 (100.0000%), train_poison_data_count: 637
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   8,  Average loss: 0.0002, Accuracy: 637/637 (100.0000%), train_poison_data_count: 637
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   9,  Average loss: 0.0002, Accuracy: 637/637 (100.0000%), train_poison_data_count: 637
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch  10,  Average loss: 0.0002, Accuracy: 637/637 (100.0000%), train_poison_data_count: 637
Global model norm: 16.508664717117114.
Norm before scaling: 16.460259871256493. Distance: 1.7111989696799195
Total norm for 7 adversaries is: 16.460259871256493. distance: 1.7111989696799195
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0850, Accuracy: 8747/8991 (97.2862%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0019, Accuracy: 614/635 (96.6929%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 632/635 (99.5276%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0003, Accuracy: 632/635 (99.5276%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Global model norm: 16.508664717117114.
Norm before scaling: 16.467121079902103. Distance: 1.366924413163764
Total norm for 7 adversaries is: 16.467121079902103. distance: 1.366924413163764
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0796, Accuracy: 8765/8991 (97.4864%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0013, Accuracy: 549/567 (96.8254%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0005, Accuracy: 561/567 (98.9418%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   3,  Average loss: 0.0003, Accuracy: 564/567 (99.4709%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Global model norm: 16.508664717117114.
Norm before scaling: 16.498370465817032. Distance: 1.158248617427074
Total norm for 7 adversaries is: 16.498370465817032. distance: 1.158248617427074
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0962, Accuracy: 8757/8991 (97.3974%)
___Train Local_Simple,  epoch  34, local model 71, internal_epoch   1,  Average loss: 0.0045, Accuracy: 570/637 (89.4819%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3250, Accuracy: 8991/10000 (89.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 60, internal_epoch   1,  Average loss: 0.0026, Accuracy: 575/600 (95.8333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1867, Accuracy: 9428/10000 (94.2800%), Attack Success Rate:0/10000(0.000)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0022, Accuracy: 625/646 (96.7492%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   2,  Average loss: 0.0035, Accuracy: 621/646 (96.1300%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   3,  Average loss: 0.0017, Accuracy: 624/646 (96.5944%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   4,  Average loss: 0.0008, Accuracy: 639/646 (98.9164%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   5,  Average loss: 0.0005, Accuracy: 644/646 (99.6904%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   6,  Average loss: 0.0003, Accuracy: 645/646 (99.8452%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   7,  Average loss: 0.0003, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   8,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Global model norm: 16.508664717117114.
Norm before scaling: 16.64338665464266. Distance: 2.7061287832974195
Total norm for 7 adversaries is: 16.64338665464266. distance: 2.7061287832974195
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1089, Accuracy: 8711/8991 (96.8858%)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0061, Accuracy: 549/611 (89.8527%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2564, Accuracy: 9192/10000 (91.9200%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.0020, Accuracy: 557/573 (97.2077%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   2,  Average loss: 0.0005, Accuracy: 567/573 (98.9529%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   3,  Average loss: 0.0004, Accuracy: 569/573 (99.3019%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   4,  Average loss: 0.0002, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.508664717117114.
Norm before scaling: 16.456846274625057. Distance: 1.2161630415532847
Total norm for 7 adversaries is: 16.456846274625057. distance: 1.2161630415532847
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0943, Accuracy: 8744/8991 (97.2528%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   1,  Average loss: 0.0015, Accuracy: 562/573 (98.0803%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 570/573 (99.4764%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   3,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   9,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch  10,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.508664717117114.
Norm before scaling: 16.45676560802103. Distance: 1.039826363318586
Total norm for 7 adversaries is: 16.45676560802103. distance: 1.039826363318586
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0910, Accuracy: 8774/8991 (97.5865%)
time spent on training: 151.294903755188
[foolsgold agg] training data poison_ratio: 0.6960526315789474  data num: [601, 637, 635, 567, 637, 600, 646, 611, 573, 573]
[foolsgold agg] considering poison per batch poison_fraction: 0.6960526315789474
[foolsgold agg] wv: [0.64243303 1.         0.64243303 1.         1.         1.
 0.85188227 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.3865, Accuracy: 8865/10000 (88.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.1201, Accuracy: 8717/8991 (96.9525%)
Done in 372.7395188808441 sec.
Server Epoch:35 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   1,  Average loss: 0.0010, Accuracy: 554/567 (97.7072%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   2,  Average loss: 0.0009, Accuracy: 557/567 (98.2363%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   3,  Average loss: 0.0010, Accuracy: 552/567 (97.3545%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   4,  Average loss: 0.0002, Accuracy: 565/567 (99.6473%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Global model norm: 16.538221075667607.
Norm before scaling: 16.518892511741008. Distance: 1.1015019501622512
Total norm for 6 adversaries is: 16.518892511741008. distance: 1.1015019501622512
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0934, Accuracy: 8767/8991 (97.5086%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0024, Accuracy: 577/601 (96.0067%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   2,  Average loss: 0.0011, Accuracy: 588/601 (97.8369%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   3,  Average loss: 0.0008, Accuracy: 591/601 (98.3361%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   4,  Average loss: 0.0003, Accuracy: 597/601 (99.3344%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   5,  Average loss: 0.0002, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   6,  Average loss: 0.0002, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   7,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   8,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Global model norm: 16.538221075667607.
Norm before scaling: 16.501690402283412. Distance: 1.4978532529237674
Total norm for 6 adversaries is: 16.501690402283412. distance: 1.4978532529237674
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0945, Accuracy: 8721/8991 (96.9970%)
___Train Local_Simple,  epoch  35, local model 53, internal_epoch   1,  Average loss: 0.0040, Accuracy: 526/568 (92.6056%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1977, Accuracy: 9383/10000 (93.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.0034, Accuracy: 534/565 (94.5133%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2070, Accuracy: 9418/10000 (94.1800%), Attack Success Rate:0/10000(0.000)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 599/612 (97.8758%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   2,  Average loss: 0.0004, Accuracy: 608/612 (99.3464%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   3,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   6,  Average loss: 0.0000, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Global model norm: 16.538221075667607.
Norm before scaling: 16.47852384307754. Distance: 1.125557178697193
Total norm for 6 adversaries is: 16.47852384307754. distance: 1.125557178697193
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1100, Accuracy: 8721/8991 (96.9970%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 565/581 (97.2461%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   2,  Average loss: 0.0003, Accuracy: 577/581 (99.3115%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   3,  Average loss: 0.0002, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   4,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   7,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   8,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   9,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch  10,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.538221075667607.
Norm before scaling: 16.492291123549396. Distance: 1.177448649248504
Total norm for 6 adversaries is: 16.492291123549396. distance: 1.177448649248504
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0949, Accuracy: 8742/8991 (97.2306%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0027, Accuracy: 536/556 (96.4029%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   2,  Average loss: 0.0009, Accuracy: 546/556 (98.2014%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   3,  Average loss: 0.0003, Accuracy: 555/556 (99.8201%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   4,  Average loss: 0.0002, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   5,  Average loss: 0.0002, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   6,  Average loss: 0.0002, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Global model norm: 16.538221075667607.
Norm before scaling: 16.474044267315914. Distance: 1.3591458796196592
Total norm for 6 adversaries is: 16.474044267315914. distance: 1.3591458796196592
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0828, Accuracy: 8744/8991 (97.2528%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 576/600 (96.0000%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   2,  Average loss: 0.0013, Accuracy: 589/600 (98.1667%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   3,  Average loss: 0.0011, Accuracy: 589/600 (98.1667%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   4,  Average loss: 0.0007, Accuracy: 595/600 (99.1667%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   5,  Average loss: 0.0004, Accuracy: 596/600 (99.3333%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   6,  Average loss: 0.0003, Accuracy: 597/600 (99.5000%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   7,  Average loss: 0.0003, Accuracy: 597/600 (99.5000%), train_poison_data_count: 600
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   8,  Average loss: 0.0002, Accuracy: 598/600 (99.6667%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   9,  Average loss: 0.0002, Accuracy: 599/600 (99.8333%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch  10,  Average loss: 0.0002, Accuracy: 599/600 (99.8333%), train_poison_data_count: 600
Global model norm: 16.538221075667607.
Norm before scaling: 16.46059544465443. Distance: 1.6472902328248893
Total norm for 6 adversaries is: 16.46059544465443. distance: 1.6472902328248893
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0847, Accuracy: 8750/8991 (97.3195%)
___Train Local_Simple,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0041, Accuracy: 528/569 (92.7944%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1758, Accuracy: 9450/10000 (94.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 98, internal_epoch   1,  Average loss: 0.0024, Accuracy: 477/499 (95.5912%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1348, Accuracy: 9599/10000 (95.9900%), Attack Success Rate:0/10000(0.000)
time spent on training: 133.81761813163757
[foolsgold agg] training data poison_ratio: 0.6150752011192725  data num: [567, 601, 568, 565, 612, 581, 556, 600, 569, 499]
[foolsgold agg] considering poison per batch poison_fraction: 0.6150752011192725
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.4551, Accuracy: 8827/10000 (88.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.1045, Accuracy: 8746/8991 (97.2751%)
Done in 455.90632700920105 sec.
Server Epoch:36 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  36, local model 82, internal_epoch   1,  Average loss: 0.0037, Accuracy: 554/589 (94.0577%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2302, Accuracy: 9330/10000 (93.3000%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0012, Accuracy: 607/621 (97.7456%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   2,  Average loss: 0.0003, Accuracy: 618/621 (99.5169%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   3,  Average loss: 0.0002, Accuracy: 619/621 (99.6779%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   4,  Average loss: 0.0001, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   5,  Average loss: 0.0001, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   6,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   7,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 621/621 (100.0000%), train_poison_data_count: 621
Global model norm: 16.55647738377264.
Norm before scaling: 16.52320570907162. Distance: 1.1979277679371259
Total norm for 5 adversaries is: 16.52320570907162. distance: 1.1979277679371259
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0891, Accuracy: 8758/8991 (97.4085%)
___Train Local_Simple,  epoch  36, local model 79, internal_epoch   1,  Average loss: 0.0043, Accuracy: 520/565 (92.0354%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2266, Accuracy: 9299/10000 (92.9900%), Attack Success Rate:0/10000(0.000)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0015, Accuracy: 605/620 (97.5806%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   2,  Average loss: 0.0007, Accuracy: 612/620 (98.7097%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   3,  Average loss: 0.0004, Accuracy: 615/620 (99.1935%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   4,  Average loss: 0.0002, Accuracy: 618/620 (99.6774%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   8,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   9,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch  10,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Global model norm: 16.55647738377264.
Norm before scaling: 16.518672665527923. Distance: 1.2483176831553369
Total norm for 5 adversaries is: 16.518672665527923. distance: 1.2483176831553369
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0906, Accuracy: 8754/8991 (97.3640%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   1,  Average loss: 0.0018, Accuracy: 557/574 (97.0383%), train_poison_data_count: 574
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   2,  Average loss: 0.0006, Accuracy: 566/574 (98.6063%), train_poison_data_count: 574
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   3,  Average loss: 0.0002, Accuracy: 572/574 (99.6516%), train_poison_data_count: 574
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   4,  Average loss: 0.0001, Accuracy: 573/574 (99.8258%), train_poison_data_count: 574
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   5,  Average loss: 0.0001, Accuracy: 574/574 (100.0000%), train_poison_data_count: 574
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   6,  Average loss: 0.0001, Accuracy: 574/574 (100.0000%), train_poison_data_count: 574
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   7,  Average loss: 0.0001, Accuracy: 574/574 (100.0000%), train_poison_data_count: 574
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   8,  Average loss: 0.0001, Accuracy: 574/574 (100.0000%), train_poison_data_count: 574
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   9,  Average loss: 0.0001, Accuracy: 574/574 (100.0000%), train_poison_data_count: 574
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch  10,  Average loss: 0.0001, Accuracy: 574/574 (100.0000%), train_poison_data_count: 574
Global model norm: 16.55647738377264.
Norm before scaling: 16.512294927994187. Distance: 1.1296227633129188
Total norm for 5 adversaries is: 16.512294927994187. distance: 1.1296227633129188
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0898, Accuracy: 8770/8991 (97.5420%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   1,  Average loss: 0.0023, Accuracy: 588/608 (96.7105%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   2,  Average loss: 0.0016, Accuracy: 593/608 (97.5329%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   3,  Average loss: 0.0005, Accuracy: 603/608 (99.1776%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   4,  Average loss: 0.0003, Accuracy: 607/608 (99.8355%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   5,  Average loss: 0.0002, Accuracy: 607/608 (99.8355%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   6,  Average loss: 0.0002, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   7,  Average loss: 0.0002, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   8,  Average loss: 0.0002, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   9,  Average loss: 0.0001, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch  10,  Average loss: 0.0001, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Global model norm: 16.55647738377264.
Norm before scaling: 16.490886598976797. Distance: 1.4042823589142388
Total norm for 5 adversaries is: 16.490886598976797. distance: 1.4042823589142388
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0788, Accuracy: 8764/8991 (97.4753%)
___Train Local_Simple,  epoch  36, local model 89, internal_epoch   1,  Average loss: 0.0051, Accuracy: 554/594 (93.2660%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1704, Accuracy: 9502/10000 (95.0200%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   1,  Average loss: 0.0014, Accuracy: 561/573 (97.9058%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 568/573 (99.1274%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   3,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.55647738377264.
Norm before scaling: 16.50320218542592. Distance: 1.0079648398064949
Total norm for 5 adversaries is: 16.50320218542592. distance: 1.0079648398064949
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0897, Accuracy: 8768/8991 (97.5197%)
___Train Local_Simple,  epoch  36, local model 70, internal_epoch   1,  Average loss: 0.0044, Accuracy: 563/610 (92.2951%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1943, Accuracy: 9423/10000 (94.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 77, internal_epoch   1,  Average loss: 0.0035, Accuracy: 527/565 (93.2743%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1741, Accuracy: 9389/10000 (93.8900%), Attack Success Rate:0/10000(0.000)
time spent on training: 184.64665722846985
[foolsgold agg] training data poison_ratio: 0.506166582192938  data num: [589, 621, 565, 620, 574, 608, 594, 573, 610, 565]
[foolsgold agg] considering poison per batch poison_fraction: 0.506166582192938
[foolsgold agg] wv: [0.10824781 1.         1.         1.         1.         1.
 0.59176685 1.         1.         0.10824781]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.4738, Accuracy: 8825/10000 (88.2500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.1003, Accuracy: 8762/8991 (97.4530%)
Done in 423.16996002197266 sec.
Server Epoch:37 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0027, Accuracy: 573/597 (95.9799%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   2,  Average loss: 0.0025, Accuracy: 573/597 (95.9799%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   3,  Average loss: 0.0012, Accuracy: 584/597 (97.8224%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   4,  Average loss: 0.0008, Accuracy: 588/597 (98.4925%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   5,  Average loss: 0.0006, Accuracy: 592/597 (99.1625%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   6,  Average loss: 0.0004, Accuracy: 594/597 (99.4975%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   7,  Average loss: 0.0004, Accuracy: 595/597 (99.6650%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   8,  Average loss: 0.0003, Accuracy: 595/597 (99.6650%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   9,  Average loss: 0.0003, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch  10,  Average loss: 0.0003, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Global model norm: 16.56796232154942.
Norm before scaling: 16.56974432518357. Distance: 1.9642700207070964
Total norm for 7 adversaries is: 16.56974432518357. distance: 1.9642700207070964
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0881, Accuracy: 8745/8991 (97.2639%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0007, Accuracy: 581/584 (99.4863%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0003, Accuracy: 581/584 (99.4863%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   3,  Average loss: 0.0003, Accuracy: 581/584 (99.4863%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   5,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   6,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   7,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   8,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Global model norm: 16.56796232154942.
Norm before scaling: 16.53289382924661. Distance: 0.8521170604034312
Total norm for 7 adversaries is: 16.53289382924661. distance: 0.8521170604034312
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0944, Accuracy: 8763/8991 (97.4641%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   1,  Average loss: 0.0014, Accuracy: 597/612 (97.5490%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   2,  Average loss: 0.0011, Accuracy: 598/612 (97.7124%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   3,  Average loss: 0.0004, Accuracy: 608/612 (99.3464%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   4,  Average loss: 0.0002, Accuracy: 610/612 (99.6732%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   7,  Average loss: 0.0001, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 612/612 (100.0000%), train_poison_data_count: 612
Global model norm: 16.56796232154942.
Norm before scaling: 16.5140515230236. Distance: 1.1410765603212554
Total norm for 7 adversaries is: 16.5140515230236. distance: 1.1410765603212554
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0952, Accuracy: 8745/8991 (97.2639%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0018, Accuracy: 617/635 (97.1654%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 630/635 (99.2126%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 631/635 (99.3701%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 633/635 (99.6850%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Global model norm: 16.56796232154942.
Norm before scaling: 16.529325376799545. Distance: 1.2194201754243172
Total norm for 7 adversaries is: 16.529325376799545. distance: 1.2194201754243172
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0829, Accuracy: 8762/8991 (97.4530%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 561/580 (96.7241%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   2,  Average loss: 0.0012, Accuracy: 571/580 (98.4483%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   3,  Average loss: 0.0008, Accuracy: 573/580 (98.7931%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   4,  Average loss: 0.0003, Accuracy: 577/580 (99.4828%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   5,  Average loss: 0.0002, Accuracy: 578/580 (99.6552%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   6,  Average loss: 0.0003, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   7,  Average loss: 0.0002, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   8,  Average loss: 0.0001, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   9,  Average loss: 0.0006, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch  10,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Global model norm: 16.56796232154942.
Norm before scaling: 16.52885734102633. Distance: 1.5031738082987351
Total norm for 7 adversaries is: 16.52885734102633. distance: 1.5031738082987351
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0800, Accuracy: 8790/8991 (97.7644%)
___Train Local_Simple,  epoch  37, local model 52, internal_epoch   1,  Average loss: 0.0043, Accuracy: 558/598 (93.3110%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1968, Accuracy: 9390/10000 (93.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.0041, Accuracy: 560/601 (93.1780%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1657, Accuracy: 9484/10000 (94.8400%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 558/571 (97.7233%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   2,  Average loss: 0.0006, Accuracy: 563/571 (98.5989%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   3,  Average loss: 0.0003, Accuracy: 568/571 (99.4746%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   4,  Average loss: 0.0002, Accuracy: 569/571 (99.6497%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   5,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   6,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   7,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Global model norm: 16.56796232154942.
Norm before scaling: 16.508093496188657. Distance: 1.0340567453592602
Total norm for 7 adversaries is: 16.508093496188657. distance: 1.0340567453592602
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0809, Accuracy: 8793/8991 (97.7978%)
___Train Local_Simple,  epoch  37, local model 62, internal_epoch   1,  Average loss: 0.0056, Accuracy: 527/582 (90.5498%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2793, Accuracy: 9123/10000 (91.2300%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0018, Accuracy: 551/567 (97.1781%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   2,  Average loss: 0.0005, Accuracy: 561/567 (98.9418%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   3,  Average loss: 0.0002, Accuracy: 566/567 (99.8236%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   4,  Average loss: 0.0002, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Global model norm: 16.56796232154942.
Norm before scaling: 16.513888900296262. Distance: 1.1484364619866696
Total norm for 7 adversaries is: 16.513888900296262. distance: 1.1484364619866696
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0998, Accuracy: 8744/8991 (97.2528%)
time spent on training: 193.17865014076233
[foolsgold agg] training data poison_ratio: 0.6995107136831449  data num: [597, 584, 612, 635, 580, 598, 601, 571, 582, 567]
[foolsgold agg] considering poison per batch poison_fraction: 0.6995107136831449
[foolsgold agg] wv: [1.         1.         1.         0.51889928 1.         0.
 0.         1.         1.         0.51889928]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.5861, Accuracy: 8811/10000 (88.1100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.0944, Accuracy: 8779/8991 (97.6421%)
Done in 419.21673488616943 sec.
Server Epoch:38 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0018, Accuracy: 545/560 (97.3214%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   2,  Average loss: 0.0006, Accuracy: 551/560 (98.3929%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   3,  Average loss: 0.0004, Accuracy: 557/560 (99.4643%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   4,  Average loss: 0.0002, Accuracy: 559/560 (99.8214%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   5,  Average loss: 0.0002, Accuracy: 559/560 (99.8214%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Global model norm: 16.591404980841173.
Norm before scaling: 16.548305201116424. Distance: 1.2337970587848859
Total norm for 5 adversaries is: 16.548305201116424. distance: 1.2337970587848859
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0792, Accuracy: 8760/8991 (97.4308%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   1,  Average loss: 0.0031, Accuracy: 552/573 (96.3351%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   2,  Average loss: 0.0018, Accuracy: 559/573 (97.5567%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   3,  Average loss: 0.0009, Accuracy: 562/573 (98.0803%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   4,  Average loss: 0.0005, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   5,  Average loss: 0.0003, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   6,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   8,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.591404980841173.
Norm before scaling: 16.51355163783105. Distance: 1.4700567235836817
Total norm for 5 adversaries is: 16.51355163783105. distance: 1.4700567235836817
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0854, Accuracy: 8762/8991 (97.4530%)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 548/591 (92.7242%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1965, Accuracy: 9412/10000 (94.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0040, Accuracy: 578/617 (93.6791%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1529, Accuracy: 9519/10000 (95.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0039, Accuracy: 534/568 (94.0141%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2057, Accuracy: 9377/10000 (93.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 83, internal_epoch   1,  Average loss: 0.0051, Accuracy: 562/611 (91.9804%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2298, Accuracy: 9397/10000 (93.9700%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0022, Accuracy: 586/601 (97.5042%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   2,  Average loss: 0.0011, Accuracy: 587/601 (97.6705%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   3,  Average loss: 0.0005, Accuracy: 598/601 (99.5008%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   4,  Average loss: 0.0004, Accuracy: 598/601 (99.5008%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   5,  Average loss: 0.0003, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   6,  Average loss: 0.0002, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   7,  Average loss: 0.0002, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   8,  Average loss: 0.0002, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   9,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch  10,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Global model norm: 16.591404980841173.
Norm before scaling: 16.51792904635653. Distance: 1.2918704805262795
Total norm for 5 adversaries is: 16.51792904635653. distance: 1.2918704805262795
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0768, Accuracy: 8767/8991 (97.5086%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   1,  Average loss: 0.0018, Accuracy: 557/571 (97.5482%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 567/571 (99.2995%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   3,  Average loss: 0.0004, Accuracy: 566/571 (99.1243%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   4,  Average loss: 0.0002, Accuracy: 570/571 (99.8249%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   5,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Global model norm: 16.591404980841173.
Norm before scaling: 16.545184602926675. Distance: 1.1124504335484124
Total norm for 5 adversaries is: 16.545184602926675. distance: 1.1124504335484124
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0948, Accuracy: 8756/8991 (97.3863%)
___Train Local_Simple,  epoch  38, local model 52, internal_epoch   1,  Average loss: 0.0047, Accuracy: 548/598 (91.6388%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4389, Accuracy: 8627/10000 (86.2700%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 572/579 (98.7910%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   2,  Average loss: 0.0002, Accuracy: 576/579 (99.4819%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   3,  Average loss: 0.0001, Accuracy: 578/579 (99.8273%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   4,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   5,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Global model norm: 16.591404980841173.
Norm before scaling: 16.550934751913843. Distance: 0.7367577551571756
Total norm for 5 adversaries is: 16.550934751913843. distance: 0.7367577551571756
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0958, Accuracy: 8765/8991 (97.4864%)
time spent on training: 119.68403816223145
[foolsgold agg] training data poison_ratio: 0.49139546771170556  data num: [560, 573, 591, 617, 568, 611, 601, 571, 598, 579]
[foolsgold agg] considering poison per batch poison_fraction: 0.49139546771170556
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.00249431
 1.         1.         0.00249431 1.        ]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.5006, Accuracy: 8821/10000 (88.2100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.0979, Accuracy: 8774/8991 (97.5865%)
Done in 413.9182479381561 sec.
Server Epoch:39 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0011, Accuracy: 558/568 (98.2394%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   2,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Global model norm: 16.6054627771396.
Norm before scaling: 16.57564429042136. Distance: 1.001756912858767
Total norm for 7 adversaries is: 16.57564429042136. distance: 1.001756912858767
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0810, Accuracy: 8777/8991 (97.6198%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   1,  Average loss: 0.0022, Accuracy: 580/597 (97.1524%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   2,  Average loss: 0.0012, Accuracy: 586/597 (98.1575%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   3,  Average loss: 0.0005, Accuracy: 590/597 (98.8275%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   4,  Average loss: 0.0003, Accuracy: 595/597 (99.6650%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   5,  Average loss: 0.0002, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   6,  Average loss: 0.0002, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   7,  Average loss: 0.0001, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   8,  Average loss: 0.0001, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   9,  Average loss: 0.0001, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch  10,  Average loss: 0.0001, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Global model norm: 16.6054627771396.
Norm before scaling: 16.543390730302804. Distance: 1.3791183438243755
Total norm for 7 adversaries is: 16.543390730302804. distance: 1.3791183438243755
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1031, Accuracy: 8746/8991 (97.2751%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   1,  Average loss: 0.0014, Accuracy: 608/620 (98.0645%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   2,  Average loss: 0.0006, Accuracy: 609/620 (98.2258%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   3,  Average loss: 0.0002, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   8,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   9,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch  10,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Global model norm: 16.6054627771396.
Norm before scaling: 16.561627519767363. Distance: 1.1116302562243188
Total norm for 7 adversaries is: 16.561627519767363. distance: 1.1116302562243188
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0912, Accuracy: 8751/8991 (97.3307%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 562/580 (96.8966%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   2,  Average loss: 0.0007, Accuracy: 574/580 (98.9655%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   3,  Average loss: 0.0006, Accuracy: 574/580 (98.9655%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   4,  Average loss: 0.0004, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   5,  Average loss: 0.0002, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   7,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   8,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   9,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch  10,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Global model norm: 16.6054627771396.
Norm before scaling: 16.56053570309359. Distance: 1.292203048372651
Total norm for 7 adversaries is: 16.56053570309359. distance: 1.292203048372651
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0765, Accuracy: 8805/8991 (97.9313%)
___Train Local_Simple,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0034, Accuracy: 579/615 (94.1463%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1110, Accuracy: 9668/10000 (96.6800%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 584/594 (98.3165%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 590/594 (99.3266%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Global model norm: 16.6054627771396.
Norm before scaling: 16.52561211310766. Distance: 0.9930157546016196
Total norm for 7 adversaries is: 16.52561211310766. distance: 0.9930157546016196
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0789, Accuracy: 8792/8991 (97.7867%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   1,  Average loss: 0.0023, Accuracy: 530/548 (96.7153%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   2,  Average loss: 0.0007, Accuracy: 543/548 (99.0876%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   3,  Average loss: 0.0003, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   4,  Average loss: 0.0002, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   7,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   8,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch  10,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Global model norm: 16.6054627771396.
Norm before scaling: 16.539387248819295. Distance: 1.258308597136305
Total norm for 7 adversaries is: 16.539387248819295. distance: 1.258308597136305
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0896, Accuracy: 8761/8991 (97.4419%)
___Train Local_Simple,  epoch  39, local model 88, internal_epoch   1,  Average loss: 0.0038, Accuracy: 520/560 (92.8571%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2882, Accuracy: 9136/10000 (91.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0047, Accuracy: 560/605 (92.5620%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1815, Accuracy: 9437/10000 (94.3700%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 609/628 (96.9745%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   2,  Average loss: 0.0010, Accuracy: 613/628 (97.6115%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   3,  Average loss: 0.0003, Accuracy: 626/628 (99.6815%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   4,  Average loss: 0.0002, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   5,  Average loss: 0.0002, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   7,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   8,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   9,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch  10,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Global model norm: 16.6054627771396.
Norm before scaling: 16.55973222746408. Distance: 1.3411068759432754
Total norm for 7 adversaries is: 16.55973222746408. distance: 1.3411068759432754
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0795, Accuracy: 8776/8991 (97.6087%)
time spent on training: 195.80454683303833
[foolsgold agg] training data poison_ratio: 0.6990701606086221  data num: [568, 597, 620, 580, 615, 594, 548, 560, 605, 628]
[foolsgold agg] considering poison per batch poison_fraction: 0.6990701606086221
[foolsgold agg] wv: [1.         1.         1.         1.         0.47376408 0.75797732
 1.         1.         0.47376408 0.75797732]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.5557, Accuracy: 8814/10000 (88.1400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.0895, Accuracy: 8791/8991 (97.7756%)
Done in 522.0019330978394 sec.
Server Epoch:40 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0024, Accuracy: 532/555 (95.8559%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   2,  Average loss: 0.0006, Accuracy: 549/555 (98.9189%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   3,  Average loss: 0.0003, Accuracy: 553/555 (99.6396%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   4,  Average loss: 0.0002, Accuracy: 554/555 (99.8198%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   5,  Average loss: 0.0002, Accuracy: 555/555 (100.0000%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   6,  Average loss: 0.0001, Accuracy: 555/555 (100.0000%), train_poison_data_count: 555
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 555/555 (100.0000%), train_poison_data_count: 555
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   8,  Average loss: 0.0001, Accuracy: 555/555 (100.0000%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   9,  Average loss: 0.0001, Accuracy: 555/555 (100.0000%), train_poison_data_count: 555
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch  10,  Average loss: 0.0001, Accuracy: 555/555 (100.0000%), train_poison_data_count: 555
Global model norm: 16.624103263820636.
Norm before scaling: 16.559827135446174. Distance: 1.2478371027492166
Total norm for 3 adversaries is: 16.559827135446174. distance: 1.2478371027492166
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0787, Accuracy: 8789/8991 (97.7533%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   1,  Average loss: 0.0021, Accuracy: 585/602 (97.1761%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 591/602 (98.1728%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   3,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   4,  Average loss: 0.0002, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   5,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   6,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   7,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   8,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   9,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch  10,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 16.624103263820636.
Norm before scaling: 16.56131334192355. Distance: 1.2950370357622873
Total norm for 3 adversaries is: 16.56131334192355. distance: 1.2950370357622873
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0756, Accuracy: 8793/8991 (97.7978%)
___Train Local_Simple,  epoch  40, local model 87, internal_epoch   1,  Average loss: 0.0047, Accuracy: 542/591 (91.7090%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3452, Accuracy: 9020/10000 (90.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 98, internal_epoch   1,  Average loss: 0.0037, Accuracy: 467/499 (93.5872%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2308, Accuracy: 9315/10000 (93.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0052, Accuracy: 552/602 (91.6944%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3674, Accuracy: 8741/10000 (87.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 83, internal_epoch   1,  Average loss: 0.0048, Accuracy: 559/611 (91.4894%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1829, Accuracy: 9429/10000 (94.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0064, Accuracy: 535/598 (89.4649%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2419, Accuracy: 9262/10000 (92.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 90, internal_epoch   1,  Average loss: 0.0025, Accuracy: 550/576 (95.4861%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1617, Accuracy: 9515/10000 (95.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 71, internal_epoch   1,  Average loss: 0.0030, Accuracy: 600/637 (94.1915%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1847, Accuracy: 9393/10000 (93.9300%), Attack Success Rate:0/10000(0.000)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0021, Accuracy: 561/577 (97.2270%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   2,  Average loss: 0.0006, Accuracy: 571/577 (98.9601%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   3,  Average loss: 0.0005, Accuracy: 572/577 (99.1334%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   4,  Average loss: 0.0003, Accuracy: 574/577 (99.4801%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   6,  Average loss: 0.0001, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   7,  Average loss: 0.0001, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   8,  Average loss: 0.0001, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   9,  Average loss: 0.0001, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 577/577 (100.0000%), train_poison_data_count: 577
Global model norm: 16.624103263820636.
Norm before scaling: 16.577015860340616. Distance: 1.3590006696574488
Total norm for 3 adversaries is: 16.577015860340616. distance: 1.3590006696574488
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0940, Accuracy: 8747/8991 (97.2862%)
time spent on training: 107.12002301216125
[foolsgold agg] training data poison_ratio: 0.29651162790697677  data num: [555, 602, 591, 499, 602, 611, 598, 576, 637, 577]
[foolsgold agg] considering poison per batch poison_fraction: 0.29651162790697677
[foolsgold agg] wv: [1.         0.75853252 1.         1.         0.30084206 0.
 0.         0.02789048 0.         0.75853252]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.4512, Accuracy: 8840/10000 (88.4000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.0955, Accuracy: 8779/8991 (97.6421%)
Done in 389.46075105667114 sec.
Server Epoch:41 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
___Train Local_Simple,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 565/602 (93.8538%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.3167, Accuracy: 8986/10000 (89.8600%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   1,  Average loss: 0.0012, Accuracy: 551/566 (97.3498%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   2,  Average loss: 0.0005, Accuracy: 561/566 (99.1166%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   3,  Average loss: 0.0001, Accuracy: 565/566 (99.8233%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   4,  Average loss: 0.0001, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   5,  Average loss: 0.0001, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   6,  Average loss: 0.0001, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   9,  Average loss: 0.0000, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch  10,  Average loss: 0.0000, Accuracy: 566/566 (100.0000%), train_poison_data_count: 566
Global model norm: 16.63084458032959.
Norm before scaling: 16.601678308419604. Distance: 1.0072614952599817
Total norm for 6 adversaries is: 16.601678308419604. distance: 1.0072614952599817
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0888, Accuracy: 8780/8991 (97.6532%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   1,  Average loss: 0.0018, Accuracy: 580/588 (98.6395%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   2,  Average loss: 0.0017, Accuracy: 564/588 (95.9184%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   3,  Average loss: 0.0011, Accuracy: 575/588 (97.7891%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   4,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   5,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   6,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.63084458032959.
Norm before scaling: 16.647607103293403. Distance: 1.6685796329241531
Total norm for 6 adversaries is: 16.647607103293403. distance: 1.6685796329241531
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0906, Accuracy: 8752/8991 (97.3418%)
___Train Local_Simple,  epoch  41, local model 95, internal_epoch   1,  Average loss: 0.0031, Accuracy: 520/549 (94.7177%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2412, Accuracy: 9276/10000 (92.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 83, internal_epoch   1,  Average loss: 0.0032, Accuracy: 572/611 (93.6170%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1712, Accuracy: 9453/10000 (94.5300%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0018, Accuracy: 549/567 (96.8254%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   2,  Average loss: 0.0007, Accuracy: 558/567 (98.4127%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   3,  Average loss: 0.0006, Accuracy: 562/567 (99.1182%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   4,  Average loss: 0.0002, Accuracy: 566/567 (99.8236%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Global model norm: 16.63084458032959.
Norm before scaling: 16.58109215906781. Distance: 1.2290645276752956
Total norm for 6 adversaries is: 16.58109215906781. distance: 1.2290645276752956
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0943, Accuracy: 8767/8991 (97.5086%)
___Train Local_Simple,  epoch  41, local model 55, internal_epoch   1,  Average loss: 0.0041, Accuracy: 555/595 (93.2773%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2201, Accuracy: 9300/10000 (93.0000%), Attack Success Rate:0/10000(0.000)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0015, Accuracy: 628/646 (97.2136%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   2,  Average loss: 0.0006, Accuracy: 639/646 (98.9164%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Global model norm: 16.63084458032959.
Norm before scaling: 16.584836243173783. Distance: 1.2119594568546876
Total norm for 6 adversaries is: 16.584836243173783. distance: 1.2119594568546876
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0792, Accuracy: 8802/8991 (97.8979%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   1,  Average loss: 0.0030, Accuracy: 555/573 (96.8586%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   2,  Average loss: 0.0007, Accuracy: 564/573 (98.4293%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   3,  Average loss: 0.0005, Accuracy: 570/573 (99.4764%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   4,  Average loss: 0.0003, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   5,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   6,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.63084458032959.
Norm before scaling: 16.55813621758198. Distance: 1.4091886545214527
Total norm for 6 adversaries is: 16.55813621758198. distance: 1.4091886545214527
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0796, Accuracy: 8771/8991 (97.5531%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   1,  Average loss: 0.0024, Accuracy: 583/609 (95.7307%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 604/609 (99.1790%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   3,  Average loss: 0.0004, Accuracy: 605/609 (99.3432%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   4,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   5,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   6,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   7,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   8,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   9,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch  10,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 16.63084458032959.
Norm before scaling: 16.592045066014503. Distance: 1.5085582568963232
Total norm for 6 adversaries is: 16.592045066014503. distance: 1.5085582568963232
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0877, Accuracy: 8751/8991 (97.3307%)
time spent on training: 163.3088891506195
[foolsgold agg] training data poison_ratio: 0.6009143244158482  data num: [602, 566, 588, 549, 611, 567, 595, 646, 573, 609]
[foolsgold agg] considering poison per batch poison_fraction: 0.6009143244158482
[foolsgold agg] wv: [0.         0.84832715 1.         1.         0.         0.84832715
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.4894, Accuracy: 8820/10000 (88.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.0957, Accuracy: 8782/8991 (97.6755%)
Done in 422.61343002319336 sec.
Server Epoch:42 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 548/591 (92.7242%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2422, Accuracy: 9225/10000 (92.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0040, Accuracy: 572/615 (93.0081%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2001, Accuracy: 9358/10000 (93.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 89, internal_epoch   1,  Average loss: 0.0039, Accuracy: 557/594 (93.7710%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2141, Accuracy: 9297/10000 (92.9700%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0012, Accuracy: 565/573 (98.6038%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 570/573 (99.4764%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   3,  Average loss: 0.0002, Accuracy: 570/573 (99.4764%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.65149934450114.
Norm before scaling: 16.605603368514554. Distance: 0.9109649012846368
Total norm for 4 adversaries is: 16.605603368514554. distance: 0.9109649012846368
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0863, Accuracy: 8796/8991 (97.8312%)
___Train Local_Simple,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0027, Accuracy: 556/588 (94.5578%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2302, Accuracy: 9283/10000 (92.8300%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 620/635 (97.6378%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   2,  Average loss: 0.0006, Accuracy: 627/635 (98.7402%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   3,  Average loss: 0.0005, Accuracy: 631/635 (99.3701%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 633/635 (99.6850%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Global model norm: 16.65149934450114.
Norm before scaling: 16.596581973500598. Distance: 1.1760612990725996
Total norm for 4 adversaries is: 16.596581973500598. distance: 1.1760612990725996
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0750, Accuracy: 8812/8991 (98.0091%)
___Train Local_Simple,  epoch  42, local model 92, internal_epoch   1,  Average loss: 0.0033, Accuracy: 532/565 (94.1593%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1418, Accuracy: 9589/10000 (95.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 62, internal_epoch   1,  Average loss: 0.0048, Accuracy: 535/582 (91.9244%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4296, Accuracy: 8589/10000 (85.8900%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   1,  Average loss: 0.0017, Accuracy: 556/573 (97.0332%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   2,  Average loss: 0.0006, Accuracy: 566/573 (98.7784%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   3,  Average loss: 0.0003, Accuracy: 571/573 (99.6510%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   4,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.65149934450114.
Norm before scaling: 16.606988084016205. Distance: 1.2157990358015311
Total norm for 4 adversaries is: 16.606988084016205. distance: 1.2157990358015311
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0867, Accuracy: 8773/8991 (97.5754%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0025, Accuracy: 549/573 (95.8115%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   2,  Average loss: 0.0007, Accuracy: 567/573 (98.9529%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   3,  Average loss: 0.0005, Accuracy: 569/573 (99.3019%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   4,  Average loss: 0.0003, Accuracy: 570/573 (99.4764%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   5,  Average loss: 0.0002, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.65149934450114.
Norm before scaling: 16.5952616719634. Distance: 1.4042155914763501
Total norm for 4 adversaries is: 16.5952616719634. distance: 1.4042155914763501
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0911, Accuracy: 8751/8991 (97.3307%)
time spent on training: 115.05973982810974
[foolsgold agg] training data poison_ratio: 0.3997283070130752  data num: [591, 615, 594, 573, 588, 635, 565, 582, 573, 573]
[foolsgold agg] considering poison per batch poison_fraction: 0.3997283070130752
[foolsgold agg] wv: [1.         0.54472592 0.54472592 1.         1.         1.
 0.85638039 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.3152, Accuracy: 8959/10000 (89.5900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.1125, Accuracy: 8677/8991 (96.5076%)
Done in 376.18006706237793 sec.
Server Epoch:43 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   1,  Average loss: 0.0016, Accuracy: 569/584 (97.4315%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   2,  Average loss: 0.0005, Accuracy: 578/584 (98.9726%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   3,  Average loss: 0.0003, Accuracy: 579/584 (99.1438%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   4,  Average loss: 0.0002, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   5,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   6,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   7,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   9,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Global model norm: 16.65771019924501.
Norm before scaling: 16.653876215991822. Distance: 1.3794759378633326
Total norm for 5 adversaries is: 16.653876215991822. distance: 1.3794759378633326
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1034, Accuracy: 8747/8991 (97.2862%)
___Train Local_Simple,  epoch  43, local model 78, internal_epoch   1,  Average loss: 0.0046, Accuracy: 571/617 (92.5446%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2057, Accuracy: 9329/10000 (93.2900%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   1,  Average loss: 0.0015, Accuracy: 557/573 (97.2077%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 568/573 (99.1274%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.65771019924501.
Norm before scaling: 16.614739256060414. Distance: 1.1276053883088553
Total norm for 5 adversaries is: 16.614739256060414. distance: 1.1276053883088553
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0878, Accuracy: 8770/8991 (97.5420%)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0017, Accuracy: 550/567 (97.0018%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   2,  Average loss: 0.0005, Accuracy: 562/567 (99.1182%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   3,  Average loss: 0.0002, Accuracy: 566/567 (99.8236%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   4,  Average loss: 0.0001, Accuracy: 566/567 (99.8236%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   9,  Average loss: 0.0000, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch  10,  Average loss: 0.0000, Accuracy: 567/567 (100.0000%), train_poison_data_count: 567
Global model norm: 16.65771019924501.
Norm before scaling: 16.60746034942768. Distance: 1.1741930605374513
Total norm for 5 adversaries is: 16.60746034942768. distance: 1.1741930605374513
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0904, Accuracy: 8765/8991 (97.4864%)
___Train Local_Simple,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0038, Accuracy: 568/605 (93.8843%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1546, Accuracy: 9472/10000 (94.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 75, internal_epoch   1,  Average loss: 0.0049, Accuracy: 555/600 (92.5000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2581, Accuracy: 9186/10000 (91.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0044, Accuracy: 473/508 (93.1102%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1923, Accuracy: 9397/10000 (93.9700%), Attack Success Rate:0/10000(0.000)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 548/560 (97.8571%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/560 (98.9286%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Global model norm: 16.65771019924501.
Norm before scaling: 16.61579169619691. Distance: 1.1026140969678717
Total norm for 5 adversaries is: 16.61579169619691. distance: 1.1026140969678717
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0750, Accuracy: 8799/8991 (97.8645%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   1,  Average loss: 0.0022, Accuracy: 586/608 (96.3816%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   2,  Average loss: 0.0012, Accuracy: 597/608 (98.1908%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   3,  Average loss: 0.0005, Accuracy: 605/608 (99.5066%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   4,  Average loss: 0.0003, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   5,  Average loss: 0.0002, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   6,  Average loss: 0.0001, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   7,  Average loss: 0.0001, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   8,  Average loss: 0.0001, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   9,  Average loss: 0.0001, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch  10,  Average loss: 0.0001, Accuracy: 608/608 (100.0000%), train_poison_data_count: 608
Global model norm: 16.65771019924501.
Norm before scaling: 16.60900292827611. Distance: 1.490788547972594
Total norm for 5 adversaries is: 16.60900292827611. distance: 1.490788547972594
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0818, Accuracy: 8761/8991 (97.4419%)
___Train Local_Simple,  epoch  43, local model 90, internal_epoch   1,  Average loss: 0.0022, Accuracy: 550/576 (95.4861%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2204, Accuracy: 9342/10000 (93.4200%), Attack Success Rate:0/10000(0.000)
time spent on training: 136.60848426818848
[foolsgold agg] training data poison_ratio: 0.4987926871334943  data num: [584, 617, 573, 567, 605, 600, 508, 560, 608, 576]
[foolsgold agg] considering poison per batch poison_fraction: 0.4987926871334943
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.93350302 1.         1.         0.93350302]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.3227, Accuracy: 8924/10000 (89.2400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.1114, Accuracy: 8694/8991 (96.6967%)
Done in 422.5525760650635 sec.
Server Epoch:44 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   1,  Average loss: 0.0022, Accuracy: 592/617 (95.9481%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   2,  Average loss: 0.0019, Accuracy: 590/617 (95.6240%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   3,  Average loss: 0.0009, Accuracy: 609/617 (98.7034%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   4,  Average loss: 0.0005, Accuracy: 612/617 (99.1896%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   5,  Average loss: 0.0003, Accuracy: 615/617 (99.6759%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   6,  Average loss: 0.0002, Accuracy: 616/617 (99.8379%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   7,  Average loss: 0.0002, Accuracy: 616/617 (99.8379%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   8,  Average loss: 0.0002, Accuracy: 616/617 (99.8379%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   9,  Average loss: 0.0002, Accuracy: 616/617 (99.8379%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch  10,  Average loss: 0.0002, Accuracy: 616/617 (99.8379%), train_poison_data_count: 617
Global model norm: 16.667646048698284.
Norm before scaling: 16.641339296582604. Distance: 1.5615588596279424
Total norm for 7 adversaries is: 16.641339296582604. distance: 1.5615588596279424
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0901, Accuracy: 8740/8991 (97.2083%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 578/600 (96.3333%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   2,  Average loss: 0.0013, Accuracy: 585/600 (97.5000%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   3,  Average loss: 0.0007, Accuracy: 589/600 (98.1667%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   4,  Average loss: 0.0006, Accuracy: 596/600 (99.3333%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   5,  Average loss: 0.0003, Accuracy: 598/600 (99.6667%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   6,  Average loss: 0.0003, Accuracy: 598/600 (99.6667%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   7,  Average loss: 0.0002, Accuracy: 598/600 (99.6667%), train_poison_data_count: 600
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   8,  Average loss: 0.0002, Accuracy: 598/600 (99.6667%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   9,  Average loss: 0.0002, Accuracy: 599/600 (99.8333%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch  10,  Average loss: 0.0002, Accuracy: 599/600 (99.8333%), train_poison_data_count: 600
Global model norm: 16.667646048698284.
Norm before scaling: 16.617743952248752. Distance: 1.6293263431098401
Total norm for 7 adversaries is: 16.617743952248752. distance: 1.6293263431098401
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0850, Accuracy: 8745/8991 (97.2639%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0010, Accuracy: 573/584 (98.1164%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   2,  Average loss: 0.0007, Accuracy: 577/584 (98.8014%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   3,  Average loss: 0.0002, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   4,  Average loss: 0.0001, Accuracy: 583/584 (99.8288%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   5,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   6,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   7,  Average loss: 0.0001, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 584/584 (100.0000%), train_poison_data_count: 584
Global model norm: 16.667646048698284.
Norm before scaling: 16.651871383020005. Distance: 1.12810580377282
Total norm for 7 adversaries is: 16.651871383020005. distance: 1.12810580377282
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0905, Accuracy: 8781/8991 (97.6643%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0023, Accuracy: 565/587 (96.2521%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   2,  Average loss: 0.0009, Accuracy: 576/587 (98.1261%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   3,  Average loss: 0.0006, Accuracy: 578/587 (98.4668%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   4,  Average loss: 0.0002, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   5,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   6,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   7,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   8,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   9,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch  10,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 16.667646048698284.
Norm before scaling: 16.607636756408557. Distance: 1.4081185536378829
Total norm for 7 adversaries is: 16.607636756408557. distance: 1.4081185536378829
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0882, Accuracy: 8771/8991 (97.5531%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 597/609 (98.0296%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   2,  Average loss: 0.0002, Accuracy: 606/609 (99.5074%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   3,  Average loss: 0.0002, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   4,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   5,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   6,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   7,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   8,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   9,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch  10,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 16.667646048698284.
Norm before scaling: 16.646171684152524. Distance: 1.070941767910862
Total norm for 7 adversaries is: 16.646171684152524. distance: 1.070941767910862
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0856, Accuracy: 8776/8991 (97.6087%)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0018, Accuracy: 584/601 (97.1714%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   2,  Average loss: 0.0008, Accuracy: 595/601 (99.0017%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   3,  Average loss: 0.0003, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   4,  Average loss: 0.0002, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   5,  Average loss: 0.0002, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   6,  Average loss: 0.0002, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   7,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   8,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   9,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch  10,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Global model norm: 16.667646048698284.
Norm before scaling: 16.601991722392548. Distance: 1.2385814796168155
Total norm for 7 adversaries is: 16.601991722392548. distance: 1.2385814796168155
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0786, Accuracy: 8786/8991 (97.7199%)
___Train Local_Simple,  epoch  44, local model 65, internal_epoch   1,  Average loss: 0.0039, Accuracy: 527/569 (92.6186%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.3038, Accuracy: 9090/10000 (90.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 66, internal_epoch   1,  Average loss: 0.0033, Accuracy: 580/622 (93.2476%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2861, Accuracy: 9149/10000 (91.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0033, Accuracy: 583/615 (94.7967%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1788, Accuracy: 9402/10000 (94.0200%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0020, Accuracy: 542/556 (97.4820%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   2,  Average loss: 0.0007, Accuracy: 549/556 (98.7410%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   3,  Average loss: 0.0002, Accuracy: 555/556 (99.8201%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   4,  Average loss: 0.0002, Accuracy: 555/556 (99.8201%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 555/556 (99.8201%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 556/556 (100.0000%), train_poison_data_count: 556
Global model norm: 16.667646048698284.
Norm before scaling: 16.62486324397465. Distance: 1.279285879306276
Total norm for 7 adversaries is: 16.62486324397465. distance: 1.279285879306276
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0743, Accuracy: 8779/8991 (97.6421%)
time spent on training: 179.29918599128723
[foolsgold agg] training data poison_ratio: 0.696979865771812  data num: [617, 600, 584, 587, 609, 601, 569, 622, 615, 556]
[foolsgold agg] considering poison per batch poison_fraction: 0.696979865771812
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.4322, Accuracy: 8844/10000 (88.4400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.0916, Accuracy: 8786/8991 (97.7199%)
Done in 389.9191029071808 sec.
Server Epoch:45 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0035, Accuracy: 535/568 (94.1901%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1917, Accuracy: 9393/10000 (93.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 75, internal_epoch   1,  Average loss: 0.0026, Accuracy: 569/600 (94.8333%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1964, Accuracy: 9443/10000 (94.4300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 583/600 (97.1667%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0014, Accuracy: 584/600 (97.3333%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   3,  Average loss: 0.0005, Accuracy: 596/600 (99.3333%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   4,  Average loss: 0.0003, Accuracy: 598/600 (99.6667%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   5,  Average loss: 0.0003, Accuracy: 598/600 (99.6667%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   6,  Average loss: 0.0002, Accuracy: 598/600 (99.6667%), train_poison_data_count: 600
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   7,  Average loss: 0.0002, Accuracy: 598/600 (99.6667%), train_poison_data_count: 600
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   8,  Average loss: 0.0002, Accuracy: 600/600 (100.0000%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   9,  Average loss: 0.0002, Accuracy: 600/600 (100.0000%), train_poison_data_count: 600
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 600/600 (100.0000%), train_poison_data_count: 600
Global model norm: 16.695623242311704.
Norm before scaling: 16.637786766464107. Distance: 1.5600297092396436
Total norm for 5 adversaries is: 16.637786766464107. distance: 1.5600297092396436
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0736, Accuracy: 8786/8991 (97.7199%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 596/601 (99.1681%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   2,  Average loss: 0.0008, Accuracy: 595/601 (99.0017%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   3,  Average loss: 0.0004, Accuracy: 597/601 (99.3344%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   4,  Average loss: 0.0002, Accuracy: 598/601 (99.5008%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 600/601 (99.8336%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   6,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Global model norm: 16.695623242311704.
Norm before scaling: 16.64258167780299. Distance: 0.9810211631580301
Total norm for 5 adversaries is: 16.64258167780299. distance: 0.9810211631580301
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0889, Accuracy: 8788/8991 (97.7422%)
___Train Local_Simple,  epoch  45, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 497/541 (91.8669%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1473, Accuracy: 9575/10000 (95.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 560/602 (93.0233%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2390, Accuracy: 9130/10000 (91.3000%), Attack Success Rate:0/10000(0.000)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   1,  Average loss: 0.0027, Accuracy: 550/573 (95.9860%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   2,  Average loss: 0.0008, Accuracy: 564/573 (98.4293%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   3,  Average loss: 0.0003, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   4,  Average loss: 0.0003, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   5,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   6,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.695623242311704.
Norm before scaling: 16.64252758343018. Distance: 1.3905829519708455
Total norm for 5 adversaries is: 16.64252758343018. distance: 1.3905829519708455
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0827, Accuracy: 8757/8991 (97.3974%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 549/560 (98.0357%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 558/560 (99.6429%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   3,  Average loss: 0.0002, Accuracy: 559/560 (99.8214%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Global model norm: 16.695623242311704.
Norm before scaling: 16.65453130790349. Distance: 0.9715555849807752
Total norm for 5 adversaries is: 16.65453130790349. distance: 0.9715555849807752
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0793, Accuracy: 8792/8991 (97.7867%)
___Train Local_Simple,  epoch  45, local model 60, internal_epoch   1,  Average loss: 0.0029, Accuracy: 571/600 (95.1667%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2206, Accuracy: 9329/10000 (93.2900%), Attack Success Rate:0/10000(0.000)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 561/580 (96.7241%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   2,  Average loss: 0.0023, Accuracy: 553/580 (95.3448%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   3,  Average loss: 0.0017, Accuracy: 566/580 (97.5862%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   4,  Average loss: 0.0004, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   5,  Average loss: 0.0005, Accuracy: 577/580 (99.4828%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   6,  Average loss: 0.0002, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   7,  Average loss: 0.0002, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   8,  Average loss: 0.0002, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   9,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch  10,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Global model norm: 16.695623242311704.
Norm before scaling: 16.812873921260085. Distance: 2.4831635982529376
Total norm for 5 adversaries is: 16.812873921260085. distance: 2.4831635982529376
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0910, Accuracy: 8753/8991 (97.3529%)
time spent on training: 113.55932426452637
[foolsgold agg] training data poison_ratio: 0.5002575107296138  data num: [568, 600, 600, 601, 541, 602, 573, 560, 600, 580]
[foolsgold agg] considering poison per batch poison_fraction: 0.5002575107296138
[foolsgold agg] wv: [0.9549957  1.         1.         1.         1.         0.55135794
 1.         1.         0.55135794 1.        ]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.4373, Accuracy: 8841/10000 (88.4100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.0950, Accuracy: 8776/8991 (97.6087%)
Done in 344.12387681007385 sec.
Server Epoch:46 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
___Train Local_Simple,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0030, Accuracy: 563/600 (93.8333%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1806, Accuracy: 9483/10000 (94.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 78, internal_epoch   1,  Average loss: 0.0034, Accuracy: 578/617 (93.6791%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.2403, Accuracy: 9195/10000 (91.9500%), Attack Success Rate:0/10000(0.000)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0017, Accuracy: 582/594 (97.9798%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   2,  Average loss: 0.0007, Accuracy: 588/594 (98.9899%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   3,  Average loss: 0.0003, Accuracy: 591/594 (99.4949%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 594/594 (100.0000%), train_poison_data_count: 594
Global model norm: 16.715578152684866.
Norm before scaling: 16.63522964910661. Distance: 1.1316572415254798
Total norm for 6 adversaries is: 16.63522964910661. distance: 1.1316572415254798
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0776, Accuracy: 8779/8991 (97.6421%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   1,  Average loss: 0.0012, Accuracy: 548/560 (97.8571%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   2,  Average loss: 0.0006, Accuracy: 552/560 (98.5714%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 560/560 (100.0000%), train_poison_data_count: 560
Global model norm: 16.715578152684866.
Norm before scaling: 16.680567526550544. Distance: 1.0982283869335367
Total norm for 6 adversaries is: 16.680567526550544. distance: 1.0982283869335367
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0839, Accuracy: 8774/8991 (97.5865%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0013, Accuracy: 560/570 (98.2456%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   2,  Average loss: 0.0009, Accuracy: 558/570 (97.8947%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   3,  Average loss: 0.0005, Accuracy: 565/570 (99.1228%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   4,  Average loss: 0.0003, Accuracy: 568/570 (99.6491%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   5,  Average loss: 0.0002, Accuracy: 568/570 (99.6491%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/570 (99.6491%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   7,  Average loss: 0.0001, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   8,  Average loss: 0.0001, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   9,  Average loss: 0.0001, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch  10,  Average loss: 0.0001, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Global model norm: 16.715578152684866.
Norm before scaling: 16.669529071419223. Distance: 1.0451982079306246
Total norm for 6 adversaries is: 16.669529071419223. distance: 1.0451982079306246
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0843, Accuracy: 8775/8991 (97.5976%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0014, Accuracy: 625/635 (98.4252%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   2,  Average loss: 0.0004, Accuracy: 631/635 (99.3701%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   3,  Average loss: 0.0003, Accuracy: 632/635 (99.5276%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 633/635 (99.6850%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 634/635 (99.8425%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Global model norm: 16.715578152684866.
Norm before scaling: 16.661641291521786. Distance: 1.1086535189688753
Total norm for 6 adversaries is: 16.661641291521786. distance: 1.1086535189688753
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0688, Accuracy: 8814/8991 (98.0314%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   1,  Average loss: 0.0019, Accuracy: 531/548 (96.8978%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   2,  Average loss: 0.0005, Accuracy: 544/548 (99.2701%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   3,  Average loss: 0.0002, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   4,  Average loss: 0.0002, Accuracy: 546/548 (99.6350%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   7,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   8,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch  10,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Global model norm: 16.715578152684866.
Norm before scaling: 16.662976479496393. Distance: 1.146501947167561
Total norm for 6 adversaries is: 16.662976479496393. distance: 1.146501947167561
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0845, Accuracy: 8776/8991 (97.6087%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 579/585 (98.9744%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   2,  Average loss: 0.0019, Accuracy: 565/585 (96.5812%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   3,  Average loss: 0.0016, Accuracy: 565/585 (96.5812%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   4,  Average loss: 0.0003, Accuracy: 584/585 (99.8291%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   5,  Average loss: 0.0002, Accuracy: 585/585 (100.0000%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   6,  Average loss: 0.0001, Accuracy: 585/585 (100.0000%), train_poison_data_count: 585
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   7,  Average loss: 0.0001, Accuracy: 585/585 (100.0000%), train_poison_data_count: 585
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   8,  Average loss: 0.0001, Accuracy: 585/585 (100.0000%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   9,  Average loss: 0.0002, Accuracy: 585/585 (100.0000%), train_poison_data_count: 585
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch  10,  Average loss: 0.0001, Accuracy: 585/585 (100.0000%), train_poison_data_count: 585
Global model norm: 16.715578152684866.
Norm before scaling: 16.77761432043174. Distance: 2.2636356433144433
Total norm for 6 adversaries is: 16.77761432043174. distance: 2.2636356433144433
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0894, Accuracy: 8750/8991 (97.3195%)
___Train Local_Simple,  epoch  46, local model 68, internal_epoch   1,  Average loss: 0.0042, Accuracy: 552/583 (94.6827%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1883, Accuracy: 9352/10000 (93.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 54, internal_epoch   1,  Average loss: 0.0039, Accuracy: 508/547 (92.8702%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1582, Accuracy: 9497/10000 (94.9700%), Attack Success Rate:0/10000(0.000)
time spent on training: 124.18784999847412
[foolsgold agg] training data poison_ratio: 0.5980476108922761  data num: [600, 617, 594, 560, 570, 635, 548, 585, 583, 547]
[foolsgold agg] considering poison per batch poison_fraction: 0.5980476108922761
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.4239, Accuracy: 8844/10000 (88.4400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.0932, Accuracy: 8775/8991 (97.5976%)
Done in 332.69577503204346 sec.
Server Epoch:47 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  47, local model 94, internal_epoch   1,  Average loss: 0.0053, Accuracy: 501/541 (92.6063%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2565, Accuracy: 9214/10000 (92.1400%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   1,  Average loss: 0.0011, Accuracy: 565/573 (98.6038%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 571/573 (99.6510%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   3,  Average loss: 0.0001, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   6,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.729933832360373.
Norm before scaling: 16.68990008635696. Distance: 0.8630848656893945
Total norm for 6 adversaries is: 16.68990008635696. distance: 0.8630848656893945
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0850, Accuracy: 8784/8991 (97.6977%)
___Train Local_Simple,  epoch  47, local model 82, internal_epoch   1,  Average loss: 0.0033, Accuracy: 557/589 (94.5671%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2179, Accuracy: 9307/10000 (93.0700%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   1,  Average loss: 0.0010, Accuracy: 573/581 (98.6231%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   2,  Average loss: 0.0015, Accuracy: 562/581 (96.7298%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   3,  Average loss: 0.0003, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   4,  Average loss: 0.0002, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 580/581 (99.8279%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.729933832360373.
Norm before scaling: 16.793548907604652. Distance: 2.0246620743973374
Total norm for 6 adversaries is: 16.793548907604652. distance: 2.0246620743973374
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0917, Accuracy: 8747/8991 (97.2862%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0014, Accuracy: 561/573 (97.9058%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   2,  Average loss: 0.0007, Accuracy: 566/573 (98.7784%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.729933832360373.
Norm before scaling: 16.686755674528413. Distance: 1.1038839890057137
Total norm for 6 adversaries is: 16.686755674528413. distance: 1.1038839890057137
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0878, Accuracy: 8768/8991 (97.5197%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0017, Accuracy: 577/596 (96.8121%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   2,  Average loss: 0.0008, Accuracy: 589/596 (98.8255%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   3,  Average loss: 0.0002, Accuracy: 595/596 (99.8322%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   4,  Average loss: 0.0001, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   5,  Average loss: 0.0001, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   6,  Average loss: 0.0001, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   7,  Average loss: 0.0001, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   8,  Average loss: 0.0001, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   9,  Average loss: 0.0001, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch  10,  Average loss: 0.0001, Accuracy: 596/596 (100.0000%), train_poison_data_count: 596
Global model norm: 16.729933832360373.
Norm before scaling: 16.694053934487517. Distance: 1.267549629067457
Total norm for 6 adversaries is: 16.694053934487517. distance: 1.267549629067457
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0757, Accuracy: 8792/8991 (97.7867%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0013, Accuracy: 557/570 (97.7193%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   2,  Average loss: 0.0007, Accuracy: 563/570 (98.7719%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   3,  Average loss: 0.0002, Accuracy: 569/570 (99.8246%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   4,  Average loss: 0.0001, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   6,  Average loss: 0.0001, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   7,  Average loss: 0.0001, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Global model norm: 16.729933832360373.
Norm before scaling: 16.679683840749014. Distance: 1.041876174202974
Total norm for 6 adversaries is: 16.679683840749014. distance: 1.041876174202974
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0838, Accuracy: 8773/8991 (97.5754%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0038, Accuracy: 539/576 (93.5764%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1534, Accuracy: 9506/10000 (95.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 68, internal_epoch   1,  Average loss: 0.0047, Accuracy: 543/583 (93.1389%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3731, Accuracy: 8989/10000 (89.8900%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 561/571 (98.2487%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   2,  Average loss: 0.0008, Accuracy: 566/571 (99.1243%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   3,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   4,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   5,  Average loss: 0.0001, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   6,  Average loss: 0.0000, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   7,  Average loss: 0.0000, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 571/571 (100.0000%), train_poison_data_count: 571
Global model norm: 16.729933832360373.
Norm before scaling: 16.679623462991827. Distance: 0.9737572929980867
Total norm for 6 adversaries is: 16.679623462991827. distance: 0.9737572929980867
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0769, Accuracy: 8814/8991 (98.0314%)
time spent on training: 124.21620297431946
[foolsgold agg] training data poison_ratio: 0.6021206327133669  data num: [541, 573, 589, 581, 573, 596, 570, 576, 583, 571]
[foolsgold agg] considering poison per batch poison_fraction: 0.6021206327133669
[foolsgold agg] wv: [1.         1.         0.11548752 1.         1.         1.
 1.         0.11548752 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.4284, Accuracy: 8834/10000 (88.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.0945, Accuracy: 8767/8991 (97.5086%)
Done in 330.08041405677795 sec.
Server Epoch:48 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
___Train Local_Simple,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0035, Accuracy: 565/597 (94.6399%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1625, Accuracy: 9513/10000 (95.1300%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 578/597 (96.8174%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   2,  Average loss: 0.0011, Accuracy: 585/597 (97.9899%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   3,  Average loss: 0.0003, Accuracy: 595/597 (99.6650%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   4,  Average loss: 0.0002, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Global model norm: 16.744921469494304.
Norm before scaling: 16.70696046790594. Distance: 1.2447397654844892
Total norm for 3 adversaries is: 16.70696046790594. distance: 1.2447397654844892
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0829, Accuracy: 8782/8991 (97.6755%)
___Train Local_Simple,  epoch  48, local model 75, internal_epoch   1,  Average loss: 0.0029, Accuracy: 567/600 (94.5000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1537, Accuracy: 9538/10000 (95.3800%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0015, Accuracy: 584/601 (97.1714%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   2,  Average loss: 0.0009, Accuracy: 593/601 (98.6689%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   3,  Average loss: 0.0003, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   4,  Average loss: 0.0002, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   5,  Average loss: 0.0002, Accuracy: 599/601 (99.6672%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   6,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   7,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   8,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   9,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch  10,  Average loss: 0.0001, Accuracy: 601/601 (100.0000%), train_poison_data_count: 601
Global model norm: 16.744921469494304.
Norm before scaling: 16.68952980983699. Distance: 1.180606155931727
Total norm for 3 adversaries is: 16.68952980983699. distance: 1.180606155931727
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0747, Accuracy: 8785/8991 (97.7088%)
___Train Local_Simple,  epoch  48, local model 58, internal_epoch   1,  Average loss: 0.0053, Accuracy: 528/575 (91.8261%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3012, Accuracy: 9004/10000 (90.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0050, Accuracy: 555/611 (90.8347%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1673, Accuracy: 9547/10000 (95.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0028, Accuracy: 565/597 (94.6399%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2071, Accuracy: 9361/10000 (93.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 96, internal_epoch   1,  Average loss: 0.0031, Accuracy: 506/540 (93.7037%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1459, Accuracy: 9546/10000 (95.4600%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0003, Accuracy: 577/579 (99.6546%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   2,  Average loss: 0.0001, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   3,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   4,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   5,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Global model norm: 16.744921469494304.
Norm before scaling: 16.69790976229323. Distance: 0.5097745112671351
Total norm for 3 adversaries is: 16.69790976229323. distance: 0.5097745112671351
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0822, Accuracy: 8794/8991 (97.8089%)
___Train Local_Simple,  epoch  48, local model 57, internal_epoch   1,  Average loss: 0.0028, Accuracy: 567/605 (93.7190%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1619, Accuracy: 9478/10000 (94.7800%), Attack Success Rate:0/10000(0.000)
time spent on training: 89.68816924095154
[foolsgold agg] training data poison_ratio: 0.3010843781768892  data num: [597, 597, 600, 601, 575, 611, 597, 540, 579, 605]
[foolsgold agg] considering poison per batch poison_fraction: 0.3010843781768892
[foolsgold agg] wv: [0.7758544  1.         0.48103636 1.         1.         0.
 0.55825461 0.         1.         0.43306211]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.3797, Accuracy: 8851/10000 (88.5100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.1021, Accuracy: 8745/8991 (97.2639%)
Done in 296.8669419288635 sec.
Server Epoch:49 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
___Train Local_Simple,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0036, Accuracy: 527/565 (93.2743%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1764, Accuracy: 9454/10000 (94.5400%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0018, Accuracy: 618/635 (97.3228%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   2,  Average loss: 0.0007, Accuracy: 629/635 (99.0551%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   3,  Average loss: 0.0003, Accuracy: 634/635 (99.8425%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Global model norm: 16.74998360248731.
Norm before scaling: 16.702574132929797. Distance: 1.2755823151971133
Total norm for 3 adversaries is: 16.702574132929797. distance: 1.2755823151971133
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0690, Accuracy: 8807/8991 (97.9535%)
___Train Local_Simple,  epoch  49, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 573/617 (92.8687%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3170, Accuracy: 8977/10000 (89.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0031, Accuracy: 571/605 (94.3802%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2684, Accuracy: 9190/10000 (91.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 91, internal_epoch   1,  Average loss: 0.0036, Accuracy: 558/597 (93.4673%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1989, Accuracy: 9370/10000 (93.7000%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 608/628 (96.8153%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   2,  Average loss: 0.0005, Accuracy: 624/628 (99.3631%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   3,  Average loss: 0.0006, Accuracy: 620/628 (98.7261%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   4,  Average loss: 0.0003, Accuracy: 625/628 (99.5223%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   7,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   8,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   9,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch  10,  Average loss: 0.0001, Accuracy: 628/628 (100.0000%), train_poison_data_count: 628
Global model norm: 16.74998360248731.
Norm before scaling: 16.726121877954014. Distance: 1.267750826739638
Total norm for 3 adversaries is: 16.726121877954014. distance: 1.267750826739638
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0765, Accuracy: 8781/8991 (97.6643%)
___Train Local_Simple,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0023, Accuracy: 482/499 (96.5932%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1444, Accuracy: 9594/10000 (95.9400%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   1,  Average loss: 0.0019, Accuracy: 570/590 (96.6102%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   2,  Average loss: 0.0010, Accuracy: 575/590 (97.4576%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   3,  Average loss: 0.0004, Accuracy: 587/590 (99.4915%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   4,  Average loss: 0.0003, Accuracy: 588/590 (99.6610%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   5,  Average loss: 0.0002, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   6,  Average loss: 0.0002, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   7,  Average loss: 0.0002, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   9,  Average loss: 0.0002, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 589/590 (99.8305%), train_poison_data_count: 590
Global model norm: 16.74998360248731.
Norm before scaling: 16.71404267112267. Distance: 1.2855143874174506
Total norm for 3 adversaries is: 16.71404267112267. distance: 1.2855143874174506
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0654, Accuracy: 8818/8991 (98.0759%)
___Train Local_Simple,  epoch  49, local model 82, internal_epoch   1,  Average loss: 0.0023, Accuracy: 562/589 (95.4160%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3701, Accuracy: 8914/10000 (89.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0029, Accuracy: 563/597 (94.3049%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1637, Accuracy: 9482/10000 (94.8200%), Attack Success Rate:0/10000(0.000)
time spent on training: 90.56886410713196
[foolsgold agg] training data poison_ratio: 0.31290104694360016  data num: [565, 635, 617, 605, 597, 628, 499, 590, 589, 597]
[foolsgold agg] considering poison per batch poison_fraction: 0.31290104694360016
[foolsgold agg] wv: [0.19751739 1.         1.         1.         0.84661732 1.
 0.77405873 1.         0.19751739 0.87054266]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.3403, Accuracy: 8919/10000 (89.1900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.1069, Accuracy: 8685/8991 (96.5966%)
Done in 295.13126707077026 sec.
Server Epoch:50 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
___Train Local_Simple,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0024, Accuracy: 569/600 (94.8333%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1431, Accuracy: 9567/10000 (95.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 86, internal_epoch   1,  Average loss: 0.0013, Accuracy: 595/609 (97.7011%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1407, Accuracy: 9601/10000 (96.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0044, Accuracy: 561/602 (93.1894%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2449, Accuracy: 9149/10000 (91.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0033, Accuracy: 563/598 (94.1472%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2454, Accuracy: 9280/10000 (92.8000%), Attack Success Rate:0/10000(0.000)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   1,  Average loss: 0.0020, Accuracy: 593/617 (96.1102%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   2,  Average loss: 0.0013, Accuracy: 599/617 (97.0827%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   3,  Average loss: 0.0004, Accuracy: 614/617 (99.5138%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   4,  Average loss: 0.0003, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   5,  Average loss: 0.0002, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   6,  Average loss: 0.0002, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   7,  Average loss: 0.0002, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   8,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   9,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch  10,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Global model norm: 16.757184210249942.
Norm before scaling: 16.735858470369376. Distance: 1.4625066805955942
Total norm for 5 adversaries is: 16.735858470369376. distance: 1.4625066805955942
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0788, Accuracy: 8776/8991 (97.6087%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   1,  Average loss: 0.0009, Accuracy: 609/620 (98.2258%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   2,  Average loss: 0.0005, Accuracy: 614/620 (99.0323%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   3,  Average loss: 0.0001, Accuracy: 619/620 (99.8387%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 620/620 (100.0000%), train_poison_data_count: 620
Global model norm: 16.757184210249942.
Norm before scaling: 16.727992845195335. Distance: 1.0484585528242671
Total norm for 5 adversaries is: 16.727992845195335. distance: 1.0484585528242671
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0756, Accuracy: 8801/8991 (97.8868%)
___Train Local_Simple,  epoch  50, local model 67, internal_epoch   1,  Average loss: 0.0033, Accuracy: 531/570 (93.1579%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3460, Accuracy: 8941/10000 (89.4100%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0004, Accuracy: 573/579 (98.9637%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   2,  Average loss: 0.0001, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   3,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   4,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   5,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 579/579 (100.0000%), train_poison_data_count: 579
Global model norm: 16.757184210249942.
Norm before scaling: 16.716380527186125. Distance: 0.6980993591626959
Total norm for 5 adversaries is: 16.716380527186125. distance: 0.6980993591626959
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0765, Accuracy: 8803/8991 (97.9090%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0020, Accuracy: 553/573 (96.5096%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   2,  Average loss: 0.0006, Accuracy: 565/573 (98.6038%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   3,  Average loss: 0.0002, Accuracy: 571/573 (99.6510%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.757184210249942.
Norm before scaling: 16.71089641036323. Distance: 1.2686360650981527
Total norm for 5 adversaries is: 16.71089641036323. distance: 1.2686360650981527
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0810, Accuracy: 8775/8991 (97.5976%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 559/570 (98.0702%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   2,  Average loss: 0.0006, Accuracy: 563/570 (98.7719%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   3,  Average loss: 0.0002, Accuracy: 568/570 (99.6491%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   4,  Average loss: 0.0001, Accuracy: 569/570 (99.8246%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   6,  Average loss: 0.0001, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 570/570 (100.0000%), train_poison_data_count: 570
Global model norm: 16.757184210249942.
Norm before scaling: 16.719788592156487. Distance: 1.0533872147754213
Total norm for 5 adversaries is: 16.719788592156487. distance: 1.0533872147754213
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0760, Accuracy: 8785/8991 (97.7088%)
time spent on training: 115.67602515220642
[foolsgold agg] training data poison_ratio: 0.4983159312899966  data num: [600, 609, 602, 598, 617, 620, 570, 579, 573, 570]
[foolsgold agg] considering poison per batch poison_fraction: 0.4983159312899966
[foolsgold agg] wv: [0.46030671 0.14588256 0.14588256 0.55135316 1.         1.
 0.17171293 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.4235, Accuracy: 8847/10000 (88.4700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.0925, Accuracy: 8765/8991 (97.4864%)
Done in 319.6632330417633 sec.
Saving all the graphs.
This run has a label: Mar.04_08.30.13. Visdom environment: mnist_DBA
