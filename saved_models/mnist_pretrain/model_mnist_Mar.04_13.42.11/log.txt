current path: saved_models/mnist_pretrain/model_mnist_Mar.04_13.42.11
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   1,  Average loss: 0.0273, Accuracy: 178/428 (41.5888%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   2,  Average loss: 0.0361, Accuracy: 220/428 (51.4019%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   3,  Average loss: 0.0187, Accuracy: 206/428 (48.1308%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   4,  Average loss: 0.0164, Accuracy: 206/428 (48.1308%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   5,  Average loss: 0.0139, Accuracy: 206/428 (48.1308%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   6,  Average loss: 0.0127, Accuracy: 270/428 (63.0841%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   7,  Average loss: 0.0114, Accuracy: 343/428 (80.1402%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   8,  Average loss: 0.0105, Accuracy: 368/428 (85.9813%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   9,  Average loss: 0.0093, Accuracy: 412/428 (96.2617%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch  10,  Average loss: 0.0089, Accuracy: 411/428 (96.0280%), train_poison_data_count: 428
Global model norm: 13.89800383141575.
Norm before scaling: 14.461230835085408. Distance: 4.432406228628637
Total norm for 10 adversaries is: 14.461230835085408. distance: 4.432406228628637
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 5.7182, Accuracy: 1946/8991 (21.6439%)
poison local model 72 index 71 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   1,  Average loss: 0.2306, Accuracy: 0/10 (0.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   2,  Average loss: 0.2182, Accuracy: 8/10 (80.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   3,  Average loss: 0.1928, Accuracy: 6/10 (60.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   4,  Average loss: 0.1880, Accuracy: 6/10 (60.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   5,  Average loss: 0.1808, Accuracy: 6/10 (60.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   6,  Average loss: 0.1706, Accuracy: 6/10 (60.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   7,  Average loss: 0.1568, Accuracy: 6/10 (60.0000%), train_poison_data_count: 10
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   8,  Average loss: 0.1393, Accuracy: 6/10 (60.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   9,  Average loss: 0.1190, Accuracy: 6/10 (60.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch  10,  Average loss: 0.1168, Accuracy: 6/10 (60.0000%), train_poison_data_count: 10
Global model norm: 13.89800383141575.
Norm before scaling: 13.913294827222586. Distance: 0.48997983365502995
Total norm for 10 adversaries is: 13.913294827222586. distance: 0.48997983365502995
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 2.5438, Accuracy: 1010/8991 (11.2335%)
poison local model 61 index 60 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   1,  Average loss: 0.0225, Accuracy: 472/767 (61.5385%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   2,  Average loss: 0.0134, Accuracy: 550/767 (71.7080%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   3,  Average loss: 0.0093, Accuracy: 550/767 (71.7080%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   4,  Average loss: 0.0075, Accuracy: 592/767 (77.1838%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   5,  Average loss: 0.0056, Accuracy: 706/767 (92.0469%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   6,  Average loss: 0.0044, Accuracy: 720/767 (93.8722%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   7,  Average loss: 0.0038, Accuracy: 723/767 (94.2634%), train_poison_data_count: 767
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   8,  Average loss: 0.0032, Accuracy: 737/767 (96.0887%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   9,  Average loss: 0.0029, Accuracy: 739/767 (96.3494%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch  10,  Average loss: 0.0029, Accuracy: 741/767 (96.6102%), train_poison_data_count: 767
Global model norm: 13.89800383141575.
Norm before scaling: 14.343260646609002. Distance: 3.6331800049326195
Total norm for 10 adversaries is: 14.343260646609002. distance: 3.6331800049326195
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 7.2981, Accuracy: 2899/8991 (32.2434%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0521, Accuracy: 45/84 (53.5714%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   2,  Average loss: 0.0387, Accuracy: 45/84 (53.5714%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   3,  Average loss: 0.0196, Accuracy: 49/84 (58.3333%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   4,  Average loss: 0.0196, Accuracy: 62/84 (73.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   5,  Average loss: 0.0192, Accuracy: 78/84 (92.8571%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   6,  Average loss: 0.0188, Accuracy: 67/84 (79.7619%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   7,  Average loss: 0.0176, Accuracy: 51/84 (60.7143%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   8,  Average loss: 0.0162, Accuracy: 70/84 (83.3333%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   9,  Average loss: 0.0158, Accuracy: 51/84 (60.7143%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch  10,  Average loss: 0.0154, Accuracy: 55/84 (65.4762%), train_poison_data_count: 84
Global model norm: 13.89800383141575.
Norm before scaling: 13.951207831265789. Distance: 0.9720241223705381
Total norm for 10 adversaries is: 13.951207831265789. distance: 0.9720241223705381
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 5.9302, Accuracy: 1440/8991 (16.0160%)
poison local model 71 index 70 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   1,  Average loss: 0.0368, Accuracy: 130/342 (38.0117%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   2,  Average loss: 0.0283, Accuracy: 115/342 (33.6257%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   3,  Average loss: 0.0270, Accuracy: 156/342 (45.6140%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   4,  Average loss: 0.0255, Accuracy: 156/342 (45.6140%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   5,  Average loss: 0.0250, Accuracy: 156/342 (45.6140%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   6,  Average loss: 0.0245, Accuracy: 156/342 (45.6140%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   7,  Average loss: 0.0236, Accuracy: 156/342 (45.6140%), train_poison_data_count: 342
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   8,  Average loss: 0.0229, Accuracy: 160/342 (46.7836%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   9,  Average loss: 0.0224, Accuracy: 162/342 (47.3684%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch  10,  Average loss: 0.0221, Accuracy: 160/342 (46.7836%), train_poison_data_count: 342
Global model norm: 13.89800383141575.
Norm before scaling: 14.002756664809512. Distance: 1.6636321894938695
Total norm for 10 adversaries is: 14.002756664809512. distance: 1.6636321894938695
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 3.7886, Accuracy: 1098/8991 (12.2122%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   1,  Average loss: 0.0354, Accuracy: 58/63 (92.0635%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   2,  Average loss: 0.0315, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   3,  Average loss: 0.0211, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   4,  Average loss: 0.0187, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   5,  Average loss: 0.0151, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   6,  Average loss: 0.0106, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   7,  Average loss: 0.0064, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   8,  Average loss: 0.0040, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   9,  Average loss: 0.0034, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch  10,  Average loss: 0.0034, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Global model norm: 13.89800383141575.
Norm before scaling: 13.93373885104571. Distance: 0.7226953856722446
Total norm for 10 adversaries is: 13.93373885104571. distance: 0.7226953856722446
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 5.2043, Accuracy: 982/8991 (10.9220%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   1,  Average loss: 0.0277, Accuracy: 240/388 (61.8557%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   2,  Average loss: 0.0485, Accuracy: 235/388 (60.5670%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   3,  Average loss: 0.0197, Accuracy: 272/388 (70.1031%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   4,  Average loss: 0.0190, Accuracy: 272/388 (70.1031%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   5,  Average loss: 0.0176, Accuracy: 272/388 (70.1031%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   6,  Average loss: 0.0135, Accuracy: 272/388 (70.1031%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   7,  Average loss: 0.0119, Accuracy: 272/388 (70.1031%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   8,  Average loss: 0.0090, Accuracy: 284/388 (73.1959%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   9,  Average loss: 0.0077, Accuracy: 343/388 (88.4021%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch  10,  Average loss: 0.0066, Accuracy: 343/388 (88.4021%), train_poison_data_count: 388
Global model norm: 13.89800383141575.
Norm before scaling: 15.153228899126942. Distance: 6.586521036852193
Total norm for 10 adversaries is: 15.153228899126942. distance: 6.586521036852193
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 4.5570, Accuracy: 1682/8991 (18.7076%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   1,  Average loss: 0.0293, Accuracy: 215/578 (37.1972%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   2,  Average loss: 0.0200, Accuracy: 342/578 (59.1696%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   3,  Average loss: 0.0082, Accuracy: 500/578 (86.5052%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   4,  Average loss: 0.0063, Accuracy: 517/578 (89.4464%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   5,  Average loss: 0.0051, Accuracy: 537/578 (92.9066%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   6,  Average loss: 0.0043, Accuracy: 542/578 (93.7716%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   7,  Average loss: 0.0044, Accuracy: 542/578 (93.7716%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   8,  Average loss: 0.0035, Accuracy: 540/578 (93.4256%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   9,  Average loss: 0.0030, Accuracy: 549/578 (94.9827%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch  10,  Average loss: 0.0040, Accuracy: 551/578 (95.3287%), train_poison_data_count: 578
Global model norm: 13.89800383141575.
Norm before scaling: 14.311549525788658. Distance: 3.290447459996818
Total norm for 10 adversaries is: 14.311549525788658. distance: 3.290447459996818
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 4.0966, Accuracy: 2820/8991 (31.3647%)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   1,  Average loss: 0.0112, Accuracy: 1567/2072 (75.6274%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   2,  Average loss: 0.0012, Accuracy: 2024/2072 (97.6834%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   3,  Average loss: 0.0005, Accuracy: 2047/2072 (98.7934%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   4,  Average loss: 0.0004, Accuracy: 2055/2072 (99.1795%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   5,  Average loss: 0.0004, Accuracy: 2060/2072 (99.4208%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   6,  Average loss: 0.0003, Accuracy: 2059/2072 (99.3726%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   7,  Average loss: 0.0003, Accuracy: 2061/2072 (99.4691%), train_poison_data_count: 2072
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   8,  Average loss: 0.0003, Accuracy: 2059/2072 (99.3726%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   9,  Average loss: 0.0003, Accuracy: 2061/2072 (99.4691%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch  10,  Average loss: 0.0003, Accuracy: 2061/2072 (99.4691%), train_poison_data_count: 2072
Global model norm: 13.89800383141575.
Norm before scaling: 14.53786706698826. Distance: 4.7151141780487285
Total norm for 10 adversaries is: 14.53786706698826. distance: 4.7151141780487285
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 4.6720, Accuracy: 2951/8991 (32.8217%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   1,  Average loss: 0.0156, Accuracy: 771/978 (78.8344%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   2,  Average loss: 0.0051, Accuracy: 880/978 (89.9796%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   3,  Average loss: 0.0036, Accuracy: 880/978 (89.9796%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   4,  Average loss: 0.0034, Accuracy: 882/978 (90.1840%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   5,  Average loss: 0.0028, Accuracy: 919/978 (93.9673%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   6,  Average loss: 0.0024, Accuracy: 940/978 (96.1145%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   7,  Average loss: 0.0020, Accuracy: 941/978 (96.2168%), train_poison_data_count: 978
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   8,  Average loss: 0.0018, Accuracy: 941/978 (96.2168%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   9,  Average loss: 0.0017, Accuracy: 942/978 (96.3190%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch  10,  Average loss: 0.0017, Accuracy: 943/978 (96.4213%), train_poison_data_count: 978
Global model norm: 13.89800383141575.
Norm before scaling: 14.348888266427538. Distance: 3.917551400651382
Total norm for 10 adversaries is: 14.348888266427538. distance: 3.917551400651382
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 4.2874, Accuracy: 1958/8991 (21.7773%)
time spent on training: 190.29787588119507
[foolsgold agg] training data poison_ratio: 1.0  data num: [428, 10, 767, 84, 342, 63, 388, 578, 2072, 978]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [1. 1. 1. 0. 1. 0. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2609, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:11/10000(0.110)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2122, Accuracy: 1010/8991 (11.2335%)
Done in 477.1267259120941 sec.
Server Epoch:2 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0463, Accuracy: 20/84 (23.8095%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   2,  Average loss: 0.0249, Accuracy: 74/84 (88.0952%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   3,  Average loss: 0.0193, Accuracy: 56/84 (66.6667%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   4,  Average loss: 0.0138, Accuracy: 72/84 (85.7143%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   5,  Average loss: 0.0163, Accuracy: 78/84 (92.8571%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   6,  Average loss: 0.0149, Accuracy: 65/84 (77.3810%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   7,  Average loss: 0.0137, Accuracy: 77/84 (91.6667%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   8,  Average loss: 0.0093, Accuracy: 79/84 (94.0476%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   9,  Average loss: 0.0082, Accuracy: 79/84 (94.0476%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch  10,  Average loss: 0.0086, Accuracy: 79/84 (94.0476%), train_poison_data_count: 84
Global model norm: 13.97203376968195.
Norm before scaling: 14.053077355308938. Distance: 1.1716613066068184
Total norm for 9 adversaries is: 14.053077355308938. distance: 1.1716613066068184
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 7.4419, Accuracy: 1892/8991 (21.0433%)
poison local model 59 index 58 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   1,  Average loss: 0.0800, Accuracy: 0/27 (0.0000%), train_poison_data_count: 27
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   2,  Average loss: 0.0594, Accuracy: 22/27 (81.4815%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   3,  Average loss: 0.0284, Accuracy: 22/27 (81.4815%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   4,  Average loss: 0.0275, Accuracy: 22/27 (81.4815%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   5,  Average loss: 0.0270, Accuracy: 22/27 (81.4815%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   6,  Average loss: 0.0268, Accuracy: 22/27 (81.4815%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   7,  Average loss: 0.0264, Accuracy: 22/27 (81.4815%), train_poison_data_count: 27
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   8,  Average loss: 0.0256, Accuracy: 22/27 (81.4815%), train_poison_data_count: 27
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   9,  Average loss: 0.0246, Accuracy: 22/27 (81.4815%), train_poison_data_count: 27
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch  10,  Average loss: 0.0244, Accuracy: 22/27 (81.4815%), train_poison_data_count: 27
Global model norm: 13.97203376968195.
Norm before scaling: 13.998345413526781. Distance: 0.632226554957812
Total norm for 9 adversaries is: 13.998345413526781. distance: 0.632226554957812
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 3.8504, Accuracy: 982/8991 (10.9220%)
poison local model 62 index 61 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   1,  Average loss: 1.1047, Accuracy: 0/2 (0.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   2,  Average loss: 0.8270, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   3,  Average loss: 0.3041, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   4,  Average loss: 0.2366, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   5,  Average loss: 0.1620, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   6,  Average loss: 0.0969, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   7,  Average loss: 0.0512, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   8,  Average loss: 0.0246, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   9,  Average loss: 0.0111, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch  10,  Average loss: 0.0103, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Global model norm: 13.97203376968195.
Norm before scaling: 14.01302603585823. Distance: 0.8084859361504655
Total norm for 9 adversaries is: 14.01302603585823. distance: 0.8084859361504655
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 6.5150, Accuracy: 1028/8991 (11.4337%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   1,  Average loss: 0.0264, Accuracy: 138/237 (58.2278%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   2,  Average loss: 0.0167, Accuracy: 183/237 (77.2152%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   3,  Average loss: 0.0109, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   4,  Average loss: 0.0108, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   5,  Average loss: 0.0100, Accuracy: 177/237 (74.6835%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   6,  Average loss: 0.0093, Accuracy: 180/237 (75.9494%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   7,  Average loss: 0.0090, Accuracy: 192/237 (81.0127%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   8,  Average loss: 0.0080, Accuracy: 195/237 (82.2785%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   9,  Average loss: 0.0075, Accuracy: 196/237 (82.7004%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch  10,  Average loss: 0.0075, Accuracy: 196/237 (82.7004%), train_poison_data_count: 237
Global model norm: 13.97203376968195.
Norm before scaling: 14.084423015505019. Distance: 1.6175909598715776
Total norm for 9 adversaries is: 14.084423015505019. distance: 1.6175909598715776
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 3.9646, Accuracy: 1609/8991 (17.8957%)
poison local model 65 index 64 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   1,  Average loss: 0.0113, Accuracy: 1047/1326 (78.9593%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   2,  Average loss: 0.0032, Accuracy: 1245/1326 (93.8914%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   3,  Average loss: 0.0019, Accuracy: 1282/1326 (96.6817%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   4,  Average loss: 0.0017, Accuracy: 1282/1326 (96.6817%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   5,  Average loss: 0.0016, Accuracy: 1284/1326 (96.8326%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   6,  Average loss: 0.0014, Accuracy: 1287/1326 (97.0588%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   7,  Average loss: 0.0014, Accuracy: 1288/1326 (97.1342%), train_poison_data_count: 1326
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   8,  Average loss: 0.0013, Accuracy: 1290/1326 (97.2851%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   9,  Average loss: 0.0012, Accuracy: 1293/1326 (97.5113%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch  10,  Average loss: 0.0012, Accuracy: 1293/1326 (97.5113%), train_poison_data_count: 1326
Global model norm: 13.97203376968195.
Norm before scaling: 14.477098466366899. Distance: 4.062180022329572
Total norm for 9 adversaries is: 14.477098466366899. distance: 4.062180022329572
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 7.4158, Accuracy: 2896/8991 (32.2100%)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   1,  Average loss: 0.0535, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   2,  Average loss: 0.0385, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   3,  Average loss: 0.0336, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   4,  Average loss: 0.0340, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   5,  Average loss: 0.0331, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   6,  Average loss: 0.0313, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   7,  Average loss: 0.0291, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   8,  Average loss: 0.0273, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   9,  Average loss: 0.0263, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch  10,  Average loss: 0.0262, Accuracy: 24/34 (70.5882%), train_poison_data_count: 34
Global model norm: 13.97203376968195.
Norm before scaling: 13.990342215005635. Distance: 0.4418635910751943
Total norm for 9 adversaries is: 13.990342215005635. distance: 0.4418635910751943
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 3.0542, Accuracy: 1010/8991 (11.2335%)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   1,  Average loss: 0.0092, Accuracy: 1906/2324 (82.0138%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   2,  Average loss: 0.0015, Accuracy: 2258/2324 (97.1601%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   3,  Average loss: 0.0007, Accuracy: 2293/2324 (98.6661%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   4,  Average loss: 0.0005, Accuracy: 2301/2324 (99.0103%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   5,  Average loss: 0.0005, Accuracy: 2303/2324 (99.0964%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   6,  Average loss: 0.0004, Accuracy: 2304/2324 (99.1394%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   7,  Average loss: 0.0004, Accuracy: 2304/2324 (99.1394%), train_poison_data_count: 2324
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   8,  Average loss: 0.0004, Accuracy: 2305/2324 (99.1824%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   9,  Average loss: 0.0003, Accuracy: 2306/2324 (99.2255%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch  10,  Average loss: 0.0003, Accuracy: 2307/2324 (99.2685%), train_poison_data_count: 2324
Global model norm: 13.97203376968195.
Norm before scaling: 14.98738788629616. Distance: 5.358613341012445
Total norm for 9 adversaries is: 14.98738788629616. distance: 5.358613341012445
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 3.7447, Accuracy: 5746/8991 (63.9084%)
poison local model 58 index 57 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   1,  Average loss: 0.0203, Accuracy: 507/1015 (49.9507%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   2,  Average loss: 0.0052, Accuracy: 930/1015 (91.6256%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   3,  Average loss: 0.0023, Accuracy: 968/1015 (95.3695%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   4,  Average loss: 0.0019, Accuracy: 975/1015 (96.0591%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   5,  Average loss: 0.0017, Accuracy: 978/1015 (96.3547%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   6,  Average loss: 0.0016, Accuracy: 985/1015 (97.0443%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   7,  Average loss: 0.0015, Accuracy: 989/1015 (97.4384%), train_poison_data_count: 1015
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   8,  Average loss: 0.0014, Accuracy: 995/1015 (98.0296%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   9,  Average loss: 0.0012, Accuracy: 996/1015 (98.1281%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch  10,  Average loss: 0.0012, Accuracy: 997/1015 (98.2266%), train_poison_data_count: 1015
Global model norm: 13.97203376968195.
Norm before scaling: 14.87205617288915. Distance: 4.8327028367544
Total norm for 9 adversaries is: 14.87205617288915. distance: 4.8327028367544
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 4.5837, Accuracy: 4390/8991 (48.8266%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   1,  Average loss: 0.0278, Accuracy: 305/509 (59.9214%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   2,  Average loss: 0.0165, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   3,  Average loss: 0.0129, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   4,  Average loss: 0.0114, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   5,  Average loss: 0.0097, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   6,  Average loss: 0.0079, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   7,  Average loss: 0.0062, Accuracy: 442/509 (86.8369%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   8,  Average loss: 0.0050, Accuracy: 470/509 (92.3379%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   9,  Average loss: 0.0043, Accuracy: 481/509 (94.4990%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch  10,  Average loss: 0.0042, Accuracy: 482/509 (94.6955%), train_poison_data_count: 509
Global model norm: 13.97203376968195.
Norm before scaling: 14.934979214112639. Distance: 5.6704244308797875
Total norm for 9 adversaries is: 14.934979214112639. distance: 5.6704244308797875
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 6.2766, Accuracy: 1824/8991 (20.2870%)
___Train Local_Simple,  epoch   2, local model 81, internal_epoch   1,  Average loss: 0.0597, Accuracy: 3/68 (4.4118%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 4.0249, Accuracy: 958/10000 (9.5800%), Attack Success Rate:12/10000(0.120)
time spent on training: 127.1040313243866
[foolsgold agg] training data poison_ratio: 0.9879132598649129  data num: [84, 27, 2, 237, 1326, 34, 2324, 1015, 509, 68]
[foolsgold agg] considering poison per batch poison_fraction: 0.9879132598649129
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.1334, Accuracy: 2485/10000 (24.8500%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.0063, Accuracy: 2676/8991 (29.7631%)
Done in 379.95463395118713 sec.
Server Epoch:3 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
poison local model 54 index 53 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   1,  Average loss: 0.0443, Accuracy: 22/91 (24.1758%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   2,  Average loss: 0.0301, Accuracy: 52/91 (57.1429%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   3,  Average loss: 0.0214, Accuracy: 49/91 (53.8462%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   4,  Average loss: 0.0181, Accuracy: 62/91 (68.1319%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   5,  Average loss: 0.0157, Accuracy: 84/91 (92.3077%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   6,  Average loss: 0.0171, Accuracy: 62/91 (68.1319%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   7,  Average loss: 0.0150, Accuracy: 58/91 (63.7363%), train_poison_data_count: 91
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   8,  Average loss: 0.0133, Accuracy: 71/91 (78.0220%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   9,  Average loss: 0.0125, Accuracy: 74/91 (81.3187%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch  10,  Average loss: 0.0117, Accuracy: 75/91 (82.4176%), train_poison_data_count: 91
Global model norm: 14.040619913962466.
Norm before scaling: 14.14101723817185. Distance: 1.2427697406613696
Total norm for 9 adversaries is: 14.14101723817185. distance: 1.2427697406613696
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 4.4796, Accuracy: 3055/8991 (33.9784%)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   1,  Average loss: 0.0081, Accuracy: 2313/2803 (82.5187%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   2,  Average loss: 0.0018, Accuracy: 2696/2803 (96.1827%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   3,  Average loss: 0.0008, Accuracy: 2757/2803 (98.3589%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   4,  Average loss: 0.0007, Accuracy: 2765/2803 (98.6443%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   5,  Average loss: 0.0006, Accuracy: 2772/2803 (98.8940%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   6,  Average loss: 0.0005, Accuracy: 2772/2803 (98.8940%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   7,  Average loss: 0.0005, Accuracy: 2777/2803 (99.0724%), train_poison_data_count: 2803
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   8,  Average loss: 0.0005, Accuracy: 2778/2803 (99.1081%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   9,  Average loss: 0.0004, Accuracy: 2783/2803 (99.2865%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch  10,  Average loss: 0.0004, Accuracy: 2783/2803 (99.2865%), train_poison_data_count: 2803
Global model norm: 14.040619913962466.
Norm before scaling: 15.421994225254691. Distance: 6.252115425689339
Total norm for 9 adversaries is: 15.421994225254691. distance: 6.252115425689339
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 4.5253, Accuracy: 4850/8991 (53.9428%)
poison local model 61 index 60 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   1,  Average loss: 0.0110, Accuracy: 594/767 (77.4446%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   2,  Average loss: 0.0023, Accuracy: 739/767 (96.3494%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   3,  Average loss: 0.0015, Accuracy: 750/767 (97.7836%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   4,  Average loss: 0.0013, Accuracy: 753/767 (98.1747%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   5,  Average loss: 0.0012, Accuracy: 752/767 (98.0443%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   6,  Average loss: 0.0011, Accuracy: 754/767 (98.3051%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   7,  Average loss: 0.0010, Accuracy: 755/767 (98.4355%), train_poison_data_count: 767
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   8,  Average loss: 0.0010, Accuracy: 755/767 (98.4355%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   9,  Average loss: 0.0009, Accuracy: 755/767 (98.4355%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch  10,  Average loss: 0.0009, Accuracy: 756/767 (98.5658%), train_poison_data_count: 767
Global model norm: 14.040619913962466.
Norm before scaling: 14.664131696859911. Distance: 3.878470312786097
Total norm for 9 adversaries is: 14.664131696859911. distance: 3.878470312786097
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 5.2187, Accuracy: 2937/8991 (32.6660%)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   1,  Average loss: 0.0092, Accuracy: 944/1205 (78.3402%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   2,  Average loss: 0.0020, Accuracy: 1158/1205 (96.0996%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   3,  Average loss: 0.0015, Accuracy: 1169/1205 (97.0124%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   4,  Average loss: 0.0014, Accuracy: 1170/1205 (97.0954%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   5,  Average loss: 0.0013, Accuracy: 1171/1205 (97.1784%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   6,  Average loss: 0.0013, Accuracy: 1171/1205 (97.1784%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   7,  Average loss: 0.0012, Accuracy: 1171/1205 (97.1784%), train_poison_data_count: 1205
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   8,  Average loss: 0.0012, Accuracy: 1172/1205 (97.2614%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   9,  Average loss: 0.0012, Accuracy: 1172/1205 (97.2614%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch  10,  Average loss: 0.0012, Accuracy: 1172/1205 (97.2614%), train_poison_data_count: 1205
Global model norm: 14.040619913962466.
Norm before scaling: 14.76723288203269. Distance: 4.903332857451339
Total norm for 9 adversaries is: 14.76723288203269. distance: 4.903332857451339
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 4.6949, Accuracy: 1826/8991 (20.3092%)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   1,  Average loss: 0.0253, Accuracy: 144/264 (54.5455%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   2,  Average loss: 0.0103, Accuracy: 197/264 (74.6212%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   3,  Average loss: 0.0073, Accuracy: 237/264 (89.7727%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   4,  Average loss: 0.0061, Accuracy: 241/264 (91.2879%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   5,  Average loss: 0.0063, Accuracy: 244/264 (92.4242%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   6,  Average loss: 0.0061, Accuracy: 245/264 (92.8030%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   7,  Average loss: 0.0062, Accuracy: 246/264 (93.1818%), train_poison_data_count: 264
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   8,  Average loss: 0.0061, Accuracy: 249/264 (94.3182%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   9,  Average loss: 0.0043, Accuracy: 249/264 (94.3182%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch  10,  Average loss: 0.0044, Accuracy: 249/264 (94.3182%), train_poison_data_count: 264
Global model norm: 14.040619913962466.
Norm before scaling: 14.320390816582082. Distance: 2.7148383051316802
Total norm for 9 adversaries is: 14.320390816582082. distance: 2.7148383051316802
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 3.4783, Accuracy: 1832/8991 (20.3759%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   1,  Average loss: 0.0296, Accuracy: 3/63 (4.7619%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   2,  Average loss: 0.0074, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   3,  Average loss: 0.0037, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   4,  Average loss: 0.0040, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   5,  Average loss: 0.0042, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   6,  Average loss: 0.0043, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   7,  Average loss: 0.0043, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   8,  Average loss: 0.0043, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   9,  Average loss: 0.0043, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch  10,  Average loss: 0.0043, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Global model norm: 14.040619913962466.
Norm before scaling: 14.083666253904456. Distance: 0.8456416647341103
Total norm for 9 adversaries is: 14.083666253904456. distance: 0.8456416647341103
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 7.7667, Accuracy: 982/8991 (10.9220%)
___Train Local_Simple,  epoch   3, local model 87, internal_epoch   1,  Average loss: 0.0636, Accuracy: 6/33 (18.1818%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.2695, Accuracy: 1438/10000 (14.3800%), Attack Success Rate:23/10000(0.230)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   1,  Average loss: 0.0163, Accuracy: 312/509 (61.2967%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   2,  Average loss: 0.0070, Accuracy: 413/509 (81.1395%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   3,  Average loss: 0.0038, Accuracy: 472/509 (92.7308%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   4,  Average loss: 0.0031, Accuracy: 484/509 (95.0884%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   5,  Average loss: 0.0026, Accuracy: 489/509 (96.0707%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   6,  Average loss: 0.0022, Accuracy: 495/509 (97.2495%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   7,  Average loss: 0.0019, Accuracy: 494/509 (97.0530%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   8,  Average loss: 0.0017, Accuracy: 493/509 (96.8566%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   9,  Average loss: 0.0016, Accuracy: 495/509 (97.2495%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch  10,  Average loss: 0.0016, Accuracy: 495/509 (97.2495%), train_poison_data_count: 509
Global model norm: 14.040619913962466.
Norm before scaling: 14.491960598796503. Distance: 3.546452165178589
Total norm for 9 adversaries is: 14.491960598796503. distance: 3.546452165178589
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 5.7493, Accuracy: 1929/8991 (21.4548%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   1,  Average loss: 0.0211, Accuracy: 88/151 (58.2781%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   2,  Average loss: 0.0017, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   3,  Average loss: 0.0034, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   4,  Average loss: 0.0035, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   5,  Average loss: 0.0034, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   6,  Average loss: 0.0031, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   7,  Average loss: 0.0030, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   8,  Average loss: 0.0027, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   9,  Average loss: 0.0065, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch  10,  Average loss: 0.0023, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Global model norm: 14.040619913962466.
Norm before scaling: 14.280383995727485. Distance: 2.590994784810373
Total norm for 9 adversaries is: 14.280383995727485. distance: 2.590994784810373
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 24.5604, Accuracy: 980/8991 (10.8998%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   1,  Average loss: 0.0171, Accuracy: 180/237 (75.9494%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   2,  Average loss: 0.0091, Accuracy: 191/237 (80.5907%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   3,  Average loss: 0.0060, Accuracy: 211/237 (89.0295%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   4,  Average loss: 0.0051, Accuracy: 222/237 (93.6709%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   5,  Average loss: 0.0042, Accuracy: 228/237 (96.2025%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   6,  Average loss: 0.0041, Accuracy: 226/237 (95.3586%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   7,  Average loss: 0.0036, Accuracy: 225/237 (94.9367%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   8,  Average loss: 0.0032, Accuracy: 229/237 (96.6245%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   9,  Average loss: 0.0029, Accuracy: 228/237 (96.2025%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch  10,  Average loss: 0.0029, Accuracy: 228/237 (96.2025%), train_poison_data_count: 237
Global model norm: 14.040619913962466.
Norm before scaling: 14.19986350840129. Distance: 1.5490895612275695
Total norm for 9 adversaries is: 14.19986350840129. distance: 1.5490895612275695
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 4.0200, Accuracy: 3570/8991 (39.7064%)
time spent on training: 160.70593571662903
[foolsgold agg] training data poison_ratio: 0.994610485056345  data num: [91, 2803, 767, 1205, 264, 63, 33, 509, 151, 237]
[foolsgold agg] considering poison per batch poison_fraction: 0.994610485056345
[foolsgold agg] wv: [0.79942319 0.94321073 0.94321073 0.79942319 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 1.8391, Accuracy: 4871/10000 (48.7100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 1.6705, Accuracy: 4861/8991 (54.0652%)
Done in 419.46536922454834 sec.
Server Epoch:4 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   1,  Average loss: 0.0304, Accuracy: 437/578 (75.6055%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   2,  Average loss: 0.0162, Accuracy: 335/578 (57.9585%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   3,  Average loss: 0.0063, Accuracy: 527/578 (91.1765%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   4,  Average loss: 0.0037, Accuracy: 543/578 (93.9446%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   5,  Average loss: 0.0032, Accuracy: 545/578 (94.2907%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   6,  Average loss: 0.0028, Accuracy: 547/578 (94.6367%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   7,  Average loss: 0.0026, Accuracy: 548/578 (94.8097%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   8,  Average loss: 0.0024, Accuracy: 548/578 (94.8097%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   9,  Average loss: 0.0023, Accuracy: 549/578 (94.9827%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch  10,  Average loss: 0.0024, Accuracy: 549/578 (94.9827%), train_poison_data_count: 578
Global model norm: 14.110468859003177.
Norm before scaling: 16.567159206096747. Distance: 8.54464486158125
Total norm for 6 adversaries is: 16.567159206096747. distance: 8.54464486158125
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 3.7653, Accuracy: 2857/8991 (31.7762%)
___Train Local_Simple,  epoch   4, local model 92, internal_epoch   1,  Average loss: 0.0111, Accuracy: 169/202 (83.6634%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 13.7269, Accuracy: 958/10000 (9.5800%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch   4, local model 95, internal_epoch   1,  Average loss: 0.0439, Accuracy: 29/29 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.7999, Accuracy: 1971/10000 (19.7100%), Attack Success Rate:7/10000(0.070)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   1,  Average loss: 0.0327, Accuracy: 46/87 (52.8736%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   2,  Average loss: 0.0188, Accuracy: 60/87 (68.9655%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   3,  Average loss: 0.0132, Accuracy: 76/87 (87.3563%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   4,  Average loss: 0.0104, Accuracy: 77/87 (88.5057%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   5,  Average loss: 0.0094, Accuracy: 79/87 (90.8046%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   6,  Average loss: 0.0098, Accuracy: 76/87 (87.3563%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   7,  Average loss: 0.0098, Accuracy: 75/87 (86.2069%), train_poison_data_count: 87
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   8,  Average loss: 0.0076, Accuracy: 76/87 (87.3563%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   9,  Average loss: 0.0073, Accuracy: 79/87 (90.8046%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch  10,  Average loss: 0.0073, Accuracy: 79/87 (90.8046%), train_poison_data_count: 87
Global model norm: 14.110468859003177.
Norm before scaling: 14.202205347013892. Distance: 1.0964164383963801
Total norm for 6 adversaries is: 14.202205347013892. distance: 1.0964164383963801
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 2.9233, Accuracy: 2682/8991 (29.8298%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.4241, Accuracy: 0/5 (0.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   2,  Average loss: 0.2666, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   3,  Average loss: 0.1087, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   4,  Average loss: 0.0963, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   5,  Average loss: 0.0817, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   6,  Average loss: 0.0664, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   7,  Average loss: 0.0521, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   8,  Average loss: 0.0402, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   9,  Average loss: 0.0311, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch  10,  Average loss: 0.0304, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.110468859003177.
Norm before scaling: 14.160207974043463. Distance: 0.8113523227130172
Total norm for 6 adversaries is: 14.160207974043463. distance: 0.8113523227130172
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 2.8837, Accuracy: 2695/8991 (29.9744%)
___Train Local_Simple,  epoch   4, local model 99, internal_epoch   1,  Average loss: 0.0119, Accuracy: 394/411 (95.8637%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.3657, Accuracy: 1952/10000 (19.5200%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch   4, local model 94, internal_epoch   1,  Average loss: 0.0103, Accuracy: 518/607 (85.3377%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 3.3919, Accuracy: 1269/10000 (12.6900%), Attack Success Rate:28/10000(0.280)
poison local model 74 index 73 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   1,  Average loss: 0.0122, Accuracy: 553/762 (72.5722%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   2,  Average loss: 0.0025, Accuracy: 734/762 (96.3255%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   3,  Average loss: 0.0014, Accuracy: 741/762 (97.2441%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   4,  Average loss: 0.0011, Accuracy: 745/762 (97.7690%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   5,  Average loss: 0.0009, Accuracy: 750/762 (98.4252%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   6,  Average loss: 0.0008, Accuracy: 751/762 (98.5564%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   7,  Average loss: 0.0007, Accuracy: 753/762 (98.8189%), train_poison_data_count: 762
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   8,  Average loss: 0.0006, Accuracy: 754/762 (98.9501%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   9,  Average loss: 0.0006, Accuracy: 756/762 (99.2126%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch  10,  Average loss: 0.0006, Accuracy: 756/762 (99.2126%), train_poison_data_count: 762
Global model norm: 14.110468859003177.
Norm before scaling: 14.776619893717184. Distance: 3.794438714699044
Total norm for 6 adversaries is: 14.776619893717184. distance: 3.794438714699044
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 5.9079, Accuracy: 3887/8991 (43.2321%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   1,  Average loss: 0.0129, Accuracy: 285/388 (73.4536%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   2,  Average loss: 0.0051, Accuracy: 351/388 (90.4639%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   3,  Average loss: 0.0032, Accuracy: 368/388 (94.8454%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   4,  Average loss: 0.0027, Accuracy: 371/388 (95.6186%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   5,  Average loss: 0.0023, Accuracy: 372/388 (95.8763%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   6,  Average loss: 0.0019, Accuracy: 373/388 (96.1340%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   7,  Average loss: 0.0017, Accuracy: 375/388 (96.6495%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   8,  Average loss: 0.0016, Accuracy: 376/388 (96.9072%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   9,  Average loss: 0.0017, Accuracy: 376/388 (96.9072%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch  10,  Average loss: 0.0015, Accuracy: 376/388 (96.9072%), train_poison_data_count: 388
Global model norm: 14.110468859003177.
Norm before scaling: 14.490197913461675. Distance: 3.050036389493392
Total norm for 6 adversaries is: 14.490197913461675. distance: 3.050036389493392
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 4.1377, Accuracy: 2065/8991 (22.9674%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   1,  Average loss: 0.0422, Accuracy: 11/47 (23.4043%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   2,  Average loss: 0.0135, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   3,  Average loss: 0.0047, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   4,  Average loss: 0.0051, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   5,  Average loss: 0.0053, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   6,  Average loss: 0.0055, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   7,  Average loss: 0.0056, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   8,  Average loss: 0.0056, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   9,  Average loss: 0.0056, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch  10,  Average loss: 0.0055, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Global model norm: 14.110468859003177.
Norm before scaling: 14.153120558138516. Distance: 0.8570311053405473
Total norm for 6 adversaries is: 14.153120558138516. distance: 0.8570311053405473
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 6.1857, Accuracy: 1032/8991 (11.4781%)
time spent on training: 102.87006211280823
[foolsgold agg] training data poison_ratio: 0.5991655969191271  data num: [578, 202, 29, 87, 5, 411, 607, 762, 388, 47]
[foolsgold agg] considering poison per batch poison_fraction: 0.5991655969191271
[foolsgold agg] wv: [1.         0.22397971 1.         1.         1.         1.
 1.         0.22397971 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 1.7753, Accuracy: 6677/10000 (66.7700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 1.6345, Accuracy: 6668/8991 (74.1631%)
Done in 464.3621940612793 sec.
Server Epoch:5 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
poison local model 60 index 59 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   1,  Average loss: 0.0433, Accuracy: 306/399 (76.6917%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   2,  Average loss: 0.0240, Accuracy: 226/399 (56.6416%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   3,  Average loss: 0.0125, Accuracy: 325/399 (81.4536%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   4,  Average loss: 0.0072, Accuracy: 386/399 (96.7419%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   5,  Average loss: 0.0030, Accuracy: 384/399 (96.2406%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   6,  Average loss: 0.0018, Accuracy: 389/399 (97.4937%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   7,  Average loss: 0.0015, Accuracy: 388/399 (97.2431%), train_poison_data_count: 399
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   8,  Average loss: 0.0015, Accuracy: 389/399 (97.4937%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   9,  Average loss: 0.0013, Accuracy: 390/399 (97.7444%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch  10,  Average loss: 0.0016, Accuracy: 391/399 (97.9950%), train_poison_data_count: 399
Global model norm: 14.14670158197359.
Norm before scaling: 16.037155877908766. Distance: 7.547112818538753
Total norm for 10 adversaries is: 16.037155877908766. distance: 7.547112818538753
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 9.8566, Accuracy: 1880/8991 (20.9098%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   1,  Average loss: 0.0139, Accuracy: 173/196 (88.2653%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   2,  Average loss: 0.0164, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   3,  Average loss: 0.0040, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   4,  Average loss: 0.0027, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   5,  Average loss: 0.0021, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   6,  Average loss: 0.0040, Accuracy: 185/196 (94.3878%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   7,  Average loss: 0.0034, Accuracy: 185/196 (94.3878%), train_poison_data_count: 196
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   8,  Average loss: 0.0019, Accuracy: 186/196 (94.8980%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   9,  Average loss: 0.0018, Accuracy: 186/196 (94.8980%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch  10,  Average loss: 0.0021, Accuracy: 186/196 (94.8980%), train_poison_data_count: 196
Global model norm: 14.14670158197359.
Norm before scaling: 14.282693935995965. Distance: 1.7731286674840767
Total norm for 10 adversaries is: 14.282693935995965. distance: 1.7731286674840767
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 2.6846, Accuracy: 1439/8991 (16.0049%)
poison local model 65 index 64 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   1,  Average loss: 0.0057, Accuracy: 1212/1326 (91.4027%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   2,  Average loss: 0.0014, Accuracy: 1292/1326 (97.4359%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   3,  Average loss: 0.0009, Accuracy: 1304/1326 (98.3409%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   4,  Average loss: 0.0007, Accuracy: 1312/1326 (98.9442%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   5,  Average loss: 0.0006, Accuracy: 1314/1326 (99.0950%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   6,  Average loss: 0.0006, Accuracy: 1314/1326 (99.0950%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   7,  Average loss: 0.0006, Accuracy: 1315/1326 (99.1704%), train_poison_data_count: 1326
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   8,  Average loss: 0.0005, Accuracy: 1314/1326 (99.0950%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   9,  Average loss: 0.0005, Accuracy: 1317/1326 (99.3213%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1317/1326 (99.3213%), train_poison_data_count: 1326
Global model norm: 14.14670158197359.
Norm before scaling: 14.594000934673465. Distance: 3.2353503834324746
Total norm for 10 adversaries is: 14.594000934673465. distance: 3.2353503834324746
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 5.8418, Accuracy: 3513/8991 (39.0724%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0423, Accuracy: 18/48 (37.5000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   2,  Average loss: 0.0287, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   3,  Average loss: 0.0047, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   4,  Average loss: 0.0035, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   5,  Average loss: 0.0027, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   6,  Average loss: 0.0021, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   7,  Average loss: 0.0018, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   8,  Average loss: 0.0017, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   9,  Average loss: 0.0017, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch  10,  Average loss: 0.0017, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Global model norm: 14.14670158197359.
Norm before scaling: 14.192344342618421. Distance: 0.7598732134193569
Total norm for 10 adversaries is: 14.192344342618421. distance: 0.7598732134193569
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 4.2795, Accuracy: 1141/8991 (12.6905%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   1,  Average loss: 0.0169, Accuracy: 257/304 (84.5395%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   2,  Average loss: 0.0049, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   3,  Average loss: 0.0030, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   4,  Average loss: 0.0027, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   5,  Average loss: 0.0023, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   6,  Average loss: 0.0022, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   7,  Average loss: 0.0020, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   8,  Average loss: 0.0019, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   9,  Average loss: 0.0017, Accuracy: 292/304 (96.0526%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch  10,  Average loss: 0.0017, Accuracy: 292/304 (96.0526%), train_poison_data_count: 304
Global model norm: 14.14670158197359.
Norm before scaling: 14.31040226251656. Distance: 2.209174757628108
Total norm for 10 adversaries is: 14.31040226251656. distance: 2.209174757628108
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 4.4118, Accuracy: 1269/8991 (14.1141%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   1,  Average loss: 0.3491, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   2,  Average loss: 0.2080, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   3,  Average loss: 0.0710, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   4,  Average loss: 0.0669, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   5,  Average loss: 0.0601, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   6,  Average loss: 0.0506, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   7,  Average loss: 0.0393, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   8,  Average loss: 0.0283, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   9,  Average loss: 0.0191, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch  10,  Average loss: 0.0183, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.14670158197359.
Norm before scaling: 14.194773418664582. Distance: 0.706125469537823
Total norm for 10 adversaries is: 14.194773418664582. distance: 0.706125469537823
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 2.6185, Accuracy: 1277/8991 (14.2031%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0231, Accuracy: 82/86 (95.3488%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   2,  Average loss: 0.0051, Accuracy: 78/86 (90.6977%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   3,  Average loss: 0.0045, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   4,  Average loss: 0.0039, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   5,  Average loss: 0.0021, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   6,  Average loss: 0.0024, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   7,  Average loss: 0.0016, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   8,  Average loss: 0.0015, Accuracy: 85/86 (98.8372%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   9,  Average loss: 0.0037, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch  10,  Average loss: 0.0017, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Global model norm: 14.14670158197359.
Norm before scaling: 14.262291676557014. Distance: 1.1268092018928484
Total norm for 10 adversaries is: 14.262291676557014. distance: 1.1268092018928484
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 7.3893, Accuracy: 1903/8991 (21.1656%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0167, Accuracy: 417/463 (90.0648%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   2,  Average loss: 0.0048, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   3,  Average loss: 0.0037, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   4,  Average loss: 0.0025, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   5,  Average loss: 0.0025, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   6,  Average loss: 0.0021, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   7,  Average loss: 0.0020, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   8,  Average loss: 0.0016, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   9,  Average loss: 0.0016, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch  10,  Average loss: 0.0015, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Global model norm: 14.14670158197359.
Norm before scaling: 14.407558025962775. Distance: 2.798578436202981
Total norm for 10 adversaries is: 14.407558025962775. distance: 2.798578436202981
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 4.1887, Accuracy: 892/8991 (9.9210%)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   1,  Average loss: 0.0282, Accuracy: 81/87 (93.1034%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   2,  Average loss: 0.0139, Accuracy: 61/87 (70.1149%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   3,  Average loss: 0.0077, Accuracy: 79/87 (90.8046%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   4,  Average loss: 0.0091, Accuracy: 79/87 (90.8046%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   5,  Average loss: 0.0068, Accuracy: 79/87 (90.8046%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   6,  Average loss: 0.0046, Accuracy: 79/87 (90.8046%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   7,  Average loss: 0.0047, Accuracy: 82/87 (94.2529%), train_poison_data_count: 87
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   8,  Average loss: 0.0049, Accuracy: 83/87 (95.4023%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   9,  Average loss: 0.0040, Accuracy: 83/87 (95.4023%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch  10,  Average loss: 0.0035, Accuracy: 83/87 (95.4023%), train_poison_data_count: 87
Global model norm: 14.14670158197359.
Norm before scaling: 14.255795019934547. Distance: 0.9812673227032449
Total norm for 10 adversaries is: 14.255795019934547. distance: 0.9812673227032449
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 2.8582, Accuracy: 3403/8991 (37.8490%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   1,  Average loss: 0.0053, Accuracy: 1177/1259 (93.4869%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   2,  Average loss: 0.0011, Accuracy: 1231/1259 (97.7760%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   3,  Average loss: 0.0007, Accuracy: 1238/1259 (98.3320%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   4,  Average loss: 0.0006, Accuracy: 1240/1259 (98.4909%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   5,  Average loss: 0.0006, Accuracy: 1243/1259 (98.7292%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   6,  Average loss: 0.0005, Accuracy: 1245/1259 (98.8880%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   7,  Average loss: 0.0005, Accuracy: 1245/1259 (98.8880%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   8,  Average loss: 0.0005, Accuracy: 1245/1259 (98.8880%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   9,  Average loss: 0.0004, Accuracy: 1246/1259 (98.9674%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch  10,  Average loss: 0.0004, Accuracy: 1246/1259 (98.9674%), train_poison_data_count: 1259
Global model norm: 14.14670158197359.
Norm before scaling: 14.681214371431333. Distance: 3.641092033063337
Total norm for 10 adversaries is: 14.681214371431333. distance: 3.641092033063337
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 3.2348, Accuracy: 2790/8991 (31.0310%)
time spent on training: 167.0543019771576
[foolsgold agg] training data poison_ratio: 1.0  data num: [399, 196, 1326, 48, 304, 5, 86, 463, 87, 1259]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 1.6266, Accuracy: 5789/10000 (57.8900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 1.4322, Accuracy: 5863/8991 (65.2097%)
Done in 517.3487501144409 sec.
Server Epoch:6 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   1,  Average loss: 0.0046, Accuracy: 1244/1311 (94.8894%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1297/1311 (98.9321%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1301/1311 (99.2372%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1303/1311 (99.3898%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1304/1311 (99.4661%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1304/1311 (99.4661%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1304/1311 (99.4661%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1304/1311 (99.4661%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1304/1311 (99.4661%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1304/1311 (99.4661%), train_poison_data_count: 1311
Global model norm: 14.220966945988808.
Norm before scaling: 14.719649819894238. Distance: 3.731869164089993
Total norm for 8 adversaries is: 14.719649819894238. distance: 3.731869164089993
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 5.6215, Accuracy: 1982/8991 (22.0443%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   1,  Average loss: 0.0065, Accuracy: 1097/1232 (89.0422%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   2,  Average loss: 0.0023, Accuracy: 1183/1232 (96.0227%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   3,  Average loss: 0.0011, Accuracy: 1206/1232 (97.8896%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   4,  Average loss: 0.0011, Accuracy: 1208/1232 (98.0519%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   5,  Average loss: 0.0009, Accuracy: 1213/1232 (98.4578%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   6,  Average loss: 0.0008, Accuracy: 1214/1232 (98.5390%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   7,  Average loss: 0.0009, Accuracy: 1213/1232 (98.4578%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   8,  Average loss: 0.0007, Accuracy: 1216/1232 (98.7013%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   9,  Average loss: 0.0006, Accuracy: 1215/1232 (98.6201%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch  10,  Average loss: 0.0007, Accuracy: 1215/1232 (98.6201%), train_poison_data_count: 1232
Global model norm: 14.220966945988808.
Norm before scaling: 14.80630659846981. Distance: 3.637979356569815
Total norm for 8 adversaries is: 14.80630659846981. distance: 3.637979356569815
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 2.8387, Accuracy: 4747/8991 (52.7972%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0093, Accuracy: 413/463 (89.2009%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   2,  Average loss: 0.0030, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   3,  Average loss: 0.0015, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   4,  Average loss: 0.0013, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   5,  Average loss: 0.0016, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   6,  Average loss: 0.0013, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   7,  Average loss: 0.0015, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   8,  Average loss: 0.0018, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   9,  Average loss: 0.0011, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch  10,  Average loss: 0.0011, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Global model norm: 14.220966945988808.
Norm before scaling: 14.435398758076879. Distance: 2.5161160765709534
Total norm for 8 adversaries is: 14.435398758076879. distance: 2.5161160765709534
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 3.4397, Accuracy: 903/8991 (10.0434%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   1,  Average loss: 0.0070, Accuracy: 461/509 (90.5697%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   2,  Average loss: 0.0522, Accuracy: 343/509 (67.3870%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   3,  Average loss: 0.0173, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   4,  Average loss: 0.0149, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   5,  Average loss: 0.0122, Accuracy: 368/509 (72.2986%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   6,  Average loss: 0.0090, Accuracy: 370/509 (72.6916%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   7,  Average loss: 0.0066, Accuracy: 441/509 (86.6405%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   8,  Average loss: 0.0053, Accuracy: 470/509 (92.3379%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   9,  Average loss: 0.0047, Accuracy: 473/509 (92.9273%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch  10,  Average loss: 0.0046, Accuracy: 475/509 (93.3202%), train_poison_data_count: 509
Global model norm: 14.220966945988808.
Norm before scaling: 17.53851004837061. Distance: 10.732602968501732
Total norm for 8 adversaries is: 17.53851004837061. distance: 10.732602968501732
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 6.0882, Accuracy: 1749/8991 (19.4528%)
___Train Local_Simple,  epoch   6, local model 99, internal_epoch   1,  Average loss: 0.0075, Accuracy: 382/411 (92.9440%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 5.7913, Accuracy: 1673/10000 (16.7300%), Attack Success Rate:19/10000(0.190)
poison local model 67 index 66 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   1,  Average loss: 0.0101, Accuracy: 470/568 (82.7465%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   2,  Average loss: 0.0024, Accuracy: 544/568 (95.7746%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   3,  Average loss: 0.0013, Accuracy: 558/568 (98.2394%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   4,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   5,  Average loss: 0.0008, Accuracy: 562/568 (98.9437%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   6,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   7,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   8,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   9,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch  10,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%), train_poison_data_count: 568
Global model norm: 14.220966945988808.
Norm before scaling: 14.670961849245987. Distance: 2.6510060326080582
Total norm for 8 adversaries is: 14.670961849245987. distance: 2.6510060326080582
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 3.5729, Accuracy: 5485/8991 (61.0054%)
___Train Local_Simple,  epoch   6, local model 91, internal_epoch   1,  Average loss: 0.0091, Accuracy: 171/182 (93.9560%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 7.8573, Accuracy: 1811/10000 (18.1100%), Attack Success Rate:12/10000(0.120)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   1,  Average loss: 0.0284, Accuracy: 67/87 (77.0115%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   2,  Average loss: 0.0098, Accuracy: 71/87 (81.6092%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   3,  Average loss: 0.0070, Accuracy: 74/87 (85.0575%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   4,  Average loss: 0.0072, Accuracy: 79/87 (90.8046%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   5,  Average loss: 0.0065, Accuracy: 80/87 (91.9540%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   6,  Average loss: 0.0050, Accuracy: 80/87 (91.9540%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   7,  Average loss: 0.0062, Accuracy: 80/87 (91.9540%), train_poison_data_count: 87
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   8,  Average loss: 0.0054, Accuracy: 81/87 (93.1034%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   9,  Average loss: 0.0034, Accuracy: 86/87 (98.8506%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch  10,  Average loss: 0.0032, Accuracy: 86/87 (98.8506%), train_poison_data_count: 87
Global model norm: 14.220966945988808.
Norm before scaling: 14.333448779210466. Distance: 1.0626543157375092
Total norm for 8 adversaries is: 14.333448779210466. distance: 1.0626543157375092
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 2.8439, Accuracy: 3238/8991 (36.0138%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0110, Accuracy: 151/171 (88.3041%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   2,  Average loss: 0.0096, Accuracy: 149/171 (87.1345%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   3,  Average loss: 0.0055, Accuracy: 154/171 (90.0585%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   4,  Average loss: 0.0039, Accuracy: 157/171 (91.8129%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   5,  Average loss: 0.0032, Accuracy: 161/171 (94.1520%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   6,  Average loss: 0.0032, Accuracy: 158/171 (92.3977%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   7,  Average loss: 0.0033, Accuracy: 157/171 (91.8129%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   8,  Average loss: 0.0031, Accuracy: 157/171 (91.8129%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   9,  Average loss: 0.0032, Accuracy: 159/171 (92.9825%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch  10,  Average loss: 0.0027, Accuracy: 160/171 (93.5673%), train_poison_data_count: 171
Global model norm: 14.220966945988808.
Norm before scaling: 14.314465783397663. Distance: 0.9632702556889189
Total norm for 8 adversaries is: 14.314465783397663. distance: 0.9632702556889189
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 2.3367, Accuracy: 2481/8991 (27.5943%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   1,  Average loss: 0.0183, Accuracy: 108/128 (84.3750%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   2,  Average loss: 0.0077, Accuracy: 115/128 (89.8438%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   3,  Average loss: 0.0039, Accuracy: 119/128 (92.9688%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   4,  Average loss: 0.0034, Accuracy: 120/128 (93.7500%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   5,  Average loss: 0.0032, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   6,  Average loss: 0.0034, Accuracy: 122/128 (95.3125%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   7,  Average loss: 0.0032, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   8,  Average loss: 0.0029, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   9,  Average loss: 0.0027, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch  10,  Average loss: 0.0027, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Global model norm: 14.220966945988808.
Norm before scaling: 14.352720825431442. Distance: 1.0741140418606305
Total norm for 8 adversaries is: 14.352720825431442. distance: 1.0741140418606305
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 3.4305, Accuracy: 3830/8991 (42.5982%)
time spent on training: 168.50840377807617
[foolsgold agg] training data poison_ratio: 0.8828526274199922  data num: [1311, 1232, 463, 509, 411, 568, 182, 87, 171, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.8828526274199922
[foolsgold agg] wv: [0.72322857 1.         1.         1.         1.         1.
 1.         0.72322857 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 1.6340, Accuracy: 6528/10000 (65.2800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 1.4502, Accuracy: 6486/8991 (72.1388%)
Done in 553.5253000259399 sec.
Server Epoch:7 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
poison local model 66 index 65 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   1,  Average loss: 0.0066, Accuracy: 597/681 (87.6652%), train_poison_data_count: 681
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   2,  Average loss: 0.0015, Accuracy: 672/681 (98.6784%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   3,  Average loss: 0.0009, Accuracy: 673/681 (98.8253%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   4,  Average loss: 0.0008, Accuracy: 675/681 (99.1189%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   5,  Average loss: 0.0008, Accuracy: 675/681 (99.1189%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   6,  Average loss: 0.0006, Accuracy: 675/681 (99.1189%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   7,  Average loss: 0.0005, Accuracy: 675/681 (99.1189%), train_poison_data_count: 681
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   8,  Average loss: 0.0004, Accuracy: 676/681 (99.2658%), train_poison_data_count: 681
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   9,  Average loss: 0.0004, Accuracy: 677/681 (99.4126%), train_poison_data_count: 681
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch  10,  Average loss: 0.0004, Accuracy: 677/681 (99.4126%), train_poison_data_count: 681
Global model norm: 14.284527625798043.
Norm before scaling: 14.662456833043342. Distance: 2.895547994556771
Total norm for 9 adversaries is: 14.662456833043342. distance: 2.895547994556771
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 5.4412, Accuracy: 3109/8991 (34.5790%)
poison local model 68 index 67 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   1,  Average loss: 0.0056, Accuracy: 1440/1591 (90.5091%), train_poison_data_count: 1591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   2,  Average loss: 0.0012, Accuracy: 1555/1591 (97.7373%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1569/1591 (98.6172%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1574/1591 (98.9315%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1582/1591 (99.4343%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1583/1591 (99.4972%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1583/1591 (99.4972%), train_poison_data_count: 1591
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   8,  Average loss: 0.0004, Accuracy: 1583/1591 (99.4972%), train_poison_data_count: 1591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1583/1591 (99.4972%), train_poison_data_count: 1591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1583/1591 (99.4972%), train_poison_data_count: 1591
Global model norm: 14.284527625798043.
Norm before scaling: 15.092329065006677. Distance: 4.268702699725932
Total norm for 9 adversaries is: 15.092329065006677. distance: 4.268702699725932
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 3.3400, Accuracy: 4035/8991 (44.8782%)
poison local model 59 index 58 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   1,  Average loss: 0.0481, Accuracy: 23/27 (85.1852%), train_poison_data_count: 27
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   2,  Average loss: 0.0249, Accuracy: 26/27 (96.2963%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   3,  Average loss: 0.0098, Accuracy: 24/27 (88.8889%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   4,  Average loss: 0.0095, Accuracy: 24/27 (88.8889%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   5,  Average loss: 0.0089, Accuracy: 24/27 (88.8889%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   6,  Average loss: 0.0082, Accuracy: 24/27 (88.8889%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   7,  Average loss: 0.0072, Accuracy: 24/27 (88.8889%), train_poison_data_count: 27
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   8,  Average loss: 0.0060, Accuracy: 25/27 (92.5926%), train_poison_data_count: 27
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   9,  Average loss: 0.0049, Accuracy: 26/27 (96.2963%), train_poison_data_count: 27
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch  10,  Average loss: 0.0048, Accuracy: 26/27 (96.2963%), train_poison_data_count: 27
Global model norm: 14.284527625798043.
Norm before scaling: 14.339077057446026. Distance: 0.6247106597637583
Total norm for 9 adversaries is: 14.339077057446026. distance: 0.6247106597637583
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 1.9882, Accuracy: 2454/8991 (27.2940%)
poison local model 62 index 61 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   1,  Average loss: 0.8523, Accuracy: 1/2 (50.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   2,  Average loss: 0.3615, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   3,  Average loss: 0.0224, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   4,  Average loss: 0.0153, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   5,  Average loss: 0.0105, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   6,  Average loss: 0.0072, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   7,  Average loss: 0.0049, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   8,  Average loss: 0.0035, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   9,  Average loss: 0.0025, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch  10,  Average loss: 0.0024, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Global model norm: 14.284527625798043.
Norm before scaling: 14.335688966680815. Distance: 0.8122396785682622
Total norm for 9 adversaries is: 14.335688966680815. distance: 0.8122396785682622
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 3.1188, Accuracy: 1107/8991 (12.3123%)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   1,  Average loss: 0.0052, Accuracy: 1676/1839 (91.1365%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   2,  Average loss: 0.0011, Accuracy: 1804/1839 (98.0968%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1824/1839 (99.1843%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1824/1839 (99.1843%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1827/1839 (99.3475%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1829/1839 (99.4562%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1827/1839 (99.3475%), train_poison_data_count: 1839
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1828/1839 (99.4018%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1831/1839 (99.5650%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1831/1839 (99.5650%), train_poison_data_count: 1839
Global model norm: 14.284527625798043.
Norm before scaling: 15.199969663087787. Distance: 4.4642819562623695
Total norm for 9 adversaries is: 15.199969663087787. distance: 4.4642819562623695
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 3.1870, Accuracy: 5081/8991 (56.5121%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0156, Accuracy: 579/688 (84.1570%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   2,  Average loss: 0.0075, Accuracy: 605/688 (87.9360%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   3,  Average loss: 0.0024, Accuracy: 658/688 (95.6395%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   4,  Average loss: 0.0019, Accuracy: 666/688 (96.8023%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   5,  Average loss: 0.0016, Accuracy: 665/688 (96.6570%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   6,  Average loss: 0.0014, Accuracy: 670/688 (97.3837%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   7,  Average loss: 0.0013, Accuracy: 674/688 (97.9651%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   8,  Average loss: 0.0012, Accuracy: 674/688 (97.9651%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   9,  Average loss: 0.0011, Accuracy: 674/688 (97.9651%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch  10,  Average loss: 0.0011, Accuracy: 674/688 (97.9651%), train_poison_data_count: 688
Global model norm: 14.284527625798043.
Norm before scaling: 15.57657829113203. Distance: 5.44674825690491
Total norm for 9 adversaries is: 15.57657829113203. distance: 5.44674825690491
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 5.0661, Accuracy: 2822/8991 (31.3869%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   1,  Average loss: 0.0088, Accuracy: 398/428 (92.9907%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   2,  Average loss: 0.0022, Accuracy: 414/428 (96.7290%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   3,  Average loss: 0.0005, Accuracy: 425/428 (99.2991%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   4,  Average loss: 0.0002, Accuracy: 425/428 (99.2991%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   5,  Average loss: 0.0001, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   6,  Average loss: 0.0001, Accuracy: 427/428 (99.7664%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   7,  Average loss: 0.0001, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   8,  Average loss: 0.0001, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 14.284527625798043.
Norm before scaling: 14.666109132284477. Distance: 2.6209534836374173
Total norm for 9 adversaries is: 14.666109132284477. distance: 2.6209534836374173
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 13.5712, Accuracy: 2781/8991 (30.9309%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0257, Accuracy: 73/86 (84.8837%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   2,  Average loss: 0.0053, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   3,  Average loss: 0.0042, Accuracy: 79/86 (91.8605%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   4,  Average loss: 0.0034, Accuracy: 80/86 (93.0233%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   5,  Average loss: 0.0036, Accuracy: 83/86 (96.5116%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   6,  Average loss: 0.0011, Accuracy: 85/86 (98.8372%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   7,  Average loss: 0.0021, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   8,  Average loss: 0.0010, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   9,  Average loss: 0.0010, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch  10,  Average loss: 0.0019, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Global model norm: 14.284527625798043.
Norm before scaling: 14.404236890764933. Distance: 1.1336815493106949
Total norm for 9 adversaries is: 14.404236890764933. distance: 1.1336815493106949
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 4.2712, Accuracy: 1950/8991 (21.6884%)
___Train Local_Simple,  epoch   7, local model 99, internal_epoch   1,  Average loss: 0.0062, Accuracy: 382/411 (92.9440%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 11.6087, Accuracy: 1509/10000 (15.0900%), Attack Success Rate:21/10000(0.210)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   1,  Average loss: 0.0101, Accuracy: 330/388 (85.0515%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   2,  Average loss: 0.0067, Accuracy: 365/388 (94.0722%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   3,  Average loss: 0.0058, Accuracy: 356/388 (91.7526%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   4,  Average loss: 0.0036, Accuracy: 372/388 (95.8763%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   5,  Average loss: 0.0016, Accuracy: 375/388 (96.6495%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   6,  Average loss: 0.0010, Accuracy: 380/388 (97.9381%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   7,  Average loss: 0.0011, Accuracy: 379/388 (97.6804%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   8,  Average loss: 0.0011, Accuracy: 380/388 (97.9381%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   9,  Average loss: 0.0010, Accuracy: 380/388 (97.9381%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch  10,  Average loss: 0.0012, Accuracy: 380/388 (97.9381%), train_poison_data_count: 388
Global model norm: 14.284527625798043.
Norm before scaling: 14.578221818575871. Distance: 2.501344700611912
Total norm for 9 adversaries is: 14.578221818575871. distance: 2.501344700611912
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 4.3495, Accuracy: 2400/8991 (26.6934%)
time spent on training: 199.5930392742157
[foolsgold agg] training data poison_ratio: 0.9330727894479727  data num: [681, 1591, 27, 2, 1839, 688, 428, 86, 411, 388]
[foolsgold agg] considering poison per batch poison_fraction: 0.9330727894479727
[foolsgold agg] wv: [1.         1.         1.         0.62827955 1.         1.
 1.         1.         1.         0.62827955]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 1.4192, Accuracy: 7734/10000 (77.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 1.1829, Accuracy: 7678/8991 (85.3965%)
Done in 578.4305400848389 sec.
Server Epoch:8 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   1,  Average loss: 0.0012, Accuracy: 2980/3022 (98.6102%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   2,  Average loss: 0.0001, Accuracy: 3016/3022 (99.8015%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   3,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   4,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   5,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   6,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   7,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   8,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   9,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch  10,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Global model norm: 14.355623404779179.
Norm before scaling: 14.380416778339562. Distance: 2.690549318177409
Total norm for 7 adversaries is: 14.380416778339562. distance: 2.690549318177409
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 7.5961, Accuracy: 1920/8991 (21.3547%)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2555/2803 (91.1523%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   2,  Average loss: 0.0013, Accuracy: 2735/2803 (97.5740%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   3,  Average loss: 0.0006, Accuracy: 2772/2803 (98.8940%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   4,  Average loss: 0.0004, Accuracy: 2782/2803 (99.2508%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   5,  Average loss: 0.0004, Accuracy: 2787/2803 (99.4292%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   6,  Average loss: 0.0003, Accuracy: 2789/2803 (99.5005%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   7,  Average loss: 0.0003, Accuracy: 2791/2803 (99.5719%), train_poison_data_count: 2803
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   8,  Average loss: 0.0003, Accuracy: 2793/2803 (99.6432%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   9,  Average loss: 0.0003, Accuracy: 2793/2803 (99.6432%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch  10,  Average loss: 0.0003, Accuracy: 2793/2803 (99.6432%), train_poison_data_count: 2803
Global model norm: 14.355623404779179.
Norm before scaling: 15.706977819481368. Distance: 5.397609442926031
Total norm for 7 adversaries is: 15.706977819481368. distance: 5.397609442926031
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 3.5942, Accuracy: 4806/8991 (53.4535%)
poison local model 79 index 78 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   1,  Average loss: 0.0432, Accuracy: 24/25 (96.0000%), train_poison_data_count: 25
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   2,  Average loss: 0.0203, Accuracy: 24/25 (96.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   3,  Average loss: 0.0129, Accuracy: 22/25 (88.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   4,  Average loss: 0.0128, Accuracy: 22/25 (88.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   5,  Average loss: 0.0121, Accuracy: 23/25 (92.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   6,  Average loss: 0.0109, Accuracy: 23/25 (92.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   7,  Average loss: 0.0094, Accuracy: 24/25 (96.0000%), train_poison_data_count: 25
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   8,  Average loss: 0.0079, Accuracy: 24/25 (96.0000%), train_poison_data_count: 25
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   9,  Average loss: 0.0064, Accuracy: 24/25 (96.0000%), train_poison_data_count: 25
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch  10,  Average loss: 0.0062, Accuracy: 24/25 (96.0000%), train_poison_data_count: 25
Global model norm: 14.355623404779179.
Norm before scaling: 14.407287957456202. Distance: 0.5512106283664275
Total norm for 7 adversaries is: 14.407287957456202. distance: 0.5512106283664275
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 1.6040, Accuracy: 3798/8991 (42.2422%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0107, Accuracy: 230/263 (87.4525%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   2,  Average loss: 0.0060, Accuracy: 248/263 (94.2966%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   3,  Average loss: 0.0028, Accuracy: 257/263 (97.7186%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   4,  Average loss: 0.0023, Accuracy: 257/263 (97.7186%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   5,  Average loss: 0.0015, Accuracy: 256/263 (97.3384%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   6,  Average loss: 0.0008, Accuracy: 259/263 (98.4791%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   7,  Average loss: 0.0004, Accuracy: 259/263 (98.4791%), train_poison_data_count: 263
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   8,  Average loss: 0.0002, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   9,  Average loss: 0.0003, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch  10,  Average loss: 0.0002, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Global model norm: 14.355623404779179.
Norm before scaling: 14.643206878632483. Distance: 2.103160831775346
Total norm for 7 adversaries is: 14.643206878632483. distance: 2.103160831775346
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 10.5123, Accuracy: 2414/8991 (26.8491%)
poison local model 62 index 61 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   1,  Average loss: 0.5876, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   2,  Average loss: 0.1575, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   3,  Average loss: 0.0066, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   4,  Average loss: 0.0045, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   5,  Average loss: 0.0031, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   6,  Average loss: 0.0022, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   7,  Average loss: 0.0016, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   8,  Average loss: 0.0012, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   9,  Average loss: 0.0009, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch  10,  Average loss: 0.0009, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Global model norm: 14.355623404779179.
Norm before scaling: 14.408650427896442. Distance: 0.7141452566058629
Total norm for 7 adversaries is: 14.408650427896442. distance: 0.7141452566058629
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 2.3878, Accuracy: 2133/8991 (23.7237%)
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   1,  Average loss: 0.0068, Accuracy: 666/704 (94.6023%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   2,  Average loss: 0.0017, Accuracy: 681/704 (96.7330%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   3,  Average loss: 0.0012, Accuracy: 680/704 (96.5909%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   4,  Average loss: 0.0011, Accuracy: 684/704 (97.1591%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   5,  Average loss: 0.0010, Accuracy: 689/704 (97.8693%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   6,  Average loss: 0.0009, Accuracy: 692/704 (98.2955%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   7,  Average loss: 0.0008, Accuracy: 693/704 (98.4375%), train_poison_data_count: 704
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   8,  Average loss: 0.0008, Accuracy: 694/704 (98.5795%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   9,  Average loss: 0.0007, Accuracy: 694/704 (98.5795%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch  10,  Average loss: 0.0007, Accuracy: 694/704 (98.5795%), train_poison_data_count: 704
Global model norm: 14.355623404779179.
Norm before scaling: 14.57882469599664. Distance: 2.2308978788632947
Total norm for 7 adversaries is: 14.57882469599664. distance: 2.2308978788632947
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 2.9699, Accuracy: 2588/8991 (28.7843%)
___Train Local_Simple,  epoch   8, local model 96, internal_epoch   1,  Average loss: 0.0100, Accuracy: 414/505 (81.9802%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 5.3990, Accuracy: 2520/10000 (25.2000%), Attack Success Rate:3/10000(0.030)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0068, Accuracy: 599/648 (92.4383%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   2,  Average loss: 0.0026, Accuracy: 625/648 (96.4506%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   3,  Average loss: 0.0013, Accuracy: 636/648 (98.1481%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   4,  Average loss: 0.0008, Accuracy: 641/648 (98.9198%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   5,  Average loss: 0.0006, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   6,  Average loss: 0.0011, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   7,  Average loss: 0.0005, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   8,  Average loss: 0.0004, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   9,  Average loss: 0.0004, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch  10,  Average loss: 0.0004, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Global model norm: 14.355623404779179.
Norm before scaling: 14.772625655244907. Distance: 2.5650888716859725
Total norm for 7 adversaries is: 14.772625655244907. distance: 2.5650888716859725
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 2.5256, Accuracy: 4846/8991 (53.8983%)
___Train Local_Simple,  epoch   8, local model 92, internal_epoch   1,  Average loss: 0.0053, Accuracy: 198/202 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 12.9484, Accuracy: 1087/10000 (10.8700%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch   8, local model 86, internal_epoch   1,  Average loss: 0.0348, Accuracy: 28/34 (82.3529%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.3832, Accuracy: 6494/10000 (64.9400%), Attack Success Rate:0/10000(0.000)
time spent on training: 203.65864896774292
[foolsgold agg] training data poison_ratio: 0.9097222222222222  data num: [3022, 2803, 25, 263, 2, 704, 505, 648, 202, 34]
[foolsgold agg] considering poison per batch poison_fraction: 0.9097222222222222
[foolsgold agg] wv: [0.9360667  1.         0.04174122 0.81263281 0.04174122 1.
 1.         1.         0.81263281 0.9360667 ]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 1.2670, Accuracy: 7638/10000 (76.3800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 0.9311, Accuracy: 7592/8991 (84.4400%)
Done in 568.2730922698975 sec.
Server Epoch:9 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   1,  Average loss: 0.0092, Accuracy: 202/237 (85.2321%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   2,  Average loss: 0.0031, Accuracy: 224/237 (94.5148%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   3,  Average loss: 0.0017, Accuracy: 232/237 (97.8903%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   4,  Average loss: 0.0014, Accuracy: 233/237 (98.3122%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   5,  Average loss: 0.0012, Accuracy: 232/237 (97.8903%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   6,  Average loss: 0.0010, Accuracy: 232/237 (97.8903%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   7,  Average loss: 0.0008, Accuracy: 232/237 (97.8903%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   8,  Average loss: 0.0006, Accuracy: 233/237 (98.3122%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   9,  Average loss: 0.0006, Accuracy: 234/237 (98.7342%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch  10,  Average loss: 0.0005, Accuracy: 234/237 (98.7342%), train_poison_data_count: 237
Global model norm: 14.418144429639527.
Norm before scaling: 14.601297064869357. Distance: 1.3698562732540498
Total norm for 9 adversaries is: 14.601297064869357. distance: 1.3698562732540498
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 2.6551, Accuracy: 4345/8991 (48.3261%)
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   1,  Average loss: 0.0009, Accuracy: 2987/3022 (98.8418%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   2,  Average loss: 0.0001, Accuracy: 3016/3022 (99.8015%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   3,  Average loss: 0.0000, Accuracy: 3020/3022 (99.9338%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   4,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   5,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   6,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   7,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   8,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   9,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch  10,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Global model norm: 14.418144429639527.
Norm before scaling: 14.384054765403969. Distance: 2.3328322372061483
Total norm for 9 adversaries is: 14.384054765403969. distance: 2.3328322372061483
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 5.8882, Accuracy: 1912/8991 (21.2657%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   1,  Average loss: 0.0065, Accuracy: 583/644 (90.5280%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   2,  Average loss: 0.0022, Accuracy: 622/644 (96.5839%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   3,  Average loss: 0.0013, Accuracy: 626/644 (97.2050%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   4,  Average loss: 0.0010, Accuracy: 634/644 (98.4472%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   5,  Average loss: 0.0008, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   6,  Average loss: 0.0008, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   7,  Average loss: 0.0007, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   8,  Average loss: 0.0007, Accuracy: 635/644 (98.6025%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   9,  Average loss: 0.0006, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch  10,  Average loss: 0.0006, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Global model norm: 14.418144429639527.
Norm before scaling: 14.711173989070986. Distance: 2.1991076263485616
Total norm for 9 adversaries is: 14.711173989070986. distance: 2.1991076263485616
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 2.6447, Accuracy: 3853/8991 (42.8540%)
poison local model 71 index 70 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   1,  Average loss: 0.0125, Accuracy: 265/342 (77.4854%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   2,  Average loss: 0.0059, Accuracy: 303/342 (88.5965%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   3,  Average loss: 0.0029, Accuracy: 325/342 (95.0292%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   4,  Average loss: 0.0015, Accuracy: 333/342 (97.3684%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   5,  Average loss: 0.0015, Accuracy: 330/342 (96.4912%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   6,  Average loss: 0.0013, Accuracy: 334/342 (97.6608%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   7,  Average loss: 0.0010, Accuracy: 338/342 (98.8304%), train_poison_data_count: 342
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   8,  Average loss: 0.0009, Accuracy: 338/342 (98.8304%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   9,  Average loss: 0.0008, Accuracy: 339/342 (99.1228%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch  10,  Average loss: 0.0008, Accuracy: 339/342 (99.1228%), train_poison_data_count: 342
Global model norm: 14.418144429639527.
Norm before scaling: 14.780533045343534. Distance: 2.041222841978012
Total norm for 9 adversaries is: 14.780533045343534. distance: 2.041222841978012
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 3.0214, Accuracy: 5662/8991 (62.9741%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.3081, Accuracy: 1/5 (20.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   2,  Average loss: 0.1245, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   3,  Average loss: 0.0189, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   4,  Average loss: 0.0151, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   5,  Average loss: 0.0118, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   6,  Average loss: 0.0091, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   7,  Average loss: 0.0070, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   8,  Average loss: 0.0054, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   9,  Average loss: 0.0041, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch  10,  Average loss: 0.0040, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.418144429639527.
Norm before scaling: 14.46704724304919. Distance: 0.794260898382036
Total norm for 9 adversaries is: 14.46704724304919. distance: 0.794260898382036
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 1.3247, Accuracy: 4521/8991 (50.2836%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   1,  Average loss: 0.0163, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   2,  Average loss: 0.0038, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   3,  Average loss: 0.0002, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   4,  Average loss: 0.0002, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   8,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 14.418144429639527.
Norm before scaling: 14.456414321644994. Distance: 0.46146640497845187
Total norm for 9 adversaries is: 14.456414321644994. distance: 0.46146640497845187
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 1.4160, Accuracy: 4174/8991 (46.4242%)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   1,  Average loss: 0.0162, Accuracy: 76/87 (87.3563%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   2,  Average loss: 0.0060, Accuracy: 80/87 (91.9540%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   3,  Average loss: 0.0064, Accuracy: 79/87 (90.8046%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   4,  Average loss: 0.0031, Accuracy: 82/87 (94.2529%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   5,  Average loss: 0.0021, Accuracy: 84/87 (96.5517%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   6,  Average loss: 0.0029, Accuracy: 84/87 (96.5517%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   7,  Average loss: 0.0022, Accuracy: 84/87 (96.5517%), train_poison_data_count: 87
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   8,  Average loss: 0.0016, Accuracy: 84/87 (96.5517%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   9,  Average loss: 0.0016, Accuracy: 85/87 (97.7011%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch  10,  Average loss: 0.0010, Accuracy: 86/87 (98.8506%), train_poison_data_count: 87
Global model norm: 14.418144429639527.
Norm before scaling: 14.525543864535567. Distance: 0.8551680850843275
Total norm for 9 adversaries is: 14.525543864535567. distance: 0.8551680850843275
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 1.5966, Accuracy: 4204/8991 (46.7579%)
___Train Local_Simple,  epoch   9, local model 97, internal_epoch   1,  Average loss: 0.0824, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.7606, Accuracy: 5834/10000 (58.3400%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   1,  Average loss: 0.0041, Accuracy: 412/428 (96.2617%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   2,  Average loss: 0.0007, Accuracy: 423/428 (98.8318%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   3,  Average loss: 0.0005, Accuracy: 424/428 (99.0654%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   4,  Average loss: 0.0001, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   5,  Average loss: 0.0001, Accuracy: 427/428 (99.7664%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 14.418144429639527.
Norm before scaling: 14.678931800998306. Distance: 1.9463174208256095
Total norm for 9 adversaries is: 14.678931800998306. distance: 1.9463174208256095
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 14.4002, Accuracy: 2817/8991 (31.3313%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   1,  Average loss: 0.0106, Accuracy: 120/128 (93.7500%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   2,  Average loss: 0.0043, Accuracy: 122/128 (95.3125%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   3,  Average loss: 0.0031, Accuracy: 119/128 (92.9688%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   4,  Average loss: 0.0026, Accuracy: 120/128 (93.7500%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   5,  Average loss: 0.0024, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   6,  Average loss: 0.0022, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   7,  Average loss: 0.0021, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   8,  Average loss: 0.0021, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   9,  Average loss: 0.0020, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch  10,  Average loss: 0.0020, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Global model norm: 14.418144429639527.
Norm before scaling: 14.526523929038822. Distance: 0.8385294366422505
Total norm for 9 adversaries is: 14.526523929038822. distance: 0.8385294366422505
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 1.5720, Accuracy: 4473/8991 (49.7497%)
time spent on training: 181.37922191619873
[foolsgold agg] training data poison_ratio: 0.9989849776695088  data num: [237, 3022, 644, 342, 5, 28, 87, 5, 428, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.9989849776695088
[foolsgold agg] wv: [1.         0.56759263 1.         1.         1.         0.
 1.         0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 1.1254, Accuracy: 8190/10000 (81.9000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 0.6498, Accuracy: 8166/8991 (90.8242%)
Done in 568.7540061473846 sec.
Server Epoch:10 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0031, Accuracy: 620/648 (95.6790%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   2,  Average loss: 0.0012, Accuracy: 636/648 (98.1481%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   3,  Average loss: 0.0010, Accuracy: 635/648 (97.9938%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   4,  Average loss: 0.0008, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   5,  Average loss: 0.0005, Accuracy: 640/648 (98.7654%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   6,  Average loss: 0.0002, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   7,  Average loss: 0.0002, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   8,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   9,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch  10,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 14.476696888711084.
Norm before scaling: 14.684372589247515. Distance: 1.7488461505232737
Total norm for 9 adversaries is: 14.684372589247515. distance: 1.7488461505232737
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 4.1962, Accuracy: 4833/8991 (53.7538%)
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   1,  Average loss: 0.0039, Accuracy: 679/704 (96.4489%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   2,  Average loss: 0.0013, Accuracy: 687/704 (97.5852%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   3,  Average loss: 0.0008, Accuracy: 687/704 (97.5852%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   4,  Average loss: 0.0007, Accuracy: 691/704 (98.1534%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   5,  Average loss: 0.0005, Accuracy: 695/704 (98.7216%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   6,  Average loss: 0.0004, Accuracy: 698/704 (99.1477%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   7,  Average loss: 0.0004, Accuracy: 699/704 (99.2898%), train_poison_data_count: 704
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   8,  Average loss: 0.0003, Accuracy: 700/704 (99.4318%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   9,  Average loss: 0.0003, Accuracy: 700/704 (99.4318%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch  10,  Average loss: 0.0003, Accuracy: 700/704 (99.4318%), train_poison_data_count: 704
Global model norm: 14.476696888711084.
Norm before scaling: 14.625471580270924. Distance: 1.6364334331182622
Total norm for 9 adversaries is: 14.625471580270924. distance: 1.6364334331182622
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 2.4702, Accuracy: 3661/8991 (40.7185%)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   1,  Average loss: 0.0052, Accuracy: 226/244 (92.6230%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   2,  Average loss: 0.0036, Accuracy: 235/244 (96.3115%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   3,  Average loss: 0.0035, Accuracy: 236/244 (96.7213%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   4,  Average loss: 0.0030, Accuracy: 237/244 (97.1311%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   5,  Average loss: 0.0026, Accuracy: 237/244 (97.1311%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   6,  Average loss: 0.0021, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   7,  Average loss: 0.0017, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   8,  Average loss: 0.0016, Accuracy: 240/244 (98.3607%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   9,  Average loss: 0.0013, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch  10,  Average loss: 0.0013, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Global model norm: 14.476696888711084.
Norm before scaling: 14.593837304844584. Distance: 1.204301184870172
Total norm for 9 adversaries is: 14.593837304844584. distance: 1.204301184870172
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 6.1587, Accuracy: 1989/8991 (22.1221%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0115, Accuracy: 79/84 (94.0476%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   2,  Average loss: 0.0023, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   3,  Average loss: 0.0045, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   4,  Average loss: 0.0061, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   5,  Average loss: 0.0030, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   6,  Average loss: 0.0028, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   7,  Average loss: 0.0032, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   8,  Average loss: 0.0015, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   9,  Average loss: 0.0013, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch  10,  Average loss: 0.0013, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Global model norm: 14.476696888711084.
Norm before scaling: 14.543313415033406. Distance: 0.7522820484057466
Total norm for 9 adversaries is: 14.543313415033406. distance: 0.7522820484057466
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 2.3480, Accuracy: 3020/8991 (33.5891%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.1587, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   2,  Average loss: 0.0343, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   3,  Average loss: 0.0053, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   4,  Average loss: 0.0047, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   5,  Average loss: 0.0041, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   6,  Average loss: 0.0035, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   7,  Average loss: 0.0030, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   8,  Average loss: 0.0025, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   9,  Average loss: 0.0021, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch  10,  Average loss: 0.0020, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.476696888711084.
Norm before scaling: 14.520003103040464. Distance: 0.6193015433980422
Total norm for 9 adversaries is: 14.520003103040464. distance: 0.6193015433980422
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 1.2446, Accuracy: 4904/8991 (54.5434%)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2181/2324 (93.8468%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   2,  Average loss: 0.0009, Accuracy: 2285/2324 (98.3219%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   3,  Average loss: 0.0003, Accuracy: 2307/2324 (99.2685%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   4,  Average loss: 0.0003, Accuracy: 2309/2324 (99.3546%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   5,  Average loss: 0.0003, Accuracy: 2312/2324 (99.4836%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   6,  Average loss: 0.0002, Accuracy: 2315/2324 (99.6127%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   7,  Average loss: 0.0002, Accuracy: 2315/2324 (99.6127%), train_poison_data_count: 2324
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   8,  Average loss: 0.0002, Accuracy: 2316/2324 (99.6558%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   9,  Average loss: 0.0002, Accuracy: 2319/2324 (99.7849%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch  10,  Average loss: 0.0002, Accuracy: 2319/2324 (99.7849%), train_poison_data_count: 2324
Global model norm: 14.476696888711084.
Norm before scaling: 15.477892460839003. Distance: 4.544057910671059
Total norm for 9 adversaries is: 15.477892460839003. distance: 4.544057910671059
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 2.2825, Accuracy: 5788/8991 (64.3755%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   1,  Average loss: 0.0046, Accuracy: 184/196 (93.8776%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   2,  Average loss: 0.0035, Accuracy: 185/196 (94.3878%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   3,  Average loss: 0.0015, Accuracy: 187/196 (95.4082%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   4,  Average loss: 0.0012, Accuracy: 193/196 (98.4694%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   5,  Average loss: 0.0009, Accuracy: 193/196 (98.4694%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   6,  Average loss: 0.0006, Accuracy: 194/196 (98.9796%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   7,  Average loss: 0.0006, Accuracy: 194/196 (98.9796%), train_poison_data_count: 196
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   8,  Average loss: 0.0005, Accuracy: 194/196 (98.9796%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   9,  Average loss: 0.0005, Accuracy: 194/196 (98.9796%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch  10,  Average loss: 0.0005, Accuracy: 194/196 (98.9796%), train_poison_data_count: 196
Global model norm: 14.476696888711084.
Norm before scaling: 14.573149229552165. Distance: 1.138018569536671
Total norm for 9 adversaries is: 14.573149229552165. distance: 1.138018569536671
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 2.1453, Accuracy: 4216/8991 (46.8913%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   1,  Average loss: 0.0053, Accuracy: 1090/1203 (90.6068%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   2,  Average loss: 0.0022, Accuracy: 1148/1203 (95.4281%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   3,  Average loss: 0.0010, Accuracy: 1178/1203 (97.9219%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   4,  Average loss: 0.0008, Accuracy: 1183/1203 (98.3375%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   5,  Average loss: 0.0007, Accuracy: 1187/1203 (98.6700%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   6,  Average loss: 0.0006, Accuracy: 1190/1203 (98.9194%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   7,  Average loss: 0.0006, Accuracy: 1192/1203 (99.0856%), train_poison_data_count: 1203
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   8,  Average loss: 0.0005, Accuracy: 1192/1203 (99.0856%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   9,  Average loss: 0.0005, Accuracy: 1192/1203 (99.0856%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch  10,  Average loss: 0.0005, Accuracy: 1192/1203 (99.0856%), train_poison_data_count: 1203
Global model norm: 14.476696888711084.
Norm before scaling: 15.002720395404806. Distance: 2.8041172988725314
Total norm for 9 adversaries is: 15.002720395404806. distance: 2.8041172988725314
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 2.3033, Accuracy: 5581/8991 (62.0732%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0249, Accuracy: 45/48 (93.7500%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   2,  Average loss: 0.0042, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   5,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   6,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   7,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   8,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   9,  Average loss: 0.0003, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch  10,  Average loss: 0.0003, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 14.476696888711084.
Norm before scaling: 14.528522719537227. Distance: 0.7360598938196089
Total norm for 9 adversaries is: 14.528522719537227. distance: 0.7360598938196089
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 3.3013, Accuracy: 2758/8991 (30.6751%)
___Train Local_Simple,  epoch  10, local model 99, internal_epoch   1,  Average loss: 0.0022, Accuracy: 401/411 (97.5669%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 5.7095, Accuracy: 2638/10000 (26.3800%), Attack Success Rate:1/10000(0.010)
time spent on training: 191.98737788200378
[foolsgold agg] training data poison_ratio: 0.9299471620930629  data num: [648, 704, 244, 84, 5, 2324, 196, 1203, 48, 411]
[foolsgold agg] considering poison per batch poison_fraction: 0.9299471620930629
[foolsgold agg] wv: [0.2146241  0.69429038 1.         1.         1.         0.6556173
 1.         0.6556173  0.2146241  1.        ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 1.0847, Accuracy: 8129/10000 (81.2900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 0.5549, Accuracy: 8104/8991 (90.1346%)
Done in 569.2409353256226 sec.
Server Epoch:11 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
poison local model 53 index 52 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   1,  Average loss: 0.0040, Accuracy: 436/456 (95.6140%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   2,  Average loss: 0.0020, Accuracy: 442/456 (96.9298%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   3,  Average loss: 0.0009, Accuracy: 447/456 (98.0263%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   4,  Average loss: 0.0010, Accuracy: 452/456 (99.1228%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   5,  Average loss: 0.0003, Accuracy: 454/456 (99.5614%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   6,  Average loss: 0.0003, Accuracy: 452/456 (99.1228%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   7,  Average loss: 0.0003, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   8,  Average loss: 0.0002, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   9,  Average loss: 0.0003, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch  10,  Average loss: 0.0002, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Global model norm: 14.52295997987836.
Norm before scaling: 14.707459738113927. Distance: 1.4532169600070641
Total norm for 8 adversaries is: 14.707459738113927. distance: 1.4532169600070641
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 1.4016, Accuracy: 5447/8991 (60.5828%)
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   1,  Average loss: 0.0041, Accuracy: 676/704 (96.0227%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   2,  Average loss: 0.0013, Accuracy: 693/704 (98.4375%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   3,  Average loss: 0.0007, Accuracy: 691/704 (98.1534%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   4,  Average loss: 0.0006, Accuracy: 693/704 (98.4375%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   5,  Average loss: 0.0005, Accuracy: 696/704 (98.8636%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   6,  Average loss: 0.0004, Accuracy: 697/704 (99.0057%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   7,  Average loss: 0.0004, Accuracy: 700/704 (99.4318%), train_poison_data_count: 704
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   8,  Average loss: 0.0004, Accuracy: 700/704 (99.4318%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   9,  Average loss: 0.0003, Accuracy: 700/704 (99.4318%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch  10,  Average loss: 0.0003, Accuracy: 700/704 (99.4318%), train_poison_data_count: 704
Global model norm: 14.52295997987836.
Norm before scaling: 14.685245941565222. Distance: 1.7702576617832142
Total norm for 8 adversaries is: 14.685245941565222. distance: 1.7702576617832142
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 2.5495, Accuracy: 3490/8991 (38.8166%)
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0038, Accuracy: 254/259 (98.0695%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0012, Accuracy: 252/259 (97.2973%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0014, Accuracy: 251/259 (96.9112%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0008, Accuracy: 255/259 (98.4556%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0007, Accuracy: 256/259 (98.8417%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0006, Accuracy: 256/259 (98.8417%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0024, Accuracy: 256/259 (98.8417%), train_poison_data_count: 259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0003, Accuracy: 257/259 (99.2278%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0004, Accuracy: 257/259 (99.2278%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0050, Accuracy: 257/259 (99.2278%), train_poison_data_count: 259
Global model norm: 14.52295997987836.
Norm before scaling: 14.678826810851362. Distance: 1.3573362035268204
Total norm for 8 adversaries is: 14.678826810851362. distance: 1.3573362035268204
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 2.6178, Accuracy: 4194/8991 (46.6466%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0126, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   2,  Average loss: 0.0020, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 14.52295997987836.
Norm before scaling: 14.567194497142479. Distance: 0.541765842772929
Total norm for 8 adversaries is: 14.567194497142479. distance: 0.541765842772929
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 2.3113, Accuracy: 3773/8991 (41.9642%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   1,  Average loss: 0.0054, Accuracy: 283/304 (93.0921%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   2,  Average loss: 0.0069, Accuracy: 291/304 (95.7237%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   3,  Average loss: 0.0026, Accuracy: 287/304 (94.4079%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   4,  Average loss: 0.0009, Accuracy: 298/304 (98.0263%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   5,  Average loss: 0.0008, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   6,  Average loss: 0.0008, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   7,  Average loss: 0.0008, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   8,  Average loss: 0.0007, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   9,  Average loss: 0.0006, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch  10,  Average loss: 0.0006, Accuracy: 299/304 (98.3553%), train_poison_data_count: 304
Global model norm: 14.52295997987836.
Norm before scaling: 14.650807100007857. Distance: 1.7679662794634472
Total norm for 8 adversaries is: 14.650807100007857. distance: 1.7679662794634472
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 3.6831, Accuracy: 2409/8991 (26.7935%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 1881/1982 (94.9041%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   2,  Average loss: 0.0012, Accuracy: 1935/1982 (97.6287%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1954/1982 (98.5873%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   4,  Average loss: 0.0005, Accuracy: 1963/1982 (99.0414%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1965/1982 (99.1423%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1968/1982 (99.2936%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1968/1982 (99.2936%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1968/1982 (99.2936%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1968/1982 (99.2936%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1968/1982 (99.2936%), train_poison_data_count: 1982
Global model norm: 14.52295997987836.
Norm before scaling: 14.812938313497838. Distance: 2.9158537322147864
Total norm for 8 adversaries is: 14.812938313497838. distance: 2.9158537322147864
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 4.3690, Accuracy: 2848/8991 (31.6761%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0033, Accuracy: 295/310 (95.1613%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   2,  Average loss: 0.0022, Accuracy: 296/310 (95.4839%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   3,  Average loss: 0.0008, Accuracy: 305/310 (98.3871%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   4,  Average loss: 0.0005, Accuracy: 308/310 (99.3548%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   5,  Average loss: 0.0004, Accuracy: 308/310 (99.3548%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   6,  Average loss: 0.0003, Accuracy: 308/310 (99.3548%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   7,  Average loss: 0.0003, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   8,  Average loss: 0.0003, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   9,  Average loss: 0.0003, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch  10,  Average loss: 0.0003, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Global model norm: 14.52295997987836.
Norm before scaling: 14.632329685374247. Distance: 0.9793414135829615
Total norm for 8 adversaries is: 14.632329685374247. distance: 0.9793414135829615
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 2.1685, Accuracy: 3898/8991 (43.3545%)
___Train Local_Simple,  epoch  11, local model 99, internal_epoch   1,  Average loss: 0.0014, Accuracy: 407/411 (99.0268%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 9.1552, Accuracy: 2190/10000 (21.9000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  11, local model 88, internal_epoch   1,  Average loss: 0.0202, Accuracy: 74/96 (77.0833%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 3.3582, Accuracy: 1949/10000 (19.4900%), Attack Success Rate:19/10000(0.190)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0039, Accuracy: 550/578 (95.1557%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   2,  Average loss: 0.0018, Accuracy: 555/578 (96.0208%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   3,  Average loss: 0.0019, Accuracy: 553/578 (95.6747%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   4,  Average loss: 0.0006, Accuracy: 571/578 (98.7889%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   5,  Average loss: 0.0005, Accuracy: 570/578 (98.6159%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   6,  Average loss: 0.0003, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   7,  Average loss: 0.0003, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   8,  Average loss: 0.0003, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   9,  Average loss: 0.0003, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch  10,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Global model norm: 14.52295997987836.
Norm before scaling: 14.75291077939685. Distance: 1.666853735280002
Total norm for 8 adversaries is: 14.75291077939685. distance: 1.666853735280002
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 2.0814, Accuracy: 4892/8991 (54.4100%)
time spent on training: 174.88627290725708
[foolsgold agg] training data poison_ratio: 0.9015151515151515  data num: [456, 704, 259, 48, 304, 1982, 310, 411, 96, 578]
[foolsgold agg] considering poison per batch poison_fraction: 0.9015151515151515
[foolsgold agg] wv: [1.         0.48811486 1.         0.48811486 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 1.0406, Accuracy: 8170/10000 (81.7000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 0.4727, Accuracy: 8146/8991 (90.6017%)
Done in 574.1390900611877 sec.
Server Epoch:12 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0039, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   2,  Average loss: 0.0018, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   3,  Average loss: 0.0008, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   4,  Average loss: 0.0008, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   5,  Average loss: 0.0007, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   6,  Average loss: 0.0007, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   7,  Average loss: 0.0007, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   8,  Average loss: 0.0007, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   9,  Average loss: 0.0007, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch  10,  Average loss: 0.0006, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Global model norm: 14.570860202507456.
Norm before scaling: 14.59234364041369. Distance: 0.29189754470489776
Total norm for 10 adversaries is: 14.59234364041369. distance: 0.29189754470489776
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.8716, Accuracy: 6327/8991 (70.3704%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   1,  Average loss: 0.0049, Accuracy: 91/94 (96.8085%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   2,  Average loss: 0.0013, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   3,  Average loss: 0.0029, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   4,  Average loss: 0.0021, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   5,  Average loss: 0.0011, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   6,  Average loss: 0.0013, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   7,  Average loss: 0.0007, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   8,  Average loss: 0.0005, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   9,  Average loss: 0.0007, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch  10,  Average loss: 0.0007, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Global model norm: 14.570860202507456.
Norm before scaling: 14.620087148925874. Distance: 0.5131546723757535
Total norm for 10 adversaries is: 14.620087148925874. distance: 0.5131546723757535
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.2992, Accuracy: 5697/8991 (63.3634%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0070, Accuracy: 107/119 (89.9160%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   2,  Average loss: 0.0035, Accuracy: 109/119 (91.5966%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   3,  Average loss: 0.0020, Accuracy: 112/119 (94.1176%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   4,  Average loss: 0.0019, Accuracy: 113/119 (94.9580%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   5,  Average loss: 0.0018, Accuracy: 114/119 (95.7983%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   6,  Average loss: 0.0016, Accuracy: 115/119 (96.6387%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   7,  Average loss: 0.0014, Accuracy: 116/119 (97.4790%), train_poison_data_count: 119
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   8,  Average loss: 0.0012, Accuracy: 117/119 (98.3193%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   9,  Average loss: 0.0011, Accuracy: 117/119 (98.3193%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch  10,  Average loss: 0.0011, Accuracy: 117/119 (98.3193%), train_poison_data_count: 119
Global model norm: 14.570860202507456.
Norm before scaling: 14.628337251117157. Distance: 0.6765078348536419
Total norm for 10 adversaries is: 14.628337251117157. distance: 0.6765078348536419
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.8706, Accuracy: 3690/8991 (41.0410%)
poison local model 64 index 63 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0059, Accuracy: 198/216 (91.6667%), train_poison_data_count: 216
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   2,  Average loss: 0.0054, Accuracy: 196/216 (90.7407%), train_poison_data_count: 216
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   3,  Average loss: 0.0028, Accuracy: 207/216 (95.8333%), train_poison_data_count: 216
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   4,  Average loss: 0.0014, Accuracy: 211/216 (97.6852%), train_poison_data_count: 216
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   5,  Average loss: 0.0012, Accuracy: 214/216 (99.0741%), train_poison_data_count: 216
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   6,  Average loss: 0.0011, Accuracy: 213/216 (98.6111%), train_poison_data_count: 216
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   7,  Average loss: 0.0008, Accuracy: 213/216 (98.6111%), train_poison_data_count: 216
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   8,  Average loss: 0.0006, Accuracy: 213/216 (98.6111%), train_poison_data_count: 216
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   9,  Average loss: 0.0006, Accuracy: 215/216 (99.5370%), train_poison_data_count: 216
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch  10,  Average loss: 0.0006, Accuracy: 215/216 (99.5370%), train_poison_data_count: 216
Global model norm: 14.570860202507456.
Norm before scaling: 14.68383795354261. Distance: 1.056547319449287
Total norm for 10 adversaries is: 14.68383795354261. distance: 1.056547319449287
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.9607, Accuracy: 4974/8991 (55.3220%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0033, Accuracy: 1871/1982 (94.3996%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   2,  Average loss: 0.0011, Accuracy: 1940/1982 (97.8809%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1957/1982 (98.7386%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1961/1982 (98.9405%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1964/1982 (99.0918%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1967/1982 (99.2432%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1969/1982 (99.3441%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1969/1982 (99.3441%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1969/1982 (99.3441%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1969/1982 (99.3441%), train_poison_data_count: 1982
Global model norm: 14.570860202507456.
Norm before scaling: 14.966815608472224. Distance: 3.231938425657836
Total norm for 10 adversaries is: 14.966815608472224. distance: 3.231938425657836
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 4.3732, Accuracy: 2844/8991 (31.6316%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   1,  Average loss: 0.0035, Accuracy: 177/179 (98.8827%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   2,  Average loss: 0.0007, Accuracy: 176/179 (98.3240%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   3,  Average loss: 0.0006, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   4,  Average loss: 0.0005, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   5,  Average loss: 0.0004, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   6,  Average loss: 0.0003, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   7,  Average loss: 0.0002, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   8,  Average loss: 0.0001, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Global model norm: 14.570860202507456.
Norm before scaling: 14.67423509622153. Distance: 0.9848236393740053
Total norm for 10 adversaries is: 14.67423509622153. distance: 0.9848236393740053
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 3.9935, Accuracy: 3217/8991 (35.7802%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0027, Accuracy: 551/578 (95.3287%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   2,  Average loss: 0.0016, Accuracy: 560/578 (96.8858%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   3,  Average loss: 0.0004, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   4,  Average loss: 0.0003, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   5,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   6,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   7,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   8,  Average loss: 0.0002, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   9,  Average loss: 0.0002, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 14.570860202507456.
Norm before scaling: 14.750376551072772. Distance: 1.4080804144399417
Total norm for 10 adversaries is: 14.750376551072772. distance: 1.4080804144399417
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 2.1050, Accuracy: 5351/8991 (59.5151%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   1,  Average loss: 0.0146, Accuracy: 40/47 (85.1064%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   2,  Average loss: 0.0032, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   3,  Average loss: 0.0016, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   4,  Average loss: 0.0018, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   5,  Average loss: 0.0018, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   6,  Average loss: 0.0019, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   7,  Average loss: 0.0019, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   8,  Average loss: 0.0019, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   9,  Average loss: 0.0018, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch  10,  Average loss: 0.0018, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Global model norm: 14.570860202507456.
Norm before scaling: 14.601874954856504. Distance: 0.5347050344779134
Total norm for 10 adversaries is: 14.601874954856504. distance: 0.5347050344779134
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.6031, Accuracy: 3369/8991 (37.4708%)
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0022, Accuracy: 1479/1544 (95.7902%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1528/1544 (98.9637%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1536/1544 (99.4819%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1541/1544 (99.8057%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1541/1544 (99.8057%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Global model norm: 14.570860202507456.
Norm before scaling: 14.79918990108971. Distance: 2.2404304026184456
Total norm for 10 adversaries is: 14.79918990108971. distance: 2.2404304026184456
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.4262, Accuracy: 5607/8991 (62.3624%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 436/463 (94.1685%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   2,  Average loss: 0.0024, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   3,  Average loss: 0.0016, Accuracy: 457/463 (98.7041%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   4,  Average loss: 0.0010, Accuracy: 457/463 (98.7041%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   5,  Average loss: 0.0008, Accuracy: 457/463 (98.7041%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   6,  Average loss: 0.0010, Accuracy: 457/463 (98.7041%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   7,  Average loss: 0.0007, Accuracy: 457/463 (98.7041%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   8,  Average loss: 0.0008, Accuracy: 458/463 (98.9201%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   9,  Average loss: 0.0009, Accuracy: 458/463 (98.9201%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch  10,  Average loss: 0.0007, Accuracy: 458/463 (98.9201%), train_poison_data_count: 463
Global model norm: 14.570860202507456.
Norm before scaling: 14.690754501463347. Distance: 1.91235300134939
Total norm for 10 adversaries is: 14.690754501463347. distance: 1.91235300134939
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 2.4129, Accuracy: 2903/8991 (32.2878%)
time spent on training: 205.9715621471405
[foolsgold agg] training data poison_ratio: 1.0  data num: [63, 94, 119, 216, 1982, 179, 578, 47, 1544, 463]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [1.         1.         1.         1.         0.67894569 1.
 1.         1.         1.         0.67894569]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.1569, Accuracy: 8159/10000 (81.5900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 0.3525, Accuracy: 8131/8991 (90.4349%)
Done in 602.5114607810974 sec.
Server Epoch:13 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0858, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   2,  Average loss: 0.0125, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   3,  Average loss: 0.0017, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   4,  Average loss: 0.0014, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   5,  Average loss: 0.0012, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   6,  Average loss: 0.0010, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   7,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   8,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   9,  Average loss: 0.0006, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch  10,  Average loss: 0.0006, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.633240554503864.
Norm before scaling: 14.659368837933048. Distance: 0.5207102884542476
Total norm for 9 adversaries is: 14.659368837933048. distance: 0.5207102884542476
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.5291, Accuracy: 7100/8991 (78.9679%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   1,  Average loss: 0.0021, Accuracy: 177/179 (98.8827%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   2,  Average loss: 0.0004, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   3,  Average loss: 0.0006, Accuracy: 177/179 (98.8827%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   4,  Average loss: 0.0006, Accuracy: 177/179 (98.8827%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   5,  Average loss: 0.0004, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   6,  Average loss: 0.0002, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   7,  Average loss: 0.0001, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Global model norm: 14.633240554503864.
Norm before scaling: 14.703714454177897. Distance: 0.7607310224504612
Total norm for 9 adversaries is: 14.703714454177897. distance: 0.7607310224504612
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 3.0413, Accuracy: 3859/8991 (42.9207%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0013, Accuracy: 691/705 (98.0142%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   2,  Average loss: 0.0003, Accuracy: 701/705 (99.4326%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   3,  Average loss: 0.0001, Accuracy: 703/705 (99.7163%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   4,  Average loss: 0.0001, Accuracy: 703/705 (99.7163%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   5,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   6,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   7,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   8,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   9,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch  10,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Global model norm: 14.633240554503864.
Norm before scaling: 14.703085044944384. Distance: 1.6871108560098558
Total norm for 9 adversaries is: 14.703085044944384. distance: 1.6871108560098558
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 5.4510, Accuracy: 2357/8991 (26.2151%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0025, Accuracy: 654/688 (95.0581%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   2,  Average loss: 0.0008, Accuracy: 675/688 (98.1105%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   3,  Average loss: 0.0003, Accuracy: 684/688 (99.4186%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   5,  Average loss: 0.0002, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   6,  Average loss: 0.0002, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   7,  Average loss: 0.0002, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 14.633240554503864.
Norm before scaling: 14.761146600945652. Distance: 1.4736698618706594
Total norm for 9 adversaries is: 14.761146600945652. distance: 1.4736698618706594
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 3.8314, Accuracy: 3268/8991 (36.3475%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0050, Accuracy: 79/84 (94.0476%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   2,  Average loss: 0.0020, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   4,  Average loss: 0.0021, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   7,  Average loss: 0.0008, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   8,  Average loss: 0.0008, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   9,  Average loss: 0.0009, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch  10,  Average loss: 0.0014, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Global model norm: 14.633240554503864.
Norm before scaling: 14.661391147529601. Distance: 0.49219101193098497
Total norm for 9 adversaries is: 14.661391147529601. distance: 0.49219101193098497
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.0228, Accuracy: 5963/8991 (66.3219%)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   1,  Average loss: 0.0066, Accuracy: 79/87 (90.8046%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   2,  Average loss: 0.0019, Accuracy: 84/87 (96.5517%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   3,  Average loss: 0.0023, Accuracy: 83/87 (95.4023%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   4,  Average loss: 0.0021, Accuracy: 84/87 (96.5517%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   5,  Average loss: 0.0014, Accuracy: 86/87 (98.8506%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   6,  Average loss: 0.0006, Accuracy: 86/87 (98.8506%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   7,  Average loss: 0.0004, Accuracy: 87/87 (100.0000%), train_poison_data_count: 87
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   8,  Average loss: 0.0005, Accuracy: 87/87 (100.0000%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   9,  Average loss: 0.0004, Accuracy: 87/87 (100.0000%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch  10,  Average loss: 0.0005, Accuracy: 87/87 (100.0000%), train_poison_data_count: 87
Global model norm: 14.633240554503864.
Norm before scaling: 14.676459655433872. Distance: 0.5541359483001731
Total norm for 9 adversaries is: 14.676459655433872. distance: 0.5541359483001731
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.8376, Accuracy: 6369/8991 (70.8375%)
___Train Local_Simple,  epoch  13, local model 97, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.2275, Accuracy: 8059/10000 (80.5900%), Attack Success Rate:0/10000(0.000)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0029, Accuracy: 81/86 (94.1860%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   2,  Average loss: 0.0010, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   3,  Average loss: 0.0004, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   4,  Average loss: 0.0004, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   5,  Average loss: 0.0003, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   6,  Average loss: 0.0005, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   7,  Average loss: 0.0004, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   8,  Average loss: 0.0002, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   9,  Average loss: 0.0002, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch  10,  Average loss: 0.0002, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Global model norm: 14.633240554503864.
Norm before scaling: 14.655804397543742. Distance: 0.41045102017624735
Total norm for 9 adversaries is: 14.655804397543742. distance: 0.41045102017624735
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.3785, Accuracy: 4936/8991 (54.8993%)
poison local model 70 index 69 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   1,  Average loss: 0.0041, Accuracy: 528/569 (92.7944%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   2,  Average loss: 0.0016, Accuracy: 551/569 (96.8366%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   3,  Average loss: 0.0006, Accuracy: 563/569 (98.9455%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   4,  Average loss: 0.0004, Accuracy: 566/569 (99.4728%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   5,  Average loss: 0.0004, Accuracy: 566/569 (99.4728%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   6,  Average loss: 0.0003, Accuracy: 567/569 (99.6485%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   7,  Average loss: 0.0003, Accuracy: 567/569 (99.6485%), train_poison_data_count: 569
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   8,  Average loss: 0.0003, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   9,  Average loss: 0.0002, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch  10,  Average loss: 0.0002, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Global model norm: 14.633240554503864.
Norm before scaling: 14.902206544256972. Distance: 1.6934694036620581
Total norm for 9 adversaries is: 14.902206544256972. distance: 1.6934694036620581
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.7182, Accuracy: 6592/8991 (73.3178%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0071, Accuracy: 47/48 (97.9167%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   2,  Average loss: 0.0011, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   5,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   6,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 14.633240554503864.
Norm before scaling: 14.662890786299183. Distance: 0.4300252454022593
Total norm for 9 adversaries is: 14.662890786299183. distance: 0.4300252454022593
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.2725, Accuracy: 5594/8991 (62.2178%)
time spent on training: 150.0576469898224
[foolsgold agg] training data poison_ratio: 0.9979641693811075  data num: [5, 179, 705, 688, 84, 87, 5, 86, 569, 48]
[foolsgold agg] considering poison per batch poison_fraction: 0.9979641693811075
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.3644, Accuracy: 8064/10000 (80.6400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 0.3478, Accuracy: 8035/8991 (89.3671%)
Done in 535.7187592983246 sec.
Server Epoch:14 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0065, Accuracy: 29/29 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.3623, Accuracy: 7727/10000 (77.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 97, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.3889, Accuracy: 8017/10000 (80.1700%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 631/648 (97.3765%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   2,  Average loss: 0.0008, Accuracy: 639/648 (98.6111%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   3,  Average loss: 0.0006, Accuracy: 638/648 (98.4568%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   4,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   5,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   6,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   8,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   9,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch  10,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 14.672288915221058.
Norm before scaling: 14.729949772082929. Distance: 1.1638953581766516
Total norm for 7 adversaries is: 14.729949772082929. distance: 1.1638953581766516
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 2.5577, Accuracy: 5220/8991 (58.0581%)
___Train Local_Simple,  epoch  14, local model 89, internal_epoch   1,  Average loss: 0.0710, Accuracy: 33/69 (47.8261%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.4802, Accuracy: 6850/10000 (68.5000%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 122/128 (95.3125%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   2,  Average loss: 0.0019, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   3,  Average loss: 0.0016, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   4,  Average loss: 0.0015, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   5,  Average loss: 0.0014, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   6,  Average loss: 0.0012, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   7,  Average loss: 0.0012, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   8,  Average loss: 0.0011, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   9,  Average loss: 0.0010, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch  10,  Average loss: 0.0010, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Global model norm: 14.672288915221058.
Norm before scaling: 14.697359971665618. Distance: 0.41832785465381495
Total norm for 7 adversaries is: 14.697359971665618. distance: 0.41832785465381495
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.5713, Accuracy: 7346/8991 (81.7039%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   1,  Average loss: 0.0034, Accuracy: 1118/1203 (92.9343%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   2,  Average loss: 0.0016, Accuracy: 1164/1203 (96.7581%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   3,  Average loss: 0.0010, Accuracy: 1179/1203 (98.0050%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   4,  Average loss: 0.0006, Accuracy: 1192/1203 (99.0856%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   5,  Average loss: 0.0005, Accuracy: 1192/1203 (99.0856%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1195/1203 (99.3350%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   7,  Average loss: 0.0004, Accuracy: 1197/1203 (99.5012%), train_poison_data_count: 1203
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1197/1203 (99.5012%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1201/1203 (99.8337%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch  10,  Average loss: 0.0003, Accuracy: 1201/1203 (99.8337%), train_poison_data_count: 1203
Global model norm: 14.672288915221058.
Norm before scaling: 14.993669827220263. Distance: 2.184110795225442
Total norm for 7 adversaries is: 14.993669827220263. distance: 2.184110795225442
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 2.0438, Accuracy: 6198/8991 (68.9356%)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2665/2803 (95.0767%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   2,  Average loss: 0.0009, Accuracy: 2745/2803 (97.9308%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   3,  Average loss: 0.0004, Accuracy: 2786/2803 (99.3935%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   4,  Average loss: 0.0003, Accuracy: 2790/2803 (99.5362%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   5,  Average loss: 0.0002, Accuracy: 2792/2803 (99.6076%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   6,  Average loss: 0.0002, Accuracy: 2794/2803 (99.6789%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   7,  Average loss: 0.0002, Accuracy: 2794/2803 (99.6789%), train_poison_data_count: 2803
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   8,  Average loss: 0.0002, Accuracy: 2797/2803 (99.7859%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   9,  Average loss: 0.0002, Accuracy: 2800/2803 (99.8930%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch  10,  Average loss: 0.0002, Accuracy: 2800/2803 (99.8930%), train_poison_data_count: 2803
Global model norm: 14.672288915221058.
Norm before scaling: 15.073604305305672. Distance: 3.2056093583494234
Total norm for 7 adversaries is: 15.073604305305672. distance: 3.2056093583494234
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 3.0802, Accuracy: 4825/8991 (53.6648%)
poison local model 67 index 66 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   1,  Average loss: 0.0021, Accuracy: 550/568 (96.8310%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   2,  Average loss: 0.0009, Accuracy: 560/568 (98.5915%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   3,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   4,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   5,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   6,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   7,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   8,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   9,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch  10,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Global model norm: 14.672288915221058.
Norm before scaling: 14.771445508716884. Distance: 1.04860822762829
Total norm for 7 adversaries is: 14.771445508716884. distance: 1.04860822762829
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.1179, Accuracy: 6286/8991 (69.9144%)
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0022, Accuracy: 680/704 (96.5909%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   2,  Average loss: 0.0006, Accuracy: 700/704 (99.4318%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   3,  Average loss: 0.0004, Accuracy: 696/704 (98.8636%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   4,  Average loss: 0.0003, Accuracy: 699/704 (99.2898%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   5,  Average loss: 0.0002, Accuracy: 701/704 (99.5739%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   6,  Average loss: 0.0002, Accuracy: 701/704 (99.5739%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   7,  Average loss: 0.0002, Accuracy: 701/704 (99.5739%), train_poison_data_count: 704
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   8,  Average loss: 0.0002, Accuracy: 701/704 (99.5739%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   9,  Average loss: 0.0002, Accuracy: 702/704 (99.7159%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch  10,  Average loss: 0.0002, Accuracy: 702/704 (99.7159%), train_poison_data_count: 704
Global model norm: 14.672288915221058.
Norm before scaling: 14.750002586235208. Distance: 1.4447685249013609
Total norm for 7 adversaries is: 14.750002586235208. distance: 1.4447685249013609
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 2.5214, Accuracy: 4139/8991 (46.0349%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 105/119 (88.2353%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   2,  Average loss: 0.0026, Accuracy: 111/119 (93.2773%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   3,  Average loss: 0.0021, Accuracy: 111/119 (93.2773%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   4,  Average loss: 0.0020, Accuracy: 113/119 (94.9580%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   5,  Average loss: 0.0018, Accuracy: 116/119 (97.4790%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   6,  Average loss: 0.0016, Accuracy: 117/119 (98.3193%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   7,  Average loss: 0.0014, Accuracy: 117/119 (98.3193%), train_poison_data_count: 119
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   8,  Average loss: 0.0011, Accuracy: 117/119 (98.3193%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   9,  Average loss: 0.0010, Accuracy: 117/119 (98.3193%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch  10,  Average loss: 0.0010, Accuracy: 118/119 (99.1597%), train_poison_data_count: 119
Global model norm: 14.672288915221058.
Norm before scaling: 14.707401120017028. Distance: 0.8075861158009772
Total norm for 7 adversaries is: 14.707401120017028. distance: 0.8075861158009772
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 2.5392, Accuracy: 3132/8991 (34.8348%)
time spent on training: 197.18485403060913
[foolsgold agg] training data poison_ratio: 0.9835882727852135  data num: [29, 5, 648, 69, 128, 1203, 2803, 568, 704, 119]
[foolsgold agg] considering poison per batch poison_fraction: 0.9835882727852135
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.2043, Accuracy: 8213/10000 (82.1300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.2752, Accuracy: 8200/8991 (91.2023%)
Done in 614.5139052867889 sec.
Server Epoch:15 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0047, Accuracy: 437/463 (94.3844%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   2,  Average loss: 0.0024, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   3,  Average loss: 0.0024, Accuracy: 454/463 (98.0562%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   4,  Average loss: 0.0013, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   5,  Average loss: 0.0013, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   6,  Average loss: 0.0023, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   7,  Average loss: 0.0011, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   8,  Average loss: 0.0011, Accuracy: 456/463 (98.4881%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   9,  Average loss: 0.0014, Accuracy: 456/463 (98.4881%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch  10,  Average loss: 0.0010, Accuracy: 456/463 (98.4881%), train_poison_data_count: 463
Global model norm: 14.727376883980817.
Norm before scaling: 14.90614251631846. Distance: 3.0315471385554424
Total norm for 8 adversaries is: 14.90614251631846. distance: 3.0315471385554424
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 2.5557, Accuracy: 1681/8991 (18.6965%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0072, Accuracy: 73/84 (86.9048%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   2,  Average loss: 0.0026, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   3,  Average loss: 0.0007, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   4,  Average loss: 0.0009, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   5,  Average loss: 0.0005, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   6,  Average loss: 0.0004, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   7,  Average loss: 0.0004, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   8,  Average loss: 0.0003, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   9,  Average loss: 0.0003, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch  10,  Average loss: 0.0004, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 14.727376883980817.
Norm before scaling: 14.761510980279033. Distance: 0.7696502903297069
Total norm for 8 adversaries is: 14.761510980279033. distance: 0.7696502903297069
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.1324, Accuracy: 6708/8991 (74.6079%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   1,  Average loss: 0.0006, Accuracy: 2156/2180 (98.8991%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   2,  Average loss: 0.0001, Accuracy: 2177/2180 (99.8624%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   4,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   5,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Global model norm: 14.727376883980817.
Norm before scaling: 14.582599962958852. Distance: 1.2971867565795268
Total norm for 8 adversaries is: 14.582599962958852. distance: 1.2971867565795268
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 2.1471, Accuracy: 4802/8991 (53.4090%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   1,  Average loss: 0.0046, Accuracy: 114/128 (89.0625%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   2,  Average loss: 0.0014, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   3,  Average loss: 0.0019, Accuracy: 122/128 (95.3125%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   4,  Average loss: 0.0014, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   5,  Average loss: 0.0009, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   6,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   7,  Average loss: 0.0004, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   8,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   9,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch  10,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 14.727376883980817.
Norm before scaling: 14.773600689870767. Distance: 0.8216290036894233
Total norm for 8 adversaries is: 14.773600689870767. distance: 0.8216290036894233
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.4079, Accuracy: 6069/8991 (67.5008%)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2665/2803 (95.0767%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   2,  Average loss: 0.0011, Accuracy: 2745/2803 (97.9308%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   3,  Average loss: 0.0005, Accuracy: 2778/2803 (99.1081%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   4,  Average loss: 0.0003, Accuracy: 2788/2803 (99.4649%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   5,  Average loss: 0.0003, Accuracy: 2792/2803 (99.6076%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   6,  Average loss: 0.0003, Accuracy: 2793/2803 (99.6432%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   7,  Average loss: 0.0002, Accuracy: 2796/2803 (99.7503%), train_poison_data_count: 2803
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   8,  Average loss: 0.0002, Accuracy: 2796/2803 (99.7503%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   9,  Average loss: 0.0002, Accuracy: 2797/2803 (99.7859%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch  10,  Average loss: 0.0002, Accuracy: 2797/2803 (99.7859%), train_poison_data_count: 2803
Global model norm: 14.727376883980817.
Norm before scaling: 15.08757850101911. Distance: 3.0637458291369732
Total norm for 8 adversaries is: 15.08757850101911. distance: 3.0637458291369732
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 2.7713, Accuracy: 4803/8991 (53.4201%)
___Train Local_Simple,  epoch  15, local model 98, internal_epoch   1,  Average loss: 0.0024, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.2183, Accuracy: 8190/10000 (81.9000%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   1,  Average loss: 0.0019, Accuracy: 651/678 (96.0177%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   2,  Average loss: 0.0008, Accuracy: 672/678 (99.1150%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   3,  Average loss: 0.0003, Accuracy: 675/678 (99.5575%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   4,  Average loss: 0.0003, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   5,  Average loss: 0.0002, Accuracy: 676/678 (99.7050%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   6,  Average loss: 0.0002, Accuracy: 676/678 (99.7050%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   7,  Average loss: 0.0002, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   8,  Average loss: 0.0002, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   9,  Average loss: 0.0002, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch  10,  Average loss: 0.0002, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Global model norm: 14.727376883980817.
Norm before scaling: 14.770531798792508. Distance: 1.2876275138300879
Total norm for 8 adversaries is: 14.770531798792508. distance: 1.2876275138300879
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 3.0631, Accuracy: 4272/8991 (47.5142%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0015, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   2,  Average loss: 0.0008, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   3,  Average loss: 0.0004, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   4,  Average loss: 0.0003, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   5,  Average loss: 0.0003, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   6,  Average loss: 0.0003, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   7,  Average loss: 0.0003, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   8,  Average loss: 0.0003, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Global model norm: 14.727376883980817.
Norm before scaling: 14.733419118317908. Distance: 0.17738587933551933
Total norm for 8 adversaries is: 14.733419118317908. distance: 0.17738587933551933
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.4437, Accuracy: 7660/8991 (85.1963%)
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0012, Accuracy: 296/300 (98.6667%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.7189, Accuracy: 4865/10000 (48.6500%), Attack Success Rate:1/10000(0.010)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   1,  Average loss: 0.0106, Accuracy: 39/47 (82.9787%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   2,  Average loss: 0.0008, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   3,  Average loss: 0.0016, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   4,  Average loss: 0.0017, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   5,  Average loss: 0.0018, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   6,  Average loss: 0.0018, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   7,  Average loss: 0.0017, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   8,  Average loss: 0.0015, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   9,  Average loss: 0.0013, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch  10,  Average loss: 0.0013, Accuracy: 45/47 (95.7447%), train_poison_data_count: 47
Global model norm: 14.727376883980817.
Norm before scaling: 14.743111763885597. Distance: 0.5121016198450536
Total norm for 8 adversaries is: 14.743111763885597. distance: 0.5121016198450536
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.5064, Accuracy: 4140/8991 (46.0460%)
time spent on training: 210.3456220626831
[foolsgold agg] training data poison_ratio: 0.9546800947867299  data num: [463, 84, 2180, 128, 2803, 6, 678, 63, 300, 47]
[foolsgold agg] considering poison per batch poison_fraction: 0.9546800947867299
[foolsgold agg] wv: [1.         1.         1.         1.         0.68995635 1.
 0.68995635 1.         0.43234124 0.43234124]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 1.2951, Accuracy: 8371/10000 (83.7100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.2272, Accuracy: 8349/8991 (92.8595%)
Done in 625.7729017734528 sec.
Server Epoch:16 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0023, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   2,  Average loss: 0.0014, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   3,  Average loss: 0.0010, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   4,  Average loss: 0.0009, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   5,  Average loss: 0.0008, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   6,  Average loss: 0.0008, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   7,  Average loss: 0.0007, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   8,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   9,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch  10,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Global model norm: 14.765223002133574.
Norm before scaling: 14.781411555175525. Distance: 0.35086081734502883
Total norm for 8 adversaries is: 14.781411555175525. distance: 0.35086081734502883
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.3738, Accuracy: 7914/8991 (88.0214%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0029, Accuracy: 161/171 (94.1520%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   2,  Average loss: 0.0017, Accuracy: 164/171 (95.9064%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   3,  Average loss: 0.0014, Accuracy: 166/171 (97.0760%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   4,  Average loss: 0.0010, Accuracy: 167/171 (97.6608%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   5,  Average loss: 0.0006, Accuracy: 168/171 (98.2456%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   6,  Average loss: 0.0007, Accuracy: 168/171 (98.2456%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   7,  Average loss: 0.0007, Accuracy: 168/171 (98.2456%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   8,  Average loss: 0.0005, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   9,  Average loss: 0.0004, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch  10,  Average loss: 0.0004, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Global model norm: 14.765223002133574.
Norm before scaling: 14.783201447722524. Distance: 0.6391572886636518
Total norm for 8 adversaries is: 14.783201447722524. distance: 0.6391572886636518
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.3905, Accuracy: 4758/8991 (52.9196%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0018, Accuracy: 630/648 (97.2222%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   2,  Average loss: 0.0013, Accuracy: 633/648 (97.6852%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   3,  Average loss: 0.0005, Accuracy: 642/648 (99.0741%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   4,  Average loss: 0.0003, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   5,  Average loss: 0.0003, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   6,  Average loss: 0.0002, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   7,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   8,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   9,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch  10,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 14.765223002133574.
Norm before scaling: 14.845323724143215. Distance: 1.404190717353451
Total norm for 8 adversaries is: 14.845323724143215. distance: 1.404190717353451
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.4782, Accuracy: 6026/8991 (67.0226%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0002, Accuracy: 411/411 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 3.4303, Accuracy: 4764/10000 (47.6400%), Attack Success Rate:1/10000(0.010)
poison local model 53 index 52 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0025, Accuracy: 444/456 (97.3684%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   2,  Average loss: 0.0019, Accuracy: 440/456 (96.4912%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   3,  Average loss: 0.0010, Accuracy: 441/456 (96.7105%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   4,  Average loss: 0.0005, Accuracy: 450/456 (98.6842%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   5,  Average loss: 0.0005, Accuracy: 453/456 (99.3421%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   6,  Average loss: 0.0004, Accuracy: 452/456 (99.1228%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   7,  Average loss: 0.0003, Accuracy: 455/456 (99.7807%), train_poison_data_count: 456
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   8,  Average loss: 0.0004, Accuracy: 455/456 (99.7807%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   9,  Average loss: 0.0003, Accuracy: 455/456 (99.7807%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch  10,  Average loss: 0.0003, Accuracy: 455/456 (99.7807%), train_poison_data_count: 456
Global model norm: 14.765223002133574.
Norm before scaling: 14.834330378823505. Distance: 1.3172401481052938
Total norm for 8 adversaries is: 14.834330378823505. distance: 1.3172401481052938
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.0685, Accuracy: 6164/8991 (68.5574%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1284/1311 (97.9405%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1300/1311 (99.1609%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1307/1311 (99.6949%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1308/1311 (99.7712%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Global model norm: 14.765223002133574.
Norm before scaling: 14.719910011016436. Distance: 1.5723673722415492
Total norm for 8 adversaries is: 14.719910011016436. distance: 1.5723673722415492
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 3.0345, Accuracy: 2686/8991 (29.8743%)
poison local model 60 index 59 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   1,  Average loss: 0.0011, Accuracy: 391/399 (97.9950%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   2,  Average loss: 0.0007, Accuracy: 397/399 (99.4987%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   3,  Average loss: 0.0015, Accuracy: 388/399 (97.2431%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   4,  Average loss: 0.0011, Accuracy: 391/399 (97.9950%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   5,  Average loss: 0.0005, Accuracy: 397/399 (99.4987%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   6,  Average loss: 0.0004, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   7,  Average loss: 0.0004, Accuracy: 397/399 (99.4987%), train_poison_data_count: 399
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   8,  Average loss: 0.0003, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   9,  Average loss: 0.0002, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch  10,  Average loss: 0.0002, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Global model norm: 14.765223002133574.
Norm before scaling: 14.809341287021134. Distance: 1.2308497247829115
Total norm for 8 adversaries is: 14.809341287021134. distance: 1.2308497247829115
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 8.1755, Accuracy: 1965/8991 (21.8552%)
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   1,  Average loss: 0.0002, Accuracy: 3009/3022 (99.5698%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   2,  Average loss: 0.0001, Accuracy: 3019/3022 (99.9007%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   3,  Average loss: 0.0001, Accuracy: 3017/3022 (99.8345%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   4,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   5,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   6,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   7,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   8,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   9,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch  10,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Global model norm: 14.765223002133574.
Norm before scaling: 14.435733307254054. Distance: 1.261615949759474
Total norm for 8 adversaries is: 14.435733307254054. distance: 1.261615949759474
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 4.5705, Accuracy: 2142/8991 (23.8238%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   1,  Average loss: 0.0014, Accuracy: 689/705 (97.7305%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 701/705 (99.4326%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   3,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   4,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   5,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   6,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   7,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   8,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   9,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch  10,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Global model norm: 14.765223002133574.
Norm before scaling: 14.777152721472122. Distance: 1.7527130758182896
Total norm for 8 adversaries is: 14.777152721472122. distance: 1.7527130758182896
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 4.0042, Accuracy: 2419/8991 (26.9047%)
___Train Local_Simple,  epoch  16, local model 90, internal_epoch   1,  Average loss: 0.0016, Accuracy: 745/768 (97.0052%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.2350, Accuracy: 3723/10000 (37.2300%), Attack Success Rate:0/10000(0.000)
time spent on training: 215.49861192703247
[foolsgold agg] training data poison_ratio: 0.8529741863075196  data num: [128, 171, 648, 411, 456, 1311, 399, 3022, 705, 768]
[foolsgold agg] considering poison per batch poison_fraction: 0.8529741863075196
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.20394493
 1.         1.         0.20394493 1.        ]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 1.3367, Accuracy: 8383/10000 (83.8300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.2247, Accuracy: 8364/8991 (93.0264%)
Done in 612.0627620220184 sec.
Server Epoch:17 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
poison local model 66 index 65 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0009, Accuracy: 670/681 (98.3847%), train_poison_data_count: 681
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   2,  Average loss: 0.0006, Accuracy: 676/681 (99.2658%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   3,  Average loss: 0.0006, Accuracy: 676/681 (99.2658%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   4,  Average loss: 0.0003, Accuracy: 680/681 (99.8532%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   5,  Average loss: 0.0003, Accuracy: 678/681 (99.5595%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   6,  Average loss: 0.0002, Accuracy: 680/681 (99.8532%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   7,  Average loss: 0.0002, Accuracy: 680/681 (99.8532%), train_poison_data_count: 681
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   8,  Average loss: 0.0002, Accuracy: 680/681 (99.8532%), train_poison_data_count: 681
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   9,  Average loss: 0.0002, Accuracy: 680/681 (99.8532%), train_poison_data_count: 681
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch  10,  Average loss: 0.0002, Accuracy: 680/681 (99.8532%), train_poison_data_count: 681
Global model norm: 14.792241016394689.
Norm before scaling: 14.800244117991717. Distance: 1.3960080061221152
Total norm for 8 adversaries is: 14.800244117991717. distance: 1.3960080061221152
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.7064, Accuracy: 5114/8991 (56.8791%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   1,  Average loss: 0.0019, Accuracy: 625/644 (97.0497%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 630/644 (97.8261%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   3,  Average loss: 0.0006, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   4,  Average loss: 0.0004, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   5,  Average loss: 0.0003, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   6,  Average loss: 0.0003, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   8,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   9,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch  10,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Global model norm: 14.792241016394689.
Norm before scaling: 14.846872615633359. Distance: 1.1382077352417475
Total norm for 8 adversaries is: 14.846872615633359. distance: 1.1382077352417475
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.5020, Accuracy: 5772/8991 (64.1975%)
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   1,  Average loss: 0.0015, Accuracy: 685/704 (97.3011%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   2,  Average loss: 0.0003, Accuracy: 702/704 (99.7159%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   3,  Average loss: 0.0002, Accuracy: 701/704 (99.5739%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   4,  Average loss: 0.0002, Accuracy: 703/704 (99.8580%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   5,  Average loss: 0.0001, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   6,  Average loss: 0.0001, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   7,  Average loss: 0.0001, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   8,  Average loss: 0.0001, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   9,  Average loss: 0.0001, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch  10,  Average loss: 0.0001, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Global model norm: 14.792241016394689.
Norm before scaling: 14.800449282038546. Distance: 1.3293154598330295
Total norm for 8 adversaries is: 14.800449282038546. distance: 1.3293154598330295
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 2.4677, Accuracy: 3875/8991 (43.0987%)
___Train Local_Simple,  epoch  17, local model 97, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.3821, Accuracy: 8355/10000 (83.5500%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 628/688 (91.2791%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0018, Accuracy: 669/688 (97.2384%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   3,  Average loss: 0.0008, Accuracy: 676/688 (98.2558%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   4,  Average loss: 0.0006, Accuracy: 681/688 (98.9826%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   5,  Average loss: 0.0004, Accuracy: 683/688 (99.2733%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   6,  Average loss: 0.0003, Accuracy: 683/688 (99.2733%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   7,  Average loss: 0.0003, Accuracy: 685/688 (99.5640%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   8,  Average loss: 0.0002, Accuracy: 685/688 (99.5640%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   9,  Average loss: 0.0002, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch  10,  Average loss: 0.0002, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Global model norm: 14.792241016394689.
Norm before scaling: 15.063939955645889. Distance: 2.475633416858552
Total norm for 8 adversaries is: 15.063939955645889. distance: 2.475633416858552
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 3.5641, Accuracy: 3006/8991 (33.4334%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0502, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   2,  Average loss: 0.0021, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   3,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   4,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   5,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   6,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   7,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   8,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   9,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch  10,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.792241016394689.
Norm before scaling: 14.80726550360788. Distance: 0.47618597821824754
Total norm for 8 adversaries is: 14.80726550360788. distance: 0.47618597821824754
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.5812, Accuracy: 7426/8991 (82.5937%)
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1506/1544 (97.5389%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1538/1544 (99.6114%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Global model norm: 14.792241016394689.
Norm before scaling: 14.817486531274195. Distance: 1.4735364635966597
Total norm for 8 adversaries is: 14.817486531274195. distance: 1.4735364635966597
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.0797, Accuracy: 6233/8991 (69.3249%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0015, Accuracy: 557/578 (96.3668%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   2,  Average loss: 0.0010, Accuracy: 569/578 (98.4429%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   3,  Average loss: 0.0006, Accuracy: 570/578 (98.6159%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   4,  Average loss: 0.0005, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   5,  Average loss: 0.0004, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   6,  Average loss: 0.0004, Accuracy: 572/578 (98.9619%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   7,  Average loss: 0.0002, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   8,  Average loss: 0.0002, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Global model norm: 14.792241016394689.
Norm before scaling: 14.864265736121089. Distance: 1.2328443573871444
Total norm for 8 adversaries is: 14.864265736121089. distance: 1.2328443573871444
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 2.0887, Accuracy: 5299/8991 (58.9367%)
___Train Local_Simple,  epoch  17, local model 90, internal_epoch   1,  Average loss: 0.0018, Accuracy: 731/768 (95.1823%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.0876, Accuracy: 4666/10000 (46.6600%), Attack Success Rate:0/10000(0.000)
poison local model 59 index 58 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0013, Accuracy: 27/27 (100.0000%), train_poison_data_count: 27
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   2,  Average loss: 0.0010, Accuracy: 27/27 (100.0000%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   3,  Average loss: 0.0006, Accuracy: 27/27 (100.0000%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   4,  Average loss: 0.0006, Accuracy: 27/27 (100.0000%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   5,  Average loss: 0.0005, Accuracy: 27/27 (100.0000%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   6,  Average loss: 0.0005, Accuracy: 27/27 (100.0000%), train_poison_data_count: 27
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   7,  Average loss: 0.0005, Accuracy: 27/27 (100.0000%), train_poison_data_count: 27
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   8,  Average loss: 0.0004, Accuracy: 27/27 (100.0000%), train_poison_data_count: 27
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   9,  Average loss: 0.0004, Accuracy: 27/27 (100.0000%), train_poison_data_count: 27
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch  10,  Average loss: 0.0004, Accuracy: 27/27 (100.0000%), train_poison_data_count: 27
Global model norm: 14.792241016394689.
Norm before scaling: 14.796673395702886. Distance: 0.09385447343404993
Total norm for 8 adversaries is: 14.796673395702886. distance: 0.09385447343404993
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.2653, Accuracy: 8228/8991 (91.5137%)
time spent on training: 183.7168619632721
[foolsgold agg] training data poison_ratio: 0.8630403968816442  data num: [681, 644, 704, 5, 688, 5, 1544, 578, 768, 27]
[foolsgold agg] considering poison per batch poison_fraction: 0.8630403968816442
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 1.3894, Accuracy: 8453/10000 (84.5300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.1991, Accuracy: 8435/8991 (93.8160%)
Done in 576.5708909034729 sec.
Server Epoch:18 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0018, Accuracy: 2703/2803 (96.4324%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   2,  Average loss: 0.0013, Accuracy: 2731/2803 (97.4313%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   3,  Average loss: 0.0005, Accuracy: 2778/2803 (99.1081%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   4,  Average loss: 0.0004, Accuracy: 2787/2803 (99.4292%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   5,  Average loss: 0.0003, Accuracy: 2790/2803 (99.5362%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   6,  Average loss: 0.0003, Accuracy: 2791/2803 (99.5719%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   7,  Average loss: 0.0002, Accuracy: 2794/2803 (99.6789%), train_poison_data_count: 2803
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   8,  Average loss: 0.0002, Accuracy: 2797/2803 (99.7859%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   9,  Average loss: 0.0002, Accuracy: 2797/2803 (99.7859%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch  10,  Average loss: 0.0002, Accuracy: 2798/2803 (99.8216%), train_poison_data_count: 2803
Global model norm: 14.833457060451478.
Norm before scaling: 15.133337828065539. Distance: 2.944583225778337
Total norm for 6 adversaries is: 15.133337828065539. distance: 2.944583225778337
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 2.5153, Accuracy: 4851/8991 (53.9540%)
poison local model 58 index 57 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0028, Accuracy: 963/1015 (94.8768%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   2,  Average loss: 0.0010, Accuracy: 997/1015 (98.2266%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1007/1015 (99.2118%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1009/1015 (99.4089%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1009/1015 (99.4089%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1011/1015 (99.6059%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1010/1015 (99.5074%), train_poison_data_count: 1015
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1012/1015 (99.7044%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   9,  Average loss: 0.0003, Accuracy: 1012/1015 (99.7044%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1012/1015 (99.7044%), train_poison_data_count: 1015
Global model norm: 14.833457060451478.
Norm before scaling: 14.97689718669459. Distance: 2.193615240321511
Total norm for 6 adversaries is: 14.97689718669459. distance: 2.193615240321511
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 3.8108, Accuracy: 4770/8991 (53.0531%)
___Train Local_Simple,  epoch  18, local model 88, internal_epoch   1,  Average loss: 0.0202, Accuracy: 79/96 (82.2917%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.0560, Accuracy: 4589/10000 (45.8900%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0009, Accuracy: 420/428 (98.1308%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 424/428 (99.0654%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   3,  Average loss: 0.0001, Accuracy: 427/428 (99.7664%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   4,  Average loss: 0.0001, Accuracy: 427/428 (99.7664%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   5,  Average loss: 0.0001, Accuracy: 427/428 (99.7664%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 14.833457060451478.
Norm before scaling: 14.846516497954106. Distance: 0.9828514236966183
Total norm for 6 adversaries is: 14.846516497954106. distance: 0.9828514236966183
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 4.6664, Accuracy: 3236/8991 (35.9915%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1231/1259 (97.7760%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1249/1259 (99.2057%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1254/1259 (99.6029%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Global model norm: 14.833457060451478.
Norm before scaling: 14.81671674882272. Distance: 1.4905268830770597
Total norm for 6 adversaries is: 14.81671674882272. distance: 1.4905268830770597
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 1.2276, Accuracy: 6275/8991 (69.7920%)
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   1,  Average loss: 0.0007, Accuracy: 491/497 (98.7928%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   2,  Average loss: 0.0005, Accuracy: 493/497 (99.1952%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   3,  Average loss: 0.0002, Accuracy: 495/497 (99.5976%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   4,  Average loss: 0.0002, Accuracy: 495/497 (99.5976%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   5,  Average loss: 0.0001, Accuracy: 495/497 (99.5976%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   7,  Average loss: 0.0001, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   8,  Average loss: 0.0001, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   9,  Average loss: 0.0001, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch  10,  Average loss: 0.0001, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Global model norm: 14.833457060451478.
Norm before scaling: 14.821190196236191. Distance: 0.8309743194628707
Total norm for 6 adversaries is: 14.821190196236191. distance: 0.8309743194628707
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 3.1083, Accuracy: 4108/8991 (45.6901%)
___Train Local_Simple,  epoch  18, local model 82, internal_epoch   1,  Average loss: 0.0021, Accuracy: 107/114 (93.8596%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.5121, Accuracy: 7168/10000 (71.6800%), Attack Success Rate:0/10000(0.000)
poison local model 61 index 60 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0015, Accuracy: 745/767 (97.1317%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   2,  Average loss: 0.0005, Accuracy: 758/767 (98.8266%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   3,  Average loss: 0.0003, Accuracy: 763/767 (99.4785%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   4,  Average loss: 0.0002, Accuracy: 765/767 (99.7392%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   5,  Average loss: 0.0002, Accuracy: 765/767 (99.7392%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   6,  Average loss: 0.0002, Accuracy: 765/767 (99.7392%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   7,  Average loss: 0.0001, Accuracy: 765/767 (99.7392%), train_poison_data_count: 767
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   8,  Average loss: 0.0001, Accuracy: 766/767 (99.8696%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   9,  Average loss: 0.0001, Accuracy: 766/767 (99.8696%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch  10,  Average loss: 0.0001, Accuracy: 766/767 (99.8696%), train_poison_data_count: 767
Global model norm: 14.833457060451478.
Norm before scaling: 14.856076810129805. Distance: 1.2178443576012188
Total norm for 6 adversaries is: 14.856076810129805. distance: 1.2178443576012188
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 2.7065, Accuracy: 4514/8991 (50.2058%)
___Train Local_Simple,  epoch  18, local model 95, internal_epoch   1,  Average loss: 0.0041, Accuracy: 28/29 (96.5517%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.4364, Accuracy: 8121/10000 (81.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0055, Accuracy: 28/30 (93.3333%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.4212, Accuracy: 7805/10000 (78.0500%), Attack Success Rate:0/10000(0.000)
time spent on training: 198.4224841594696
[foolsgold agg] training data poison_ratio: 0.9617789144643365  data num: [2803, 1015, 96, 428, 1259, 497, 114, 767, 29, 30]
[foolsgold agg] considering poison per batch poison_fraction: 0.9617789144643365
[foolsgold agg] wv: [0.75802186 1.         1.         0.         1.         1.
 1.         0.75802186 0.         0.40025717]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 1.2570, Accuracy: 8526/10000 (85.2600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.1733, Accuracy: 8522/8991 (94.7837%)
Done in 591.0398988723755 sec.
Server Epoch:19 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0011, Accuracy: 568/578 (98.2699%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   2,  Average loss: 0.0011, Accuracy: 567/578 (98.0969%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   3,  Average loss: 0.0004, Accuracy: 572/578 (98.9619%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   4,  Average loss: 0.0002, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   5,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   8,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 14.865453397455259.
Norm before scaling: 14.907036654589975. Distance: 0.8890028787744381
Total norm for 9 adversaries is: 14.907036654589975. distance: 0.8890028787744381
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.9824, Accuracy: 6156/8991 (68.4685%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.0066, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   2,  Average loss: 0.0033, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   3,  Average loss: 0.0015, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   4,  Average loss: 0.0014, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   5,  Average loss: 0.0013, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   6,  Average loss: 0.0012, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   7,  Average loss: 0.0011, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   8,  Average loss: 0.0010, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   9,  Average loss: 0.0009, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch  10,  Average loss: 0.0009, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Global model norm: 14.865453397455259.
Norm before scaling: 14.870707429477758. Distance: 0.12242510163267138
Total norm for 9 adversaries is: 14.870707429477758. distance: 0.12242510163267138
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1758, Accuracy: 8524/8991 (94.8059%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   1,  Average loss: 0.0014, Accuracy: 149/151 (98.6755%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 14.865453397455259.
Norm before scaling: 14.866244263628234. Distance: 0.5855972573743106
Total norm for 9 adversaries is: 14.866244263628234. distance: 0.5855972573743106
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.3170, Accuracy: 6162/8991 (68.5352%)
___Train Local_Simple,  epoch  19, local model 84, internal_epoch   1,  Average loss: 0.2494, Accuracy: 9/29 (31.0345%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.1772, Accuracy: 7879/10000 (78.7900%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   2,  Average loss: 0.0011, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   3,  Average loss: 0.0008, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   4,  Average loss: 0.0008, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   5,  Average loss: 0.0006, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   6,  Average loss: 0.0006, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   7,  Average loss: 0.0005, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   8,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   9,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch  10,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Global model norm: 14.865453397455259.
Norm before scaling: 14.87590831900458. Distance: 0.2947671749782986
Total norm for 9 adversaries is: 14.87590831900458. distance: 0.2947671749782986
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.2821, Accuracy: 8196/8991 (91.1578%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 228/237 (96.2025%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   2,  Average loss: 0.0013, Accuracy: 232/237 (97.8903%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   3,  Average loss: 0.0005, Accuracy: 235/237 (99.1561%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   4,  Average loss: 0.0005, Accuracy: 236/237 (99.5781%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   5,  Average loss: 0.0003, Accuracy: 236/237 (99.5781%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   6,  Average loss: 0.0002, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   7,  Average loss: 0.0002, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   8,  Average loss: 0.0002, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch  10,  Average loss: 0.0002, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Global model norm: 14.865453397455259.
Norm before scaling: 14.889473165052298. Distance: 0.6975636633323345
Total norm for 9 adversaries is: 14.889473165052298. distance: 0.6975636633323345
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.1078, Accuracy: 6189/8991 (68.8355%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0021, Accuracy: 164/171 (95.9064%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   2,  Average loss: 0.0008, Accuracy: 168/171 (98.2456%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   3,  Average loss: 0.0004, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   4,  Average loss: 0.0004, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   5,  Average loss: 0.0003, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   6,  Average loss: 0.0003, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   7,  Average loss: 0.0003, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   8,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   9,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch  10,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Global model norm: 14.865453397455259.
Norm before scaling: 14.870679211782042. Distance: 0.5066492696126057
Total norm for 9 adversaries is: 14.870679211782042. distance: 0.5066492696126057
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.0768, Accuracy: 5806/8991 (64.5757%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0015, Accuracy: 965/994 (97.0825%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   2,  Average loss: 0.0008, Accuracy: 977/994 (98.2897%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   3,  Average loss: 0.0004, Accuracy: 987/994 (99.2958%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   4,  Average loss: 0.0002, Accuracy: 992/994 (99.7988%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   5,  Average loss: 0.0002, Accuracy: 993/994 (99.8994%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   6,  Average loss: 0.0002, Accuracy: 993/994 (99.8994%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   7,  Average loss: 0.0001, Accuracy: 993/994 (99.8994%), train_poison_data_count: 994
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   8,  Average loss: 0.0001, Accuracy: 993/994 (99.8994%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   9,  Average loss: 0.0001, Accuracy: 993/994 (99.8994%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch  10,  Average loss: 0.0001, Accuracy: 993/994 (99.8994%), train_poison_data_count: 994
Global model norm: 14.865453397455259.
Norm before scaling: 14.91248272801284. Distance: 1.2634485628189547
Total norm for 9 adversaries is: 14.91248272801284. distance: 1.2634485628189547
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.8468, Accuracy: 6906/8991 (76.8101%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1914/1982 (96.5691%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1943/1982 (98.0323%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1961/1982 (98.9405%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1971/1982 (99.4450%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1973/1982 (99.5459%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1973/1982 (99.5459%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1974/1982 (99.5964%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1975/1982 (99.6468%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1975/1982 (99.6468%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1975/1982 (99.6468%), train_poison_data_count: 1982
Global model norm: 14.865453397455259.
Norm before scaling: 14.943509860085634. Distance: 2.314253992455335
Total norm for 9 adversaries is: 14.943509860085634. distance: 2.314253992455335
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 3.6007, Accuracy: 3118/8991 (34.6791%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 978/1010 (96.8317%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   2,  Average loss: 0.0010, Accuracy: 993/1010 (98.3168%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   3,  Average loss: 0.0006, Accuracy: 999/1010 (98.9109%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1005/1010 (99.5050%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1008/1010 (99.8020%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1009/1010 (99.9010%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1009/1010 (99.9010%), train_poison_data_count: 1010
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1008/1010 (99.8020%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1009/1010 (99.9010%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1009/1010 (99.9010%), train_poison_data_count: 1010
Global model norm: 14.865453397455259.
Norm before scaling: 14.966206949787484. Distance: 1.6539632017108257
Total norm for 9 adversaries is: 14.966206949787484. distance: 1.6539632017108257
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 2.2892, Accuracy: 5356/8991 (59.5707%)
time spent on training: 200.4324107170105
[foolsgold agg] training data poison_ratio: 0.9945138100643208  data num: [578, 6, 151, 29, 128, 237, 171, 994, 1982, 1010]
[foolsgold agg] considering poison per batch poison_fraction: 0.9945138100643208
[foolsgold agg] wv: [0.95126987 1.         1.         1.         0.90804025 1.
 0.76373453 0.90804025 0.76373453 1.        ]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.8106, Accuracy: 8478/10000 (84.7800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.2004, Accuracy: 8469/8991 (94.1942%)
Done in 587.902176618576 sec.
Server Epoch:20 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 423/428 (98.8318%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   3,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   4,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   5,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 14.8860407013978.
Norm before scaling: 14.88235420062076. Distance: 0.8443470714363566
Total norm for 9 adversaries is: 14.88235420062076. distance: 0.8443470714363566
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 3.5890, Accuracy: 4415/8991 (49.1047%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0074, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   2,  Average loss: 0.0020, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   3,  Average loss: 0.0012, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   4,  Average loss: 0.0011, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   5,  Average loss: 0.0011, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   6,  Average loss: 0.0010, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   7,  Average loss: 0.0010, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   8,  Average loss: 0.0009, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   9,  Average loss: 0.0008, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch  10,  Average loss: 0.0008, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Global model norm: 14.8860407013978.
Norm before scaling: 14.890406732070295. Distance: 0.1629288196380556
Total norm for 9 adversaries is: 14.890406732070295. distance: 0.1629288196380556
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1997, Accuracy: 8466/8991 (94.1608%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 656/678 (96.7552%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   2,  Average loss: 0.0008, Accuracy: 664/678 (97.9351%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   3,  Average loss: 0.0007, Accuracy: 665/678 (98.0826%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   4,  Average loss: 0.0003, Accuracy: 675/678 (99.5575%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Global model norm: 14.8860407013978.
Norm before scaling: 14.894969198419814. Distance: 1.2983235461821463
Total norm for 9 adversaries is: 14.894969198419814. distance: 1.2983235461821463
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 3.1377, Accuracy: 4411/8991 (49.0602%)
___Train Local_Simple,  epoch  20, local model 82, internal_epoch   1,  Average loss: 0.0012, Accuracy: 111/114 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0404, Accuracy: 7608/10000 (76.0800%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 565/578 (97.7509%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   2,  Average loss: 0.0007, Accuracy: 571/578 (98.7889%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   3,  Average loss: 0.0002, Accuracy: 575/578 (99.4810%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   4,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   8,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 14.8860407013978.
Norm before scaling: 14.930412111209352. Distance: 0.895606980818018
Total norm for 9 adversaries is: 14.930412111209352. distance: 0.895606980818018
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.0197, Accuracy: 6309/8991 (70.1702%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0008, Accuracy: 966/978 (98.7730%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   2,  Average loss: 0.0004, Accuracy: 971/978 (99.2843%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   3,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   4,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   5,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Global model norm: 14.8860407013978.
Norm before scaling: 14.883811072143116. Distance: 1.384288754155464
Total norm for 9 adversaries is: 14.883811072143116. distance: 1.384288754155464
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 2.8129, Accuracy: 5056/8991 (56.2340%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   1,  Average loss: 0.0026, Accuracy: 1184/1232 (96.1039%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1215/1232 (98.6201%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1224/1232 (99.3506%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1225/1232 (99.4318%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1227/1232 (99.5942%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1226/1232 (99.5130%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1226/1232 (99.5130%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1228/1232 (99.6753%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Global model norm: 14.8860407013978.
Norm before scaling: 15.023096740317733. Distance: 2.1970988434966876
Total norm for 9 adversaries is: 15.023096740317733. distance: 2.1970988434966876
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.8010, Accuracy: 5631/8991 (62.6293%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   1,  Average loss: 0.0017, Accuracy: 2441/2519 (96.9035%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 2499/2519 (99.2060%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   3,  Average loss: 0.0003, Accuracy: 2511/2519 (99.6824%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   4,  Average loss: 0.0002, Accuracy: 2514/2519 (99.8015%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2513/2519 (99.7618%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2516/2519 (99.8809%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2516/2519 (99.8809%), train_poison_data_count: 2519
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2516/2519 (99.8809%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2517/2519 (99.9206%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2517/2519 (99.9206%), train_poison_data_count: 2519
Global model norm: 14.8860407013978.
Norm before scaling: 15.060940357045325. Distance: 2.625244855814123
Total norm for 9 adversaries is: 15.060940357045325. distance: 2.625244855814123
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.8178, Accuracy: 5788/8991 (64.3755%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0048, Accuracy: 80/84 (95.2381%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   2,  Average loss: 0.0020, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   3,  Average loss: 0.0009, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   7,  Average loss: 0.0003, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   8,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   9,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 14.8860407013978.
Norm before scaling: 14.903465410769403. Distance: 0.6041897462404734
Total norm for 9 adversaries is: 14.903465410769403. distance: 0.6041897462404734
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.7966, Accuracy: 6849/8991 (76.1762%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0052, Accuracy: 57/63 (90.4762%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   2,  Average loss: 0.0004, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   3,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   5,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   6,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   7,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   8,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Global model norm: 14.8860407013978.
Norm before scaling: 14.898571155830735. Distance: 0.459330424267499
Total norm for 9 adversaries is: 14.898571155830735. distance: 0.459330424267499
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.6445, Accuracy: 7326/8991 (81.4815%)
time spent on training: 219.27469992637634
[foolsgold agg] training data poison_ratio: 0.982934131736527  data num: [428, 6, 678, 114, 578, 978, 1232, 2519, 84, 63]
[foolsgold agg] considering poison per batch poison_fraction: 0.982934131736527
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.8994, Accuracy: 8598/10000 (85.9800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.1685, Accuracy: 8546/8991 (95.0506%)
Done in 609.9171071052551 sec.
Server Epoch:21 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   1,  Average loss: 0.0015, Accuracy: 629/644 (97.6708%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   3,  Average loss: 0.0004, Accuracy: 637/644 (98.9130%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   4,  Average loss: 0.0003, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   5,  Average loss: 0.0002, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   8,  Average loss: 0.0003, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   9,  Average loss: 0.0004, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 14.925057436322952.
Norm before scaling: 14.969583826593386. Distance: 1.3186311568816997
Total norm for 7 adversaries is: 14.969583826593386. distance: 1.3186311568816997
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 2.1979, Accuracy: 5826/8991 (64.7981%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0022, Accuracy: 619/648 (95.5247%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   2,  Average loss: 0.0010, Accuracy: 635/648 (97.9938%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   3,  Average loss: 0.0006, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   4,  Average loss: 0.0003, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   5,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   6,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   7,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   8,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   9,  Average loss: 0.0002, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch  10,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 14.925057436322952.
Norm before scaling: 15.001355427855563. Distance: 1.7984954161809603
Total norm for 7 adversaries is: 15.001355427855563. distance: 1.7984954161809603
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 2.0676, Accuracy: 5442/8991 (60.5272%)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0022, Accuracy: 29/30 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.9586, Accuracy: 8380/10000 (83.8000%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   1,  Average loss: 0.0022, Accuracy: 988/1033 (95.6438%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   2,  Average loss: 0.0015, Accuracy: 1005/1033 (97.2894%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   3,  Average loss: 0.0006, Accuracy: 1020/1033 (98.7415%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1026/1033 (99.3224%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1027/1033 (99.4192%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1029/1033 (99.6128%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1030/1033 (99.7096%), train_poison_data_count: 1033
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1031/1033 (99.8064%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Global model norm: 14.925057436322952.
Norm before scaling: 15.085776171619255. Distance: 2.0457068451459155
Total norm for 7 adversaries is: 15.085776171619255. distance: 2.0457068451459155
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 2.1396, Accuracy: 4403/8991 (48.9712%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0019, Accuracy: 486/509 (95.4813%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 505/509 (99.2141%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0002, Accuracy: 507/509 (99.6071%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Global model norm: 14.925057436322952.
Norm before scaling: 14.966736596389445. Distance: 1.2996202391023308
Total norm for 7 adversaries is: 14.966736596389445. distance: 1.2996202391023308
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 3.8399, Accuracy: 3220/8991 (35.8136%)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0111, Accuracy: 8558/10000 (85.5800%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   1,  Average loss: 0.0004, Accuracy: 2166/2180 (99.3578%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   2,  Average loss: 0.0001, Accuracy: 2177/2180 (99.8624%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   3,  Average loss: 0.0000, Accuracy: 2179/2180 (99.9541%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   4,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   5,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Global model norm: 14.925057436322952.
Norm before scaling: 14.715393331587176. Distance: 1.0690721996573194
Total norm for 7 adversaries is: 14.715393331587176. distance: 1.0690721996573194
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 1.6396, Accuracy: 5573/8991 (61.9842%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0033, Accuracy: 33/34 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.9962, Accuracy: 8545/10000 (85.4500%), Attack Success Rate:0/10000(0.000)
poison local model 54 index 53 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0035, Accuracy: 85/91 (93.4066%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   2,  Average loss: 0.0022, Accuracy: 87/91 (95.6044%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   3,  Average loss: 0.0023, Accuracy: 87/91 (95.6044%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   4,  Average loss: 0.0016, Accuracy: 88/91 (96.7033%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   5,  Average loss: 0.0009, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   6,  Average loss: 0.0006, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   7,  Average loss: 0.0007, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   8,  Average loss: 0.0007, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   9,  Average loss: 0.0008, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch  10,  Average loss: 0.0008, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Global model norm: 14.925057436322952.
Norm before scaling: 14.941788700170635. Distance: 0.3818050284204922
Total norm for 7 adversaries is: 14.941788700170635. distance: 0.3818050284204922
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.2737, Accuracy: 8236/8991 (91.6027%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 698/705 (99.0071%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   2,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   3,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   4,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   5,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   6,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   7,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   8,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   9,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch  10,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Global model norm: 14.925057436322952.
Norm before scaling: 14.89252369354807. Distance: 1.009789058922502
Total norm for 7 adversaries is: 14.89252369354807. distance: 1.009789058922502
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 3.9263, Accuracy: 3756/8991 (41.7751%)
time spent on training: 189.43403124809265
[foolsgold agg] training data poison_ratio: 0.9882633100867495  data num: [644, 648, 30, 1033, 509, 5, 2180, 34, 91, 705]
[foolsgold agg] considering poison per batch poison_fraction: 0.9882633100867495
[foolsgold agg] wv: [1.         1.         1.         1.         1.         0.12243291
 1.         0.12243291 1.         0.71291572]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 1.0093, Accuracy: 8625/10000 (86.2500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.1497, Accuracy: 8593/8991 (95.5734%)
Done in 611.6137471199036 sec.
Server Epoch:22 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   2,  Average loss: 0.0020, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   3,  Average loss: 0.0010, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   4,  Average loss: 0.0009, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   5,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   6,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   7,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   8,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   9,  Average loss: 0.0006, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch  10,  Average loss: 0.0006, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 14.960995634678174.
Norm before scaling: 14.963021028222062. Distance: 0.07936959420497992
Total norm for 8 adversaries is: 14.963021028222062. distance: 0.07936959420497992
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1546, Accuracy: 8562/8991 (95.2286%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 176/179 (98.3240%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   3,  Average loss: 0.0001, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   4,  Average loss: 0.0001, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   5,  Average loss: 0.0001, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   6,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   7,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Global model norm: 14.960995634678174.
Norm before scaling: 14.968878440863355. Distance: 0.45519449931698724
Total norm for 8 adversaries is: 14.968878440863355. distance: 0.45519449931698724
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.0988, Accuracy: 6554/8991 (72.8951%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0015, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   2,  Average loss: 0.0004, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   3,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Global model norm: 14.960995634678174.
Norm before scaling: 14.964291603459195. Distance: 0.21392259794451185
Total norm for 8 adversaries is: 14.964291603459195. distance: 0.21392259794451185
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2365, Accuracy: 8312/8991 (92.4480%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0023, Accuracy: 27/28 (96.4286%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   2,  Average loss: 0.0003, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   3,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   4,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   5,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   6,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 14.960995634678174.
Norm before scaling: 14.962945055417578. Distance: 0.19004000382224573
Total norm for 8 adversaries is: 14.962945055417578. distance: 0.19004000382224573
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1741, Accuracy: 8491/8991 (94.4389%)
poison local model 60 index 59 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   1,  Average loss: 0.0010, Accuracy: 392/399 (98.2456%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   3,  Average loss: 0.0001, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   4,  Average loss: 0.0001, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   5,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   6,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   7,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   8,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   9,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch  10,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Global model norm: 14.960995634678174.
Norm before scaling: 14.966622920209561. Distance: 0.9602628370925141
Total norm for 8 adversaries is: 14.966622920209561. distance: 0.9602628370925141
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 6.4569, Accuracy: 2640/8991 (29.3627%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 163/171 (95.3216%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   2,  Average loss: 0.0006, Accuracy: 169/171 (98.8304%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   3,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   4,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   5,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   6,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   7,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   8,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   9,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Global model norm: 14.960995634678174.
Norm before scaling: 14.960583587524146. Distance: 0.5167078438880526
Total norm for 8 adversaries is: 14.960583587524146. distance: 0.5167078438880526
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.1855, Accuracy: 5870/8991 (65.2875%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 967/978 (98.8753%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   2,  Average loss: 0.0002, Accuracy: 974/978 (99.5910%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   3,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   4,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   5,  Average loss: 0.0000, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Global model norm: 14.960995634678174.
Norm before scaling: 14.931163257779641. Distance: 1.1087009907656544
Total norm for 8 adversaries is: 14.931163257779641. distance: 1.1087009907656544
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.3100, Accuracy: 6230/8991 (69.2915%)
___Train Local_Simple,  epoch  22, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 199/202 (98.5149%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 3.4038, Accuracy: 4813/10000 (48.1300%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 666/678 (98.2301%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   2,  Average loss: 0.0007, Accuracy: 666/678 (98.2301%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   3,  Average loss: 0.0004, Accuracy: 672/678 (99.1150%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   4,  Average loss: 0.0003, Accuracy: 674/678 (99.4100%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   5,  Average loss: 0.0002, Accuracy: 675/678 (99.5575%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Global model norm: 14.960995634678174.
Norm before scaling: 14.958003445160376. Distance: 1.1833060138306823
Total norm for 8 adversaries is: 14.958003445160376. distance: 1.1833060138306823
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 2.9784, Accuracy: 4620/8991 (51.3847%)
___Train Local_Simple,  epoch  22, local model 96, internal_epoch   1,  Average loss: 0.0077, Accuracy: 455/505 (90.0990%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 3.5592, Accuracy: 2873/10000 (28.7300%), Attack Success Rate:1/10000(0.010)
time spent on training: 170.6122739315033
[foolsgold agg] training data poison_ratio: 0.7796134663341646  data num: [5, 179, 63, 28, 399, 171, 978, 202, 678, 505]
[foolsgold agg] considering poison per batch poison_fraction: 0.7796134663341646
[foolsgold agg] wv: [1.         0.85425674 0.         0.         0.81807265 0.73337682
 1.         0.81807265 0.73337682 1.        ]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.9031, Accuracy: 8614/10000 (86.1400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.1527, Accuracy: 8576/8991 (95.3843%)
Done in 550.9576470851898 sec.
Server Epoch:23 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0011, Accuracy: 690/704 (98.0114%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   2,  Average loss: 0.0003, Accuracy: 699/704 (99.2898%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   3,  Average loss: 0.0001, Accuracy: 703/704 (99.8580%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   4,  Average loss: 0.0001, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   5,  Average loss: 0.0001, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   6,  Average loss: 0.0001, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   7,  Average loss: 0.0001, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   8,  Average loss: 0.0001, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   9,  Average loss: 0.0000, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch  10,  Average loss: 0.0000, Accuracy: 704/704 (100.0000%), train_poison_data_count: 704
Global model norm: 14.96823214787947.
Norm before scaling: 14.945272171436702. Distance: 0.9692498425003172
Total norm for 6 adversaries is: 14.945272171436702. distance: 0.9692498425003172
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.9706, Accuracy: 6236/8991 (69.3582%)
___Train Local_Simple,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0013, Accuracy: 109/114 (95.6140%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.9633, Accuracy: 7965/10000 (79.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 85, internal_epoch   1,  Average loss: 0.0226, Accuracy: 4/4 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.1170, Accuracy: 7988/10000 (79.8800%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0029, Accuracy: 90/94 (95.7447%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   2,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   3,  Average loss: 0.0010, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   4,  Average loss: 0.0005, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   5,  Average loss: 0.0004, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   6,  Average loss: 0.0004, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   7,  Average loss: 0.0004, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   8,  Average loss: 0.0003, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   9,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Global model norm: 14.96823214787947.
Norm before scaling: 14.971538753790472. Distance: 0.48152774314041585
Total norm for 6 adversaries is: 14.971538753790472. distance: 0.48152774314041585
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.7958, Accuracy: 7069/8991 (78.6231%)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0019, Accuracy: 84/87 (96.5517%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   2,  Average loss: 0.0003, Accuracy: 87/87 (100.0000%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   3,  Average loss: 0.0004, Accuracy: 86/87 (98.8506%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   4,  Average loss: 0.0004, Accuracy: 86/87 (98.8506%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   5,  Average loss: 0.0003, Accuracy: 86/87 (98.8506%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   6,  Average loss: 0.0003, Accuracy: 86/87 (98.8506%), train_poison_data_count: 87
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   7,  Average loss: 0.0002, Accuracy: 87/87 (100.0000%), train_poison_data_count: 87
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   8,  Average loss: 0.0002, Accuracy: 87/87 (100.0000%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   9,  Average loss: 0.0001, Accuracy: 87/87 (100.0000%), train_poison_data_count: 87
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch  10,  Average loss: 0.0001, Accuracy: 87/87 (100.0000%), train_poison_data_count: 87
Global model norm: 14.96823214787947.
Norm before scaling: 14.976327654490216. Distance: 0.3285987249950997
Total norm for 6 adversaries is: 14.976327654490216. distance: 0.3285987249950997
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.3505, Accuracy: 8042/8991 (89.4450%)
poison local model 61 index 60 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 749/767 (97.6532%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   2,  Average loss: 0.0005, Accuracy: 755/767 (98.4355%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   3,  Average loss: 0.0003, Accuracy: 764/767 (99.6089%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   4,  Average loss: 0.0001, Accuracy: 766/767 (99.8696%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   5,  Average loss: 0.0001, Accuracy: 766/767 (99.8696%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   6,  Average loss: 0.0001, Accuracy: 766/767 (99.8696%), train_poison_data_count: 767
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   7,  Average loss: 0.0001, Accuracy: 766/767 (99.8696%), train_poison_data_count: 767
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   8,  Average loss: 0.0001, Accuracy: 766/767 (99.8696%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   9,  Average loss: 0.0001, Accuracy: 766/767 (99.8696%), train_poison_data_count: 767
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch  10,  Average loss: 0.0001, Accuracy: 766/767 (99.8696%), train_poison_data_count: 767
Global model norm: 14.96823214787947.
Norm before scaling: 14.95661144210406. Distance: 1.0463465025592473
Total norm for 6 adversaries is: 14.95661144210406. distance: 1.0463465025592473
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 2.2188, Accuracy: 5196/8991 (57.7911%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1284/1311 (97.9405%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1301/1311 (99.2372%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1308/1311 (99.7712%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Global model norm: 14.96823214787947.
Norm before scaling: 14.91537867833613. Distance: 1.9602105970515236
Total norm for 6 adversaries is: 14.91537867833613. distance: 1.9602105970515236
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 3.5044, Accuracy: 2638/8991 (29.3405%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0031, Accuracy: 34/34 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.9993, Accuracy: 8578/10000 (85.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0445, Accuracy: 41/69 (59.4203%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.2790, Accuracy: 7271/10000 (72.7100%), Attack Success Rate:0/10000(0.000)
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   1,  Average loss: 0.0015, Accuracy: 485/497 (97.5855%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   2,  Average loss: 0.0007, Accuracy: 491/497 (98.7928%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   3,  Average loss: 0.0002, Accuracy: 495/497 (99.5976%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   4,  Average loss: 0.0001, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   5,  Average loss: 0.0001, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   6,  Average loss: 0.0001, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   7,  Average loss: 0.0001, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   8,  Average loss: 0.0001, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   9,  Average loss: 0.0001, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch  10,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Global model norm: 14.96823214787947.
Norm before scaling: 14.98000172430418. Distance: 1.5619003671186649
Total norm for 6 adversaries is: 14.98000172430418. distance: 1.5619003671186649
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 4.7760, Accuracy: 3411/8991 (37.9379%)
time spent on training: 135.90048599243164
[foolsgold agg] training data poison_ratio: 0.9399619668568324  data num: [704, 114, 4, 94, 87, 767, 1311, 34, 69, 497]
[foolsgold agg] considering poison per batch poison_fraction: 0.9399619668568324
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.7238, Accuracy: 8619/10000 (86.1900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.1589, Accuracy: 8567/8991 (95.2842%)
Done in 480.51459097862244 sec.
Server Epoch:24 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   1,  Average loss: 0.0018, Accuracy: 294/304 (96.7105%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   2,  Average loss: 0.0003, Accuracy: 302/304 (99.3421%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   3,  Average loss: 0.0006, Accuracy: 298/304 (98.0263%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   4,  Average loss: 0.0003, Accuracy: 301/304 (99.0132%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   5,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   6,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   7,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   8,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Global model norm: 14.974272471795427.
Norm before scaling: 14.982554654321357. Distance: 0.7185876082365041
Total norm for 7 adversaries is: 14.982554654321357. distance: 0.7185876082365041
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 1.8826, Accuracy: 4714/8991 (52.4302%)
poison local model 65 index 64 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1293/1326 (97.5113%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1314/1326 (99.0950%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1316/1326 (99.2459%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1323/1326 (99.7738%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1324/1326 (99.8492%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Global model norm: 14.974272471795427.
Norm before scaling: 14.971617230939536. Distance: 1.49853762231489
Total norm for 7 adversaries is: 14.971617230939536. distance: 1.49853762231489
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 1.8837, Accuracy: 4612/8991 (51.2957%)
___Train Local_Simple,  epoch  24, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 474/505 (93.8614%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 5.0300, Accuracy: 3542/10000 (35.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 728/750 (97.0667%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.1322, Accuracy: 6746/10000 (67.4600%), Attack Success Rate:1/10000(0.010)
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   1,  Average loss: 0.0006, Accuracy: 2989/3022 (98.9080%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   2,  Average loss: 0.0001, Accuracy: 3019/3022 (99.9007%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   3,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   4,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   5,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   6,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   7,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   8,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   9,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch  10,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Global model norm: 14.974272471795427.
Norm before scaling: 14.761972514522958. Distance: 2.3763793152403814
Total norm for 7 adversaries is: 14.761972514522958. distance: 2.3763793152403814
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 5.8759, Accuracy: 1939/8991 (21.5660%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0010, Accuracy: 802/818 (98.0440%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   2,  Average loss: 0.0009, Accuracy: 801/818 (97.9218%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   3,  Average loss: 0.0004, Accuracy: 813/818 (99.3888%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   4,  Average loss: 0.0002, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 14.974272471795427.
Norm before scaling: 15.045880151107292. Distance: 1.7078104924838455
Total norm for 7 adversaries is: 15.045880151107292. distance: 1.7078104924838455
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 3.2122, Accuracy: 4069/8991 (45.2564%)
___Train Local_Simple,  epoch  24, local model 94, internal_epoch   1,  Average loss: 0.0015, Accuracy: 593/607 (97.6936%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.7775, Accuracy: 6098/10000 (60.9800%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0020, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   2,  Average loss: 0.0008, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   3,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   4,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   5,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   6,  Average loss: 0.0005, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   7,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   8,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   9,  Average loss: 0.0003, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch  10,  Average loss: 0.0003, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Global model norm: 14.974272471795427.
Norm before scaling: 14.983226298514616. Distance: 0.3509138162659908
Total norm for 7 adversaries is: 14.983226298514616. distance: 0.3509138162659908
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.2447, Accuracy: 8310/8991 (92.4258%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 695/705 (98.5816%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   3,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   4,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   5,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   6,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   7,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   8,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   9,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch  10,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Global model norm: 14.974272471795427.
Norm before scaling: 14.943441446358404. Distance: 1.2948874904848766
Total norm for 7 adversaries is: 14.943441446358404. distance: 1.2948874904848766
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 3.2408, Accuracy: 3836/8991 (42.6649%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   1,  Average loss: 0.0005, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 14.974272471795427.
Norm before scaling: 14.96775556538251. Distance: 0.25607594940808764
Total norm for 7 adversaries is: 14.96775556538251. distance: 0.25607594940808764
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.3675, Accuracy: 8010/8991 (89.0891%)
time spent on training: 196.97254586219788
[foolsgold agg] training data poison_ratio: 0.7760942760942761  data num: [304, 1326, 505, 750, 3022, 818, 607, 128, 705, 151]
[foolsgold agg] considering poison per batch poison_fraction: 0.7760942760942761
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.6762, Accuracy: 8633/10000 (86.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.1479, Accuracy: 8602/8991 (95.6735%)
Done in 569.3453633785248 sec.
Server Epoch:25 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0036, Accuracy: 361/388 (93.0412%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   2,  Average loss: 0.0017, Accuracy: 377/388 (97.1649%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   3,  Average loss: 0.0023, Accuracy: 370/388 (95.3608%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   4,  Average loss: 0.0009, Accuracy: 382/388 (98.4536%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   5,  Average loss: 0.0015, Accuracy: 384/388 (98.9691%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   6,  Average loss: 0.0006, Accuracy: 382/388 (98.4536%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   7,  Average loss: 0.0011, Accuracy: 377/388 (97.1649%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   8,  Average loss: 0.0006, Accuracy: 382/388 (98.4536%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   9,  Average loss: 0.0009, Accuracy: 386/388 (99.4845%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch  10,  Average loss: 0.0005, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Global model norm: 14.99349936450325.
Norm before scaling: 15.017751235549602. Distance: 1.458739560178976
Total norm for 10 adversaries is: 15.017751235549602. distance: 1.458739560178976
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.3349, Accuracy: 5848/8991 (65.0428%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1926/1982 (97.1746%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1957/1982 (98.7386%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1969/1982 (99.3441%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1973/1982 (99.5459%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1974/1982 (99.5964%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1977/1982 (99.7477%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1977/1982 (99.7477%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1977/1982 (99.7477%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1977/1982 (99.7477%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1977/1982 (99.7477%), train_poison_data_count: 1982
Global model norm: 14.99349936450325.
Norm before scaling: 15.015013746826302. Distance: 2.2111268518463736
Total norm for 10 adversaries is: 15.015013746826302. distance: 2.2111268518463736
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 3.4322, Accuracy: 3430/8991 (38.1493%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.0004, Accuracy: 973/978 (99.4888%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   2,  Average loss: 0.0004, Accuracy: 971/978 (99.2843%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   3,  Average loss: 0.0001, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   4,  Average loss: 0.0001, Accuracy: 977/978 (99.8978%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   5,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Global model norm: 14.99349936450325.
Norm before scaling: 14.9551779873331. Distance: 1.069469816283987
Total norm for 10 adversaries is: 14.9551779873331. distance: 1.069469816283987
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.3520, Accuracy: 6152/8991 (68.4240%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0031, Accuracy: 91/94 (96.8085%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   2,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   3,  Average loss: 0.0003, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   4,  Average loss: 0.0003, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   5,  Average loss: 0.0003, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   6,  Average loss: 0.0002, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   8,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   9,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Global model norm: 14.99349936450325.
Norm before scaling: 15.000846838888432. Distance: 0.49878537645336524
Total norm for 10 adversaries is: 15.000846838888432. distance: 0.49878537645336524
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.7559, Accuracy: 7123/8991 (79.2237%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0004, Accuracy: 2165/2180 (99.3119%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   3,  Average loss: 0.0000, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   4,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   5,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Global model norm: 14.99349936450325.
Norm before scaling: 14.771834941670088. Distance: 1.1164250473030992
Total norm for 10 adversaries is: 14.771834941670088. distance: 1.1164250473030992
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.6715, Accuracy: 5708/8991 (63.4857%)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1184/1205 (98.2573%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1198/1205 (99.4191%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1201/1205 (99.6680%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1202/1205 (99.7510%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1203/1205 (99.8340%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1203/1205 (99.8340%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Global model norm: 14.99349936450325.
Norm before scaling: 14.952881622725506. Distance: 1.3445379475366352
Total norm for 10 adversaries is: 14.952881622725506. distance: 1.3445379475366352
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.6395, Accuracy: 5989/8991 (66.6111%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0017, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   2,  Average loss: 0.0014, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   3,  Average loss: 0.0010, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   4,  Average loss: 0.0009, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   5,  Average loss: 0.0009, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   6,  Average loss: 0.0009, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   7,  Average loss: 0.0008, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   8,  Average loss: 0.0008, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   9,  Average loss: 0.0007, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch  10,  Average loss: 0.0007, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Global model norm: 14.99349936450325.
Norm before scaling: 14.994575536914226. Distance: 0.04501682591946662
Total norm for 10 adversaries is: 14.994575536914226. distance: 0.04501682591946662
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1519, Accuracy: 8596/8991 (95.6067%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 165/171 (96.4912%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   2,  Average loss: 0.0012, Accuracy: 168/171 (98.2456%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   3,  Average loss: 0.0004, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   4,  Average loss: 0.0003, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   5,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   6,  Average loss: 0.0002, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   7,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   8,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   9,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Global model norm: 14.99349936450325.
Norm before scaling: 14.997490227860315. Distance: 0.4949407470043608
Total norm for 10 adversaries is: 14.997490227860315. distance: 0.4949407470043608
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.9448, Accuracy: 6444/8991 (71.6717%)
poison local model 74 index 73 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0019, Accuracy: 732/762 (96.0630%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0010, Accuracy: 747/762 (98.0315%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 751/762 (98.5564%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 759/762 (99.6063%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0002, Accuracy: 759/762 (99.6063%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 760/762 (99.7375%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 760/762 (99.7375%), train_poison_data_count: 762
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 760/762 (99.7375%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 761/762 (99.8688%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 761/762 (99.8688%), train_poison_data_count: 762
Global model norm: 14.99349936450325.
Norm before scaling: 15.05801008110099. Distance: 1.6319859068813676
Total norm for 10 adversaries is: 15.05801008110099. distance: 1.6319859068813676
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.8578, Accuracy: 5946/8991 (66.1328%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0013, Accuracy: 983/1010 (97.3267%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   2,  Average loss: 0.0013, Accuracy: 983/1010 (97.3267%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   3,  Average loss: 0.0007, Accuracy: 997/1010 (98.7129%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1004/1010 (99.4059%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1005/1010 (99.5050%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   6,  Average loss: 0.0003, Accuracy: 1006/1010 (99.6040%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1006/1010 (99.6040%), train_poison_data_count: 1010
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1006/1010 (99.6040%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1007/1010 (99.7030%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1007/1010 (99.7030%), train_poison_data_count: 1010
Global model norm: 14.99349936450325.
Norm before scaling: 15.060320811305884. Distance: 1.4843190232815067
Total norm for 10 adversaries is: 15.060320811305884. distance: 1.4843190232815067
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.6533, Accuracy: 5319/8991 (59.1592%)
time spent on training: 259.81459975242615
[foolsgold agg] training data poison_ratio: 1.0  data num: [388, 1982, 978, 94, 2180, 1205, 6, 171, 762, 1010]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [1.         0.87973026 1.         1.         1.         1.
 1.         0.87973026 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.7855, Accuracy: 8655/10000 (86.5500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.1347, Accuracy: 8626/8991 (95.9404%)
Done in 614.1504981517792 sec.
Server Epoch:26 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1236/1259 (98.1732%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1255/1259 (99.6823%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Global model norm: 15.038303552278387.
Norm before scaling: 14.954628034765797. Distance: 1.0650334727261104
Total norm for 8 adversaries is: 14.954628034765797. distance: 1.0650334727261104
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.6557, Accuracy: 7345/8991 (81.6928%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0005, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 15.038303552278387.
Norm before scaling: 15.039215198088431. Distance: 0.0864792593680989
Total norm for 8 adversaries is: 15.039215198088431. distance: 0.0864792593680989
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1569, Accuracy: 8541/8991 (94.9950%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   1,  Average loss: 0.0020, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   2,  Average loss: 0.0003, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   3,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   4,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   5,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   6,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 15.038303552278387.
Norm before scaling: 15.041584609944692. Distance: 0.17655064365784956
Total norm for 8 adversaries is: 15.041584609944692. distance: 0.17655064365784956
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1486, Accuracy: 8574/8991 (95.3620%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0014, Accuracy: 451/463 (97.4082%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   2,  Average loss: 0.0011, Accuracy: 458/463 (98.9201%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   3,  Average loss: 0.0010, Accuracy: 456/463 (98.4881%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   4,  Average loss: 0.0004, Accuracy: 461/463 (99.5680%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   5,  Average loss: 0.0003, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   6,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   7,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   8,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   9,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch  10,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Global model norm: 15.038303552278387.
Norm before scaling: 15.031860085397055. Distance: 1.2308028479028978
Total norm for 8 adversaries is: 15.031860085397055. distance: 1.2308028479028978
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.4473, Accuracy: 5869/8991 (65.2764%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   1,  Average loss: 0.0011, Accuracy: 802/818 (98.0440%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   2,  Average loss: 0.0009, Accuracy: 803/818 (98.1663%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   3,  Average loss: 0.0006, Accuracy: 807/818 (98.6553%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 15.038303552278387.
Norm before scaling: 15.076696013892185. Distance: 1.5674699705614972
Total norm for 8 adversaries is: 15.076696013892185. distance: 1.5674699705614972
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 2.3417, Accuracy: 4245/8991 (47.2139%)
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0003, Accuracy: 3009/3022 (99.5698%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   2,  Average loss: 0.0001, Accuracy: 3017/3022 (99.8345%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   3,  Average loss: 0.0000, Accuracy: 3021/3022 (99.9669%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   4,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   5,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   6,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   7,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   8,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   9,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch  10,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Global model norm: 15.038303552278387.
Norm before scaling: 14.736908356080248. Distance: 1.7611924969265764
Total norm for 8 adversaries is: 14.736908356080248. distance: 1.7611924969265764
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 5.8725, Accuracy: 2195/8991 (24.4133%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 420/428 (98.1308%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   2,  Average loss: 0.0002, Accuracy: 425/428 (99.2991%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   3,  Average loss: 0.0001, Accuracy: 427/428 (99.7664%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   4,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   5,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 15.038303552278387.
Norm before scaling: 15.023399920324813. Distance: 0.8230865439988044
Total norm for 8 adversaries is: 15.023399920324813. distance: 0.8230865439988044
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 2.5381, Accuracy: 4936/8991 (54.8993%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0013, Accuracy: 989/1010 (97.9208%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   2,  Average loss: 0.0009, Accuracy: 994/1010 (98.4158%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1002/1010 (99.2079%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1004/1010 (99.4059%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1009/1010 (99.9010%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1008/1010 (99.8020%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1009/1010 (99.9010%), train_poison_data_count: 1010
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1009/1010 (99.9010%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1009/1010 (99.9010%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1009/1010 (99.9010%), train_poison_data_count: 1010
Global model norm: 15.038303552278387.
Norm before scaling: 15.086789629125096. Distance: 1.4618529852962325
Total norm for 8 adversaries is: 15.086789629125096. distance: 1.4618529852962325
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 2.1800, Accuracy: 5518/8991 (61.3725%)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0013, Accuracy: 591/607 (97.3641%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.7061, Accuracy: 4494/10000 (44.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 84, internal_epoch   1,  Average loss: 0.1442, Accuracy: 9/29 (31.0345%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.4203, Accuracy: 8113/10000 (81.1300%), Attack Success Rate:0/10000(0.000)
time spent on training: 193.0389120578766
[foolsgold agg] training data poison_ratio: 0.9175311203319502  data num: [1259, 48, 28, 463, 818, 3022, 428, 1010, 607, 29]
[foolsgold agg] considering poison per batch poison_fraction: 0.9175311203319502
[foolsgold agg] wv: [1.         0.         0.         0.80067601 0.79736091 0.
 1.         1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.4445, Accuracy: 8521/10000 (85.2100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.1931, Accuracy: 8496/8991 (94.4945%)
Done in 551.7605278491974 sec.
Server Epoch:27 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
poison local model 69 index 68 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.0037, Accuracy: 558/586 (95.2218%), train_poison_data_count: 586
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   2,  Average loss: 0.0010, Accuracy: 578/586 (98.6348%), train_poison_data_count: 586
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   3,  Average loss: 0.0005, Accuracy: 583/586 (99.4881%), train_poison_data_count: 586
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   4,  Average loss: 0.0004, Accuracy: 583/586 (99.4881%), train_poison_data_count: 586
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   5,  Average loss: 0.0004, Accuracy: 582/586 (99.3174%), train_poison_data_count: 586
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   6,  Average loss: 0.0003, Accuracy: 583/586 (99.4881%), train_poison_data_count: 586
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   7,  Average loss: 0.0003, Accuracy: 583/586 (99.4881%), train_poison_data_count: 586
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   8,  Average loss: 0.0003, Accuracy: 583/586 (99.4881%), train_poison_data_count: 586
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   9,  Average loss: 0.0011, Accuracy: 583/586 (99.4881%), train_poison_data_count: 586
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch  10,  Average loss: 0.0003, Accuracy: 583/586 (99.4881%), train_poison_data_count: 586
Global model norm: 15.04641662723429.
Norm before scaling: 15.21671201623271. Distance: 2.7743886256973673
Total norm for 9 adversaries is: 15.21671201623271. distance: 2.7743886256973673
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 3.2626, Accuracy: 3006/8991 (33.4334%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0038, Accuracy: 110/119 (92.4370%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   2,  Average loss: 0.0013, Accuracy: 115/119 (96.6387%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   3,  Average loss: 0.0006, Accuracy: 118/119 (99.1597%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   4,  Average loss: 0.0007, Accuracy: 117/119 (98.3193%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   5,  Average loss: 0.0005, Accuracy: 118/119 (99.1597%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   6,  Average loss: 0.0003, Accuracy: 118/119 (99.1597%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   7,  Average loss: 0.0002, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   8,  Average loss: 0.0002, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   9,  Average loss: 0.0002, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch  10,  Average loss: 0.0002, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Global model norm: 15.04641662723429.
Norm before scaling: 15.049471337040849. Distance: 0.5707467920828926
Total norm for 9 adversaries is: 15.049471337040849. distance: 0.5707467920828926
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 1.0470, Accuracy: 6403/8991 (71.2157%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   1,  Average loss: 0.0073, Accuracy: 56/63 (88.8889%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   4,  Average loss: 0.0002, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   5,  Average loss: 0.0003, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   6,  Average loss: 0.0003, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   7,  Average loss: 0.0003, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   8,  Average loss: 0.0003, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Global model norm: 15.04641662723429.
Norm before scaling: 15.073402859171608. Distance: 0.7620525313490081
Total norm for 9 adversaries is: 15.073402859171608. distance: 0.7620525313490081
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 1.6734, Accuracy: 6488/8991 (72.1610%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0030, Accuracy: 123/128 (96.0938%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   2,  Average loss: 0.0009, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   3,  Average loss: 0.0010, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   4,  Average loss: 0.0009, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   5,  Average loss: 0.0008, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   6,  Average loss: 0.0006, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   7,  Average loss: 0.0005, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   8,  Average loss: 0.0003, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   9,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch  10,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.04641662723429.
Norm before scaling: 15.056241203232695. Distance: 0.4541441046363115
Total norm for 9 adversaries is: 15.056241203232695. distance: 0.4541441046363115
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1990, Accuracy: 8433/8991 (93.7938%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0067, Accuracy: 83/94 (88.2979%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   3,  Average loss: 0.0038, Accuracy: 91/94 (96.8085%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   4,  Average loss: 0.0039, Accuracy: 91/94 (96.8085%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   5,  Average loss: 0.0030, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   6,  Average loss: 0.0012, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   7,  Average loss: 0.0009, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   8,  Average loss: 0.0007, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   9,  Average loss: 0.0005, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Global model norm: 15.04641662723429.
Norm before scaling: 15.094471284364094. Distance: 1.183002991750744
Total norm for 9 adversaries is: 15.094471284364094. distance: 1.183002991750744
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 2.5264, Accuracy: 5809/8991 (64.6091%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0013, Accuracy: 564/578 (97.5779%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   2,  Average loss: 0.0005, Accuracy: 574/578 (99.3080%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   3,  Average loss: 0.0003, Accuracy: 575/578 (99.4810%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   4,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   8,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 15.04641662723429.
Norm before scaling: 15.073471189192164. Distance: 0.9009428833778487
Total norm for 9 adversaries is: 15.073471189192164. distance: 0.9009428833778487
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.7563, Accuracy: 6771/8991 (75.3086%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   1,  Average loss: 0.0016, Accuracy: 374/388 (96.3918%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   2,  Average loss: 0.0034, Accuracy: 367/388 (94.5876%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   3,  Average loss: 0.0008, Accuracy: 383/388 (98.7113%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   4,  Average loss: 0.0006, Accuracy: 385/388 (99.2268%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   5,  Average loss: 0.0005, Accuracy: 384/388 (98.9691%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   6,  Average loss: 0.0004, Accuracy: 383/388 (98.7113%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   7,  Average loss: 0.0004, Accuracy: 385/388 (99.2268%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   8,  Average loss: 0.0006, Accuracy: 385/388 (99.2268%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   9,  Average loss: 0.0003, Accuracy: 385/388 (99.2268%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch  10,  Average loss: 0.0003, Accuracy: 385/388 (99.2268%), train_poison_data_count: 388
Global model norm: 15.04641662723429.
Norm before scaling: 15.057772959148302. Distance: 1.3864241166147468
Total norm for 9 adversaries is: 15.057772959148302. distance: 1.3864241166147468
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 1.6928, Accuracy: 5995/8991 (66.6778%)
poison local model 54 index 53 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   1,  Average loss: 0.0038, Accuracy: 86/91 (94.5055%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   2,  Average loss: 0.0037, Accuracy: 85/91 (93.4066%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   3,  Average loss: 0.0028, Accuracy: 84/91 (92.3077%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   4,  Average loss: 0.0016, Accuracy: 87/91 (95.6044%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   5,  Average loss: 0.0007, Accuracy: 90/91 (98.9011%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   6,  Average loss: 0.0004, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   7,  Average loss: 0.0004, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   8,  Average loss: 0.0004, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   9,  Average loss: 0.0005, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch  10,  Average loss: 0.0004, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Global model norm: 15.04641662723429.
Norm before scaling: 15.056417542978663. Distance: 0.423196876258625
Total norm for 9 adversaries is: 15.056417542978663. distance: 0.423196876258625
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2372, Accuracy: 8335/8991 (92.7038%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   1,  Average loss: 0.0018, Accuracy: 795/818 (97.1883%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   2,  Average loss: 0.0003, Accuracy: 811/818 (99.1443%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   3,  Average loss: 0.0002, Accuracy: 814/818 (99.5110%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 15.04641662723429.
Norm before scaling: 15.144829480233561. Distance: 1.9263069719705765
Total norm for 9 adversaries is: 15.144829480233561. distance: 1.9263069719705765
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 3.6526, Accuracy: 4184/8991 (46.5354%)
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0006, Accuracy: 296/300 (98.6667%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.9476, Accuracy: 7268/10000 (72.6800%), Attack Success Rate:0/10000(0.000)
time spent on training: 136.88237881660461
[foolsgold agg] training data poison_ratio: 0.9052132701421801  data num: [586, 119, 63, 128, 94, 578, 388, 91, 818, 300]
[foolsgold agg] considering poison per batch poison_fraction: 0.9052132701421801
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.5415, Accuracy: 8495/10000 (84.9500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.2230, Accuracy: 8370/8991 (93.0931%)
Done in 479.1991710662842 sec.
Server Epoch:28 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   1,  Average loss: 0.0016, Accuracy: 624/644 (96.8944%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 635/644 (98.6025%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   3,  Average loss: 0.0003, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   4,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   5,  Average loss: 0.0002, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   7,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   8,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   9,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 15.071477343687615.
Norm before scaling: 15.133191121199197. Distance: 1.7580210244155179
Total norm for 8 adversaries is: 15.133191121199197. distance: 1.7580210244155179
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 2.7938, Accuracy: 5442/8991 (60.5272%)
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0011, Accuracy: 251/259 (96.9112%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 257/259 (99.2278%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 258/259 (99.6139%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 258/259 (99.6139%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 258/259 (99.6139%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Global model norm: 15.071477343687615.
Norm before scaling: 15.06823165552645. Distance: 0.7638810595679516
Total norm for 8 adversaries is: 15.06823165552645. distance: 0.7638810595679516
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.5115, Accuracy: 6150/8991 (68.4017%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0035, Accuracy: 90/94 (95.7447%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   2,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   3,  Average loss: 0.0003, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   4,  Average loss: 0.0002, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   5,  Average loss: 0.0002, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   6,  Average loss: 0.0002, Accuracy: 93/94 (98.9362%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   7,  Average loss: 0.0003, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   8,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   9,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Global model norm: 15.071477343687615.
Norm before scaling: 15.082113199078062. Distance: 0.546626579537106
Total norm for 8 adversaries is: 15.082113199078062. distance: 0.546626579537106
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.7547, Accuracy: 7155/8991 (79.5796%)
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0006, Accuracy: 2994/3022 (99.0735%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   2,  Average loss: 0.0000, Accuracy: 3019/3022 (99.9007%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   3,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   4,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   5,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   6,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   7,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   8,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   9,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch  10,  Average loss: 0.0000, Accuracy: 3022/3022 (100.0000%), train_poison_data_count: 3022
Global model norm: 15.071477343687615.
Norm before scaling: 15.076974838742881. Distance: 3.545506688159148
Total norm for 8 adversaries is: 15.076974838742881. distance: 3.545506688159148
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 7.5667, Accuracy: 1932/8991 (21.4882%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1912/1982 (96.4682%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1961/1982 (98.9405%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1972/1982 (99.4955%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1974/1982 (99.5964%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1975/1982 (99.6468%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1977/1982 (99.7477%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1977/1982 (99.7477%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1978/1982 (99.7982%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1979/1982 (99.8486%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1979/1982 (99.8486%), train_poison_data_count: 1982
Global model norm: 15.071477343687615.
Norm before scaling: 15.090722453706604. Distance: 2.22547077384824
Total norm for 8 adversaries is: 15.090722453706604. distance: 2.22547077384824
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 3.5310, Accuracy: 3262/8991 (36.2807%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.0119, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   2,  Average loss: 0.0023, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   3,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   4,  Average loss: 0.0008, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   5,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   6,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   7,  Average loss: 0.0006, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   8,  Average loss: 0.0006, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   9,  Average loss: 0.0005, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch  10,  Average loss: 0.0005, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 15.071477343687615.
Norm before scaling: 15.077124622740518. Distance: 0.19013791350864614
Total norm for 8 adversaries is: 15.077124622740518. distance: 0.19013791350864614
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.2007, Accuracy: 8473/8991 (94.2387%)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0019, Accuracy: 111/114 (97.3684%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6875, Accuracy: 7893/10000 (78.9300%), Attack Success Rate:0/10000(0.000)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   1,  Average loss: 0.0005, Accuracy: 967/978 (98.8753%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 976/978 (99.7955%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   3,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   4,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   5,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 978/978 (100.0000%), train_poison_data_count: 978
Global model norm: 15.071477343687615.
Norm before scaling: 15.002349669484069. Distance: 1.0118830484844183
Total norm for 8 adversaries is: 15.002349669484069. distance: 1.0118830484844183
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.9866, Accuracy: 5923/8991 (65.8770%)
poison local model 80 index 79 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   1,  Average loss: 0.0034, Accuracy: 79/84 (94.0476%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   3,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   4,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   5,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   6,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   7,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   8,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   9,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch  10,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 15.071477343687615.
Norm before scaling: 15.073972772675662. Distance: 0.5754679372192907
Total norm for 8 adversaries is: 15.073972772675662. distance: 0.5754679372192907
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.4173, Accuracy: 5476/8991 (60.9053%)
___Train Local_Simple,  epoch  28, local model 81, internal_epoch   1,  Average loss: 0.0013, Accuracy: 66/68 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.5278, Accuracy: 8544/10000 (85.4400%), Attack Success Rate:0/10000(0.000)
time spent on training: 184.17862510681152
[foolsgold agg] training data poison_ratio: 0.9748965517241379  data num: [644, 259, 94, 3022, 1982, 5, 114, 978, 84, 68]
[foolsgold agg] considering poison per batch poison_fraction: 0.9748965517241379
[foolsgold agg] wv: [0.96723866 1.         1.         0.96723866 1.         0.79776449
 0.79776449 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.6417, Accuracy: 8632/10000 (86.3200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.1474, Accuracy: 8583/8991 (95.4621%)
Done in 540.7977449893951 sec.
Server Epoch:29 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
poison local model 58 index 57 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   1,  Average loss: 0.0022, Accuracy: 972/1015 (95.7635%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   2,  Average loss: 0.0015, Accuracy: 986/1015 (97.1429%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   3,  Average loss: 0.0007, Accuracy: 1002/1015 (98.7192%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   4,  Average loss: 0.0004, Accuracy: 1008/1015 (99.3103%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   5,  Average loss: 0.0004, Accuracy: 1009/1015 (99.4089%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   6,  Average loss: 0.0004, Accuracy: 1010/1015 (99.5074%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   7,  Average loss: 0.0003, Accuracy: 1010/1015 (99.5074%), train_poison_data_count: 1015
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   8,  Average loss: 0.0003, Accuracy: 1010/1015 (99.5074%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1011/1015 (99.6059%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1010/1015 (99.5074%), train_poison_data_count: 1015
Global model norm: 15.09329305079536.
Norm before scaling: 15.222086389930258. Distance: 1.920867593863806
Total norm for 8 adversaries is: 15.222086389930258. distance: 1.920867593863806
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 1.6150, Accuracy: 5178/8991 (57.5909%)
___Train Local_Simple,  epoch  29, local model 90, internal_epoch   1,  Average loss: 0.0009, Accuracy: 756/768 (98.4375%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.2686, Accuracy: 4912/10000 (49.1200%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0009, Accuracy: 805/818 (98.4108%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   2,  Average loss: 0.0002, Accuracy: 815/818 (99.6333%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   3,  Average loss: 0.0002, Accuracy: 815/818 (99.6333%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   6,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   7,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   8,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 15.09329305079536.
Norm before scaling: 15.099092347610823. Distance: 1.4090097262748695
Total norm for 8 adversaries is: 15.099092347610823. distance: 1.4090097262748695
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 3.0676, Accuracy: 4728/8991 (52.5859%)
poison local model 72 index 71 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.0390, Accuracy: 9/10 (90.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   2,  Average loss: 0.0017, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   3,  Average loss: 0.0048, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   4,  Average loss: 0.0034, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   5,  Average loss: 0.0015, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   6,  Average loss: 0.0006, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   7,  Average loss: 0.0002, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   8,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   9,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch  10,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Global model norm: 15.09329305079536.
Norm before scaling: 15.092674833115701. Distance: 0.4208924543128065
Total norm for 8 adversaries is: 15.092674833115701. distance: 0.4208924543128065
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.5497, Accuracy: 7732/8991 (85.9971%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0021, Accuracy: 488/509 (95.8743%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 504/509 (99.0177%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 506/509 (99.4106%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Global model norm: 15.09329305079536.
Norm before scaling: 15.133273297385447. Distance: 1.3069849401684817
Total norm for 8 adversaries is: 15.133273297385447. distance: 1.3069849401684817
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 2.5962, Accuracy: 3493/8991 (38.8500%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   2,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   3,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   4,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   5,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   6,  Average loss: 0.0003, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   7,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   8,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   9,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch  10,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.09329305079536.
Norm before scaling: 15.100240318962797. Distance: 0.309791546058161
Total norm for 8 adversaries is: 15.100240318962797. distance: 0.309791546058161
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1920, Accuracy: 8448/8991 (93.9606%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0018, Accuracy: 960/994 (96.5795%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   2,  Average loss: 0.0009, Accuracy: 982/994 (98.7928%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   3,  Average loss: 0.0006, Accuracy: 986/994 (99.1952%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   4,  Average loss: 0.0004, Accuracy: 987/994 (99.2958%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   5,  Average loss: 0.0002, Accuracy: 988/994 (99.3964%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   6,  Average loss: 0.0002, Accuracy: 990/994 (99.5976%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   7,  Average loss: 0.0002, Accuracy: 991/994 (99.6982%), train_poison_data_count: 994
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   8,  Average loss: 0.0002, Accuracy: 991/994 (99.6982%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   9,  Average loss: 0.0001, Accuracy: 992/994 (99.7988%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch  10,  Average loss: 0.0002, Accuracy: 992/994 (99.7988%), train_poison_data_count: 994
Global model norm: 15.09329305079536.
Norm before scaling: 15.143638539268158. Distance: 1.4187193846235127
Total norm for 8 adversaries is: 15.143638539268158. distance: 1.4187193846235127
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.5337, Accuracy: 7555/8991 (84.0285%)
___Train Local_Simple,  epoch  29, local model 91, internal_epoch   1,  Average loss: 0.0006, Accuracy: 179/182 (98.3516%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.7488, Accuracy: 8292/10000 (82.9200%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0013, Accuracy: 149/151 (98.6755%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 15.09329305079536.
Norm before scaling: 15.093557415793905. Distance: 0.5414116577054517
Total norm for 8 adversaries is: 15.093557415793905. distance: 0.5414116577054517
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 1.0887, Accuracy: 6713/8991 (74.6636%)
poison local model 57 index 56 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1390/1437 (96.7293%), train_poison_data_count: 1437
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   2,  Average loss: 0.0010, Accuracy: 1400/1437 (97.4252%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1426/1437 (99.2345%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1428/1437 (99.3737%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   5,  Average loss: 0.0003, Accuracy: 1431/1437 (99.5825%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1431/1437 (99.5825%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1433/1437 (99.7216%), train_poison_data_count: 1437
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1433/1437 (99.7216%), train_poison_data_count: 1437
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   9,  Average loss: 0.0002, Accuracy: 1434/1437 (99.7912%), train_poison_data_count: 1437
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1435/1437 (99.8608%), train_poison_data_count: 1437
Global model norm: 15.09329305079536.
Norm before scaling: 15.151622702939331. Distance: 2.024874850514916
Total norm for 8 adversaries is: 15.151622702939331. distance: 2.024874850514916
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 1.4531, Accuracy: 6112/8991 (67.9791%)
time spent on training: 165.49598908424377
[foolsgold agg] training data poison_ratio: 0.8419827012641384  data num: [1015, 768, 818, 10, 509, 128, 994, 182, 151, 1437]
[foolsgold agg] considering poison per batch poison_fraction: 0.8419827012641384
[foolsgold agg] wv: [0.72675864 0.89356212 1.         0.89356212 1.         1.
 1.         0.72675864 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.7209, Accuracy: 8630/10000 (86.3000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.1453, Accuracy: 8598/8991 (95.6290%)
Done in 531.5169100761414 sec.
Server Epoch:30 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   1,  Average loss: 0.0005, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 15.129974808151946.
Norm before scaling: 15.125142246554761. Distance: 0.32898740741217225
Total norm for 10 adversaries is: 15.125142246554761. distance: 0.32898740741217225
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.4456, Accuracy: 7875/8991 (87.5876%)
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1522/1544 (98.5751%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1537/1544 (99.5466%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Global model norm: 15.129974808151946.
Norm before scaling: 15.067844313337478. Distance: 1.6202326314401647
Total norm for 10 adversaries is: 15.067844313337478. distance: 1.6202326314401647
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.1508, Accuracy: 6128/8991 (68.1570%)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1183/1205 (98.1743%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1199/1205 (99.5021%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1203/1205 (99.8340%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Global model norm: 15.129974808151946.
Norm before scaling: 15.075186424304645. Distance: 1.3830532575601275
Total norm for 10 adversaries is: 15.075186424304645. distance: 1.3830532575601275
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.4228, Accuracy: 6247/8991 (69.4806%)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   1,  Average loss: 0.0009, Accuracy: 2041/2072 (98.5039%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   2,  Average loss: 0.0004, Accuracy: 2056/2072 (99.2278%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2066/2072 (99.7104%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2067/2072 (99.7587%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2067/2072 (99.7587%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2069/2072 (99.8552%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2069/2072 (99.8552%), train_poison_data_count: 2072
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2070/2072 (99.9035%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2070/2072 (99.9035%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2070/2072 (99.9035%), train_poison_data_count: 2072
Global model norm: 15.129974808151946.
Norm before scaling: 14.990547253453018. Distance: 1.8311273423085572
Total norm for 10 adversaries is: 14.990547253453018. distance: 1.8311273423085572
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 2.2521, Accuracy: 4221/8991 (46.9469%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 669/688 (97.2384%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   2,  Average loss: 0.0006, Accuracy: 681/688 (98.9826%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   3,  Average loss: 0.0004, Accuracy: 682/688 (99.1279%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 15.129974808151946.
Norm before scaling: 15.146787477826363. Distance: 1.3413911119872155
Total norm for 10 adversaries is: 15.146787477826363. distance: 1.3413911119872155
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 2.5002, Accuracy: 4557/8991 (50.6840%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0010, Accuracy: 169/171 (98.8304%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 170/171 (99.4152%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   3,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   4,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   5,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   6,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   7,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   8,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   9,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 171/171 (100.0000%), train_poison_data_count: 171
Global model norm: 15.129974808151946.
Norm before scaling: 15.127325210280175. Distance: 0.3297845787922122
Total norm for 10 adversaries is: 15.127325210280175. distance: 0.3297845787922122
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.4125, Accuracy: 7797/8991 (86.7201%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0010, Accuracy: 425/436 (97.4771%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   3,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   5,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   6,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Global model norm: 15.129974808151946.
Norm before scaling: 15.154215190405255. Distance: 0.9283826630896154
Total norm for 10 adversaries is: 15.154215190405255. distance: 0.9283826630896154
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.2653, Accuracy: 6637/8991 (73.8183%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   1,  Average loss: 0.0003, Accuracy: 701/705 (99.4326%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 702/705 (99.5745%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   3,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   4,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   5,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   6,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   7,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   8,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   9,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch  10,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Global model norm: 15.129974808151946.
Norm before scaling: 15.080562161356553. Distance: 1.047682607206842
Total norm for 10 adversaries is: 15.080562161356553. distance: 1.047682607206842
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 2.8015, Accuracy: 4476/8991 (49.7831%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 380/388 (97.9381%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   2,  Average loss: 0.0024, Accuracy: 375/388 (96.6495%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   3,  Average loss: 0.0009, Accuracy: 382/388 (98.4536%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   4,  Average loss: 0.0004, Accuracy: 384/388 (98.9691%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   5,  Average loss: 0.0003, Accuracy: 386/388 (99.4845%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   6,  Average loss: 0.0002, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   7,  Average loss: 0.0002, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Global model norm: 15.129974808151946.
Norm before scaling: 15.096191714219216. Distance: 0.9540820085597003
Total norm for 10 adversaries is: 15.096191714219216. distance: 0.9540820085597003
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.2525, Accuracy: 6188/8991 (68.8244%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   1,  Average loss: 0.0009, Accuracy: 806/818 (98.5330%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 816/818 (99.7555%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   3,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   4,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   5,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   6,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   7,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   8,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 15.129974808151946.
Norm before scaling: 15.120260709906654. Distance: 1.333492026223314
Total norm for 10 adversaries is: 15.120260709906654. distance: 1.333492026223314
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 3.2185, Accuracy: 4617/8991 (51.3514%)
time spent on training: 222.23991703987122
[foolsgold agg] training data poison_ratio: 1.0  data num: [151, 1544, 1205, 2072, 688, 171, 436, 705, 388, 818]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [1.         0.83192848 1.         1.         1.         1.
 0.37318491 0.37318491 1.         0.83192848]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.7881, Accuracy: 8679/10000 (86.7900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.1282, Accuracy: 8648/8991 (96.1851%)
Done in 573.8208348751068 sec.
Server Epoch:31 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
poison local model 74 index 73 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0015, Accuracy: 741/762 (97.2441%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   2,  Average loss: 0.0017, Accuracy: 735/762 (96.4567%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   3,  Average loss: 0.0006, Accuracy: 754/762 (98.9501%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   4,  Average loss: 0.0003, Accuracy: 759/762 (99.6063%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   5,  Average loss: 0.0003, Accuracy: 759/762 (99.6063%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   6,  Average loss: 0.0002, Accuracy: 759/762 (99.6063%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   7,  Average loss: 0.0002, Accuracy: 759/762 (99.6063%), train_poison_data_count: 762
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   8,  Average loss: 0.0002, Accuracy: 759/762 (99.6063%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   9,  Average loss: 0.0002, Accuracy: 760/762 (99.7375%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch  10,  Average loss: 0.0002, Accuracy: 760/762 (99.7375%), train_poison_data_count: 762
Global model norm: 15.153142299787763.
Norm before scaling: 15.212459196162923. Distance: 1.686676248188974
Total norm for 8 adversaries is: 15.212459196162923. distance: 1.686676248188974
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.3110, Accuracy: 6338/8991 (70.4927%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0026, Accuracy: 252/263 (95.8175%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   2,  Average loss: 0.0007, Accuracy: 259/263 (98.4791%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   3,  Average loss: 0.0006, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   4,  Average loss: 0.0006, Accuracy: 262/263 (99.6198%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   5,  Average loss: 0.0001, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   6,  Average loss: 0.0001, Accuracy: 262/263 (99.6198%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   7,  Average loss: 0.0001, Accuracy: 262/263 (99.6198%), train_poison_data_count: 263
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   8,  Average loss: 0.0001, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   9,  Average loss: 0.0001, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch  10,  Average loss: 0.0000, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Global model norm: 15.153142299787763.
Norm before scaling: 15.169064733936096. Distance: 1.3383910197030253
Total norm for 8 adversaries is: 15.169064733936096. distance: 1.3383910197030253
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 2.8891, Accuracy: 4621/8991 (51.3958%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0001, Accuracy: 411/411 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.1886, Accuracy: 7826/10000 (78.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 85, internal_epoch   1,  Average loss: 0.0094, Accuracy: 4/4 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.8376, Accuracy: 8558/10000 (85.5800%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 453/463 (97.8402%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   2,  Average loss: 0.0020, Accuracy: 452/463 (97.6242%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   3,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   4,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   5,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   6,  Average loss: 0.0002, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   7,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   8,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   9,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch  10,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Global model norm: 15.153142299787763.
Norm before scaling: 15.13232597549732. Distance: 1.3780616140169415
Total norm for 8 adversaries is: 15.13232597549732. distance: 1.3780616140169415
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.5127, Accuracy: 4792/8991 (53.2977%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0048, Accuracy: 81/84 (96.4286%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 83/84 (98.8095%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   3,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   4,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   5,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   6,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   7,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   8,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   9,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 15.153142299787763.
Norm before scaling: 15.153893482234142. Distance: 0.5500650280743847
Total norm for 8 adversaries is: 15.153893482234142. distance: 0.5500650280743847
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.5301, Accuracy: 7568/8991 (84.1731%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   2,  Average loss: 0.0010, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   3,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   4,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   5,  Average loss: 0.0007, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   6,  Average loss: 0.0006, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   7,  Average loss: 0.0006, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   8,  Average loss: 0.0005, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   9,  Average loss: 0.0005, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch  10,  Average loss: 0.0005, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 15.153142299787763.
Norm before scaling: 15.153050665064372. Distance: 0.03490727898053113
Total norm for 8 adversaries is: 15.153050665064372. distance: 0.03490727898053113
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1242, Accuracy: 8662/8991 (96.3408%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0008, Accuracy: 61/63 (96.8254%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   2,  Average loss: 0.0003, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   3,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Global model norm: 15.153142299787763.
Norm before scaling: 15.154152762436626. Distance: 0.15061860948476366
Total norm for 8 adversaries is: 15.154152762436626. distance: 0.15061860948476366
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1518, Accuracy: 8543/8991 (95.0172%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0005, Accuracy: 421/428 (98.3645%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   3,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   4,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   5,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 15.153142299787763.
Norm before scaling: 15.131734562473023. Distance: 0.670475922517054
Total norm for 8 adversaries is: 15.131734562473023. distance: 0.670475922517054
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.8938, Accuracy: 5429/8991 (60.3826%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   1,  Average loss: 0.0014, Accuracy: 124/128 (96.8750%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   2,  Average loss: 0.0007, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   3,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   4,  Average loss: 0.0004, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   5,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   6,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   7,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   8,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   9,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch  10,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.153142299787763.
Norm before scaling: 15.156608404267509. Distance: 0.30792315570891904
Total norm for 8 adversaries is: 15.156608404267509. distance: 0.30792315570891904
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1722, Accuracy: 8506/8991 (94.6057%)
time spent on training: 164.83270621299744
[foolsgold agg] training data poison_ratio: 0.8410570662581387  data num: [762, 263, 411, 4, 463, 84, 5, 63, 428, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.8410570662581387
[foolsgold agg] wv: [0.83383244 0.83383244 1.         0.60563523 1.         1.
 0.60563523 1.         1.         0.937372  ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.8775, Accuracy: 8653/10000 (86.5300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.1341, Accuracy: 8615/8991 (95.8180%)
Done in 546.2821922302246 sec.
Server Epoch:32 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0016, Accuracy: 29/30 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9252, Accuracy: 8512/10000 (85.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.0004, Accuracy: 33/33 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.8612, Accuracy: 8676/10000 (86.7600%), Attack Success Rate:0/10000(0.000)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   1,  Average loss: 0.0016, Accuracy: 2723/2803 (97.1459%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   2,  Average loss: 0.0007, Accuracy: 2760/2803 (98.4659%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   3,  Average loss: 0.0003, Accuracy: 2785/2803 (99.3578%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   4,  Average loss: 0.0002, Accuracy: 2795/2803 (99.7146%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   5,  Average loss: 0.0002, Accuracy: 2796/2803 (99.7503%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2798/2803 (99.8216%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2799/2803 (99.8573%), train_poison_data_count: 2803
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2800/2803 (99.8930%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2802/2803 (99.9643%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2802/2803 (99.9643%), train_poison_data_count: 2803
Global model norm: 15.165852507372957.
Norm before scaling: 15.239746148505835. Distance: 2.398631035268507
Total norm for 5 adversaries is: 15.239746148505835. distance: 2.398631035268507
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 2.1557, Accuracy: 5123/8991 (56.9792%)
poison local model 70 index 69 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   1,  Average loss: 0.0014, Accuracy: 550/569 (96.6608%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   2,  Average loss: 0.0003, Accuracy: 566/569 (99.4728%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   3,  Average loss: 0.0003, Accuracy: 564/569 (99.1213%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   4,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   5,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   6,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   7,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   8,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   9,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch  10,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Global model norm: 15.165852507372957.
Norm before scaling: 15.20229645497294. Distance: 0.9668919372061455
Total norm for 5 adversaries is: 15.20229645497294. distance: 0.9668919372061455
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.5920, Accuracy: 7438/8991 (82.7272%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0016, Accuracy: 998/1033 (96.6118%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1017/1033 (98.4511%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1023/1033 (99.0319%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1031/1033 (99.8064%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Global model norm: 15.165852507372957.
Norm before scaling: 15.237688441750329. Distance: 1.744380374846862
Total norm for 5 adversaries is: 15.237688441750329. distance: 1.744380374846862
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 2.3963, Accuracy: 4350/8991 (48.3817%)
___Train Local_Simple,  epoch  32, local model 90, internal_epoch   1,  Average loss: 0.0005, Accuracy: 762/768 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 4.0246, Accuracy: 4176/10000 (41.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 91, internal_epoch   1,  Average loss: 0.0006, Accuracy: 179/182 (98.3516%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9897, Accuracy: 8217/10000 (82.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 86, internal_epoch   1,  Average loss: 0.0019, Accuracy: 34/34 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.8619, Accuracy: 8640/10000 (86.4000%), Attack Success Rate:0/10000(0.000)
poison local model 67 index 66 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   1,  Average loss: 0.0015, Accuracy: 551/568 (97.0070%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   2,  Average loss: 0.0010, Accuracy: 554/568 (97.5352%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   3,  Average loss: 0.0007, Accuracy: 559/568 (98.4155%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   4,  Average loss: 0.0004, Accuracy: 562/568 (98.9437%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   5,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   6,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   7,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   8,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Global model norm: 15.165852507372957.
Norm before scaling: 15.18196563981346. Distance: 1.174088282643462
Total norm for 5 adversaries is: 15.18196563981346. distance: 1.174088282643462
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.3011, Accuracy: 8107/8991 (90.1679%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0004, Accuracy: 2169/2180 (99.4954%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   2,  Average loss: 0.0001, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   3,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   4,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   5,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Global model norm: 15.165852507372957.
Norm before scaling: 14.933507409670627. Distance: 1.1184030602250914
Total norm for 5 adversaries is: 14.933507409670627. distance: 1.1184030602250914
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 1.2215, Accuracy: 6226/8991 (69.2470%)
time spent on training: 167.09802794456482
[foolsgold agg] training data poison_ratio: 0.8723170731707317  data num: [30, 33, 2803, 569, 1033, 768, 182, 34, 568, 2180]
[foolsgold agg] considering poison per batch poison_fraction: 0.8723170731707317
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.9267, Accuracy: 8701/10000 (87.0100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.1202, Accuracy: 8675/8991 (96.4854%)
Done in 515.9113478660583 sec.
Server Epoch:33 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1516/1544 (98.1865%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1528/1544 (98.9637%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1540/1544 (99.7409%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Global model norm: 15.209255632974932.
Norm before scaling: 15.192020952142988. Distance: 1.7635191115146005
Total norm for 8 adversaries is: 15.192020952142988. distance: 1.7635191115146005
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.8255, Accuracy: 6769/8991 (75.2864%)
poison local model 57 index 56 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1385/1437 (96.3814%), train_poison_data_count: 1437
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1410/1437 (98.1211%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   3,  Average loss: 0.0005, Accuracy: 1418/1437 (98.6778%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1432/1437 (99.6521%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1433/1437 (99.7216%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1433/1437 (99.7216%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1435/1437 (99.8608%), train_poison_data_count: 1437
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1436/1437 (99.9304%), train_poison_data_count: 1437
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1436/1437 (99.9304%), train_poison_data_count: 1437
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1436/1437 (99.9304%), train_poison_data_count: 1437
Global model norm: 15.209255632974932.
Norm before scaling: 15.241362079617168. Distance: 2.1110953768205167
Total norm for 8 adversaries is: 15.241362079617168. distance: 2.1110953768205167
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 1.7166, Accuracy: 5508/8991 (61.2613%)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   1,  Average loss: 0.0008, Accuracy: 2044/2072 (98.6486%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   2,  Average loss: 0.0003, Accuracy: 2059/2072 (99.3726%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2068/2072 (99.8069%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2071/2072 (99.9517%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   6,  Average loss: 0.0000, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Global model norm: 15.209255632974932.
Norm before scaling: 15.042050738023503. Distance: 1.6179753103081782
Total norm for 8 adversaries is: 15.042050738023503. distance: 1.6179753103081782
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 1.3873, Accuracy: 5758/8991 (64.0418%)
poison local model 67 index 66 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.0015, Accuracy: 549/568 (96.6549%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   2,  Average loss: 0.0009, Accuracy: 555/568 (97.7113%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   3,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   4,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   5,  Average loss: 0.0002, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Global model norm: 15.209255632974932.
Norm before scaling: 15.212714970620588. Distance: 1.1479215436071426
Total norm for 8 adversaries is: 15.212714970620588. distance: 1.1479215436071426
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.2588, Accuracy: 8240/8991 (91.6472%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0008, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   4,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   5,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   6,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 15.209255632974932.
Norm before scaling: 15.210227256145576. Distance: 0.13434522126939047
Total norm for 8 adversaries is: 15.210227256145576. distance: 0.13434522126939047
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.1400, Accuracy: 8620/8991 (95.8737%)
___Train Local_Simple,  epoch  33, local model 97, internal_epoch   1,  Average loss: 0.0003, Accuracy: 5/5 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.9356, Accuracy: 8701/10000 (87.0100%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0016, Accuracy: 231/237 (97.4684%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   2,  Average loss: 0.0009, Accuracy: 230/237 (97.0464%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   3,  Average loss: 0.0004, Accuracy: 235/237 (99.1561%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   4,  Average loss: 0.0005, Accuracy: 235/237 (99.1561%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   5,  Average loss: 0.0004, Accuracy: 235/237 (99.1561%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   6,  Average loss: 0.0003, Accuracy: 235/237 (99.1561%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   7,  Average loss: 0.0002, Accuracy: 236/237 (99.5781%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Global model norm: 15.209255632974932.
Norm before scaling: 15.208277426142246. Distance: 0.7674380652696416
Total norm for 8 adversaries is: 15.208277426142246. distance: 0.7674380652696416
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 1.3378, Accuracy: 6578/8991 (73.1621%)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   1,  Average loss: 0.0003, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   3,  Average loss: 0.0001, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   4,  Average loss: 0.0001, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   5,  Average loss: 0.0001, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   6,  Average loss: 0.0001, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   7,  Average loss: 0.0001, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   8,  Average loss: 0.0001, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   9,  Average loss: 0.0001, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch  10,  Average loss: 0.0001, Accuracy: 34/34 (100.0000%), train_poison_data_count: 34
Global model norm: 15.209255632974932.
Norm before scaling: 15.208987259414457. Distance: 0.0452766352570015
Total norm for 8 adversaries is: 15.208987259414457. distance: 0.0452766352570015
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.1207, Accuracy: 8674/8991 (96.4743%)
poison local model 70 index 69 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   1,  Average loss: 0.0011, Accuracy: 552/569 (97.0123%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   2,  Average loss: 0.0011, Accuracy: 554/569 (97.3638%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   3,  Average loss: 0.0005, Accuracy: 563/569 (98.9455%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   4,  Average loss: 0.0003, Accuracy: 566/569 (99.4728%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   5,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   6,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   7,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   8,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   9,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch  10,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Global model norm: 15.209255632974932.
Norm before scaling: 15.245501245532699. Distance: 0.9823464275534162
Total norm for 8 adversaries is: 15.245501245532699. distance: 0.9823464275534162
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.4551, Accuracy: 7608/8991 (84.6180%)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0017, Accuracy: 29/30 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.9884, Accuracy: 8539/10000 (85.3900%), Attack Success Rate:0/10000(0.000)
time spent on training: 169.61225414276123
[foolsgold agg] training data poison_ratio: 0.9946515892420538  data num: [1544, 1437, 2072, 568, 48, 5, 237, 34, 569, 30]
[foolsgold agg] considering poison per batch poison_fraction: 0.9946515892420538
[foolsgold agg] wv: [0.42244036 0.95511644 1.         1.         0.42244036 0.95511644
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.9774, Accuracy: 8691/10000 (86.9100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.1232, Accuracy: 8662/8991 (96.3408%)
Done in 516.5836710929871 sec.
Server Epoch:34 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 570/578 (98.6159%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   2,  Average loss: 0.0127, Accuracy: 485/578 (83.9100%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   3,  Average loss: 0.0029, Accuracy: 549/578 (94.9827%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   4,  Average loss: 0.0051, Accuracy: 555/578 (96.0208%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   5,  Average loss: 0.0032, Accuracy: 543/578 (93.9446%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   6,  Average loss: 0.0015, Accuracy: 566/578 (97.9239%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   7,  Average loss: 0.0013, Accuracy: 561/578 (97.0588%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   8,  Average loss: 0.0009, Accuracy: 569/578 (98.4429%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   9,  Average loss: 0.0007, Accuracy: 571/578 (98.7889%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch  10,  Average loss: 0.0007, Accuracy: 571/578 (98.7889%), train_poison_data_count: 578
Global model norm: 15.236245878711806.
Norm before scaling: 16.543836219139234. Distance: 6.5464866359116565
Total norm for 9 adversaries is: 16.543836219139234. distance: 6.5464866359116565
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 2.3771, Accuracy: 4255/8991 (47.3251%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0011, Accuracy: 191/196 (97.4490%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   2,  Average loss: 0.0006, Accuracy: 195/196 (99.4898%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   3,  Average loss: 0.0014, Accuracy: 193/196 (98.4694%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   4,  Average loss: 0.0008, Accuracy: 193/196 (98.4694%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   5,  Average loss: 0.0003, Accuracy: 193/196 (98.4694%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   6,  Average loss: 0.0000, Accuracy: 196/196 (100.0000%), train_poison_data_count: 196
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   7,  Average loss: 0.0000, Accuracy: 196/196 (100.0000%), train_poison_data_count: 196
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   8,  Average loss: 0.0000, Accuracy: 196/196 (100.0000%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   9,  Average loss: 0.0000, Accuracy: 196/196 (100.0000%), train_poison_data_count: 196
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch  10,  Average loss: 0.0000, Accuracy: 196/196 (100.0000%), train_poison_data_count: 196
Global model norm: 15.236245878711806.
Norm before scaling: 15.237156196452084. Distance: 0.6877091046428853
Total norm for 9 adversaries is: 15.237156196452084. distance: 0.6877091046428853
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.9381, Accuracy: 7154/8991 (79.5685%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0011, Accuracy: 499/509 (98.0354%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 507/509 (99.6071%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0000, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0000, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0000, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0000, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0000, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0000, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0000, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Global model norm: 15.236245878711806.
Norm before scaling: 15.23556285433135. Distance: 0.9441300239646493
Total norm for 9 adversaries is: 15.23556285433135. distance: 0.9441300239646493
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 2.4953, Accuracy: 4227/8991 (47.0137%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0005, Accuracy: 150/151 (99.3377%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 15.236245878711806.
Norm before scaling: 15.227859183499826. Distance: 0.32448834390454473
Total norm for 9 adversaries is: 15.227859183499826. distance: 0.32448834390454473
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.3400, Accuracy: 8173/8991 (90.9020%)
poison local model 71 index 70 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   1,  Average loss: 0.0022, Accuracy: 330/342 (96.4912%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   2,  Average loss: 0.0008, Accuracy: 337/342 (98.5380%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   3,  Average loss: 0.0008, Accuracy: 337/342 (98.5380%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   4,  Average loss: 0.0004, Accuracy: 339/342 (99.1228%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   5,  Average loss: 0.0003, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   6,  Average loss: 0.0003, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   7,  Average loss: 0.0002, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   8,  Average loss: 0.0002, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   9,  Average loss: 0.0002, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch  10,  Average loss: 0.0002, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Global model norm: 15.236245878711806.
Norm before scaling: 15.234919862051294. Distance: 0.9666173594878371
Total norm for 9 adversaries is: 15.234919862051294. distance: 0.9666173594878371
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1.1909, Accuracy: 6608/8991 (73.4957%)
poison local model 60 index 59 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   1,  Average loss: 0.0007, Accuracy: 393/399 (98.4962%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   2,  Average loss: 0.0006, Accuracy: 397/399 (99.4987%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   3,  Average loss: 0.0007, Accuracy: 391/399 (97.9950%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   4,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   5,  Average loss: 0.0003, Accuracy: 397/399 (99.4987%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   6,  Average loss: 0.0001, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   7,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   8,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   9,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch  10,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Global model norm: 15.236245878711806.
Norm before scaling: 15.22033457564999. Distance: 0.9001129450394071
Total norm for 9 adversaries is: 15.22033457564999. distance: 0.9001129450394071
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 4.9102, Accuracy: 3330/8991 (37.0370%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   2,  Average loss: 0.0002, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   3,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   4,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   5,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   6,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   7,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Global model norm: 15.236245878711806.
Norm before scaling: 15.236185289076985. Distance: 0.11902524489159441
Total norm for 9 adversaries is: 15.236185289076985. distance: 0.11902524489159441
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.1367, Accuracy: 8589/8991 (95.5289%)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0008, Accuracy: 736/750 (98.1333%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.2609, Accuracy: 7203/10000 (72.0300%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1292/1311 (98.5507%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1306/1311 (99.6186%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1308/1311 (99.7712%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Global model norm: 15.236245878711806.
Norm before scaling: 15.103081576953665. Distance: 1.6892166589616906
Total norm for 9 adversaries is: 15.103081576953665. distance: 1.6892166589616906
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 2.8343, Accuracy: 3452/8991 (38.3939%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 125/128 (97.6562%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   3,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   4,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   5,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   6,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.236245878711806.
Norm before scaling: 15.239330123636915. Distance: 0.34067013992646655
Total norm for 9 adversaries is: 15.239330123636915. distance: 0.34067013992646655
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.3410, Accuracy: 8142/8991 (90.5572%)
time spent on training: 148.6783459186554
[foolsgold agg] training data poison_ratio: 0.830585046306754  data num: [578, 196, 509, 151, 342, 399, 63, 750, 1311, 128]
[foolsgold agg] considering poison per batch poison_fraction: 0.830585046306754
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.9812, Accuracy: 8692/10000 (86.9200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.1240, Accuracy: 8662/8991 (96.3408%)
Done in 488.1948640346527 sec.
Server Epoch:35 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   1,  Average loss: 0.0006, Accuracy: 149/151 (98.6755%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   3,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   4,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   5,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 151/151 (100.0000%), train_poison_data_count: 151
Global model norm: 15.266096281587869.
Norm before scaling: 15.25694391968964. Distance: 0.3544466604207032
Total norm for 9 adversaries is: 15.25694391968964. distance: 0.3544466604207032
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.3108, Accuracy: 8226/8991 (91.4915%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0011, Accuracy: 296/304 (97.3684%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   2,  Average loss: 0.0004, Accuracy: 301/304 (99.0132%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   3,  Average loss: 0.0004, Accuracy: 301/304 (99.0132%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   4,  Average loss: 0.0002, Accuracy: 303/304 (99.6711%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   5,  Average loss: 0.0001, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   6,  Average loss: 0.0000, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   7,  Average loss: 0.0000, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   8,  Average loss: 0.0000, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   9,  Average loss: 0.0000, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch  10,  Average loss: 0.0000, Accuracy: 304/304 (100.0000%), train_poison_data_count: 304
Global model norm: 15.266096281587869.
Norm before scaling: 15.258783031248807. Distance: 0.721965769225762
Total norm for 9 adversaries is: 15.258783031248807. distance: 0.721965769225762
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 2.3122, Accuracy: 5005/8991 (55.6668%)
poison local model 53 index 52 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   1,  Average loss: 0.0011, Accuracy: 446/456 (97.8070%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   2,  Average loss: 0.0005, Accuracy: 451/456 (98.9035%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   3,  Average loss: 0.0001, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   4,  Average loss: 0.0001, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   5,  Average loss: 0.0001, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   6,  Average loss: 0.0001, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   7,  Average loss: 0.0000, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   8,  Average loss: 0.0000, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   9,  Average loss: 0.0000, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch  10,  Average loss: 0.0000, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Global model norm: 15.266096281587869.
Norm before scaling: 15.240217229141003. Distance: 0.8211560952484441
Total norm for 9 adversaries is: 15.240217229141003. distance: 0.8211560952484441
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.6737, Accuracy: 7346/8991 (81.7039%)
poison local model 79 index 78 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.0041, Accuracy: 24/25 (96.0000%), train_poison_data_count: 25
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   2,  Average loss: 0.0003, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   3,  Average loss: 0.0003, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   4,  Average loss: 0.0003, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   5,  Average loss: 0.0003, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   6,  Average loss: 0.0002, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   7,  Average loss: 0.0002, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   8,  Average loss: 0.0002, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   9,  Average loss: 0.0002, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch  10,  Average loss: 0.0002, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Global model norm: 15.266096281587869.
Norm before scaling: 15.265024757102784. Distance: 0.22767768370164115
Total norm for 9 adversaries is: 15.265024757102784. distance: 0.22767768370164115
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1740, Accuracy: 8531/8991 (94.8838%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0011, Accuracy: 632/644 (98.1366%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   3,  Average loss: 0.0002, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   4,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   7,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   8,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   9,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 15.266096281587869.
Norm before scaling: 15.231528680417563. Distance: 1.0674012959966142
Total norm for 9 adversaries is: 15.231528680417563. distance: 1.0674012959966142
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.1941, Accuracy: 6693/8991 (74.4411%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   1,  Average loss: 0.0010, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   2,  Average loss: 0.0005, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   3,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   4,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   5,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   6,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.266096281587869.
Norm before scaling: 15.267859835134475. Distance: 0.25440784207187844
Total norm for 9 adversaries is: 15.267859835134475. distance: 0.25440784207187844
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1495, Accuracy: 8578/8991 (95.4065%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0023, Accuracy: 984/1033 (95.2565%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1017/1033 (98.4511%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1029/1033 (99.6128%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Global model norm: 15.266096281587869.
Norm before scaling: 15.356541912702923. Distance: 2.1569934613690687
Total norm for 9 adversaries is: 15.356541912702923. distance: 2.1569934613690687
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 3.2060, Accuracy: 4089/8991 (45.4788%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   2,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   3,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   4,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   7,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   8,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch  10,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 15.266096281587869.
Norm before scaling: 15.265090230205917. Distance: 0.22187300164034685
Total norm for 9 adversaries is: 15.265090230205917. distance: 0.22187300164034685
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1665, Accuracy: 8546/8991 (95.0506%)
poison local model 65 index 64 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1288/1326 (97.1342%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1316/1326 (99.2459%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1323/1326 (99.7738%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Global model norm: 15.266096281587869.
Norm before scaling: 15.233863673309939. Distance: 1.6502628434953808
Total norm for 9 adversaries is: 15.233863673309939. distance: 1.6502628434953808
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.5091, Accuracy: 5333/8991 (59.3149%)
___Train Local_Simple,  epoch  35, local model 98, internal_epoch   1,  Average loss: 0.0000, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.9810, Accuracy: 8692/10000 (86.9200%), Attack Success Rate:0/10000(0.000)
time spent on training: 146.77584099769592
[foolsgold agg] training data poison_ratio: 0.9985566514313207  data num: [151, 304, 456, 25, 644, 128, 1033, 84, 1326, 6]
[foolsgold agg] considering poison per batch poison_fraction: 0.9985566514313207
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 0. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.9836, Accuracy: 8694/10000 (86.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.1196, Accuracy: 8665/8991 (96.3742%)
Done in 478.3678638935089 sec.
Server Epoch:36 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  36, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 113/114 (99.1228%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.8680, Accuracy: 8579/10000 (85.7900%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 455/463 (98.2721%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   2,  Average loss: 0.0007, Accuracy: 459/463 (99.1361%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   3,  Average loss: 0.0003, Accuracy: 461/463 (99.5680%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   4,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   5,  Average loss: 0.0001, Accuracy: 462/463 (99.7840%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   6,  Average loss: 0.0001, Accuracy: 463/463 (100.0000%), train_poison_data_count: 463
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   7,  Average loss: 0.0000, Accuracy: 463/463 (100.0000%), train_poison_data_count: 463
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 463/463 (100.0000%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 463/463 (100.0000%), train_poison_data_count: 463
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 463/463 (100.0000%), train_poison_data_count: 463
Global model norm: 15.274170278936952.
Norm before scaling: 15.246310428738264. Distance: 0.9801279516770401
Total norm for 8 adversaries is: 15.246310428738264. distance: 0.9801279516770401
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 1.2775, Accuracy: 6591/8991 (73.3066%)
poison local model 79 index 78 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   1,  Average loss: 0.0035, Accuracy: 24/25 (96.0000%), train_poison_data_count: 25
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   2,  Average loss: 0.0002, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   3,  Average loss: 0.0001, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   4,  Average loss: 0.0001, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   5,  Average loss: 0.0001, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   6,  Average loss: 0.0001, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   7,  Average loss: 0.0001, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   8,  Average loss: 0.0001, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   9,  Average loss: 0.0001, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch  10,  Average loss: 0.0001, Accuracy: 25/25 (100.0000%), train_poison_data_count: 25
Global model norm: 15.274170278936952.
Norm before scaling: 15.272623759492783. Distance: 0.2242247314851531
Total norm for 8 adversaries is: 15.272623759492783. distance: 0.2242247314851531
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1714, Accuracy: 8553/8991 (95.1285%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0004, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   2,  Average loss: 0.0002, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   3,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   8,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   9,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch  10,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 15.274170278936952.
Norm before scaling: 15.274298149504641. Distance: 0.06263671391471937
Total norm for 8 adversaries is: 15.274298149504641. distance: 0.06263671391471937
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1227, Accuracy: 8653/8991 (96.2407%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   1,  Average loss: 0.0007, Accuracy: 2489/2519 (98.8091%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   2,  Average loss: 0.0003, Accuracy: 2505/2519 (99.4442%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2513/2519 (99.7618%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2517/2519 (99.9206%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2517/2519 (99.9206%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2518/2519 (99.9603%), train_poison_data_count: 2519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2518/2519 (99.9603%), train_poison_data_count: 2519
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2518/2519 (99.9603%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2518/2519 (99.9603%), train_poison_data_count: 2519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2518/2519 (99.9603%), train_poison_data_count: 2519
Global model norm: 15.274170278936952.
Norm before scaling: 15.106539471038332. Distance: 1.5704366150956495
Total norm for 8 adversaries is: 15.106539471038332. distance: 1.5704366150956495
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.8865, Accuracy: 6968/8991 (77.4997%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 44/47 (93.6170%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   2,  Average loss: 0.0002, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   3,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   4,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   5,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   6,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   7,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   8,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   9,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch  10,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Global model norm: 15.274170278936952.
Norm before scaling: 15.275582290264442. Distance: 0.34947108085514733
Total norm for 8 adversaries is: 15.275582290264442. distance: 0.34947108085514733
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.3393, Accuracy: 8079/8991 (89.8565%)
___Train Local_Simple,  epoch  36, local model 89, internal_epoch   1,  Average loss: 0.0483, Accuracy: 44/69 (63.7681%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.4868, Accuracy: 7757/10000 (77.5700%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   1,  Average loss: 0.0006, Accuracy: 127/128 (99.2188%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   3,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   4,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   5,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   6,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.274170278936952.
Norm before scaling: 15.276114195599357. Distance: 0.2867334980510817
Total norm for 8 adversaries is: 15.276114195599357. distance: 0.2867334980510817
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.2588, Accuracy: 8332/8991 (92.6704%)
poison local model 70 index 69 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   1,  Average loss: 0.0010, Accuracy: 559/569 (98.2425%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   2,  Average loss: 0.0005, Accuracy: 565/569 (99.2970%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   3,  Average loss: 0.0002, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   4,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   5,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   6,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   7,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   8,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   9,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch  10,  Average loss: 0.0001, Accuracy: 569/569 (100.0000%), train_poison_data_count: 569
Global model norm: 15.274170278936952.
Norm before scaling: 15.283941301062889. Distance: 0.8297100013799539
Total norm for 8 adversaries is: 15.283941301062889. distance: 0.8297100013799539
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.3746, Accuracy: 7912/8991 (87.9991%)
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1521/1544 (98.5104%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1536/1544 (99.4819%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Global model norm: 15.274170278936952.
Norm before scaling: 15.181236953698336. Distance: 1.5611188506360294
Total norm for 8 adversaries is: 15.181236953698336. distance: 1.5611188506360294
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.7004, Accuracy: 7086/8991 (78.8121%)
time spent on training: 159.826810836792
[foolsgold agg] training data poison_ratio: 0.9667635306937886  data num: [114, 463, 25, 28, 2519, 47, 69, 128, 569, 1544]
[foolsgold agg] considering poison per batch poison_fraction: 0.9667635306937886
[foolsgold agg] wv: [0. 1. 0. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.7162, Accuracy: 8694/10000 (86.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.1206, Accuracy: 8687/8991 (96.6188%)
Done in 505.9030520915985 sec.
Server Epoch:37 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 660/678 (97.3451%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 673/678 (99.2625%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   3,  Average loss: 0.0001, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   4,  Average loss: 0.0000, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   5,  Average loss: 0.0000, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   6,  Average loss: 0.0000, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   7,  Average loss: 0.0000, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch  10,  Average loss: 0.0000, Accuracy: 678/678 (100.0000%), train_poison_data_count: 678
Global model norm: 15.288301490865031.
Norm before scaling: 15.268355532409588. Distance: 1.3918007156015018
Total norm for 9 adversaries is: 15.268355532409588. distance: 1.3918007156015018
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 3.4822, Accuracy: 5492/8991 (61.0833%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0010, Accuracy: 799/818 (97.6773%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0008, Accuracy: 804/818 (98.2885%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   3,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   7,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   8,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 818/818 (100.0000%), train_poison_data_count: 818
Global model norm: 15.288301490865031.
Norm before scaling: 15.296922880415362. Distance: 1.4816139643206727
Total norm for 9 adversaries is: 15.296922880415362. distance: 1.4816139643206727
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.4203, Accuracy: 5624/8991 (62.5514%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 629/644 (97.6708%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   2,  Average loss: 0.0005, Accuracy: 637/644 (98.9130%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   3,  Average loss: 0.0001, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   7,  Average loss: 0.0002, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   8,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   9,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 15.288301490865031.
Norm before scaling: 15.259621508542876. Distance: 1.1189295384924383
Total norm for 9 adversaries is: 15.259621508542876. distance: 1.1189295384924383
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.2516, Accuracy: 6713/8991 (74.6636%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0019, Accuracy: 490/509 (96.2672%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0008, Accuracy: 500/509 (98.2318%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0005, Accuracy: 505/509 (99.2141%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 508/509 (99.8035%), train_poison_data_count: 509
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0000, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0000, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0000, Accuracy: 509/509 (100.0000%), train_poison_data_count: 509
Global model norm: 15.288301490865031.
Norm before scaling: 15.31053279774356. Distance: 1.4023210528988868
Total norm for 9 adversaries is: 15.31053279774356. distance: 1.4023210528988868
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.8907, Accuracy: 4762/8991 (52.9641%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1026/1046 (98.0880%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1024/1046 (97.8967%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1042/1046 (99.6176%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1044/1046 (99.8088%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1045/1046 (99.9044%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Global model norm: 15.288301490865031.
Norm before scaling: 15.305494052573389. Distance: 1.6880532523383562
Total norm for 9 adversaries is: 15.305494052573389. distance: 1.6880532523383562
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.3449, Accuracy: 6388/8991 (71.0488%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   1,  Average loss: 0.0006, Accuracy: 696/705 (98.7234%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   2,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   3,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   4,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   5,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   6,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   7,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   8,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   9,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch  10,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Global model norm: 15.288301490865031.
Norm before scaling: 15.241436164048762. Distance: 1.2763848861716438
Total norm for 9 adversaries is: 15.241436164048762. distance: 1.2763848861716438
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 5.3897, Accuracy: 3380/8991 (37.5931%)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.1275, Accuracy: 9/29 (31.0345%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.8031, Accuracy: 8031/10000 (80.3100%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0003, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   3,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   4,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   5,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   6,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   7,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   8,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   9,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch  10,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Global model norm: 15.288301490865031.
Norm before scaling: 15.286876181026111. Distance: 0.01421869700171083
Total norm for 9 adversaries is: 15.286876181026111. distance: 0.01421869700171083
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1216, Accuracy: 8684/8991 (96.5855%)
poison local model 62 index 61 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   2,  Average loss: 0.0006, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   3,  Average loss: 0.0005, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   4,  Average loss: 0.0005, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   5,  Average loss: 0.0005, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   6,  Average loss: 0.0005, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   7,  Average loss: 0.0005, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   8,  Average loss: 0.0005, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   9,  Average loss: 0.0005, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch  10,  Average loss: 0.0005, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Global model norm: 15.288301490865031.
Norm before scaling: 15.286765883653763. Distance: 0.010733704712652213
Total norm for 9 adversaries is: 15.286765883653763. distance: 0.010733704712652213
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1214, Accuracy: 8683/8991 (96.5744%)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0009, Accuracy: 259/264 (98.1061%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   2,  Average loss: 0.0003, Accuracy: 262/264 (99.2424%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   3,  Average loss: 0.0003, Accuracy: 262/264 (99.2424%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   4,  Average loss: 0.0002, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   9,  Average loss: 0.0000, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch  10,  Average loss: 0.0000, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Global model norm: 15.288301490865031.
Norm before scaling: 15.278828871819199. Distance: 0.49117800714066695
Total norm for 9 adversaries is: 15.278828871819199. distance: 0.49117800714066695
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.3965, Accuracy: 7903/8991 (87.8990%)
time spent on training: 173.91035890579224
[foolsgold agg] training data poison_ratio: 0.9938310997660073  data num: [678, 818, 644, 509, 1046, 705, 29, 6, 2, 264]
[foolsgold agg] considering poison per batch poison_fraction: 0.9938310997660073
[foolsgold agg] wv: [1.         0.62106046 0.62106046 1.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.4064, Accuracy: 8701/10000 (87.0100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.1396, Accuracy: 8629/8991 (95.9738%)
Done in 572.5834863185883 sec.
Server Epoch:38 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1231/1259 (97.7760%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1248/1259 (99.1263%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1252/1259 (99.4440%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1254/1259 (99.6029%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Global model norm: 15.296370750275466.
Norm before scaling: 15.314791760898595. Distance: 1.8388013863401267
Total norm for 8 adversaries is: 15.314791760898595. distance: 1.8388013863401267
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.6760, Accuracy: 7380/8991 (82.0821%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   1,  Average loss: 0.0021, Accuracy: 1196/1232 (97.0779%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1221/1232 (99.1071%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1221/1232 (99.1071%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1227/1232 (99.5942%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1228/1232 (99.6753%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   8,  Average loss: 0.0002, Accuracy: 1230/1232 (99.8377%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1230/1232 (99.8377%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch  10,  Average loss: 0.0002, Accuracy: 1230/1232 (99.8377%), train_poison_data_count: 1232
Global model norm: 15.296370750275466.
Norm before scaling: 15.353656127115995. Distance: 2.234153789960764
Total norm for 8 adversaries is: 15.353656127115995. distance: 2.234153789960764
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.6108, Accuracy: 6355/8991 (70.6818%)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 33/33 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4057, Accuracy: 8706/10000 (87.0600%), Attack Success Rate:0/10000(0.000)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 2285/2324 (98.3219%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   2,  Average loss: 0.0005, Accuracy: 2300/2324 (98.9673%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   3,  Average loss: 0.0002, Accuracy: 2318/2324 (99.7418%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2321/2324 (99.8709%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2320/2324 (99.8279%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2322/2324 (99.9139%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2322/2324 (99.9139%), train_poison_data_count: 2324
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2322/2324 (99.9139%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Global model norm: 15.296370750275466.
Norm before scaling: 15.250729902966684. Distance: 1.9229857793630316
Total norm for 8 adversaries is: 15.250729902966684. distance: 1.9229857793630316
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.0593, Accuracy: 6641/8991 (73.8628%)
poison local model 53 index 52 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 449/456 (98.4649%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   2,  Average loss: 0.0013, Accuracy: 446/456 (97.8070%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   3,  Average loss: 0.0006, Accuracy: 449/456 (98.4649%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   4,  Average loss: 0.0003, Accuracy: 454/456 (99.5614%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   5,  Average loss: 0.0002, Accuracy: 454/456 (99.5614%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   6,  Average loss: 0.0001, Accuracy: 455/456 (99.7807%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   7,  Average loss: 0.0001, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   8,  Average loss: 0.0001, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   9,  Average loss: 0.0001, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch  10,  Average loss: 0.0001, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Global model norm: 15.296370750275466.
Norm before scaling: 15.27740667335546. Distance: 0.918922869968714
Total norm for 8 adversaries is: 15.27740667335546. distance: 0.918922869968714
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.9127, Accuracy: 7222/8991 (80.3248%)
___Train Local_Simple,  epoch  38, local model 83, internal_epoch   1,  Average loss: 0.0012, Accuracy: 731/750 (97.4667%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.1368, Accuracy: 6951/10000 (69.5100%), Attack Success Rate:1/10000(0.010)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0016, Accuracy: 236/244 (96.7213%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   2,  Average loss: 0.0009, Accuracy: 240/244 (98.3607%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   3,  Average loss: 0.0016, Accuracy: 238/244 (97.5410%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   4,  Average loss: 0.0011, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   5,  Average loss: 0.0007, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   6,  Average loss: 0.0004, Accuracy: 242/244 (99.1803%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   7,  Average loss: 0.0003, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   8,  Average loss: 0.0001, Accuracy: 244/244 (100.0000%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   9,  Average loss: 0.0001, Accuracy: 244/244 (100.0000%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch  10,  Average loss: 0.0001, Accuracy: 244/244 (100.0000%), train_poison_data_count: 244
Global model norm: 15.296370750275466.
Norm before scaling: 15.294826475607538. Distance: 0.797651510943795
Total norm for 8 adversaries is: 15.294826475607538. distance: 0.797651510943795
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.7948, Accuracy: 5223/8991 (58.0914%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 379/388 (97.6804%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   2,  Average loss: 0.0008, Accuracy: 382/388 (98.4536%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   3,  Average loss: 0.0016, Accuracy: 372/388 (95.8763%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   4,  Average loss: 0.0006, Accuracy: 383/388 (98.7113%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   5,  Average loss: 0.0003, Accuracy: 384/388 (98.9691%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 387/388 (99.7423%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 388/388 (100.0000%), train_poison_data_count: 388
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 388/388 (100.0000%), train_poison_data_count: 388
Global model norm: 15.296370750275466.
Norm before scaling: 15.278463846850942. Distance: 1.0166316398986317
Total norm for 8 adversaries is: 15.278463846850942. distance: 1.0166316398986317
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 2.6065, Accuracy: 5460/8991 (60.7274%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   1,  Average loss: 0.0002, Accuracy: 702/705 (99.5745%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   2,  Average loss: 0.0000, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   3,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   4,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   5,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   6,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   7,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   8,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   9,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch  10,  Average loss: 0.0000, Accuracy: 705/705 (100.0000%), train_poison_data_count: 705
Global model norm: 15.296370750275466.
Norm before scaling: 15.250213121269507. Distance: 0.8844807821032997
Total norm for 8 adversaries is: 15.250213121269507. distance: 0.8844807821032997
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 4.3171, Accuracy: 3283/8991 (36.5143%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0039, Accuracy: 89/94 (94.6809%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   2,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   3,  Average loss: 0.0003, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   4,  Average loss: 0.0003, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   5,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   6,  Average loss: 0.0002, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Global model norm: 15.296370750275466.
Norm before scaling: 15.303921285535521. Distance: 0.6118858888570949
Total norm for 8 adversaries is: 15.303921285535521. distance: 0.6118858888570949
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.7277, Accuracy: 7446/8991 (82.8161%)
time spent on training: 204.64387798309326
[foolsgold agg] training data poison_ratio: 0.8953907815631262  data num: [1259, 1232, 33, 2324, 456, 750, 244, 388, 705, 94]
[foolsgold agg] considering poison per batch poison_fraction: 0.8953907815631262
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.4943, Accuracy: 8721/10000 (87.2100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.1271, Accuracy: 8683/8991 (96.5744%)
Done in 600.2796850204468 sec.
Server Epoch:39 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0012, Accuracy: 990/1010 (98.0198%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   2,  Average loss: 0.0009, Accuracy: 990/1010 (98.0198%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1004/1010 (99.4059%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1006/1010 (99.6040%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1005/1010 (99.5050%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1008/1010 (99.8020%), train_poison_data_count: 1010
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1009/1010 (99.9010%), train_poison_data_count: 1010
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1009/1010 (99.9010%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1010/1010 (100.0000%), train_poison_data_count: 1010
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1010/1010 (100.0000%), train_poison_data_count: 1010
Global model norm: 15.325255270196307.
Norm before scaling: 15.323241907433001. Distance: 1.4650274949862456
Total norm for 9 adversaries is: 15.323241907433001. distance: 1.4650274949862456
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.6082, Accuracy: 5955/8991 (66.2329%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   1,  Average loss: 0.0022, Accuracy: 1155/1203 (96.0100%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   2,  Average loss: 0.0011, Accuracy: 1179/1203 (98.0050%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   3,  Average loss: 0.0007, Accuracy: 1188/1203 (98.7531%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1196/1203 (99.4181%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1201/1203 (99.8337%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   6,  Average loss: 0.0002, Accuracy: 1202/1203 (99.9169%), train_poison_data_count: 1203
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   7,  Average loss: 0.0002, Accuracy: 1203/1203 (100.0000%), train_poison_data_count: 1203
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1203/1203 (100.0000%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1203/1203 (100.0000%), train_poison_data_count: 1203
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1203/1203 (100.0000%), train_poison_data_count: 1203
Global model norm: 15.325255270196307.
Norm before scaling: 15.431473887887025. Distance: 1.8429178202578977
Total norm for 9 adversaries is: 15.431473887887025. distance: 1.8429178202578977
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.0057, Accuracy: 6631/8991 (73.7515%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   1,  Average loss: 0.0054, Accuracy: 27/28 (96.4286%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   2,  Average loss: 0.0004, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   3,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   4,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   5,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   6,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 15.325255270196307.
Norm before scaling: 15.332054140110301. Distance: 0.31421580155334683
Total norm for 9 adversaries is: 15.332054140110301. distance: 0.31421580155334683
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1399, Accuracy: 8618/8991 (95.8514%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1028/1046 (98.2792%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1038/1046 (99.2352%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1045/1046 (99.9044%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Global model norm: 15.325255270196307.
Norm before scaling: 15.254456416134854. Distance: 1.0726482771697337
Total norm for 9 adversaries is: 15.254456416134854. distance: 1.0726482771697337
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.6887, Accuracy: 7282/8991 (80.9921%)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1181/1205 (98.0083%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1194/1205 (99.0871%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1202/1205 (99.7510%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Global model norm: 15.325255270196307.
Norm before scaling: 15.289693235584593. Distance: 1.585450948109813
Total norm for 9 adversaries is: 15.289693235584593. distance: 1.585450948109813
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.2139, Accuracy: 6509/8991 (72.3946%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0003, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 15.325255270196307.
Norm before scaling: 15.324551818168594. Distance: 0.06249884701201758
Total norm for 9 adversaries is: 15.324551818168594. distance: 0.06249884701201758
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1368, Accuracy: 8655/8991 (96.2629%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   1,  Average loss: 0.0008, Accuracy: 434/436 (99.5413%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 433/436 (99.3119%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   3,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   4,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   5,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   6,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Global model norm: 15.325255270196307.
Norm before scaling: 15.343741547063608. Distance: 0.8645643132580354
Total norm for 9 adversaries is: 15.343741547063608. distance: 0.8645643132580354
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.1415, Accuracy: 6857/8991 (76.2652%)
___Train Local_Simple,  epoch  39, local model 88, internal_epoch   1,  Average loss: 0.0070, Accuracy: 88/96 (91.6667%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.0809, Accuracy: 7187/10000 (71.8700%), Attack Success Rate:0/10000(0.000)
poison local model 72 index 71 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0588, Accuracy: 9/10 (90.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   2,  Average loss: 0.0015, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   3,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   4,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   5,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   6,  Average loss: 0.0002, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   7,  Average loss: 0.0002, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   8,  Average loss: 0.0002, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   9,  Average loss: 0.0002, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch  10,  Average loss: 0.0002, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Global model norm: 15.325255270196307.
Norm before scaling: 15.31741889265953. Distance: 0.5163227619776307
Total norm for 9 adversaries is: 15.31741889265953. distance: 0.5163227619776307
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.5694, Accuracy: 7828/8991 (87.0648%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0183, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   2,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   3,  Average loss: 0.0000, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   4,  Average loss: 0.0000, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   5,  Average loss: 0.0000, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   6,  Average loss: 0.0000, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   7,  Average loss: 0.0000, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   8,  Average loss: 0.0000, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   9,  Average loss: 0.0000, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch  10,  Average loss: 0.0000, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 15.325255270196307.
Norm before scaling: 15.331928244080737. Distance: 0.38363492942779875
Total norm for 9 adversaries is: 15.331928244080737. distance: 0.38363492942779875
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.3884, Accuracy: 8088/8991 (89.9566%)
time spent on training: 164.6945230960846
[foolsgold agg] training data poison_ratio: 0.9811283664242186  data num: [1010, 1203, 28, 1046, 1205, 48, 436, 96, 10, 5]
[foolsgold agg] considering poison per batch poison_fraction: 0.9811283664242186
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.5674, Accuracy: 8740/10000 (87.4000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.1171, Accuracy: 8693/8991 (96.6856%)
Done in 564.5195748806 sec.
Server Epoch:40 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0014, Accuracy: 634/648 (97.8395%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   2,  Average loss: 0.0007, Accuracy: 641/648 (98.9198%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   3,  Average loss: 0.0003, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   4,  Average loss: 0.0001, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   5,  Average loss: 0.0001, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   6,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 15.354754260278954.
Norm before scaling: 15.353240704231478. Distance: 1.4041106587379453
Total norm for 6 adversaries is: 15.353240704231478. distance: 1.4041106587379453
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 1.2548, Accuracy: 6403/8991 (71.2157%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 423/428 (98.8318%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 427/428 (99.7664%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   3,  Average loss: 0.0003, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   4,  Average loss: 0.0001, Accuracy: 426/428 (99.5327%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   5,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   6,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   7,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   8,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   9,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch  10,  Average loss: 0.0000, Accuracy: 428/428 (100.0000%), train_poison_data_count: 428
Global model norm: 15.354754260278954.
Norm before scaling: 15.331937698759177. Distance: 0.8128943953273139
Total norm for 6 adversaries is: 15.331937698759177. distance: 0.8128943953273139
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 2.1228, Accuracy: 5665/8991 (63.0075%)
___Train Local_Simple,  epoch  40, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 33/33 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5674, Accuracy: 8742/10000 (87.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 98, internal_epoch   1,  Average loss: 0.0001, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5674, Accuracy: 8740/10000 (87.4000%), Attack Success Rate:0/10000(0.000)
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 256/259 (98.8417%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Global model norm: 15.354754260278954.
Norm before scaling: 15.338104887757535. Distance: 0.48629999653923883
Total norm for 6 adversaries is: 15.338104887757535. distance: 0.48629999653923883
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.4102, Accuracy: 8058/8991 (89.6230%)
___Train Local_Simple,  epoch  40, local model 83, internal_epoch   1,  Average loss: 0.0009, Accuracy: 732/750 (97.6000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.6414, Accuracy: 6661/10000 (66.6100%), Attack Success Rate:0/10000(0.000)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0006, Accuracy: 697/705 (98.8652%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   2,  Average loss: 0.0003, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   3,  Average loss: 0.0002, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   4,  Average loss: 0.0002, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   5,  Average loss: 0.0002, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   6,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   7,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   8,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   9,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch  10,  Average loss: 0.0001, Accuracy: 704/705 (99.8582%), train_poison_data_count: 705
Global model norm: 15.354754260278954.
Norm before scaling: 15.333187157860193. Distance: 1.5928099608779975
Total norm for 6 adversaries is: 15.333187157860193. distance: 1.5928099608779975
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 6.8534, Accuracy: 2014/8991 (22.4002%)
___Train Local_Simple,  epoch  40, local model 90, internal_epoch   1,  Average loss: 0.0009, Accuracy: 757/768 (98.5677%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 2.0879, Accuracy: 5575/10000 (55.7500%), Attack Success Rate:0/10000(0.000)
poison local model 71 index 70 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 330/342 (96.4912%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   2,  Average loss: 0.0007, Accuracy: 338/342 (98.8304%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   3,  Average loss: 0.0005, Accuracy: 339/342 (99.1228%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   4,  Average loss: 0.0003, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   5,  Average loss: 0.0002, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   6,  Average loss: 0.0002, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   7,  Average loss: 0.0002, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   8,  Average loss: 0.0001, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   9,  Average loss: 0.0001, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch  10,  Average loss: 0.0001, Accuracy: 342/342 (100.0000%), train_poison_data_count: 342
Global model norm: 15.354754260278954.
Norm before scaling: 15.348597737729934. Distance: 0.8654545144437372
Total norm for 6 adversaries is: 15.348597737729934. distance: 0.8654545144437372
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.8628, Accuracy: 7077/8991 (78.7120%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0029, Accuracy: 82/84 (97.6190%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   3,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   4,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   5,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   6,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   7,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   8,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   9,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 15.354754260278954.
Norm before scaling: 15.357642323428912. Distance: 0.452465465292135
Total norm for 6 adversaries is: 15.357642323428912. distance: 0.452465465292135
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.3240, Accuracy: 8142/8991 (90.5572%)
time spent on training: 148.60453081130981
[foolsgold agg] training data poison_ratio: 0.6129753914988815  data num: [648, 428, 33, 6, 259, 750, 705, 768, 342, 84]
[foolsgold agg] considering poison per batch poison_fraction: 0.6129753914988815
[foolsgold agg] wv: [1. 0. 1. 0. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.5961, Accuracy: 8727/10000 (87.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.1175, Accuracy: 8685/8991 (96.5966%)
Done in 556.3082051277161 sec.
Server Epoch:41 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 257/259 (99.2278%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Global model norm: 15.360567591829543.
Norm before scaling: 15.343902649285226. Distance: 0.3720861116193799
Total norm for 8 adversaries is: 15.343902649285226. distance: 0.3720861116193799
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.3329, Accuracy: 8226/8991 (91.4915%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   1,  Average loss: 0.0013, Accuracy: 230/237 (97.0464%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   2,  Average loss: 0.0003, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   3,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   4,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   5,  Average loss: 0.0001, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   6,  Average loss: 0.0000, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   7,  Average loss: 0.0000, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   8,  Average loss: 0.0000, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   9,  Average loss: 0.0000, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch  10,  Average loss: 0.0000, Accuracy: 237/237 (100.0000%), train_poison_data_count: 237
Global model norm: 15.360567591829543.
Norm before scaling: 15.35657271533995. Distance: 0.5933348308456825
Total norm for 8 adversaries is: 15.35657271533995. distance: 0.5933348308456825
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.8315, Accuracy: 7002/8991 (77.8779%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   1,  Average loss: 0.0003, Accuracy: 2169/2180 (99.4954%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   2,  Average loss: 0.0000, Accuracy: 2178/2180 (99.9083%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   3,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   4,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   5,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   6,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2180/2180 (100.0000%), train_poison_data_count: 2180
Global model norm: 15.360567591829543.
Norm before scaling: 15.113931436324371. Distance: 1.1660311137181865
Total norm for 8 adversaries is: 15.113931436324371. distance: 1.1660311137181865
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 1.5905, Accuracy: 6119/8991 (68.0569%)
___Train Local_Simple,  epoch  41, local model 95, internal_epoch   1,  Average loss: 0.0008, Accuracy: 29/29 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5974, Accuracy: 8717/10000 (87.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 83, internal_epoch   1,  Average loss: 0.0015, Accuracy: 728/750 (97.0667%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.1558, Accuracy: 7438/10000 (74.3800%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0011, Accuracy: 259/264 (98.1061%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   2,  Average loss: 0.0015, Accuracy: 259/264 (98.1061%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   3,  Average loss: 0.0005, Accuracy: 258/264 (97.7273%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   4,  Average loss: 0.0002, Accuracy: 263/264 (99.6212%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 264/264 (100.0000%), train_poison_data_count: 264
Global model norm: 15.360567591829543.
Norm before scaling: 15.346094764197137. Distance: 0.5959991470001185
Total norm for 8 adversaries is: 15.346094764197137. distance: 0.5959991470001185
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.3136, Accuracy: 8099/8991 (90.0790%)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   1,  Average loss: 0.0016, Accuracy: 2707/2803 (96.5751%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   2,  Average loss: 0.0007, Accuracy: 2758/2803 (98.3946%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   3,  Average loss: 0.0003, Accuracy: 2784/2803 (99.3222%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   4,  Average loss: 0.0002, Accuracy: 2792/2803 (99.6076%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   5,  Average loss: 0.0002, Accuracy: 2795/2803 (99.7146%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2796/2803 (99.7503%), train_poison_data_count: 2803
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2797/2803 (99.7859%), train_poison_data_count: 2803
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2799/2803 (99.8573%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2803/2803 (100.0000%), train_poison_data_count: 2803
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2803/2803 (100.0000%), train_poison_data_count: 2803
Global model norm: 15.360567591829543.
Norm before scaling: 15.452611037174622. Distance: 2.6125380481340357
Total norm for 8 adversaries is: 15.452611037174622. distance: 2.6125380481340357
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 2.4077, Accuracy: 4922/8991 (54.7436%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0012, Accuracy: 62/63 (98.4127%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   2,  Average loss: 0.0003, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   3,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   6,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   7,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 63/63 (100.0000%), train_poison_data_count: 63
Global model norm: 15.360567591829543.
Norm before scaling: 15.36141441985456. Distance: 0.18337897663641256
Total norm for 8 adversaries is: 15.36141441985456. distance: 0.18337897663641256
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1160, Accuracy: 8665/8991 (96.3742%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1206/1232 (97.8896%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1223/1232 (99.2695%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Global model norm: 15.360567591829543.
Norm before scaling: 15.2972136509692. Distance: 1.480616338212589
Total norm for 8 adversaries is: 15.2972136509692. distance: 1.480616338212589
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 1.0913, Accuracy: 6692/8991 (74.4300%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   1,  Average loss: 0.0020, Accuracy: 297/310 (95.8065%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   2,  Average loss: 0.0009, Accuracy: 303/310 (97.7419%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   3,  Average loss: 0.0002, Accuracy: 309/310 (99.6774%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   4,  Average loss: 0.0001, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   5,  Average loss: 0.0001, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   6,  Average loss: 0.0001, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   7,  Average loss: 0.0000, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 310/310 (100.0000%), train_poison_data_count: 310
Global model norm: 15.360567591829543.
Norm before scaling: 15.378341683820656. Distance: 1.1419888011764079
Total norm for 8 adversaries is: 15.378341683820656. distance: 1.1419888011764079
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 1.6706, Accuracy: 6019/8991 (66.9447%)
time spent on training: 215.04514598846436
[foolsgold agg] training data poison_ratio: 0.904146671588532  data num: [259, 237, 2180, 29, 750, 264, 2803, 63, 1232, 310]
[foolsgold agg] considering poison per batch poison_fraction: 0.904146671588532
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.97533504 0.55377946 0.97533504 0.55377946]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.6866, Accuracy: 8745/10000 (87.4500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.1101, Accuracy: 8710/8991 (96.8747%)
Done in 621.3922288417816 sec.
Server Epoch:42 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0000, Accuracy: 33/33 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6866, Accuracy: 8744/10000 (87.4400%), Attack Success Rate:0/10000(0.000)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1186/1205 (98.4232%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1197/1205 (99.3361%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Global model norm: 15.388509630165467.
Norm before scaling: 15.301207570809567. Distance: 1.4951946056611554
Total norm for 6 adversaries is: 15.301207570809567. distance: 1.4951946056611554
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 1.5115, Accuracy: 6669/8991 (74.1742%)
___Train Local_Simple,  epoch  42, local model 89, internal_epoch   1,  Average loss: 0.0311, Accuracy: 42/69 (60.8696%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.8320, Accuracy: 7931/10000 (79.3100%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   3,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   4,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   5,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   6,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.388509630165467.
Norm before scaling: 15.387480345774664. Distance: 0.1858635458812961
Total norm for 6 adversaries is: 15.387480345774664. distance: 0.1858635458812961
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1531, Accuracy: 8598/8991 (95.6290%)
___Train Local_Simple,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0012, Accuracy: 66/68 (97.0588%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6543, Accuracy: 8732/10000 (87.3200%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 662/688 (96.2209%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   2,  Average loss: 0.0004, Accuracy: 680/688 (98.8372%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   3,  Average loss: 0.0002, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 15.388509630165467.
Norm before scaling: 15.37340555995132. Distance: 1.237239315049256
Total norm for 6 adversaries is: 15.37340555995132. distance: 1.237239315049256
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 1.3934, Accuracy: 5460/8991 (60.7274%)
___Train Local_Simple,  epoch  42, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 199/202 (98.5149%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.4145, Accuracy: 7326/10000 (73.2600%), Attack Success Rate:0/10000(0.000)
poison local model 62 index 61 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   1,  Average loss: 0.0013, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   2,  Average loss: 0.0011, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   3,  Average loss: 0.0009, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   4,  Average loss: 0.0009, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   5,  Average loss: 0.0008, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   6,  Average loss: 0.0008, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   7,  Average loss: 0.0008, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   8,  Average loss: 0.0007, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   9,  Average loss: 0.0007, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch  10,  Average loss: 0.0007, Accuracy: 2/2 (100.0000%), train_poison_data_count: 2
Global model norm: 15.388509630165467.
Norm before scaling: 15.387368786250056. Distance: 0.019717980131332063
Total norm for 6 adversaries is: 15.387368786250056. distance: 0.019717980131332063
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1104, Accuracy: 8708/8991 (96.8524%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1294/1311 (98.7033%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1307/1311 (99.6949%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   3,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   4,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Global model norm: 15.388509630165467.
Norm before scaling: 15.26448846684018. Distance: 1.5178554679156127
Total norm for 6 adversaries is: 15.26448846684018. distance: 1.5178554679156127
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 2.4964, Accuracy: 4711/8991 (52.3968%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1211/1232 (98.2955%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1214/1232 (98.5390%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1227/1232 (99.5942%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1228/1232 (99.6753%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Global model norm: 15.388509630165467.
Norm before scaling: 15.324140584971438. Distance: 1.4818267632931128
Total norm for 6 adversaries is: 15.324140584971438. distance: 1.4818267632931128
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.9781, Accuracy: 6890/8991 (76.6322%)
time spent on training: 164.30867886543274
[foolsgold agg] training data poison_ratio: 0.9246658566221142  data num: [33, 1205, 69, 128, 68, 688, 202, 2, 1311, 1232]
[foolsgold agg] considering poison per batch poison_fraction: 0.9246658566221142
[foolsgold agg] wv: [1.         0.58697509 1.         0.91358079 0.1154352  1.
 0.1154352  0.91358079 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.5167, Accuracy: 8757/10000 (87.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.1110, Accuracy: 8705/8991 (96.8190%)
Done in 575.4900720119476 sec.
Server Epoch:43 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   1,  Average loss: 0.0003, Accuracy: 177/179 (98.8827%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   3,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   4,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   5,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   6,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   7,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Global model norm: 15.39538017435395.
Norm before scaling: 15.385484547638564. Distance: 0.29269088283573935
Total norm for 8 adversaries is: 15.385484547638564. distance: 0.29269088283573935
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.3006, Accuracy: 8221/8991 (91.4359%)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 2280/2324 (98.1067%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   2,  Average loss: 0.0003, Accuracy: 2311/2324 (99.4406%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2320/2324 (99.8279%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2322/2324 (99.9139%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2324/2324 (100.0000%), train_poison_data_count: 2324
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2324/2324 (100.0000%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2324/2324 (100.0000%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2324/2324 (100.0000%), train_poison_data_count: 2324
Global model norm: 15.39538017435395.
Norm before scaling: 15.291414153104277. Distance: 1.7184375132081897
Total norm for 8 adversaries is: 15.291414153104277. distance: 1.7184375132081897
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.7827, Accuracy: 7030/8991 (78.1893%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1295/1311 (98.7796%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1306/1311 (99.6186%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1310/1311 (99.9237%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Global model norm: 15.39538017435395.
Norm before scaling: 15.30148529622232. Distance: 1.8818718550955733
Total norm for 8 adversaries is: 15.30148529622232. distance: 1.8818718550955733
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 3.0185, Accuracy: 4019/8991 (44.7003%)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0024, Accuracy: 256/264 (96.9697%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   2,  Average loss: 0.0028, Accuracy: 248/264 (93.9394%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   3,  Average loss: 0.0040, Accuracy: 254/264 (96.2121%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   4,  Average loss: 0.0033, Accuracy: 255/264 (96.5909%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   5,  Average loss: 0.0013, Accuracy: 261/264 (98.8636%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   6,  Average loss: 0.0005, Accuracy: 262/264 (99.2424%), train_poison_data_count: 264
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   7,  Average loss: 0.0006, Accuracy: 261/264 (98.8636%), train_poison_data_count: 264
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   8,  Average loss: 0.0005, Accuracy: 262/264 (99.2424%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   9,  Average loss: 0.0004, Accuracy: 263/264 (99.6212%), train_poison_data_count: 264
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch  10,  Average loss: 0.0004, Accuracy: 263/264 (99.6212%), train_poison_data_count: 264
Global model norm: 15.39538017435395.
Norm before scaling: 15.472409210505768. Distance: 1.6426697114682982
Total norm for 8 adversaries is: 15.472409210505768. distance: 1.6426697114682982
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.3447, Accuracy: 7851/8991 (87.3207%)
poison local model 72 index 71 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0429, Accuracy: 9/10 (90.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   2,  Average loss: 0.0005, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   3,  Average loss: 0.0000, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   4,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   5,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   6,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   7,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   8,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   9,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch  10,  Average loss: 0.0001, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Global model norm: 15.39538017435395.
Norm before scaling: 15.390983894927128. Distance: 0.49044006713432553
Total norm for 8 adversaries is: 15.390983894927128. distance: 0.49044006713432553
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.6265, Accuracy: 7848/8991 (87.2873%)
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   1,  Average loss: 0.0007, Accuracy: 490/497 (98.5915%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   2,  Average loss: 0.0005, Accuracy: 492/497 (98.9940%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   3,  Average loss: 0.0001, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   4,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   5,  Average loss: 0.0000, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   6,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   7,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   8,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   9,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch  10,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Global model norm: 15.39538017435395.
Norm before scaling: 15.385452811117553. Distance: 1.0809037707123712
Total norm for 8 adversaries is: 15.385452811117553. distance: 1.0809037707123712
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 3.1372, Accuracy: 4758/8991 (52.9196%)
___Train Local_Simple,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0019, Accuracy: 29/30 (96.6667%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5559, Accuracy: 8666/10000 (86.6600%), Attack Success Rate:0/10000(0.000)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1247/1259 (99.0469%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1254/1259 (99.6029%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1257/1259 (99.8411%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Global model norm: 15.39538017435395.
Norm before scaling: 15.265649988784563. Distance: 0.9669542589109316
Total norm for 8 adversaries is: 15.265649988784563. distance: 0.9669542589109316
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.4101, Accuracy: 7915/8991 (88.0325%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 42/47 (89.3617%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   2,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   3,  Average loss: 0.0000, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   4,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   5,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   6,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   7,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   8,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   9,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch  10,  Average loss: 0.0001, Accuracy: 47/47 (100.0000%), train_poison_data_count: 47
Global model norm: 15.39538017435395.
Norm before scaling: 15.397328608284113. Distance: 0.4296189166735193
Total norm for 8 adversaries is: 15.397328608284113. distance: 0.4296189166735193
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.4021, Accuracy: 7934/8991 (88.2438%)
___Train Local_Simple,  epoch  43, local model 90, internal_epoch   1,  Average loss: 0.0022, Accuracy: 732/768 (95.3125%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.7173, Accuracy: 3855/10000 (38.5500%), Attack Success Rate:0/10000(0.000)
time spent on training: 195.79640913009644
[foolsgold agg] training data poison_ratio: 0.8806996561518912  data num: [179, 2324, 1311, 264, 10, 497, 30, 1259, 47, 768]
[foolsgold agg] considering poison per batch poison_fraction: 0.8806996561518912
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.6314, Accuracy: 8711/10000 (87.1100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.1190, Accuracy: 8675/8991 (96.4854%)
Done in 564.1911699771881 sec.
Server Epoch:44 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1810/1839 (98.4231%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1827/1839 (99.3475%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1829/1839 (99.4562%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1835/1839 (99.7825%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1837/1839 (99.8912%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1839/1839 (100.0000%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1839/1839 (100.0000%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1839/1839 (100.0000%), train_poison_data_count: 1839
Global model norm: 15.415990756227565.
Norm before scaling: 15.321105282904487. Distance: 1.6607284457398512
Total norm for 10 adversaries is: 15.321105282904487. distance: 1.6607284457398512
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.5887, Accuracy: 6184/8991 (68.7799%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   2,  Average loss: 0.0002, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   3,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   4,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   9,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 15.415990756227565.
Norm before scaling: 15.414469849375447. Distance: 0.09678555962787617
Total norm for 10 adversaries is: 15.414469849375447. distance: 0.09678555962787617
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1322, Accuracy: 8635/8991 (96.0405%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0002, Accuracy: 178/179 (99.4413%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   3,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   4,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   5,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   6,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   7,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   8,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   9,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch  10,  Average loss: 0.0000, Accuracy: 179/179 (100.0000%), train_poison_data_count: 179
Global model norm: 15.415990756227565.
Norm before scaling: 15.40689475546125. Distance: 0.21490187292230303
Total norm for 10 adversaries is: 15.40689475546125. distance: 0.21490187292230303
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.2292, Accuracy: 8380/8991 (93.2043%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0018, Accuracy: 257/263 (97.7186%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   2,  Average loss: 0.0007, Accuracy: 260/263 (98.8593%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   3,  Average loss: 0.0002, Accuracy: 262/263 (99.6198%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   4,  Average loss: 0.0001, Accuracy: 262/263 (99.6198%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   5,  Average loss: 0.0001, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   6,  Average loss: 0.0001, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   7,  Average loss: 0.0000, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   8,  Average loss: 0.0000, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   9,  Average loss: 0.0000, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch  10,  Average loss: 0.0000, Accuracy: 263/263 (100.0000%), train_poison_data_count: 263
Global model norm: 15.415990756227565.
Norm before scaling: 15.403951043926096. Distance: 0.9130181435289528
Total norm for 10 adversaries is: 15.403951043926096. distance: 0.9130181435289528
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.0559, Accuracy: 6604/8991 (73.4512%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1943/1982 (98.0323%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1954/1982 (98.5873%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1974/1982 (99.5964%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1977/1982 (99.7477%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1978/1982 (99.7982%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1980/1982 (99.8991%), train_poison_data_count: 1982
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1981/1982 (99.9495%), train_poison_data_count: 1982
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1981/1982 (99.9495%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1981/1982 (99.9495%), train_poison_data_count: 1982
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1981/1982 (99.9495%), train_poison_data_count: 1982
Global model norm: 15.415990756227565.
Norm before scaling: 15.326396257477194. Distance: 1.8996748169144426
Total norm for 10 adversaries is: 15.326396257477194. distance: 1.8996748169144426
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 2.6580, Accuracy: 4187/8991 (46.5688%)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0019, Accuracy: 236/244 (96.7213%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   2,  Average loss: 0.0008, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   3,  Average loss: 0.0004, Accuracy: 241/244 (98.7705%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   4,  Average loss: 0.0004, Accuracy: 242/244 (99.1803%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   5,  Average loss: 0.0003, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   6,  Average loss: 0.0002, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   7,  Average loss: 0.0001, Accuracy: 244/244 (100.0000%), train_poison_data_count: 244
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   8,  Average loss: 0.0001, Accuracy: 244/244 (100.0000%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   9,  Average loss: 0.0001, Accuracy: 244/244 (100.0000%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch  10,  Average loss: 0.0001, Accuracy: 244/244 (100.0000%), train_poison_data_count: 244
Global model norm: 15.415990756227565.
Norm before scaling: 15.414750483569403. Distance: 0.7750928484765296
Total norm for 10 adversaries is: 15.414750483569403. distance: 0.7750928484765296
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.6492, Accuracy: 5450/8991 (60.6162%)
poison local model 65 index 64 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1296/1326 (97.7376%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1313/1326 (99.0196%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1320/1326 (99.5475%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1323/1326 (99.7738%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1324/1326 (99.8492%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1325/1326 (99.9246%), train_poison_data_count: 1326
Global model norm: 15.415990756227565.
Norm before scaling: 15.382447462657113. Distance: 1.8937237149167536
Total norm for 10 adversaries is: 15.382447462657113. distance: 1.8937237149167536
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.7182, Accuracy: 5632/8991 (62.6404%)
poison local model 66 index 65 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   1,  Average loss: 0.0010, Accuracy: 669/681 (98.2379%), train_poison_data_count: 681
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   2,  Average loss: 0.0003, Accuracy: 678/681 (99.5595%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   3,  Average loss: 0.0001, Accuracy: 681/681 (100.0000%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   4,  Average loss: 0.0001, Accuracy: 681/681 (100.0000%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   5,  Average loss: 0.0000, Accuracy: 681/681 (100.0000%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   6,  Average loss: 0.0000, Accuracy: 681/681 (100.0000%), train_poison_data_count: 681
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   7,  Average loss: 0.0000, Accuracy: 681/681 (100.0000%), train_poison_data_count: 681
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   8,  Average loss: 0.0000, Accuracy: 681/681 (100.0000%), train_poison_data_count: 681
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   9,  Average loss: 0.0000, Accuracy: 681/681 (100.0000%), train_poison_data_count: 681
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch  10,  Average loss: 0.0000, Accuracy: 681/681 (100.0000%), train_poison_data_count: 681
Global model norm: 15.415990756227565.
Norm before scaling: 15.373350473633138. Distance: 1.1375291694841532
Total norm for 10 adversaries is: 15.373350473633138. distance: 1.1375291694841532
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.6641, Accuracy: 7295/8991 (81.1367%)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1190/1205 (98.7552%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1202/1205 (99.7510%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   3,  Average loss: 0.0000, Accuracy: 1204/1205 (99.9170%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   4,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   5,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1205/1205 (100.0000%), train_poison_data_count: 1205
Global model norm: 15.415990756227565.
Norm before scaling: 15.339391644884625. Distance: 1.4153579763230775
Total norm for 10 adversaries is: 15.339391644884625. distance: 1.4153579763230775
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 2.2011, Accuracy: 7004/8991 (77.9001%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1008/1033 (97.5799%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1015/1033 (98.2575%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   3,  Average loss: 0.0007, Accuracy: 1018/1033 (98.5479%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1032/1033 (99.9032%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1033/1033 (100.0000%), train_poison_data_count: 1033
Global model norm: 15.415990756227565.
Norm before scaling: 15.432152690727301. Distance: 1.7271853743143737
Total norm for 10 adversaries is: 15.432152690727301. distance: 1.7271853743143737
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 2.2661, Accuracy: 4766/8991 (53.0086%)
time spent on training: 212.59970617294312
[foolsgold agg] training data poison_ratio: 1.0  data num: [1839, 84, 179, 263, 1982, 244, 1326, 681, 1205, 1033]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 0.06587262 1.         1.         0.06587262]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.7016, Accuracy: 8724/10000 (87.2400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.1094, Accuracy: 8698/8991 (96.7412%)
Done in 540.2469820976257 sec.
Server Epoch:45 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
poison local model 53 index 52 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0011, Accuracy: 448/456 (98.2456%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   2,  Average loss: 0.0011, Accuracy: 446/456 (97.8070%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   3,  Average loss: 0.0009, Accuracy: 449/456 (98.4649%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   4,  Average loss: 0.0002, Accuracy: 455/456 (99.7807%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   5,  Average loss: 0.0001, Accuracy: 455/456 (99.7807%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   6,  Average loss: 0.0001, Accuracy: 455/456 (99.7807%), train_poison_data_count: 456
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   7,  Average loss: 0.0001, Accuracy: 455/456 (99.7807%), train_poison_data_count: 456
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   8,  Average loss: 0.0001, Accuracy: 455/456 (99.7807%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   9,  Average loss: 0.0001, Accuracy: 455/456 (99.7807%), train_poison_data_count: 456
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch  10,  Average loss: 0.0001, Accuracy: 456/456 (100.0000%), train_poison_data_count: 456
Global model norm: 15.438869894305128.
Norm before scaling: 15.422374651543715. Distance: 1.015228193968054
Total norm for 9 adversaries is: 15.422374651543715. distance: 1.015228193968054
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.8091, Accuracy: 7212/8991 (80.2135%)
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   1,  Average loss: 0.0006, Accuracy: 491/497 (98.7928%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   2,  Average loss: 0.0003, Accuracy: 494/497 (99.3964%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   3,  Average loss: 0.0001, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   4,  Average loss: 0.0001, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   5,  Average loss: 0.0000, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   6,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   7,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   8,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   9,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch  10,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Global model norm: 15.438869894305128.
Norm before scaling: 15.414934105647202. Distance: 0.880585723120181
Total norm for 9 adversaries is: 15.414934105647202. distance: 0.880585723120181
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 3.2584, Accuracy: 4880/8991 (54.2765%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0004, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   3,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   4,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   5,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   9,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch  10,  Average loss: 0.0000, Accuracy: 84/84 (100.0000%), train_poison_data_count: 84
Global model norm: 15.438869894305128.
Norm before scaling: 15.437632448191943. Distance: 0.16454867579530938
Total norm for 9 adversaries is: 15.437632448191943. distance: 0.16454867579530938
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1439, Accuracy: 8614/8991 (95.8069%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 567/578 (98.0969%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   2,  Average loss: 0.0004, Accuracy: 572/578 (98.9619%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   3,  Average loss: 0.0003, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   4,  Average loss: 0.0001, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   5,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 15.438869894305128.
Norm before scaling: 15.424369633436148. Distance: 0.8634967793822627
Total norm for 9 adversaries is: 15.424369633436148. distance: 0.8634967793822627
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.4338, Accuracy: 7719/8991 (85.8525%)
___Train Local_Simple,  epoch  45, local model 94, internal_epoch   1,  Average loss: 0.0010, Accuracy: 596/607 (98.1878%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.4306, Accuracy: 6706/10000 (67.0600%), Attack Success Rate:0/10000(0.000)
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 257/259 (99.2278%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Global model norm: 15.438869894305128.
Norm before scaling: 15.42423163035095. Distance: 0.45331377175085796
Total norm for 9 adversaries is: 15.42423163035095. distance: 0.45331377175085796
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.3949, Accuracy: 8073/8991 (89.7898%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1200/1232 (97.4026%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1220/1232 (99.0260%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1227/1232 (99.5942%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 1228/1232 (99.6753%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1230/1232 (99.8377%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1232/1232 (100.0000%), train_poison_data_count: 1232
Global model norm: 15.438869894305128.
Norm before scaling: 15.407455304334915. Distance: 1.8043552769956221
Total norm for 9 adversaries is: 15.407455304334915. distance: 1.8043552769956221
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 1.1746, Accuracy: 7208/8991 (80.1691%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1241/1259 (98.5703%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1250/1259 (99.2851%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1256/1259 (99.7617%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Global model norm: 15.438869894305128.
Norm before scaling: 15.342230385544502. Distance: 1.1861985754799156
Total norm for 9 adversaries is: 15.342230385544502. distance: 1.1861985754799156
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.3596, Accuracy: 8043/8991 (89.4561%)
poison local model 60 index 59 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   1,  Average loss: 0.0011, Accuracy: 393/399 (98.4962%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 398/399 (99.7494%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   3,  Average loss: 0.0001, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   4,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   5,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   6,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   7,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   8,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   9,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch  10,  Average loss: 0.0000, Accuracy: 399/399 (100.0000%), train_poison_data_count: 399
Global model norm: 15.438869894305128.
Norm before scaling: 15.425612100237455. Distance: 1.0954080820212766
Total norm for 9 adversaries is: 15.425612100237455. distance: 1.0954080820212766
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 5.5165, Accuracy: 2896/8991 (32.2100%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1024/1046 (97.8967%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1026/1046 (98.0880%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1042/1046 (99.6176%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1044/1046 (99.8088%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1045/1046 (99.9044%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1046/1046 (100.0000%), train_poison_data_count: 1046
Global model norm: 15.438869894305128.
Norm before scaling: 15.432242173797759. Distance: 1.6761209637091685
Total norm for 9 adversaries is: 15.432242173797759. distance: 1.6761209637091685
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.9107, Accuracy: 6647/8991 (73.9295%)
time spent on training: 173.8683478832245
[foolsgold agg] training data poison_ratio: 0.9054075112981144  data num: [456, 497, 84, 578, 607, 259, 1232, 1259, 399, 1046]
[foolsgold agg] considering poison per batch poison_fraction: 0.9054075112981144
[foolsgold agg] wv: [0.77626553 1.         1.         1.         0.77626553 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.7421, Accuracy: 8726/10000 (87.2600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.1100, Accuracy: 8699/8991 (96.7523%)
Done in 514.7572059631348 sec.
Server Epoch:46 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0007, Accuracy: 494/497 (99.3964%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   2,  Average loss: 0.0003, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   3,  Average loss: 0.0002, Accuracy: 495/497 (99.5976%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   4,  Average loss: 0.0001, Accuracy: 495/497 (99.5976%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   5,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   6,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   7,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   8,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   9,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch  10,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Global model norm: 15.46111711934571.
Norm before scaling: 15.418958888747666. Distance: 0.7822206570786956
Total norm for 10 adversaries is: 15.418958888747666. distance: 0.7822206570786956
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 1.8679, Accuracy: 5344/8991 (59.4372%)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   1,  Average loss: 0.0008, Accuracy: 2289/2324 (98.4940%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   2,  Average loss: 0.0004, Accuracy: 2299/2324 (98.9243%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   3,  Average loss: 0.0002, Accuracy: 2314/2324 (99.5697%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2319/2324 (99.7849%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2320/2324 (99.8279%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2321/2324 (99.8709%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   7,  Average loss: 0.0001, Accuracy: 2322/2324 (99.9139%), train_poison_data_count: 2324
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   8,  Average loss: 0.0001, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   9,  Average loss: 0.0001, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch  10,  Average loss: 0.0001, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Global model norm: 15.46111711934571.
Norm before scaling: 15.328033415883379. Distance: 1.6653888413305673
Total norm for 10 adversaries is: 15.328033415883379. distance: 1.6653888413305673
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.6451, Accuracy: 7307/8991 (81.2702%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0002, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   6,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 48/48 (100.0000%), train_poison_data_count: 48
Global model norm: 15.46111711934571.
Norm before scaling: 15.459952517260119. Distance: 0.04535065105419347
Total norm for 10 adversaries is: 15.459952517260119. distance: 0.04535065105419347
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1162, Accuracy: 8692/8991 (96.6745%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1250/1259 (99.2851%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1255/1259 (99.6823%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1258/1259 (99.9206%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   5,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1259/1259 (100.0000%), train_poison_data_count: 1259
Global model norm: 15.46111711934571.
Norm before scaling: 15.33821979005794. Distance: 0.8240173961691908
Total norm for 10 adversaries is: 15.33821979005794. distance: 0.8240173961691908
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.2945, Accuracy: 8227/8991 (91.5026%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0015, Accuracy: 83/86 (96.5116%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   3,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   4,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   5,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Global model norm: 15.46111711934571.
Norm before scaling: 15.45687280766027. Distance: 0.3258003700372212
Total norm for 10 adversaries is: 15.45687280766027. distance: 0.3258003700372212
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.4215, Accuracy: 7938/8991 (88.2883%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 673/688 (97.8198%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   2,  Average loss: 0.0008, Accuracy: 676/688 (98.2558%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   3,  Average loss: 0.0002, Accuracy: 685/688 (99.5640%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 687/688 (99.8547%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 15.46111711934571.
Norm before scaling: 15.456609720686396. Distance: 1.1504415037759328
Total norm for 10 adversaries is: 15.456609720686396. distance: 1.1504415037759328
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.7597, Accuracy: 6885/8991 (76.5766%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 432/436 (99.0826%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/436 (99.3119%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   3,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   4,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   5,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   6,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%), train_poison_data_count: 436
Global model norm: 15.46111711934571.
Norm before scaling: 15.464695747902553. Distance: 0.7351290301514248
Total norm for 10 adversaries is: 15.464695747902553. distance: 0.7351290301514248
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.8135, Accuracy: 7311/8991 (81.3146%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 111/119 (93.2773%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   2,  Average loss: 0.0013, Accuracy: 115/119 (96.6387%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   3,  Average loss: 0.0004, Accuracy: 118/119 (99.1597%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   4,  Average loss: 0.0002, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   5,  Average loss: 0.0001, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   6,  Average loss: 0.0001, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   7,  Average loss: 0.0001, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   8,  Average loss: 0.0001, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   9,  Average loss: 0.0001, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch  10,  Average loss: 0.0001, Accuracy: 119/119 (100.0000%), train_poison_data_count: 119
Global model norm: 15.46111711934571.
Norm before scaling: 15.460247623883548. Distance: 0.6190848581126971
Total norm for 10 adversaries is: 15.460247623883548. distance: 0.6190848581126971
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.5984, Accuracy: 7607/8991 (84.6068%)
poison local model 68 index 67 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1546/1591 (97.1716%), train_poison_data_count: 1591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1576/1591 (99.0572%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1588/1591 (99.8114%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1590/1591 (99.9371%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1590/1591 (99.9371%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1590/1591 (99.9371%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1590/1591 (99.9371%), train_poison_data_count: 1591
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1590/1591 (99.9371%), train_poison_data_count: 1591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1590/1591 (99.9371%), train_poison_data_count: 1591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1590/1591 (99.9371%), train_poison_data_count: 1591
Global model norm: 15.46111711934571.
Norm before scaling: 15.48762067081218. Distance: 1.877183088332673
Total norm for 10 adversaries is: 15.48762067081218. distance: 1.877183088332673
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 1.5946, Accuracy: 5607/8991 (62.3624%)
poison local model 54 index 53 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   1,  Average loss: 0.0026, Accuracy: 86/91 (94.5055%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   2,  Average loss: 0.0008, Accuracy: 89/91 (97.8022%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   3,  Average loss: 0.0009, Accuracy: 90/91 (98.9011%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   4,  Average loss: 0.0004, Accuracy: 90/91 (98.9011%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   5,  Average loss: 0.0002, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   6,  Average loss: 0.0001, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   7,  Average loss: 0.0001, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   8,  Average loss: 0.0001, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   9,  Average loss: 0.0001, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch  10,  Average loss: 0.0001, Accuracy: 91/91 (100.0000%), train_poison_data_count: 91
Global model norm: 15.46111711934571.
Norm before scaling: 15.462503670990369. Distance: 0.4274051043386376
Total norm for 10 adversaries is: 15.462503670990369. distance: 0.4274051043386376
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1798, Accuracy: 8496/8991 (94.4945%)
time spent on training: 245.23005414009094
[foolsgold agg] training data poison_ratio: 1.0  data num: [497, 2324, 48, 1259, 86, 688, 436, 119, 1591, 91]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [0.6671884  0.79883232 1.         0.79883232 0.80624628 0.6671884
 1.         1.         0.95721564 0.80624628]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.7930, Accuracy: 8733/10000 (87.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.1077, Accuracy: 8710/8991 (96.8747%)
Done in 713.6744868755341 sec.
Server Epoch:47 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  47, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 595/607 (98.0231%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.9001, Accuracy: 6436/10000 (64.3600%), Attack Success Rate:1/10000(0.010)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   1,  Average loss: 0.0002, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   3,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   4,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   5,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   6,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.482861303409813.
Norm before scaling: 15.480783178739648. Distance: 0.1515913933319341
Total norm for 7 adversaries is: 15.480783178739648. distance: 0.1515913933319341
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1257, Accuracy: 8671/8991 (96.4409%)
___Train Local_Simple,  epoch  47, local model 82, internal_epoch   1,  Average loss: 0.0007, Accuracy: 112/114 (98.2456%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.7071, Accuracy: 8580/10000 (85.8000%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 126/128 (98.4375%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   2,  Average loss: 0.0003, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   3,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   4,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 128/128 (100.0000%), train_poison_data_count: 128
Global model norm: 15.482861303409813.
Norm before scaling: 15.482122139972649. Distance: 0.24834332060545775
Total norm for 7 adversaries is: 15.482122139972649. distance: 0.24834332060545775
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1206, Accuracy: 8656/8991 (96.2741%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1301/1311 (99.2372%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1308/1311 (99.7712%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1309/1311 (99.8474%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   4,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1311/1311 (100.0000%), train_poison_data_count: 1311
Global model norm: 15.482861303409813.
Norm before scaling: 15.341629161440073. Distance: 1.3977310697979042
Total norm for 7 adversaries is: 15.341629161440073. distance: 1.3977310697979042
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 1.7514, Accuracy: 5077/8991 (56.4676%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0012, Accuracy: 968/994 (97.3843%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   2,  Average loss: 0.0006, Accuracy: 982/994 (98.7928%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   3,  Average loss: 0.0002, Accuracy: 992/994 (99.7988%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   4,  Average loss: 0.0001, Accuracy: 993/994 (99.8994%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   5,  Average loss: 0.0001, Accuracy: 994/994 (100.0000%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   6,  Average loss: 0.0001, Accuracy: 994/994 (100.0000%), train_poison_data_count: 994
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   7,  Average loss: 0.0001, Accuracy: 994/994 (100.0000%), train_poison_data_count: 994
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   8,  Average loss: 0.0001, Accuracy: 994/994 (100.0000%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   9,  Average loss: 0.0001, Accuracy: 994/994 (100.0000%), train_poison_data_count: 994
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch  10,  Average loss: 0.0001, Accuracy: 994/994 (100.0000%), train_poison_data_count: 994
Global model norm: 15.482861303409813.
Norm before scaling: 15.448157458016029. Distance: 1.3153675633906947
Total norm for 7 adversaries is: 15.448157458016029. distance: 1.3153675633906947
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.3878, Accuracy: 7907/8991 (87.9435%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0016, Accuracy: 85/86 (98.8372%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   3,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   4,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   5,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Global model norm: 15.482861303409813.
Norm before scaling: 15.479161190204842. Distance: 0.3762570610524423
Total norm for 7 adversaries is: 15.479161190204842. distance: 0.3762570610524423
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.6174, Accuracy: 7671/8991 (85.3187%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0005, Accuracy: 760/768 (98.9583%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 2.2295, Accuracy: 6384/10000 (63.8400%), Attack Success Rate:0/10000(0.000)
poison local model 68 index 67 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1571/1591 (98.7429%), train_poison_data_count: 1591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1578/1591 (99.1829%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1587/1591 (99.7486%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1589/1591 (99.8743%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1590/1591 (99.9371%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1590/1591 (99.9371%), train_poison_data_count: 1591
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1590/1591 (99.9371%), train_poison_data_count: 1591
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1590/1591 (99.9371%), train_poison_data_count: 1591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1591/1591 (100.0000%), train_poison_data_count: 1591
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1591/1591 (100.0000%), train_poison_data_count: 1591
Global model norm: 15.482861303409813.
Norm before scaling: 15.404754380370083. Distance: 1.36734823099561
Total norm for 7 adversaries is: 15.404754380370083. distance: 1.36734823099561
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 1.0930, Accuracy: 6483/8991 (72.1054%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0011, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   2,  Average loss: 0.0005, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   3,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   4,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   5,  Average loss: 0.0002, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   6,  Average loss: 0.0001, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   7,  Average loss: 0.0001, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   8,  Average loss: 0.0001, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   9,  Average loss: 0.0001, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch  10,  Average loss: 0.0001, Accuracy: 6/6 (100.0000%), train_poison_data_count: 6
Global model norm: 15.482861303409813.
Norm before scaling: 15.48179985366638. Distance: 0.050970250776667544
Total norm for 7 adversaries is: 15.48179985366638. distance: 0.050970250776667544
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1048, Accuracy: 8709/8991 (96.8635%)
time spent on training: 173.17429304122925
[foolsgold agg] training data poison_ratio: 0.7402755974184546  data num: [607, 128, 114, 128, 1311, 994, 86, 768, 1591, 6]
[foolsgold agg] considering poison per batch poison_fraction: 0.7402755974184546
[foolsgold agg] wv: [1.         1.         1.         0.92536623 1.         1.
 0.92536623 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.8116, Accuracy: 8736/10000 (87.3600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.1027, Accuracy: 8706/8991 (96.8302%)
Done in 566.1686961650848 sec.
Server Epoch:48 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
poison local model 74 index 73 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0011, Accuracy: 744/762 (97.6378%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 756/762 (99.2126%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   3,  Average loss: 0.0003, Accuracy: 758/762 (99.4751%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   4,  Average loss: 0.0002, Accuracy: 759/762 (99.6063%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 760/762 (99.7375%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 761/762 (99.8688%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 761/762 (99.8688%), train_poison_data_count: 762
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 761/762 (99.8688%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   9,  Average loss: 0.0001, Accuracy: 762/762 (100.0000%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch  10,  Average loss: 0.0001, Accuracy: 762/762 (100.0000%), train_poison_data_count: 762
Global model norm: 15.497796178856115.
Norm before scaling: 15.462942308592734. Distance: 1.3447536003148282
Total norm for 7 adversaries is: 15.462942308592734. distance: 1.3447536003148282
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1.2777, Accuracy: 7155/8991 (79.5796%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 664/678 (97.9351%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   2,  Average loss: 0.0022, Accuracy: 653/678 (96.3127%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   3,  Average loss: 0.0004, Accuracy: 673/678 (99.2625%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   4,  Average loss: 0.0003, Accuracy: 676/678 (99.7050%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   5,  Average loss: 0.0002, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   6,  Average loss: 0.0002, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 677/678 (99.8525%), train_poison_data_count: 678
Global model norm: 15.497796178856115.
Norm before scaling: 15.526076009567994. Distance: 1.7930799794653332
Total norm for 7 adversaries is: 15.526076009567994. distance: 1.7930799794653332
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1.8466, Accuracy: 4550/8991 (50.6062%)
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   1,  Average loss: 0.0005, Accuracy: 493/497 (99.1952%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   2,  Average loss: 0.0003, Accuracy: 493/497 (99.1952%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   3,  Average loss: 0.0001, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   4,  Average loss: 0.0001, Accuracy: 496/497 (99.7988%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   5,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   6,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   7,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   8,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   9,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch  10,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Global model norm: 15.497796178856115.
Norm before scaling: 15.4632452523832. Distance: 0.938967128994879
Total norm for 7 adversaries is: 15.4632452523832. distance: 0.938967128994879
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 3.6878, Accuracy: 4652/8991 (51.7406%)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0016, Accuracy: 235/244 (96.3115%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   2,  Average loss: 0.0006, Accuracy: 240/244 (98.3607%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   3,  Average loss: 0.0005, Accuracy: 240/244 (98.3607%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   4,  Average loss: 0.0003, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   5,  Average loss: 0.0002, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   6,  Average loss: 0.0002, Accuracy: 243/244 (99.5902%), train_poison_data_count: 244
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   7,  Average loss: 0.0001, Accuracy: 244/244 (100.0000%), train_poison_data_count: 244
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   8,  Average loss: 0.0001, Accuracy: 244/244 (100.0000%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   9,  Average loss: 0.0001, Accuracy: 244/244 (100.0000%), train_poison_data_count: 244
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch  10,  Average loss: 0.0001, Accuracy: 244/244 (100.0000%), train_poison_data_count: 244
Global model norm: 15.497796178856115.
Norm before scaling: 15.50354947703005. Distance: 0.863226944954414
Total norm for 7 adversaries is: 15.50354947703005. distance: 0.863226944954414
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 2.1960, Accuracy: 4998/8991 (55.5889%)
poison local model 58 index 57 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   1,  Average loss: 0.0014, Accuracy: 988/1015 (97.3399%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1007/1015 (99.2118%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1011/1015 (99.6059%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1013/1015 (99.8030%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1015/1015 (100.0000%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1015/1015 (100.0000%), train_poison_data_count: 1015
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1015/1015 (100.0000%), train_poison_data_count: 1015
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1015/1015 (100.0000%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1015/1015 (100.0000%), train_poison_data_count: 1015
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1015/1015 (100.0000%), train_poison_data_count: 1015
Global model norm: 15.497796178856115.
Norm before scaling: 15.459324286574137. Distance: 1.5738111398953936
Total norm for 7 adversaries is: 15.459324286574137. distance: 1.5738111398953936
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1.7463, Accuracy: 5602/8991 (62.3068%)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0009, Accuracy: 736/750 (98.1333%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.1224, Accuracy: 7412/10000 (74.1200%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0007, Accuracy: 179/182 (98.3516%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.7877, Accuracy: 8677/10000 (86.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 96, internal_epoch   1,  Average loss: 0.0066, Accuracy: 468/505 (92.6733%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.3765, Accuracy: 3815/10000 (38.1500%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 91/94 (96.8085%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   2,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   3,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   4,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   5,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Global model norm: 15.497796178856115.
Norm before scaling: 15.493128083839803. Distance: 0.37939260671316494
Total norm for 7 adversaries is: 15.493128083839803. distance: 0.37939260671316494
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.2892, Accuracy: 8248/8991 (91.7362%)
poison local model 57 index 56 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1402/1437 (97.5644%), train_poison_data_count: 1437
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1410/1437 (98.1211%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   3,  Average loss: 0.0003, Accuracy: 1431/1437 (99.5825%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1433/1437 (99.7216%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1435/1437 (99.8608%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1435/1437 (99.8608%), train_poison_data_count: 1437
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1435/1437 (99.8608%), train_poison_data_count: 1437
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1437/1437 (100.0000%), train_poison_data_count: 1437
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1437/1437 (100.0000%), train_poison_data_count: 1437
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1437/1437 (100.0000%), train_poison_data_count: 1437
Global model norm: 15.497796178856115.
Norm before scaling: 15.429978735384378. Distance: 1.6051802550015226
Total norm for 7 adversaries is: 15.429978735384378. distance: 1.6051802550015226
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.7528, Accuracy: 7315/8991 (81.3591%)
time spent on training: 181.88954210281372
[foolsgold agg] training data poison_ratio: 0.7668721609344581  data num: [762, 678, 497, 244, 1015, 750, 182, 505, 94, 1437]
[foolsgold agg] considering poison per batch poison_fraction: 0.7668721609344581
[foolsgold agg] wv: [1.         1.         1.         1.         0.59251917 1.
 0.59251917 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.6124, Accuracy: 8768/10000 (87.6800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.0953, Accuracy: 8732/8991 (97.1193%)
Done in 605.9580209255219 sec.
Server Epoch:49 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1522/1544 (98.5751%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1536/1544 (99.4819%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   3,  Average loss: 0.0001, Accuracy: 1540/1544 (99.7409%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1543/1544 (99.9352%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1543/1544 (99.9352%), train_poison_data_count: 1544
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1542/1544 (99.8705%), train_poison_data_count: 1544
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   8,  Average loss: 0.0000, Accuracy: 1543/1544 (99.9352%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   9,  Average loss: 0.0000, Accuracy: 1543/1544 (99.9352%), train_poison_data_count: 1544
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch  10,  Average loss: 0.0000, Accuracy: 1543/1544 (99.9352%), train_poison_data_count: 1544
Global model norm: 15.51127362194994.
Norm before scaling: 15.38459639621443. Distance: 1.4096317319635672
Total norm for 7 adversaries is: 15.38459639621443. distance: 1.4096317319635672
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.4185, Accuracy: 7934/8991 (88.2438%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 675/688 (98.1105%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   2,  Average loss: 0.0010, Accuracy: 673/688 (97.8198%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   3,  Average loss: 0.0006, Accuracy: 678/688 (98.5465%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 684/688 (99.4186%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 686/688 (99.7093%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 688/688 (100.0000%), train_poison_data_count: 688
Global model norm: 15.51127362194994.
Norm before scaling: 15.496661903499321. Distance: 1.2680726578139363
Total norm for 7 adversaries is: 15.496661903499321. distance: 1.2680726578139363
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 1.3573, Accuracy: 5684/8991 (63.2188%)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   1,  Average loss: 0.0007, Accuracy: 2289/2324 (98.4940%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   2,  Average loss: 0.0004, Accuracy: 2304/2324 (99.1394%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2322/2324 (99.9139%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   4,  Average loss: 0.0001, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   5,  Average loss: 0.0001, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   6,  Average loss: 0.0001, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2323/2324 (99.9570%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2324/2324 (100.0000%), train_poison_data_count: 2324
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2324/2324 (100.0000%), train_poison_data_count: 2324
Global model norm: 15.51127362194994.
Norm before scaling: 15.389707896216203. Distance: 1.6842676216960089
Total norm for 7 adversaries is: 15.389707896216203. distance: 1.6842676216960089
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.7076, Accuracy: 7213/8991 (80.2247%)
poison local model 72 index 71 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0262, Accuracy: 9/10 (90.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   2,  Average loss: 0.0002, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   3,  Average loss: 0.0000, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   4,  Average loss: 0.0000, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   5,  Average loss: 0.0000, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   6,  Average loss: 0.0000, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   7,  Average loss: 0.0000, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   8,  Average loss: 0.0000, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   9,  Average loss: 0.0000, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch  10,  Average loss: 0.0000, Accuracy: 10/10 (100.0000%), train_poison_data_count: 10
Global model norm: 15.51127362194994.
Norm before scaling: 15.509960788699377. Distance: 0.4469761807263375
Total norm for 7 adversaries is: 15.509960788699377. distance: 0.4469761807263375
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.6241, Accuracy: 7888/8991 (87.7322%)
___Train Local_Simple,  epoch  49, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 180/182 (98.9011%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6155, Accuracy: 8660/10000 (86.6000%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0780, Accuracy: 4/5 (80.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   2,  Average loss: 0.0000, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   3,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   4,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   7,  Average loss: 0.0002, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   8,  Average loss: 0.0002, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   9,  Average loss: 0.0002, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch  10,  Average loss: 0.0002, Accuracy: 5/5 (100.0000%), train_poison_data_count: 5
Global model norm: 15.51127362194994.
Norm before scaling: 15.534153381006911. Distance: 0.9645785998289385
Total norm for 7 adversaries is: 15.534153381006911. distance: 0.9645785998289385
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 1.4378, Accuracy: 6692/8991 (74.4300%)
___Train Local_Simple,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0000, Accuracy: 6/6 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6123, Accuracy: 8768/10000 (87.6800%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   1,  Average loss: 0.0007, Accuracy: 2042/2072 (98.5521%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   2,  Average loss: 0.0002, Accuracy: 2060/2072 (99.4208%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   3,  Average loss: 0.0001, Accuracy: 2069/2072 (99.8552%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   4,  Average loss: 0.0000, Accuracy: 2070/2072 (99.9035%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   5,  Average loss: 0.0000, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   6,  Average loss: 0.0000, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   7,  Average loss: 0.0000, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   8,  Average loss: 0.0000, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   9,  Average loss: 0.0000, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch  10,  Average loss: 0.0000, Accuracy: 2072/2072 (100.0000%), train_poison_data_count: 2072
Global model norm: 15.51127362194994.
Norm before scaling: 15.323301654943638. Distance: 1.6377549271489789
Total norm for 7 adversaries is: 15.323301654943638. distance: 1.6377549271489789
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 1.1370, Accuracy: 6274/8991 (69.7809%)
___Train Local_Simple,  epoch  49, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 113/114 (99.1228%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5235, Accuracy: 8685/10000 (86.8500%), Attack Success Rate:0/10000(0.000)
poison local model 74 index 73 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0010, Accuracy: 749/762 (98.2940%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 760/762 (99.7375%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 760/762 (99.7375%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 761/762 (99.8688%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 762/762 (100.0000%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 762/762 (100.0000%), train_poison_data_count: 762
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   7,  Average loss: 0.0001, Accuracy: 762/762 (100.0000%), train_poison_data_count: 762
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   8,  Average loss: 0.0001, Accuracy: 762/762 (100.0000%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 762/762 (100.0000%), train_poison_data_count: 762
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 762/762 (100.0000%), train_poison_data_count: 762
Global model norm: 15.51127362194994.
Norm before scaling: 15.463833854212968. Distance: 1.216170785172825
Total norm for 7 adversaries is: 15.463833854212968. distance: 1.216170785172825
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 1.9455, Accuracy: 6603/8991 (73.4401%)
time spent on training: 242.5775101184845
[foolsgold agg] training data poison_ratio: 0.9608148436486311  data num: [1544, 688, 2324, 10, 182, 5, 6, 2072, 114, 762]
[foolsgold agg] considering poison per batch poison_fraction: 0.9608148436486311
[foolsgold agg] wv: [1.         1.         0.97540748 1.         1.         0.40389826
 1.         1.         0.40389826 0.97540748]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.6688, Accuracy: 8769/10000 (87.6900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.0987, Accuracy: 8729/8991 (97.0860%)
Done in 638.1705811023712 sec.
Server Epoch:50 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0011, Accuracy: 491/497 (98.7928%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   2,  Average loss: 0.0003, Accuracy: 495/497 (99.5976%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   3,  Average loss: 0.0003, Accuracy: 494/497 (99.3964%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   4,  Average loss: 0.0001, Accuracy: 495/497 (99.5976%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   5,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   6,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   7,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   8,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   9,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch  10,  Average loss: 0.0000, Accuracy: 497/497 (100.0000%), train_poison_data_count: 497
Global model norm: 15.531699467685183.
Norm before scaling: 15.484464181283293. Distance: 0.945471978725001
Total norm for 8 adversaries is: 15.484464181283293. distance: 0.945471978725001
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 2.7906, Accuracy: 5203/8991 (57.8690%)
___Train Local_Simple,  epoch  50, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 34/34 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6734, Accuracy: 8764/10000 (87.6400%), Attack Success Rate:0/10000(0.000)
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 256/259 (98.8417%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   3,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   4,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 259/259 (100.0000%), train_poison_data_count: 259
Global model norm: 15.531699467685183.
Norm before scaling: 15.517073057584478. Distance: 0.5618891578222996
Total norm for 8 adversaries is: 15.517073057584478. distance: 0.5618891578222996
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.8077, Accuracy: 7653/8991 (85.1185%)
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 295/300 (98.3333%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6840, Accuracy: 8534/10000 (85.3400%), Attack Success Rate:0/10000(0.000)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1780/1839 (96.7917%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1816/1839 (98.7493%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   3,  Average loss: 0.0002, Accuracy: 1835/1839 (99.7825%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   4,  Average loss: 0.0001, Accuracy: 1835/1839 (99.7825%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   5,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1838/1839 (99.9456%), train_poison_data_count: 1839
Global model norm: 15.531699467685183.
Norm before scaling: 15.591920061089533. Distance: 2.4342492753006537
Total norm for 8 adversaries is: 15.591920061089533. distance: 2.4342492753006537
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 1.3533, Accuracy: 6108/8991 (67.9346%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   1,  Average loss: 0.0009, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   2,  Average loss: 0.0004, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   3,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   8,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   9,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch  10,  Average loss: 0.0001, Accuracy: 28/28 (100.0000%), train_poison_data_count: 28
Global model norm: 15.531699467685183.
Norm before scaling: 15.532679900695209. Distance: 0.10243820952745204
Total norm for 8 adversaries is: 15.532679900695209. distance: 0.10243820952745204
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0979, Accuracy: 8729/8991 (97.0860%)
poison local model 67 index 66 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   1,  Average loss: 0.0019, Accuracy: 552/568 (97.1831%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   2,  Average loss: 0.0007, Accuracy: 554/568 (97.5352%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   3,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   4,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   5,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   7,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   8,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   9,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch  10,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Global model norm: 15.531699467685183.
Norm before scaling: 15.543945036409575. Distance: 1.3546022839346579
Total norm for 8 adversaries is: 15.543945036409575. distance: 1.3546022839346579
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.2171, Accuracy: 8371/8991 (93.1042%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 92/94 (97.8723%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   2,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   3,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   4,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   5,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 94/94 (100.0000%), train_poison_data_count: 94
Global model norm: 15.531699467685183.
Norm before scaling: 15.529063878778137. Distance: 0.3372882810312382
Total norm for 8 adversaries is: 15.529063878778137. distance: 0.3372882810312382
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.2598, Accuracy: 8309/8991 (92.4146%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1213/1232 (98.4578%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1214/1232 (98.5390%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   3,  Average loss: 0.0004, Accuracy: 1225/1232 (99.4318%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   4,  Average loss: 0.0003, Accuracy: 1225/1232 (99.4318%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   5,  Average loss: 0.0002, Accuracy: 1228/1232 (99.6753%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 1229/1232 (99.7565%), train_poison_data_count: 1232
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 1230/1232 (99.8377%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 1231/1232 (99.9188%), train_poison_data_count: 1232
Global model norm: 15.531699467685183.
Norm before scaling: 15.490428307203937. Distance: 1.796749873573062
Total norm for 8 adversaries is: 15.490428307203937. distance: 1.796749873573062
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.8220, Accuracy: 7451/8991 (82.8718%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 84/86 (97.6744%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   3,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   4,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   5,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 86/86 (100.0000%), train_poison_data_count: 86
Global model norm: 15.531699467685183.
Norm before scaling: 15.526669108771568. Distance: 0.2674671137728841
Total norm for 8 adversaries is: 15.526669108771568. distance: 0.2674671137728841
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.2517, Accuracy: 8317/8991 (92.5036%)
time spent on training: 186.09857892990112
[foolsgold agg] training data poison_ratio: 0.9323475795017216  data num: [497, 34, 259, 300, 1839, 28, 568, 94, 1232, 86]
[foolsgold agg] considering poison per batch poison_fraction: 0.9323475795017216
[foolsgold agg] wv: [0.95631605 1.         1.         1.         1.         0.95631605
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.8445, Accuracy: 8755/10000 (87.5500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.0993, Accuracy: 8726/8991 (97.0526%)
Done in 571.4310548305511 sec.
Saving all the graphs.
This run has a label: Mar.04_13.42.11. Visdom environment: mnist_DBA
