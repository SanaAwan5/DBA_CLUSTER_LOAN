current path: saved_models/mnist_pretrain/model_mnist_Mar.04_21.27.56
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   1,  Average loss: 0.0376, Accuracy: 115/588 (19.5578%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   2,  Average loss: 0.0325, Accuracy: 177/588 (30.1020%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   3,  Average loss: 0.0220, Accuracy: 353/588 (60.0340%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   4,  Average loss: 0.0155, Accuracy: 466/588 (79.2517%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   5,  Average loss: 0.0123, Accuracy: 471/588 (80.1020%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   6,  Average loss: 0.0115, Accuracy: 481/588 (81.8027%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   7,  Average loss: 0.0095, Accuracy: 499/588 (84.8639%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   8,  Average loss: 0.0086, Accuracy: 509/588 (86.5646%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch   9,  Average loss: 0.0072, Accuracy: 516/588 (87.7551%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 23, internal_epoch  10,  Average loss: 0.0077, Accuracy: 517/588 (87.9252%), train_poison_data_count: 588
Global model norm: 13.89800383141575.
Norm before scaling: 14.290957300730033. Distance: 2.845655368883342
Total norm for 10 adversaries is: 14.290957300730033. distance: 2.845655368883342
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4173, Accuracy: 7898/8991 (87.8434%)
poison local model 72 index 71 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   1,  Average loss: 0.0378, Accuracy: 111/529 (20.9830%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   2,  Average loss: 0.0330, Accuracy: 184/529 (34.7826%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   3,  Average loss: 0.0245, Accuracy: 285/529 (53.8752%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   4,  Average loss: 0.0185, Accuracy: 381/529 (72.0227%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   5,  Average loss: 0.0125, Accuracy: 433/529 (81.8526%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   6,  Average loss: 0.0094, Accuracy: 441/529 (83.3648%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   7,  Average loss: 0.0072, Accuracy: 463/529 (87.5236%), train_poison_data_count: 529
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   8,  Average loss: 0.0062, Accuracy: 464/529 (87.7127%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch   9,  Average loss: 0.0057, Accuracy: 469/529 (88.6578%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 72, internal_epoch  10,  Average loss: 0.0052, Accuracy: 481/529 (90.9263%), train_poison_data_count: 529
Global model norm: 13.89800383141575.
Norm before scaling: 14.292435487284983. Distance: 2.816409128216716
Total norm for 10 adversaries is: 14.292435487284983. distance: 2.816409128216716
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4990, Accuracy: 7626/8991 (84.8182%)
poison local model 61 index 60 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   1,  Average loss: 0.0368, Accuracy: 132/537 (24.5810%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   2,  Average loss: 0.0323, Accuracy: 147/537 (27.3743%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   3,  Average loss: 0.0233, Accuracy: 340/537 (63.3147%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   4,  Average loss: 0.0177, Accuracy: 374/537 (69.6462%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   5,  Average loss: 0.0125, Accuracy: 435/537 (81.0056%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   6,  Average loss: 0.0100, Accuracy: 446/537 (83.0540%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   7,  Average loss: 0.0082, Accuracy: 466/537 (86.7784%), train_poison_data_count: 537
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   8,  Average loss: 0.0068, Accuracy: 471/537 (87.7095%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch   9,  Average loss: 0.0068, Accuracy: 471/537 (87.7095%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 61, internal_epoch  10,  Average loss: 0.0056, Accuracy: 494/537 (91.9926%), train_poison_data_count: 537
Global model norm: 13.89800383141575.
Norm before scaling: 14.284216775061667. Distance: 2.7847152724672153
Total norm for 10 adversaries is: 14.284216775061667. distance: 2.7847152724672153
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4810, Accuracy: 7655/8991 (85.1407%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0365, Accuracy: 152/644 (23.6025%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   2,  Average loss: 0.0375, Accuracy: 147/644 (22.8261%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   3,  Average loss: 0.0342, Accuracy: 163/644 (25.3106%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   4,  Average loss: 0.0313, Accuracy: 193/644 (29.9689%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   5,  Average loss: 0.0286, Accuracy: 283/644 (43.9441%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   6,  Average loss: 0.0228, Accuracy: 396/644 (61.4907%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   7,  Average loss: 0.0164, Accuracy: 476/644 (73.9130%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   8,  Average loss: 0.0115, Accuracy: 528/644 (81.9876%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch   9,  Average loss: 0.0093, Accuracy: 545/644 (84.6273%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 11, internal_epoch  10,  Average loss: 0.0087, Accuracy: 556/644 (86.3354%), train_poison_data_count: 644
Global model norm: 13.89800383141575.
Norm before scaling: 14.278624044853125. Distance: 3.1268475983521027
Total norm for 10 adversaries is: 14.278624044853125. distance: 3.1268475983521027
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.7645, Accuracy: 6858/8991 (76.2763%)
poison local model 71 index 70 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   1,  Average loss: 0.0347, Accuracy: 129/638 (20.2194%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   2,  Average loss: 0.0276, Accuracy: 256/638 (40.1254%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   3,  Average loss: 0.0182, Accuracy: 400/638 (62.6959%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   4,  Average loss: 0.0145, Accuracy: 439/638 (68.8088%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   5,  Average loss: 0.0114, Accuracy: 514/638 (80.5643%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   6,  Average loss: 0.0093, Accuracy: 519/638 (81.3480%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   7,  Average loss: 0.0078, Accuracy: 543/638 (85.1097%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   8,  Average loss: 0.0069, Accuracy: 546/638 (85.5799%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch   9,  Average loss: 0.0058, Accuracy: 567/638 (88.8715%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 71, internal_epoch  10,  Average loss: 0.0058, Accuracy: 568/638 (89.0282%), train_poison_data_count: 638
Global model norm: 13.89800383141575.
Norm before scaling: 14.312041562663458. Distance: 2.9224751717954325
Total norm for 10 adversaries is: 14.312041562663458. distance: 2.9224751717954325
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.3942, Accuracy: 7929/8991 (88.1882%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   1,  Average loss: 0.0360, Accuracy: 161/665 (24.2105%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   2,  Average loss: 0.0284, Accuracy: 277/665 (41.6541%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   3,  Average loss: 0.0141, Accuracy: 482/665 (72.4812%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   4,  Average loss: 0.0112, Accuracy: 521/665 (78.3459%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   5,  Average loss: 0.0090, Accuracy: 568/665 (85.4135%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   6,  Average loss: 0.0081, Accuracy: 565/665 (84.9624%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   7,  Average loss: 0.0074, Accuracy: 578/665 (86.9173%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   8,  Average loss: 0.0061, Accuracy: 594/665 (89.3233%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch   9,  Average loss: 0.0056, Accuracy: 600/665 (90.2256%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 42, internal_epoch  10,  Average loss: 0.0049, Accuracy: 612/665 (92.0301%), train_poison_data_count: 665
Global model norm: 13.89800383141575.
Norm before scaling: 14.337555788259214. Distance: 3.0690994778467893
Total norm for 10 adversaries is: 14.337555788259214. distance: 3.0690994778467893
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4089, Accuracy: 7862/8991 (87.4430%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   1,  Average loss: 0.0342, Accuracy: 199/750 (26.5333%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   2,  Average loss: 0.0235, Accuracy: 369/750 (49.2000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   3,  Average loss: 0.0116, Accuracy: 573/750 (76.4000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   4,  Average loss: 0.0092, Accuracy: 631/750 (84.1333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   5,  Average loss: 0.0077, Accuracy: 652/750 (86.9333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   6,  Average loss: 0.0068, Accuracy: 665/750 (88.6667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   7,  Average loss: 0.0060, Accuracy: 674/750 (89.8667%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   8,  Average loss: 0.0054, Accuracy: 684/750 (91.2000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch   9,  Average loss: 0.0049, Accuracy: 687/750 (91.6000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 45, internal_epoch  10,  Average loss: 0.0047, Accuracy: 693/750 (92.4000%), train_poison_data_count: 750
Global model norm: 13.89800383141575.
Norm before scaling: 14.396025299838625. Distance: 3.3292006782509964
Total norm for 10 adversaries is: 14.396025299838625. distance: 3.3292006782509964
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4046, Accuracy: 7942/8991 (88.3328%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   1,  Average loss: 0.0361, Accuracy: 123/641 (19.1888%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   2,  Average loss: 0.0413, Accuracy: 113/641 (17.6287%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   3,  Average loss: 0.0376, Accuracy: 100/641 (15.6006%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   4,  Average loss: 0.0380, Accuracy: 89/641 (13.8846%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   5,  Average loss: 0.0371, Accuracy: 89/641 (13.8846%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   6,  Average loss: 0.0370, Accuracy: 89/641 (13.8846%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   7,  Average loss: 0.0371, Accuracy: 101/641 (15.7566%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   8,  Average loss: 0.0360, Accuracy: 158/641 (24.6490%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch   9,  Average loss: 0.0354, Accuracy: 175/641 (27.3011%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 37, internal_epoch  10,  Average loss: 0.0350, Accuracy: 174/641 (27.1451%), train_poison_data_count: 641
Global model norm: 13.89800383141575.
Norm before scaling: 14.153295212806782. Distance: 3.2899899296475996
Total norm for 10 adversaries is: 14.153295212806782. distance: 3.2899899296475996
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 2.1664, Accuracy: 1855/8991 (20.6317%)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   1,  Average loss: 0.0351, Accuracy: 139/625 (22.2400%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   2,  Average loss: 0.0297, Accuracy: 179/625 (28.6400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   3,  Average loss: 0.0186, Accuracy: 408/625 (65.2800%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   4,  Average loss: 0.0136, Accuracy: 464/625 (74.2400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   5,  Average loss: 0.0102, Accuracy: 520/625 (83.2000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   6,  Average loss: 0.0087, Accuracy: 544/625 (87.0400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   7,  Average loss: 0.0080, Accuracy: 541/625 (86.5600%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   8,  Average loss: 0.0070, Accuracy: 542/625 (86.7200%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch   9,  Average loss: 0.0061, Accuracy: 568/625 (90.8800%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 21, internal_epoch  10,  Average loss: 0.0060, Accuracy: 568/625 (90.8800%), train_poison_data_count: 625
Global model norm: 13.89800383141575.
Norm before scaling: 14.29757565308413. Distance: 2.899037589496297
Total norm for 10 adversaries is: 14.29757565308413. distance: 2.899037589496297
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4711, Accuracy: 7697/8991 (85.6078%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   1,  Average loss: 0.0358, Accuracy: 124/493 (25.1521%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   2,  Average loss: 0.0316, Accuracy: 132/493 (26.7748%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   3,  Average loss: 0.0264, Accuracy: 204/493 (41.3793%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   4,  Average loss: 0.0229, Accuracy: 312/493 (63.2860%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   5,  Average loss: 0.0180, Accuracy: 352/493 (71.3996%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   6,  Average loss: 0.0140, Accuracy: 370/493 (75.0507%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   7,  Average loss: 0.0110, Accuracy: 402/493 (81.5416%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   8,  Average loss: 0.0088, Accuracy: 420/493 (85.1927%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch   9,  Average loss: 0.0078, Accuracy: 420/493 (85.1927%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   1, local model 35, internal_epoch  10,  Average loss: 0.0074, Accuracy: 433/493 (87.8296%), train_poison_data_count: 493
Global model norm: 13.89800383141575.
Norm before scaling: 14.226406978488212. Distance: 2.53546413438842
Total norm for 10 adversaries is: 14.226406978488212. distance: 2.53546413438842
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.6279, Accuracy: 7037/8991 (78.2672%)
time spent on training: 169.31519103050232
[foolsgold agg] training data poison_ratio: 1.0  data num: [588, 529, 537, 644, 638, 665, 750, 641, 625, 493]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [0.02673756 0.         0.         0.90689392 0.         0.13991343
 0.29627501 1.         0.         0.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2055, Accuracy: 4960/10000 (49.6000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.1769, Accuracy: 4971/8991 (55.2886%)
Done in 496.88091802597046 sec.
Server Epoch:2 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0286, Accuracy: 305/644 (47.3602%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   2,  Average loss: 0.0119, Accuracy: 502/644 (77.9503%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   3,  Average loss: 0.0067, Accuracy: 544/644 (84.4720%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   4,  Average loss: 0.0049, Accuracy: 580/644 (90.0621%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   5,  Average loss: 0.0039, Accuracy: 589/644 (91.4596%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   6,  Average loss: 0.0040, Accuracy: 592/644 (91.9255%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   7,  Average loss: 0.0030, Accuracy: 596/644 (92.5466%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   8,  Average loss: 0.0029, Accuracy: 603/644 (93.6335%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch   9,  Average loss: 0.0025, Accuracy: 609/644 (94.5652%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 11, internal_epoch  10,  Average loss: 0.0029, Accuracy: 609/644 (94.5652%), train_poison_data_count: 644
Global model norm: 13.9582321542897.
Norm before scaling: 14.867501556719693. Distance: 4.2796398392774435
Total norm for 9 adversaries is: 14.867501556719693. distance: 4.2796398392774435
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.4202, Accuracy: 7777/8991 (86.4976%)
poison local model 59 index 58 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   1,  Average loss: 0.0300, Accuracy: 258/652 (39.5706%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   2,  Average loss: 0.0121, Accuracy: 494/652 (75.7669%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   3,  Average loss: 0.0065, Accuracy: 570/652 (87.4233%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   4,  Average loss: 0.0046, Accuracy: 595/652 (91.2577%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   5,  Average loss: 0.0038, Accuracy: 609/652 (93.4049%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   6,  Average loss: 0.0036, Accuracy: 616/652 (94.4785%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   7,  Average loss: 0.0029, Accuracy: 626/652 (96.0123%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   8,  Average loss: 0.0026, Accuracy: 624/652 (95.7055%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch   9,  Average loss: 0.0023, Accuracy: 624/652 (95.7055%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 59, internal_epoch  10,  Average loss: 0.0026, Accuracy: 624/652 (95.7055%), train_poison_data_count: 652
Global model norm: 13.9582321542897.
Norm before scaling: 14.785736757923475. Distance: 4.08485436169394
Total norm for 9 adversaries is: 14.785736757923475. distance: 4.08485436169394
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.3210, Accuracy: 8187/8991 (91.0577%)
poison local model 62 index 61 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   1,  Average loss: 0.0306, Accuracy: 246/617 (39.8703%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   2,  Average loss: 0.0129, Accuracy: 450/617 (72.9335%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   3,  Average loss: 0.0064, Accuracy: 534/617 (86.5478%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   4,  Average loss: 0.0057, Accuracy: 539/617 (87.3582%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   5,  Average loss: 0.0046, Accuracy: 560/617 (90.7618%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   6,  Average loss: 0.0041, Accuracy: 564/617 (91.4100%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   7,  Average loss: 0.0038, Accuracy: 571/617 (92.5446%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   8,  Average loss: 0.0033, Accuracy: 581/617 (94.1653%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch   9,  Average loss: 0.0029, Accuracy: 584/617 (94.6515%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 62, internal_epoch  10,  Average loss: 0.0029, Accuracy: 587/617 (95.1378%), train_poison_data_count: 617
Global model norm: 13.9582321542897.
Norm before scaling: 14.655164601167218. Distance: 3.5797796296644364
Total norm for 9 adversaries is: 14.655164601167218. distance: 3.5797796296644364
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.2867, Accuracy: 8226/8991 (91.4915%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   1,  Average loss: 0.0290, Accuracy: 305/665 (45.8647%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   2,  Average loss: 0.0137, Accuracy: 496/665 (74.5865%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   3,  Average loss: 0.0059, Accuracy: 594/665 (89.3233%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   4,  Average loss: 0.0049, Accuracy: 604/665 (90.8271%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   5,  Average loss: 0.0042, Accuracy: 614/665 (92.3308%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   6,  Average loss: 0.0037, Accuracy: 620/665 (93.2331%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   7,  Average loss: 0.0033, Accuracy: 623/665 (93.6842%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   8,  Average loss: 0.0031, Accuracy: 626/665 (94.1353%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch   9,  Average loss: 0.0027, Accuracy: 632/665 (95.0376%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 28, internal_epoch  10,  Average loss: 0.0027, Accuracy: 633/665 (95.1880%), train_poison_data_count: 665
Global model norm: 13.9582321542897.
Norm before scaling: 14.84004785247244. Distance: 4.190979835456283
Total norm for 9 adversaries is: 14.84004785247244. distance: 4.190979835456283
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.2639, Accuracy: 8269/8991 (91.9697%)
poison local model 65 index 64 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   1,  Average loss: 0.0301, Accuracy: 231/573 (40.3141%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   2,  Average loss: 0.0142, Accuracy: 416/573 (72.6003%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   3,  Average loss: 0.0084, Accuracy: 486/573 (84.8168%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   4,  Average loss: 0.0063, Accuracy: 507/573 (88.4817%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   5,  Average loss: 0.0055, Accuracy: 513/573 (89.5288%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   6,  Average loss: 0.0046, Accuracy: 526/573 (91.7976%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   7,  Average loss: 0.0041, Accuracy: 532/573 (92.8447%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   8,  Average loss: 0.0037, Accuracy: 536/573 (93.5428%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch   9,  Average loss: 0.0033, Accuracy: 540/573 (94.2408%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 65, internal_epoch  10,  Average loss: 0.0033, Accuracy: 544/573 (94.9389%), train_poison_data_count: 573
Global model norm: 13.9582321542897.
Norm before scaling: 14.594675300229897. Distance: 3.3552686567231933
Total norm for 9 adversaries is: 14.594675300229897. distance: 3.3552686567231933
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.2864, Accuracy: 8200/8991 (91.2023%)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   1,  Average loss: 0.0317, Accuracy: 276/531 (51.9774%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   2,  Average loss: 0.0281, Accuracy: 301/531 (56.6855%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   3,  Average loss: 0.0157, Accuracy: 391/531 (73.6347%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   4,  Average loss: 0.0106, Accuracy: 442/531 (83.2392%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   5,  Average loss: 0.0081, Accuracy: 460/531 (86.6290%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   6,  Average loss: 0.0065, Accuracy: 470/531 (88.5122%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   7,  Average loss: 0.0050, Accuracy: 479/531 (90.2072%), train_poison_data_count: 531
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   8,  Average loss: 0.0043, Accuracy: 485/531 (91.3371%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch   9,  Average loss: 0.0039, Accuracy: 493/531 (92.8437%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 22, internal_epoch  10,  Average loss: 0.0039, Accuracy: 497/531 (93.5970%), train_poison_data_count: 531
Global model norm: 13.9582321542897.
Norm before scaling: 15.067041749139493. Distance: 5.1762245535392015
Total norm for 9 adversaries is: 15.067041749139493. distance: 5.1762245535392015
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.3088, Accuracy: 8178/8991 (90.9576%)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   1,  Average loss: 0.0296, Accuracy: 283/624 (45.3526%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   2,  Average loss: 0.0173, Accuracy: 410/624 (65.7051%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   3,  Average loss: 0.0076, Accuracy: 530/624 (84.9359%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   4,  Average loss: 0.0062, Accuracy: 552/624 (88.4615%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   5,  Average loss: 0.0053, Accuracy: 567/624 (90.8654%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   6,  Average loss: 0.0047, Accuracy: 571/624 (91.5064%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   7,  Average loss: 0.0041, Accuracy: 578/624 (92.6282%), train_poison_data_count: 624
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   8,  Average loss: 0.0036, Accuracy: 581/624 (93.1090%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch   9,  Average loss: 0.0031, Accuracy: 589/624 (94.3910%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 78, internal_epoch  10,  Average loss: 0.0031, Accuracy: 589/624 (94.3910%), train_poison_data_count: 624
Global model norm: 13.9582321542897.
Norm before scaling: 14.85061518875144. Distance: 4.219601919553202
Total norm for 9 adversaries is: 14.85061518875144. distance: 4.219601919553202
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.2884, Accuracy: 8238/8991 (91.6250%)
poison local model 58 index 57 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   1,  Average loss: 0.0302, Accuracy: 201/510 (39.4118%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   2,  Average loss: 0.0141, Accuracy: 355/510 (69.6078%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   3,  Average loss: 0.0070, Accuracy: 440/510 (86.2745%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   4,  Average loss: 0.0057, Accuracy: 459/510 (90.0000%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   5,  Average loss: 0.0049, Accuracy: 463/510 (90.7843%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   6,  Average loss: 0.0044, Accuracy: 472/510 (92.5490%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   7,  Average loss: 0.0040, Accuracy: 474/510 (92.9412%), train_poison_data_count: 510
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   8,  Average loss: 0.0036, Accuracy: 476/510 (93.3333%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch   9,  Average loss: 0.0033, Accuracy: 481/510 (94.3137%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 58, internal_epoch  10,  Average loss: 0.0033, Accuracy: 483/510 (94.7059%), train_poison_data_count: 510
Global model norm: 13.9582321542897.
Norm before scaling: 14.543322857796074. Distance: 3.1988695114724863
Total norm for 9 adversaries is: 14.543322857796074. distance: 3.1988695114724863
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.3498, Accuracy: 8054/8991 (89.5785%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   1,  Average loss: 0.0300, Accuracy: 352/652 (53.9877%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   2,  Average loss: 0.0266, Accuracy: 350/652 (53.6810%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   3,  Average loss: 0.0107, Accuracy: 515/652 (78.9877%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   4,  Average loss: 0.0084, Accuracy: 566/652 (86.8098%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   5,  Average loss: 0.0068, Accuracy: 580/652 (88.9571%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   6,  Average loss: 0.0061, Accuracy: 590/652 (90.4908%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   7,  Average loss: 0.0051, Accuracy: 590/652 (90.4908%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   8,  Average loss: 0.0043, Accuracy: 593/652 (90.9509%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch   9,  Average loss: 0.0038, Accuracy: 609/652 (93.4049%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   2, local model 41, internal_epoch  10,  Average loss: 0.0040, Accuracy: 609/652 (93.4049%), train_poison_data_count: 652
Global model norm: 13.9582321542897.
Norm before scaling: 15.979305712688843. Distance: 7.3355318877482825
Total norm for 9 adversaries is: 15.979305712688843. distance: 7.3355318877482825
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.3720, Accuracy: 8023/8991 (89.2337%)
___Train Local_Simple,  epoch   2, local model 81, internal_epoch   1,  Average loss: 0.0308, Accuracy: 302/586 (51.5358%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.2362, Accuracy: 6006/10000 (60.0600%), Attack Success Rate:0/10000(0.000)
time spent on training: 156.80442094802856
[foolsgold agg] training data poison_ratio: 0.903204492897258  data num: [644, 652, 617, 665, 573, 531, 624, 510, 652, 586]
[foolsgold agg] considering poison per batch poison_fraction: 0.903204492897258
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 1.6951, Accuracy: 4624/10000 (46.2400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 1.4357, Accuracy: 4741/8991 (52.7305%)
Done in 450.57281589508057 sec.
Server Epoch:3 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
poison local model 54 index 53 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   1,  Average loss: 0.0161, Accuracy: 393/523 (75.1434%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   2,  Average loss: 0.0244, Accuracy: 341/523 (65.2008%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   3,  Average loss: 0.0130, Accuracy: 411/523 (78.5851%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   4,  Average loss: 0.0072, Accuracy: 474/523 (90.6310%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   5,  Average loss: 0.0048, Accuracy: 479/523 (91.5870%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   6,  Average loss: 0.0036, Accuracy: 496/523 (94.8375%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   7,  Average loss: 0.0035, Accuracy: 498/523 (95.2199%), train_poison_data_count: 523
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   8,  Average loss: 0.0029, Accuracy: 496/523 (94.8375%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch   9,  Average loss: 0.0026, Accuracy: 503/523 (96.1759%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 54, internal_epoch  10,  Average loss: 0.0023, Accuracy: 505/523 (96.5583%), train_poison_data_count: 523
Global model norm: 14.209786408850636.
Norm before scaling: 15.85502894191693. Distance: 6.195702866405801
Total norm for 9 adversaries is: 15.85502894191693. distance: 6.195702866405801
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.3163, Accuracy: 8230/8991 (91.5360%)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   1,  Average loss: 0.0136, Accuracy: 468/592 (79.0541%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   2,  Average loss: 0.0073, Accuracy: 522/592 (88.1757%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   3,  Average loss: 0.0046, Accuracy: 535/592 (90.3716%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   4,  Average loss: 0.0028, Accuracy: 565/592 (95.4392%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   5,  Average loss: 0.0025, Accuracy: 571/592 (96.4527%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   6,  Average loss: 0.0021, Accuracy: 573/592 (96.7905%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   7,  Average loss: 0.0018, Accuracy: 577/592 (97.4662%), train_poison_data_count: 592
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   8,  Average loss: 0.0016, Accuracy: 577/592 (97.4662%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch   9,  Average loss: 0.0014, Accuracy: 580/592 (97.9730%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 55, internal_epoch  10,  Average loss: 0.0017, Accuracy: 580/592 (97.9730%), train_poison_data_count: 592
Global model norm: 14.209786408850636.
Norm before scaling: 15.083960476196593. Distance: 3.57881018062707
Total norm for 9 adversaries is: 15.083960476196593. distance: 3.57881018062707
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2449, Accuracy: 8352/8991 (92.8929%)
poison local model 61 index 60 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   1,  Average loss: 0.0117, Accuracy: 435/537 (81.0056%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   2,  Average loss: 0.0199, Accuracy: 417/537 (77.6536%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   3,  Average loss: 0.0116, Accuracy: 446/537 (83.0540%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   4,  Average loss: 0.0093, Accuracy: 461/537 (85.8473%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   5,  Average loss: 0.0071, Accuracy: 481/537 (89.5717%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   6,  Average loss: 0.0047, Accuracy: 508/537 (94.5996%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   7,  Average loss: 0.0031, Accuracy: 512/537 (95.3445%), train_poison_data_count: 537
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   8,  Average loss: 0.0025, Accuracy: 514/537 (95.7169%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch   9,  Average loss: 0.0024, Accuracy: 519/537 (96.6480%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 61, internal_epoch  10,  Average loss: 0.0022, Accuracy: 520/537 (96.8343%), train_poison_data_count: 537
Global model norm: 14.209786408850636.
Norm before scaling: 15.560685017469206. Distance: 5.344882064388939
Total norm for 9 adversaries is: 15.560685017469206. distance: 5.344882064388939
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2982, Accuracy: 8212/8991 (91.3358%)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   1,  Average loss: 0.0123, Accuracy: 483/626 (77.1565%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   2,  Average loss: 0.0075, Accuracy: 541/626 (86.4217%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   3,  Average loss: 0.0037, Accuracy: 584/626 (93.2907%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   4,  Average loss: 0.0027, Accuracy: 596/626 (95.2077%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   5,  Average loss: 0.0022, Accuracy: 600/626 (95.8466%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   6,  Average loss: 0.0020, Accuracy: 603/626 (96.3259%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   7,  Average loss: 0.0018, Accuracy: 604/626 (96.4856%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   8,  Average loss: 0.0015, Accuracy: 609/626 (97.2843%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch   9,  Average loss: 0.0014, Accuracy: 610/626 (97.4441%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 73, internal_epoch  10,  Average loss: 0.0014, Accuracy: 611/626 (97.6038%), train_poison_data_count: 626
Global model norm: 14.209786408850636.
Norm before scaling: 14.96814243939232. Distance: 3.278145911310954
Total norm for 9 adversaries is: 14.96814243939232. distance: 3.278145911310954
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2417, Accuracy: 8338/8991 (92.7372%)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   1,  Average loss: 0.0218, Accuracy: 380/516 (73.6434%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   2,  Average loss: 0.0170, Accuracy: 374/516 (72.4806%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   3,  Average loss: 0.0092, Accuracy: 430/516 (83.3333%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   4,  Average loss: 0.0060, Accuracy: 461/516 (89.3411%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   5,  Average loss: 0.0045, Accuracy: 477/516 (92.4419%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   6,  Average loss: 0.0039, Accuracy: 480/516 (93.0233%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   7,  Average loss: 0.0035, Accuracy: 486/516 (94.1860%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   8,  Average loss: 0.0030, Accuracy: 491/516 (95.1550%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch   9,  Average loss: 0.0027, Accuracy: 497/516 (96.3178%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 18, internal_epoch  10,  Average loss: 0.0025, Accuracy: 496/516 (96.1240%), train_poison_data_count: 516
Global model norm: 14.209786408850636.
Norm before scaling: 16.230948680479504. Distance: 7.009308756269954
Total norm for 9 adversaries is: 16.230948680479504. distance: 7.009308756269954
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2785, Accuracy: 8235/8991 (91.5916%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   1,  Average loss: 0.0174, Accuracy: 499/665 (75.0376%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   2,  Average loss: 0.0136, Accuracy: 515/665 (77.4436%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   3,  Average loss: 0.0088, Accuracy: 566/665 (85.1128%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   4,  Average loss: 0.0069, Accuracy: 589/665 (88.5714%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   5,  Average loss: 0.0048, Accuracy: 621/665 (93.3835%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   6,  Average loss: 0.0033, Accuracy: 633/665 (95.1880%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   7,  Average loss: 0.0025, Accuracy: 637/665 (95.7895%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   8,  Average loss: 0.0021, Accuracy: 642/665 (96.5414%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch   9,  Average loss: 0.0019, Accuracy: 643/665 (96.6917%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 42, internal_epoch  10,  Average loss: 0.0019, Accuracy: 643/665 (96.6917%), train_poison_data_count: 665
Global model norm: 14.209786408850636.
Norm before scaling: 16.180204301258645. Distance: 6.835975725339554
Total norm for 9 adversaries is: 16.180204301258645. distance: 6.835975725339554
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2725, Accuracy: 8301/8991 (92.3257%)
___Train Local_Simple,  epoch   3, local model 87, internal_epoch   1,  Average loss: 0.0184, Accuracy: 361/575 (62.7826%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6848, Accuracy: 7507/10000 (75.0700%), Attack Success Rate:0/10000(0.000)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   1,  Average loss: 0.0141, Accuracy: 499/652 (76.5337%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   2,  Average loss: 0.0083, Accuracy: 553/652 (84.8160%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   3,  Average loss: 0.0037, Accuracy: 602/652 (92.3313%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   4,  Average loss: 0.0031, Accuracy: 617/652 (94.6319%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   5,  Average loss: 0.0023, Accuracy: 627/652 (96.1656%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   6,  Average loss: 0.0022, Accuracy: 630/652 (96.6258%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   7,  Average loss: 0.0019, Accuracy: 636/652 (97.5460%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   8,  Average loss: 0.0018, Accuracy: 635/652 (97.3926%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch   9,  Average loss: 0.0016, Accuracy: 641/652 (98.3129%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 41, internal_epoch  10,  Average loss: 0.0015, Accuracy: 642/652 (98.4663%), train_poison_data_count: 652
Global model norm: 14.209786408850636.
Norm before scaling: 15.175148293589157. Distance: 3.9891368460086802
Total norm for 9 adversaries is: 15.175148293589157. distance: 3.9891368460086802
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2645, Accuracy: 8262/8991 (91.8919%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   1,  Average loss: 0.0155, Accuracy: 342/474 (72.1519%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   2,  Average loss: 0.0097, Accuracy: 392/474 (82.7004%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   3,  Average loss: 0.0040, Accuracy: 444/474 (93.6709%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   4,  Average loss: 0.0031, Accuracy: 450/474 (94.9367%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   5,  Average loss: 0.0025, Accuracy: 456/474 (96.2025%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   6,  Average loss: 0.0021, Accuracy: 460/474 (97.0464%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   7,  Average loss: 0.0020, Accuracy: 462/474 (97.4684%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   8,  Average loss: 0.0017, Accuracy: 461/474 (97.2574%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch   9,  Average loss: 0.0015, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 50, internal_epoch  10,  Average loss: 0.0015, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Global model norm: 14.209786408850636.
Norm before scaling: 14.910770778369512. Distance: 3.151760874657681
Total norm for 9 adversaries is: 14.910770778369512. distance: 3.151760874657681
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2367, Accuracy: 8363/8991 (93.0152%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   1,  Average loss: 0.0129, Accuracy: 519/665 (78.0451%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   2,  Average loss: 0.0196, Accuracy: 493/665 (74.1353%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   3,  Average loss: 0.0064, Accuracy: 593/665 (89.1729%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   4,  Average loss: 0.0050, Accuracy: 599/665 (90.0752%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   5,  Average loss: 0.0039, Accuracy: 617/665 (92.7820%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   6,  Average loss: 0.0032, Accuracy: 629/665 (94.5865%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   7,  Average loss: 0.0029, Accuracy: 633/665 (95.1880%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   8,  Average loss: 0.0026, Accuracy: 632/665 (95.0376%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch   9,  Average loss: 0.0023, Accuracy: 634/665 (95.3383%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   3, local model 28, internal_epoch  10,  Average loss: 0.0021, Accuracy: 636/665 (95.6391%), train_poison_data_count: 665
Global model norm: 14.209786408850636.
Norm before scaling: 16.510224844442988. Distance: 7.5492182345835745
Total norm for 9 adversaries is: 16.510224844442988. distance: 7.5492182345835745
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2431, Accuracy: 8293/8991 (92.2367%)
time spent on training: 127.68073606491089
[foolsgold agg] training data poison_ratio: 0.9012875536480687  data num: [523, 592, 537, 626, 516, 665, 575, 652, 474, 665]
[foolsgold agg] considering poison per batch poison_fraction: 0.9012875536480687
[foolsgold agg] wv: [1.         0.81782207 0.62788594 0.81782207 1.         0.62788594
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 1.4450, Accuracy: 6680/10000 (66.8000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 0.8006, Accuracy: 6885/8991 (76.5766%)
Done in 378.3455460071564 sec.
Server Epoch:4 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   1,  Average loss: 0.0073, Accuracy: 553/641 (86.2715%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   2,  Average loss: 0.0053, Accuracy: 562/641 (87.6755%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   3,  Average loss: 0.0027, Accuracy: 605/641 (94.3838%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   4,  Average loss: 0.0018, Accuracy: 619/641 (96.5679%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   5,  Average loss: 0.0014, Accuracy: 623/641 (97.1919%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   6,  Average loss: 0.0011, Accuracy: 627/641 (97.8159%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   7,  Average loss: 0.0014, Accuracy: 629/641 (98.1279%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   8,  Average loss: 0.0021, Accuracy: 616/641 (96.0998%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch   9,  Average loss: 0.0013, Accuracy: 623/641 (97.1919%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 37, internal_epoch  10,  Average loss: 0.0016, Accuracy: 625/641 (97.5039%), train_poison_data_count: 641
Global model norm: 14.465611160611225.
Norm before scaling: 15.166869165654655. Distance: 3.1385836063642123
Total norm for 6 adversaries is: 15.166869165654655. distance: 3.1385836063642123
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2884, Accuracy: 8256/8991 (91.8252%)
___Train Local_Simple,  epoch   4, local model 92, internal_epoch   1,  Average loss: 0.0178, Accuracy: 381/571 (66.7250%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.4182, Accuracy: 8625/10000 (86.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 95, internal_epoch   1,  Average loss: 0.0213, Accuracy: 347/532 (65.2256%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.9594, Accuracy: 5571/10000 (55.7100%), Attack Success Rate:1/10000(0.010)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   1,  Average loss: 0.0088, Accuracy: 440/518 (84.9421%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   2,  Average loss: 0.0055, Accuracy: 461/518 (88.9961%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   3,  Average loss: 0.0031, Accuracy: 483/518 (93.2432%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   4,  Average loss: 0.0023, Accuracy: 495/518 (95.5598%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   5,  Average loss: 0.0029, Accuracy: 501/518 (96.7181%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   6,  Average loss: 0.0017, Accuracy: 501/518 (96.7181%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   7,  Average loss: 0.0017, Accuracy: 505/518 (97.4903%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   8,  Average loss: 0.0013, Accuracy: 506/518 (97.6834%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch   9,  Average loss: 0.0012, Accuracy: 507/518 (97.8764%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 76, internal_epoch  10,  Average loss: 0.0012, Accuracy: 507/518 (97.8764%), train_poison_data_count: 518
Global model norm: 14.465611160611225.
Norm before scaling: 15.033053284015162. Distance: 2.832425215054575
Total norm for 6 adversaries is: 15.033053284015162. distance: 2.832425215054575
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2487, Accuracy: 8302/8991 (92.3368%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0080, Accuracy: 457/521 (87.7159%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   2,  Average loss: 0.0045, Accuracy: 477/521 (91.5547%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   3,  Average loss: 0.0039, Accuracy: 479/521 (91.9386%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   4,  Average loss: 0.0024, Accuracy: 501/521 (96.1612%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   5,  Average loss: 0.0026, Accuracy: 505/521 (96.9290%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   6,  Average loss: 0.0016, Accuracy: 509/521 (97.6967%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   7,  Average loss: 0.0017, Accuracy: 508/521 (97.5048%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   8,  Average loss: 0.0012, Accuracy: 514/521 (98.6564%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch   9,  Average loss: 0.0012, Accuracy: 513/521 (98.4645%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 13, internal_epoch  10,  Average loss: 0.0011, Accuracy: 514/521 (98.6564%), train_poison_data_count: 521
Global model norm: 14.465611160611225.
Norm before scaling: 14.955584061777937. Distance: 2.5352882856362076
Total norm for 6 adversaries is: 14.955584061777937. distance: 2.5352882856362076
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2236, Accuracy: 8352/8991 (92.8929%)
___Train Local_Simple,  epoch   4, local model 99, internal_epoch   1,  Average loss: 0.0112, Accuracy: 324/410 (79.0244%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.6416, Accuracy: 6470/10000 (64.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 94, internal_epoch   1,  Average loss: 0.0187, Accuracy: 352/555 (63.4234%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.1886, Accuracy: 7468/10000 (74.6800%), Attack Success Rate:0/10000(0.000)
poison local model 74 index 73 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   1,  Average loss: 0.0110, Accuracy: 491/626 (78.4345%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   2,  Average loss: 0.0047, Accuracy: 569/626 (90.8946%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   3,  Average loss: 0.0031, Accuracy: 584/626 (93.2907%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   4,  Average loss: 0.0017, Accuracy: 605/626 (96.6454%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   5,  Average loss: 0.0015, Accuracy: 607/626 (96.9649%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   6,  Average loss: 0.0013, Accuracy: 611/626 (97.6038%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   7,  Average loss: 0.0010, Accuracy: 615/626 (98.2428%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   8,  Average loss: 0.0010, Accuracy: 616/626 (98.4026%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch   9,  Average loss: 0.0008, Accuracy: 619/626 (98.8818%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 74, internal_epoch  10,  Average loss: 0.0008, Accuracy: 619/626 (98.8818%), train_poison_data_count: 626
Global model norm: 14.465611160611225.
Norm before scaling: 15.22876649566511. Distance: 3.5640869621430764
Total norm for 6 adversaries is: 15.22876649566511. distance: 3.5640869621430764
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.1834, Accuracy: 8510/8991 (94.6502%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   1,  Average loss: 0.0077, Accuracy: 645/750 (86.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   2,  Average loss: 0.0037, Accuracy: 697/750 (92.9333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   3,  Average loss: 0.0024, Accuracy: 721/750 (96.1333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   4,  Average loss: 0.0017, Accuracy: 732/750 (97.6000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   5,  Average loss: 0.0014, Accuracy: 733/750 (97.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   6,  Average loss: 0.0012, Accuracy: 736/750 (98.1333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   7,  Average loss: 0.0011, Accuracy: 740/750 (98.6667%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   8,  Average loss: 0.0010, Accuracy: 740/750 (98.6667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch   9,  Average loss: 0.0009, Accuracy: 743/750 (99.0667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 45, internal_epoch  10,  Average loss: 0.0009, Accuracy: 743/750 (99.0667%), train_poison_data_count: 750
Global model norm: 14.465611160611225.
Norm before scaling: 15.071869148318116. Distance: 2.883425929028835
Total norm for 6 adversaries is: 15.071869148318116. distance: 2.883425929028835
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2096, Accuracy: 8462/8991 (94.1163%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   1,  Average loss: 0.0085, Accuracy: 445/518 (85.9073%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   2,  Average loss: 0.0072, Accuracy: 446/518 (86.1004%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   3,  Average loss: 0.0042, Accuracy: 477/518 (92.0849%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   4,  Average loss: 0.0024, Accuracy: 495/518 (95.5598%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   5,  Average loss: 0.0019, Accuracy: 497/518 (95.9459%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   6,  Average loss: 0.0015, Accuracy: 501/518 (96.7181%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   7,  Average loss: 0.0015, Accuracy: 505/518 (97.4903%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   8,  Average loss: 0.0011, Accuracy: 508/518 (98.0695%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch   9,  Average loss: 0.0010, Accuracy: 508/518 (98.0695%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   4, local model 44, internal_epoch  10,  Average loss: 0.0010, Accuracy: 508/518 (98.0695%), train_poison_data_count: 518
Global model norm: 14.465611160611225.
Norm before scaling: 15.099709292007082. Distance: 2.9587650431809402
Total norm for 6 adversaries is: 15.099709292007082. distance: 2.9587650431809402
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2113, Accuracy: 8440/8991 (93.8716%)
time spent on training: 99.82948112487793
[foolsgold agg] training data poison_ratio: 0.6334633108826657  data num: [641, 571, 532, 518, 521, 410, 555, 626, 750, 518]
[foolsgold agg] considering poison per batch poison_fraction: 0.6334633108826657
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 1.4523, Accuracy: 7064/10000 (70.6400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 0.6307, Accuracy: 7264/8991 (80.7919%)
Done in 353.6247799396515 sec.
Server Epoch:5 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
poison local model 60 index 59 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   1,  Average loss: 0.0058, Accuracy: 588/644 (91.3043%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   2,  Average loss: 0.0083, Accuracy: 541/644 (84.0062%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   3,  Average loss: 0.0035, Accuracy: 616/644 (95.6522%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   4,  Average loss: 0.0026, Accuracy: 612/644 (95.0311%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   5,  Average loss: 0.0022, Accuracy: 619/644 (96.1180%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   6,  Average loss: 0.0018, Accuracy: 628/644 (97.5155%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   7,  Average loss: 0.0012, Accuracy: 634/644 (98.4472%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   8,  Average loss: 0.0010, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch   9,  Average loss: 0.0009, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 60, internal_epoch  10,  Average loss: 0.0010, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Global model norm: 14.619729160038862.
Norm before scaling: 15.351866647750445. Distance: 3.471637657973435
Total norm for 10 adversaries is: 15.351866647750445. distance: 3.471637657973435
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2055, Accuracy: 8487/8991 (94.3944%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   1,  Average loss: 0.0063, Accuracy: 463/516 (89.7287%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   2,  Average loss: 0.0070, Accuracy: 448/516 (86.8217%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   3,  Average loss: 0.0039, Accuracy: 476/516 (92.2481%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   4,  Average loss: 0.0025, Accuracy: 495/516 (95.9302%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   5,  Average loss: 0.0021, Accuracy: 499/516 (96.7054%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   6,  Average loss: 0.0016, Accuracy: 504/516 (97.6744%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   7,  Average loss: 0.0014, Accuracy: 502/516 (97.2868%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   8,  Average loss: 0.0013, Accuracy: 505/516 (97.8682%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch   9,  Average loss: 0.0010, Accuracy: 508/516 (98.4496%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 49, internal_epoch  10,  Average loss: 0.0010, Accuracy: 508/516 (98.4496%), train_poison_data_count: 516
Global model norm: 14.619729160038862.
Norm before scaling: 15.164645608797777. Distance: 2.7345440621563872
Total norm for 10 adversaries is: 15.164645608797777. distance: 2.7345440621563872
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.1915, Accuracy: 8485/8991 (94.3721%)
poison local model 65 index 64 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   1,  Average loss: 0.0068, Accuracy: 486/573 (84.8168%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   2,  Average loss: 0.0041, Accuracy: 527/573 (91.9721%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   3,  Average loss: 0.0027, Accuracy: 544/573 (94.9389%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   4,  Average loss: 0.0016, Accuracy: 559/573 (97.5567%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   5,  Average loss: 0.0014, Accuracy: 562/573 (98.0803%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   6,  Average loss: 0.0012, Accuracy: 561/573 (97.9058%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   7,  Average loss: 0.0011, Accuracy: 566/573 (98.7784%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   8,  Average loss: 0.0010, Accuracy: 566/573 (98.7784%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch   9,  Average loss: 0.0008, Accuracy: 567/573 (98.9529%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 65, internal_epoch  10,  Average loss: 0.0008, Accuracy: 567/573 (98.9529%), train_poison_data_count: 573
Global model norm: 14.619729160038862.
Norm before scaling: 15.036620134470358. Distance: 2.112974133977256
Total norm for 10 adversaries is: 15.036620134470358. distance: 2.112974133977256
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.1655, Accuracy: 8543/8991 (95.0172%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0067, Accuracy: 473/535 (88.4112%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   2,  Average loss: 0.0047, Accuracy: 496/535 (92.7103%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   3,  Average loss: 0.0031, Accuracy: 504/535 (94.2056%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   4,  Average loss: 0.0017, Accuracy: 522/535 (97.5701%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   5,  Average loss: 0.0015, Accuracy: 525/535 (98.1308%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   6,  Average loss: 0.0011, Accuracy: 528/535 (98.6916%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   7,  Average loss: 0.0010, Accuracy: 529/535 (98.8785%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   8,  Average loss: 0.0009, Accuracy: 529/535 (98.8785%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch   9,  Average loss: 0.0008, Accuracy: 529/535 (98.8785%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 14, internal_epoch  10,  Average loss: 0.0008, Accuracy: 529/535 (98.8785%), train_poison_data_count: 535
Global model norm: 14.619729160038862.
Norm before scaling: 15.004192020840115. Distance: 2.0495783302394446
Total norm for 10 adversaries is: 15.004192020840115. distance: 2.0495783302394446
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2080, Accuracy: 8433/8991 (93.7938%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   1,  Average loss: 0.0072, Accuracy: 456/520 (87.6923%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   2,  Average loss: 0.0048, Accuracy: 475/520 (91.3462%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   3,  Average loss: 0.0023, Accuracy: 496/520 (95.3846%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   4,  Average loss: 0.0020, Accuracy: 497/520 (95.5769%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   5,  Average loss: 0.0019, Accuracy: 502/520 (96.5385%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   6,  Average loss: 0.0017, Accuracy: 503/520 (96.7308%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   7,  Average loss: 0.0017, Accuracy: 505/520 (97.1154%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   8,  Average loss: 0.0015, Accuracy: 508/520 (97.6923%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch   9,  Average loss: 0.0013, Accuracy: 509/520 (97.8846%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 36, internal_epoch  10,  Average loss: 0.0014, Accuracy: 508/520 (97.6923%), train_poison_data_count: 520
Global model norm: 14.619729160038862.
Norm before scaling: 15.0419158210443. Distance: 2.3031405154654094
Total norm for 10 adversaries is: 15.0419158210443. distance: 2.3031405154654094
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2014, Accuracy: 8438/8991 (93.8494%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   1,  Average loss: 0.0054, Accuracy: 526/578 (91.0035%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   2,  Average loss: 0.0030, Accuracy: 550/578 (95.1557%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   3,  Average loss: 0.0016, Accuracy: 560/578 (96.8858%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   4,  Average loss: 0.0011, Accuracy: 566/578 (97.9239%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   5,  Average loss: 0.0010, Accuracy: 566/578 (97.9239%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   6,  Average loss: 0.0013, Accuracy: 568/578 (98.2699%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   7,  Average loss: 0.0015, Accuracy: 561/578 (97.0588%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   8,  Average loss: 0.0009, Accuracy: 565/578 (97.7509%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch   9,  Average loss: 0.0008, Accuracy: 567/578 (98.0969%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 24, internal_epoch  10,  Average loss: 0.0012, Accuracy: 570/578 (98.6159%), train_poison_data_count: 578
Global model norm: 14.619729160038862.
Norm before scaling: 15.016302786146607. Distance: 2.0580192212985704
Total norm for 10 adversaries is: 15.016302786146607. distance: 2.0580192212985704
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2164, Accuracy: 8427/8991 (93.7271%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0065, Accuracy: 482/550 (87.6364%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   2,  Average loss: 0.0044, Accuracy: 502/550 (91.2727%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   3,  Average loss: 0.0022, Accuracy: 528/550 (96.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   4,  Average loss: 0.0017, Accuracy: 536/550 (97.4545%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   5,  Average loss: 0.0015, Accuracy: 538/550 (97.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   6,  Average loss: 0.0013, Accuracy: 536/550 (97.4545%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   7,  Average loss: 0.0011, Accuracy: 541/550 (98.3636%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   8,  Average loss: 0.0011, Accuracy: 541/550 (98.3636%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch   9,  Average loss: 0.0010, Accuracy: 541/550 (98.3636%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 7, internal_epoch  10,  Average loss: 0.0009, Accuracy: 542/550 (98.5455%), train_poison_data_count: 550
Global model norm: 14.619729160038862.
Norm before scaling: 15.022993139716752. Distance: 2.0642450059920656
Total norm for 10 adversaries is: 15.022993139716752. distance: 2.0642450059920656
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.1838, Accuracy: 8497/8991 (94.5056%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0078, Accuracy: 492/587 (83.8160%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 542/587 (92.3339%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   3,  Average loss: 0.0018, Accuracy: 562/587 (95.7411%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   4,  Average loss: 0.0011, Accuracy: 574/587 (97.7853%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   5,  Average loss: 0.0009, Accuracy: 578/587 (98.4668%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   6,  Average loss: 0.0007, Accuracy: 582/587 (99.1482%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   7,  Average loss: 0.0006, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   8,  Average loss: 0.0006, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   9,  Average loss: 0.0005, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch  10,  Average loss: 0.0005, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Global model norm: 14.619729160038862.
Norm before scaling: 15.116416828708376. Distance: 2.3531526277700943
Total norm for 10 adversaries is: 15.116416828708376. distance: 2.3531526277700943
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.1669, Accuracy: 8549/8991 (95.0840%)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   1,  Average loss: 0.0054, Accuracy: 455/518 (87.8378%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   2,  Average loss: 0.0032, Accuracy: 487/518 (94.0154%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   3,  Average loss: 0.0025, Accuracy: 500/518 (96.5251%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   4,  Average loss: 0.0012, Accuracy: 505/518 (97.4903%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   5,  Average loss: 0.0011, Accuracy: 505/518 (97.4903%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   6,  Average loss: 0.0008, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   7,  Average loss: 0.0007, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   8,  Average loss: 0.0006, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch   9,  Average loss: 0.0005, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 76, internal_epoch  10,  Average loss: 0.0005, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Global model norm: 14.619729160038862.
Norm before scaling: 14.962223039579808. Distance: 1.9417656118807296
Total norm for 10 adversaries is: 14.962223039579808. distance: 1.9417656118807296
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2394, Accuracy: 8323/8991 (92.5703%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   1,  Average loss: 0.0070, Accuracy: 431/503 (85.6859%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   2,  Average loss: 0.0031, Accuracy: 474/503 (94.2346%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   3,  Average loss: 0.0017, Accuracy: 485/503 (96.4215%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   4,  Average loss: 0.0012, Accuracy: 489/503 (97.2167%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   5,  Average loss: 0.0010, Accuracy: 492/503 (97.8131%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   6,  Average loss: 0.0008, Accuracy: 498/503 (99.0060%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   7,  Average loss: 0.0007, Accuracy: 500/503 (99.4036%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   8,  Average loss: 0.0006, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch   9,  Average loss: 0.0006, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   5, local model 39, internal_epoch  10,  Average loss: 0.0005, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Global model norm: 14.619729160038862.
Norm before scaling: 14.960212327398946. Distance: 1.8740292897413833
Total norm for 10 adversaries is: 14.960212327398946. distance: 1.8740292897413833
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.1686, Accuracy: 8545/8991 (95.0395%)
time spent on training: 138.14143800735474
[foolsgold agg] training data poison_ratio: 1.0  data num: [644, 516, 573, 535, 520, 578, 550, 587, 518, 503]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 1.6348, Accuracy: 7874/10000 (78.7400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 0.4025, Accuracy: 7888/8991 (87.7322%)
Done in 390.15292596817017 sec.
Server Epoch:6 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   1,  Average loss: 0.0041, Accuracy: 481/526 (91.4449%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   2,  Average loss: 0.0041, Accuracy: 491/526 (93.3460%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   3,  Average loss: 0.0015, Accuracy: 513/526 (97.5285%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   4,  Average loss: 0.0015, Accuracy: 520/526 (98.8593%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   5,  Average loss: 0.0009, Accuracy: 518/526 (98.4791%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   6,  Average loss: 0.0007, Accuracy: 521/526 (99.0494%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   7,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   8,  Average loss: 0.0006, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch   9,  Average loss: 0.0005, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 26, internal_epoch  10,  Average loss: 0.0005, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Global model norm: 14.824919696866985.
Norm before scaling: 15.100076617116002. Distance: 1.9658804674415142
Total norm for 8 adversaries is: 15.100076617116002. distance: 1.9658804674415142
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1893, Accuracy: 8510/8991 (94.6502%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   1,  Average loss: 0.0057, Accuracy: 543/605 (89.7521%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   2,  Average loss: 0.0030, Accuracy: 568/605 (93.8843%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   3,  Average loss: 0.0023, Accuracy: 579/605 (95.7025%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   4,  Average loss: 0.0016, Accuracy: 588/605 (97.1901%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   5,  Average loss: 0.0012, Accuracy: 593/605 (98.0165%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   6,  Average loss: 0.0010, Accuracy: 596/605 (98.5124%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   7,  Average loss: 0.0009, Accuracy: 598/605 (98.8430%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   8,  Average loss: 0.0008, Accuracy: 596/605 (98.5124%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch   9,  Average loss: 0.0006, Accuracy: 601/605 (99.3388%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 29, internal_epoch  10,  Average loss: 0.0006, Accuracy: 601/605 (99.3388%), train_poison_data_count: 605
Global model norm: 14.824919696866985.
Norm before scaling: 15.126912650244432. Distance: 2.0619296817056068
Total norm for 8 adversaries is: 15.126912650244432. distance: 2.0619296817056068
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1821, Accuracy: 8517/8991 (94.7281%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0047, Accuracy: 534/587 (90.9710%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   2,  Average loss: 0.0031, Accuracy: 548/587 (93.3560%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   3,  Average loss: 0.0015, Accuracy: 574/587 (97.7853%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   4,  Average loss: 0.0009, Accuracy: 580/587 (98.8075%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   5,  Average loss: 0.0011, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   6,  Average loss: 0.0007, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   7,  Average loss: 0.0006, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   8,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   9,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch  10,  Average loss: 0.0004, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 14.824919696866985.
Norm before scaling: 15.107140960744774. Distance: 1.876317832681252
Total norm for 8 adversaries is: 15.107140960744774. distance: 1.876317832681252
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1546, Accuracy: 8583/8991 (95.4621%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   1,  Average loss: 0.0037, Accuracy: 602/652 (92.3313%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   2,  Average loss: 0.0028, Accuracy: 617/652 (94.6319%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   3,  Average loss: 0.0013, Accuracy: 636/652 (97.5460%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   4,  Average loss: 0.0011, Accuracy: 641/652 (98.3129%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   5,  Average loss: 0.0008, Accuracy: 646/652 (99.0798%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   6,  Average loss: 0.0007, Accuracy: 643/652 (98.6196%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   7,  Average loss: 0.0006, Accuracy: 645/652 (98.9264%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   8,  Average loss: 0.0006, Accuracy: 648/652 (99.3865%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch   9,  Average loss: 0.0005, Accuracy: 648/652 (99.3865%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 41, internal_epoch  10,  Average loss: 0.0005, Accuracy: 648/652 (99.3865%), train_poison_data_count: 652
Global model norm: 14.824919696866985.
Norm before scaling: 15.058632255138837. Distance: 1.7766737796552792
Total norm for 8 adversaries is: 15.058632255138837. distance: 1.7766737796552792
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1651, Accuracy: 8531/8991 (94.8838%)
___Train Local_Simple,  epoch   6, local model 99, internal_epoch   1,  Average loss: 0.0347, Accuracy: 262/410 (63.9024%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.8599, Accuracy: 4761/10000 (47.6100%), Attack Success Rate:0/10000(0.000)
poison local model 67 index 66 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   1,  Average loss: 0.0038, Accuracy: 597/643 (92.8460%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   2,  Average loss: 0.0033, Accuracy: 606/643 (94.2457%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   3,  Average loss: 0.0032, Accuracy: 602/643 (93.6236%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   4,  Average loss: 0.0021, Accuracy: 628/643 (97.6672%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   5,  Average loss: 0.0013, Accuracy: 627/643 (97.5117%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   6,  Average loss: 0.0010, Accuracy: 631/643 (98.1337%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   7,  Average loss: 0.0007, Accuracy: 637/643 (99.0669%), train_poison_data_count: 643
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   8,  Average loss: 0.0005, Accuracy: 640/643 (99.5334%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch   9,  Average loss: 0.0006, Accuracy: 639/643 (99.3779%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 67, internal_epoch  10,  Average loss: 0.0007, Accuracy: 640/643 (99.5334%), train_poison_data_count: 643
Global model norm: 14.824919696866985.
Norm before scaling: 15.068248364181168. Distance: 1.9147638398410052
Total norm for 8 adversaries is: 15.068248364181168. distance: 1.9147638398410052
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1994, Accuracy: 8458/8991 (94.0718%)
___Train Local_Simple,  epoch   6, local model 91, internal_epoch   1,  Average loss: 0.0154, Accuracy: 489/627 (77.9904%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.4091, Accuracy: 8670/10000 (86.7000%), Attack Success Rate:0/10000(0.000)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   1,  Average loss: 0.0047, Accuracy: 471/518 (90.9266%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   2,  Average loss: 0.0054, Accuracy: 486/518 (93.8224%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   3,  Average loss: 0.0029, Accuracy: 495/518 (95.5598%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   4,  Average loss: 0.0014, Accuracy: 506/518 (97.6834%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   5,  Average loss: 0.0022, Accuracy: 505/518 (97.4903%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   6,  Average loss: 0.0013, Accuracy: 509/518 (98.2625%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   7,  Average loss: 0.0009, Accuracy: 509/518 (98.2625%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   8,  Average loss: 0.0007, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch   9,  Average loss: 0.0006, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 76, internal_epoch  10,  Average loss: 0.0006, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Global model norm: 14.824919696866985.
Norm before scaling: 15.144054170168053. Distance: 2.172042620660464
Total norm for 8 adversaries is: 15.144054170168053. distance: 2.172042620660464
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.2096, Accuracy: 8407/8991 (93.5046%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0039, Accuracy: 630/683 (92.2401%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   2,  Average loss: 0.0035, Accuracy: 636/683 (93.1186%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   3,  Average loss: 0.0019, Accuracy: 657/683 (96.1933%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   4,  Average loss: 0.0012, Accuracy: 668/683 (97.8038%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   5,  Average loss: 0.0010, Accuracy: 671/683 (98.2430%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   6,  Average loss: 0.0008, Accuracy: 676/683 (98.9751%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   7,  Average loss: 0.0007, Accuracy: 676/683 (98.9751%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   8,  Average loss: 0.0006, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch   9,  Average loss: 0.0006, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 8, internal_epoch  10,  Average loss: 0.0006, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Global model norm: 14.824919696866985.
Norm before scaling: 15.098713376638514. Distance: 1.896351677036371
Total norm for 8 adversaries is: 15.098713376638514. distance: 1.896351677036371
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1340, Accuracy: 8614/8991 (95.8069%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   1,  Average loss: 0.0050, Accuracy: 522/582 (89.6907%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   2,  Average loss: 0.0052, Accuracy: 529/582 (90.8935%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   3,  Average loss: 0.0058, Accuracy: 508/582 (87.2852%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   4,  Average loss: 0.0020, Accuracy: 563/582 (96.7354%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   5,  Average loss: 0.0016, Accuracy: 567/582 (97.4227%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   6,  Average loss: 0.0011, Accuracy: 572/582 (98.2818%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   7,  Average loss: 0.0011, Accuracy: 572/582 (98.2818%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   8,  Average loss: 0.0009, Accuracy: 575/582 (98.7973%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch   9,  Average loss: 0.0015, Accuracy: 578/582 (99.3127%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   6, local model 25, internal_epoch  10,  Average loss: 0.0009, Accuracy: 577/582 (99.1409%), train_poison_data_count: 582
Global model norm: 14.824919696866985.
Norm before scaling: 15.148130275056328. Distance: 2.04859479333733
Total norm for 8 adversaries is: 15.148130275056328. distance: 2.04859479333733
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1552, Accuracy: 8566/8991 (95.2731%)
time spent on training: 120.81331992149353
[foolsgold agg] training data poison_ratio: 0.8222184124807131  data num: [526, 605, 587, 652, 410, 643, 627, 518, 683, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.8222184124807131
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 1.8509, Accuracy: 7899/10000 (78.9900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 0.4463, Accuracy: 7902/8991 (87.8879%)
Done in 372.0697817802429 sec.
Server Epoch:7 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
poison local model 66 index 65 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   1,  Average loss: 0.0074, Accuracy: 529/629 (84.1017%), train_poison_data_count: 629
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   2,  Average loss: 0.0048, Accuracy: 567/629 (90.1431%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   3,  Average loss: 0.0026, Accuracy: 596/629 (94.7536%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   4,  Average loss: 0.0016, Accuracy: 608/629 (96.6614%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   5,  Average loss: 0.0015, Accuracy: 608/629 (96.6614%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   6,  Average loss: 0.0013, Accuracy: 613/629 (97.4563%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   7,  Average loss: 0.0011, Accuracy: 618/629 (98.2512%), train_poison_data_count: 629
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   8,  Average loss: 0.0010, Accuracy: 619/629 (98.4102%), train_poison_data_count: 629
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch   9,  Average loss: 0.0009, Accuracy: 624/629 (99.2051%), train_poison_data_count: 629
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 66, internal_epoch  10,  Average loss: 0.0009, Accuracy: 624/629 (99.2051%), train_poison_data_count: 629
Global model norm: 14.991100977596936.
Norm before scaling: 15.481193207878016. Distance: 3.092747072975328
Total norm for 9 adversaries is: 15.481193207878016. distance: 3.092747072975328
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1721, Accuracy: 8501/8991 (94.5501%)
poison local model 68 index 67 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   1,  Average loss: 0.0048, Accuracy: 574/632 (90.8228%), train_poison_data_count: 632
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   2,  Average loss: 0.0029, Accuracy: 602/632 (95.2532%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   3,  Average loss: 0.0015, Accuracy: 620/632 (98.1013%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   4,  Average loss: 0.0010, Accuracy: 624/632 (98.7342%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   5,  Average loss: 0.0008, Accuracy: 626/632 (99.0506%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   6,  Average loss: 0.0007, Accuracy: 627/632 (99.2089%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   7,  Average loss: 0.0006, Accuracy: 628/632 (99.3671%), train_poison_data_count: 632
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   8,  Average loss: 0.0005, Accuracy: 630/632 (99.6835%), train_poison_data_count: 632
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch   9,  Average loss: 0.0005, Accuracy: 630/632 (99.6835%), train_poison_data_count: 632
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 68, internal_epoch  10,  Average loss: 0.0005, Accuracy: 630/632 (99.6835%), train_poison_data_count: 632
Global model norm: 14.991100977596936.
Norm before scaling: 15.292049780818248. Distance: 2.2930153317244604
Total norm for 9 adversaries is: 15.292049780818248. distance: 2.2930153317244604
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1501, Accuracy: 8570/8991 (95.3175%)
poison local model 59 index 58 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   1,  Average loss: 0.0042, Accuracy: 600/652 (92.0245%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   2,  Average loss: 0.0021, Accuracy: 628/652 (96.3190%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   3,  Average loss: 0.0010, Accuracy: 641/652 (98.3129%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   4,  Average loss: 0.0007, Accuracy: 643/652 (98.6196%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   5,  Average loss: 0.0005, Accuracy: 646/652 (99.0798%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   6,  Average loss: 0.0005, Accuracy: 648/652 (99.3865%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   7,  Average loss: 0.0004, Accuracy: 648/652 (99.3865%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   8,  Average loss: 0.0003, Accuracy: 649/652 (99.5399%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch   9,  Average loss: 0.0003, Accuracy: 649/652 (99.5399%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 59, internal_epoch  10,  Average loss: 0.0003, Accuracy: 649/652 (99.5399%), train_poison_data_count: 652
Global model norm: 14.991100977596936.
Norm before scaling: 15.23050431596899. Distance: 1.9859647615423932
Total norm for 9 adversaries is: 15.23050431596899. distance: 1.9859647615423932
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1626, Accuracy: 8560/8991 (95.2063%)
poison local model 62 index 61 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   1,  Average loss: 0.0062, Accuracy: 549/617 (88.9789%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   2,  Average loss: 0.0046, Accuracy: 568/617 (92.0583%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   3,  Average loss: 0.0021, Accuracy: 590/617 (95.6240%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   4,  Average loss: 0.0016, Accuracy: 603/617 (97.7310%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   5,  Average loss: 0.0013, Accuracy: 605/617 (98.0551%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   6,  Average loss: 0.0011, Accuracy: 608/617 (98.5413%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   7,  Average loss: 0.0009, Accuracy: 610/617 (98.8655%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   8,  Average loss: 0.0008, Accuracy: 611/617 (99.0276%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch   9,  Average loss: 0.0007, Accuracy: 614/617 (99.5138%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 62, internal_epoch  10,  Average loss: 0.0007, Accuracy: 614/617 (99.5138%), train_poison_data_count: 617
Global model norm: 14.991100977596936.
Norm before scaling: 15.33584844997707. Distance: 2.512840862780641
Total norm for 9 adversaries is: 15.33584844997707. distance: 2.512840862780641
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1599, Accuracy: 8547/8991 (95.0617%)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   1,  Average loss: 0.0060, Accuracy: 452/511 (88.4540%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   2,  Average loss: 0.0032, Accuracy: 481/511 (94.1292%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   3,  Average loss: 0.0017, Accuracy: 500/511 (97.8474%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   4,  Average loss: 0.0012, Accuracy: 501/511 (98.0431%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   5,  Average loss: 0.0009, Accuracy: 504/511 (98.6301%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   6,  Average loss: 0.0008, Accuracy: 505/511 (98.8258%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   7,  Average loss: 0.0007, Accuracy: 507/511 (99.2172%), train_poison_data_count: 511
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   8,  Average loss: 0.0006, Accuracy: 507/511 (99.2172%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch   9,  Average loss: 0.0005, Accuracy: 507/511 (99.2172%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 31, internal_epoch  10,  Average loss: 0.0005, Accuracy: 507/511 (99.2172%), train_poison_data_count: 511
Global model norm: 14.991100977596936.
Norm before scaling: 15.206871206292425. Distance: 1.9667869954017319
Total norm for 9 adversaries is: 15.206871206292425. distance: 1.9667869954017319
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1467, Accuracy: 8578/8991 (95.4065%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0047, Accuracy: 517/572 (90.3846%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   2,  Average loss: 0.0037, Accuracy: 535/572 (93.5315%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   3,  Average loss: 0.0020, Accuracy: 554/572 (96.8531%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   4,  Average loss: 0.0014, Accuracy: 559/572 (97.7273%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   5,  Average loss: 0.0010, Accuracy: 563/572 (98.4266%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   6,  Average loss: 0.0008, Accuracy: 567/572 (99.1259%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   7,  Average loss: 0.0007, Accuracy: 566/572 (98.9510%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   8,  Average loss: 0.0006, Accuracy: 568/572 (99.3007%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch   9,  Average loss: 0.0005, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 10, internal_epoch  10,  Average loss: 0.0005, Accuracy: 569/572 (99.4755%), train_poison_data_count: 572
Global model norm: 14.991100977596936.
Norm before scaling: 15.237282374817429. Distance: 2.1060284098984896
Total norm for 9 adversaries is: 15.237282374817429. distance: 2.1060284098984896
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1605, Accuracy: 8537/8991 (94.9505%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   1,  Average loss: 0.0055, Accuracy: 530/588 (90.1361%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   2,  Average loss: 0.0039, Accuracy: 545/588 (92.6871%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   3,  Average loss: 0.0022, Accuracy: 567/588 (96.4286%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   4,  Average loss: 0.0016, Accuracy: 576/588 (97.9592%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   5,  Average loss: 0.0013, Accuracy: 576/588 (97.9592%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   6,  Average loss: 0.0012, Accuracy: 576/588 (97.9592%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   7,  Average loss: 0.0009, Accuracy: 579/588 (98.4694%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   8,  Average loss: 0.0010, Accuracy: 581/588 (98.8095%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch   9,  Average loss: 0.0008, Accuracy: 583/588 (99.1497%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 23, internal_epoch  10,  Average loss: 0.0007, Accuracy: 584/588 (99.3197%), train_poison_data_count: 588
Global model norm: 14.991100977596936.
Norm before scaling: 15.239945896483176. Distance: 2.151661510308684
Total norm for 9 adversaries is: 15.239945896483176. distance: 2.151661510308684
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1593, Accuracy: 8559/8991 (95.1952%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 502/550 (91.2727%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   2,  Average loss: 0.0027, Accuracy: 519/550 (94.3636%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   3,  Average loss: 0.0023, Accuracy: 527/550 (95.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   4,  Average loss: 0.0012, Accuracy: 541/550 (98.3636%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   5,  Average loss: 0.0009, Accuracy: 545/550 (99.0909%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   6,  Average loss: 0.0007, Accuracy: 545/550 (99.0909%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   7,  Average loss: 0.0006, Accuracy: 547/550 (99.4545%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   8,  Average loss: 0.0005, Accuracy: 547/550 (99.4545%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch   9,  Average loss: 0.0005, Accuracy: 547/550 (99.4545%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 7, internal_epoch  10,  Average loss: 0.0005, Accuracy: 547/550 (99.4545%), train_poison_data_count: 550
Global model norm: 14.991100977596936.
Norm before scaling: 15.185370401908676. Distance: 1.7695435108829505
Total norm for 9 adversaries is: 15.185370401908676. distance: 1.7695435108829505
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1563, Accuracy: 8562/8991 (95.2286%)
___Train Local_Simple,  epoch   7, local model 99, internal_epoch   1,  Average loss: 0.0041, Accuracy: 379/410 (92.4390%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.1950, Accuracy: 6898/10000 (68.9800%), Attack Success Rate:1/10000(0.010)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   1,  Average loss: 0.0052, Accuracy: 681/750 (90.8000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   2,  Average loss: 0.0023, Accuracy: 718/750 (95.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   3,  Average loss: 0.0012, Accuracy: 733/750 (97.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   4,  Average loss: 0.0009, Accuracy: 738/750 (98.4000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   5,  Average loss: 0.0007, Accuracy: 743/750 (99.0667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   6,  Average loss: 0.0006, Accuracy: 743/750 (99.0667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   7,  Average loss: 0.0006, Accuracy: 745/750 (99.3333%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   8,  Average loss: 0.0005, Accuracy: 745/750 (99.3333%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch   9,  Average loss: 0.0005, Accuracy: 746/750 (99.4667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   7, local model 45, internal_epoch  10,  Average loss: 0.0005, Accuracy: 746/750 (99.4667%), train_poison_data_count: 750
Global model norm: 14.991100977596936.
Norm before scaling: 15.274115334223586. Distance: 2.1830664255588057
Total norm for 9 adversaries is: 15.274115334223586. distance: 2.1830664255588057
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1532, Accuracy: 8578/8991 (95.4065%)
time spent on training: 131.56252098083496
[foolsgold agg] training data poison_ratio: 0.9306377939434952  data num: [629, 632, 652, 617, 511, 572, 588, 550, 410, 750]
[foolsgold agg] considering poison per batch poison_fraction: 0.9306377939434952
[foolsgold agg] wv: [1.         1.         0.4992724  0.56077088 0.91071515 0.91071515
 0.         1.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 2.2618, Accuracy: 8161/10000 (81.6100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 0.3808, Accuracy: 8148/8991 (90.6240%)
Done in 382.87334299087524 sec.
Server Epoch:8 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   1,  Average loss: 0.0073, Accuracy: 537/616 (87.1753%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   2,  Average loss: 0.0048, Accuracy: 560/616 (90.9091%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   3,  Average loss: 0.0019, Accuracy: 596/616 (96.7532%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   4,  Average loss: 0.0016, Accuracy: 599/616 (97.2403%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   5,  Average loss: 0.0013, Accuracy: 603/616 (97.8896%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   6,  Average loss: 0.0012, Accuracy: 605/616 (98.2143%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   7,  Average loss: 0.0010, Accuracy: 608/616 (98.7013%), train_poison_data_count: 616
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   8,  Average loss: 0.0008, Accuracy: 607/616 (98.5390%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch   9,  Average loss: 0.0008, Accuracy: 608/616 (98.7013%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 63, internal_epoch  10,  Average loss: 0.0007, Accuracy: 608/616 (98.7013%), train_poison_data_count: 616
Global model norm: 15.115021243369128.
Norm before scaling: 15.581475512620447. Distance: 3.075041489980273
Total norm for 7 adversaries is: 15.581475512620447. distance: 3.075041489980273
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1491, Accuracy: 8601/8991 (95.6623%)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   1,  Average loss: 0.0071, Accuracy: 527/592 (89.0203%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   2,  Average loss: 0.0046, Accuracy: 556/592 (93.9189%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   3,  Average loss: 0.0025, Accuracy: 565/592 (95.4392%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   4,  Average loss: 0.0015, Accuracy: 579/592 (97.8041%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   5,  Average loss: 0.0011, Accuracy: 581/592 (98.1419%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   6,  Average loss: 0.0010, Accuracy: 584/592 (98.6486%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   7,  Average loss: 0.0008, Accuracy: 586/592 (98.9865%), train_poison_data_count: 592
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   8,  Average loss: 0.0008, Accuracy: 587/592 (99.1554%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch   9,  Average loss: 0.0006, Accuracy: 587/592 (99.1554%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 55, internal_epoch  10,  Average loss: 0.0007, Accuracy: 587/592 (99.1554%), train_poison_data_count: 592
Global model norm: 15.115021243369128.
Norm before scaling: 15.520754793040934. Distance: 3.0210370926813273
Total norm for 7 adversaries is: 15.520754793040934. distance: 3.0210370926813273
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1861, Accuracy: 8496/8991 (94.4945%)
poison local model 79 index 78 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   1,  Average loss: 0.0061, Accuracy: 573/635 (90.2362%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   2,  Average loss: 0.0034, Accuracy: 601/635 (94.6457%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   3,  Average loss: 0.0017, Accuracy: 608/635 (95.7480%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   4,  Average loss: 0.0012, Accuracy: 622/635 (97.9528%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   5,  Average loss: 0.0010, Accuracy: 626/635 (98.5827%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   6,  Average loss: 0.0008, Accuracy: 627/635 (98.7402%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   7,  Average loss: 0.0007, Accuracy: 629/635 (99.0551%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   8,  Average loss: 0.0006, Accuracy: 630/635 (99.2126%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch   9,  Average loss: 0.0006, Accuracy: 631/635 (99.3701%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 79, internal_epoch  10,  Average loss: 0.0005, Accuracy: 631/635 (99.3701%), train_poison_data_count: 635
Global model norm: 15.115021243369128.
Norm before scaling: 15.543259335371124. Distance: 2.9784661560953434
Total norm for 7 adversaries is: 15.543259335371124. distance: 2.9784661560953434
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1819, Accuracy: 8517/8991 (94.7281%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0076, Accuracy: 477/548 (87.0438%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   2,  Average loss: 0.0037, Accuracy: 514/548 (93.7956%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   3,  Average loss: 0.0023, Accuracy: 525/548 (95.8029%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   4,  Average loss: 0.0016, Accuracy: 533/548 (97.2628%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   5,  Average loss: 0.0015, Accuracy: 536/548 (97.8102%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   6,  Average loss: 0.0012, Accuracy: 539/548 (98.3577%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   7,  Average loss: 0.0011, Accuracy: 540/548 (98.5401%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   8,  Average loss: 0.0009, Accuracy: 542/548 (98.9051%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch   9,  Average loss: 0.0009, Accuracy: 543/548 (99.0876%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 9, internal_epoch  10,  Average loss: 0.0009, Accuracy: 543/548 (99.0876%), train_poison_data_count: 548
Global model norm: 15.115021243369128.
Norm before scaling: 15.456940923257685. Distance: 2.71020805813009
Total norm for 7 adversaries is: 15.456940923257685. distance: 2.71020805813009
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1388, Accuracy: 8602/8991 (95.6735%)
poison local model 62 index 61 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   1,  Average loss: 0.0049, Accuracy: 569/617 (92.2204%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   2,  Average loss: 0.0031, Accuracy: 580/617 (94.0032%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   3,  Average loss: 0.0021, Accuracy: 594/617 (96.2723%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   4,  Average loss: 0.0013, Accuracy: 609/617 (98.7034%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   5,  Average loss: 0.0010, Accuracy: 611/617 (99.0276%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   6,  Average loss: 0.0008, Accuracy: 612/617 (99.1896%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   7,  Average loss: 0.0007, Accuracy: 613/617 (99.3517%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   8,  Average loss: 0.0006, Accuracy: 614/617 (99.5138%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch   9,  Average loss: 0.0005, Accuracy: 615/617 (99.6759%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 62, internal_epoch  10,  Average loss: 0.0005, Accuracy: 615/617 (99.6759%), train_poison_data_count: 617
Global model norm: 15.115021243369128.
Norm before scaling: 15.283027280338228. Distance: 2.113759549038713
Total norm for 7 adversaries is: 15.283027280338228. distance: 2.113759549038713
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1359, Accuracy: 8586/8991 (95.4955%)
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   1,  Average loss: 0.0050, Accuracy: 568/626 (90.7348%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   2,  Average loss: 0.0030, Accuracy: 593/626 (94.7284%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   3,  Average loss: 0.0013, Accuracy: 610/626 (97.4441%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   4,  Average loss: 0.0010, Accuracy: 615/626 (98.2428%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   5,  Average loss: 0.0008, Accuracy: 619/626 (98.8818%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   6,  Average loss: 0.0007, Accuracy: 622/626 (99.3610%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   7,  Average loss: 0.0006, Accuracy: 622/626 (99.3610%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   8,  Average loss: 0.0005, Accuracy: 624/626 (99.6805%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch   9,  Average loss: 0.0004, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 56, internal_epoch  10,  Average loss: 0.0004, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Global model norm: 15.115021243369128.
Norm before scaling: 15.326615285456814. Distance: 2.1838486851893992
Total norm for 7 adversaries is: 15.326615285456814. distance: 2.1838486851893992
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1290, Accuracy: 8630/8991 (95.9849%)
___Train Local_Simple,  epoch   8, local model 96, internal_epoch   1,  Average loss: 0.0152, Accuracy: 472/608 (77.6316%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.8920, Accuracy: 7519/10000 (75.1900%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 542/597 (90.7873%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   2,  Average loss: 0.0025, Accuracy: 570/597 (95.4774%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   3,  Average loss: 0.0014, Accuracy: 578/597 (96.8174%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   4,  Average loss: 0.0010, Accuracy: 585/597 (97.9899%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   5,  Average loss: 0.0009, Accuracy: 587/597 (98.3250%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   6,  Average loss: 0.0007, Accuracy: 589/597 (98.6600%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   7,  Average loss: 0.0007, Accuracy: 591/597 (98.9950%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   8,  Average loss: 0.0006, Accuracy: 592/597 (99.1625%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch   9,  Average loss: 0.0006, Accuracy: 594/597 (99.4975%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   8, local model 12, internal_epoch  10,  Average loss: 0.0005, Accuracy: 594/597 (99.4975%), train_poison_data_count: 597
Global model norm: 15.115021243369128.
Norm before scaling: 15.33573054496121. Distance: 2.231037875652046
Total norm for 7 adversaries is: 15.33573054496121. distance: 2.231037875652046
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1374, Accuracy: 8630/8991 (95.9849%)
___Train Local_Simple,  epoch   8, local model 92, internal_epoch   1,  Average loss: 0.0315, Accuracy: 315/571 (55.1664%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.3617, Accuracy: 5897/10000 (58.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 86, internal_epoch   1,  Average loss: 0.0207, Accuracy: 433/587 (73.7649%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.1453, Accuracy: 6152/10000 (61.5200%), Attack Success Rate:0/10000(0.000)
time spent on training: 111.55171203613281
[foolsgold agg] training data poison_ratio: 0.7055194263798565  data num: [616, 592, 635, 548, 617, 626, 608, 597, 571, 587]
[foolsgold agg] considering poison per batch poison_fraction: 0.7055194263798565
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 1.9718, Accuracy: 8195/10000 (81.9500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 0.3743, Accuracy: 8181/8991 (90.9910%)
Done in 412.3652958869934 sec.
Server Epoch:9 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   1,  Average loss: 0.0055, Accuracy: 599/665 (90.0752%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   2,  Average loss: 0.0036, Accuracy: 622/665 (93.5338%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   3,  Average loss: 0.0015, Accuracy: 648/665 (97.4436%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   4,  Average loss: 0.0012, Accuracy: 651/665 (97.8947%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   5,  Average loss: 0.0009, Accuracy: 654/665 (98.3459%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   6,  Average loss: 0.0008, Accuracy: 655/665 (98.4962%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   7,  Average loss: 0.0007, Accuracy: 659/665 (99.0977%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   8,  Average loss: 0.0007, Accuracy: 659/665 (99.0977%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch   9,  Average loss: 0.0005, Accuracy: 660/665 (99.2481%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 28, internal_epoch  10,  Average loss: 0.0006, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Global model norm: 15.270605455947415.
Norm before scaling: 15.536563693473767. Distance: 2.5901259876965663
Total norm for 9 adversaries is: 15.536563693473767. distance: 2.5901259876965663
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1496, Accuracy: 8589/8991 (95.5289%)
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   1,  Average loss: 0.0056, Accuracy: 560/616 (90.9091%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   2,  Average loss: 0.0044, Accuracy: 574/616 (93.1818%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   3,  Average loss: 0.0017, Accuracy: 602/616 (97.7273%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   4,  Average loss: 0.0014, Accuracy: 605/616 (98.2143%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   5,  Average loss: 0.0011, Accuracy: 606/616 (98.3766%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   6,  Average loss: 0.0010, Accuracy: 607/616 (98.5390%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   7,  Average loss: 0.0008, Accuracy: 610/616 (99.0260%), train_poison_data_count: 616
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   8,  Average loss: 0.0007, Accuracy: 612/616 (99.3506%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch   9,  Average loss: 0.0006, Accuracy: 613/616 (99.5130%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 63, internal_epoch  10,  Average loss: 0.0006, Accuracy: 613/616 (99.5130%), train_poison_data_count: 616
Global model norm: 15.270605455947415.
Norm before scaling: 15.539896655432539. Distance: 2.450469894501343
Total norm for 9 adversaries is: 15.539896655432539. distance: 2.450469894501343
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1247, Accuracy: 8648/8991 (96.1851%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   1,  Average loss: 0.0033, Accuracy: 599/638 (93.8871%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   2,  Average loss: 0.0025, Accuracy: 604/638 (94.6708%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   3,  Average loss: 0.0015, Accuracy: 625/638 (97.9624%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   4,  Average loss: 0.0009, Accuracy: 626/638 (98.1191%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   5,  Average loss: 0.0007, Accuracy: 633/638 (99.2163%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   6,  Average loss: 0.0005, Accuracy: 634/638 (99.3730%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   7,  Average loss: 0.0004, Accuracy: 635/638 (99.5298%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   8,  Average loss: 0.0004, Accuracy: 636/638 (99.6865%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch   9,  Average loss: 0.0003, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 33, internal_epoch  10,  Average loss: 0.0003, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Global model norm: 15.270605455947415.
Norm before scaling: 15.45585646755002. Distance: 2.118712379324119
Total norm for 9 adversaries is: 15.45585646755002. distance: 2.118712379324119
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1244, Accuracy: 8642/8991 (96.1183%)
poison local model 71 index 70 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   1,  Average loss: 0.0089, Accuracy: 559/638 (87.6176%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   2,  Average loss: 0.0060, Accuracy: 586/638 (91.8495%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   3,  Average loss: 0.0025, Accuracy: 608/638 (95.2978%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   4,  Average loss: 0.0018, Accuracy: 618/638 (96.8652%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   5,  Average loss: 0.0015, Accuracy: 622/638 (97.4922%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   6,  Average loss: 0.0013, Accuracy: 625/638 (97.9624%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   7,  Average loss: 0.0012, Accuracy: 626/638 (98.1191%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   8,  Average loss: 0.0010, Accuracy: 627/638 (98.2759%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch   9,  Average loss: 0.0009, Accuracy: 627/638 (98.2759%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 71, internal_epoch  10,  Average loss: 0.0009, Accuracy: 627/638 (98.2759%), train_poison_data_count: 638
Global model norm: 15.270605455947415.
Norm before scaling: 15.83392450667879. Distance: 3.7967868370840736
Total norm for 9 adversaries is: 15.83392450667879. distance: 3.7967868370840736
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1645, Accuracy: 8518/8991 (94.7392%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 481/521 (92.3225%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   2,  Average loss: 0.0044, Accuracy: 481/521 (92.3225%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   3,  Average loss: 0.0023, Accuracy: 502/521 (96.3532%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   4,  Average loss: 0.0015, Accuracy: 511/521 (98.0806%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   5,  Average loss: 0.0012, Accuracy: 513/521 (98.4645%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   6,  Average loss: 0.0012, Accuracy: 513/521 (98.4645%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   7,  Average loss: 0.0011, Accuracy: 514/521 (98.6564%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   8,  Average loss: 0.0008, Accuracy: 516/521 (99.0403%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch   9,  Average loss: 0.0007, Accuracy: 517/521 (99.2322%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 13, internal_epoch  10,  Average loss: 0.0007, Accuracy: 517/521 (99.2322%), train_poison_data_count: 521
Global model norm: 15.270605455947415.
Norm before scaling: 15.449262701422942. Distance: 2.369764278938294
Total norm for 9 adversaries is: 15.449262701422942. distance: 2.369764278938294
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1509, Accuracy: 8558/8991 (95.1841%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   1,  Average loss: 0.0060, Accuracy: 545/609 (89.4910%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   2,  Average loss: 0.0031, Accuracy: 579/609 (95.0739%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   3,  Average loss: 0.0019, Accuracy: 590/609 (96.8801%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   4,  Average loss: 0.0013, Accuracy: 597/609 (98.0296%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   5,  Average loss: 0.0011, Accuracy: 600/609 (98.5222%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   6,  Average loss: 0.0008, Accuracy: 601/609 (98.6864%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   7,  Average loss: 0.0007, Accuracy: 601/609 (98.6864%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   8,  Average loss: 0.0006, Accuracy: 603/609 (99.0148%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch   9,  Average loss: 0.0005, Accuracy: 603/609 (99.0148%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 32, internal_epoch  10,  Average loss: 0.0005, Accuracy: 604/609 (99.1790%), train_poison_data_count: 609
Global model norm: 15.270605455947415.
Norm before scaling: 15.592741603010106. Distance: 2.7051763964268414
Total norm for 9 adversaries is: 15.592741603010106. distance: 2.7051763964268414
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1448, Accuracy: 8577/8991 (95.3954%)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   1,  Average loss: 0.0044, Accuracy: 480/518 (92.6641%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   2,  Average loss: 0.0025, Accuracy: 489/518 (94.4015%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   3,  Average loss: 0.0024, Accuracy: 493/518 (95.1737%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   4,  Average loss: 0.0013, Accuracy: 509/518 (98.2625%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   5,  Average loss: 0.0006, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   6,  Average loss: 0.0006, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   7,  Average loss: 0.0005, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   8,  Average loss: 0.0003, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch   9,  Average loss: 0.0003, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 76, internal_epoch  10,  Average loss: 0.0003, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 15.270605455947415.
Norm before scaling: 15.358491796516736. Distance: 2.0137848253512445
Total norm for 9 adversaries is: 15.358491796516736. distance: 2.0137848253512445
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1778, Accuracy: 8492/8991 (94.4500%)
___Train Local_Simple,  epoch   9, local model 97, internal_epoch   1,  Average loss: 0.0165, Accuracy: 447/588 (76.0204%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.8958, Accuracy: 8144/10000 (81.4400%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   1,  Average loss: 0.0074, Accuracy: 524/588 (89.1156%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   2,  Average loss: 0.0062, Accuracy: 525/588 (89.2857%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   3,  Average loss: 0.0030, Accuracy: 564/588 (95.9184%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   4,  Average loss: 0.0018, Accuracy: 573/588 (97.4490%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   5,  Average loss: 0.0015, Accuracy: 573/588 (97.4490%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   6,  Average loss: 0.0013, Accuracy: 576/588 (97.9592%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   7,  Average loss: 0.0010, Accuracy: 578/588 (98.2993%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   8,  Average loss: 0.0009, Accuracy: 579/588 (98.4694%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch   9,  Average loss: 0.0007, Accuracy: 584/588 (99.3197%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 23, internal_epoch  10,  Average loss: 0.0007, Accuracy: 584/588 (99.3197%), train_poison_data_count: 588
Global model norm: 15.270605455947415.
Norm before scaling: 15.70924991324901. Distance: 3.2708603357710957
Total norm for 9 adversaries is: 15.70924991324901. distance: 3.2708603357710957
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1577, Accuracy: 8564/8991 (95.2508%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   1,  Average loss: 0.0056, Accuracy: 532/582 (91.4089%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   2,  Average loss: 0.0038, Accuracy: 543/582 (93.2990%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   3,  Average loss: 0.0018, Accuracy: 566/582 (97.2509%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   4,  Average loss: 0.0013, Accuracy: 571/582 (98.1100%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   5,  Average loss: 0.0009, Accuracy: 575/582 (98.7973%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   6,  Average loss: 0.0007, Accuracy: 579/582 (99.4845%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   7,  Average loss: 0.0006, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   8,  Average loss: 0.0006, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch   9,  Average loss: 0.0005, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch   9, local model 25, internal_epoch  10,  Average loss: 0.0004, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 15.270605455947415.
Norm before scaling: 15.483216089325564. Distance: 2.262722602979306
Total norm for 9 adversaries is: 15.483216089325564. distance: 2.262722602979306
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1332, Accuracy: 8618/8991 (95.8514%)
time spent on training: 161.5819387435913
[foolsgold agg] training data poison_ratio: 0.9013919168203924  data num: [665, 616, 638, 638, 521, 609, 518, 588, 588, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.9013919168203924
[foolsgold agg] wv: [0.58816054 1.         0.93903669 0.03743866 0.93903669 1.
 0.88867816 1.         0.03743866 1.        ]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 2.6274, Accuracy: 8213/10000 (82.1300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 0.4320, Accuracy: 8203/8991 (91.2357%)
Done in 516.3356008529663 sec.
Server Epoch:10 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0209, Accuracy: 452/597 (75.7119%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   2,  Average loss: 0.0102, Accuracy: 510/597 (85.4271%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   3,  Average loss: 0.0038, Accuracy: 560/597 (93.8023%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   4,  Average loss: 0.0025, Accuracy: 565/597 (94.6399%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   5,  Average loss: 0.0021, Accuracy: 571/597 (95.6449%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   6,  Average loss: 0.0019, Accuracy: 579/597 (96.9849%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   7,  Average loss: 0.0017, Accuracy: 581/597 (97.3199%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   8,  Average loss: 0.0016, Accuracy: 583/597 (97.6549%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch   9,  Average loss: 0.0014, Accuracy: 585/597 (97.9899%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 12, internal_epoch  10,  Average loss: 0.0012, Accuracy: 586/597 (98.1575%), train_poison_data_count: 597
Global model norm: 15.413340826681708.
Norm before scaling: 17.824174662311243. Distance: 8.630573627949705
Total norm for 9 adversaries is: 17.824174662311243. distance: 8.630573627949705
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1925, Accuracy: 8473/8991 (94.2387%)
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   1,  Average loss: 0.0054, Accuracy: 567/626 (90.5751%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   2,  Average loss: 0.0037, Accuracy: 584/626 (93.2907%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   3,  Average loss: 0.0023, Accuracy: 606/626 (96.8051%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   4,  Average loss: 0.0016, Accuracy: 613/626 (97.9233%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   5,  Average loss: 0.0012, Accuracy: 617/626 (98.5623%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   6,  Average loss: 0.0009, Accuracy: 619/626 (98.8818%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   7,  Average loss: 0.0008, Accuracy: 620/626 (99.0415%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   8,  Average loss: 0.0007, Accuracy: 622/626 (99.3610%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch   9,  Average loss: 0.0006, Accuracy: 622/626 (99.3610%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 56, internal_epoch  10,  Average loss: 0.0006, Accuracy: 622/626 (99.3610%), train_poison_data_count: 626
Global model norm: 15.413340826681708.
Norm before scaling: 15.678929392796464. Distance: 2.904451859936648
Total norm for 9 adversaries is: 15.678929392796464. distance: 2.904451859936648
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1266, Accuracy: 8637/8991 (96.0627%)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   1,  Average loss: 0.0064, Accuracy: 504/552 (91.3043%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   2,  Average loss: 0.0034, Accuracy: 516/552 (93.4783%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   3,  Average loss: 0.0025, Accuracy: 528/552 (95.6522%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   4,  Average loss: 0.0017, Accuracy: 540/552 (97.8261%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   5,  Average loss: 0.0012, Accuracy: 545/552 (98.7319%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   6,  Average loss: 0.0010, Accuracy: 548/552 (99.2754%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   7,  Average loss: 0.0008, Accuracy: 546/552 (98.9130%), train_poison_data_count: 552
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   8,  Average loss: 0.0006, Accuracy: 547/552 (99.0942%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch   9,  Average loss: 0.0006, Accuracy: 549/552 (99.4565%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 19, internal_epoch  10,  Average loss: 0.0006, Accuracy: 549/552 (99.4565%), train_poison_data_count: 552
Global model norm: 15.413340826681708.
Norm before scaling: 15.632224892129878. Distance: 2.7137723935686755
Total norm for 9 adversaries is: 15.632224892129878. distance: 2.7137723935686755
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1553, Accuracy: 8539/8991 (94.9728%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 578/644 (89.7516%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   2,  Average loss: 0.0030, Accuracy: 609/644 (94.5652%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   3,  Average loss: 0.0015, Accuracy: 626/644 (97.2050%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 633/644 (98.2919%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 635/644 (98.6025%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   7,  Average loss: 0.0008, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   8,  Average loss: 0.0006, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch   9,  Average loss: 0.0006, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 11, internal_epoch  10,  Average loss: 0.0006, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Global model norm: 15.413340826681708.
Norm before scaling: 15.756247114085168. Distance: 3.08617606870554
Total norm for 9 adversaries is: 15.756247114085168. distance: 3.08617606870554
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1865, Accuracy: 8457/8991 (94.0607%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 484/521 (92.8983%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   2,  Average loss: 0.0034, Accuracy: 491/521 (94.2418%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   3,  Average loss: 0.0017, Accuracy: 512/521 (98.2726%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   4,  Average loss: 0.0012, Accuracy: 511/521 (98.0806%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   5,  Average loss: 0.0010, Accuracy: 515/521 (98.8484%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   6,  Average loss: 0.0008, Accuracy: 515/521 (98.8484%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   7,  Average loss: 0.0010, Accuracy: 517/521 (99.2322%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   8,  Average loss: 0.0010, Accuracy: 517/521 (99.2322%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch   9,  Average loss: 0.0005, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 13, internal_epoch  10,  Average loss: 0.0005, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Global model norm: 15.413340826681708.
Norm before scaling: 15.560332978517643. Distance: 2.5926300756328367
Total norm for 9 adversaries is: 15.560332978517643. distance: 2.5926300756328367
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1630, Accuracy: 8529/8991 (94.8615%)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   1,  Average loss: 0.0085, Accuracy: 543/624 (87.0192%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   2,  Average loss: 0.0042, Accuracy: 579/624 (92.7885%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   3,  Average loss: 0.0017, Accuracy: 609/624 (97.5962%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   4,  Average loss: 0.0012, Accuracy: 613/624 (98.2372%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   5,  Average loss: 0.0010, Accuracy: 615/624 (98.5577%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   6,  Average loss: 0.0009, Accuracy: 616/624 (98.7179%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   7,  Average loss: 0.0007, Accuracy: 618/624 (99.0385%), train_poison_data_count: 624
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   8,  Average loss: 0.0006, Accuracy: 621/624 (99.5192%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch   9,  Average loss: 0.0006, Accuracy: 621/624 (99.5192%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 78, internal_epoch  10,  Average loss: 0.0006, Accuracy: 621/624 (99.5192%), train_poison_data_count: 624
Global model norm: 15.413340826681708.
Norm before scaling: 15.960294571455039. Distance: 3.629248924213693
Total norm for 9 adversaries is: 15.960294571455039. distance: 3.629248924213693
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1803, Accuracy: 8543/8991 (95.0172%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   1,  Average loss: 0.0079, Accuracy: 460/516 (89.1473%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   2,  Average loss: 0.0044, Accuracy: 475/516 (92.0543%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   3,  Average loss: 0.0026, Accuracy: 489/516 (94.7674%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   4,  Average loss: 0.0019, Accuracy: 501/516 (97.0930%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   5,  Average loss: 0.0015, Accuracy: 504/516 (97.6744%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   6,  Average loss: 0.0015, Accuracy: 505/516 (97.8682%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   7,  Average loss: 0.0010, Accuracy: 507/516 (98.2558%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   8,  Average loss: 0.0009, Accuracy: 510/516 (98.8372%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch   9,  Average loss: 0.0012, Accuracy: 511/516 (99.0310%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 49, internal_epoch  10,  Average loss: 0.0009, Accuracy: 511/516 (99.0310%), train_poison_data_count: 516
Global model norm: 15.413340826681708.
Norm before scaling: 15.818590280486882. Distance: 3.426766300707284
Total norm for 9 adversaries is: 15.818590280486882. distance: 3.426766300707284
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1733, Accuracy: 8513/8991 (94.6836%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   1,  Average loss: 0.0065, Accuracy: 469/528 (88.8258%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   2,  Average loss: 0.0042, Accuracy: 489/528 (92.6136%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   3,  Average loss: 0.0025, Accuracy: 507/528 (96.0227%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   4,  Average loss: 0.0016, Accuracy: 518/528 (98.1061%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   5,  Average loss: 0.0012, Accuracy: 520/528 (98.4848%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   6,  Average loss: 0.0010, Accuracy: 523/528 (99.0530%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   7,  Average loss: 0.0008, Accuracy: 523/528 (99.0530%), train_poison_data_count: 528
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   8,  Average loss: 0.0007, Accuracy: 523/528 (99.0530%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch   9,  Average loss: 0.0007, Accuracy: 523/528 (99.0530%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 34, internal_epoch  10,  Average loss: 0.0006, Accuracy: 523/528 (99.0530%), train_poison_data_count: 528
Global model norm: 15.413340826681708.
Norm before scaling: 15.695145768931482. Distance: 2.924086116602856
Total norm for 9 adversaries is: 15.695145768931482. distance: 2.924086116602856
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1466, Accuracy: 8585/8991 (95.4844%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0075, Accuracy: 476/535 (88.9720%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   2,  Average loss: 0.0041, Accuracy: 497/535 (92.8972%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   3,  Average loss: 0.0025, Accuracy: 522/535 (97.5701%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   4,  Average loss: 0.0017, Accuracy: 523/535 (97.7570%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   5,  Average loss: 0.0013, Accuracy: 525/535 (98.1308%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   6,  Average loss: 0.0011, Accuracy: 527/535 (98.5047%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   7,  Average loss: 0.0009, Accuracy: 529/535 (98.8785%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   8,  Average loss: 0.0009, Accuracy: 531/535 (99.2523%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch   9,  Average loss: 0.0007, Accuracy: 531/535 (99.2523%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  10, local model 14, internal_epoch  10,  Average loss: 0.0007, Accuracy: 531/535 (99.2523%), train_poison_data_count: 535
Global model norm: 15.413340826681708.
Norm before scaling: 15.692306694042237. Distance: 2.8742930330889154
Total norm for 9 adversaries is: 15.692306694042237. distance: 2.8742930330889154
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1603, Accuracy: 8558/8991 (95.1841%)
___Train Local_Simple,  epoch  10, local model 99, internal_epoch   1,  Average loss: 0.0335, Accuracy: 300/410 (73.1707%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.8219, Accuracy: 4549/10000 (45.4900%), Attack Success Rate:0/10000(0.000)
time spent on training: 154.30003714561462
[foolsgold agg] training data poison_ratio: 0.9261660363767333  data num: [597, 626, 552, 644, 521, 624, 516, 528, 535, 410]
[foolsgold agg] considering poison per batch poison_fraction: 0.9261660363767333
[foolsgold agg] wv: [1.         1.         1.         0.60862601 1.         0.60862601
 0.79888597 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 2.9625, Accuracy: 7984/10000 (79.8400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 0.6632, Accuracy: 8012/8991 (89.1113%)
Done in 484.3846220970154 sec.
Server Epoch:11 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
poison local model 53 index 52 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   1,  Average loss: 0.0098, Accuracy: 538/617 (87.1961%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   2,  Average loss: 0.0053, Accuracy: 563/617 (91.2480%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   3,  Average loss: 0.0024, Accuracy: 591/617 (95.7861%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   4,  Average loss: 0.0016, Accuracy: 603/617 (97.7310%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   5,  Average loss: 0.0013, Accuracy: 600/617 (97.2447%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   6,  Average loss: 0.0011, Accuracy: 601/617 (97.4068%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   7,  Average loss: 0.0010, Accuracy: 605/617 (98.0551%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   8,  Average loss: 0.0008, Accuracy: 607/617 (98.3793%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch   9,  Average loss: 0.0008, Accuracy: 608/617 (98.5413%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 53, internal_epoch  10,  Average loss: 0.0008, Accuracy: 608/617 (98.5413%), train_poison_data_count: 617
Global model norm: 15.598582159313692.
Norm before scaling: 16.218642747116473. Distance: 4.184479492341452
Total norm for 8 adversaries is: 16.218642747116473. distance: 4.184479492341452
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1330, Accuracy: 8611/8991 (95.7736%)
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   1,  Average loss: 0.0072, Accuracy: 559/626 (89.2971%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   2,  Average loss: 0.0041, Accuracy: 589/626 (94.0895%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   3,  Average loss: 0.0023, Accuracy: 602/626 (96.1661%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   4,  Average loss: 0.0014, Accuracy: 613/626 (97.9233%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   5,  Average loss: 0.0011, Accuracy: 618/626 (98.7220%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   6,  Average loss: 0.0009, Accuracy: 619/626 (98.8818%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   7,  Average loss: 0.0008, Accuracy: 620/626 (99.0415%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   8,  Average loss: 0.0007, Accuracy: 621/626 (99.2013%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch   9,  Average loss: 0.0006, Accuracy: 622/626 (99.3610%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 56, internal_epoch  10,  Average loss: 0.0006, Accuracy: 622/626 (99.3610%), train_poison_data_count: 626
Global model norm: 15.598582159313692.
Norm before scaling: 15.982592172844697. Distance: 3.265368291812848
Total norm for 8 adversaries is: 15.982592172844697. distance: 3.265368291812848
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1421, Accuracy: 8589/8991 (95.5289%)
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   1,  Average loss: 0.0073, Accuracy: 574/647 (88.7172%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   2,  Average loss: 0.0041, Accuracy: 597/647 (92.2720%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   3,  Average loss: 0.0022, Accuracy: 626/647 (96.7543%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   4,  Average loss: 0.0015, Accuracy: 630/647 (97.3725%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   5,  Average loss: 0.0012, Accuracy: 634/647 (97.9907%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   6,  Average loss: 0.0010, Accuracy: 637/647 (98.4544%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   7,  Average loss: 0.0008, Accuracy: 639/647 (98.7635%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   8,  Average loss: 0.0007, Accuracy: 640/647 (98.9181%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch   9,  Average loss: 0.0006, Accuracy: 643/647 (99.3818%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 51, internal_epoch  10,  Average loss: 0.0007, Accuracy: 643/647 (99.3818%), train_poison_data_count: 647
Global model norm: 15.598582159313692.
Norm before scaling: 16.01623188636736. Distance: 3.409101220317621
Total norm for 8 adversaries is: 16.01623188636736. distance: 3.409101220317621
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1531, Accuracy: 8561/8991 (95.2174%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0080, Accuracy: 476/535 (88.9720%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   2,  Average loss: 0.0049, Accuracy: 496/535 (92.7103%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   3,  Average loss: 0.0025, Accuracy: 518/535 (96.8224%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   4,  Average loss: 0.0019, Accuracy: 524/535 (97.9439%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   5,  Average loss: 0.0015, Accuracy: 526/535 (98.3178%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   6,  Average loss: 0.0011, Accuracy: 526/535 (98.3178%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   7,  Average loss: 0.0009, Accuracy: 529/535 (98.8785%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   8,  Average loss: 0.0008, Accuracy: 529/535 (98.8785%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch   9,  Average loss: 0.0009, Accuracy: 530/535 (99.0654%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 14, internal_epoch  10,  Average loss: 0.0008, Accuracy: 530/535 (99.0654%), train_poison_data_count: 535
Global model norm: 15.598582159313692.
Norm before scaling: 16.06399137349296. Distance: 3.78512261437745
Total norm for 8 adversaries is: 16.06399137349296. distance: 3.78512261437745
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1759, Accuracy: 8505/8991 (94.5946%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   1,  Average loss: 0.0065, Accuracy: 487/520 (93.6538%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   2,  Average loss: 0.0067, Accuracy: 457/520 (87.8846%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   3,  Average loss: 0.0031, Accuracy: 492/520 (94.6154%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   4,  Average loss: 0.0022, Accuracy: 501/520 (96.3462%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   5,  Average loss: 0.0016, Accuracy: 508/520 (97.6923%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   6,  Average loss: 0.0013, Accuracy: 512/520 (98.4615%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   7,  Average loss: 0.0011, Accuracy: 514/520 (98.8462%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   8,  Average loss: 0.0009, Accuracy: 514/520 (98.8462%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch   9,  Average loss: 0.0009, Accuracy: 515/520 (99.0385%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 36, internal_epoch  10,  Average loss: 0.0011, Accuracy: 515/520 (99.0385%), train_poison_data_count: 520
Global model norm: 15.598582159313692.
Norm before scaling: 15.89647849570631. Distance: 3.270784964882134
Total norm for 8 adversaries is: 15.89647849570631. distance: 3.270784964882134
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1468, Accuracy: 8559/8991 (95.1952%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0088, Accuracy: 622/708 (87.8531%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 641/708 (90.5367%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   3,  Average loss: 0.0024, Accuracy: 674/708 (95.1977%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   4,  Average loss: 0.0017, Accuracy: 685/708 (96.7514%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   5,  Average loss: 0.0014, Accuracy: 687/708 (97.0339%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   6,  Average loss: 0.0012, Accuracy: 690/708 (97.4576%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   7,  Average loss: 0.0010, Accuracy: 690/708 (97.4576%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   8,  Average loss: 0.0009, Accuracy: 694/708 (98.0226%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch   9,  Average loss: 0.0008, Accuracy: 698/708 (98.5876%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 6, internal_epoch  10,  Average loss: 0.0008, Accuracy: 698/708 (98.5876%), train_poison_data_count: 708
Global model norm: 15.598582159313692.
Norm before scaling: 16.30216050134824. Distance: 4.40136252894556
Total norm for 8 adversaries is: 16.30216050134824. distance: 4.40136252894556
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1355, Accuracy: 8599/8991 (95.6401%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   1,  Average loss: 0.0113, Accuracy: 423/478 (88.4937%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   2,  Average loss: 0.0053, Accuracy: 442/478 (92.4686%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   3,  Average loss: 0.0040, Accuracy: 445/478 (93.0962%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   4,  Average loss: 0.0025, Accuracy: 460/478 (96.2343%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   5,  Average loss: 0.0019, Accuracy: 468/478 (97.9079%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   6,  Average loss: 0.0016, Accuracy: 470/478 (98.3264%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   7,  Average loss: 0.0013, Accuracy: 473/478 (98.9540%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   8,  Average loss: 0.0010, Accuracy: 472/478 (98.7448%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch   9,  Average loss: 0.0009, Accuracy: 473/478 (98.9540%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 46, internal_epoch  10,  Average loss: 0.0009, Accuracy: 473/478 (98.9540%), train_poison_data_count: 478
Global model norm: 15.598582159313692.
Norm before scaling: 16.230795442710903. Distance: 4.397979983559614
Total norm for 8 adversaries is: 16.230795442710903. distance: 4.397979983559614
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1690, Accuracy: 8505/8991 (94.5946%)
___Train Local_Simple,  epoch  11, local model 99, internal_epoch   1,  Average loss: 0.0161, Accuracy: 348/410 (84.8780%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.6083, Accuracy: 5495/10000 (54.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 88, internal_epoch   1,  Average loss: 0.0148, Accuracy: 549/679 (80.8542%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3747, Accuracy: 8926/10000 (89.2600%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0087, Accuracy: 575/641 (89.7036%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   2,  Average loss: 0.0046, Accuracy: 600/641 (93.6037%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   3,  Average loss: 0.0023, Accuracy: 608/641 (94.8518%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   4,  Average loss: 0.0013, Accuracy: 629/641 (98.1279%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   5,  Average loss: 0.0010, Accuracy: 630/641 (98.2839%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   6,  Average loss: 0.0008, Accuracy: 634/641 (98.9080%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   7,  Average loss: 0.0006, Accuracy: 635/641 (99.0640%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   8,  Average loss: 0.0007, Accuracy: 635/641 (99.0640%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch   9,  Average loss: 0.0005, Accuracy: 636/641 (99.2200%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  11, local model 37, internal_epoch  10,  Average loss: 0.0007, Accuracy: 637/641 (99.3760%), train_poison_data_count: 641
Global model norm: 15.598582159313692.
Norm before scaling: 16.222715036463438. Distance: 4.116619034670482
Total norm for 8 adversaries is: 16.222715036463438. distance: 4.116619034670482
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1886, Accuracy: 8475/8991 (94.2609%)
time spent on training: 144.90266489982605
[foolsgold agg] training data poison_ratio: 0.8141955297730763  data num: [617, 626, 647, 535, 520, 708, 478, 410, 679, 641]
[foolsgold agg] considering poison per batch poison_fraction: 0.8141955297730763
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 3.1669, Accuracy: 8050/10000 (80.5000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 0.6557, Accuracy: 8102/8991 (90.1123%)
Done in 472.1492700576782 sec.
Server Epoch:12 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   1,  Average loss: 0.0070, Accuracy: 605/665 (90.9774%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   2,  Average loss: 0.0031, Accuracy: 627/665 (94.2857%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   3,  Average loss: 0.0016, Accuracy: 653/665 (98.1955%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   4,  Average loss: 0.0011, Accuracy: 658/665 (98.9474%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   5,  Average loss: 0.0008, Accuracy: 657/665 (98.7970%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   6,  Average loss: 0.0007, Accuracy: 661/665 (99.3985%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   7,  Average loss: 0.0005, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   8,  Average loss: 0.0005, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch   9,  Average loss: 0.0004, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 42, internal_epoch  10,  Average loss: 0.0004, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Global model norm: 15.823321955272077.
Norm before scaling: 16.20111807273315. Distance: 3.5593098863066492
Total norm for 10 adversaries is: 16.20111807273315. distance: 3.5593098863066492
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1402, Accuracy: 8604/8991 (95.6957%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   1,  Average loss: 0.0045, Accuracy: 602/648 (92.9012%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   2,  Average loss: 0.0047, Accuracy: 597/648 (92.1296%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   3,  Average loss: 0.0024, Accuracy: 619/648 (95.5247%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   4,  Average loss: 0.0015, Accuracy: 630/648 (97.2222%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   5,  Average loss: 0.0010, Accuracy: 639/648 (98.6111%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   6,  Average loss: 0.0010, Accuracy: 640/648 (98.7654%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   7,  Average loss: 0.0007, Accuracy: 641/648 (98.9198%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   8,  Average loss: 0.0006, Accuracy: 642/648 (99.0741%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch   9,  Average loss: 0.0005, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 17, internal_epoch  10,  Average loss: 0.0005, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Global model norm: 15.823321955272077.
Norm before scaling: 16.12443979162532. Distance: 3.405702879476054
Total norm for 10 adversaries is: 16.12443979162532. distance: 3.405702879476054
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1747, Accuracy: 8542/8991 (95.0061%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0130, Accuracy: 503/580 (86.7241%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   2,  Average loss: 0.0064, Accuracy: 524/580 (90.3448%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   3,  Average loss: 0.0023, Accuracy: 553/580 (95.3448%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   4,  Average loss: 0.0016, Accuracy: 567/580 (97.7586%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   5,  Average loss: 0.0013, Accuracy: 565/580 (97.4138%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   6,  Average loss: 0.0010, Accuracy: 570/580 (98.2759%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   7,  Average loss: 0.0009, Accuracy: 572/580 (98.6207%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   8,  Average loss: 0.0007, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   9,  Average loss: 0.0006, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch  10,  Average loss: 0.0008, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Global model norm: 15.823321955272077.
Norm before scaling: 16.7028600744893. Distance: 5.248942495742204
Total norm for 10 adversaries is: 16.7028600744893. distance: 5.248942495742204
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1485, Accuracy: 8572/8991 (95.3398%)
poison local model 64 index 63 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   1,  Average loss: 0.0070, Accuracy: 516/566 (91.1661%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   2,  Average loss: 0.0035, Accuracy: 529/566 (93.4629%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   3,  Average loss: 0.0021, Accuracy: 550/566 (97.1731%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   4,  Average loss: 0.0013, Accuracy: 555/566 (98.0565%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   5,  Average loss: 0.0009, Accuracy: 563/566 (99.4700%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   6,  Average loss: 0.0007, Accuracy: 562/566 (99.2933%), train_poison_data_count: 566
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   7,  Average loss: 0.0006, Accuracy: 562/566 (99.2933%), train_poison_data_count: 566
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   8,  Average loss: 0.0005, Accuracy: 563/566 (99.4700%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch   9,  Average loss: 0.0005, Accuracy: 564/566 (99.6466%), train_poison_data_count: 566
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 64, internal_epoch  10,  Average loss: 0.0005, Accuracy: 564/566 (99.6466%), train_poison_data_count: 566
Global model norm: 15.823321955272077.
Norm before scaling: 16.164621335192365. Distance: 3.5756402196028483
Total norm for 10 adversaries is: 16.164621335192365. distance: 3.5756402196028483
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1523, Accuracy: 8524/8991 (94.8059%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0084, Accuracy: 633/708 (89.4068%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   2,  Average loss: 0.0049, Accuracy: 658/708 (92.9379%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   3,  Average loss: 0.0031, Accuracy: 657/708 (92.7966%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   4,  Average loss: 0.0017, Accuracy: 686/708 (96.8927%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   5,  Average loss: 0.0013, Accuracy: 691/708 (97.5989%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   6,  Average loss: 0.0011, Accuracy: 695/708 (98.1638%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   7,  Average loss: 0.0012, Accuracy: 696/708 (98.3051%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   8,  Average loss: 0.0008, Accuracy: 699/708 (98.7288%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch   9,  Average loss: 0.0007, Accuracy: 699/708 (98.7288%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 6, internal_epoch  10,  Average loss: 0.0007, Accuracy: 700/708 (98.8701%), train_poison_data_count: 708
Global model norm: 15.823321955272077.
Norm before scaling: 16.289402536918463. Distance: 3.9229190242285523
Total norm for 10 adversaries is: 16.289402536918463. distance: 3.9229190242285523
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1177, Accuracy: 8645/8991 (96.1517%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   1,  Average loss: 0.0088, Accuracy: 691/774 (89.2765%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   2,  Average loss: 0.0075, Accuracy: 685/774 (88.5013%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   3,  Average loss: 0.0028, Accuracy: 728/774 (94.0568%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   4,  Average loss: 0.0023, Accuracy: 736/774 (95.0904%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   5,  Average loss: 0.0017, Accuracy: 749/774 (96.7700%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   6,  Average loss: 0.0015, Accuracy: 753/774 (97.2868%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   7,  Average loss: 0.0013, Accuracy: 756/774 (97.6744%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   8,  Average loss: 0.0011, Accuracy: 757/774 (97.8036%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch   9,  Average loss: 0.0010, Accuracy: 760/774 (98.1912%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 38, internal_epoch  10,  Average loss: 0.0009, Accuracy: 760/774 (98.1912%), train_poison_data_count: 774
Global model norm: 15.823321955272077.
Norm before scaling: 16.561521566028624. Distance: 4.988700114253818
Total norm for 10 adversaries is: 16.561521566028624. distance: 4.988700114253818
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1284, Accuracy: 8632/8991 (96.0071%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   1,  Average loss: 0.0091, Accuracy: 579/641 (90.3276%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   2,  Average loss: 0.0134, Accuracy: 501/641 (78.1591%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   3,  Average loss: 0.0046, Accuracy: 599/641 (93.4477%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   4,  Average loss: 0.0025, Accuracy: 614/641 (95.7878%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   5,  Average loss: 0.0022, Accuracy: 621/641 (96.8799%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   6,  Average loss: 0.0016, Accuracy: 618/641 (96.4119%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   7,  Average loss: 0.0013, Accuracy: 628/641 (97.9719%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   8,  Average loss: 0.0010, Accuracy: 631/641 (98.4399%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch   9,  Average loss: 0.0021, Accuracy: 632/641 (98.5959%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 37, internal_epoch  10,  Average loss: 0.0009, Accuracy: 633/641 (98.7520%), train_poison_data_count: 641
Global model norm: 15.823321955272077.
Norm before scaling: 17.80467121680914. Distance: 8.083335273454047
Total norm for 10 adversaries is: 17.80467121680914. distance: 8.083335273454047
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.2226, Accuracy: 8385/8991 (93.2599%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   1,  Average loss: 0.0076, Accuracy: 475/518 (91.6988%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   2,  Average loss: 0.0036, Accuracy: 488/518 (94.2085%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   3,  Average loss: 0.0022, Accuracy: 504/518 (97.2973%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   4,  Average loss: 0.0017, Accuracy: 511/518 (98.6486%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   5,  Average loss: 0.0011, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   6,  Average loss: 0.0008, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   7,  Average loss: 0.0008, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   8,  Average loss: 0.0006, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch   9,  Average loss: 0.0006, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 44, internal_epoch  10,  Average loss: 0.0005, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Global model norm: 15.823321955272077.
Norm before scaling: 16.00056170431262. Distance: 3.08254872898466
Total norm for 10 adversaries is: 16.00056170431262. distance: 3.08254872898466
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1278, Accuracy: 8651/8991 (96.2184%)
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   1,  Average loss: 0.0151, Accuracy: 445/519 (85.7418%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   2,  Average loss: 0.0059, Accuracy: 480/519 (92.4855%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 479/519 (92.2929%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   4,  Average loss: 0.0025, Accuracy: 492/519 (94.7977%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   5,  Average loss: 0.0031, Accuracy: 500/519 (96.3391%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   6,  Average loss: 0.0015, Accuracy: 505/519 (97.3025%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   7,  Average loss: 0.0014, Accuracy: 509/519 (98.0732%), train_poison_data_count: 519
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   8,  Average loss: 0.0010, Accuracy: 510/519 (98.2659%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch   9,  Average loss: 0.0009, Accuracy: 513/519 (98.8439%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 77, internal_epoch  10,  Average loss: 0.0010, Accuracy: 513/519 (98.8439%), train_poison_data_count: 519
Global model norm: 15.823321955272077.
Norm before scaling: 16.613755632628738. Distance: 5.132552931448073
Total norm for 10 adversaries is: 16.613755632628738. distance: 5.132552931448073
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1476, Accuracy: 8590/8991 (95.5400%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0075, Accuracy: 534/587 (90.9710%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   2,  Average loss: 0.0032, Accuracy: 558/587 (95.0596%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   3,  Average loss: 0.0021, Accuracy: 569/587 (96.9336%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   4,  Average loss: 0.0016, Accuracy: 575/587 (97.9557%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   5,  Average loss: 0.0011, Accuracy: 581/587 (98.9779%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   6,  Average loss: 0.0008, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   7,  Average loss: 0.0006, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   8,  Average loss: 0.0005, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   9,  Average loss: 0.0005, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch  10,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Global model norm: 15.823321955272077.
Norm before scaling: 16.229029813621214. Distance: 3.638313050527359
Total norm for 10 adversaries is: 16.229029813621214. distance: 3.638313050527359
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1439, Accuracy: 8596/8991 (95.6067%)
time spent on training: 170.53823900222778
[foolsgold agg] training data poison_ratio: 1.0  data num: [665, 648, 580, 566, 708, 774, 641, 518, 519, 587]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 4.0543, Accuracy: 8046/10000 (80.4600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 0.5146, Accuracy: 8399/8991 (93.4156%)
Done in 499.4902300834656 sec.
Server Epoch:13 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   1,  Average loss: 0.0053, Accuracy: 544/578 (94.1176%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   2,  Average loss: 0.0026, Accuracy: 547/578 (94.6367%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   3,  Average loss: 0.0011, Accuracy: 569/578 (98.4429%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   4,  Average loss: 0.0007, Accuracy: 572/578 (98.9619%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   5,  Average loss: 0.0004, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   6,  Average loss: 0.0004, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   7,  Average loss: 0.0003, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   8,  Average loss: 0.0004, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch   9,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 24, internal_epoch  10,  Average loss: 0.0002, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Global model norm: 16.119028804478557.
Norm before scaling: 16.22159946819797. Distance: 3.0733183689815053
Total norm for 9 adversaries is: 16.22159946819797. distance: 3.0733183689815053
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1250, Accuracy: 8654/8991 (96.2518%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   1,  Average loss: 0.0105, Accuracy: 680/774 (87.8553%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 698/774 (90.1809%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   3,  Average loss: 0.0022, Accuracy: 748/774 (96.6408%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   4,  Average loss: 0.0014, Accuracy: 752/774 (97.1576%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   5,  Average loss: 0.0012, Accuracy: 762/774 (98.4496%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   6,  Average loss: 0.0009, Accuracy: 764/774 (98.7080%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   7,  Average loss: 0.0008, Accuracy: 767/774 (99.0956%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   8,  Average loss: 0.0007, Accuracy: 769/774 (99.3540%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch   9,  Average loss: 0.0006, Accuracy: 770/774 (99.4832%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 38, internal_epoch  10,  Average loss: 0.0007, Accuracy: 771/774 (99.6124%), train_poison_data_count: 774
Global model norm: 16.119028804478557.
Norm before scaling: 17.159187440640856. Distance: 5.820053934588035
Total norm for 9 adversaries is: 17.159187440640856. distance: 5.820053934588035
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1627, Accuracy: 8553/8991 (95.1285%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   1,  Average loss: 0.0106, Accuracy: 545/618 (88.1877%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   2,  Average loss: 0.0051, Accuracy: 563/618 (91.1003%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   3,  Average loss: 0.0031, Accuracy: 589/618 (95.3074%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   4,  Average loss: 0.0023, Accuracy: 600/618 (97.0874%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   5,  Average loss: 0.0016, Accuracy: 603/618 (97.5728%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   6,  Average loss: 0.0013, Accuracy: 607/618 (98.2201%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   7,  Average loss: 0.0011, Accuracy: 609/618 (98.5437%), train_poison_data_count: 618
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   8,  Average loss: 0.0009, Accuracy: 611/618 (98.8673%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch   9,  Average loss: 0.0008, Accuracy: 612/618 (99.0291%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 52, internal_epoch  10,  Average loss: 0.0008, Accuracy: 612/618 (99.0291%), train_poison_data_count: 618
Global model norm: 16.119028804478557.
Norm before scaling: 16.745891010115177. Distance: 4.760605466786803
Total norm for 9 adversaries is: 16.745891010115177. distance: 4.760605466786803
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1497, Accuracy: 8570/8991 (95.3175%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0114, Accuracy: 504/572 (88.1119%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 534/572 (93.3566%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   3,  Average loss: 0.0038, Accuracy: 548/572 (95.8042%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   4,  Average loss: 0.0025, Accuracy: 559/572 (97.7273%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   5,  Average loss: 0.0019, Accuracy: 560/572 (97.9021%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   6,  Average loss: 0.0015, Accuracy: 563/572 (98.4266%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   7,  Average loss: 0.0013, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   8,  Average loss: 0.0011, Accuracy: 565/572 (98.7762%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch   9,  Average loss: 0.0010, Accuracy: 565/572 (98.7762%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 10, internal_epoch  10,  Average loss: 0.0010, Accuracy: 565/572 (98.7762%), train_poison_data_count: 572
Global model norm: 16.119028804478557.
Norm before scaling: 16.829513166688287. Distance: 5.250964666476901
Total norm for 9 adversaries is: 16.829513166688287. distance: 5.250964666476901
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1612, Accuracy: 8573/8991 (95.3509%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0099, Accuracy: 578/644 (89.7516%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 594/644 (92.2360%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 626/644 (97.2050%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   4,  Average loss: 0.0019, Accuracy: 631/644 (97.9814%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 638/644 (99.0683%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 637/644 (98.9130%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   7,  Average loss: 0.0009, Accuracy: 637/644 (98.9130%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   8,  Average loss: 0.0008, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch   9,  Average loss: 0.0007, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 11, internal_epoch  10,  Average loss: 0.0007, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Global model norm: 16.119028804478557.
Norm before scaling: 16.861954230998293. Distance: 5.449513110889078
Total norm for 9 adversaries is: 16.861954230998293. distance: 5.449513110889078
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.2057, Accuracy: 8428/8991 (93.7382%)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   1,  Average loss: 0.0162, Accuracy: 456/518 (88.0309%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   2,  Average loss: 0.0052, Accuracy: 484/518 (93.4363%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   3,  Average loss: 0.0038, Accuracy: 496/518 (95.7529%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   4,  Average loss: 0.0026, Accuracy: 503/518 (97.1042%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   5,  Average loss: 0.0020, Accuracy: 504/518 (97.2973%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   6,  Average loss: 0.0014, Accuracy: 507/518 (97.8764%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   7,  Average loss: 0.0014, Accuracy: 509/518 (98.2625%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   8,  Average loss: 0.0009, Accuracy: 509/518 (98.2625%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch   9,  Average loss: 0.0009, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 76, internal_epoch  10,  Average loss: 0.0008, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Global model norm: 16.119028804478557.
Norm before scaling: 16.979444755039935. Distance: 5.855943656733716
Total norm for 9 adversaries is: 16.979444755039935. distance: 5.855943656733716
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1905, Accuracy: 8464/8991 (94.1386%)
___Train Local_Simple,  epoch  13, local model 97, internal_epoch   1,  Average loss: 0.0699, Accuracy: 222/588 (37.7551%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.0687, Accuracy: 2932/10000 (29.3200%), Attack Success Rate:0/10000(0.000)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0174, Accuracy: 463/550 (84.1818%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   2,  Average loss: 0.0051, Accuracy: 511/550 (92.9091%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   3,  Average loss: 0.0027, Accuracy: 529/550 (96.1818%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   4,  Average loss: 0.0020, Accuracy: 533/550 (96.9091%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   5,  Average loss: 0.0017, Accuracy: 535/550 (97.2727%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   6,  Average loss: 0.0014, Accuracy: 540/550 (98.1818%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   7,  Average loss: 0.0012, Accuracy: 540/550 (98.1818%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   8,  Average loss: 0.0011, Accuracy: 542/550 (98.5455%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch   9,  Average loss: 0.0010, Accuracy: 543/550 (98.7273%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 7, internal_epoch  10,  Average loss: 0.0009, Accuracy: 543/550 (98.7273%), train_poison_data_count: 550
Global model norm: 16.119028804478557.
Norm before scaling: 17.14886816087927. Distance: 6.1856399977202425
Total norm for 9 adversaries is: 17.14886816087927. distance: 6.1856399977202425
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1775, Accuracy: 8494/8991 (94.4723%)
poison local model 70 index 69 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   1,  Average loss: 0.0124, Accuracy: 488/549 (88.8889%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   2,  Average loss: 0.0037, Accuracy: 517/549 (94.1712%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   3,  Average loss: 0.0034, Accuracy: 527/549 (95.9927%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   4,  Average loss: 0.0024, Accuracy: 532/549 (96.9035%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   5,  Average loss: 0.0019, Accuracy: 535/549 (97.4499%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   6,  Average loss: 0.0016, Accuracy: 537/549 (97.8142%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   7,  Average loss: 0.0013, Accuracy: 539/549 (98.1785%), train_poison_data_count: 549
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   8,  Average loss: 0.0012, Accuracy: 539/549 (98.1785%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch   9,  Average loss: 0.0011, Accuracy: 539/549 (98.1785%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 70, internal_epoch  10,  Average loss: 0.0010, Accuracy: 539/549 (98.1785%), train_poison_data_count: 549
Global model norm: 16.119028804478557.
Norm before scaling: 16.674832797606246. Distance: 4.660797765659644
Total norm for 9 adversaries is: 16.674832797606246. distance: 4.660797765659644
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1575, Accuracy: 8591/8991 (95.5511%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0122, Accuracy: 479/535 (89.5327%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   2,  Average loss: 0.0044, Accuracy: 493/535 (92.1495%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   3,  Average loss: 0.0042, Accuracy: 503/535 (94.0187%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   4,  Average loss: 0.0026, Accuracy: 519/535 (97.0093%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   5,  Average loss: 0.0018, Accuracy: 524/535 (97.9439%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   6,  Average loss: 0.0015, Accuracy: 526/535 (98.3178%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   7,  Average loss: 0.0013, Accuracy: 526/535 (98.3178%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   8,  Average loss: 0.0010, Accuracy: 527/535 (98.5047%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch   9,  Average loss: 0.0010, Accuracy: 527/535 (98.5047%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  13, local model 14, internal_epoch  10,  Average loss: 0.0009, Accuracy: 527/535 (98.5047%), train_poison_data_count: 535
Global model norm: 16.119028804478557.
Norm before scaling: 16.69740898453634. Distance: 4.663168458857517
Total norm for 9 adversaries is: 16.69740898453634. distance: 4.663168458857517
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1662, Accuracy: 8535/8991 (94.9283%)
time spent on training: 157.06506085395813
[foolsgold agg] training data poison_ratio: 0.9007762402969963  data num: [578, 774, 618, 572, 644, 518, 588, 550, 549, 535]
[foolsgold agg] considering poison per batch poison_fraction: 0.9007762402969963
[foolsgold agg] wv: [1.         1.         1.         1.         0.61668648 0.95904205
 1.         0.61668648 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 3.5682, Accuracy: 8215/10000 (82.1500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 0.6513, Accuracy: 8289/8991 (92.1922%)
Done in 484.8027169704437 sec.
Server Epoch:14 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0131, Accuracy: 448/532 (84.2105%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.8837, Accuracy: 7435/10000 (74.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 97, internal_epoch   1,  Average loss: 0.0231, Accuracy: 430/588 (73.1293%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1638, Accuracy: 7136/10000 (71.3600%), Attack Success Rate:0/10000(0.000)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0089, Accuracy: 541/597 (90.6198%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   2,  Average loss: 0.0050, Accuracy: 543/597 (90.9548%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   3,  Average loss: 0.0038, Accuracy: 561/597 (93.9698%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   4,  Average loss: 0.0025, Accuracy: 569/597 (95.3099%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   5,  Average loss: 0.0019, Accuracy: 579/597 (96.9849%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   6,  Average loss: 0.0014, Accuracy: 582/597 (97.4874%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   7,  Average loss: 0.0012, Accuracy: 587/597 (98.3250%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   8,  Average loss: 0.0010, Accuracy: 587/597 (98.3250%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch   9,  Average loss: 0.0009, Accuracy: 588/597 (98.4925%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 12, internal_epoch  10,  Average loss: 0.0008, Accuracy: 588/597 (98.4925%), train_poison_data_count: 597
Global model norm: 16.345191439782067.
Norm before scaling: 16.909937430006025. Distance: 4.707779415709442
Total norm for 7 adversaries is: 16.909937430006025. distance: 4.707779415709442
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1217, Accuracy: 8658/8991 (96.2963%)
___Train Local_Simple,  epoch  14, local model 89, internal_epoch   1,  Average loss: 0.0197, Accuracy: 503/664 (75.7530%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.5486, Accuracy: 8515/10000 (85.1500%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   1,  Average loss: 0.0111, Accuracy: 524/582 (90.0344%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   2,  Average loss: 0.0069, Accuracy: 523/582 (89.8625%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   3,  Average loss: 0.0048, Accuracy: 551/582 (94.6735%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   4,  Average loss: 0.0029, Accuracy: 560/582 (96.2199%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   5,  Average loss: 0.0021, Accuracy: 567/582 (97.4227%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   6,  Average loss: 0.0016, Accuracy: 568/582 (97.5945%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   7,  Average loss: 0.0013, Accuracy: 571/582 (98.1100%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   8,  Average loss: 0.0013, Accuracy: 573/582 (98.4536%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch   9,  Average loss: 0.0009, Accuracy: 574/582 (98.6254%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 25, internal_epoch  10,  Average loss: 0.0009, Accuracy: 575/582 (98.7973%), train_poison_data_count: 582
Global model norm: 16.345191439782067.
Norm before scaling: 16.98179459469022. Distance: 5.170270688258804
Total norm for 7 adversaries is: 16.98179459469022. distance: 5.170270688258804
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1297, Accuracy: 8613/8991 (95.7958%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   1,  Average loss: 0.0104, Accuracy: 467/528 (88.4470%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   2,  Average loss: 0.0038, Accuracy: 491/528 (92.9924%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   3,  Average loss: 0.0019, Accuracy: 508/528 (96.2121%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   4,  Average loss: 0.0013, Accuracy: 516/528 (97.7273%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   5,  Average loss: 0.0011, Accuracy: 522/528 (98.8636%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   6,  Average loss: 0.0008, Accuracy: 521/528 (98.6742%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   7,  Average loss: 0.0007, Accuracy: 523/528 (99.0530%), train_poison_data_count: 528
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   8,  Average loss: 0.0006, Accuracy: 524/528 (99.2424%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch   9,  Average loss: 0.0005, Accuracy: 524/528 (99.2424%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 34, internal_epoch  10,  Average loss: 0.0006, Accuracy: 524/528 (99.2424%), train_poison_data_count: 528
Global model norm: 16.345191439782067.
Norm before scaling: 16.782362007791004. Distance: 4.562135028611835
Total norm for 7 adversaries is: 16.782362007791004. distance: 4.562135028611835
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1424, Accuracy: 8627/8991 (95.9515%)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   1,  Average loss: 0.0058, Accuracy: 557/592 (94.0878%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   2,  Average loss: 0.0051, Accuracy: 549/592 (92.7365%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   3,  Average loss: 0.0022, Accuracy: 567/592 (95.7770%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   4,  Average loss: 0.0014, Accuracy: 580/592 (97.9730%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   5,  Average loss: 0.0010, Accuracy: 586/592 (98.9865%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   6,  Average loss: 0.0009, Accuracy: 588/592 (99.3243%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   7,  Average loss: 0.0006, Accuracy: 588/592 (99.3243%), train_poison_data_count: 592
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   8,  Average loss: 0.0005, Accuracy: 590/592 (99.6622%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch   9,  Average loss: 0.0004, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 55, internal_epoch  10,  Average loss: 0.0004, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Global model norm: 16.345191439782067.
Norm before scaling: 16.613050253361155. Distance: 3.8766384967579706
Total norm for 7 adversaries is: 16.613050253361155. distance: 3.8766384967579706
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1654, Accuracy: 8561/8991 (95.2174%)
poison local model 67 index 66 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   1,  Average loss: 0.0049, Accuracy: 607/643 (94.4012%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   2,  Average loss: 0.0031, Accuracy: 605/643 (94.0902%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   3,  Average loss: 0.0015, Accuracy: 628/643 (97.6672%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   4,  Average loss: 0.0008, Accuracy: 636/643 (98.9114%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   5,  Average loss: 0.0006, Accuracy: 638/643 (99.2224%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   6,  Average loss: 0.0005, Accuracy: 639/643 (99.3779%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   7,  Average loss: 0.0004, Accuracy: 641/643 (99.6890%), train_poison_data_count: 643
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   8,  Average loss: 0.0003, Accuracy: 641/643 (99.6890%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch   9,  Average loss: 0.0003, Accuracy: 642/643 (99.8445%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 67, internal_epoch  10,  Average loss: 0.0003, Accuracy: 642/643 (99.8445%), train_poison_data_count: 643
Global model norm: 16.345191439782067.
Norm before scaling: 16.511785748474196. Distance: 3.47885858386178
Total norm for 7 adversaries is: 16.511785748474196. distance: 3.47885858386178
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1318, Accuracy: 8648/8991 (96.1851%)
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   1,  Average loss: 0.0064, Accuracy: 588/626 (93.9297%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   2,  Average loss: 0.0036, Accuracy: 580/626 (92.6518%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   3,  Average loss: 0.0017, Accuracy: 611/626 (97.6038%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   4,  Average loss: 0.0011, Accuracy: 616/626 (98.4026%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   5,  Average loss: 0.0007, Accuracy: 621/626 (99.2013%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   6,  Average loss: 0.0006, Accuracy: 621/626 (99.2013%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   7,  Average loss: 0.0005, Accuracy: 623/626 (99.5208%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   8,  Average loss: 0.0005, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch   9,  Average loss: 0.0004, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 56, internal_epoch  10,  Average loss: 0.0004, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Global model norm: 16.345191439782067.
Norm before scaling: 16.463870170652275. Distance: 3.3839440688703286
Total norm for 7 adversaries is: 16.463870170652275. distance: 3.3839440688703286
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1040, Accuracy: 8692/8991 (96.6745%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 538/580 (92.7586%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   2,  Average loss: 0.0033, Accuracy: 541/580 (93.2759%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   3,  Average loss: 0.0027, Accuracy: 550/580 (94.8276%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   4,  Average loss: 0.0010, Accuracy: 574/580 (98.9655%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   5,  Average loss: 0.0008, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   6,  Average loss: 0.0007, Accuracy: 576/580 (99.3103%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   7,  Average loss: 0.0005, Accuracy: 578/580 (99.6552%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   8,  Average loss: 0.0005, Accuracy: 578/580 (99.6552%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   9,  Average loss: 0.0004, Accuracy: 578/580 (99.6552%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch  10,  Average loss: 0.0004, Accuracy: 578/580 (99.6552%), train_poison_data_count: 580
Global model norm: 16.345191439782067.
Norm before scaling: 16.671574798140696. Distance: 3.894933804107447
Total norm for 7 adversaries is: 16.671574798140696. distance: 3.894933804107447
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1494, Accuracy: 8601/8991 (95.6623%)
time spent on training: 132.11237406730652
[foolsgold agg] training data poison_ratio: 0.6992582602832097  data num: [532, 588, 597, 664, 582, 528, 592, 643, 626, 580]
[foolsgold agg] considering poison per batch poison_fraction: 0.6992582602832097
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.8860, Accuracy: 8307/10000 (83.0700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.4881, Accuracy: 8345/8991 (92.8150%)
Done in 459.94054317474365 sec.
Server Epoch:15 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 546/587 (93.0153%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   2,  Average loss: 0.0058, Accuracy: 530/587 (90.2896%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   3,  Average loss: 0.0029, Accuracy: 554/587 (94.3782%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   4,  Average loss: 0.0011, Accuracy: 580/587 (98.8075%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   5,  Average loss: 0.0009, Accuracy: 581/587 (98.9779%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   6,  Average loss: 0.0007, Accuracy: 583/587 (99.3186%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   7,  Average loss: 0.0006, Accuracy: 584/587 (99.4889%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   8,  Average loss: 0.0005, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   9,  Average loss: 0.0005, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch  10,  Average loss: 0.0004, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Global model norm: 16.462084121491024.
Norm before scaling: 16.861575968474153. Distance: 4.149919780277597
Total norm for 8 adversaries is: 16.861575968474153. distance: 4.149919780277597
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1187, Accuracy: 8662/8991 (96.3408%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0070, Accuracy: 567/606 (93.5644%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   2,  Average loss: 0.0030, Accuracy: 566/606 (93.3993%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   3,  Average loss: 0.0018, Accuracy: 586/606 (96.6997%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   4,  Average loss: 0.0010, Accuracy: 594/606 (98.0198%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   5,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   6,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   7,  Average loss: 0.0005, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   8,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   9,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch  10,  Average loss: 0.0004, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Global model norm: 16.462084121491024.
Norm before scaling: 16.65823232223523. Distance: 3.72729855991555
Total norm for 8 adversaries is: 16.65823232223523. distance: 3.72729855991555
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1380, Accuracy: 8612/8991 (95.7847%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   1,  Average loss: 0.0091, Accuracy: 500/553 (90.4159%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   2,  Average loss: 0.0044, Accuracy: 504/553 (91.1392%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   3,  Average loss: 0.0017, Accuracy: 536/553 (96.9259%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   4,  Average loss: 0.0013, Accuracy: 540/553 (97.6492%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   5,  Average loss: 0.0012, Accuracy: 545/553 (98.5533%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   6,  Average loss: 0.0009, Accuracy: 547/553 (98.9150%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   7,  Average loss: 0.0008, Accuracy: 547/553 (98.9150%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   8,  Average loss: 0.0007, Accuracy: 547/553 (98.9150%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch   9,  Average loss: 0.0007, Accuracy: 549/553 (99.2767%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 20, internal_epoch  10,  Average loss: 0.0007, Accuracy: 549/553 (99.2767%), train_poison_data_count: 553
Global model norm: 16.462084121491024.
Norm before scaling: 16.764897795563893. Distance: 4.009629103709769
Total norm for 8 adversaries is: 16.764897795563893. distance: 4.009629103709769
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1125, Accuracy: 8685/8991 (96.5966%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   1,  Average loss: 0.0084, Accuracy: 535/589 (90.8319%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   2,  Average loss: 0.0033, Accuracy: 558/589 (94.7368%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   3,  Average loss: 0.0015, Accuracy: 576/589 (97.7929%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   4,  Average loss: 0.0011, Accuracy: 577/589 (97.9626%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   5,  Average loss: 0.0012, Accuracy: 582/589 (98.8115%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   6,  Average loss: 0.0007, Accuracy: 583/589 (98.9813%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   7,  Average loss: 0.0006, Accuracy: 584/589 (99.1511%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   8,  Average loss: 0.0006, Accuracy: 587/589 (99.6604%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch   9,  Average loss: 0.0006, Accuracy: 588/589 (99.8302%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 48, internal_epoch  10,  Average loss: 0.0005, Accuracy: 588/589 (99.8302%), train_poison_data_count: 589
Global model norm: 16.462084121491024.
Norm before scaling: 16.873861542905367. Distance: 4.517342527903358
Total norm for 8 adversaries is: 16.873861542905367. distance: 4.517342527903358
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1532, Accuracy: 8572/8991 (95.3398%)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   1,  Average loss: 0.0035, Accuracy: 569/592 (96.1149%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   2,  Average loss: 0.0013, Accuracy: 576/592 (97.2973%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   3,  Average loss: 0.0006, Accuracy: 586/592 (98.9865%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   4,  Average loss: 0.0003, Accuracy: 589/592 (99.4932%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   5,  Average loss: 0.0002, Accuracy: 590/592 (99.6622%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   6,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   7,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   8,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch   9,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 55, internal_epoch  10,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Global model norm: 16.462084121491024.
Norm before scaling: 16.482786505216964. Distance: 2.3683908758973753
Total norm for 8 adversaries is: 16.482786505216964. distance: 2.3683908758973753
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1685, Accuracy: 8608/8991 (95.7402%)
___Train Local_Simple,  epoch  15, local model 98, internal_epoch   1,  Average loss: 0.0091, Accuracy: 488/568 (85.9155%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.7216, Accuracy: 7334/10000 (73.3400%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   1,  Average loss: 0.0058, Accuracy: 602/650 (92.6154%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   2,  Average loss: 0.0028, Accuracy: 618/650 (95.0769%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   3,  Average loss: 0.0015, Accuracy: 629/650 (96.7692%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   4,  Average loss: 0.0010, Accuracy: 636/650 (97.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   5,  Average loss: 0.0008, Accuracy: 643/650 (98.9231%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   6,  Average loss: 0.0006, Accuracy: 643/650 (98.9231%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   7,  Average loss: 0.0006, Accuracy: 646/650 (99.3846%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   8,  Average loss: 0.0006, Accuracy: 648/650 (99.6923%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch   9,  Average loss: 0.0004, Accuracy: 648/650 (99.6923%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 27, internal_epoch  10,  Average loss: 0.0005, Accuracy: 648/650 (99.6923%), train_poison_data_count: 650
Global model norm: 16.462084121491024.
Norm before scaling: 16.801728041649373. Distance: 3.8732625696368186
Total norm for 8 adversaries is: 16.801728041649373. distance: 3.8732625696368186
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1191, Accuracy: 8680/8991 (96.5410%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   1,  Average loss: 0.0057, Accuracy: 611/665 (91.8797%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   2,  Average loss: 0.0017, Accuracy: 644/665 (96.8421%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   3,  Average loss: 0.0009, Accuracy: 649/665 (97.5940%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   4,  Average loss: 0.0004, Accuracy: 662/665 (99.5489%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   5,  Average loss: 0.0003, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   6,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   7,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   8,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch   9,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 42, internal_epoch  10,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.462084121491024.
Norm before scaling: 16.720870922714. Distance: 3.7820126103393186
Total norm for 8 adversaries is: 16.720870922714. distance: 3.7820126103393186
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1379, Accuracy: 8629/8991 (95.9738%)
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0218, Accuracy: 462/609 (75.8621%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0112, Accuracy: 7269/10000 (72.6900%), Attack Success Rate:0/10000(0.000)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   1,  Average loss: 0.0055, Accuracy: 485/518 (93.6293%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   2,  Average loss: 0.0053, Accuracy: 483/518 (93.2432%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   3,  Average loss: 0.0010, Accuracy: 508/518 (98.0695%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   4,  Average loss: 0.0007, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   5,  Average loss: 0.0006, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   6,  Average loss: 0.0006, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   7,  Average loss: 0.0004, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   8,  Average loss: 0.0003, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch   9,  Average loss: 0.0003, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  15, local model 44, internal_epoch  10,  Average loss: 0.0004, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 16.462084121491024.
Norm before scaling: 16.638435155208033. Distance: 3.4446251285155802
Total norm for 8 adversaries is: 16.638435155208033. distance: 3.4446251285155802
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1186, Accuracy: 8683/8991 (96.5744%)
time spent on training: 144.54844188690186
[foolsgold agg] training data poison_ratio: 0.8017517264611757  data num: [587, 606, 553, 589, 592, 568, 650, 665, 609, 518]
[foolsgold agg] considering poison per batch poison_fraction: 0.8017517264611757
[foolsgold agg] wv: [1.         1.         1.         1.         0.95431668 1.
 1.         0.95431668 1.         0.97164404]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 1.5069, Accuracy: 8474/10000 (84.7400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.2984, Accuracy: 8527/8991 (94.8393%)
Done in 469.9375228881836 sec.
Server Epoch:16 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0039, Accuracy: 545/582 (93.6426%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   2,  Average loss: 0.0070, Accuracy: 520/582 (89.3471%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   3,  Average loss: 0.0030, Accuracy: 549/582 (94.3299%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   4,  Average loss: 0.0017, Accuracy: 564/582 (96.9072%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   5,  Average loss: 0.0011, Accuracy: 572/582 (98.2818%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   6,  Average loss: 0.0010, Accuracy: 577/582 (99.1409%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   7,  Average loss: 0.0006, Accuracy: 579/582 (99.4845%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   8,  Average loss: 0.0005, Accuracy: 579/582 (99.4845%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch   9,  Average loss: 0.0005, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 25, internal_epoch  10,  Average loss: 0.0005, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Global model norm: 16.541331917989364.
Norm before scaling: 16.878634591223975. Distance: 3.702645057448493
Total norm for 8 adversaries is: 16.878634591223975. distance: 3.702645057448493
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1170, Accuracy: 8668/8991 (96.4075%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0032, Accuracy: 658/683 (96.3397%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   2,  Average loss: 0.0028, Accuracy: 645/683 (94.4363%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   3,  Average loss: 0.0026, Accuracy: 651/683 (95.3148%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   4,  Average loss: 0.0006, Accuracy: 676/683 (98.9751%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   5,  Average loss: 0.0006, Accuracy: 673/683 (98.5359%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   6,  Average loss: 0.0004, Accuracy: 677/683 (99.1215%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   7,  Average loss: 0.0003, Accuracy: 681/683 (99.7072%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   8,  Average loss: 0.0003, Accuracy: 681/683 (99.7072%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch   9,  Average loss: 0.0002, Accuracy: 681/683 (99.7072%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 8, internal_epoch  10,  Average loss: 0.0002, Accuracy: 681/683 (99.7072%), train_poison_data_count: 683
Global model norm: 16.541331917989364.
Norm before scaling: 16.554207276836095. Distance: 2.4270378948973628
Total norm for 8 adversaries is: 16.554207276836095. distance: 2.4270378948973628
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0900, Accuracy: 8752/8991 (97.3418%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0050, Accuracy: 557/597 (93.2998%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   2,  Average loss: 0.0036, Accuracy: 556/597 (93.1323%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   3,  Average loss: 0.0022, Accuracy: 573/597 (95.9799%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   4,  Average loss: 0.0010, Accuracy: 589/597 (98.6600%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   5,  Average loss: 0.0006, Accuracy: 590/597 (98.8275%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   6,  Average loss: 0.0005, Accuracy: 591/597 (98.9950%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   7,  Average loss: 0.0004, Accuracy: 594/597 (99.4975%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   8,  Average loss: 0.0004, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch   9,  Average loss: 0.0003, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 12, internal_epoch  10,  Average loss: 0.0003, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Global model norm: 16.541331917989364.
Norm before scaling: 16.66435642761173. Distance: 2.8841141240770423
Total norm for 8 adversaries is: 16.66435642761173. distance: 2.8841141240770423
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1075, Accuracy: 8702/8991 (96.7857%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0030, Accuracy: 388/410 (94.6341%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.8591, Accuracy: 7963/10000 (79.6300%), Attack Success Rate:0/10000(0.000)
poison local model 53 index 52 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   1,  Average loss: 0.0048, Accuracy: 573/617 (92.8687%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   2,  Average loss: 0.0018, Accuracy: 598/617 (96.9206%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   3,  Average loss: 0.0009, Accuracy: 604/617 (97.8930%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   4,  Average loss: 0.0004, Accuracy: 610/617 (98.8655%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   5,  Average loss: 0.0004, Accuracy: 613/617 (99.3517%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   6,  Average loss: 0.0003, Accuracy: 615/617 (99.6759%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   7,  Average loss: 0.0002, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   8,  Average loss: 0.0002, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch   9,  Average loss: 0.0002, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 53, internal_epoch  10,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Global model norm: 16.541331917989364.
Norm before scaling: 16.60761286807292. Distance: 2.6824934701404572
Total norm for 8 adversaries is: 16.60761286807292. distance: 2.6824934701404572
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1022, Accuracy: 8716/8991 (96.9414%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0039, Accuracy: 496/526 (94.2966%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   2,  Average loss: 0.0042, Accuracy: 487/526 (92.5856%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   3,  Average loss: 0.0009, Accuracy: 514/526 (97.7186%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   4,  Average loss: 0.0005, Accuracy: 523/526 (99.4297%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   5,  Average loss: 0.0003, Accuracy: 524/526 (99.6198%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   6,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   7,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   8,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Global model norm: 16.541331917989364.
Norm before scaling: 16.660832617425196. Distance: 2.8850342167720995
Total norm for 8 adversaries is: 16.660832617425196. distance: 2.8850342167720995
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1203, Accuracy: 8666/8991 (96.3853%)
poison local model 60 index 59 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   1,  Average loss: 0.0050, Accuracy: 603/644 (93.6335%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   2,  Average loss: 0.0021, Accuracy: 618/644 (95.9627%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   3,  Average loss: 0.0024, Accuracy: 621/644 (96.4286%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   4,  Average loss: 0.0007, Accuracy: 633/644 (98.2919%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   5,  Average loss: 0.0010, Accuracy: 632/644 (98.1366%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   6,  Average loss: 0.0006, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   7,  Average loss: 0.0003, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   8,  Average loss: 0.0003, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch   9,  Average loss: 0.0002, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 60, internal_epoch  10,  Average loss: 0.0002, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Global model norm: 16.541331917989364.
Norm before scaling: 16.633536305587484. Distance: 2.84747657156693
Total norm for 8 adversaries is: 16.633536305587484. distance: 2.84747657156693
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1341, Accuracy: 8647/8991 (96.1740%)
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   1,  Average loss: 0.0041, Accuracy: 582/616 (94.4805%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   2,  Average loss: 0.0032, Accuracy: 581/616 (94.3182%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   3,  Average loss: 0.0012, Accuracy: 600/616 (97.4026%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   4,  Average loss: 0.0007, Accuracy: 613/616 (99.5130%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   5,  Average loss: 0.0005, Accuracy: 612/616 (99.3506%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   6,  Average loss: 0.0003, Accuracy: 615/616 (99.8377%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   7,  Average loss: 0.0003, Accuracy: 615/616 (99.8377%), train_poison_data_count: 616
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   8,  Average loss: 0.0002, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch   9,  Average loss: 0.0002, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 63, internal_epoch  10,  Average loss: 0.0002, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Global model norm: 16.541331917989364.
Norm before scaling: 16.62323493479129. Distance: 2.685194934325467
Total norm for 8 adversaries is: 16.62323493479129. distance: 2.685194934325467
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1018, Accuracy: 8726/8991 (97.0526%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   1,  Average loss: 0.0061, Accuracy: 567/618 (91.7476%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   2,  Average loss: 0.0031, Accuracy: 580/618 (93.8511%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   3,  Average loss: 0.0013, Accuracy: 601/618 (97.2492%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   4,  Average loss: 0.0008, Accuracy: 608/618 (98.3819%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   5,  Average loss: 0.0006, Accuracy: 613/618 (99.1909%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   6,  Average loss: 0.0005, Accuracy: 614/618 (99.3528%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   7,  Average loss: 0.0004, Accuracy: 616/618 (99.6764%), train_poison_data_count: 618
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   8,  Average loss: 0.0004, Accuracy: 616/618 (99.6764%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch   9,  Average loss: 0.0004, Accuracy: 616/618 (99.6764%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  16, local model 52, internal_epoch  10,  Average loss: 0.0004, Accuracy: 616/618 (99.6764%), train_poison_data_count: 618
Global model norm: 16.541331917989364.
Norm before scaling: 16.70529905753149. Distance: 3.248585319733783
Total norm for 8 adversaries is: 16.70529905753149. distance: 3.248585319733783
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1183, Accuracy: 8661/8991 (96.3297%)
___Train Local_Simple,  epoch  16, local model 90, internal_epoch   1,  Average loss: 0.0181, Accuracy: 448/577 (77.6430%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.4126, Accuracy: 4085/10000 (40.8500%), Attack Success Rate:0/10000(0.000)
time spent on training: 146.2856149673462
[foolsgold agg] training data poison_ratio: 0.8318568994889267  data num: [582, 683, 597, 410, 617, 526, 644, 616, 618, 577]
[foolsgold agg] considering poison per batch poison_fraction: 0.8318568994889267
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 1.2841, Accuracy: 8567/10000 (85.6700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.2246, Accuracy: 8593/8991 (95.5734%)
Done in 473.0566830635071 sec.
Server Epoch:17 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
poison local model 66 index 65 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0040, Accuracy: 592/629 (94.1176%), train_poison_data_count: 629
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   2,  Average loss: 0.0013, Accuracy: 608/629 (96.6614%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   3,  Average loss: 0.0009, Accuracy: 617/629 (98.0922%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   4,  Average loss: 0.0004, Accuracy: 627/629 (99.6820%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   5,  Average loss: 0.0003, Accuracy: 629/629 (100.0000%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   6,  Average loss: 0.0002, Accuracy: 629/629 (100.0000%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   7,  Average loss: 0.0002, Accuracy: 629/629 (100.0000%), train_poison_data_count: 629
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   8,  Average loss: 0.0002, Accuracy: 629/629 (100.0000%), train_poison_data_count: 629
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch   9,  Average loss: 0.0002, Accuracy: 629/629 (100.0000%), train_poison_data_count: 629
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 66, internal_epoch  10,  Average loss: 0.0002, Accuracy: 629/629 (100.0000%), train_poison_data_count: 629
Global model norm: 16.598325051981902.
Norm before scaling: 16.607728634302315. Distance: 2.3241780253456823
Total norm for 8 adversaries is: 16.607728634302315. distance: 2.3241780253456823
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0942, Accuracy: 8730/8991 (97.0971%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   1,  Average loss: 0.0032, Accuracy: 610/638 (95.6113%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   2,  Average loss: 0.0010, Accuracy: 623/638 (97.6489%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   3,  Average loss: 0.0004, Accuracy: 636/638 (99.6865%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   4,  Average loss: 0.0003, Accuracy: 636/638 (99.6865%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   5,  Average loss: 0.0002, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   6,  Average loss: 0.0002, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   7,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   8,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch   9,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 33, internal_epoch  10,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 16.598325051981902.
Norm before scaling: 16.584508704061093. Distance: 2.0944876438995763
Total norm for 8 adversaries is: 16.584508704061093. distance: 2.0944876438995763
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1051, Accuracy: 8682/8991 (96.5632%)
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   1,  Average loss: 0.0034, Accuracy: 602/626 (96.1661%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   2,  Average loss: 0.0013, Accuracy: 614/626 (98.0831%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   3,  Average loss: 0.0004, Accuracy: 620/626 (99.0415%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   4,  Average loss: 0.0003, Accuracy: 624/626 (99.6805%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   5,  Average loss: 0.0003, Accuracy: 624/626 (99.6805%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   6,  Average loss: 0.0002, Accuracy: 624/626 (99.6805%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   7,  Average loss: 0.0002, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   8,  Average loss: 0.0002, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch   9,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 56, internal_epoch  10,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Global model norm: 16.598325051981902.
Norm before scaling: 16.557611859747375. Distance: 1.9223036869453667
Total norm for 8 adversaries is: 16.557611859747375. distance: 1.9223036869453667
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0951, Accuracy: 8732/8991 (97.1193%)
___Train Local_Simple,  epoch  17, local model 97, internal_epoch   1,  Average loss: 0.0168, Accuracy: 449/588 (76.3605%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.7300, Accuracy: 8156/10000 (81.5600%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 548/572 (95.8042%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0012, Accuracy: 558/572 (97.5524%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   3,  Average loss: 0.0005, Accuracy: 567/572 (99.1259%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   4,  Average loss: 0.0004, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   5,  Average loss: 0.0002, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   6,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   8,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch   9,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 10, internal_epoch  10,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.598325051981902.
Norm before scaling: 16.584770919878384. Distance: 1.8926098075868159
Total norm for 8 adversaries is: 16.584770919878384. distance: 1.8926098075868159
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1136, Accuracy: 8670/8991 (96.4298%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 503/521 (96.5451%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   2,  Average loss: 0.0038, Accuracy: 490/521 (94.0499%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   3,  Average loss: 0.0009, Accuracy: 513/521 (98.4645%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   4,  Average loss: 0.0009, Accuracy: 516/521 (99.0403%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   5,  Average loss: 0.0008, Accuracy: 517/521 (99.2322%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   6,  Average loss: 0.0006, Accuracy: 517/521 (99.2322%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   7,  Average loss: 0.0005, Accuracy: 517/521 (99.2322%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   8,  Average loss: 0.0004, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch   9,  Average loss: 0.0003, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 13, internal_epoch  10,  Average loss: 0.0003, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Global model norm: 16.598325051981902.
Norm before scaling: 16.653161540879875. Distance: 2.992393068269009
Total norm for 8 adversaries is: 16.653161540879875. distance: 2.992393068269009
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1229, Accuracy: 8674/8991 (96.4743%)
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   1,  Average loss: 0.0046, Accuracy: 489/519 (94.2197%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   2,  Average loss: 0.0015, Accuracy: 504/519 (97.1098%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   3,  Average loss: 0.0011, Accuracy: 512/519 (98.6513%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 516/519 (99.4220%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   5,  Average loss: 0.0003, Accuracy: 517/519 (99.6146%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   7,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%), train_poison_data_count: 519
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   8,  Average loss: 0.0002, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch   9,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 77, internal_epoch  10,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Global model norm: 16.598325051981902.
Norm before scaling: 16.635677264741602. Distance: 2.10856624216438
Total norm for 8 adversaries is: 16.635677264741602. distance: 2.10856624216438
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1147, Accuracy: 8705/8991 (96.8190%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   1,  Average loss: 0.0032, Accuracy: 612/641 (95.4758%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   2,  Average loss: 0.0107, Accuracy: 568/641 (88.6115%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   3,  Average loss: 0.0108, Accuracy: 550/641 (85.8034%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   4,  Average loss: 0.0033, Accuracy: 606/641 (94.5398%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   5,  Average loss: 0.0018, Accuracy: 621/641 (96.8799%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   6,  Average loss: 0.0014, Accuracy: 624/641 (97.3479%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   7,  Average loss: 0.0025, Accuracy: 631/641 (98.4399%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   8,  Average loss: 0.0018, Accuracy: 616/641 (96.0998%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch   9,  Average loss: 0.0014, Accuracy: 627/641 (97.8159%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 37, internal_epoch  10,  Average loss: 0.0009, Accuracy: 633/641 (98.7520%), train_poison_data_count: 641
Global model norm: 16.598325051981902.
Norm before scaling: 18.63021716070637. Distance: 8.478140604108152
Total norm for 8 adversaries is: 18.63021716070637. distance: 8.478140604108152
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.2093, Accuracy: 8419/8991 (93.6381%)
___Train Local_Simple,  epoch  17, local model 90, internal_epoch   1,  Average loss: 0.0095, Accuracy: 481/577 (83.3622%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3022, Accuracy: 9039/10000 (90.3900%), Attack Success Rate:0/10000(0.000)
poison local model 59 index 58 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0025, Accuracy: 632/652 (96.9325%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   2,  Average loss: 0.0009, Accuracy: 641/652 (98.3129%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   3,  Average loss: 0.0003, Accuracy: 648/652 (99.3865%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   4,  Average loss: 0.0002, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   5,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   6,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   7,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch   9,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  17, local model 59, internal_epoch  10,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 16.598325051981902.
Norm before scaling: 16.552949966332. Distance: 1.8413629759023742
Total norm for 8 adversaries is: 16.552949966332. distance: 1.8413629759023742
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1114, Accuracy: 8717/8991 (96.9525%)
time spent on training: 146.31740593910217
[foolsgold agg] training data poison_ratio: 0.8046285426798592  data num: [629, 638, 626, 588, 572, 521, 519, 641, 577, 652]
[foolsgold agg] considering poison per batch poison_fraction: 0.8046285426798592
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 1.2315, Accuracy: 8653/10000 (86.5300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.1742, Accuracy: 8652/8991 (96.2296%)
Done in 472.463228225708 sec.
Server Epoch:18 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0037, Accuracy: 572/592 (96.6216%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   2,  Average loss: 0.0020, Accuracy: 566/592 (95.6081%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   3,  Average loss: 0.0009, Accuracy: 583/592 (98.4797%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   4,  Average loss: 0.0005, Accuracy: 587/592 (99.1554%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   5,  Average loss: 0.0003, Accuracy: 589/592 (99.4932%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   6,  Average loss: 0.0002, Accuracy: 591/592 (99.8311%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   7,  Average loss: 0.0002, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   8,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch   9,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 55, internal_epoch  10,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Global model norm: 16.6522058440513.
Norm before scaling: 16.68816474419212. Distance: 2.325384485591331
Total norm for 6 adversaries is: 16.68816474419212. distance: 2.325384485591331
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1540, Accuracy: 8614/8991 (95.8069%)
poison local model 58 index 57 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   1,  Average loss: 0.0036, Accuracy: 489/510 (95.8824%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   2,  Average loss: 0.0009, Accuracy: 497/510 (97.4510%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   3,  Average loss: 0.0004, Accuracy: 508/510 (99.6078%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   4,  Average loss: 0.0002, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   5,  Average loss: 0.0002, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   6,  Average loss: 0.0002, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   7,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   8,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch   9,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 58, internal_epoch  10,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Global model norm: 16.6522058440513.
Norm before scaling: 16.610302846261753. Distance: 1.6001389294150572
Total norm for 6 adversaries is: 16.610302846261753. distance: 1.6001389294150572
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1014, Accuracy: 8731/8991 (97.1082%)
___Train Local_Simple,  epoch  18, local model 88, internal_epoch   1,  Average loss: 0.0077, Accuracy: 593/679 (87.3343%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2243, Accuracy: 9328/10000 (93.2800%), Attack Success Rate:0/10000(0.000)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   1,  Average loss: 0.0039, Accuracy: 562/588 (95.5782%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   2,  Average loss: 0.0015, Accuracy: 571/588 (97.1088%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   3,  Average loss: 0.0008, Accuracy: 579/588 (98.4694%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   4,  Average loss: 0.0004, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   5,  Average loss: 0.0003, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   6,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   7,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   8,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch   9,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 23, internal_epoch  10,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.6522058440513.
Norm before scaling: 16.622262829772342. Distance: 1.93766667049077
Total norm for 6 adversaries is: 16.622262829772342. distance: 1.93766667049077
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1010, Accuracy: 8727/8991 (97.0637%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   1,  Average loss: 0.0034, Accuracy: 469/503 (93.2406%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   2,  Average loss: 0.0011, Accuracy: 492/503 (97.8131%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   3,  Average loss: 0.0005, Accuracy: 498/503 (99.0060%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   4,  Average loss: 0.0003, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   5,  Average loss: 0.0002, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch   9,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 39, internal_epoch  10,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 16.6522058440513.
Norm before scaling: 16.67059635882845. Distance: 1.8148008409633962
Total norm for 6 adversaries is: 16.67059635882845. distance: 1.8148008409633962
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1075, Accuracy: 8716/8991 (96.9414%)
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   1,  Average loss: 0.0022, Accuracy: 533/554 (96.2094%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   2,  Average loss: 0.0008, Accuracy: 543/554 (98.0144%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   3,  Average loss: 0.0003, Accuracy: 549/554 (99.0975%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   4,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   5,  Average loss: 0.0002, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   6,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   7,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   8,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch   9,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 75, internal_epoch  10,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 16.6522058440513.
Norm before scaling: 16.63136846420605. Distance: 1.497410605537415
Total norm for 6 adversaries is: 16.63136846420605. distance: 1.497410605537415
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1094, Accuracy: 8724/8991 (97.0304%)
___Train Local_Simple,  epoch  18, local model 82, internal_epoch   1,  Average loss: 0.0082, Accuracy: 536/621 (86.3124%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2341, Accuracy: 9147/10000 (91.4700%), Attack Success Rate:0/10000(0.000)
poison local model 61 index 60 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   1,  Average loss: 0.0020, Accuracy: 523/537 (97.3929%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   2,  Average loss: 0.0018, Accuracy: 517/537 (96.2756%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   3,  Average loss: 0.0013, Accuracy: 525/537 (97.7654%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   4,  Average loss: 0.0005, Accuracy: 531/537 (98.8827%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   5,  Average loss: 0.0002, Accuracy: 535/537 (99.6276%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   6,  Average loss: 0.0002, Accuracy: 535/537 (99.6276%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   7,  Average loss: 0.0001, Accuracy: 536/537 (99.8138%), train_poison_data_count: 537
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   8,  Average loss: 0.0001, Accuracy: 537/537 (100.0000%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch   9,  Average loss: 0.0001, Accuracy: 537/537 (100.0000%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  18, local model 61, internal_epoch  10,  Average loss: 0.0001, Accuracy: 537/537 (100.0000%), train_poison_data_count: 537
Global model norm: 16.6522058440513.
Norm before scaling: 16.61848769596022. Distance: 1.4910423318391413
Total norm for 6 adversaries is: 16.61848769596022. distance: 1.4910423318391413
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1178, Accuracy: 8718/8991 (96.9636%)
___Train Local_Simple,  epoch  18, local model 95, internal_epoch   1,  Average loss: 0.0084, Accuracy: 470/532 (88.3459%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5293, Accuracy: 8356/10000 (83.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 93, internal_epoch   1,  Average loss: 0.0072, Accuracy: 470/529 (88.8469%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4811, Accuracy: 8708/10000 (87.0800%), Attack Success Rate:0/10000(0.000)
time spent on training: 118.2167580127716
[foolsgold agg] training data poison_ratio: 0.5817537643932684  data num: [592, 510, 679, 588, 503, 554, 621, 537, 532, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.5817537643932684
[foolsgold agg] wv: [1.         0.70782487 0.74363428 0.2788531  1.         1.
 0.34999022 0.2788531  0.74491308 0.34999022]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 1.1020, Accuracy: 8715/10000 (87.1500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.1425, Accuracy: 8704/8991 (96.8079%)
Done in 444.2657473087311 sec.
Server Epoch:19 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   1,  Average loss: 0.0016, Accuracy: 619/641 (96.5679%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   2,  Average loss: 0.0018, Accuracy: 618/641 (96.4119%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   3,  Average loss: 0.0002, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   4,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   6,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   7,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 16.663130321442456.
Norm before scaling: 16.667487671022045. Distance: 1.8436089801199655
Total norm for 9 adversaries is: 16.667487671022045. distance: 1.8436089801199655
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1398, Accuracy: 8662/8991 (96.3408%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   1,  Average loss: 0.0034, Accuracy: 498/518 (96.1390%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   2,  Average loss: 0.0075, Accuracy: 482/518 (93.0502%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   3,  Average loss: 0.0020, Accuracy: 498/518 (96.1390%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   4,  Average loss: 0.0010, Accuracy: 507/518 (97.8764%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   5,  Average loss: 0.0006, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   6,  Average loss: 0.0005, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   7,  Average loss: 0.0004, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   8,  Average loss: 0.0003, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch   9,  Average loss: 0.0003, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 43, internal_epoch  10,  Average loss: 0.0003, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 16.663130321442456.
Norm before scaling: 17.080017264221187. Distance: 4.47762180863427
Total norm for 9 adversaries is: 17.080017264221187. distance: 4.47762180863427
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1046, Accuracy: 8709/8991 (96.8635%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   1,  Average loss: 0.0036, Accuracy: 457/474 (96.4135%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   2,  Average loss: 0.0019, Accuracy: 456/474 (96.2025%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   3,  Average loss: 0.0011, Accuracy: 464/474 (97.8903%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   4,  Average loss: 0.0005, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   5,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   6,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   7,  Average loss: 0.0002, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 16.663130321442456.
Norm before scaling: 16.63003807884715. Distance: 1.8639535390851136
Total norm for 9 adversaries is: 16.63003807884715. distance: 1.8639535390851136
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1149, Accuracy: 8691/8991 (96.6633%)
___Train Local_Simple,  epoch  19, local model 84, internal_epoch   1,  Average loss: 0.0068, Accuracy: 497/560 (88.7500%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2773, Accuracy: 9026/10000 (90.2600%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0024, Accuracy: 560/582 (96.2199%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   2,  Average loss: 0.0019, Accuracy: 558/582 (95.8763%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   3,  Average loss: 0.0004, Accuracy: 578/582 (99.3127%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   4,  Average loss: 0.0002, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   5,  Average loss: 0.0002, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 16.663130321442456.
Norm before scaling: 16.643439829418337. Distance: 1.6971464301815284
Total norm for 9 adversaries is: 16.643439829418337. distance: 1.6971464301815284
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1081, Accuracy: 8717/8991 (96.9525%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0033, Accuracy: 632/665 (95.0376%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   2,  Average loss: 0.0023, Accuracy: 632/665 (95.0376%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   3,  Average loss: 0.0008, Accuracy: 654/665 (98.3459%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   4,  Average loss: 0.0005, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   5,  Average loss: 0.0004, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   6,  Average loss: 0.0003, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   7,  Average loss: 0.0003, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   8,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch   9,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 28, internal_epoch  10,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.663130321442456.
Norm before scaling: 16.656557806724354. Distance: 2.1710012311189555
Total norm for 9 adversaries is: 16.656557806724354. distance: 2.1710012311189555
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1021, Accuracy: 8712/8991 (96.8969%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0024, Accuracy: 659/683 (96.4861%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   2,  Average loss: 0.0007, Accuracy: 674/683 (98.6823%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   3,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   4,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   5,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   6,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   7,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   8,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch   9,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Global model norm: 16.663130321442456.
Norm before scaling: 16.622306892419633. Distance: 1.5734518374383626
Total norm for 9 adversaries is: 16.622306892419633. distance: 1.5734518374383626
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0947, Accuracy: 8732/8991 (97.1193%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 546/581 (93.9759%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   2,  Average loss: 0.0028, Accuracy: 552/581 (95.0086%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   3,  Average loss: 0.0011, Accuracy: 565/581 (97.2461%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   4,  Average loss: 0.0006, Accuracy: 577/581 (99.3115%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   5,  Average loss: 0.0004, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   6,  Average loss: 0.0003, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   7,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   8,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch   9,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 16, internal_epoch  10,  Average loss: 0.0002, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 16.663130321442456.
Norm before scaling: 16.885465866227417. Distance: 3.3027518445076867
Total norm for 9 adversaries is: 16.885465866227417. distance: 3.3027518445076867
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.1051, Accuracy: 8705/8991 (96.8190%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 678/708 (95.7627%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   2,  Average loss: 0.0022, Accuracy: 676/708 (95.4802%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   3,  Average loss: 0.0008, Accuracy: 697/708 (98.4463%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   4,  Average loss: 0.0005, Accuracy: 702/708 (99.1525%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   5,  Average loss: 0.0003, Accuracy: 704/708 (99.4350%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   6,  Average loss: 0.0002, Accuracy: 705/708 (99.5763%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   7,  Average loss: 0.0002, Accuracy: 707/708 (99.8588%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   8,  Average loss: 0.0002, Accuracy: 707/708 (99.8588%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 16.663130321442456.
Norm before scaling: 16.712906031787043. Distance: 2.138134921178294
Total norm for 9 adversaries is: 16.712906031787043. distance: 2.138134921178294
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0848, Accuracy: 8748/8991 (97.2973%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 486/505 (96.2376%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   2,  Average loss: 0.0005, Accuracy: 499/505 (98.8119%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   3,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   4,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   5,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   6,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   7,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   8,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   9,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch  10,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Global model norm: 16.663130321442456.
Norm before scaling: 16.64366536192336. Distance: 1.277421534791763
Total norm for 9 adversaries is: 16.64366536192336. distance: 1.277421534791763
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0997, Accuracy: 8743/8991 (97.2417%)
time spent on training: 157.9886770248413
[foolsgold agg] training data poison_ratio: 0.9053574446510055  data num: [641, 518, 474, 560, 582, 665, 683, 581, 708, 505]
[foolsgold agg] considering poison per batch poison_fraction: 0.9053574446510055
[foolsgold agg] wv: [1.         1.         0.97174752 1.         0.97174752 1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 1.2042, Accuracy: 8769/10000 (87.6900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.1114, Accuracy: 8760/8991 (97.4308%)
Done in 484.98328709602356 sec.
Server Epoch:20 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   1,  Average loss: 0.0039, Accuracy: 559/588 (95.0680%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   2,  Average loss: 0.0042, Accuracy: 551/588 (93.7075%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   3,  Average loss: 0.0018, Accuracy: 572/588 (97.2789%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   4,  Average loss: 0.0013, Accuracy: 581/588 (98.8095%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   5,  Average loss: 0.0006, Accuracy: 581/588 (98.8095%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   6,  Average loss: 0.0004, Accuracy: 585/588 (99.4898%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   7,  Average loss: 0.0004, Accuracy: 586/588 (99.6599%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   8,  Average loss: 0.0003, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch   9,  Average loss: 0.0003, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 23, internal_epoch  10,  Average loss: 0.0003, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.705367563149334.
Norm before scaling: 16.73252754449679. Distance: 2.4582949058848325
Total norm for 9 adversaries is: 16.73252754449679. distance: 2.4582949058848325
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0923, Accuracy: 8733/8991 (97.1305%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   1,  Average loss: 0.0019, Accuracy: 502/518 (96.9112%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   2,  Average loss: 0.0008, Accuracy: 509/518 (98.2625%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   3,  Average loss: 0.0016, Accuracy: 503/518 (97.1042%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   4,  Average loss: 0.0003, Accuracy: 516/518 (99.6139%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   5,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   6,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   7,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   8,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch   9,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 16.705367563149334.
Norm before scaling: 16.690339836194354. Distance: 1.4918802953721202
Total norm for 9 adversaries is: 16.690339836194354. distance: 1.4918802953721202
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0960, Accuracy: 8719/8991 (96.9748%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   1,  Average loss: 0.0021, Accuracy: 632/650 (97.2308%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   2,  Average loss: 0.0012, Accuracy: 635/650 (97.6923%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   3,  Average loss: 0.0007, Accuracy: 642/650 (98.7692%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   4,  Average loss: 0.0002, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   5,  Average loss: 0.0002, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   6,  Average loss: 0.0002, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 16.705367563149334.
Norm before scaling: 16.674385317978647. Distance: 1.6406011670515948
Total norm for 9 adversaries is: 16.674385317978647. distance: 1.6406011670515948
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0898, Accuracy: 8757/8991 (97.3974%)
___Train Local_Simple,  epoch  20, local model 82, internal_epoch   1,  Average loss: 0.0069, Accuracy: 561/621 (90.3382%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1964, Accuracy: 9360/10000 (93.6000%), Attack Success Rate:0/10000(0.000)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 621/641 (96.8799%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   2,  Average loss: 0.0011, Accuracy: 624/641 (97.3479%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   3,  Average loss: 0.0015, Accuracy: 622/641 (97.0359%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   4,  Average loss: 0.0001, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   5,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   6,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 16.705367563149334.
Norm before scaling: 16.672834145324543. Distance: 1.4784224970928568
Total norm for 9 adversaries is: 16.672834145324543. distance: 1.4784224970928568
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1063, Accuracy: 8728/8991 (97.0749%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   1,  Average loss: 0.0020, Accuracy: 479/493 (97.1602%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   2,  Average loss: 0.0008, Accuracy: 486/493 (98.5801%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   3,  Average loss: 0.0004, Accuracy: 490/493 (99.3915%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   4,  Average loss: 0.0002, Accuracy: 491/493 (99.5943%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   5,  Average loss: 0.0001, Accuracy: 492/493 (99.7972%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   6,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   7,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   8,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch   9,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 35, internal_epoch  10,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.705367563149334.
Norm before scaling: 16.67336769178761. Distance: 1.3727645475234698
Total norm for 9 adversaries is: 16.67336769178761. distance: 1.3727645475234698
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1299, Accuracy: 8685/8991 (96.5966%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   1,  Average loss: 0.0021, Accuracy: 582/605 (96.1983%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   2,  Average loss: 0.0011, Accuracy: 596/605 (98.5124%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   3,  Average loss: 0.0009, Accuracy: 593/605 (98.0165%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   4,  Average loss: 0.0004, Accuracy: 603/605 (99.6694%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   5,  Average loss: 0.0003, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   6,  Average loss: 0.0002, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   7,  Average loss: 0.0002, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 16.705367563149334.
Norm before scaling: 16.666429339944397. Distance: 1.5669247347071462
Total norm for 9 adversaries is: 16.666429339944397. distance: 1.5669247347071462
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1146, Accuracy: 8714/8991 (96.9191%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   1,  Average loss: 0.0020, Accuracy: 585/602 (97.1761%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   2,  Average loss: 0.0010, Accuracy: 592/602 (98.3389%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   3,  Average loss: 0.0005, Accuracy: 596/602 (99.0033%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   4,  Average loss: 0.0002, Accuracy: 601/602 (99.8339%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   5,  Average loss: 0.0001, Accuracy: 601/602 (99.8339%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   6,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   7,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   8,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch   9,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 47, internal_epoch  10,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 16.705367563149334.
Norm before scaling: 16.632913412681194. Distance: 1.387646088341205
Total norm for 9 adversaries is: 16.632913412681194. distance: 1.387646088341205
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0966, Accuracy: 8753/8991 (97.3529%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0020, Accuracy: 621/644 (96.4286%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   2,  Average loss: 0.0009, Accuracy: 631/644 (97.9814%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   3,  Average loss: 0.0006, Accuracy: 637/644 (98.9130%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   5,  Average loss: 0.0003, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   6,  Average loss: 0.0003, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   7,  Average loss: 0.0002, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   8,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   9,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 16.705367563149334.
Norm before scaling: 16.68539952692314. Distance: 1.759581358277157
Total norm for 9 adversaries is: 16.68539952692314. distance: 1.759581358277157
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1374, Accuracy: 8651/8991 (96.2184%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   1,  Average loss: 0.0016, Accuracy: 648/665 (97.4436%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   2,  Average loss: 0.0007, Accuracy: 657/665 (98.7970%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  20, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.705367563149334.
Norm before scaling: 16.663598248631562. Distance: 1.4528917515095934
Total norm for 9 adversaries is: 16.663598248631562. distance: 1.4528917515095934
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1002, Accuracy: 8740/8991 (97.2083%)
time spent on training: 159.4664580821991
[foolsgold agg] training data poison_ratio: 0.8969636635141862  data num: [588, 518, 650, 621, 641, 493, 605, 602, 644, 665]
[foolsgold agg] considering poison per batch poison_fraction: 0.8969636635141862
[foolsgold agg] wv: [0.16209766 1.         1.         1.         1.         0.13659021
 1.         1.         0.73893417 0.13659021]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 1.1249, Accuracy: 8771/10000 (87.7100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.1102, Accuracy: 8763/8991 (97.4641%)
Done in 487.9471538066864 sec.
Server Epoch:21 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   1,  Average loss: 0.0012, Accuracy: 620/638 (97.1787%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   2,  Average loss: 0.0008, Accuracy: 629/638 (98.5893%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   3,  Average loss: 0.0003, Accuracy: 635/638 (99.5298%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   4,  Average loss: 0.0002, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   6,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   7,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 16.723655822292564.
Norm before scaling: 16.67717889507807. Distance: 1.278993247305885
Total norm for 7 adversaries is: 16.67717889507807. distance: 1.278993247305885
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1051, Accuracy: 8732/8991 (97.1193%)
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0023, Accuracy: 575/597 (96.3149%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   2,  Average loss: 0.0015, Accuracy: 579/597 (96.9849%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   3,  Average loss: 0.0006, Accuracy: 589/597 (98.6600%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   4,  Average loss: 0.0003, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   5,  Average loss: 0.0002, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   6,  Average loss: 0.0002, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   8,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch   9,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 12, internal_epoch  10,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Global model norm: 16.723655822292564.
Norm before scaling: 16.70372609126572. Distance: 1.6672804258667446
Total norm for 7 adversaries is: 16.70372609126572. distance: 1.6672804258667446
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1066, Accuracy: 8736/8991 (97.1638%)
___Train Local_Simple,  epoch  21, local model 93, internal_epoch   1,  Average loss: 0.0080, Accuracy: 469/529 (88.6578%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6482, Accuracy: 7969/10000 (79.6900%), Attack Success Rate:0/10000(0.000)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   1,  Average loss: 0.0027, Accuracy: 554/572 (96.8531%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   2,  Average loss: 0.0014, Accuracy: 550/572 (96.1538%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   3,  Average loss: 0.0008, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   4,  Average loss: 0.0004, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   5,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   6,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   7,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   8,  Average loss: 0.0002, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.723655822292564.
Norm before scaling: 16.66121177415386. Distance: 1.5395342883125847
Total norm for 7 adversaries is: 16.66121177415386. distance: 1.5395342883125847
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0848, Accuracy: 8781/8991 (97.6643%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   1,  Average loss: 0.0023, Accuracy: 632/652 (96.9325%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   2,  Average loss: 0.0011, Accuracy: 635/652 (97.3926%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   3,  Average loss: 0.0007, Accuracy: 643/652 (98.6196%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   4,  Average loss: 0.0003, Accuracy: 649/652 (99.5399%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   7,  Average loss: 0.0002, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 16.723655822292564.
Norm before scaling: 16.670840745215695. Distance: 1.6119706785834136
Total norm for 7 adversaries is: 16.670840745215695. distance: 1.6119706785834136
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1132, Accuracy: 8702/8991 (96.7857%)
___Train Local_Simple,  epoch  21, local model 97, internal_epoch   1,  Average loss: 0.0095, Accuracy: 496/588 (84.3537%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8367, Accuracy: 7856/10000 (78.5600%), Attack Success Rate:0/10000(0.000)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   1,  Average loss: 0.0027, Accuracy: 534/553 (96.5642%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   2,  Average loss: 0.0013, Accuracy: 544/553 (98.3725%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   3,  Average loss: 0.0006, Accuracy: 545/553 (98.5533%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   4,  Average loss: 0.0004, Accuracy: 550/553 (99.4575%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   5,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   6,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   7,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   8,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch   9,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 20, internal_epoch  10,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Global model norm: 16.723655822292564.
Norm before scaling: 16.65903562687763. Distance: 1.480778241582658
Total norm for 7 adversaries is: 16.65903562687763. distance: 1.480778241582658
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0781, Accuracy: 8790/8991 (97.7644%)
___Train Local_Simple,  epoch  21, local model 86, internal_epoch   1,  Average loss: 0.0050, Accuracy: 544/587 (92.6746%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.5757, Accuracy: 8159/10000 (81.5900%), Attack Success Rate:0/10000(0.000)
poison local model 54 index 53 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   1,  Average loss: 0.0022, Accuracy: 509/523 (97.3231%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   2,  Average loss: 0.0009, Accuracy: 515/523 (98.4704%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   3,  Average loss: 0.0009, Accuracy: 513/523 (98.0880%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   4,  Average loss: 0.0002, Accuracy: 520/523 (99.4264%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   5,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   6,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   7,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   8,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch   9,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 54, internal_epoch  10,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Global model norm: 16.723655822292564.
Norm before scaling: 16.670011464500032. Distance: 1.4614175426022789
Total norm for 7 adversaries is: 16.670011464500032. distance: 1.4614175426022789
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1008, Accuracy: 8727/8991 (97.0637%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   1,  Average loss: 0.0030, Accuracy: 597/618 (96.6019%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   2,  Average loss: 0.0009, Accuracy: 608/618 (98.3819%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   3,  Average loss: 0.0003, Accuracy: 616/618 (99.6764%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   4,  Average loss: 0.0002, Accuracy: 617/618 (99.8382%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   5,  Average loss: 0.0002, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   6,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   7,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   8,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch   9,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  21, local model 52, internal_epoch  10,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Global model norm: 16.723655822292564.
Norm before scaling: 16.655713156803547. Distance: 1.599529036110198
Total norm for 7 adversaries is: 16.655713156803547. distance: 1.599529036110198
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0876, Accuracy: 8759/8991 (97.4196%)
time spent on training: 134.33003187179565
[foolsgold agg] training data poison_ratio: 0.7090660747823118  data num: [638, 597, 529, 572, 652, 588, 553, 587, 523, 618]
[foolsgold agg] considering poison per batch poison_fraction: 0.7090660747823118
[foolsgold agg] wv: [1.         1.         0.59911615 1.         1.         0.82622678
 1.         0.59911615 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.9132, Accuracy: 8782/10000 (87.8200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.0993, Accuracy: 8778/8991 (97.6310%)
Done in 458.0756869316101 sec.
Server Epoch:22 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   1,  Average loss: 0.0013, Accuracy: 562/578 (97.2318%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   2,  Average loss: 0.0005, Accuracy: 572/578 (98.9619%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   3,  Average loss: 0.0005, Accuracy: 575/578 (99.4810%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   4,  Average loss: 0.0003, Accuracy: 576/578 (99.6540%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   5,  Average loss: 0.0001, Accuracy: 577/578 (99.8270%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   6,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   7,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   8,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch   9,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 24, internal_epoch  10,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 16.743461585328614.
Norm before scaling: 16.699259411500204. Distance: 1.2684671960602998
Total norm for 8 adversaries is: 16.699259411500204. distance: 1.2684671960602998
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0922, Accuracy: 8758/8991 (97.4085%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0021, Accuracy: 751/774 (97.0284%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   2,  Average loss: 0.0009, Accuracy: 765/774 (98.8372%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   3,  Average loss: 0.0005, Accuracy: 767/774 (99.0956%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   4,  Average loss: 0.0002, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   5,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   6,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   7,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   8,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch   9,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 38, internal_epoch  10,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Global model norm: 16.743461585328614.
Norm before scaling: 16.674183078869447. Distance: 1.643924048314455
Total norm for 8 adversaries is: 16.674183078869447. distance: 1.643924048314455
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0842, Accuracy: 8758/8991 (97.4085%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0019, Accuracy: 643/665 (96.6917%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   2,  Average loss: 0.0030, Accuracy: 629/665 (94.5865%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   3,  Average loss: 0.0008, Accuracy: 653/665 (98.1955%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   4,  Average loss: 0.0004, Accuracy: 661/665 (99.3985%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   5,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   6,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.743461585328614.
Norm before scaling: 16.763706349907753. Distance: 2.064624501371869
Total norm for 8 adversaries is: 16.763706349907753. distance: 2.064624501371869
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0970, Accuracy: 8721/8991 (96.9970%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   1,  Average loss: 0.0021, Accuracy: 591/609 (97.0443%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   2,  Average loss: 0.0005, Accuracy: 601/609 (98.6864%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   3,  Average loss: 0.0004, Accuracy: 604/609 (99.1790%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   8,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch   9,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 32, internal_epoch  10,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 16.743461585328614.
Norm before scaling: 16.69425227681765. Distance: 1.4004468068620448
Total norm for 8 adversaries is: 16.69425227681765. distance: 1.4004468068620448
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0800, Accuracy: 8769/8991 (97.5309%)
poison local model 60 index 59 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   1,  Average loss: 0.0024, Accuracy: 624/644 (96.8944%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   2,  Average loss: 0.0015, Accuracy: 625/644 (97.0497%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   3,  Average loss: 0.0007, Accuracy: 632/644 (98.1366%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   4,  Average loss: 0.0004, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   5,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   6,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   7,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   8,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch   9,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 60, internal_epoch  10,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Global model norm: 16.743461585328614.
Norm before scaling: 16.708126735916192. Distance: 1.719268027180721
Total norm for 8 adversaries is: 16.708126735916192. distance: 1.719268027180721
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1052, Accuracy: 8720/8991 (96.9859%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0021, Accuracy: 662/683 (96.9253%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   2,  Average loss: 0.0014, Accuracy: 666/683 (97.5110%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   3,  Average loss: 0.0005, Accuracy: 676/683 (98.9751%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   4,  Average loss: 0.0003, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   5,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   6,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   7,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   8,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch   9,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Global model norm: 16.743461585328614.
Norm before scaling: 16.72046209107459. Distance: 1.7969228323499404
Total norm for 8 adversaries is: 16.72046209107459. distance: 1.7969228323499404
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0906, Accuracy: 8759/8991 (97.4196%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   1,  Average loss: 0.0017, Accuracy: 482/493 (97.7688%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   2,  Average loss: 0.0012, Accuracy: 482/493 (97.7688%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   3,  Average loss: 0.0009, Accuracy: 486/493 (98.5801%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   4,  Average loss: 0.0006, Accuracy: 489/493 (99.1886%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   5,  Average loss: 0.0002, Accuracy: 491/493 (99.5943%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   6,  Average loss: 0.0001, Accuracy: 492/493 (99.7972%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   7,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   8,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch   9,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 35, internal_epoch  10,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.743461585328614.
Norm before scaling: 16.72152795262181. Distance: 1.374827027278229
Total norm for 8 adversaries is: 16.72152795262181. distance: 1.374827027278229
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1100, Accuracy: 8730/8991 (97.0971%)
___Train Local_Simple,  epoch  22, local model 92, internal_epoch   1,  Average loss: 0.0050, Accuracy: 528/571 (92.4694%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1728, Accuracy: 9455/10000 (94.5500%), Attack Success Rate:0/10000(0.000)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   1,  Average loss: 0.0016, Accuracy: 634/650 (97.5385%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   2,  Average loss: 0.0004, Accuracy: 644/650 (99.0769%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   3,  Average loss: 0.0002, Accuracy: 648/650 (99.6923%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  22, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 16.743461585328614.
Norm before scaling: 16.702516578605564. Distance: 1.3337457982491374
Total norm for 8 adversaries is: 16.702516578605564. distance: 1.3337457982491374
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0860, Accuracy: 8767/8991 (97.5086%)
___Train Local_Simple,  epoch  22, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 554/608 (91.1184%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.9532, Accuracy: 8304/10000 (83.0400%), Attack Success Rate:0/10000(0.000)
time spent on training: 151.5658540725708
[foolsgold agg] training data poison_ratio: 0.8121115537848606  data num: [578, 774, 665, 609, 644, 683, 493, 571, 650, 608]
[foolsgold agg] considering poison per batch poison_fraction: 0.8121115537848606
[foolsgold agg] wv: [1.         1.         0.43765491 1.         1.         1.
 0.43765491 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.9484, Accuracy: 8804/10000 (88.0400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.0974, Accuracy: 8792/8991 (97.7867%)
Done in 477.4948728084564 sec.
Server Epoch:23 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
poison local model 56 index 55 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   1,  Average loss: 0.0019, Accuracy: 614/626 (98.0831%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   2,  Average loss: 0.0008, Accuracy: 616/626 (98.4026%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   3,  Average loss: 0.0008, Accuracy: 618/626 (98.7220%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   4,  Average loss: 0.0005, Accuracy: 622/626 (99.3610%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   5,  Average loss: 0.0002, Accuracy: 623/626 (99.5208%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   6,  Average loss: 0.0002, Accuracy: 624/626 (99.6805%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   7,  Average loss: 0.0001, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   8,  Average loss: 0.0001, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch   9,  Average loss: 0.0001, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 56, internal_epoch  10,  Average loss: 0.0001, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Global model norm: 16.7693479018337.
Norm before scaling: 16.69241043594691. Distance: 1.3469324794461717
Total norm for 6 adversaries is: 16.69241043594691. distance: 1.3469324794461717
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0847, Accuracy: 8774/8991 (97.5865%)
___Train Local_Simple,  epoch  23, local model 82, internal_epoch   1,  Average loss: 0.0058, Accuracy: 572/621 (92.1095%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2169, Accuracy: 9302/10000 (93.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 85, internal_epoch   1,  Average loss: 0.0073, Accuracy: 512/570 (89.8246%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1922, Accuracy: 9418/10000 (94.1800%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 631/648 (97.3765%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 643/648 (99.2284%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   3,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.7693479018337.
Norm before scaling: 16.715198403429604. Distance: 1.3802639164318924
Total norm for 6 adversaries is: 16.715198403429604. distance: 1.3802639164318924
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1327, Accuracy: 8690/8991 (96.6522%)
poison local model 76 index 75 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0027, Accuracy: 502/518 (96.9112%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   2,  Average loss: 0.0104, Accuracy: 465/518 (89.7683%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   3,  Average loss: 0.0034, Accuracy: 480/518 (92.6641%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   4,  Average loss: 0.0013, Accuracy: 508/518 (98.0695%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   5,  Average loss: 0.0009, Accuracy: 511/518 (98.6486%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   6,  Average loss: 0.0008, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   7,  Average loss: 0.0006, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   8,  Average loss: 0.0006, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch   9,  Average loss: 0.0004, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 76, internal_epoch  10,  Average loss: 0.0004, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Global model norm: 16.7693479018337.
Norm before scaling: 17.346831616715253. Distance: 4.87715727195873
Total norm for 6 adversaries is: 17.346831616715253. distance: 4.87715727195873
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1241, Accuracy: 8643/8991 (96.1295%)
poison local model 61 index 60 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   1,  Average loss: 0.0014, Accuracy: 524/537 (97.5791%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   2,  Average loss: 0.0006, Accuracy: 531/537 (98.8827%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   3,  Average loss: 0.0002, Accuracy: 536/537 (99.8138%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   4,  Average loss: 0.0002, Accuracy: 536/537 (99.8138%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   5,  Average loss: 0.0001, Accuracy: 537/537 (100.0000%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   6,  Average loss: 0.0001, Accuracy: 537/537 (100.0000%), train_poison_data_count: 537
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   7,  Average loss: 0.0001, Accuracy: 537/537 (100.0000%), train_poison_data_count: 537
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   8,  Average loss: 0.0000, Accuracy: 537/537 (100.0000%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch   9,  Average loss: 0.0000, Accuracy: 537/537 (100.0000%), train_poison_data_count: 537
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 61, internal_epoch  10,  Average loss: 0.0000, Accuracy: 537/537 (100.0000%), train_poison_data_count: 537
Global model norm: 16.7693479018337.
Norm before scaling: 16.726999461539062. Distance: 1.154213013160281
Total norm for 6 adversaries is: 16.726999461539062. distance: 1.154213013160281
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1254, Accuracy: 8720/8991 (96.9859%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   1,  Average loss: 0.0018, Accuracy: 513/526 (97.5285%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   2,  Average loss: 0.0015, Accuracy: 517/526 (98.2890%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   3,  Average loss: 0.0004, Accuracy: 524/526 (99.6198%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   4,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   8,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch   9,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 26, internal_epoch  10,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 16.7693479018337.
Norm before scaling: 16.71061882439249. Distance: 1.2881933808072414
Total norm for 6 adversaries is: 16.71061882439249. distance: 1.2881933808072414
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0975, Accuracy: 8755/8991 (97.3752%)
___Train Local_Simple,  epoch  23, local model 86, internal_epoch   1,  Average loss: 0.0062, Accuracy: 538/587 (91.6525%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.5407, Accuracy: 8233/10000 (82.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 89, internal_epoch   1,  Average loss: 0.0067, Accuracy: 593/664 (89.3072%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.5219, Accuracy: 8553/10000 (85.5300%), Attack Success Rate:0/10000(0.000)
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   1,  Average loss: 0.0022, Accuracy: 536/554 (96.7509%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   2,  Average loss: 0.0014, Accuracy: 540/554 (97.4729%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   3,  Average loss: 0.0003, Accuracy: 552/554 (99.6390%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   4,  Average loss: 0.0002, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   5,  Average loss: 0.0002, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   6,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   7,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   8,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch   9,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  23, local model 75, internal_epoch  10,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 16.7693479018337.
Norm before scaling: 16.734449769324094. Distance: 1.5156317641903665
Total norm for 6 adversaries is: 16.734449769324094. distance: 1.5156317641903665
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0972, Accuracy: 8728/8991 (97.0749%)
time spent on training: 121.35481715202332
[foolsgold agg] training data poison_ratio: 0.5826354469321483  data num: [626, 621, 570, 648, 518, 537, 526, 587, 664, 554]
[foolsgold agg] considering poison per batch poison_fraction: 0.5826354469321483
[foolsgold agg] wv: [1.         0.02151111 0.04456657 1.         1.         1.
 1.         0.02151111 0.02198879 1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 1.1839, Accuracy: 8794/10000 (87.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.0999, Accuracy: 8780/8991 (97.6532%)
Done in 444.6268150806427 sec.
Server Epoch:24 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   1,  Average loss: 0.0030, Accuracy: 504/520 (96.9231%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   2,  Average loss: 0.0012, Accuracy: 507/520 (97.5000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   3,  Average loss: 0.0010, Accuracy: 515/520 (99.0385%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   4,  Average loss: 0.0004, Accuracy: 518/520 (99.6154%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   5,  Average loss: 0.0002, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   6,  Average loss: 0.0002, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   7,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   8,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch   9,  Average loss: 0.0002, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Global model norm: 16.79783609168994.
Norm before scaling: 16.747722413948935. Distance: 1.5981181999482577
Total norm for 7 adversaries is: 16.747722413948935. distance: 1.5981181999482577
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1110, Accuracy: 8700/8991 (96.7634%)
poison local model 65 index 64 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   1,  Average loss: 0.0023, Accuracy: 550/573 (95.9860%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   2,  Average loss: 0.0009, Accuracy: 561/573 (97.9058%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   3,  Average loss: 0.0004, Accuracy: 569/573 (99.3019%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   4,  Average loss: 0.0002, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch   9,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 65, internal_epoch  10,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 16.79783609168994.
Norm before scaling: 16.78114816077106. Distance: 1.6242559636978127
Total norm for 7 adversaries is: 16.78114816077106. distance: 1.6242559636978127
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1071, Accuracy: 8728/8991 (97.0749%)
___Train Local_Simple,  epoch  24, local model 96, internal_epoch   1,  Average loss: 0.0055, Accuracy: 556/608 (91.4474%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.7701, Accuracy: 8200/10000 (82.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 83, internal_epoch   1,  Average loss: 0.0062, Accuracy: 507/555 (91.3514%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2367, Accuracy: 9223/10000 (92.2300%), Attack Success Rate:0/10000(0.000)
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   1,  Average loss: 0.0020, Accuracy: 596/616 (96.7532%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   2,  Average loss: 0.0007, Accuracy: 609/616 (98.8636%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   3,  Average loss: 0.0003, Accuracy: 613/616 (99.5130%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   4,  Average loss: 0.0002, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   5,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   6,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   7,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   8,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch   9,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 63, internal_epoch  10,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Global model norm: 16.79783609168994.
Norm before scaling: 16.7656477530717. Distance: 1.5167659122706914
Total norm for 7 adversaries is: 16.7656477530717. distance: 1.5167659122706914
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0885, Accuracy: 8767/8991 (97.5086%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   1,  Average loss: 0.0026, Accuracy: 641/668 (95.9581%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   2,  Average loss: 0.0011, Accuracy: 650/668 (97.3054%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   3,  Average loss: 0.0003, Accuracy: 663/668 (99.2515%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   4,  Average loss: 0.0002, Accuracy: 666/668 (99.7006%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   5,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.79783609168994.
Norm before scaling: 16.766668879140376. Distance: 1.7768856590077422
Total norm for 7 adversaries is: 16.766668879140376. distance: 1.7768856590077422
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0978, Accuracy: 8748/8991 (97.2973%)
___Train Local_Simple,  epoch  24, local model 94, internal_epoch   1,  Average loss: 0.0069, Accuracy: 496/555 (89.3694%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3077, Accuracy: 8940/10000 (89.4000%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0017, Accuracy: 560/582 (96.2199%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   2,  Average loss: 0.0014, Accuracy: 569/582 (97.7663%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   3,  Average loss: 0.0005, Accuracy: 578/582 (99.3127%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   4,  Average loss: 0.0003, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 25, internal_epoch  10,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 16.79783609168994.
Norm before scaling: 16.758064719838533. Distance: 1.4759063069966436
Total norm for 7 adversaries is: 16.758064719838533. distance: 1.4759063069966436
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1037, Accuracy: 8737/8991 (97.1750%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   1,  Average loss: 0.0029, Accuracy: 599/618 (96.9256%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   2,  Average loss: 0.0015, Accuracy: 600/618 (97.0874%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   3,  Average loss: 0.0009, Accuracy: 607/618 (98.2201%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   4,  Average loss: 0.0004, Accuracy: 615/618 (99.5146%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   5,  Average loss: 0.0002, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   6,  Average loss: 0.0002, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   7,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   8,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch   9,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 52, internal_epoch  10,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Global model norm: 16.79783609168994.
Norm before scaling: 16.728530105254972. Distance: 1.6975303241566186
Total norm for 7 adversaries is: 16.728530105254972. distance: 1.6975303241566186
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0925, Accuracy: 8752/8991 (97.3418%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   1,  Average loss: 0.0023, Accuracy: 462/474 (97.4684%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   2,  Average loss: 0.0011, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   3,  Average loss: 0.0004, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   4,  Average loss: 0.0003, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   5,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  24, local model 50, internal_epoch  10,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 16.79783609168994.
Norm before scaling: 16.736577819535718. Distance: 1.2872585736921014
Total norm for 7 adversaries is: 16.736577819535718. distance: 1.2872585736921014
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0981, Accuracy: 8739/8991 (97.1972%)
time spent on training: 135.03975081443787
[foolsgold agg] training data poison_ratio: 0.7022014213901889  data num: [520, 573, 608, 555, 616, 668, 555, 582, 618, 474]
[foolsgold agg] considering poison per batch poison_fraction: 0.7022014213901889
[foolsgold agg] wv: [1. 1. 0. 0. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 1.1512, Accuracy: 8798/10000 (87.9800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.0942, Accuracy: 8791/8991 (97.7756%)
Done in 462.7723128795624 sec.
Server Epoch:25 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   1,  Average loss: 0.0027, Accuracy: 728/750 (97.0667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   2,  Average loss: 0.0015, Accuracy: 730/750 (97.3333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   3,  Average loss: 0.0006, Accuracy: 742/750 (98.9333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   4,  Average loss: 0.0004, Accuracy: 748/750 (99.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   5,  Average loss: 0.0003, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   6,  Average loss: 0.0002, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   7,  Average loss: 0.0002, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   8,  Average loss: 0.0002, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 16.822445108361272.
Norm before scaling: 16.74543084980805. Distance: 1.8671285707759226
Total norm for 10 adversaries is: 16.74543084980805. distance: 1.8671285707759226
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0843, Accuracy: 8759/8991 (97.4196%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0022, Accuracy: 686/708 (96.8927%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   2,  Average loss: 0.0009, Accuracy: 695/708 (98.1638%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   3,  Average loss: 0.0004, Accuracy: 705/708 (99.5763%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   4,  Average loss: 0.0001, Accuracy: 707/708 (99.8588%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   5,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   6,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   8,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 6, internal_epoch  10,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 16.822445108361272.
Norm before scaling: 16.779542292648546. Distance: 1.7052700987737188
Total norm for 10 adversaries is: 16.779542292648546. distance: 1.7052700987737188
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0761, Accuracy: 8786/8991 (97.7199%)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   1,  Average loss: 0.0016, Accuracy: 480/493 (97.3631%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   2,  Average loss: 0.0009, Accuracy: 484/493 (98.1744%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   3,  Average loss: 0.0003, Accuracy: 491/493 (99.5943%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   4,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   5,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   6,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.822445108361272.
Norm before scaling: 16.784839438044603. Distance: 1.2898379218872673
Total norm for 10 adversaries is: 16.784839438044603. distance: 1.2898379218872673
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1077, Accuracy: 8724/8991 (97.0304%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 632/648 (97.5309%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 638/648 (98.4568%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   3,  Average loss: 0.0003, Accuracy: 645/648 (99.5370%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   4,  Average loss: 0.0002, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   7,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   8,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch   9,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 17, internal_epoch  10,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.822445108361272.
Norm before scaling: 16.777996294789457. Distance: 1.470972044170189
Total norm for 10 adversaries is: 16.777996294789457. distance: 1.470972044170189
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1211, Accuracy: 8704/8991 (96.8079%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0026, Accuracy: 535/553 (96.7450%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0016, Accuracy: 539/553 (97.4684%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   3,  Average loss: 0.0005, Accuracy: 548/553 (99.0958%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   4,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   5,  Average loss: 0.0003, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   6,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   7,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   8,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   9,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch  10,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Global model norm: 16.822445108361272.
Norm before scaling: 16.753994138117577. Distance: 1.4682896481069105
Total norm for 10 adversaries is: 16.753994138117577. distance: 1.4682896481069105
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0761, Accuracy: 8792/8991 (97.7867%)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   1,  Average loss: 0.0022, Accuracy: 606/626 (96.8051%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   2,  Average loss: 0.0014, Accuracy: 608/626 (97.1246%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   3,  Average loss: 0.0010, Accuracy: 612/626 (97.7636%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   4,  Average loss: 0.0004, Accuracy: 621/626 (99.2013%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   5,  Average loss: 0.0002, Accuracy: 624/626 (99.6805%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   6,  Average loss: 0.0002, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Global model norm: 16.822445108361272.
Norm before scaling: 16.764130510627258. Distance: 1.6210309487553005
Total norm for 10 adversaries is: 16.764130510627258. distance: 1.6210309487553005
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1189, Accuracy: 8711/8991 (96.8858%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   1,  Average loss: 0.0022, Accuracy: 498/518 (96.1390%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   2,  Average loss: 0.0009, Accuracy: 508/518 (98.0695%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   3,  Average loss: 0.0003, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   4,  Average loss: 0.0002, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   5,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   6,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   7,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   8,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch   9,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 43, internal_epoch  10,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 16.822445108361272.
Norm before scaling: 16.79576213609915. Distance: 1.5134236187547383
Total norm for 10 adversaries is: 16.79576213609915. distance: 1.5134236187547383
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0907, Accuracy: 8739/8991 (97.1972%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0025, Accuracy: 654/683 (95.7540%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   2,  Average loss: 0.0011, Accuracy: 667/683 (97.6574%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   3,  Average loss: 0.0009, Accuracy: 671/683 (98.2430%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   4,  Average loss: 0.0004, Accuracy: 680/683 (99.5608%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   5,  Average loss: 0.0003, Accuracy: 679/683 (99.4143%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   6,  Average loss: 0.0002, Accuracy: 681/683 (99.7072%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   7,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   8,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch   9,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Global model norm: 16.822445108361272.
Norm before scaling: 16.802077682629758. Distance: 1.8465595498790148
Total norm for 10 adversaries is: 16.802077682629758. distance: 1.8465595498790148
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0819, Accuracy: 8776/8991 (97.6087%)
poison local model 74 index 73 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   1,  Average loss: 0.0012, Accuracy: 611/626 (97.6038%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 623/626 (99.5208%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   3,  Average loss: 0.0001, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Global model norm: 16.822445108361272.
Norm before scaling: 16.77487567338196. Distance: 1.187114251375617
Total norm for 10 adversaries is: 16.77487567338196. distance: 1.187114251375617
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1033, Accuracy: 8746/8991 (97.2751%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0016, Accuracy: 489/505 (96.8317%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   2,  Average loss: 0.0005, Accuracy: 500/505 (99.0099%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   3,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   4,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   5,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   6,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   7,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   8,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   9,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch  10,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Global model norm: 16.822445108361272.
Norm before scaling: 16.796603377164253. Distance: 1.249707950807224
Total norm for 10 adversaries is: 16.796603377164253. distance: 1.249707950807224
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1155, Accuracy: 8690/8991 (96.6522%)
time spent on training: 173.9392602443695
[foolsgold agg] training data poison_ratio: 1.0  data num: [750, 708, 493, 648, 553, 626, 518, 683, 626, 505]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [0.8836501 1.        0.8836501 1.        1.        1.        1.
 1.        1.        1.       ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 1.3609, Accuracy: 8796/10000 (87.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.0964, Accuracy: 8788/8991 (97.7422%)
Done in 497.3000650405884 sec.
Server Epoch:26 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   1,  Average loss: 0.0018, Accuracy: 486/503 (96.6203%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   2,  Average loss: 0.0008, Accuracy: 496/503 (98.6083%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   3,  Average loss: 0.0003, Accuracy: 500/503 (99.4036%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   4,  Average loss: 0.0002, Accuracy: 502/503 (99.8012%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   7,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   8,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 16.858256305563234.
Norm before scaling: 16.827991708211666. Distance: 1.395035468235117
Total norm for 8 adversaries is: 16.827991708211666. distance: 1.395035468235117
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0925, Accuracy: 8763/8991 (97.4641%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0020, Accuracy: 521/535 (97.3832%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   2,  Average loss: 0.0014, Accuracy: 521/535 (97.3832%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   3,  Average loss: 0.0006, Accuracy: 528/535 (98.6916%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   7,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   8,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch   9,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 14, internal_epoch  10,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 16.858256305563234.
Norm before scaling: 16.812493646897035. Distance: 1.5502818189805745
Total norm for 8 adversaries is: 16.812493646897035. distance: 1.5502818189805745
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1014, Accuracy: 8726/8991 (97.0526%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   1,  Average loss: 0.0019, Accuracy: 597/609 (98.0296%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   2,  Average loss: 0.0014, Accuracy: 590/609 (96.8801%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   3,  Average loss: 0.0004, Accuracy: 603/609 (99.0148%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   4,  Average loss: 0.0002, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   7,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   8,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch   9,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 32, internal_epoch  10,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 16.858256305563234.
Norm before scaling: 16.80284232663945. Distance: 1.4866136234098009
Total norm for 8 adversaries is: 16.80284232663945. distance: 1.4866136234098009
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0906, Accuracy: 8745/8991 (97.2639%)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 577/587 (98.2964%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   2,  Average loss: 0.0013, Accuracy: 569/587 (96.9336%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   3,  Average loss: 0.0010, Accuracy: 572/587 (97.4446%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   4,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   5,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   6,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   7,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 16.858256305563234.
Norm before scaling: 16.9075794085102. Distance: 2.091579735863156
Total norm for 8 adversaries is: 16.9075794085102. distance: 2.091579735863156
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1149, Accuracy: 8725/8991 (97.0415%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   1,  Average loss: 0.0027, Accuracy: 639/668 (95.6587%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   2,  Average loss: 0.0010, Accuracy: 653/668 (97.7545%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   3,  Average loss: 0.0009, Accuracy: 659/668 (98.6527%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   4,  Average loss: 0.0005, Accuracy: 663/668 (99.2515%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   5,  Average loss: 0.0003, Accuracy: 664/668 (99.4012%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   6,  Average loss: 0.0002, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   7,  Average loss: 0.0002, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.858256305563234.
Norm before scaling: 16.81210338025434. Distance: 1.8096206419235445
Total norm for 8 adversaries is: 16.81210338025434. distance: 1.8096206419235445
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0884, Accuracy: 8760/8991 (97.4308%)
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0017, Accuracy: 603/616 (97.8896%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   2,  Average loss: 0.0006, Accuracy: 608/616 (98.7013%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   3,  Average loss: 0.0003, Accuracy: 613/616 (99.5130%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   4,  Average loss: 0.0002, Accuracy: 614/616 (99.6753%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   5,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   6,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   7,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   8,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   9,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch  10,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Global model norm: 16.858256305563234.
Norm before scaling: 16.80363054556124. Distance: 1.265730253010943
Total norm for 8 adversaries is: 16.80363054556124. distance: 1.265730253010943
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0830, Accuracy: 8792/8991 (97.7867%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   1,  Average loss: 0.0033, Accuracy: 565/588 (96.0884%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   2,  Average loss: 0.0020, Accuracy: 565/588 (96.0884%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   3,  Average loss: 0.0008, Accuracy: 578/588 (98.2993%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   4,  Average loss: 0.0005, Accuracy: 586/588 (99.6599%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   5,  Average loss: 0.0003, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   6,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   7,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   8,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch   9,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 23, internal_epoch  10,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.858256305563234.
Norm before scaling: 16.817923766459792. Distance: 1.864707928407063
Total norm for 8 adversaries is: 16.817923766459792. distance: 1.864707928407063
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0910, Accuracy: 8759/8991 (97.4196%)
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0012, Accuracy: 495/505 (98.0198%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   2,  Average loss: 0.0005, Accuracy: 500/505 (99.0099%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   3,  Average loss: 0.0002, Accuracy: 502/505 (99.4059%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   4,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   5,  Average loss: 0.0001, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   6,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   7,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   8,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   9,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch  10,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Global model norm: 16.858256305563234.
Norm before scaling: 16.82524403002589. Distance: 1.1654947162051819
Total norm for 8 adversaries is: 16.82524403002589. distance: 1.1654947162051819
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1352, Accuracy: 8709/8991 (96.8635%)
___Train Local_Simple,  epoch  26, local model 94, internal_epoch   1,  Average loss: 0.0075, Accuracy: 504/555 (90.8108%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2478, Accuracy: 9198/10000 (91.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 84, internal_epoch   1,  Average loss: 0.0085, Accuracy: 494/560 (88.2143%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2868, Accuracy: 8980/10000 (89.8000%), Attack Success Rate:0/10000(0.000)
time spent on training: 145.86866688728333
[foolsgold agg] training data poison_ratio: 0.8052741879147747  data num: [503, 535, 609, 587, 668, 616, 588, 505, 555, 560]
[foolsgold agg] considering poison per batch poison_fraction: 0.8052741879147747
[foolsgold agg] wv: [1.         0.94208767 1.         0.94208767 1.         1.
 1.         1.         0.         0.        ]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 1.4037, Accuracy: 8810/10000 (88.1000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.0984, Accuracy: 8801/8991 (97.8868%)
Done in 471.38576006889343 sec.
Server Epoch:27 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
poison local model 69 index 68 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   1,  Average loss: 0.0018, Accuracy: 627/646 (97.0588%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   2,  Average loss: 0.0010, Accuracy: 631/646 (97.6780%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   3,  Average loss: 0.0006, Accuracy: 638/646 (98.7616%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   4,  Average loss: 0.0003, Accuracy: 642/646 (99.3808%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   5,  Average loss: 0.0002, Accuracy: 644/646 (99.6904%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   6,  Average loss: 0.0002, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   7,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   8,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch   9,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 69, internal_epoch  10,  Average loss: 0.0001, Accuracy: 646/646 (100.0000%), train_poison_data_count: 646
Global model norm: 16.881693550957426.
Norm before scaling: 16.81044600748901. Distance: 1.4914820736233947
Total norm for 9 adversaries is: 16.81044600748901. distance: 1.4914820736233947
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1115, Accuracy: 8718/8991 (96.9636%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 568/580 (97.9310%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   2,  Average loss: 0.0005, Accuracy: 575/580 (99.1379%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   3,  Average loss: 0.0002, Accuracy: 577/580 (99.4828%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   4,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   5,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   6,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   7,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   8,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   9,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch  10,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Global model norm: 16.881693550957426.
Norm before scaling: 16.817843924462437. Distance: 1.277852041855284
Total norm for 9 adversaries is: 16.817843924462437. distance: 1.277852041855284
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1083, Accuracy: 8745/8991 (97.2639%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   1,  Average loss: 0.0020, Accuracy: 646/665 (97.1429%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   2,  Average loss: 0.0009, Accuracy: 653/665 (98.1955%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.881693550957426.
Norm before scaling: 16.83606257204123. Distance: 1.671737665257815
Total norm for 9 adversaries is: 16.83606257204123. distance: 1.671737665257815
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0914, Accuracy: 8756/8991 (97.3863%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   1,  Average loss: 0.0019, Accuracy: 561/582 (96.3918%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   2,  Average loss: 0.0005, Accuracy: 575/582 (98.7973%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   3,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   4,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   6,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   7,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   8,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch   9,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 25, internal_epoch  10,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 16.881693550957426.
Norm before scaling: 16.8286064737877. Distance: 1.3447970369774958
Total norm for 9 adversaries is: 16.8286064737877. distance: 1.3447970369774958
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0945, Accuracy: 8756/8991 (97.3863%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 636/648 (98.1481%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 640/648 (98.7654%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   3,  Average loss: 0.0001, Accuracy: 647/648 (99.8457%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.881693550957426.
Norm before scaling: 16.815366819647345. Distance: 1.3227468767116648
Total norm for 9 adversaries is: 16.815366819647345. distance: 1.3227468767116648
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1087, Accuracy: 8742/8991 (97.2306%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0018, Accuracy: 626/641 (97.6599%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   2,  Average loss: 0.0005, Accuracy: 634/641 (98.9080%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   3,  Average loss: 0.0003, Accuracy: 635/641 (99.0640%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   4,  Average loss: 0.0001, Accuracy: 640/641 (99.8440%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   5,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   6,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch   9,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 16.881693550957426.
Norm before scaling: 16.815349578445062. Distance: 1.4336881268694188
Total norm for 9 adversaries is: 16.815349578445062. distance: 1.4336881268694188
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1160, Accuracy: 8718/8991 (96.9636%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   1,  Average loss: 0.0019, Accuracy: 728/750 (97.0667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 741/750 (98.8000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   3,  Average loss: 0.0002, Accuracy: 748/750 (99.7333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   4,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   5,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   6,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 16.881693550957426.
Norm before scaling: 16.823868208705935. Distance: 1.6151973992281905
Total norm for 9 adversaries is: 16.823868208705935. distance: 1.6151973992281905
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0843, Accuracy: 8769/8991 (97.5309%)
poison local model 54 index 53 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   1,  Average loss: 0.0023, Accuracy: 514/523 (98.2792%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   2,  Average loss: 0.0006, Accuracy: 517/523 (98.8528%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   3,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   4,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   5,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   6,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   7,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   8,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch   9,  Average loss: 0.0000, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 54, internal_epoch  10,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Global model norm: 16.881693550957426.
Norm before scaling: 16.796335383774007. Distance: 1.2250006383777434
Total norm for 9 adversaries is: 16.796335383774007. distance: 1.2250006383777434
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0818, Accuracy: 8781/8991 (97.6643%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   1,  Average loss: 0.0025, Accuracy: 649/668 (97.1557%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   2,  Average loss: 0.0019, Accuracy: 640/668 (95.8084%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   3,  Average loss: 0.0012, Accuracy: 650/668 (97.3054%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   4,  Average loss: 0.0004, Accuracy: 662/668 (99.1018%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   5,  Average loss: 0.0002, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   6,  Average loss: 0.0002, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  27, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.881693550957426.
Norm before scaling: 16.872444467954807. Distance: 1.9788602357522882
Total norm for 9 adversaries is: 16.872444467954807. distance: 1.9788602357522882
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0912, Accuracy: 8739/8991 (97.1972%)
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0085, Accuracy: 545/609 (89.4910%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2089, Accuracy: 9349/10000 (93.4900%), Attack Success Rate:0/10000(0.000)
time spent on training: 164.24917101860046
[foolsgold agg] training data poison_ratio: 0.9035171102661597  data num: [646, 580, 665, 582, 648, 641, 750, 523, 668, 609]
[foolsgold agg] considering poison per batch poison_fraction: 0.9035171102661597
[foolsgold agg] wv: [1.         1.         0.32891363 1.         1.         1.
 0.32891363 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 1.2400, Accuracy: 8817/10000 (88.1700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.0965, Accuracy: 8810/8991 (97.9869%)
Done in 489.227334022522 sec.
Server Epoch:28 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   1,  Average loss: 0.0014, Accuracy: 620/638 (97.1787%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   2,  Average loss: 0.0007, Accuracy: 632/638 (99.0596%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   3,  Average loss: 0.0001, Accuracy: 637/638 (99.8433%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   6,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 16.89495980309059.
Norm before scaling: 16.839209006391528. Distance: 1.3702697016471157
Total norm for 8 adversaries is: 16.839209006391528. distance: 1.3702697016471157
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0798, Accuracy: 8785/8991 (97.7088%)
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   1,  Average loss: 0.0021, Accuracy: 623/647 (96.2906%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   2,  Average loss: 0.0009, Accuracy: 630/647 (97.3725%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   3,  Average loss: 0.0008, Accuracy: 639/647 (98.7635%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   4,  Average loss: 0.0003, Accuracy: 643/647 (99.3818%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   8,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch   9,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 51, internal_epoch  10,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Global model norm: 16.89495980309059.
Norm before scaling: 16.846149563830696. Distance: 1.6062168874927034
Total norm for 8 adversaries is: 16.846149563830696. distance: 1.6062168874927034
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0786, Accuracy: 8793/8991 (97.7978%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 634/648 (97.8395%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 640/648 (98.7654%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   3,  Average loss: 0.0002, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 16.89495980309059.
Norm before scaling: 16.82863186185368. Distance: 1.209020857499327
Total norm for 8 adversaries is: 16.82863186185368. distance: 1.209020857499327
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1129, Accuracy: 8732/8991 (97.1193%)
poison local model 63 index 62 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   1,  Average loss: 0.0012, Accuracy: 603/616 (97.8896%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   2,  Average loss: 0.0008, Accuracy: 607/616 (98.5390%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   3,  Average loss: 0.0005, Accuracy: 609/616 (98.8636%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   4,  Average loss: 0.0002, Accuracy: 613/616 (99.5130%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   5,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   6,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   7,  Average loss: 0.0001, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   8,  Average loss: 0.0000, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch   9,  Average loss: 0.0000, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 63, internal_epoch  10,  Average loss: 0.0000, Accuracy: 616/616 (100.0000%), train_poison_data_count: 616
Global model norm: 16.89495980309059.
Norm before scaling: 16.851835953390953. Distance: 1.1604777189365039
Total norm for 8 adversaries is: 16.851835953390953. distance: 1.1604777189365039
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0866, Accuracy: 8788/8991 (97.7422%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0017, Accuracy: 687/708 (97.0339%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   2,  Average loss: 0.0008, Accuracy: 697/708 (98.4463%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   3,  Average loss: 0.0011, Accuracy: 689/708 (97.3164%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   4,  Average loss: 0.0003, Accuracy: 704/708 (99.4350%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   5,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   6,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   7,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   8,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch   9,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 6, internal_epoch  10,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 16.89495980309059.
Norm before scaling: 16.846919453370678. Distance: 1.4964614296839114
Total norm for 8 adversaries is: 16.846919453370678. distance: 1.4964614296839114
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0776, Accuracy: 8791/8991 (97.7756%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   1,  Average loss: 0.0012, Accuracy: 566/578 (97.9239%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 575/578 (99.4810%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   3,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   4,  Average loss: 0.0001, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   5,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   6,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   7,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   8,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch   9,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 24, internal_epoch  10,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 16.89495980309059.
Norm before scaling: 16.844906797301242. Distance: 1.1897568087959123
Total norm for 8 adversaries is: 16.844906797301242. distance: 1.1897568087959123
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0872, Accuracy: 8775/8991 (97.5976%)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 566/621 (91.1433%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2413, Accuracy: 9220/10000 (92.2000%), Attack Success Rate:0/10000(0.000)
poison local model 35 index 34 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   1,  Average loss: 0.0015, Accuracy: 482/493 (97.7688%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   2,  Average loss: 0.0005, Accuracy: 488/493 (98.9858%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   3,  Average loss: 0.0007, Accuracy: 488/493 (98.9858%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   4,  Average loss: 0.0003, Accuracy: 490/493 (99.3915%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   5,  Average loss: 0.0001, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   6,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   7,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   8,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch   9,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 35, internal_epoch  10,  Average loss: 0.0000, Accuracy: 493/493 (100.0000%), train_poison_data_count: 493
Global model norm: 16.89495980309059.
Norm before scaling: 16.869502323500186. Distance: 1.303760221885629
Total norm for 8 adversaries is: 16.869502323500186. distance: 1.303760221885629
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1191, Accuracy: 8721/8991 (96.9970%)
poison local model 80 index 79 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 586/593 (98.8196%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   2,  Average loss: 0.0008, Accuracy: 583/593 (98.3137%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   3,  Average loss: 0.0004, Accuracy: 589/593 (99.3255%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   4,  Average loss: 0.0001, Accuracy: 592/593 (99.8314%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   5,  Average loss: 0.0000, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   6,  Average loss: 0.0000, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   7,  Average loss: 0.0000, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   8,  Average loss: 0.0000, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch   9,  Average loss: 0.0000, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  28, local model 80, internal_epoch  10,  Average loss: 0.0000, Accuracy: 593/593 (100.0000%), train_poison_data_count: 593
Global model norm: 16.89495980309059.
Norm before scaling: 16.849956098097483. Distance: 1.158231326398332
Total norm for 8 adversaries is: 16.849956098097483. distance: 1.158231326398332
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.1042, Accuracy: 8773/8991 (97.5754%)
___Train Local_Simple,  epoch  28, local model 81, internal_epoch   1,  Average loss: 0.0038, Accuracy: 550/586 (93.8567%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3000, Accuracy: 8992/10000 (89.9200%), Attack Success Rate:0/10000(0.000)
time spent on training: 149.7415270805359
[foolsgold agg] training data poison_ratio: 0.8030352480417755  data num: [638, 647, 648, 616, 708, 578, 621, 493, 593, 586]
[foolsgold agg] considering poison per batch poison_fraction: 0.8030352480417755
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 1.1940, Accuracy: 8823/10000 (88.2300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.0871, Accuracy: 8813/8991 (98.0202%)
Done in 471.55101799964905 sec.
Server Epoch:29 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
poison local model 58 index 57 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   1,  Average loss: 0.0025, Accuracy: 494/510 (96.8627%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   2,  Average loss: 0.0012, Accuracy: 500/510 (98.0392%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   3,  Average loss: 0.0006, Accuracy: 503/510 (98.6275%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   4,  Average loss: 0.0003, Accuracy: 508/510 (99.6078%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   5,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   6,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   7,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   8,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch   9,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 58, internal_epoch  10,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Global model norm: 16.90919748162686.
Norm before scaling: 16.84130479265608. Distance: 1.323312725143691
Total norm for 8 adversaries is: 16.84130479265608. distance: 1.323312725143691
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0771, Accuracy: 8778/8991 (97.6310%)
___Train Local_Simple,  epoch  29, local model 90, internal_epoch   1,  Average loss: 0.0062, Accuracy: 517/577 (89.6014%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.8003, Accuracy: 7655/10000 (76.5500%), Attack Success Rate:0/10000(0.000)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   1,  Average loss: 0.0017, Accuracy: 651/668 (97.4551%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   2,  Average loss: 0.0007, Accuracy: 659/668 (98.6527%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   3,  Average loss: 0.0005, Accuracy: 663/668 (99.2515%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   4,  Average loss: 0.0003, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.90919748162686.
Norm before scaling: 16.852132944100134. Distance: 1.3959628752004791
Total norm for 8 adversaries is: 16.852132944100134. distance: 1.3959628752004791
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0895, Accuracy: 8782/8991 (97.6755%)
poison local model 72 index 71 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   1,  Average loss: 0.0012, Accuracy: 521/529 (98.4877%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   2,  Average loss: 0.0007, Accuracy: 522/529 (98.6767%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   3,  Average loss: 0.0002, Accuracy: 527/529 (99.6219%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   4,  Average loss: 0.0002, Accuracy: 528/529 (99.8110%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   5,  Average loss: 0.0001, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   6,  Average loss: 0.0001, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   7,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   8,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch   9,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 72, internal_epoch  10,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Global model norm: 16.90919748162686.
Norm before scaling: 16.848954509595135. Distance: 1.1694124924701146
Total norm for 8 adversaries is: 16.848954509595135. distance: 1.1694124924701146
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1037, Accuracy: 8738/8991 (97.1861%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   1,  Average loss: 0.0025, Accuracy: 632/652 (96.9325%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   2,  Average loss: 0.0012, Accuracy: 638/652 (97.8528%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   3,  Average loss: 0.0011, Accuracy: 633/652 (97.0859%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   4,  Average loss: 0.0002, Accuracy: 650/652 (99.6933%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   5,  Average loss: 0.0002, Accuracy: 650/652 (99.6933%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   6,  Average loss: 0.0002, Accuracy: 651/652 (99.8466%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 16.90919748162686.
Norm before scaling: 16.918655554201663. Distance: 2.351269066838249
Total norm for 8 adversaries is: 16.918655554201663. distance: 2.351269066838249
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1188, Accuracy: 8675/8991 (96.4854%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0013, Accuracy: 568/582 (97.5945%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   2,  Average loss: 0.0007, Accuracy: 573/582 (98.4536%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   3,  Average loss: 0.0008, Accuracy: 570/582 (97.9381%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   4,  Average loss: 0.0002, Accuracy: 579/582 (99.4845%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   6,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   7,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   8,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch   9,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 25, internal_epoch  10,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 16.90919748162686.
Norm before scaling: 16.86317131001341. Distance: 1.2379948137325678
Total norm for 8 adversaries is: 16.86317131001341. distance: 1.2379948137325678
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0955, Accuracy: 8753/8991 (97.3529%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0040, Accuracy: 556/581 (95.6971%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   2,  Average loss: 0.0058, Accuracy: 534/581 (91.9105%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   3,  Average loss: 0.0034, Accuracy: 556/581 (95.6971%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   4,  Average loss: 0.0011, Accuracy: 568/581 (97.7625%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   5,  Average loss: 0.0011, Accuracy: 575/581 (98.9673%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   6,  Average loss: 0.0007, Accuracy: 577/581 (99.3115%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   7,  Average loss: 0.0006, Accuracy: 577/581 (99.3115%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   8,  Average loss: 0.0005, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   9,  Average loss: 0.0004, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch  10,  Average loss: 0.0004, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Global model norm: 16.90919748162686.
Norm before scaling: 17.29753396864664. Distance: 4.329632548186894
Total norm for 8 adversaries is: 17.29753396864664. distance: 4.329632548186894
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1032, Accuracy: 8689/8991 (96.6411%)
___Train Local_Simple,  epoch  29, local model 91, internal_epoch   1,  Average loss: 0.0067, Accuracy: 572/627 (91.2281%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2148, Accuracy: 9353/10000 (93.5300%), Attack Success Rate:0/10000(0.000)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0022, Accuracy: 460/474 (97.0464%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0008, Accuracy: 467/474 (98.5232%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   3,  Average loss: 0.0005, Accuracy: 470/474 (99.1561%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   4,  Average loss: 0.0003, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 16.90919748162686.
Norm before scaling: 16.84835135434251. Distance: 1.2234445778750405
Total norm for 8 adversaries is: 16.84835135434251. distance: 1.2234445778750405
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1010, Accuracy: 8741/8991 (97.2194%)
poison local model 57 index 56 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   1,  Average loss: 0.0014, Accuracy: 558/568 (98.2394%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   2,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   3,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   4,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   5,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  29, local model 57, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Global model norm: 16.90919748162686.
Norm before scaling: 16.855366001280107. Distance: 1.1430120703726527
Total norm for 8 adversaries is: 16.855366001280107. distance: 1.1430120703726527
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0993, Accuracy: 8745/8991 (97.2639%)
time spent on training: 150.4491410255432
[foolsgold agg] training data poison_ratio: 0.7912621359223301  data num: [510, 577, 668, 529, 652, 582, 581, 627, 474, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.7912621359223301
[foolsgold agg] wv: [0.62484857 0.98393737 1.         1.         0.62484857 1.
 1.         0.98393737 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.9184, Accuracy: 8817/10000 (88.1700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.0829, Accuracy: 8813/8991 (98.0202%)
Done in 473.2652909755707 sec.
Server Epoch:30 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   1,  Average loss: 0.0021, Accuracy: 464/474 (97.8903%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   2,  Average loss: 0.0007, Accuracy: 467/474 (98.5232%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   3,  Average loss: 0.0004, Accuracy: 471/474 (99.3671%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   4,  Average loss: 0.0002, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   6,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   7,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   8,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch   9,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 16.927566599671913.
Norm before scaling: 16.873671641872566. Distance: 1.3170251947685323
Total norm for 10 adversaries is: 16.873671641872566. distance: 1.3170251947685323
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1034, Accuracy: 8737/8991 (97.1750%)
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   1,  Average loss: 0.0011, Accuracy: 510/519 (98.2659%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   2,  Average loss: 0.0041, Accuracy: 496/519 (95.5684%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   3,  Average loss: 0.0008, Accuracy: 509/519 (98.0732%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 514/519 (99.0366%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   5,  Average loss: 0.0002, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   7,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   8,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch   9,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 77, internal_epoch  10,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Global model norm: 16.927566599671913.
Norm before scaling: 16.990914104584693. Distance: 2.0649129451108177
Total norm for 10 adversaries is: 16.990914104584693. distance: 2.0649129451108177
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0993, Accuracy: 8761/8991 (97.4419%)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   1,  Average loss: 0.0021, Accuracy: 609/626 (97.2843%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   2,  Average loss: 0.0007, Accuracy: 613/626 (97.9233%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   3,  Average loss: 0.0003, Accuracy: 623/626 (99.5208%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Global model norm: 16.927566599671913.
Norm before scaling: 16.85207046783078. Distance: 1.3366843918665983
Total norm for 10 adversaries is: 16.85207046783078. distance: 1.3366843918665983
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0985, Accuracy: 8740/8991 (97.2083%)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   1,  Average loss: 0.0027, Accuracy: 600/625 (96.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   2,  Average loss: 0.0007, Accuracy: 615/625 (98.4000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   3,  Average loss: 0.0004, Accuracy: 620/625 (99.2000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   4,  Average loss: 0.0003, Accuracy: 622/625 (99.5200%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   5,  Average loss: 0.0002, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   6,  Average loss: 0.0002, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   7,  Average loss: 0.0002, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch   9,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Global model norm: 16.927566599671913.
Norm before scaling: 16.824666325744957. Distance: 1.4950379313884592
Total norm for 10 adversaries is: 16.824666325744957. distance: 1.4950379313884592
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0807, Accuracy: 8784/8991 (97.6977%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0018, Accuracy: 560/572 (97.9021%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   2,  Average loss: 0.0009, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   3,  Average loss: 0.0002, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   7,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.927566599671913.
Norm before scaling: 16.854170992190163. Distance: 1.2243842445791755
Total norm for 10 adversaries is: 16.854170992190163. distance: 1.2243842445791755
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0971, Accuracy: 8752/8991 (97.3418%)
poison local model 8 index 7 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0023, Accuracy: 662/683 (96.9253%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   2,  Average loss: 0.0009, Accuracy: 671/683 (98.2430%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   3,  Average loss: 0.0004, Accuracy: 678/683 (99.2679%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   4,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   5,  Average loss: 0.0002, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   6,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   7,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   8,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch   9,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 8, internal_epoch  10,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%), train_poison_data_count: 683
Global model norm: 16.927566599671913.
Norm before scaling: 16.853721936570402. Distance: 1.4905527957087075
Total norm for 10 adversaries is: 16.853721936570402. distance: 1.4905527957087075
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0750, Accuracy: 8786/8991 (97.7199%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   1,  Average loss: 0.0014, Accuracy: 549/563 (97.5133%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   2,  Average loss: 0.0008, Accuracy: 555/563 (98.5790%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   3,  Average loss: 0.0003, Accuracy: 560/563 (99.4671%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   4,  Average loss: 0.0002, Accuracy: 561/563 (99.6448%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   7,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   8,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch   9,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 40, internal_epoch  10,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 16.927566599671913.
Norm before scaling: 16.880950556743503. Distance: 1.176012035545082
Total norm for 10 adversaries is: 16.880950556743503. distance: 1.176012035545082
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0893, Accuracy: 8765/8991 (97.4864%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   1,  Average loss: 0.0025, Accuracy: 598/618 (96.7638%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   2,  Average loss: 0.0008, Accuracy: 609/618 (98.5437%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   3,  Average loss: 0.0008, Accuracy: 609/618 (98.5437%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   4,  Average loss: 0.0004, Accuracy: 614/618 (99.3528%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   5,  Average loss: 0.0002, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   6,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   7,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   8,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch   9,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 52, internal_epoch  10,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Global model norm: 16.927566599671913.
Norm before scaling: 16.857761196221404. Distance: 1.555915232734836
Total norm for 10 adversaries is: 16.857761196221404. distance: 1.555915232734836
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0924, Accuracy: 8757/8991 (97.3974%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   1,  Average loss: 0.0020, Accuracy: 726/750 (96.8000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   2,  Average loss: 0.0013, Accuracy: 737/750 (98.2667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   3,  Average loss: 0.0007, Accuracy: 736/750 (98.1333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   4,  Average loss: 0.0002, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   5,  Average loss: 0.0002, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   6,  Average loss: 0.0002, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 16.927566599671913.
Norm before scaling: 16.861341586240716. Distance: 1.6410862592148274
Total norm for 10 adversaries is: 16.861341586240716. distance: 1.6410862592148274
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0769, Accuracy: 8781/8991 (97.6643%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   1,  Average loss: 0.0015, Accuracy: 650/668 (97.3054%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   2,  Average loss: 0.0007, Accuracy: 659/668 (98.6527%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   3,  Average loss: 0.0002, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   4,  Average loss: 0.0001, Accuracy: 667/668 (99.8503%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch   9,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  30, local model 30, internal_epoch  10,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 16.927566599671913.
Norm before scaling: 16.86529849890097. Distance: 1.2686455086961543
Total norm for 10 adversaries is: 16.86529849890097. distance: 1.2686455086961543
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0906, Accuracy: 8773/8991 (97.5754%)
time spent on training: 178.4022650718689
[foolsgold agg] training data poison_ratio: 1.0  data num: [474, 519, 626, 625, 572, 683, 563, 618, 750, 668]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [1.         1.         1.         0.28165076 1.         1.
 1.         1.         0.28165076 1.        ]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 1.0859, Accuracy: 8821/10000 (88.2100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.0791, Accuracy: 8817/8991 (98.0647%)
Done in 507.3892271518707 sec.
Server Epoch:31 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
poison local model 74 index 73 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   1,  Average loss: 0.0010, Accuracy: 613/626 (97.9233%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   2,  Average loss: 0.0008, Accuracy: 617/626 (98.5623%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 624/626 (99.6805%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   5,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   6,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Global model norm: 16.954155534634513.
Norm before scaling: 16.903203608675135. Distance: 1.2183882836779791
Total norm for 8 adversaries is: 16.903203608675135. distance: 1.2183882836779791
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0944, Accuracy: 8763/8991 (97.4641%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0022, Accuracy: 525/548 (95.8029%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   2,  Average loss: 0.0004, Accuracy: 542/548 (98.9051%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   3,  Average loss: 0.0004, Accuracy: 543/548 (99.0876%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   4,  Average loss: 0.0002, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   5,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   6,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   7,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   8,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch   9,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 9, internal_epoch  10,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Global model norm: 16.954155534634513.
Norm before scaling: 16.889976354913326. Distance: 1.3575215474591171
Total norm for 8 adversaries is: 16.889976354913326. distance: 1.3575215474591171
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0944, Accuracy: 8751/8991 (97.3307%)
___Train Local_Simple,  epoch  31, local model 99, internal_epoch   1,  Average loss: 0.0006, Accuracy: 407/410 (99.2683%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.3681, Accuracy: 8580/10000 (85.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 85, internal_epoch   1,  Average loss: 0.0063, Accuracy: 520/570 (91.2281%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2199, Accuracy: 9277/10000 (92.7700%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 576/587 (98.1261%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   2,  Average loss: 0.0030, Accuracy: 552/587 (94.0375%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   3,  Average loss: 0.0007, Accuracy: 579/587 (98.6371%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   4,  Average loss: 0.0003, Accuracy: 585/587 (99.6593%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   5,  Average loss: 0.0002, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   6,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   7,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   8,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   9,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch  10,  Average loss: 0.0001, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 16.954155534634513.
Norm before scaling: 17.13787669540638. Distance: 2.562549962742962
Total norm for 8 adversaries is: 17.13787669540638. distance: 2.562549962742962
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0990, Accuracy: 8747/8991 (97.2862%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0040, Accuracy: 628/644 (97.5155%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   2,  Average loss: 0.0074, Accuracy: 594/644 (92.2360%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   3,  Average loss: 0.0017, Accuracy: 626/644 (97.2050%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 635/644 (98.6025%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 639/644 (99.2236%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   7,  Average loss: 0.0004, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   8,  Average loss: 0.0003, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch   9,  Average loss: 0.0003, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 11, internal_epoch  10,  Average loss: 0.0003, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 16.954155534634513.
Norm before scaling: 17.45144544151134. Distance: 5.075027225214651
Total norm for 8 adversaries is: 17.45144544151134. distance: 5.075027225214651
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1210, Accuracy: 8646/8991 (96.1628%)
poison local model 24 index 23 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   1,  Average loss: 0.0010, Accuracy: 569/578 (98.4429%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 575/578 (99.4810%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   3,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   4,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   5,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   6,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   7,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   8,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch   9,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 24, internal_epoch  10,  Average loss: 0.0000, Accuracy: 578/578 (100.0000%), train_poison_data_count: 578
Global model norm: 16.954155534634513.
Norm before scaling: 16.896718156868694. Distance: 1.0428008326539935
Total norm for 8 adversaries is: 16.896718156868694. distance: 1.0428008326539935
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0776, Accuracy: 8796/8991 (97.8312%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   1,  Average loss: 0.0014, Accuracy: 650/665 (97.7444%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   2,  Average loss: 0.0004, Accuracy: 661/665 (99.3985%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   3,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   6,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   7,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.954155534634513.
Norm before scaling: 16.88591407766489. Distance: 1.2770292962462018
Total norm for 8 adversaries is: 16.88591407766489. distance: 1.2770292962462018
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0756, Accuracy: 8788/8991 (97.7422%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   1,  Average loss: 0.0027, Accuracy: 567/588 (96.4286%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   2,  Average loss: 0.0014, Accuracy: 570/588 (96.9388%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   3,  Average loss: 0.0005, Accuracy: 585/588 (99.4898%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   4,  Average loss: 0.0003, Accuracy: 586/588 (99.6599%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   5,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   6,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   7,  Average loss: 0.0002, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   8,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch   9,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 23, internal_epoch  10,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 16.954155534634513.
Norm before scaling: 16.935280967704024. Distance: 1.8075244618049275
Total norm for 8 adversaries is: 16.935280967704024. distance: 1.8075244618049275
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0842, Accuracy: 8757/8991 (97.3974%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 569/582 (97.7663%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   2,  Average loss: 0.0007, Accuracy: 572/582 (98.2818%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   3,  Average loss: 0.0001, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   4,  Average loss: 0.0001, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   5,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   6,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   7,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   8,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch   9,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  31, local model 25, internal_epoch  10,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 16.954155534634513.
Norm before scaling: 16.916452090150564. Distance: 1.2164008658013716
Total norm for 8 adversaries is: 16.916452090150564. distance: 1.2164008658013716
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0921, Accuracy: 8774/8991 (97.5865%)
time spent on training: 153.91747999191284
[foolsgold agg] training data poison_ratio: 0.8309761986892031  data num: [626, 548, 410, 570, 587, 644, 578, 665, 588, 582]
[foolsgold agg] considering poison per batch poison_fraction: 0.8309761986892031
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         0.66434368 0.66434368 1.        ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 1.0549, Accuracy: 8830/10000 (88.3000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.0787, Accuracy: 8823/8991 (98.1315%)
Done in 481.08944296836853 sec.
Server Epoch:32 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
___Train Local_Simple,  epoch  32, local model 93, internal_epoch   1,  Average loss: 0.0069, Accuracy: 482/529 (91.1153%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3548, Accuracy: 8825/10000 (88.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 525/575 (91.3043%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3723, Accuracy: 8954/10000 (89.5400%), Attack Success Rate:0/10000(0.000)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   1,  Average loss: 0.0017, Accuracy: 579/592 (97.8041%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   2,  Average loss: 0.0016, Accuracy: 586/592 (98.9865%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   3,  Average loss: 0.0009, Accuracy: 585/592 (98.8176%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   4,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   5,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   6,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   7,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   8,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch   9,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 55, internal_epoch  10,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Global model norm: 16.981197954925765.
Norm before scaling: 16.90880132522289. Distance: 1.5020747935369358
Total norm for 5 adversaries is: 16.90880132522289. distance: 1.5020747935369358
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0962, Accuracy: 8744/8991 (97.2528%)
poison local model 70 index 69 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   1,  Average loss: 0.0017, Accuracy: 531/549 (96.7213%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   2,  Average loss: 0.0006, Accuracy: 541/549 (98.5428%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   3,  Average loss: 0.0002, Accuracy: 547/549 (99.6357%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   4,  Average loss: 0.0002, Accuracy: 548/549 (99.8179%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   5,  Average loss: 0.0001, Accuracy: 548/549 (99.8179%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   6,  Average loss: 0.0001, Accuracy: 548/549 (99.8179%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   7,  Average loss: 0.0001, Accuracy: 548/549 (99.8179%), train_poison_data_count: 549
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   8,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch   9,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 70, internal_epoch  10,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Global model norm: 16.981197954925765.
Norm before scaling: 16.932861593889335. Distance: 1.2039074520870003
Total norm for 5 adversaries is: 16.932861593889335. distance: 1.2039074520870003
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0853, Accuracy: 8775/8991 (97.5976%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   1,  Average loss: 0.0018, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   2,  Average loss: 0.0004, Accuracy: 567/572 (99.1259%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   3,  Average loss: 0.0002, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 16.981197954925765.
Norm before scaling: 16.89167651097908. Distance: 1.0619524498547774
Total norm for 5 adversaries is: 16.89167651097908. distance: 1.0619524498547774
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0830, Accuracy: 8803/8991 (97.9090%)
___Train Local_Simple,  epoch  32, local model 90, internal_epoch   1,  Average loss: 0.0094, Accuracy: 530/577 (91.8544%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 5.7062, Accuracy: 4617/10000 (46.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 91, internal_epoch   1,  Average loss: 0.0056, Accuracy: 577/627 (92.0255%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1602, Accuracy: 9542/10000 (95.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 86, internal_epoch   1,  Average loss: 0.0060, Accuracy: 539/587 (91.8228%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5345, Accuracy: 8409/10000 (84.0900%), Attack Success Rate:0/10000(0.000)
poison local model 67 index 66 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   1,  Average loss: 0.0014, Accuracy: 628/643 (97.6672%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   2,  Average loss: 0.0007, Accuracy: 638/643 (99.2224%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   3,  Average loss: 0.0003, Accuracy: 641/643 (99.6890%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   4,  Average loss: 0.0002, Accuracy: 641/643 (99.6890%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   5,  Average loss: 0.0001, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   6,  Average loss: 0.0001, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   7,  Average loss: 0.0001, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   8,  Average loss: 0.0001, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch   9,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 67, internal_epoch  10,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Global model norm: 16.981197954925765.
Norm before scaling: 16.90914243539248. Distance: 1.2731436642012322
Total norm for 5 adversaries is: 16.90914243539248. distance: 1.2731436642012322
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0779, Accuracy: 8785/8991 (97.7088%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   1,  Average loss: 0.0019, Accuracy: 538/553 (97.2875%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   2,  Average loss: 0.0006, Accuracy: 548/553 (99.0958%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   3,  Average loss: 0.0003, Accuracy: 551/553 (99.6383%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   4,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   5,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  32, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Global model norm: 16.981197954925765.
Norm before scaling: 16.915953271916315. Distance: 1.1748448188250256
Total norm for 5 adversaries is: 16.915953271916315. distance: 1.1748448188250256
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0786, Accuracy: 8799/8991 (97.8645%)
time spent on training: 111.22164702415466
[foolsgold agg] training data poison_ratio: 0.5012060647829083  data num: [529, 575, 592, 549, 572, 577, 627, 587, 643, 553]
[foolsgold agg] considering poison per batch poison_fraction: 0.5012060647829083
[foolsgold agg] wv: [0. 1. 1. 1. 1. 1. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.9343, Accuracy: 8834/10000 (88.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.0781, Accuracy: 8820/8991 (98.0981%)
Done in 437.44949078559875 sec.
Server Epoch:33 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 509/519 (98.0732%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 512/519 (98.6513%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   3,  Average loss: 0.0014, Accuracy: 507/519 (97.6879%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   4,  Average loss: 0.0004, Accuracy: 513/519 (98.8439%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   6,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   7,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   8,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch   9,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 77, internal_epoch  10,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Global model norm: 16.98325375783819.
Norm before scaling: 16.96303623732119. Distance: 1.078044667222691
Total norm for 8 adversaries is: 16.96303623732119. distance: 1.078044667222691
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0771, Accuracy: 8809/8991 (97.9758%)
poison local model 57 index 56 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   1,  Average loss: 0.0011, Accuracy: 560/568 (98.5915%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 562/568 (98.9437%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   3,  Average loss: 0.0002, Accuracy: 565/568 (99.4718%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   5,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   6,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 57, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Global model norm: 16.98325375783819.
Norm before scaling: 16.92771262852676. Distance: 0.9463600785541925
Total norm for 8 adversaries is: 16.92771262852676. distance: 0.9463600785541925
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0923, Accuracy: 8765/8991 (97.4864%)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   1,  Average loss: 0.0022, Accuracy: 608/625 (97.2800%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   2,  Average loss: 0.0008, Accuracy: 616/625 (98.5600%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   3,  Average loss: 0.0003, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   4,  Average loss: 0.0002, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   5,  Average loss: 0.0002, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   6,  Average loss: 0.0002, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch   9,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Global model norm: 16.98325375783819.
Norm before scaling: 16.880062897913028. Distance: 1.287494237201719
Total norm for 8 adversaries is: 16.880062897913028. distance: 1.287494237201719
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0774, Accuracy: 8787/8991 (97.7311%)
poison local model 67 index 66 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 631/643 (98.1337%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   2,  Average loss: 0.0005, Accuracy: 638/643 (99.2224%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   3,  Average loss: 0.0002, Accuracy: 641/643 (99.6890%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   4,  Average loss: 0.0001, Accuracy: 642/643 (99.8445%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   5,  Average loss: 0.0001, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   6,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   7,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   8,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch   9,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 67, internal_epoch  10,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Global model norm: 16.98325375783819.
Norm before scaling: 16.92333301803912. Distance: 1.1884505834067436
Total norm for 8 adversaries is: 16.92333301803912. distance: 1.1884505834067436
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0790, Accuracy: 8796/8991 (97.8312%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0015, Accuracy: 522/535 (97.5701%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   2,  Average loss: 0.0005, Accuracy: 529/535 (98.8785%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   3,  Average loss: 0.0002, Accuracy: 532/535 (99.4393%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   6,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 16.98325375783819.
Norm before scaling: 16.92569966299861. Distance: 1.1173711239023871
Total norm for 8 adversaries is: 16.92569966299861. distance: 1.1173711239023871
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0966, Accuracy: 8749/8991 (97.3084%)
___Train Local_Simple,  epoch  33, local model 97, internal_epoch   1,  Average loss: 0.0060, Accuracy: 519/588 (88.2653%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6322, Accuracy: 8140/10000 (81.4000%), Attack Success Rate:0/10000(0.000)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   1,  Average loss: 0.0026, Accuracy: 648/665 (97.4436%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   2,  Average loss: 0.0009, Accuracy: 654/665 (98.3459%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   3,  Average loss: 0.0005, Accuracy: 660/665 (99.2481%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   4,  Average loss: 0.0003, Accuracy: 663/665 (99.6992%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   5,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   6,  Average loss: 0.0002, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 16.98325375783819.
Norm before scaling: 16.893697143426838. Distance: 1.5520137626195045
Total norm for 8 adversaries is: 16.893697143426838. distance: 1.5520137626195045
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0816, Accuracy: 8780/8991 (97.6532%)
poison local model 22 index 21 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   1,  Average loss: 0.0017, Accuracy: 516/531 (97.1751%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   2,  Average loss: 0.0006, Accuracy: 525/531 (98.8701%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   3,  Average loss: 0.0001, Accuracy: 530/531 (99.8117%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   4,  Average loss: 0.0001, Accuracy: 530/531 (99.8117%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   5,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   6,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   7,  Average loss: 0.0001, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   8,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch   9,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 22, internal_epoch  10,  Average loss: 0.0000, Accuracy: 531/531 (100.0000%), train_poison_data_count: 531
Global model norm: 16.98325375783819.
Norm before scaling: 16.93760089914596. Distance: 1.1810010455948143
Total norm for 8 adversaries is: 16.93760089914596. distance: 1.1810010455948143
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0782, Accuracy: 8805/8991 (97.9313%)
poison local model 70 index 69 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   1,  Average loss: 0.0013, Accuracy: 535/549 (97.4499%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   2,  Average loss: 0.0006, Accuracy: 542/549 (98.7250%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   3,  Average loss: 0.0002, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   4,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   5,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   6,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   7,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   8,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch   9,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  33, local model 70, internal_epoch  10,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Global model norm: 16.98325375783819.
Norm before scaling: 16.935617039591996. Distance: 1.0861251998165375
Total norm for 8 adversaries is: 16.935617039591996. distance: 1.0861251998165375
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0863, Accuracy: 8771/8991 (97.5531%)
___Train Local_Simple,  epoch  33, local model 93, internal_epoch   1,  Average loss: 0.0059, Accuracy: 490/529 (92.6276%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1437, Accuracy: 9529/10000 (95.2900%), Attack Success Rate:0/10000(0.000)
time spent on training: 147.76378417015076
[foolsgold agg] training data poison_ratio: 0.8058066759388038  data num: [519, 568, 625, 643, 535, 588, 665, 531, 549, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.8058066759388038
[foolsgold agg] wv: [1.        1.        1.        1.        1.        0.3782936 1.
 1.        1.        0.3782936]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 1.0951, Accuracy: 8827/10000 (88.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.0783, Accuracy: 8812/8991 (98.0091%)
Done in 472.8462657928467 sec.
Server Epoch:34 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   1,  Average loss: 0.0010, Accuracy: 629/641 (98.1279%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   2,  Average loss: 0.0003, Accuracy: 638/641 (99.5320%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   3,  Average loss: 0.0001, Accuracy: 639/641 (99.6880%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   4,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   5,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   6,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 37, internal_epoch  10,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 17.002899820175436.
Norm before scaling: 16.943118806829624. Distance: 1.0964363351265676
Total norm for 9 adversaries is: 16.943118806829624. distance: 1.0964363351265676
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0881, Accuracy: 8784/8991 (97.6977%)
poison local model 49 index 48 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   1,  Average loss: 0.0018, Accuracy: 500/516 (96.8992%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   2,  Average loss: 0.0008, Accuracy: 509/516 (98.6434%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   3,  Average loss: 0.0003, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   4,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   5,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   6,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   7,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   8,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch   9,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 49, internal_epoch  10,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 17.002899820175436.
Norm before scaling: 16.96478843460358. Distance: 1.3241335861142305
Total norm for 9 adversaries is: 16.96478843460358. distance: 1.3241335861142305
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0760, Accuracy: 8798/8991 (97.8534%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   1,  Average loss: 0.0019, Accuracy: 636/652 (97.5460%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 649/652 (99.5399%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   3,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 41, internal_epoch  10,  Average loss: 0.0000, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 17.002899820175436.
Norm before scaling: 16.922514307233296. Distance: 1.3458727991244324
Total norm for 9 adversaries is: 16.922514307233296. distance: 1.3458727991244324
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0825, Accuracy: 8793/8991 (97.7978%)
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0015, Accuracy: 464/474 (97.8903%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   3,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   4,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 17.002899820175436.
Norm before scaling: 16.940751893202123. Distance: 0.9810471367550171
Total norm for 9 adversaries is: 16.940751893202123. distance: 0.9810471367550171
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0923, Accuracy: 8767/8991 (97.5086%)
poison local model 71 index 70 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   1,  Average loss: 0.0015, Accuracy: 616/638 (96.5517%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   2,  Average loss: 0.0010, Accuracy: 624/638 (97.8056%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   3,  Average loss: 0.0006, Accuracy: 630/638 (98.7461%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   4,  Average loss: 0.0002, Accuracy: 636/638 (99.6865%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   5,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   6,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   7,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   8,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch   9,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 71, internal_epoch  10,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 17.002899820175436.
Norm before scaling: 16.973633908119822. Distance: 1.4403253239470244
Total norm for 9 adversaries is: 16.973633908119822. distance: 1.4403253239470244
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0790, Accuracy: 8797/8991 (97.8423%)
poison local model 60 index 59 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   1,  Average loss: 0.0018, Accuracy: 630/644 (97.8261%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   2,  Average loss: 0.0006, Accuracy: 636/644 (98.7578%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   3,  Average loss: 0.0002, Accuracy: 641/644 (99.5342%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   4,  Average loss: 0.0002, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   5,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   6,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   7,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   8,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch   9,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 60, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 17.002899820175436.
Norm before scaling: 16.91681739978002. Distance: 1.241322678189041
Total norm for 9 adversaries is: 16.91681739978002. distance: 1.241322678189041
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0886, Accuracy: 8773/8991 (97.5754%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   1,  Average loss: 0.0012, Accuracy: 653/665 (98.1955%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   2,  Average loss: 0.0005, Accuracy: 657/665 (98.7970%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 661/665 (99.3985%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   6,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   7,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   8,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch   9,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 42, internal_epoch  10,  Average loss: 0.0000, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 17.002899820175436.
Norm before scaling: 16.948336917455297. Distance: 1.2762686495114217
Total norm for 9 adversaries is: 16.948336917455297. distance: 1.2762686495114217
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0876, Accuracy: 8769/8991 (97.5309%)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0062, Accuracy: 517/555 (93.1532%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2226, Accuracy: 9234/10000 (92.3400%), Attack Success Rate:0/10000(0.000)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 518/526 (98.4791%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   2,  Average loss: 0.0005, Accuracy: 521/526 (99.0494%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   3,  Average loss: 0.0003, Accuracy: 524/526 (99.6198%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   4,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   7,  Average loss: 0.0001, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 17.002899820175436.
Norm before scaling: 16.94762925754431. Distance: 0.9923273123207279
Total norm for 9 adversaries is: 16.94762925754431. distance: 0.9923273123207279
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0882, Accuracy: 8784/8991 (97.6977%)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   1,  Average loss: 0.0013, Accuracy: 579/589 (98.3022%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 586/589 (99.4907%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   3,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   6,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  34, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 17.002899820175436.
Norm before scaling: 16.952889183267736. Distance: 1.123221421982593
Total norm for 9 adversaries is: 16.952889183267736. distance: 1.123221421982593
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0864, Accuracy: 8773/8991 (97.5754%)
time spent on training: 161.95909094810486
[foolsgold agg] training data poison_ratio: 0.9059322033898305  data num: [641, 516, 652, 474, 638, 644, 665, 555, 526, 589]
[foolsgold agg] considering poison per batch poison_fraction: 0.9059322033898305
[foolsgold agg] wv: [1.         1.         1.         1.         0.29006864 1.
 0.29006864 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 1.0634, Accuracy: 8824/10000 (88.2400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.0782, Accuracy: 8809/8991 (97.9758%)
Done in 488.3355758190155 sec.
Server Epoch:35 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
poison local model 50 index 49 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   1,  Average loss: 0.0013, Accuracy: 465/474 (98.1013%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 472/474 (99.5781%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   3,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   4,  Average loss: 0.0001, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   5,  Average loss: 0.0001, Accuracy: 473/474 (99.7890%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   6,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   7,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   8,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch   9,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 50, internal_epoch  10,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%), train_poison_data_count: 474
Global model norm: 17.016650852914623.
Norm before scaling: 16.962306701413358. Distance: 0.957403709958349
Total norm for 9 adversaries is: 16.962306701413358. distance: 0.957403709958349
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0887, Accuracy: 8775/8991 (97.5976%)
poison local model 36 index 35 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   1,  Average loss: 0.0038, Accuracy: 501/520 (96.3462%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   2,  Average loss: 0.0014, Accuracy: 506/520 (97.3077%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   3,  Average loss: 0.0015, Accuracy: 502/520 (96.5385%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   4,  Average loss: 0.0005, Accuracy: 517/520 (99.4231%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   5,  Average loss: 0.0002, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   6,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   7,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   8,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch   9,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 36, internal_epoch  10,  Average loss: 0.0001, Accuracy: 520/520 (100.0000%), train_poison_data_count: 520
Global model norm: 17.016650852914623.
Norm before scaling: 17.065940873289847. Distance: 2.44885173280563
Total norm for 9 adversaries is: 17.065940873289847. distance: 2.44885173280563
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1039, Accuracy: 8722/8991 (97.0081%)
poison local model 53 index 52 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   1,  Average loss: 0.0018, Accuracy: 599/617 (97.0827%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   2,  Average loss: 0.0013, Accuracy: 604/617 (97.8930%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   3,  Average loss: 0.0006, Accuracy: 611/617 (99.0276%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   4,  Average loss: 0.0002, Accuracy: 615/617 (99.6759%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   5,  Average loss: 0.0001, Accuracy: 616/617 (99.8379%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   6,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   7,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   8,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch   9,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 53, internal_epoch  10,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Global model norm: 17.016650852914623.
Norm before scaling: 16.975510853874177. Distance: 1.534704942831326
Total norm for 9 adversaries is: 16.975510853874177. distance: 1.534704942831326
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0780, Accuracy: 8784/8991 (97.6977%)
poison local model 79 index 78 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   1,  Average loss: 0.0013, Accuracy: 626/635 (98.5827%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   2,  Average loss: 0.0007, Accuracy: 625/635 (98.4252%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   3,  Average loss: 0.0002, Accuracy: 633/635 (99.6850%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   4,  Average loss: 0.0001, Accuracy: 634/635 (99.8425%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   5,  Average loss: 0.0001, Accuracy: 634/635 (99.8425%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   6,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   7,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   8,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch   9,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 79, internal_epoch  10,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Global model norm: 17.016650852914623.
Norm before scaling: 16.949695433634457. Distance: 1.1499687936943972
Total norm for 9 adversaries is: 16.949695433634457. distance: 1.1499687936943972
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0876, Accuracy: 8771/8991 (97.5531%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   1,  Average loss: 0.0007, Accuracy: 630/638 (98.7461%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   2,  Average loss: 0.0008, Accuracy: 632/638 (99.0596%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   3,  Average loss: 0.0002, Accuracy: 635/638 (99.5298%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   5,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   6,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 17.016650852914623.
Norm before scaling: 16.952392337278866. Distance: 0.9975496311317271
Total norm for 9 adversaries is: 16.952392337278866. distance: 0.9975496311317271
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0705, Accuracy: 8807/8991 (97.9535%)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 567/582 (97.4227%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   2,  Average loss: 0.0068, Accuracy: 549/582 (94.3299%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   3,  Average loss: 0.0017, Accuracy: 561/582 (96.3918%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   4,  Average loss: 0.0012, Accuracy: 572/582 (98.2818%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   5,  Average loss: 0.0008, Accuracy: 576/582 (98.9691%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   6,  Average loss: 0.0006, Accuracy: 578/582 (99.3127%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   7,  Average loss: 0.0005, Accuracy: 579/582 (99.4845%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   8,  Average loss: 0.0004, Accuracy: 579/582 (99.4845%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch   9,  Average loss: 0.0003, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 25, internal_epoch  10,  Average loss: 0.0003, Accuracy: 580/582 (99.6564%), train_poison_data_count: 582
Global model norm: 17.016650852914623.
Norm before scaling: 17.17158176216867. Distance: 3.3345365419020054
Total norm for 9 adversaries is: 17.17158176216867. distance: 3.3345365419020054
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0835, Accuracy: 8776/8991 (97.6087%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   1,  Average loss: 0.0018, Accuracy: 559/572 (97.7273%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   2,  Average loss: 0.0005, Accuracy: 567/572 (99.1259%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   3,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   4,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.016650852914623.
Norm before scaling: 16.936695487985087. Distance: 1.0998694212310638
Total norm for 9 adversaries is: 16.936695487985087. distance: 1.0998694212310638
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0758, Accuracy: 8807/8991 (97.9535%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 587/606 (96.8647%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   2,  Average loss: 0.0009, Accuracy: 589/606 (97.1947%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   3,  Average loss: 0.0011, Accuracy: 600/606 (99.0099%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   4,  Average loss: 0.0007, Accuracy: 603/606 (99.5050%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   5,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   6,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 17.016650852914623.
Norm before scaling: 16.937691888038955. Distance: 1.5489280254765518
Total norm for 9 adversaries is: 16.937691888038955. distance: 1.5489280254765518
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0851, Accuracy: 8765/8991 (97.4864%)
poison local model 65 index 64 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   1,  Average loss: 0.0017, Accuracy: 554/573 (96.6841%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   2,  Average loss: 0.0005, Accuracy: 568/573 (99.1274%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   3,  Average loss: 0.0002, Accuracy: 572/573 (99.8255%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   4,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch   9,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  35, local model 65, internal_epoch  10,  Average loss: 0.0000, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 17.016650852914623.
Norm before scaling: 16.990938352074153. Distance: 1.28876473426721
Total norm for 9 adversaries is: 16.990938352074153. distance: 1.28876473426721
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0751, Accuracy: 8804/8991 (97.9201%)
___Train Local_Simple,  epoch  35, local model 98, internal_epoch   1,  Average loss: 0.0051, Accuracy: 524/568 (92.2535%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2329, Accuracy: 9256/10000 (92.5600%), Attack Success Rate:0/10000(0.000)
time spent on training: 159.72068810462952
[foolsgold agg] training data poison_ratio: 0.9018150388936905  data num: [474, 520, 617, 635, 638, 582, 572, 606, 573, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.9018150388936905
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 1.0561, Accuracy: 8837/10000 (88.3700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.0751, Accuracy: 8825/8991 (98.1537%)
Done in 485.6107518672943 sec.
Server Epoch:36 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  36, local model 82, internal_epoch   1,  Average loss: 0.0075, Accuracy: 560/621 (90.1771%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2939, Accuracy: 8999/10000 (89.9900%), Attack Success Rate:0/10000(0.000)
poison local model 4 index 3 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 581/587 (98.9779%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   2,  Average loss: 0.0009, Accuracy: 577/587 (98.2964%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   3,  Average loss: 0.0009, Accuracy: 577/587 (98.2964%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   4,  Average loss: 0.0003, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   5,  Average loss: 0.0001, Accuracy: 586/587 (99.8296%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   6,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   7,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   8,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   9,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch  10,  Average loss: 0.0000, Accuracy: 587/587 (100.0000%), train_poison_data_count: 587
Global model norm: 17.044309428273085.
Norm before scaling: 17.05012393134486. Distance: 1.5219535447047587
Total norm for 8 adversaries is: 17.05012393134486. distance: 1.5219535447047587
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0909, Accuracy: 8778/8991 (97.6310%)
poison local model 79 index 78 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   1,  Average loss: 0.0014, Accuracy: 622/635 (97.9528%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   2,  Average loss: 0.0005, Accuracy: 629/635 (99.0551%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   3,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   4,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   5,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   6,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   7,  Average loss: 0.0001, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   8,  Average loss: 0.0000, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch   9,  Average loss: 0.0000, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 79, internal_epoch  10,  Average loss: 0.0000, Accuracy: 635/635 (100.0000%), train_poison_data_count: 635
Global model norm: 17.044309428273085.
Norm before scaling: 16.97255780682038. Distance: 1.1908998507552213
Total norm for 8 adversaries is: 16.97255780682038. distance: 1.1908998507552213
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0913, Accuracy: 8765/8991 (97.4864%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0014, Accuracy: 598/609 (98.1938%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   2,  Average loss: 0.0003, Accuracy: 605/609 (99.3432%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   3,  Average loss: 0.0001, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   6,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 17.044309428273085.
Norm before scaling: 16.9984121142034. Distance: 1.2021159114202533
Total norm for 8 adversaries is: 16.9984121142034. distance: 1.2021159114202533
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0838, Accuracy: 8777/8991 (97.6198%)
poison local model 47 index 46 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   1,  Average loss: 0.0020, Accuracy: 588/602 (97.6744%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   2,  Average loss: 0.0012, Accuracy: 588/602 (97.6744%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   3,  Average loss: 0.0004, Accuracy: 598/602 (99.3355%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   4,  Average loss: 0.0002, Accuracy: 600/602 (99.6678%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   5,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   6,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   7,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   8,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch   9,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 47, internal_epoch  10,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%), train_poison_data_count: 602
Global model norm: 17.044309428273085.
Norm before scaling: 16.9920725570825. Distance: 1.6386354280949396
Total norm for 8 adversaries is: 16.9920725570825. distance: 1.6386354280949396
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0824, Accuracy: 8778/8991 (97.6310%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   1,  Average loss: 0.0014, Accuracy: 506/518 (97.6834%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 513/518 (99.0347%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   3,  Average loss: 0.0002, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   4,  Average loss: 0.0001, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   5,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   6,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   7,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   8,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 44, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 17.044309428273085.
Norm before scaling: 16.994467339873164. Distance: 1.1505997213542674
Total norm for 8 adversaries is: 16.994467339873164. distance: 1.1505997213542674
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0810, Accuracy: 8797/8991 (97.8423%)
___Train Local_Simple,  epoch  36, local model 89, internal_epoch   1,  Average loss: 0.0048, Accuracy: 625/664 (94.1265%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2176, Accuracy: 9249/10000 (92.4900%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   1,  Average loss: 0.0016, Accuracy: 577/589 (97.9626%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   2,  Average loss: 0.0006, Accuracy: 582/589 (98.8115%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   3,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   7,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   8,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 17.044309428273085.
Norm before scaling: 16.982740728928757. Distance: 1.2177408392978062
Total norm for 8 adversaries is: 16.982740728928757. distance: 1.2177408392978062
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0792, Accuracy: 8773/8991 (97.5754%)
poison local model 70 index 69 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   1,  Average loss: 0.0015, Accuracy: 534/549 (97.2678%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   2,  Average loss: 0.0006, Accuracy: 542/549 (98.7250%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   3,  Average loss: 0.0002, Accuracy: 547/549 (99.6357%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   4,  Average loss: 0.0001, Accuracy: 548/549 (99.8179%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   5,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   6,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   7,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   8,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch   9,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 70, internal_epoch  10,  Average loss: 0.0001, Accuracy: 549/549 (100.0000%), train_poison_data_count: 549
Global model norm: 17.044309428273085.
Norm before scaling: 16.988879886411638. Distance: 1.132977545981195
Total norm for 8 adversaries is: 16.988879886411638. distance: 1.132977545981195
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0855, Accuracy: 8780/8991 (97.6532%)
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 511/519 (98.4586%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   3,  Average loss: 0.0003, Accuracy: 516/519 (99.4220%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   4,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   5,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   6,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   7,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   8,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch   9,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  36, local model 77, internal_epoch  10,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Global model norm: 17.044309428273085.
Norm before scaling: 17.00574530960511. Distance: 0.9179241737743298
Total norm for 8 adversaries is: 17.00574530960511. distance: 0.9179241737743298
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0812, Accuracy: 8809/8991 (97.9758%)
time spent on training: 150.30269813537598
[foolsgold agg] training data poison_ratio: 0.7819446801289666  data num: [621, 587, 635, 609, 602, 518, 664, 589, 549, 519]
[foolsgold agg] considering poison per batch poison_fraction: 0.7819446801289666
[foolsgold agg] wv: [0. 1. 1. 1. 1. 1. 0. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 1.1610, Accuracy: 8841/10000 (88.4100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.0781, Accuracy: 8827/8991 (98.1760%)
Done in 475.1525821685791 sec.
Server Epoch:37 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   1,  Average loss: 0.0013, Accuracy: 637/650 (98.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   2,  Average loss: 0.0009, Accuracy: 639/650 (98.3077%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   3,  Average loss: 0.0004, Accuracy: 646/650 (99.3846%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 649/650 (99.8462%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   8,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch   9,  Average loss: 0.0000, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 17.061175508059137.
Norm before scaling: 17.001728643154753. Distance: 1.3049499339149833
Total norm for 9 adversaries is: 17.001728643154753. distance: 1.3049499339149833
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0732, Accuracy: 8812/8991 (98.0091%)
poison local model 30 index 29 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0014, Accuracy: 653/668 (97.7545%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0010, Accuracy: 654/668 (97.9042%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   3,  Average loss: 0.0005, Accuracy: 660/668 (98.8024%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   4,  Average loss: 0.0002, Accuracy: 665/668 (99.5509%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   5,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   6,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   7,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   8,  Average loss: 0.0001, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch   9,  Average loss: 0.0000, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 30, internal_epoch  10,  Average loss: 0.0000, Accuracy: 668/668 (100.0000%), train_poison_data_count: 668
Global model norm: 17.061175508059137.
Norm before scaling: 17.016406949434124. Distance: 1.3951846603489746
Total norm for 9 adversaries is: 17.016406949434124. distance: 1.3951846603489746
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0832, Accuracy: 8792/8991 (97.7867%)
poison local model 33 index 32 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   1,  Average loss: 0.0009, Accuracy: 627/638 (98.2759%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   2,  Average loss: 0.0008, Accuracy: 625/638 (97.9624%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   3,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   4,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   5,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   6,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 33, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 17.061175508059137.
Norm before scaling: 17.009741292216205. Distance: 1.1035986945019778
Total norm for 9 adversaries is: 17.009741292216205. distance: 1.1035986945019778
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0785, Accuracy: 8789/8991 (97.7533%)
poison local model 41 index 40 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   1,  Average loss: 0.0018, Accuracy: 633/652 (97.0859%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   2,  Average loss: 0.0008, Accuracy: 642/652 (98.4663%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   3,  Average loss: 0.0004, Accuracy: 650/652 (99.6933%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   4,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   5,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   6,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   7,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   8,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch   9,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 41, internal_epoch  10,  Average loss: 0.0001, Accuracy: 652/652 (100.0000%), train_poison_data_count: 652
Global model norm: 17.061175508059137.
Norm before scaling: 16.979832972771057. Distance: 1.414713167160366
Total norm for 9 adversaries is: 16.979832972771057. distance: 1.414713167160366
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0774, Accuracy: 8792/8991 (97.7867%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 503/512 (98.2422%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 508/512 (99.2188%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   3,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   7,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   8,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Global model norm: 17.061175508059137.
Norm before scaling: 17.013213464041616. Distance: 1.0079111450178635
Total norm for 9 adversaries is: 17.013213464041616. distance: 1.0079111450178635
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1004, Accuracy: 8757/8991 (97.3974%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   1,  Average loss: 0.0020, Accuracy: 603/618 (97.5728%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   2,  Average loss: 0.0005, Accuracy: 612/618 (99.0291%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   3,  Average loss: 0.0003, Accuracy: 614/618 (99.3528%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   4,  Average loss: 0.0002, Accuracy: 617/618 (99.8382%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   5,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   6,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   7,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   8,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch   9,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 52, internal_epoch  10,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Global model norm: 17.061175508059137.
Norm before scaling: 16.98225284292675. Distance: 1.4068267487259354
Total norm for 9 adversaries is: 16.98225284292675. distance: 1.4068267487259354
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0923, Accuracy: 8765/8991 (97.4864%)
___Train Local_Simple,  epoch  37, local model 84, internal_epoch   1,  Average loss: 0.0060, Accuracy: 509/560 (90.8929%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2645, Accuracy: 9031/10000 (90.3100%), Attack Success Rate:0/10000(0.000)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   1,  Average loss: 0.0015, Accuracy: 501/518 (96.7181%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   2,  Average loss: 0.0007, Accuracy: 510/518 (98.4556%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   3,  Average loss: 0.0004, Accuracy: 514/518 (99.2278%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   4,  Average loss: 0.0002, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   5,  Average loss: 0.0001, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   6,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   7,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 43, internal_epoch  10,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 17.061175508059137.
Norm before scaling: 17.0491958562773. Distance: 1.4301320203114185
Total norm for 9 adversaries is: 17.0491958562773. distance: 1.4301320203114185
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0788, Accuracy: 8791/8991 (97.7756%)
poison local model 62 index 61 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   1,  Average loss: 0.0026, Accuracy: 596/617 (96.5964%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   2,  Average loss: 0.0007, Accuracy: 604/617 (97.8930%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   3,  Average loss: 0.0006, Accuracy: 611/617 (99.0276%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   4,  Average loss: 0.0002, Accuracy: 616/617 (99.8379%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   5,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   6,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   7,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   8,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch   9,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 62, internal_epoch  10,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Global model norm: 17.061175508059137.
Norm before scaling: 16.975054221424816. Distance: 1.5109902531469157
Total norm for 9 adversaries is: 16.975054221424816. distance: 1.5109902531469157
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0641, Accuracy: 8811/8991 (97.9980%)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   1,  Average loss: 0.0017, Accuracy: 506/516 (98.0620%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   2,  Average loss: 0.0007, Accuracy: 513/516 (99.4186%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   3,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   4,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   5,  Average loss: 0.0002, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   7,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  37, local model 18, internal_epoch  10,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 17.061175508059137.
Norm before scaling: 17.018714028893772. Distance: 1.2745013795368545
Total norm for 9 adversaries is: 17.018714028893772. distance: 1.2745013795368545
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1066, Accuracy: 8730/8991 (97.0971%)
time spent on training: 162.0437228679657
[foolsgold agg] training data poison_ratio: 0.9058665321902841  data num: [650, 668, 638, 652, 512, 618, 560, 518, 617, 516]
[foolsgold agg] considering poison per batch poison_fraction: 0.9058665321902841
[foolsgold agg] wv: [1.         1.         1.         0.81034377 1.         1.
 1.         1.         0.81034377 1.        ]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 1.0698, Accuracy: 8848/10000 (88.4800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.0734, Accuracy: 8836/8991 (98.2761%)
Done in 487.3669250011444 sec.
Server Epoch:38 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   1,  Average loss: 0.0009, Accuracy: 493/503 (98.0119%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 500/503 (99.4036%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   4,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   5,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 17.078392145383134.
Norm before scaling: 17.033813955514887. Distance: 0.8948732080634813
Total norm for 8 adversaries is: 17.033813955514887. distance: 0.8948732080634813
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0744, Accuracy: 8818/8991 (98.0759%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   1,  Average loss: 0.0014, Accuracy: 589/605 (97.3554%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   2,  Average loss: 0.0010, Accuracy: 598/605 (98.8430%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   4,  Average loss: 0.0002, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 17.078392145383134.
Norm before scaling: 17.01548779645097. Distance: 1.1691932001091687
Total norm for 8 adversaries is: 17.01548779645097. distance: 1.1691932001091687
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0860, Accuracy: 8783/8991 (97.6866%)
___Train Local_Simple,  epoch  38, local model 87, internal_epoch   1,  Average loss: 0.0050, Accuracy: 529/575 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3401, Accuracy: 9028/10000 (90.2800%), Attack Success Rate:0/10000(0.000)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   1,  Average loss: 0.0016, Accuracy: 603/624 (96.6346%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   2,  Average loss: 0.0008, Accuracy: 612/624 (98.0769%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   3,  Average loss: 0.0003, Accuracy: 617/624 (98.8782%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   4,  Average loss: 0.0001, Accuracy: 623/624 (99.8397%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   5,  Average loss: 0.0001, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   6,  Average loss: 0.0001, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   7,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   8,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch   9,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 78, internal_epoch  10,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Global model norm: 17.078392145383134.
Norm before scaling: 17.0396606955976. Distance: 1.4435352017028535
Total norm for 8 adversaries is: 17.0396606955976. distance: 1.4435352017028535
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0963, Accuracy: 8765/8991 (97.4864%)
poison local model 53 index 52 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   1,  Average loss: 0.0018, Accuracy: 603/617 (97.7310%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   2,  Average loss: 0.0013, Accuracy: 603/617 (97.7310%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   3,  Average loss: 0.0003, Accuracy: 613/617 (99.3517%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   4,  Average loss: 0.0002, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   5,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   6,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   7,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   8,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch   9,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 53, internal_epoch  10,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Global model norm: 17.078392145383134.
Norm before scaling: 17.027834376534425. Distance: 1.5886911624125024
Total norm for 8 adversaries is: 17.027834376534425. distance: 1.5886911624125024
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0797, Accuracy: 8768/8991 (97.5197%)
___Train Local_Simple,  epoch  38, local model 83, internal_epoch   1,  Average loss: 0.0060, Accuracy: 511/555 (92.0721%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2053, Accuracy: 9297/10000 (92.9700%), Attack Success Rate:0/10000(0.000)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   1,  Average loss: 0.0010, Accuracy: 541/552 (98.0072%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   2,  Average loss: 0.0003, Accuracy: 548/552 (99.2754%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   3,  Average loss: 0.0002, Accuracy: 551/552 (99.8188%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   4,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   5,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   6,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   7,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   8,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch   9,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 19, internal_epoch  10,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Global model norm: 17.078392145383134.
Norm before scaling: 17.036713394064137. Distance: 1.0410014253546112
Total norm for 8 adversaries is: 17.036713394064137. distance: 1.0410014253546112
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.1169, Accuracy: 8731/8991 (97.1082%)
poison local model 45 index 44 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   1,  Average loss: 0.0018, Accuracy: 734/750 (97.8667%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   2,  Average loss: 0.0016, Accuracy: 722/750 (96.2667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   3,  Average loss: 0.0006, Accuracy: 744/750 (99.2000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   4,  Average loss: 0.0004, Accuracy: 745/750 (99.3333%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   5,  Average loss: 0.0002, Accuracy: 746/750 (99.4667%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   6,  Average loss: 0.0002, Accuracy: 747/750 (99.6000%), train_poison_data_count: 750
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   7,  Average loss: 0.0001, Accuracy: 749/750 (99.8667%), train_poison_data_count: 750
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   8,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch   9,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 45, internal_epoch  10,  Average loss: 0.0001, Accuracy: 750/750 (100.0000%), train_poison_data_count: 750
Global model norm: 17.078392145383134.
Norm before scaling: 17.005836831162558. Distance: 1.694124922130974
Total norm for 8 adversaries is: 17.005836831162558. distance: 1.694124922130974
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0731, Accuracy: 8802/8991 (97.8979%)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   1,  Average loss: 0.0019, Accuracy: 603/618 (97.5728%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   2,  Average loss: 0.0007, Accuracy: 609/618 (98.5437%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   3,  Average loss: 0.0004, Accuracy: 613/618 (99.1909%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   4,  Average loss: 0.0002, Accuracy: 617/618 (99.8382%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   5,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   6,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   7,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   8,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch   9,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 52, internal_epoch  10,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Global model norm: 17.078392145383134.
Norm before scaling: 17.00359620596616. Distance: 1.4015974433821174
Total norm for 8 adversaries is: 17.00359620596616. distance: 1.4015974433821174
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0933, Accuracy: 8760/8991 (97.4308%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 638/648 (98.4568%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 641/648 (98.9198%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   3,  Average loss: 0.0001, Accuracy: 646/648 (99.6914%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   5,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 17.078392145383134.
Norm before scaling: 17.00038236300235. Distance: 1.09069042064251
Total norm for 8 adversaries is: 17.00038236300235. distance: 1.09069042064251
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0833, Accuracy: 8798/8991 (97.8534%)
time spent on training: 151.20412373542786
[foolsgold agg] training data poison_ratio: 0.813130477922937  data num: [503, 605, 575, 624, 617, 555, 552, 750, 618, 648]
[foolsgold agg] considering poison per batch poison_fraction: 0.813130477922937
[foolsgold agg] wv: [1.         1.         0.09096471 1.         1.         0.09096471
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 1.2047, Accuracy: 8843/10000 (88.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.0739, Accuracy: 8832/8991 (98.2316%)
Done in 475.4563579559326 sec.
Server Epoch:39 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
poison local model 3 index 2 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0010, Accuracy: 494/505 (97.8218%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   2,  Average loss: 0.0006, Accuracy: 502/505 (99.4059%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   3,  Average loss: 0.0002, Accuracy: 504/505 (99.8020%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   4,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   5,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   6,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   7,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   8,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   9,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch  10,  Average loss: 0.0000, Accuracy: 505/505 (100.0000%), train_poison_data_count: 505
Global model norm: 17.095570022795286.
Norm before scaling: 17.06422141757105. Distance: 1.0910568868699526
Total norm for 9 adversaries is: 17.06422141757105. distance: 1.0910568868699526
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1239, Accuracy: 8731/8991 (97.1082%)
poison local model 34 index 33 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   1,  Average loss: 0.0024, Accuracy: 516/528 (97.7273%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   2,  Average loss: 0.0020, Accuracy: 511/528 (96.7803%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   3,  Average loss: 0.0007, Accuracy: 519/528 (98.2955%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   4,  Average loss: 0.0003, Accuracy: 527/528 (99.8106%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   5,  Average loss: 0.0002, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   6,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   7,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   8,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch   9,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 34, internal_epoch  10,  Average loss: 0.0001, Accuracy: 528/528 (100.0000%), train_poison_data_count: 528
Global model norm: 17.095570022795286.
Norm before scaling: 17.053528827166076. Distance: 1.5663509977494299
Total norm for 9 adversaries is: 17.053528827166076. distance: 1.5663509977494299
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0843, Accuracy: 8769/8991 (97.5309%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 600/609 (98.5222%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   2,  Average loss: 0.0003, Accuracy: 603/609 (99.0148%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   3,  Average loss: 0.0001, Accuracy: 608/609 (99.8358%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   4,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   5,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   6,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 17.095570022795286.
Norm before scaling: 17.043460717314904. Distance: 1.1973669311079527
Total norm for 9 adversaries is: 17.043460717314904. distance: 1.1973669311079527
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0794, Accuracy: 8785/8991 (97.7088%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 503/512 (98.2422%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 509/512 (99.4141%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   3,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   6,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   7,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   8,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Global model norm: 17.095570022795286.
Norm before scaling: 17.05314676102698. Distance: 0.9706465092503036
Total norm for 9 adversaries is: 17.05314676102698. distance: 0.9706465092503036
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1028, Accuracy: 8747/8991 (97.2862%)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   1,  Average loss: 0.0018, Accuracy: 612/626 (97.7636%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   2,  Average loss: 0.0008, Accuracy: 616/626 (98.4026%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   3,  Average loss: 0.0004, Accuracy: 624/626 (99.6805%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   4,  Average loss: 0.0002, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch   9,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 73, internal_epoch  10,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Global model norm: 17.095570022795286.
Norm before scaling: 17.027696375248656. Distance: 1.4096634867708884
Total norm for 9 adversaries is: 17.027696375248656. distance: 1.4096634867708884
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1084, Accuracy: 8723/8991 (97.0192%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 526/535 (98.3178%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 532/535 (99.4393%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   3,  Average loss: 0.0003, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   5,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   6,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 17.095570022795286.
Norm before scaling: 17.030826220358392. Distance: 0.998472865617071
Total norm for 9 adversaries is: 17.030826220358392. distance: 0.998472865617071
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0875, Accuracy: 8775/8991 (97.5976%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   1,  Average loss: 0.0011, Accuracy: 552/563 (98.0462%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   2,  Average loss: 0.0007, Accuracy: 554/563 (98.4014%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   3,  Average loss: 0.0001, Accuracy: 562/563 (99.8224%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   6,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 17.095570022795286.
Norm before scaling: 17.045850966034227. Distance: 1.1210790759465392
Total norm for 9 adversaries is: 17.045850966034227. distance: 1.1210790759465392
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0831, Accuracy: 8802/8991 (97.8979%)
___Train Local_Simple,  epoch  39, local model 88, internal_epoch   1,  Average loss: 0.0055, Accuracy: 624/679 (91.8999%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3769, Accuracy: 8785/10000 (87.8500%), Attack Success Rate:0/10000(0.000)
poison local model 72 index 71 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0012, Accuracy: 519/529 (98.1096%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   2,  Average loss: 0.0007, Accuracy: 519/529 (98.1096%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   3,  Average loss: 0.0001, Accuracy: 527/529 (99.6219%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   4,  Average loss: 0.0001, Accuracy: 528/529 (99.8110%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   5,  Average loss: 0.0001, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   6,  Average loss: 0.0001, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   7,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   8,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch   9,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 72, internal_epoch  10,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Global model norm: 17.095570022795286.
Norm before scaling: 17.07267932676448. Distance: 1.4683787099788628
Total norm for 9 adversaries is: 17.07267932676448. distance: 1.4683787099788628
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0909, Accuracy: 8781/8991 (97.6643%)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 515/521 (98.8484%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   2,  Average loss: 0.0003, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   3,  Average loss: 0.0002, Accuracy: 519/521 (99.6161%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   4,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   7,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   8,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch   9,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  39, local model 13, internal_epoch  10,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 17.095570022795286.
Norm before scaling: 17.016788943776415. Distance: 0.9806671245856116
Total norm for 9 adversaries is: 17.016788943776415. distance: 0.9806671245856116
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0646, Accuracy: 8830/8991 (98.2093%)
time spent on training: 158.07416796684265
[foolsgold agg] training data poison_ratio: 0.8789013732833958  data num: [505, 528, 609, 512, 626, 535, 563, 679, 529, 521]
[foolsgold agg] considering poison per batch poison_fraction: 0.8789013732833958
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 1.1532, Accuracy: 8841/10000 (88.4100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.0746, Accuracy: 8829/8991 (98.1982%)
Done in 480.0466480255127 sec.
Server Epoch:40 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
poison local model 12 index 11 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0023, Accuracy: 578/597 (96.8174%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   2,  Average loss: 0.0012, Accuracy: 579/597 (96.9849%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   3,  Average loss: 0.0006, Accuracy: 590/597 (98.8275%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   4,  Average loss: 0.0003, Accuracy: 596/597 (99.8325%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   5,  Average loss: 0.0002, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   6,  Average loss: 0.0002, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   7,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   8,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch   9,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 12, internal_epoch  10,  Average loss: 0.0001, Accuracy: 597/597 (100.0000%), train_poison_data_count: 597
Global model norm: 17.107542174946644.
Norm before scaling: 17.118845481090972. Distance: 2.0065269065210707
Total norm for 6 adversaries is: 17.118845481090972. distance: 2.0065269065210707
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0743, Accuracy: 8793/8991 (97.7978%)
poison local model 23 index 22 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   1,  Average loss: 0.0024, Accuracy: 569/588 (96.7687%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   2,  Average loss: 0.0020, Accuracy: 572/588 (97.2789%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   3,  Average loss: 0.0006, Accuracy: 583/588 (99.1497%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   4,  Average loss: 0.0003, Accuracy: 586/588 (99.6599%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   5,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   6,  Average loss: 0.0002, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   7,  Average loss: 0.0001, Accuracy: 587/588 (99.8299%), train_poison_data_count: 588
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   8,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch   9,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 23, internal_epoch  10,  Average loss: 0.0001, Accuracy: 588/588 (100.0000%), train_poison_data_count: 588
Global model norm: 17.107542174946644.
Norm before scaling: 17.0546875. Distance: 1.7038771342186572
Total norm for 6 adversaries is: 17.0546875. distance: 1.7038771342186572
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0689, Accuracy: 8804/8991 (97.9201%)
___Train Local_Simple,  epoch  40, local model 87, internal_epoch   1,  Average loss: 0.0063, Accuracy: 521/575 (90.6087%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.3133, Accuracy: 9097/10000 (90.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 98, internal_epoch   1,  Average loss: 0.0059, Accuracy: 526/568 (92.6056%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4503, Accuracy: 8776/10000 (87.7600%), Attack Success Rate:0/10000(0.000)
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   1,  Average loss: 0.0012, Accuracy: 637/647 (98.4544%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 642/647 (99.2272%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 642/647 (99.2272%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Global model norm: 17.107542174946644.
Norm before scaling: 17.034707934510134. Distance: 1.068019108397743
Total norm for 6 adversaries is: 17.034707934510134. distance: 1.068019108397743
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0791, Accuracy: 8807/8991 (97.9535%)
___Train Local_Simple,  epoch  40, local model 83, internal_epoch   1,  Average loss: 0.0056, Accuracy: 514/555 (92.6126%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1613, Accuracy: 9495/10000 (94.9500%), Attack Success Rate:0/10000(0.000)
poison local model 52 index 51 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0020, Accuracy: 601/618 (97.2492%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   2,  Average loss: 0.0009, Accuracy: 607/618 (98.2201%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   3,  Average loss: 0.0006, Accuracy: 612/618 (99.0291%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   4,  Average loss: 0.0004, Accuracy: 614/618 (99.3528%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   5,  Average loss: 0.0002, Accuracy: 617/618 (99.8382%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   6,  Average loss: 0.0001, Accuracy: 617/618 (99.8382%), train_poison_data_count: 618
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   7,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   8,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   9,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch  10,  Average loss: 0.0001, Accuracy: 618/618 (100.0000%), train_poison_data_count: 618
Global model norm: 17.107542174946644.
Norm before scaling: 17.050048756459795. Distance: 1.5233787329660817
Total norm for 6 adversaries is: 17.050048756459795. distance: 1.5233787329660817
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0812, Accuracy: 8784/8991 (97.6977%)
___Train Local_Simple,  epoch  40, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 533/577 (92.3744%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2232, Accuracy: 9324/10000 (93.2400%), Attack Success Rate:0/10000(0.000)
poison local model 71 index 70 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   1,  Average loss: 0.0010, Accuracy: 627/638 (98.2759%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   2,  Average loss: 0.0009, Accuracy: 628/638 (98.4326%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   3,  Average loss: 0.0003, Accuracy: 634/638 (99.3730%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   4,  Average loss: 0.0002, Accuracy: 635/638 (99.5298%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   5,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   6,  Average loss: 0.0001, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   7,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   8,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch   9,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 71, internal_epoch  10,  Average loss: 0.0000, Accuracy: 638/638 (100.0000%), train_poison_data_count: 638
Global model norm: 17.107542174946644.
Norm before scaling: 17.050044281753806. Distance: 1.1316549240330809
Total norm for 6 adversaries is: 17.050044281753806. distance: 1.1316549240330809
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0658, Accuracy: 8822/8991 (98.1203%)
poison local model 11 index 10 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0022, Accuracy: 622/644 (96.5839%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   2,  Average loss: 0.0013, Accuracy: 625/644 (97.0497%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   3,  Average loss: 0.0004, Accuracy: 640/644 (99.3789%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   4,  Average loss: 0.0002, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   6,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   7,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   8,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch   9,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  40, local model 11, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 17.107542174946644.
Norm before scaling: 17.072039386335593. Distance: 1.7135880376074133
Total norm for 6 adversaries is: 17.072039386335593. distance: 1.7135880376074133
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.1008, Accuracy: 8734/8991 (97.1416%)
time spent on training: 127.28744602203369
[foolsgold agg] training data poison_ratio: 0.6212751789578824  data num: [597, 588, 575, 568, 647, 555, 618, 577, 638, 644]
[foolsgold agg] considering poison per batch poison_fraction: 0.6212751789578824
[foolsgold agg] wv: [1.         0.73776591 0.         0.         1.         0.
 1.         0.89152211 0.5997076  0.5997076 ]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 1.1648, Accuracy: 8835/10000 (88.3500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.0755, Accuracy: 8824/8991 (98.1426%)
Done in 452.2105441093445 sec.
Server Epoch:41 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   1,  Average loss: 0.0012, Accuracy: 640/647 (98.9181%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 643/647 (99.3818%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   3,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Global model norm: 17.121439097161563.
Norm before scaling: 17.036793105979115. Distance: 0.993009542112036
Total norm for 8 adversaries is: 17.036793105979115. distance: 0.993009542112036
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0712, Accuracy: 8818/8991 (98.0759%)
poison local model 28 index 27 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   1,  Average loss: 0.0020, Accuracy: 645/665 (96.9925%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   2,  Average loss: 0.0013, Accuracy: 652/665 (98.0451%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   3,  Average loss: 0.0005, Accuracy: 654/665 (98.3459%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   4,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   5,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 28, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 17.121439097161563.
Norm before scaling: 17.03705910820998. Distance: 1.5298688459592842
Total norm for 8 adversaries is: 17.03705910820998. distance: 1.5298688459592842
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0790, Accuracy: 8793/8991 (97.7978%)
poison local model 20 index 19 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   1,  Average loss: 0.0019, Accuracy: 541/553 (97.8300%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   2,  Average loss: 0.0012, Accuracy: 540/553 (97.6492%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   3,  Average loss: 0.0003, Accuracy: 548/553 (99.0958%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   4,  Average loss: 0.0002, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   5,  Average loss: 0.0001, Accuracy: 552/553 (99.8192%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   6,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   7,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   8,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch   9,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 20, internal_epoch  10,  Average loss: 0.0001, Accuracy: 553/553 (100.0000%), train_poison_data_count: 553
Global model norm: 17.121439097161563.
Norm before scaling: 17.045821425680014. Distance: 1.269178652582577
Total norm for 8 adversaries is: 17.045821425680014. distance: 1.269178652582577
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0617, Accuracy: 8829/8991 (98.1982%)
___Train Local_Simple,  epoch  41, local model 95, internal_epoch   1,  Average loss: 0.0060, Accuracy: 494/532 (92.8571%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2876, Accuracy: 9032/10000 (90.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 83, internal_epoch   1,  Average loss: 0.0064, Accuracy: 504/555 (90.8108%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2292, Accuracy: 9254/10000 (92.5400%), Attack Success Rate:0/10000(0.000)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   1,  Average loss: 0.0014, Accuracy: 506/516 (98.0620%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   2,  Average loss: 0.0003, Accuracy: 513/516 (99.4186%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   3,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   4,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   7,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   8,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch   9,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 18, internal_epoch  10,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 17.121439097161563.
Norm before scaling: 17.056853425508965. Distance: 1.0948120410498148
Total norm for 8 adversaries is: 17.056853425508965. distance: 1.0948120410498148
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0936, Accuracy: 8766/8991 (97.4975%)
poison local model 55 index 54 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   1,  Average loss: 0.0012, Accuracy: 578/592 (97.6351%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   2,  Average loss: 0.0004, Accuracy: 587/592 (99.1554%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   3,  Average loss: 0.0002, Accuracy: 590/592 (99.6622%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   4,  Average loss: 0.0001, Accuracy: 590/592 (99.6622%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   5,  Average loss: 0.0001, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   6,  Average loss: 0.0000, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   7,  Average loss: 0.0000, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   8,  Average loss: 0.0000, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch   9,  Average loss: 0.0000, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 55, internal_epoch  10,  Average loss: 0.0000, Accuracy: 592/592 (100.0000%), train_poison_data_count: 592
Global model norm: 17.121439097161563.
Norm before scaling: 17.072045642852547. Distance: 1.2685243340106538
Total norm for 8 adversaries is: 17.072045642852547. distance: 1.2685243340106538
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1110, Accuracy: 8728/8991 (97.0749%)
poison local model 42 index 41 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0019, Accuracy: 647/665 (97.2932%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   2,  Average loss: 0.0006, Accuracy: 655/665 (98.4962%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   3,  Average loss: 0.0002, Accuracy: 664/665 (99.8496%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   4,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   5,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   6,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   7,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   8,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   9,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch  10,  Average loss: 0.0001, Accuracy: 665/665 (100.0000%), train_poison_data_count: 665
Global model norm: 17.121439097161563.
Norm before scaling: 17.0726274889075. Distance: 1.5661209112919765
Total norm for 8 adversaries is: 17.0726274889075. distance: 1.5661209112919765
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0883, Accuracy: 8762/8991 (97.4530%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   1,  Average loss: 0.0015, Accuracy: 591/605 (97.6860%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   2,  Average loss: 0.0006, Accuracy: 596/605 (98.5124%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   3,  Average loss: 0.0003, Accuracy: 603/605 (99.6694%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   4,  Average loss: 0.0003, Accuracy: 603/605 (99.6694%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 603/605 (99.6694%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch   9,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 17.121439097161563.
Norm before scaling: 17.054026305609533. Distance: 1.167853410314059
Total norm for 8 adversaries is: 17.054026305609533. distance: 1.167853410314059
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0761, Accuracy: 8809/8991 (97.9758%)
poison local model 46 index 45 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   1,  Average loss: 0.0015, Accuracy: 467/478 (97.6987%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   2,  Average loss: 0.0012, Accuracy: 469/478 (98.1172%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   3,  Average loss: 0.0005, Accuracy: 475/478 (99.3724%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   4,  Average loss: 0.0004, Accuracy: 475/478 (99.3724%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   5,  Average loss: 0.0002, Accuracy: 476/478 (99.5816%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   6,  Average loss: 0.0001, Accuracy: 477/478 (99.7908%), train_poison_data_count: 478
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   7,  Average loss: 0.0001, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   8,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch   9,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  41, local model 46, internal_epoch  10,  Average loss: 0.0000, Accuracy: 478/478 (100.0000%), train_poison_data_count: 478
Global model norm: 17.121439097161563.
Norm before scaling: 17.09277698041906. Distance: 1.260862975535838
Total norm for 8 adversaries is: 17.09277698041906. distance: 1.260862975535838
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0745, Accuracy: 8795/8991 (97.8200%)
time spent on training: 150.359148979187
[foolsgold agg] training data poison_ratio: 0.8128443526170799  data num: [647, 665, 553, 532, 555, 516, 592, 665, 605, 478]
[foolsgold agg] considering poison per batch poison_fraction: 0.8128443526170799
[foolsgold agg] wv: [1.         0.79115487 1.         0.43026495 0.43026495 1.
 1.         0.79115487 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 1.0794, Accuracy: 8835/10000 (88.3500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.0717, Accuracy: 8830/8991 (98.2093%)
Done in 476.3214101791382 sec.
Server Epoch:42 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0046, Accuracy: 529/575 (92.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1773, Accuracy: 9398/10000 (93.9800%), Attack Success Rate:0/10000(0.000)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   1,  Average loss: 0.0015, Accuracy: 615/626 (98.2428%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 622/626 (99.3610%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   3,  Average loss: 0.0001, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   7,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   8,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch   9,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 73, internal_epoch  10,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Global model norm: 17.132898889716078.
Norm before scaling: 17.061254211331356. Distance: 1.1484598689593148
Total norm for 6 adversaries is: 17.061254211331356. distance: 1.1484598689593148
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0958, Accuracy: 8750/8991 (97.3195%)
___Train Local_Simple,  epoch  42, local model 89, internal_epoch   1,  Average loss: 0.0046, Accuracy: 622/664 (93.6747%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4432, Accuracy: 8517/10000 (85.1700%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   1,  Average loss: 0.0014, Accuracy: 575/589 (97.6231%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   2,  Average loss: 0.0006, Accuracy: 583/589 (98.9813%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   3,  Average loss: 0.0002, Accuracy: 588/589 (99.8302%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   4,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   7,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   8,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 17.132898889716078.
Norm before scaling: 17.090505790748082. Distance: 1.315539111235623
Total norm for 6 adversaries is: 17.090505790748082. distance: 1.315539111235623
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0789, Accuracy: 8785/8991 (97.7088%)
___Train Local_Simple,  epoch  42, local model 81, internal_epoch   1,  Average loss: 0.0054, Accuracy: 540/586 (92.1502%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4746, Accuracy: 8506/10000 (85.0600%), Attack Success Rate:0/10000(0.000)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0020, Accuracy: 556/572 (97.2028%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   2,  Average loss: 0.0012, Accuracy: 562/572 (98.2517%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   3,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   6,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.132898889716078.
Norm before scaling: 17.073884959417462. Distance: 1.3429201358076108
Total norm for 6 adversaries is: 17.073884959417462. distance: 1.3429201358076108
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0775, Accuracy: 8797/8991 (97.8423%)
___Train Local_Simple,  epoch  42, local model 92, internal_epoch   1,  Average loss: 0.0051, Accuracy: 531/571 (92.9947%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2941, Accuracy: 8982/10000 (89.8200%), Attack Success Rate:0/10000(0.000)
poison local model 62 index 61 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   1,  Average loss: 0.0022, Accuracy: 597/617 (96.7585%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   2,  Average loss: 0.0007, Accuracy: 609/617 (98.7034%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   3,  Average loss: 0.0002, Accuracy: 616/617 (99.8379%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   4,  Average loss: 0.0001, Accuracy: 616/617 (99.8379%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   5,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   6,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   7,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   8,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch   9,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 62, internal_epoch  10,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Global model norm: 17.132898889716078.
Norm before scaling: 17.05317718346881. Distance: 1.3944764113128874
Total norm for 6 adversaries is: 17.05317718346881. distance: 1.3944764113128874
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0732, Accuracy: 8791/8991 (97.7756%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   1,  Average loss: 0.0010, Accuracy: 515/526 (97.9087%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 524/526 (99.6198%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   3,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   5,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 17.132898889716078.
Norm before scaling: 17.07910600167369. Distance: 1.0175486613454274
Total norm for 6 adversaries is: 17.07910600167369. distance: 1.0175486613454274
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0814, Accuracy: 8806/8991 (97.9424%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   1,  Average loss: 0.0014, Accuracy: 591/605 (97.6860%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   2,  Average loss: 0.0006, Accuracy: 597/605 (98.6777%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   7,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   8,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  42, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 17.132898889716078.
Norm before scaling: 17.07033574083086. Distance: 1.1108828224000291
Total norm for 6 adversaries is: 17.07033574083086. distance: 1.1108828224000291
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0794, Accuracy: 8802/8991 (97.8979%)
time spent on training: 125.02187299728394
[foolsgold agg] training data poison_ratio: 0.5960209070982971  data num: [575, 626, 664, 589, 586, 572, 571, 617, 526, 605]
[foolsgold agg] considering poison per batch poison_fraction: 0.5960209070982971
[foolsgold agg] wv: [0. 1. 0. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 1.0279, Accuracy: 8837/10000 (88.3700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.0685, Accuracy: 8830/8991 (98.2093%)
Done in 450.2993280887604 sec.
Server Epoch:43 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   1,  Average loss: 0.0016, Accuracy: 752/774 (97.1576%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   2,  Average loss: 0.0006, Accuracy: 761/774 (98.3204%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   3,  Average loss: 0.0005, Accuracy: 766/774 (98.9664%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   4,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   5,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   6,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   7,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   8,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch   9,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 38, internal_epoch  10,  Average loss: 0.0001, Accuracy: 774/774 (100.0000%), train_poison_data_count: 774
Global model norm: 17.138374396456772.
Norm before scaling: 17.08103567659632. Distance: 1.5418868895630116
Total norm for 8 adversaries is: 17.08103567659632. distance: 1.5418868895630116
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0677, Accuracy: 8810/8991 (97.9869%)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   1,  Average loss: 0.0012, Accuracy: 612/624 (98.0769%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   2,  Average loss: 0.0006, Accuracy: 613/624 (98.2372%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   3,  Average loss: 0.0001, Accuracy: 623/624 (99.8397%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   4,  Average loss: 0.0001, Accuracy: 623/624 (99.8397%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   5,  Average loss: 0.0001, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   6,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   7,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   8,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch   9,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 78, internal_epoch  10,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Global model norm: 17.138374396456772.
Norm before scaling: 17.08746278056938. Distance: 1.1892176803806593
Total norm for 8 adversaries is: 17.08746278056938. distance: 1.1892176803806593
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0843, Accuracy: 8780/8991 (97.6532%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 518/526 (98.4791%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   2,  Average loss: 0.0007, Accuracy: 520/526 (98.8593%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   4,  Average loss: 0.0002, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   6,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 17.138374396456772.
Norm before scaling: 17.084921166045806. Distance: 0.9508103892015124
Total norm for 8 adversaries is: 17.084921166045806. distance: 0.9508103892015124
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0749, Accuracy: 8811/8991 (97.9980%)
poison local model 18 index 17 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   1,  Average loss: 0.0013, Accuracy: 510/516 (98.8372%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   2,  Average loss: 0.0002, Accuracy: 513/516 (99.4186%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   3,  Average loss: 0.0002, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   4,  Average loss: 0.0001, Accuracy: 515/516 (99.8062%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   5,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   6,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   7,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   8,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch   9,  Average loss: 0.0001, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 18, internal_epoch  10,  Average loss: 0.0000, Accuracy: 516/516 (100.0000%), train_poison_data_count: 516
Global model norm: 17.138374396456772.
Norm before scaling: 17.078660180029402. Distance: 0.9570982306260285
Total norm for 8 adversaries is: 17.078660180029402. distance: 0.9570982306260285
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0881, Accuracy: 8783/8991 (97.6866%)
poison local model 72 index 71 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 524/529 (99.0548%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   2,  Average loss: 0.0009, Accuracy: 525/529 (99.2439%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   3,  Average loss: 0.0001, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   4,  Average loss: 0.0001, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   5,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   6,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   7,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   8,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch   9,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 72, internal_epoch  10,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Global model norm: 17.138374396456772.
Norm before scaling: 17.084849716744657. Distance: 0.9101924970882966
Total norm for 8 adversaries is: 17.084849716744657. distance: 0.9101924970882966
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0702, Accuracy: 8811/8991 (97.9980%)
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   1,  Average loss: 0.0015, Accuracy: 541/554 (97.6534%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   2,  Average loss: 0.0006, Accuracy: 547/554 (98.7365%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   3,  Average loss: 0.0003, Accuracy: 552/554 (99.6390%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   4,  Average loss: 0.0002, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   5,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   6,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   7,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   8,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch   9,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 75, internal_epoch  10,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 17.138374396456772.
Norm before scaling: 17.083536782642703. Distance: 1.161589023553071
Total norm for 8 adversaries is: 17.083536782642703. distance: 1.161589023553071
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0633, Accuracy: 8834/8991 (98.2538%)
___Train Local_Simple,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0046, Accuracy: 485/529 (91.6824%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1662, Accuracy: 9481/10000 (94.8100%), Attack Success Rate:0/10000(0.000)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 495/503 (98.4095%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   2,  Average loss: 0.0010, Accuracy: 494/503 (98.2107%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   4,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   5,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   6,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 17.138374396456772.
Norm before scaling: 17.102935610419067. Distance: 0.9816759132755024
Total norm for 8 adversaries is: 17.102935610419067. distance: 0.9816759132755024
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0660, Accuracy: 8824/8991 (98.1426%)
poison local model 44 index 43 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   1,  Average loss: 0.0015, Accuracy: 506/518 (97.6834%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   2,  Average loss: 0.0004, Accuracy: 512/518 (98.8417%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   3,  Average loss: 0.0002, Accuracy: 517/518 (99.8069%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   4,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   5,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   6,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   7,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   8,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  43, local model 44, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 17.138374396456772.
Norm before scaling: 17.092677889996402. Distance: 1.1648210447824605
Total norm for 8 adversaries is: 17.092677889996402. distance: 1.1648210447824605
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0678, Accuracy: 8818/8991 (98.0759%)
___Train Local_Simple,  epoch  43, local model 90, internal_epoch   1,  Average loss: 0.0048, Accuracy: 535/577 (92.7210%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.3153, Accuracy: 8946/10000 (89.4600%), Attack Success Rate:0/10000(0.000)
time spent on training: 147.76486802101135
[foolsgold agg] training data poison_ratio: 0.8042477876106194  data num: [774, 624, 526, 516, 529, 554, 529, 503, 518, 577]
[foolsgold agg] considering poison per batch poison_fraction: 0.8042477876106194
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 0. 1. 1. 0.]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 1.1918, Accuracy: 8833/10000 (88.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.0735, Accuracy: 8820/8991 (98.0981%)
Done in 472.85888290405273 sec.
Server Epoch:44 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   1,  Average loss: 0.0017, Accuracy: 498/511 (97.4560%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   2,  Average loss: 0.0007, Accuracy: 508/511 (99.4129%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   3,  Average loss: 0.0006, Accuracy: 507/511 (99.2172%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   4,  Average loss: 0.0004, Accuracy: 509/511 (99.6086%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   5,  Average loss: 0.0002, Accuracy: 510/511 (99.8043%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   6,  Average loss: 0.0001, Accuracy: 510/511 (99.8043%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   7,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   8,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch   9,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 31, internal_epoch  10,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Global model norm: 17.15522360033071.
Norm before scaling: 17.117924697441147. Distance: 1.3587544219533774
Total norm for 10 adversaries is: 17.117924697441147. distance: 1.3587544219533774
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0992, Accuracy: 8749/8991 (97.3084%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 589/606 (97.1947%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   2,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   3,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   4,  Average loss: 0.0001, Accuracy: 604/606 (99.6700%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   8,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   9,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch  10,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 17.15522360033071.
Norm before scaling: 17.080664052449958. Distance: 1.3652667695269256
Total norm for 10 adversaries is: 17.080664052449958. distance: 1.3652667695269256
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0767, Accuracy: 8790/8991 (97.7644%)
poison local model 38 index 37 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   1,  Average loss: 0.0020, Accuracy: 758/774 (97.9328%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   2,  Average loss: 0.0070, Accuracy: 704/774 (90.9561%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   3,  Average loss: 0.0021, Accuracy: 744/774 (96.1240%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   4,  Average loss: 0.0013, Accuracy: 755/774 (97.5452%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   5,  Average loss: 0.0009, Accuracy: 761/774 (98.3204%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   6,  Average loss: 0.0009, Accuracy: 765/774 (98.8372%), train_poison_data_count: 774
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   7,  Average loss: 0.0006, Accuracy: 769/774 (99.3540%), train_poison_data_count: 774
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   8,  Average loss: 0.0005, Accuracy: 771/774 (99.6124%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch   9,  Average loss: 0.0004, Accuracy: 771/774 (99.6124%), train_poison_data_count: 774
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 38, internal_epoch  10,  Average loss: 0.0004, Accuracy: 771/774 (99.6124%), train_poison_data_count: 774
Global model norm: 17.15522360033071.
Norm before scaling: 18.06455776016431. Distance: 5.9388866210844355
Total norm for 10 adversaries is: 18.06455776016431. distance: 5.9388866210844355
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1026, Accuracy: 8719/8991 (96.9748%)
poison local model 9 index 8 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0018, Accuracy: 530/548 (96.7153%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   2,  Average loss: 0.0008, Accuracy: 540/548 (98.5401%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   3,  Average loss: 0.0003, Accuracy: 544/548 (99.2701%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   4,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   5,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   6,  Average loss: 0.0001, Accuracy: 547/548 (99.8175%), train_poison_data_count: 548
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   7,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   8,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch   9,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 9, internal_epoch  10,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%), train_poison_data_count: 548
Global model norm: 17.15522360033071.
Norm before scaling: 17.097380927215504. Distance: 1.2648120671168945
Total norm for 10 adversaries is: 17.097380927215504. distance: 1.2648120671168945
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0808, Accuracy: 8777/8991 (97.6198%)
poison local model 6 index 5 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 693/708 (97.8814%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   2,  Average loss: 0.0003, Accuracy: 703/708 (99.2938%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   3,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   4,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   5,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   6,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   7,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   8,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch   9,  Average loss: 0.0001, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 6, internal_epoch  10,  Average loss: 0.0000, Accuracy: 708/708 (100.0000%), train_poison_data_count: 708
Global model norm: 17.15522360033071.
Norm before scaling: 17.07957950690861. Distance: 1.2287374760095242
Total norm for 10 adversaries is: 17.07957950690861. distance: 1.2287374760095242
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0651, Accuracy: 8820/8991 (98.0981%)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   1,  Average loss: 0.0007, Accuracy: 544/552 (98.5507%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   2,  Average loss: 0.0003, Accuracy: 548/552 (99.2754%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   3,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   4,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   5,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   6,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   7,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   8,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch   9,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 19, internal_epoch  10,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Global model norm: 17.15522360033071.
Norm before scaling: 17.113545617536875. Distance: 0.9987460559580896
Total norm for 10 adversaries is: 17.113545617536875. distance: 0.9987460559580896
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.1015, Accuracy: 8758/8991 (97.4085%)
poison local model 65 index 64 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   1,  Average loss: 0.0016, Accuracy: 558/573 (97.3822%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   2,  Average loss: 0.0006, Accuracy: 565/573 (98.6038%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   3,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   4,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   5,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   6,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   7,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   8,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch   9,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 65, internal_epoch  10,  Average loss: 0.0001, Accuracy: 573/573 (100.0000%), train_poison_data_count: 573
Global model norm: 17.15522360033071.
Norm before scaling: 17.10851346289783. Distance: 1.2552904231452275
Total norm for 10 adversaries is: 17.10851346289783. distance: 1.2552904231452275
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0701, Accuracy: 8802/8991 (97.8979%)
poison local model 66 index 65 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   1,  Average loss: 0.0015, Accuracy: 617/629 (98.0922%), train_poison_data_count: 629
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   2,  Average loss: 0.0006, Accuracy: 620/629 (98.5692%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   3,  Average loss: 0.0003, Accuracy: 627/629 (99.6820%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   4,  Average loss: 0.0002, Accuracy: 628/629 (99.8410%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   5,  Average loss: 0.0001, Accuracy: 628/629 (99.8410%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   6,  Average loss: 0.0001, Accuracy: 628/629 (99.8410%), train_poison_data_count: 629
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   7,  Average loss: 0.0001, Accuracy: 629/629 (100.0000%), train_poison_data_count: 629
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   8,  Average loss: 0.0001, Accuracy: 629/629 (100.0000%), train_poison_data_count: 629
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch   9,  Average loss: 0.0001, Accuracy: 629/629 (100.0000%), train_poison_data_count: 629
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 66, internal_epoch  10,  Average loss: 0.0001, Accuracy: 629/629 (100.0000%), train_poison_data_count: 629
Global model norm: 17.15522360033071.
Norm before scaling: 17.089767410543782. Distance: 1.2770961323149115
Total norm for 10 adversaries is: 17.089767410543782. distance: 1.2770961323149115
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0646, Accuracy: 8828/8991 (98.1871%)
poison local model 73 index 72 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   1,  Average loss: 0.0016, Accuracy: 616/626 (98.4026%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 621/626 (99.2013%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   3,  Average loss: 0.0002, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   4,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   5,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   6,  Average loss: 0.0001, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   7,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   8,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch   9,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 73, internal_epoch  10,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Global model norm: 17.15522360033071.
Norm before scaling: 17.071800743191517. Distance: 1.1100281417990885
Total norm for 10 adversaries is: 17.071800743191517. distance: 1.1100281417990885
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0776, Accuracy: 8790/8991 (97.7644%)
poison local model 15 index 14 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   1,  Average loss: 0.0015, Accuracy: 558/572 (97.5524%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   2,  Average loss: 0.0005, Accuracy: 568/572 (99.3007%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   3,  Average loss: 0.0002, Accuracy: 571/572 (99.8252%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   4,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   6,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   7,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   8,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch   9,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  44, local model 15, internal_epoch  10,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.15522360033071.
Norm before scaling: 17.088601294121563. Distance: 1.2340011513424887
Total norm for 10 adversaries is: 17.088601294121563. distance: 1.2340011513424887
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0727, Accuracy: 8804/8991 (97.9201%)
time spent on training: 176.89222693443298
[foolsgold agg] training data poison_ratio: 1.0  data num: [511, 606, 774, 548, 708, 552, 573, 629, 626, 572]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 1.3344, Accuracy: 8842/10000 (88.4200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.0723, Accuracy: 8827/8991 (98.1760%)
Done in 501.0667099952698 sec.
Server Epoch:45 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
poison local model 53 index 52 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0016, Accuracy: 604/617 (97.8930%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   2,  Average loss: 0.0013, Accuracy: 604/617 (97.8930%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   3,  Average loss: 0.0003, Accuracy: 614/617 (99.5138%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   4,  Average loss: 0.0002, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   5,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   6,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   7,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   8,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch   9,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 53, internal_epoch  10,  Average loss: 0.0001, Accuracy: 617/617 (100.0000%), train_poison_data_count: 617
Global model norm: 17.191819414627304.
Norm before scaling: 17.14395317933511. Distance: 1.4813506788330706
Total norm for 9 adversaries is: 17.14395317933511. distance: 1.4813506788330706
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0632, Accuracy: 8815/8991 (98.0425%)
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   1,  Average loss: 0.0015, Accuracy: 539/554 (97.2924%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   2,  Average loss: 0.0006, Accuracy: 547/554 (98.7365%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   3,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   4,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   5,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   6,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   7,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   8,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch   9,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 75, internal_epoch  10,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 17.191819414627304.
Norm before scaling: 17.146187032000093. Distance: 1.2514204537581886
Total norm for 9 adversaries is: 17.146187032000093. distance: 1.2514204537581886
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0655, Accuracy: 8821/8991 (98.1092%)
poison local model 1 index 0 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 587/606 (96.8647%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0005, Accuracy: 599/606 (98.8449%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   3,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   4,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   5,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   6,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   7,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   8,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   9,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch  10,  Average loss: 0.0000, Accuracy: 606/606 (100.0000%), train_poison_data_count: 606
Global model norm: 17.191819414627304.
Norm before scaling: 17.132637938007203. Distance: 1.4348141831038648
Total norm for 9 adversaries is: 17.132637938007203. distance: 1.4348141831038648
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0781, Accuracy: 8782/8991 (97.6755%)
poison local model 37 index 36 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 632/641 (98.5959%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   2,  Average loss: 0.0003, Accuracy: 637/641 (99.3760%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   3,  Average loss: 0.0001, Accuracy: 639/641 (99.6880%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   4,  Average loss: 0.0001, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   5,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   6,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   7,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   8,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch   9,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 37, internal_epoch  10,  Average loss: 0.0000, Accuracy: 641/641 (100.0000%), train_poison_data_count: 641
Global model norm: 17.191819414627304.
Norm before scaling: 17.127247906467908. Distance: 1.014212932508278
Total norm for 9 adversaries is: 17.127247906467908. distance: 1.014212932508278
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0959, Accuracy: 8763/8991 (97.4641%)
___Train Local_Simple,  epoch  45, local model 94, internal_epoch   1,  Average loss: 0.0059, Accuracy: 513/555 (92.4324%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2626, Accuracy: 9036/10000 (90.3600%), Attack Success Rate:0/10000(0.000)
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   1,  Average loss: 0.0010, Accuracy: 637/647 (98.4544%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   2,  Average loss: 0.0006, Accuracy: 639/647 (98.7635%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   3,  Average loss: 0.0003, Accuracy: 645/647 (99.6909%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   4,  Average loss: 0.0002, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   5,  Average loss: 0.0001, Accuracy: 646/647 (99.8454%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   6,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   7,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Global model norm: 17.191819414627304.
Norm before scaling: 17.12637301321826. Distance: 1.1671008199144193
Total norm for 9 adversaries is: 17.12637301321826. distance: 1.1671008199144193
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0784, Accuracy: 8806/8991 (97.9424%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   1,  Average loss: 0.0013, Accuracy: 591/605 (97.6860%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   2,  Average loss: 0.0010, Accuracy: 595/605 (98.3471%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   3,  Average loss: 0.0006, Accuracy: 598/605 (98.8430%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   4,  Average loss: 0.0004, Accuracy: 603/605 (99.6694%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   5,  Average loss: 0.0002, Accuracy: 603/605 (99.6694%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 604/605 (99.8347%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   8,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 29, internal_epoch  10,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 17.191819414627304.
Norm before scaling: 17.144747965849483. Distance: 1.2792802416469957
Total norm for 9 adversaries is: 17.144747965849483. distance: 1.2792802416469957
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0863, Accuracy: 8797/8991 (97.8423%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   1,  Average loss: 0.0009, Accuracy: 494/503 (98.2107%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   3,  Average loss: 0.0001, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   4,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   5,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 17.191819414627304.
Norm before scaling: 17.145060352253704. Distance: 0.8682784014866722
Total norm for 9 adversaries is: 17.145060352253704. distance: 0.8682784014866722
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0782, Accuracy: 8805/8991 (97.9313%)
poison local model 60 index 59 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   1,  Average loss: 0.0014, Accuracy: 630/644 (97.8261%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   2,  Average loss: 0.0010, Accuracy: 633/644 (98.2919%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   3,  Average loss: 0.0005, Accuracy: 635/644 (98.6025%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   4,  Average loss: 0.0003, Accuracy: 642/644 (99.6894%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   5,  Average loss: 0.0001, Accuracy: 643/644 (99.8447%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   6,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   7,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   8,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch   9,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 60, internal_epoch  10,  Average loss: 0.0001, Accuracy: 644/644 (100.0000%), train_poison_data_count: 644
Global model norm: 17.191819414627304.
Norm before scaling: 17.114041351386092. Distance: 1.326119198546519
Total norm for 9 adversaries is: 17.114041351386092. distance: 1.326119198546519
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0846, Accuracy: 8764/8991 (97.4753%)
poison local model 5 index 4 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 505/512 (98.6328%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 510/512 (99.6094%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   3,  Average loss: 0.0001, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   4,  Average loss: 0.0001, Accuracy: 511/512 (99.8047%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   5,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   6,  Average loss: 0.0001, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   7,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   8,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   9,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch  10,  Average loss: 0.0000, Accuracy: 512/512 (100.0000%), train_poison_data_count: 512
Global model norm: 17.191819414627304.
Norm before scaling: 17.140822625911767. Distance: 0.8619248448952384
Total norm for 9 adversaries is: 17.140822625911767. distance: 0.8619248448952384
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0897, Accuracy: 8790/8991 (97.7644%)
time spent on training: 162.62496304512024
[foolsgold agg] training data poison_ratio: 0.9056764106050306  data num: [617, 554, 606, 641, 555, 647, 605, 503, 644, 512]
[foolsgold agg] considering poison per batch poison_fraction: 0.9056764106050306
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 1.1897, Accuracy: 8852/10000 (88.5200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.0678, Accuracy: 8841/8991 (98.3317%)
Done in 486.56845331192017 sec.
Server Epoch:46 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   1,  Average loss: 0.0015, Accuracy: 538/554 (97.1119%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   2,  Average loss: 0.0005, Accuracy: 550/554 (99.2780%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   3,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   4,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   5,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   6,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   7,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   8,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch   9,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 75, internal_epoch  10,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 17.205542731445405.
Norm before scaling: 17.16107610142745. Distance: 1.2718139315104124
Total norm for 10 adversaries is: 17.16107610142745. distance: 1.2718139315104124
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0677, Accuracy: 8822/8991 (98.1203%)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   1,  Average loss: 0.0013, Accuracy: 609/624 (97.5962%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   2,  Average loss: 0.0009, Accuracy: 613/624 (98.2372%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   3,  Average loss: 0.0003, Accuracy: 620/624 (99.3590%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   4,  Average loss: 0.0001, Accuracy: 623/624 (99.8397%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   5,  Average loss: 0.0001, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   6,  Average loss: 0.0001, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   7,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   8,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch   9,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 78, internal_epoch  10,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Global model norm: 17.205542731445405.
Norm before scaling: 17.15496565661638. Distance: 1.2276231104225723
Total norm for 10 adversaries is: 17.15496565661638. distance: 1.2276231104225723
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0835, Accuracy: 8777/8991 (97.6198%)
poison local model 14 index 13 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 527/535 (98.5047%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   3,  Average loss: 0.0001, Accuracy: 534/535 (99.8131%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   4,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   5,  Average loss: 0.0001, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   6,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   7,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   8,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch   9,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 14, internal_epoch  10,  Average loss: 0.0000, Accuracy: 535/535 (100.0000%), train_poison_data_count: 535
Global model norm: 17.205542731445405.
Norm before scaling: 17.14756368787378. Distance: 0.9815487024308488
Total norm for 10 adversaries is: 17.14756368787378. distance: 0.9815487024308488
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0841, Accuracy: 8781/8991 (97.6643%)
poison local model 39 index 38 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 493/503 (98.0119%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   2,  Average loss: 0.0006, Accuracy: 498/503 (99.0060%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   3,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   4,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   5,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   6,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   7,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   8,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch   9,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 39, internal_epoch  10,  Average loss: 0.0000, Accuracy: 503/503 (100.0000%), train_poison_data_count: 503
Global model norm: 17.205542731445405.
Norm before scaling: 17.166718615604548. Distance: 0.9906413128108392
Total norm for 10 adversaries is: 17.166718615604548. distance: 0.9906413128108392
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0731, Accuracy: 8818/8991 (98.0759%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0016, Accuracy: 535/550 (97.2727%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 547/550 (99.4545%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   3,  Average loss: 0.0003, Accuracy: 548/550 (99.6364%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   4,  Average loss: 0.0002, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   5,  Average loss: 0.0002, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   6,  Average loss: 0.0001, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   7,  Average loss: 0.0001, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   8,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 7, internal_epoch  10,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Global model norm: 17.205542731445405.
Norm before scaling: 17.153051415172826. Distance: 1.2372540084949675
Total norm for 10 adversaries is: 17.153051415172826. distance: 1.2372540084949675
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0718, Accuracy: 8811/8991 (97.9980%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 563/572 (98.4266%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   2,  Average loss: 0.0007, Accuracy: 564/572 (98.6014%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   3,  Average loss: 0.0002, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   4,  Average loss: 0.0002, Accuracy: 570/572 (99.6503%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   5,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.205542731445405.
Norm before scaling: 17.137496509732504. Distance: 1.0530869949682469
Total norm for 10 adversaries is: 17.137496509732504. distance: 1.0530869949682469
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0775, Accuracy: 8803/8991 (97.9090%)
poison local model 40 index 39 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   1,  Average loss: 0.0010, Accuracy: 555/563 (98.5790%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   2,  Average loss: 0.0006, Accuracy: 555/563 (98.5790%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   3,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   4,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   5,  Average loss: 0.0001, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   6,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   7,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   8,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch   9,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 40, internal_epoch  10,  Average loss: 0.0000, Accuracy: 563/563 (100.0000%), train_poison_data_count: 563
Global model norm: 17.205542731445405.
Norm before scaling: 17.151244609368458. Distance: 0.9290762743296087
Total norm for 10 adversaries is: 17.151244609368458. distance: 0.9290762743296087
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0679, Accuracy: 8828/8991 (98.1871%)
poison local model 2 index 1 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0011, Accuracy: 572/580 (98.6207%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   2,  Average loss: 0.0024, Accuracy: 559/580 (96.3793%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   3,  Average loss: 0.0012, Accuracy: 565/580 (97.4138%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   4,  Average loss: 0.0003, Accuracy: 577/580 (99.4828%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   5,  Average loss: 0.0002, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   6,  Average loss: 0.0001, Accuracy: 579/580 (99.8276%), train_poison_data_count: 580
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   7,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   8,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   9,  Average loss: 0.0000, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch  10,  Average loss: 0.0001, Accuracy: 580/580 (100.0000%), train_poison_data_count: 580
Global model norm: 17.205542731445405.
Norm before scaling: 17.288946000511245. Distance: 2.2584826257023463
Total norm for 10 adversaries is: 17.288946000511245. distance: 2.2584826257023463
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0872, Accuracy: 8806/8991 (97.9424%)
poison local model 68 index 67 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   1,  Average loss: 0.0009, Accuracy: 627/632 (99.2089%), train_poison_data_count: 632
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   2,  Average loss: 0.0005, Accuracy: 625/632 (98.8924%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   3,  Average loss: 0.0001, Accuracy: 631/632 (99.8418%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   4,  Average loss: 0.0001, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   5,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   6,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   7,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   8,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch   9,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 68, internal_epoch  10,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Global model norm: 17.205542731445405.
Norm before scaling: 17.11967708532668. Distance: 0.9272362586489662
Total norm for 10 adversaries is: 17.11967708532668. distance: 0.9272362586489662
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0630, Accuracy: 8838/8991 (98.2983%)
poison local model 54 index 53 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   1,  Average loss: 0.0015, Accuracy: 513/523 (98.0880%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   2,  Average loss: 0.0002, Accuracy: 522/523 (99.8088%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   3,  Average loss: 0.0002, Accuracy: 521/523 (99.6176%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   4,  Average loss: 0.0001, Accuracy: 522/523 (99.8088%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   5,  Average loss: 0.0001, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   6,  Average loss: 0.0000, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   7,  Average loss: 0.0000, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   8,  Average loss: 0.0000, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch   9,  Average loss: 0.0000, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  46, local model 54, internal_epoch  10,  Average loss: 0.0000, Accuracy: 523/523 (100.0000%), train_poison_data_count: 523
Global model norm: 17.205542731445405.
Norm before scaling: 17.133077011467012. Distance: 1.0258080205162388
Total norm for 10 adversaries is: 17.133077011467012. distance: 1.0258080205162388
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0694, Accuracy: 8824/8991 (98.1426%)
time spent on training: 172.3515009880066
[foolsgold agg] training data poison_ratio: 1.0  data num: [554, 624, 535, 503, 550, 572, 563, 580, 632, 523]
[foolsgold agg] considering poison per batch poison_fraction: 1.0
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 1.2089, Accuracy: 8851/10000 (88.5100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.0668, Accuracy: 8840/8991 (98.3205%)
Done in 497.05150294303894 sec.
Server Epoch:47 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  47, local model 94, internal_epoch   1,  Average loss: 0.0052, Accuracy: 516/555 (92.9730%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2410, Accuracy: 9184/10000 (91.8400%), Attack Success Rate:0/10000(0.000)
poison local model 48 index 47 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   1,  Average loss: 0.0013, Accuracy: 580/589 (98.4720%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   2,  Average loss: 0.0008, Accuracy: 581/589 (98.6418%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   3,  Average loss: 0.0002, Accuracy: 587/589 (99.6604%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   4,  Average loss: 0.0002, Accuracy: 588/589 (99.8302%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   5,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   6,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   7,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   8,  Average loss: 0.0001, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch   9,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 48, internal_epoch  10,  Average loss: 0.0000, Accuracy: 589/589 (100.0000%), train_poison_data_count: 589
Global model norm: 17.222012579404193.
Norm before scaling: 17.17773071080831. Distance: 1.3606986255552744
Total norm for 7 adversaries is: 17.17773071080831. distance: 1.3606986255552744
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0834, Accuracy: 8772/8991 (97.5642%)
___Train Local_Simple,  epoch  47, local model 82, internal_epoch   1,  Average loss: 0.0055, Accuracy: 580/621 (93.3977%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1528, Accuracy: 9534/10000 (95.3400%), Attack Success Rate:0/10000(0.000)
poison local model 25 index 24 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 571/582 (98.1100%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   2,  Average loss: 0.0004, Accuracy: 576/582 (98.9691%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   3,  Average loss: 0.0001, Accuracy: 581/582 (99.8282%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   4,  Average loss: 0.0001, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   5,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   6,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   7,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   8,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch   9,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 25, internal_epoch  10,  Average loss: 0.0000, Accuracy: 582/582 (100.0000%), train_poison_data_count: 582
Global model norm: 17.222012579404193.
Norm before scaling: 17.180412245967972. Distance: 1.1625261857559852
Total norm for 7 adversaries is: 17.180412245967972. distance: 1.1625261857559852
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0676, Accuracy: 8823/8991 (98.1315%)
poison local model 26 index 25 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   1,  Average loss: 0.0006, Accuracy: 520/526 (98.8593%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   2,  Average loss: 0.0004, Accuracy: 519/526 (98.6692%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   3,  Average loss: 0.0002, Accuracy: 524/526 (99.6198%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   4,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   5,  Average loss: 0.0001, Accuracy: 525/526 (99.8099%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   6,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   7,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   8,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch   9,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 26, internal_epoch  10,  Average loss: 0.0000, Accuracy: 526/526 (100.0000%), train_poison_data_count: 526
Global model norm: 17.222012579404193.
Norm before scaling: 17.178834818539244. Distance: 0.9432104399893586
Total norm for 7 adversaries is: 17.178834818539244. distance: 0.9432104399893586
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0819, Accuracy: 8808/8991 (97.9646%)
poison local model 16 index 15 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   1,  Average loss: 0.0009, Accuracy: 571/581 (98.2788%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   2,  Average loss: 0.0005, Accuracy: 575/581 (98.9673%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   3,  Average loss: 0.0002, Accuracy: 578/581 (99.4836%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   4,  Average loss: 0.0001, Accuracy: 579/581 (99.6558%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   5,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   6,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   7,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   8,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch   9,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 16, internal_epoch  10,  Average loss: 0.0000, Accuracy: 581/581 (100.0000%), train_poison_data_count: 581
Global model norm: 17.222012579404193.
Norm before scaling: 17.179475221801287. Distance: 1.003098931374911
Total norm for 7 adversaries is: 17.179475221801287. distance: 1.003098931374911
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0684, Accuracy: 8827/8991 (98.1760%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 543/550 (98.7273%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   2,  Average loss: 0.0005, Accuracy: 544/550 (98.9091%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   3,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   4,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Global model norm: 17.222012579404193.
Norm before scaling: 17.16129394205533. Distance: 1.0566765008783647
Total norm for 7 adversaries is: 17.16129394205533. distance: 1.0566765008783647
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0716, Accuracy: 8819/8991 (98.0870%)
___Train Local_Simple,  epoch  47, local model 90, internal_epoch   1,  Average loss: 0.0073, Accuracy: 521/577 (90.2946%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.2192, Accuracy: 7301/10000 (73.0100%), Attack Success Rate:0/10000(0.000)
poison local model 68 index 67 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   1,  Average loss: 0.0010, Accuracy: 626/632 (99.0506%), train_poison_data_count: 632
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   2,  Average loss: 0.0004, Accuracy: 627/632 (99.2089%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   3,  Average loss: 0.0001, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   4,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   5,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   6,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   7,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   8,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch   9,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 68, internal_epoch  10,  Average loss: 0.0000, Accuracy: 632/632 (100.0000%), train_poison_data_count: 632
Global model norm: 17.222012579404193.
Norm before scaling: 17.13460432946567. Distance: 0.895549278172857
Total norm for 7 adversaries is: 17.13460432946567. distance: 0.895549278172857
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0593, Accuracy: 8846/8991 (98.3873%)
poison local model 43 index 42 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0013, Accuracy: 504/518 (97.2973%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 515/518 (99.4208%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   3,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   4,  Average loss: 0.0001, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   5,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   6,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   7,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   8,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch   9,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  47, local model 43, internal_epoch  10,  Average loss: 0.0000, Accuracy: 518/518 (100.0000%), train_poison_data_count: 518
Global model norm: 17.222012579404193.
Norm before scaling: 17.20371660398515. Distance: 1.1740810229759564
Total norm for 7 adversaries is: 17.20371660398515. distance: 1.1740810229759564
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0663, Accuracy: 8820/8991 (98.0981%)
time spent on training: 136.83145713806152
[foolsgold agg] training data poison_ratio: 0.6941196998778573  data num: [555, 589, 621, 582, 526, 581, 550, 577, 632, 518]
[foolsgold agg] considering poison per batch poison_fraction: 0.6941196998778573
[foolsgold agg] wv: [0.         1.         0.         1.         1.         1.
 1.         0.20791856 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 1.2294, Accuracy: 8851/10000 (88.5100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.0653, Accuracy: 8841/8991 (98.3317%)
Done in 459.4713759422302 sec.
Server Epoch:48 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
poison local model 74 index 73 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   1,  Average loss: 0.0007, Accuracy: 615/626 (98.2428%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 621/626 (99.2013%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   3,  Average loss: 0.0002, Accuracy: 623/626 (99.5208%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   4,  Average loss: 0.0001, Accuracy: 625/626 (99.8403%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Global model norm: 17.23269360140096.
Norm before scaling: 17.180112936694513. Distance: 1.0160418901931447
Total norm for 7 adversaries is: 17.180112936694513. distance: 1.0160418901931447
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0714, Accuracy: 8798/8991 (97.8534%)
poison local model 27 index 26 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   1,  Average loss: 0.0013, Accuracy: 640/650 (98.4615%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   2,  Average loss: 0.0006, Accuracy: 644/650 (99.0769%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   3,  Average loss: 0.0002, Accuracy: 648/650 (99.6923%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   4,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   5,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   6,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   7,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   8,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch   9,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 27, internal_epoch  10,  Average loss: 0.0001, Accuracy: 650/650 (100.0000%), train_poison_data_count: 650
Global model norm: 17.23269360140096.
Norm before scaling: 17.16524037975938. Distance: 1.2989603305159905
Total norm for 7 adversaries is: 17.16524037975938. distance: 1.2989603305159905
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0569, Accuracy: 8843/8991 (98.3539%)
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   1,  Average loss: 0.0012, Accuracy: 542/554 (97.8339%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   3,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   4,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   5,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   6,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   7,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   8,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch   9,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 75, internal_epoch  10,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 17.23269360140096.
Norm before scaling: 17.185778500435053. Distance: 1.0713821968759967
Total norm for 7 adversaries is: 17.185778500435053. distance: 1.0713821968759967
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0682, Accuracy: 8826/8991 (98.1648%)
poison local model 19 index 18 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0008, Accuracy: 547/552 (99.0942%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   2,  Average loss: 0.0006, Accuracy: 546/552 (98.9130%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   3,  Average loss: 0.0002, Accuracy: 549/552 (99.4565%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   4,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   5,  Average loss: 0.0001, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   6,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   7,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   8,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch   9,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 19, internal_epoch  10,  Average loss: 0.0000, Accuracy: 552/552 (100.0000%), train_poison_data_count: 552
Global model norm: 17.23269360140096.
Norm before scaling: 17.189151199093935. Distance: 0.936018058608763
Total norm for 7 adversaries is: 17.189151199093935. distance: 0.936018058608763
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0937, Accuracy: 8775/8991 (97.5976%)
poison local model 58 index 57 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   1,  Average loss: 0.0015, Accuracy: 501/510 (98.2353%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   2,  Average loss: 0.0007, Accuracy: 503/510 (98.6275%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   3,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   4,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   5,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   6,  Average loss: 0.0001, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   7,  Average loss: 0.0000, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   8,  Average loss: 0.0000, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch   9,  Average loss: 0.0000, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 58, internal_epoch  10,  Average loss: 0.0000, Accuracy: 510/510 (100.0000%), train_poison_data_count: 510
Global model norm: 17.23269360140096.
Norm before scaling: 17.173313570030956. Distance: 1.090253527318282
Total norm for 7 adversaries is: 17.173313570030956. distance: 1.090253527318282
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0769, Accuracy: 8806/8991 (97.9424%)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0077, Accuracy: 510/555 (91.8919%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1709, Accuracy: 9446/10000 (94.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 91, internal_epoch   1,  Average loss: 0.0052, Accuracy: 581/627 (92.6635%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1429, Accuracy: 9556/10000 (95.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 96, internal_epoch   1,  Average loss: 0.0048, Accuracy: 571/608 (93.9145%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1338, Accuracy: 9567/10000 (95.6700%), Attack Success Rate:0/10000(0.000)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 638/648 (98.4568%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   2,  Average loss: 0.0003, Accuracy: 644/648 (99.3827%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   3,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   4,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   5,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   6,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 17.23269360140096.
Norm before scaling: 17.164160289320886. Distance: 1.0982742470422897
Total norm for 7 adversaries is: 17.164160289320886. distance: 1.0982742470422897
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0799, Accuracy: 8810/8991 (97.9869%)
poison local model 57 index 56 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   1,  Average loss: 0.0010, Accuracy: 561/568 (98.7676%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   2,  Average loss: 0.0004, Accuracy: 562/568 (98.9437%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   3,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   4,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   5,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   6,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   7,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   8,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch   9,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  48, local model 57, internal_epoch  10,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%), train_poison_data_count: 568
Global model norm: 17.23269360140096.
Norm before scaling: 17.17138893335046. Distance: 0.9274737825312732
Total norm for 7 adversaries is: 17.17138893335046. distance: 0.9274737825312732
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0697, Accuracy: 8808/8991 (97.9646%)
time spent on training: 138.40084624290466
[foolsgold agg] training data poison_ratio: 0.6965072906069855  data num: [626, 650, 554, 552, 510, 555, 627, 608, 648, 568]
[foolsgold agg] considering poison per batch poison_fraction: 0.6965072906069855
[foolsgold agg] wv: [1. 1. 1. 1. 1. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 1.2476, Accuracy: 8856/10000 (88.5600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.0621, Accuracy: 8846/8991 (98.3873%)
Done in 463.048889875412 sec.
Server Epoch:49 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
poison local model 77 index 76 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 513/519 (98.8439%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   3,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   4,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   5,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   6,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   7,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   8,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch   9,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 77, internal_epoch  10,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%), train_poison_data_count: 519
Global model norm: 17.243771520465007.
Norm before scaling: 17.201121200568313. Distance: 0.8138332432185595
Total norm for 7 adversaries is: 17.201121200568313. distance: 0.8138332432185595
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0684, Accuracy: 8832/8991 (98.2316%)
poison local model 10 index 9 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0014, Accuracy: 561/572 (98.0769%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   2,  Average loss: 0.0004, Accuracy: 565/572 (98.7762%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   3,  Average loss: 0.0001, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   4,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   5,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   6,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   7,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   8,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch   9,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 10, internal_epoch  10,  Average loss: 0.0000, Accuracy: 572/572 (100.0000%), train_poison_data_count: 572
Global model norm: 17.243771520465007.
Norm before scaling: 17.19637821123926. Distance: 1.133231039666632
Total norm for 7 adversaries is: 17.19637821123926. distance: 1.133231039666632
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0729, Accuracy: 8810/8991 (97.9869%)
poison local model 78 index 77 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 612/624 (98.0769%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   2,  Average loss: 0.0004, Accuracy: 617/624 (98.8782%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   3,  Average loss: 0.0001, Accuracy: 623/624 (99.8397%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   4,  Average loss: 0.0001, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   5,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   6,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   7,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   8,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch   9,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 78, internal_epoch  10,  Average loss: 0.0000, Accuracy: 624/624 (100.0000%), train_poison_data_count: 624
Global model norm: 17.243771520465007.
Norm before scaling: 17.185484611952504. Distance: 1.023600033965116
Total norm for 7 adversaries is: 17.185484611952504. distance: 1.023600033965116
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0722, Accuracy: 8815/8991 (98.0425%)
poison local model 72 index 71 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0005, Accuracy: 524/529 (99.0548%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   2,  Average loss: 0.0002, Accuracy: 527/529 (99.6219%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   3,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   4,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   5,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   6,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   7,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   8,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch   9,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 72, internal_epoch  10,  Average loss: 0.0000, Accuracy: 529/529 (100.0000%), train_poison_data_count: 529
Global model norm: 17.243771520465007.
Norm before scaling: 17.189024257695394. Distance: 0.7605775157867173
Total norm for 7 adversaries is: 17.189024257695394. distance: 0.7605775157867173
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0713, Accuracy: 8815/8991 (98.0425%)
___Train Local_Simple,  epoch  49, local model 91, internal_epoch   1,  Average loss: 0.0047, Accuracy: 587/627 (93.6204%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1798, Accuracy: 9391/10000 (93.9100%), Attack Success Rate:0/10000(0.000)
poison local model 13 index 12 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 509/521 (97.6967%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   2,  Average loss: 0.0006, Accuracy: 515/521 (98.8484%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   3,  Average loss: 0.0004, Accuracy: 518/521 (99.4242%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   4,  Average loss: 0.0002, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   5,  Average loss: 0.0001, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   6,  Average loss: 0.0001, Accuracy: 520/521 (99.8081%), train_poison_data_count: 521
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   7,  Average loss: 0.0001, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   8,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   9,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch  10,  Average loss: 0.0000, Accuracy: 521/521 (100.0000%), train_poison_data_count: 521
Global model norm: 17.243771520465007.
Norm before scaling: 17.17975766669391. Distance: 1.1878758387851172
Total norm for 7 adversaries is: 17.17975766669391. distance: 1.1878758387851172
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0671, Accuracy: 8808/8991 (97.9646%)
___Train Local_Simple,  epoch  49, local model 98, internal_epoch   1,  Average loss: 0.0065, Accuracy: 521/568 (91.7254%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5020, Accuracy: 8611/10000 (86.1100%), Attack Success Rate:0/10000(0.000)
poison local model 21 index 20 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   1,  Average loss: 0.0018, Accuracy: 613/625 (98.0800%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   2,  Average loss: 0.0009, Accuracy: 614/625 (98.2400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   3,  Average loss: 0.0005, Accuracy: 620/625 (99.2000%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   4,  Average loss: 0.0003, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   5,  Average loss: 0.0002, Accuracy: 623/625 (99.6800%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   6,  Average loss: 0.0001, Accuracy: 624/625 (99.8400%), train_poison_data_count: 625
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   7,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   8,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch   9,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 21, internal_epoch  10,  Average loss: 0.0001, Accuracy: 625/625 (100.0000%), train_poison_data_count: 625
Global model norm: 17.243771520465007.
Norm before scaling: 17.13377612144175. Distance: 1.1972072269703342
Total norm for 7 adversaries is: 17.13377612144175. distance: 1.1972072269703342
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0624, Accuracy: 8825/8991 (98.1537%)
___Train Local_Simple,  epoch  49, local model 82, internal_epoch   1,  Average loss: 0.0060, Accuracy: 572/621 (92.1095%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1714, Accuracy: 9482/10000 (94.8200%), Attack Success Rate:0/10000(0.000)
poison local model 74 index 73 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 619/626 (98.8818%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   2,  Average loss: 0.0002, Accuracy: 623/626 (99.5208%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   3,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   4,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   5,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   6,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   7,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   8,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch   9,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  49, local model 74, internal_epoch  10,  Average loss: 0.0000, Accuracy: 626/626 (100.0000%), train_poison_data_count: 626
Global model norm: 17.243771520465007.
Norm before scaling: 17.176646075708618. Distance: 0.7892020829124439
Total norm for 7 adversaries is: 17.176646075708618. distance: 0.7892020829124439
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0616, Accuracy: 8845/8991 (98.3762%)
time spent on training: 137.5711281299591
[foolsgold agg] training data poison_ratio: 0.6886145404663924  data num: [519, 572, 624, 529, 627, 521, 568, 625, 621, 626]
[foolsgold agg] considering poison per batch poison_fraction: 0.6886145404663924
[foolsgold agg] wv: [1. 1. 1. 0. 0. 1. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 1.2717, Accuracy: 8859/10000 (88.5900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.0604, Accuracy: 8850/8991 (98.4318%)
Done in 460.3191890716553 sec.
Server Epoch:50 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
poison local model 75 index 74 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   1,  Average loss: 0.0011, Accuracy: 543/554 (98.0144%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   2,  Average loss: 0.0007, Accuracy: 542/554 (97.8339%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   3,  Average loss: 0.0004, Accuracy: 547/554 (98.7365%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   4,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   5,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   6,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   7,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   8,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch   9,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 75, internal_epoch  10,  Average loss: 0.0000, Accuracy: 554/554 (100.0000%), train_poison_data_count: 554
Global model norm: 17.249330369418963.
Norm before scaling: 17.20635861696102. Distance: 1.0935023436135294
Total norm for 8 adversaries is: 17.20635861696102. distance: 1.0935023436135294
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0562, Accuracy: 8856/8991 (98.4985%)
___Train Local_Simple,  epoch  50, local model 86, internal_epoch   1,  Average loss: 0.0065, Accuracy: 549/587 (93.5264%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2161, Accuracy: 9471/10000 (94.7100%), Attack Success Rate:0/10000(0.000)
poison local model 51 index 50 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0012, Accuracy: 637/647 (98.4544%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 641/647 (99.0726%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   3,  Average loss: 0.0002, Accuracy: 644/647 (99.5363%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   4,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   5,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   6,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   7,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   8,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   9,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch  10,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%), train_poison_data_count: 647
Global model norm: 17.249330369418963.
Norm before scaling: 17.176517265188778. Distance: 1.1428498295567033
Total norm for 8 adversaries is: 17.176517265188778. distance: 1.1428498295567033
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0757, Accuracy: 8817/8991 (98.0647%)
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 551/609 (90.4762%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2756, Accuracy: 9105/10000 (91.0500%), Attack Success Rate:0/10000(0.000)
poison local model 31 index 30 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   1,  Average loss: 0.0013, Accuracy: 500/511 (97.8474%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   2,  Average loss: 0.0002, Accuracy: 507/511 (99.2172%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   3,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   4,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   5,  Average loss: 0.0001, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   6,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   7,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   8,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch   9,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 31, internal_epoch  10,  Average loss: 0.0000, Accuracy: 511/511 (100.0000%), train_poison_data_count: 511
Global model norm: 17.249330369418963.
Norm before scaling: 17.21145702518202. Distance: 1.162967038423057
Total norm for 8 adversaries is: 17.21145702518202. distance: 1.162967038423057
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0920, Accuracy: 8763/8991 (97.4641%)
poison local model 32 index 31 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 601/609 (98.6864%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   2,  Average loss: 0.0002, Accuracy: 605/609 (99.3432%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   3,  Average loss: 0.0001, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   4,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   5,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   6,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   7,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   8,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch   9,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 32, internal_epoch  10,  Average loss: 0.0000, Accuracy: 609/609 (100.0000%), train_poison_data_count: 609
Global model norm: 17.249330369418963.
Norm before scaling: 17.189341165589543. Distance: 1.0897887294649244
Total norm for 8 adversaries is: 17.189341165589543. distance: 1.0897887294649244
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0641, Accuracy: 8827/8991 (98.1760%)
poison local model 67 index 66 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   1,  Average loss: 0.0008, Accuracy: 635/643 (98.7558%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   2,  Average loss: 0.0007, Accuracy: 637/643 (99.0669%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   3,  Average loss: 0.0001, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   4,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   5,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   6,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   7,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   8,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch   9,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 67, internal_epoch  10,  Average loss: 0.0000, Accuracy: 643/643 (100.0000%), train_poison_data_count: 643
Global model norm: 17.249330369418963.
Norm before scaling: 17.1787033597153. Distance: 1.1501091449193206
Total norm for 8 adversaries is: 17.1787033597153. distance: 1.1501091449193206
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0768, Accuracy: 8808/8991 (97.9646%)
poison local model 17 index 16 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   1,  Average loss: 0.0010, Accuracy: 636/648 (98.1481%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 637/648 (98.3025%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   3,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   4,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   5,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   6,  Average loss: 0.0001, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   7,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   8,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch   9,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 17, internal_epoch  10,  Average loss: 0.0000, Accuracy: 648/648 (100.0000%), train_poison_data_count: 648
Global model norm: 17.249330369418963.
Norm before scaling: 17.188014907059877. Distance: 1.2441934667172003
Total norm for 8 adversaries is: 17.188014907059877. distance: 1.2441934667172003
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0686, Accuracy: 8821/8991 (98.1092%)
poison local model 29 index 28 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   1,  Average loss: 0.0013, Accuracy: 592/605 (97.8512%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   2,  Average loss: 0.0005, Accuracy: 598/605 (98.8430%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   3,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   4,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   5,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   6,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   7,  Average loss: 0.0001, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   8,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch   9,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 29, internal_epoch  10,  Average loss: 0.0000, Accuracy: 605/605 (100.0000%), train_poison_data_count: 605
Global model norm: 17.249330369418963.
Norm before scaling: 17.185558306515404. Distance: 1.1422176477129957
Total norm for 8 adversaries is: 17.185558306515404. distance: 1.1422176477129957
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0779, Accuracy: 8806/8991 (97.9424%)
poison local model 7 index 6 
poison_now
Current lr: [0.05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 539/550 (98.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   2,  Average loss: 0.0005, Accuracy: 543/550 (98.7273%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   3,  Average loss: 0.0002, Accuracy: 547/550 (99.4545%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   4,  Average loss: 0.0001, Accuracy: 549/550 (99.8182%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   5,  Average loss: 0.0001, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   6,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   7,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [5.0000000000000016e-05]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   8,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch   9,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Current lr: [0.0005000000000000001]
___PoisonTrain Local_Simple ,  epoch  50, local model 7, internal_epoch  10,  Average loss: 0.0000, Accuracy: 550/550 (100.0000%), train_poison_data_count: 550
Global model norm: 17.249330369418963.
Norm before scaling: 17.19776948172304. Distance: 1.0704856231344086
Total norm for 8 adversaries is: 17.19776948172304. distance: 1.0704856231344086
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0731, Accuracy: 8824/8991 (98.1426%)
time spent on training: 151.97194027900696
[foolsgold agg] training data poison_ratio: 0.7994298172061043  data num: [554, 587, 647, 609, 511, 609, 643, 648, 605, 550]
[foolsgold agg] considering poison per batch poison_fraction: 0.7994298172061043
[foolsgold agg] wv: [1.         0.30740079 1.         0.30740079 1.         1.
 1.         1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 1.2105, Accuracy: 8852/10000 (88.5200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.0627, Accuracy: 8841/8991 (98.3317%)
Done in 473.77991914749146 sec.
Saving all the graphs.
This run has a label: Mar.04_21.27.56. Visdom environment: mnist_DBA
