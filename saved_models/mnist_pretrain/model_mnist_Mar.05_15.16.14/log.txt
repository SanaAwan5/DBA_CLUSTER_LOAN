current path: saved_models/mnist_pretrain/model_mnist_Mar.05_15.16.14
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   1, local model 0, internal_epoch   1,  Average loss: 1.1737, Accuracy: 0/2 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.3016, Accuracy: 1135/10000 (11.3500%), Attack Success Rate:9/10000(0.090)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 1, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3082/4113 (74.9331%), train_poison_data_count: 4113
Global model norm: 13.89800383141575.
Norm before scaling: 13.681965026712628. Distance: 2.3470991492374833
Total norm for 5 adversaries is: 13.681965026712628. distance: 2.3470991492374833
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 4.8198, Accuracy: 2921/8991 (32.4880%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 2, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2272/2275 (99.8681%), train_poison_data_count: 2275
Global model norm: 13.89800383141575.
Norm before scaling: 13.853351922804471. Distance: 2.077978602250546
Total norm for 5 adversaries is: 13.853351922804471. distance: 2.077978602250546
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 64.8699, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 3, internal_epoch   1,  Average loss: 0.0180, Accuracy: 1156/1293 (89.4045%), train_poison_data_count: 1293
Global model norm: 13.89800383141575.
Norm before scaling: 13.845316158940381. Distance: 1.4161445085473252
Total norm for 5 adversaries is: 13.845316158940381. distance: 1.4161445085473252
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 4.4704, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 4, internal_epoch   1,  Average loss: 0.0066, Accuracy: 7292/8146 (89.5163%), train_poison_data_count: 8146
Global model norm: 13.89800383141575.
Norm before scaling: 13.225532829641674. Distance: 2.7259784936539337
Total norm for 5 adversaries is: 13.225532829641674. distance: 2.7259784936539337
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 6.2028, Accuracy: 2610/8991 (29.0290%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 5, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4900/5399 (90.7575%), train_poison_data_count: 5399
Global model norm: 13.89800383141575.
Norm before scaling: 13.452237444408354. Distance: 2.1902414854154357
Total norm for 5 adversaries is: 13.452237444408354. distance: 2.1902414854154357
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 6.0294, Accuracy: 2106/8991 (23.4234%)
___Train Local_Simple,  epoch   1, local model 6, internal_epoch   1,  Average loss: 0.0197, Accuracy: 752/866 (86.8360%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 27.6775, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   1, local model 7, internal_epoch   1,  Average loss: 0.0171, Accuracy: 1953/2905 (67.2289%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 7.4835, Accuracy: 2857/10000 (28.5700%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   1, local model 8, internal_epoch   1,  Average loss: 0.0094, Accuracy: 6139/7219 (85.0395%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 6.4452, Accuracy: 4012/10000 (40.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 9, internal_epoch   1,  Average loss: 0.0137, Accuracy: 2303/2685 (85.7728%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 5.3536, Accuracy: 982/10000 (9.8200%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   1, local model 10, internal_epoch   1,  Average loss: 0.0139, Accuracy: 4266/5617 (75.9480%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 5.2595, Accuracy: 4576/10000 (45.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0105, Accuracy: 6518/8046 (81.0092%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 5.7661, Accuracy: 2847/10000 (28.4700%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   1, local model 12, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5014/5087 (98.5650%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 83.7990, Accuracy: 980/10000 (9.8000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch   1, local model 13, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3401/3436 (98.9814%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 7.9515, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   1, local model 14, internal_epoch   1,  Average loss: 0.0154, Accuracy: 1325/1481 (89.4666%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 5.4755, Accuracy: 958/10000 (9.5800%), Attack Success Rate:2/10000(0.020)
time spent on training: 181.3343780040741
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         1.         1.         1.
 0.49673202 0.49673202 1.         1.         1.         1.
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2949, Accuracy: 1605/10000 (16.0500%), Attack Success Rate:32/10000(0.320)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2924, Accuracy: 1639/8991 (18.2293%)
Done in 210.64162302017212 sec.
Server Epoch:2 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   2, local model 0, internal_epoch   1,  Average loss: 1.1647, Accuracy: 0/2 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.2943, Accuracy: 1635/10000 (16.3500%), Attack Success Rate:31/10000(0.310)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 1, internal_epoch   1,  Average loss: 0.0135, Accuracy: 3300/4113 (80.2334%), train_poison_data_count: 4113
Global model norm: 13.903097211073037.
Norm before scaling: 13.705090232866606. Distance: 2.409864905753672
Total norm for 5 adversaries is: 13.705090232866606. distance: 2.409864905753672
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 4.8069, Accuracy: 2935/8991 (32.6438%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 2, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2271/2275 (99.8242%), train_poison_data_count: 2275
Global model norm: 13.903097211073037.
Norm before scaling: 13.86327354536275. Distance: 2.097228733021761
Total norm for 5 adversaries is: 13.86327354536275. distance: 2.097228733021761
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 68.9551, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 3, internal_epoch   1,  Average loss: 0.0158, Accuracy: 1158/1293 (89.5592%), train_poison_data_count: 1293
Global model norm: 13.903097211073037.
Norm before scaling: 13.848587327654748. Distance: 1.378036959857004
Total norm for 5 adversaries is: 13.848587327654748. distance: 1.378036959857004
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 4.5617, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 4, internal_epoch   1,  Average loss: 0.0064, Accuracy: 7326/8146 (89.9337%), train_poison_data_count: 8146
Global model norm: 13.903097211073037.
Norm before scaling: 13.215352949840847. Distance: 2.645893957289565
Total norm for 5 adversaries is: 13.215352949840847. distance: 2.645893957289565
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 6.1097, Accuracy: 2716/8991 (30.2080%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 5, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4974/5399 (92.1282%), train_poison_data_count: 5399
Global model norm: 13.903097211073037.
Norm before scaling: 13.453711945493135. Distance: 2.1388097709896297
Total norm for 5 adversaries is: 13.453711945493135. distance: 2.1388097709896297
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 7.7504, Accuracy: 2144/8991 (23.8461%)
___Train Local_Simple,  epoch   2, local model 6, internal_epoch   1,  Average loss: 0.0199, Accuracy: 754/866 (87.0670%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 23.4576, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch   2, local model 7, internal_epoch   1,  Average loss: 0.0164, Accuracy: 1993/2905 (68.6059%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 7.8723, Accuracy: 2818/10000 (28.1800%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   2, local model 8, internal_epoch   1,  Average loss: 0.0087, Accuracy: 6238/7219 (86.4109%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 6.3617, Accuracy: 4025/10000 (40.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 9, internal_epoch   1,  Average loss: 0.0132, Accuracy: 2298/2685 (85.5866%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 5.9532, Accuracy: 982/10000 (9.8200%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   2, local model 10, internal_epoch   1,  Average loss: 0.0122, Accuracy: 4462/5617 (79.4374%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 4.9705, Accuracy: 4603/10000 (46.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0094, Accuracy: 6657/8046 (82.7368%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 5.5614, Accuracy: 2840/10000 (28.4000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   2, local model 12, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5035/5087 (98.9778%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 84.8626, Accuracy: 980/10000 (9.8000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   2, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3391/3436 (98.6903%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 7.8221, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   2, local model 14, internal_epoch   1,  Average loss: 0.0153, Accuracy: 1352/1481 (91.2897%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 4.0051, Accuracy: 958/10000 (9.5800%), Attack Success Rate:5/10000(0.050)
time spent on training: 187.1531538963318
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.24393693 1.         1.
 0.24393693 0.63172828 1.         1.         1.         0.76514996
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2856, Accuracy: 1717/10000 (17.1700%), Attack Success Rate:26/10000(0.260)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2828, Accuracy: 1802/8991 (20.0423%)
Done in 216.4756579399109 sec.
Server Epoch:3 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   3, local model 0, internal_epoch   1,  Average loss: 1.1555, Accuracy: 0/2 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.2849, Accuracy: 1919/10000 (19.1900%), Attack Success Rate:19/10000(0.190)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 1, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3269/4113 (79.4797%), train_poison_data_count: 4113
Global model norm: 13.908440509533287.
Norm before scaling: 13.699581301340244. Distance: 2.3180756238593485
Total norm for 5 adversaries is: 13.699581301340244. distance: 2.3180756238593485
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 5.3887, Accuracy: 2953/8991 (32.8440%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2264/2275 (99.5165%), train_poison_data_count: 2275
Global model norm: 13.908440509533287.
Norm before scaling: 13.844745815446954. Distance: 1.9880313378978378
Total norm for 5 adversaries is: 13.844745815446954. distance: 1.9880313378978378
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 51.7136, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 3, internal_epoch   1,  Average loss: 0.0142, Accuracy: 1183/1293 (91.4927%), train_poison_data_count: 1293
Global model norm: 13.908440509533287.
Norm before scaling: 13.85960620227109. Distance: 1.3987046737758633
Total norm for 5 adversaries is: 13.85960620227109. distance: 1.3987046737758633
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 5.3881, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 7464/8146 (91.6278%), train_poison_data_count: 8146
Global model norm: 13.908440509533287.
Norm before scaling: 13.217600815332432. Distance: 2.62840504282594
Total norm for 5 adversaries is: 13.217600815332432. distance: 2.62840504282594
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 5.8675, Accuracy: 2480/8991 (27.5831%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 5, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5082/5399 (94.1285%), train_poison_data_count: 5399
Global model norm: 13.908440509533287.
Norm before scaling: 13.449738363110741. Distance: 2.063144005309738
Total norm for 5 adversaries is: 13.449738363110741. distance: 2.063144005309738
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 9.2008, Accuracy: 2134/8991 (23.7348%)
___Train Local_Simple,  epoch   3, local model 6, internal_epoch   1,  Average loss: 0.0181, Accuracy: 780/866 (90.0693%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 26.8612, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   3, local model 7, internal_epoch   1,  Average loss: 0.0142, Accuracy: 2196/2905 (75.5938%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 5.6216, Accuracy: 2791/10000 (27.9100%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   3, local model 8, internal_epoch   1,  Average loss: 0.0078, Accuracy: 6386/7219 (88.4610%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 6.3736, Accuracy: 4055/10000 (40.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 9, internal_epoch   1,  Average loss: 0.0124, Accuracy: 2321/2685 (86.4432%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 5.0724, Accuracy: 993/10000 (9.9300%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   3, local model 10, internal_epoch   1,  Average loss: 0.0116, Accuracy: 4555/5617 (81.0931%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 4.7132, Accuracy: 4449/10000 (44.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 11, internal_epoch   1,  Average loss: 0.0090, Accuracy: 6738/8046 (83.7435%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 5.3548, Accuracy: 2889/10000 (28.8900%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   3, local model 12, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5037/5087 (99.0171%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 81.2810, Accuracy: 980/10000 (9.8000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   3, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3387/3436 (98.5739%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 6.1705, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch   3, local model 14, internal_epoch   1,  Average loss: 0.0132, Accuracy: 1372/1481 (92.6401%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 6.1676, Accuracy: 958/10000 (9.5800%), Attack Success Rate:5/10000(0.050)
time spent on training: 192.1729600429535
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.94397686
 0.         0.68928739 0.94397686 1.         1.         0.78421506
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.2739, Accuracy: 1641/10000 (16.4100%), Attack Success Rate:28/10000(0.280)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.2709, Accuracy: 1636/8991 (18.1960%)
Done in 222.1008951663971 sec.
Server Epoch:4 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   4, local model 0, internal_epoch   1,  Average loss: 1.1419, Accuracy: 0/2 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.2732, Accuracy: 1966/10000 (19.6600%), Attack Success Rate:35/10000(0.350)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 1, internal_epoch   1,  Average loss: 0.0113, Accuracy: 3375/4113 (82.0569%), train_poison_data_count: 4113
Global model norm: 13.91405866174147.
Norm before scaling: 13.707812700366178. Distance: 2.2988346589156827
Total norm for 5 adversaries is: 13.707812700366178. distance: 2.2988346589156827
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 5.8528, Accuracy: 2962/8991 (32.9441%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2241/2275 (98.5055%), train_poison_data_count: 2275
Global model norm: 13.91405866174147.
Norm before scaling: 13.861894896692627. Distance: 2.0414803737843354
Total norm for 5 adversaries is: 13.861894896692627. distance: 2.0414803737843354
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 59.6283, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 3, internal_epoch   1,  Average loss: 0.0146, Accuracy: 1175/1293 (90.8739%), train_poison_data_count: 1293
Global model norm: 13.91405866174147.
Norm before scaling: 13.859173520590184. Distance: 1.3955926782578334
Total norm for 5 adversaries is: 13.859173520590184. distance: 1.3955926782578334
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 4.5532, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 4, internal_epoch   1,  Average loss: 0.0058, Accuracy: 7360/8146 (90.3511%), train_poison_data_count: 8146
Global model norm: 13.91405866174147.
Norm before scaling: 13.244536803035171. Distance: 2.7076600240403397
Total norm for 5 adversaries is: 13.244536803035171. distance: 2.7076600240403397
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 4.5943, Accuracy: 2766/8991 (30.7641%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5042/5399 (93.3877%), train_poison_data_count: 5399
Global model norm: 13.91405866174147.
Norm before scaling: 13.469872660215533. Distance: 2.126299965353801
Total norm for 5 adversaries is: 13.469872660215533. distance: 2.126299965353801
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 6.6085, Accuracy: 2128/8991 (23.6681%)
___Train Local_Simple,  epoch   4, local model 6, internal_epoch   1,  Average loss: 0.0177, Accuracy: 776/866 (89.6074%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 18.7354, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch   4, local model 7, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2250/2905 (77.4527%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 9.8331, Accuracy: 2825/10000 (28.2500%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch   4, local model 8, internal_epoch   1,  Average loss: 0.0074, Accuracy: 6405/7219 (88.7242%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 5.5668, Accuracy: 3971/10000 (39.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 9, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2338/2685 (87.0764%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 5.1136, Accuracy: 1258/10000 (12.5800%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch   4, local model 10, internal_epoch   1,  Average loss: 0.0106, Accuracy: 4654/5617 (82.8556%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 4.8871, Accuracy: 4674/10000 (46.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 6848/8046 (85.1106%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 5.3838, Accuracy: 2866/10000 (28.6600%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   4, local model 12, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5044/5087 (99.1547%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 78.6629, Accuracy: 980/10000 (9.8000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3368/3436 (98.0210%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 8.8013, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch   4, local model 14, internal_epoch   1,  Average loss: 0.0138, Accuracy: 1378/1481 (93.0452%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 5.8262, Accuracy: 958/10000 (9.5800%), Attack Success Rate:4/10000(0.040)
time spent on training: 203.17637705802917
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.99412191 1.         0.         0.         1.         0.98088845
 0.         0.61493357 0.98088845 1.         1.         0.80114736
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 2.2596, Accuracy: 1932/10000 (19.3200%), Attack Success Rate:32/10000(0.320)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 2.2563, Accuracy: 1863/8991 (20.7207%)
Done in 232.61061191558838 sec.
Server Epoch:5 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   5, local model 0, internal_epoch   1,  Average loss: 1.1258, Accuracy: 0/2 (0.0000%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.2590, Accuracy: 2088/10000 (20.8800%), Attack Success Rate:23/10000(0.230)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 1, internal_epoch   1,  Average loss: 0.0125, Accuracy: 3264/4113 (79.3581%), train_poison_data_count: 4113
Global model norm: 13.920057664072148.
Norm before scaling: 13.716362330481601. Distance: 2.33838792959668
Total norm for 5 adversaries is: 13.716362330481601. distance: 2.33838792959668
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 4.4450, Accuracy: 2966/8991 (32.9885%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2227/2275 (97.8901%), train_poison_data_count: 2275
Global model norm: 13.920057664072148.
Norm before scaling: 13.862131560703427. Distance: 2.019612471166537
Total norm for 5 adversaries is: 13.862131560703427. distance: 2.019612471166537
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 55.5451, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 3, internal_epoch   1,  Average loss: 0.0132, Accuracy: 1172/1293 (90.6419%), train_poison_data_count: 1293
Global model norm: 13.920057664072148.
Norm before scaling: 13.872992292981815. Distance: 1.4317462876946008
Total norm for 5 adversaries is: 13.872992292981815. distance: 1.4317462876946008
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 5.6891, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 7435/8146 (91.2718%), train_poison_data_count: 8146
Global model norm: 13.920057664072148.
Norm before scaling: 13.246413987208305. Distance: 2.664610686073559
Total norm for 5 adversaries is: 13.246413987208305. distance: 2.664610686073559
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 6.8222, Accuracy: 2633/8991 (29.2848%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5098/5399 (94.4249%), train_poison_data_count: 5399
Global model norm: 13.920057664072148.
Norm before scaling: 13.449648169698413. Distance: 1.9863745159782082
Total norm for 5 adversaries is: 13.449648169698413. distance: 1.9863745159782082
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 6.4979, Accuracy: 2124/8991 (23.6236%)
___Train Local_Simple,  epoch   5, local model 6, internal_epoch   1,  Average loss: 0.0169, Accuracy: 769/866 (88.7991%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 23.8026, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0126, Accuracy: 2349/2905 (80.8606%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 4.8738, Accuracy: 2882/10000 (28.8200%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   5, local model 8, internal_epoch   1,  Average loss: 0.0069, Accuracy: 6505/7219 (90.1094%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 5.8381, Accuracy: 4038/10000 (40.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 9, internal_epoch   1,  Average loss: 0.0115, Accuracy: 2347/2685 (87.4115%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 4.7065, Accuracy: 1370/10000 (13.7000%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch   5, local model 10, internal_epoch   1,  Average loss: 0.0097, Accuracy: 4714/5617 (83.9238%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 4.7000, Accuracy: 4716/10000 (47.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 6858/8046 (85.2349%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 5.0307, Accuracy: 2868/10000 (28.6800%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch   5, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5043/5087 (99.1351%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 78.0873, Accuracy: 980/10000 (9.8000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   5, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3365/3436 (97.9336%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 9.4474, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0123, Accuracy: 1393/1481 (94.0581%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 4.8261, Accuracy: 958/10000 (9.5800%), Attack Success Rate:6/10000(0.060)
time spent on training: 207.3504250049591
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.72432771 1.         0.         0.02533858 1.         0.85873335
 0.02533858 0.78806104 0.85873335 1.         1.         0.72432771
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.2428, Accuracy: 2282/10000 (22.8200%), Attack Success Rate:20/10000(0.200)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 2.2399, Accuracy: 2215/8991 (24.6357%)
Done in 236.76342105865479 sec.
Server Epoch:6 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   6, local model 0, internal_epoch   1,  Average loss: 1.1079, Accuracy: 1/2 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.2425, Accuracy: 2342/10000 (23.4200%), Attack Success Rate:18/10000(0.180)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 1, internal_epoch   1,  Average loss: 0.0105, Accuracy: 3487/4113 (84.7800%), train_poison_data_count: 4113
Global model norm: 13.926122563313792.
Norm before scaling: 13.713730017439126. Distance: 2.2393674761224953
Total norm for 5 adversaries is: 13.713730017439126. distance: 2.2393674761224953
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 4.9771, Accuracy: 2954/8991 (32.8551%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2221/2275 (97.6264%), train_poison_data_count: 2275
Global model norm: 13.926122563313792.
Norm before scaling: 13.87803492990362. Distance: 2.0684377567183327
Total norm for 5 adversaries is: 13.87803492990362. distance: 2.0684377567183327
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 60.8338, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 3, internal_epoch   1,  Average loss: 0.0115, Accuracy: 1170/1293 (90.4872%), train_poison_data_count: 1293
Global model norm: 13.926122563313792.
Norm before scaling: 13.89232042433736. Distance: 1.4831430241662658
Total norm for 5 adversaries is: 13.89232042433736. distance: 1.4831430241662658
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 8.4413, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 7539/8146 (92.5485%), train_poison_data_count: 8146
Global model norm: 13.926122563313792.
Norm before scaling: 13.250191165336776. Distance: 2.6531036591766766
Total norm for 5 adversaries is: 13.250191165336776. distance: 2.6531036591766766
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 6.0532, Accuracy: 2660/8991 (29.5851%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 5, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5084/5399 (94.1656%), train_poison_data_count: 5399
Global model norm: 13.926122563313792.
Norm before scaling: 13.471690695503385. Distance: 2.0442758612763274
Total norm for 5 adversaries is: 13.471690695503385. distance: 2.0442758612763274
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 6.8276, Accuracy: 2149/8991 (23.9017%)
___Train Local_Simple,  epoch   6, local model 6, internal_epoch   1,  Average loss: 0.0170, Accuracy: 769/866 (88.7991%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 18.0476, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   6, local model 7, internal_epoch   1,  Average loss: 0.0109, Accuracy: 2372/2905 (81.6523%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 7.8852, Accuracy: 2862/10000 (28.6200%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0064, Accuracy: 6563/7219 (90.9129%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 6.0150, Accuracy: 4034/10000 (40.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 9, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2386/2685 (88.8641%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 5.9816, Accuracy: 1815/10000 (18.1500%), Attack Success Rate:29/10000(0.290)
___Train Local_Simple,  epoch   6, local model 10, internal_epoch   1,  Average loss: 0.0089, Accuracy: 4856/5617 (86.4518%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 4.0479, Accuracy: 4644/10000 (46.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 6984/8046 (86.8009%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 6.2103, Accuracy: 2832/10000 (28.3200%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch   6, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5059/5087 (99.4496%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 75.4934, Accuracy: 980/10000 (9.8000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   6, local model 13, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3355/3436 (97.6426%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 7.7410, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   6, local model 14, internal_epoch   1,  Average loss: 0.0110, Accuracy: 1410/1481 (95.2059%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 5.6646, Accuracy: 958/10000 (9.5800%), Attack Success Rate:5/10000(0.050)
time spent on training: 217.13090991973877
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.93803838 1.         0.         0.         1.         0.8320536
 0.         0.65482566 0.8320536  1.         1.         0.72284247
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 2.2236, Accuracy: 2533/10000 (25.3300%), Attack Success Rate:18/10000(0.180)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 2.2212, Accuracy: 2466/8991 (27.4274%)
Done in 246.46990609169006 sec.
Server Epoch:7 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   7, local model 0, internal_epoch   1,  Average loss: 1.0891, Accuracy: 1/2 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2237, Accuracy: 2556/10000 (25.5600%), Attack Success Rate:14/10000(0.140)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 1, internal_epoch   1,  Average loss: 0.0103, Accuracy: 3436/4113 (83.5400%), train_poison_data_count: 4113
Global model norm: 13.932244511699794.
Norm before scaling: 13.730399848689142. Distance: 2.291712974311665
Total norm for 5 adversaries is: 13.730399848689142. distance: 2.291712974311665
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 4.5102, Accuracy: 2952/8991 (32.8328%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 2, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2220/2275 (97.5824%), train_poison_data_count: 2275
Global model norm: 13.932244511699794.
Norm before scaling: 13.880548141165706. Distance: 2.0601711418762227
Total norm for 5 adversaries is: 13.880548141165706. distance: 2.0601711418762227
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 56.8098, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 3, internal_epoch   1,  Average loss: 0.0136, Accuracy: 1174/1293 (90.7966%), train_poison_data_count: 1293
Global model norm: 13.932244511699794.
Norm before scaling: 13.876915601858135. Distance: 1.4565516441872044
Total norm for 5 adversaries is: 13.876915601858135. distance: 1.4565516441872044
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 3.8699, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 4, internal_epoch   1,  Average loss: 0.0047, Accuracy: 7624/8146 (93.5919%), train_poison_data_count: 8146
Global model norm: 13.932244511699794.
Norm before scaling: 13.23506330301316. Distance: 2.550415573664157
Total norm for 5 adversaries is: 13.23506330301316. distance: 2.550415573664157
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 5.7734, Accuracy: 2717/8991 (30.2191%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 5, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5161/5399 (95.5918%), train_poison_data_count: 5399
Global model norm: 13.932244511699794.
Norm before scaling: 13.458728575832478. Distance: 1.9235940083991658
Total norm for 5 adversaries is: 13.458728575832478. distance: 1.9235940083991658
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 8.8557, Accuracy: 2149/8991 (23.9017%)
___Train Local_Simple,  epoch   7, local model 6, internal_epoch   1,  Average loss: 0.0156, Accuracy: 762/866 (87.9908%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 16.9747, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0104, Accuracy: 2474/2905 (85.1635%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 6.6430, Accuracy: 2873/10000 (28.7300%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   7, local model 8, internal_epoch   1,  Average loss: 0.0065, Accuracy: 6492/7219 (89.9294%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 5.5244, Accuracy: 4073/10000 (40.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 9, internal_epoch   1,  Average loss: 0.0101, Accuracy: 2370/2685 (88.2682%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 4.9560, Accuracy: 1741/10000 (17.4100%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0084, Accuracy: 4886/5617 (86.9859%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 4.1059, Accuracy: 4514/10000 (45.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 7123/8046 (88.5285%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 5.1105, Accuracy: 2882/10000 (28.8200%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   7, local model 12, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5064/5087 (99.5479%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 71.8720, Accuracy: 980/10000 (9.8000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   7, local model 13, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3352/3436 (97.5553%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 8.3738, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch   7, local model 14, internal_epoch   1,  Average loss: 0.0105, Accuracy: 1411/1481 (95.2735%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 4.8885, Accuracy: 958/10000 (9.5800%), Attack Success Rate:1/10000(0.010)
time spent on training: 224.4137101173401
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.83493075
 0.         0.66706381 0.83493075 1.         1.         0.70187345
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 2.2025, Accuracy: 2765/10000 (27.6500%), Attack Success Rate:6/10000(0.060)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 2.2010, Accuracy: 2694/8991 (29.9633%)
Done in 254.1744601726532 sec.
Server Epoch:8 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   8, local model 0, internal_epoch   1,  Average loss: 1.0702, Accuracy: 1/2 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.2030, Accuracy: 2679/10000 (26.7900%), Attack Success Rate:6/10000(0.060)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 1, internal_epoch   1,  Average loss: 0.0094, Accuracy: 3505/4113 (85.2176%), train_poison_data_count: 4113
Global model norm: 13.93854713782884.
Norm before scaling: 13.731118850185869. Distance: 2.231469352475812
Total norm for 5 adversaries is: 13.731118850185869. distance: 2.231469352475812
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 5.3484, Accuracy: 2962/8991 (32.9441%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 2, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2218/2275 (97.4945%), train_poison_data_count: 2275
Global model norm: 13.93854713782884.
Norm before scaling: 13.889975773987265. Distance: 2.0771215784141455
Total norm for 5 adversaries is: 13.889975773987265. distance: 2.0771215784141455
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 58.3248, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 3, internal_epoch   1,  Average loss: 0.0115, Accuracy: 1171/1293 (90.5646%), train_poison_data_count: 1293
Global model norm: 13.93854713782884.
Norm before scaling: 13.890616761281303. Distance: 1.4673475509300231
Total norm for 5 adversaries is: 13.890616761281303. distance: 1.4673475509300231
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 5.0100, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 7593/8146 (93.2114%), train_poison_data_count: 8146
Global model norm: 13.93854713782884.
Norm before scaling: 13.254517558846622. Distance: 2.583386502692956
Total norm for 5 adversaries is: 13.254517558846622. distance: 2.583386502692956
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 6.1901, Accuracy: 2728/8991 (30.3415%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5153/5399 (95.4436%), train_poison_data_count: 5399
Global model norm: 13.93854713782884.
Norm before scaling: 13.46915783895285. Distance: 1.9394369595287086
Total norm for 5 adversaries is: 13.46915783895285. distance: 1.9394369595287086
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 7.5397, Accuracy: 2135/8991 (23.7460%)
___Train Local_Simple,  epoch   8, local model 6, internal_epoch   1,  Average loss: 0.0149, Accuracy: 766/866 (88.4527%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 19.6855, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   8, local model 7, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2430/2905 (83.6489%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 6.5161, Accuracy: 2899/10000 (28.9900%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   8, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 6540/7219 (90.5943%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 5.3418, Accuracy: 4074/10000 (40.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0107, Accuracy: 2289/2685 (85.2514%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 3.4652, Accuracy: 1196/10000 (11.9600%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   8, local model 10, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4938/5617 (87.9117%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 4.5496, Accuracy: 4635/10000 (46.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 11, internal_epoch   1,  Average loss: 0.0062, Accuracy: 7161/8046 (89.0007%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 5.8129, Accuracy: 2838/10000 (28.3800%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5053/5087 (99.3316%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 72.5209, Accuracy: 980/10000 (9.8000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   8, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3352/3436 (97.5553%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 7.3046, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   8, local model 14, internal_epoch   1,  Average loss: 0.0105, Accuracy: 1418/1481 (95.7461%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 5.8607, Accuracy: 958/10000 (9.5800%), Attack Success Rate:4/10000(0.040)
time spent on training: 228.00685906410217
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         1.
 0.         0.63341541 1.         1.         1.         0.65862173
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 2.1789, Accuracy: 2982/10000 (29.8200%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 2.1781, Accuracy: 2876/8991 (31.9875%)
Done in 257.72581815719604 sec.
Server Epoch:9 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   9, local model 0, internal_epoch   1,  Average loss: 1.0509, Accuracy: 1/2 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.1803, Accuracy: 2838/10000 (28.3800%), Attack Success Rate:6/10000(0.060)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 1, internal_epoch   1,  Average loss: 0.0091, Accuracy: 3536/4113 (85.9713%), train_poison_data_count: 4113
Global model norm: 13.945072870840328.
Norm before scaling: 13.745478216006846. Distance: 2.2391999973797296
Total norm for 5 adversaries is: 13.745478216006846. distance: 2.2391999973797296
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 5.1158, Accuracy: 2870/8991 (31.9208%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 2, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2218/2275 (97.4945%), train_poison_data_count: 2275
Global model norm: 13.945072870840328.
Norm before scaling: 13.916132812006584. Distance: 2.1697328830276335
Total norm for 5 adversaries is: 13.916132812006584. distance: 2.1697328830276335
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 70.4971, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 3, internal_epoch   1,  Average loss: 0.0120, Accuracy: 1167/1293 (90.2552%), train_poison_data_count: 1293
Global model norm: 13.945072870840328.
Norm before scaling: 13.899018814255323. Distance: 1.5169170417507858
Total norm for 5 adversaries is: 13.899018814255323. distance: 1.5169170417507858
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 4.8245, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 7602/8146 (93.3219%), train_poison_data_count: 8146
Global model norm: 13.945072870840328.
Norm before scaling: 13.263818408896425. Distance: 2.590464705971363
Total norm for 5 adversaries is: 13.263818408896425. distance: 2.590464705971363
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 6.1137, Accuracy: 2702/8991 (30.0523%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5153/5399 (95.4436%), train_poison_data_count: 5399
Global model norm: 13.945072870840328.
Norm before scaling: 13.490104156612357. Distance: 2.007309668842458
Total norm for 5 adversaries is: 13.490104156612357. distance: 2.007309668842458
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 5.7400, Accuracy: 2138/8991 (23.7793%)
___Train Local_Simple,  epoch   9, local model 6, internal_epoch   1,  Average loss: 0.0166, Accuracy: 766/866 (88.4527%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 15.4997, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   9, local model 7, internal_epoch   1,  Average loss: 0.0088, Accuracy: 2508/2905 (86.3339%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 10.9432, Accuracy: 2879/10000 (28.7900%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   9, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 6608/7219 (91.5362%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 4.3564, Accuracy: 4005/10000 (40.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 9, internal_epoch   1,  Average loss: 0.0086, Accuracy: 2422/2685 (90.2048%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 6.5160, Accuracy: 1872/10000 (18.7200%), Attack Success Rate:30/10000(0.300)
___Train Local_Simple,  epoch   9, local model 10, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4932/5617 (87.8049%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 4.3431, Accuracy: 4718/10000 (47.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 11, internal_epoch   1,  Average loss: 0.0059, Accuracy: 7253/8046 (90.1442%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 6.8170, Accuracy: 2786/10000 (27.8600%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch   9, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5061/5087 (99.4889%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 70.9815, Accuracy: 980/10000 (9.8000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3351/3436 (97.5262%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 6.3095, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch   9, local model 14, internal_epoch   1,  Average loss: 0.0094, Accuracy: 1416/1481 (95.6111%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 5.3917, Accuracy: 958/10000 (9.5800%), Attack Success Rate:4/10000(0.040)
time spent on training: 237.71882700920105
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.90557559 1.         0.         0.         1.         0.8649777
 0.         0.5831171  0.8649777  1.         1.         0.74886253
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 2.1531, Accuracy: 3281/10000 (32.8100%), Attack Success Rate:2/10000(0.020)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 2.1530, Accuracy: 3122/8991 (34.7236%)
Done in 267.3751599788666 sec.
Server Epoch:10 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  10, local model 0, internal_epoch   1,  Average loss: 1.0300, Accuracy: 1/2 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.1557, Accuracy: 2966/10000 (29.6600%), Attack Success Rate:3/10000(0.030)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 1, internal_epoch   1,  Average loss: 0.0090, Accuracy: 3542/4113 (86.1172%), train_poison_data_count: 4113
Global model norm: 13.951811554572291.
Norm before scaling: 13.756023405462809. Distance: 2.2450126899071723
Total norm for 5 adversaries is: 13.756023405462809. distance: 2.2450126899071723
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 4.6422, Accuracy: 2964/8991 (32.9663%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 2216/2275 (97.4066%), train_poison_data_count: 2275
Global model norm: 13.951811554572291.
Norm before scaling: 13.890229535990397. Distance: 2.0346274833047673
Total norm for 5 adversaries is: 13.890229535990397. distance: 2.0346274833047673
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 47.8670, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 3, internal_epoch   1,  Average loss: 0.0123, Accuracy: 1165/1293 (90.1005%), train_poison_data_count: 1293
Global model norm: 13.951811554572291.
Norm before scaling: 13.901630311491628. Distance: 1.5309080403801483
Total norm for 5 adversaries is: 13.901630311491628. distance: 1.5309080403801483
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 3.9521, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 4, internal_epoch   1,  Average loss: 0.0042, Accuracy: 7646/8146 (93.8620%), train_poison_data_count: 8146
Global model norm: 13.951811554572291.
Norm before scaling: 13.271666464212574. Distance: 2.5930707110948665
Total norm for 5 adversaries is: 13.271666464212574. distance: 2.5930707110948665
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 6.5635, Accuracy: 2613/8991 (29.0624%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 5, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5195/5399 (96.2215%), train_poison_data_count: 5399
Global model norm: 13.951811554572291.
Norm before scaling: 13.486204091799296. Distance: 1.924920808723774
Total norm for 5 adversaries is: 13.486204091799296. distance: 1.924920808723774
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 6.8639, Accuracy: 2139/8991 (23.7905%)
___Train Local_Simple,  epoch  10, local model 6, internal_epoch   1,  Average loss: 0.0140, Accuracy: 765/866 (88.3372%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 15.4160, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  10, local model 7, internal_epoch   1,  Average loss: 0.0090, Accuracy: 2505/2905 (86.2306%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 5.2621, Accuracy: 2896/10000 (28.9600%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  10, local model 8, internal_epoch   1,  Average loss: 0.0056, Accuracy: 6650/7219 (92.1180%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 5.1310, Accuracy: 4053/10000 (40.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 9, internal_epoch   1,  Average loss: 0.0079, Accuracy: 2440/2685 (90.8752%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 5.5992, Accuracy: 1878/10000 (18.7800%), Attack Success Rate:33/10000(0.330)
___Train Local_Simple,  epoch  10, local model 10, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5015/5617 (89.2825%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 4.6358, Accuracy: 4698/10000 (46.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0056, Accuracy: 7317/8046 (90.9396%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 4.9489, Accuracy: 2899/10000 (28.9900%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5066/5087 (99.5872%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 67.6373, Accuracy: 980/10000 (9.8000%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3351/3436 (97.5262%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 7.1246, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0100, Accuracy: 1418/1481 (95.7461%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 6.2450, Accuracy: 958/10000 (9.5800%), Attack Success Rate:5/10000(0.050)
time spent on training: 242.00558733940125
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.89281281
 0.         0.47337927 0.89281281 1.         1.         0.62656886
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 2.1265, Accuracy: 3404/10000 (34.0400%), Attack Success Rate:4/10000(0.040)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 2.1265, Accuracy: 3222/8991 (35.8358%)
Done in 271.49714517593384 sec.
Server Epoch:11 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  11, local model 0, internal_epoch   1,  Average loss: 1.0092, Accuracy: 1/2 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.1301, Accuracy: 3119/10000 (31.1900%), Attack Success Rate:2/10000(0.020)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 1, internal_epoch   1,  Average loss: 0.0083, Accuracy: 3583/4113 (87.1140%), train_poison_data_count: 4113
Global model norm: 13.958517470023008.
Norm before scaling: 13.761470379890426. Distance: 2.1908019077411818
Total norm for 5 adversaries is: 13.761470379890426. distance: 2.1908019077411818
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 4.8748, Accuracy: 2987/8991 (33.2221%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 2, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2210/2275 (97.1429%), train_poison_data_count: 2275
Global model norm: 13.958517470023008.
Norm before scaling: 13.892490120143373. Distance: 2.0233954347929055
Total norm for 5 adversaries is: 13.892490120143373. distance: 2.0233954347929055
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 42.8113, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 3, internal_epoch   1,  Average loss: 0.0117, Accuracy: 1165/1293 (90.1005%), train_poison_data_count: 1293
Global model norm: 13.958517470023008.
Norm before scaling: 13.910677292965408. Distance: 1.5426250606147687
Total norm for 5 adversaries is: 13.910677292965408. distance: 1.5426250606147687
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 4.1615, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 4, internal_epoch   1,  Average loss: 0.0039, Accuracy: 7669/8146 (94.1444%), train_poison_data_count: 8146
Global model norm: 13.958517470023008.
Norm before scaling: 13.267055259138083. Distance: 2.526254315945932
Total norm for 5 adversaries is: 13.267055259138083. distance: 2.526254315945932
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 6.6055, Accuracy: 2765/8991 (30.7530%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5220/5399 (96.6846%), train_poison_data_count: 5399
Global model norm: 13.958517470023008.
Norm before scaling: 13.486752261840714. Distance: 1.8846937729179722
Total norm for 5 adversaries is: 13.486752261840714. distance: 1.8846937729179722
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 7.2941, Accuracy: 2154/8991 (23.9573%)
___Train Local_Simple,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0117, Accuracy: 764/866 (88.2217%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 21.5908, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  11, local model 7, internal_epoch   1,  Average loss: 0.0082, Accuracy: 2550/2905 (87.7797%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 6.6885, Accuracy: 2877/10000 (28.7700%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  11, local model 8, internal_epoch   1,  Average loss: 0.0050, Accuracy: 6708/7219 (92.9215%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 5.4211, Accuracy: 4066/10000 (40.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 9, internal_epoch   1,  Average loss: 0.0079, Accuracy: 2456/2685 (91.4711%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 6.3093, Accuracy: 1890/10000 (18.9000%), Attack Success Rate:27/10000(0.270)
___Train Local_Simple,  epoch  11, local model 10, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5088/5617 (90.5822%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 3.5781, Accuracy: 4587/10000 (45.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 7290/8046 (90.6040%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 5.0534, Accuracy: 2870/10000 (28.7000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  11, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5063/5087 (99.5282%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 63.1415, Accuracy: 980/10000 (9.8000%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  11, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3350/3436 (97.4971%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 7.9382, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0093, Accuracy: 1417/1481 (95.6786%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 6.0471, Accuracy: 958/10000 (9.5800%), Attack Success Rate:9/10000(0.090)
time spent on training: 252.58457899093628
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.87800563
 0.         0.45613012 0.87800563 1.         1.         0.67867944
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 2.0976, Accuracy: 3557/10000 (35.5700%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 2.0984, Accuracy: 3327/8991 (37.0037%)
Done in 281.63990020751953 sec.
Server Epoch:12 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  12, local model 0, internal_epoch   1,  Average loss: 0.9881, Accuracy: 1/2 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.1025, Accuracy: 3208/10000 (32.0800%), Attack Success Rate:2/10000(0.020)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3655/4113 (88.8646%), train_poison_data_count: 4113
Global model norm: 13.965407549807724.
Norm before scaling: 13.74592335696467. Distance: 2.0882375088216167
Total norm for 5 adversaries is: 13.74592335696467. distance: 2.0882375088216167
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 4.7660, Accuracy: 2946/8991 (32.7661%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2212/2275 (97.2308%), train_poison_data_count: 2275
Global model norm: 13.965407549807724.
Norm before scaling: 13.896013173889346. Distance: 2.0158112905599994
Total norm for 5 adversaries is: 13.896013173889346. distance: 2.0158112905599994
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 40.7872, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 3, internal_epoch   1,  Average loss: 0.0119, Accuracy: 1172/1293 (90.6419%), train_poison_data_count: 1293
Global model norm: 13.965407549807724.
Norm before scaling: 13.916683235082452. Distance: 1.5584413841173148
Total norm for 5 adversaries is: 13.916683235082452. distance: 1.5584413841173148
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 3.9197, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 7712/8146 (94.6722%), train_poison_data_count: 8146
Global model norm: 13.965407549807724.
Norm before scaling: 13.257752076136613. Distance: 2.4605142865261356
Total norm for 5 adversaries is: 13.257752076136613. distance: 2.4605142865261356
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 6.1035, Accuracy: 2703/8991 (30.0634%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 5, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5215/5399 (96.5920%), train_poison_data_count: 5399
Global model norm: 13.965407549807724.
Norm before scaling: 13.48899279545149. Distance: 1.8367999060130678
Total norm for 5 adversaries is: 13.48899279545149. distance: 1.8367999060130678
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 8.8167, Accuracy: 2152/8991 (23.9350%)
___Train Local_Simple,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0143, Accuracy: 765/866 (88.3372%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 19.2918, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  12, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 2525/2905 (86.9191%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 5.9158, Accuracy: 2904/10000 (29.0400%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  12, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 6713/7219 (92.9907%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 5.9807, Accuracy: 4033/10000 (40.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 9, internal_epoch   1,  Average loss: 0.0073, Accuracy: 2460/2685 (91.6201%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 5.2464, Accuracy: 1874/10000 (18.7400%), Attack Success Rate:30/10000(0.300)
___Train Local_Simple,  epoch  12, local model 10, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5141/5617 (91.5257%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 4.1743, Accuracy: 4755/10000 (47.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 7305/8046 (90.7905%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 5.3553, Accuracy: 2890/10000 (28.9000%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  12, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5062/5087 (99.5086%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 60.5419, Accuracy: 980/10000 (9.8000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  12, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3350/3436 (97.4971%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 6.5589, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  12, local model 14, internal_epoch   1,  Average loss: 0.0084, Accuracy: 1417/1481 (95.6786%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 5.2756, Accuracy: 958/10000 (9.5800%), Attack Success Rate:6/10000(0.060)
time spent on training: 253.5276198387146
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.8707458  1.         0.         0.         1.         1.
 0.         0.70941734 1.         1.         1.         0.79107627
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 2.0654, Accuracy: 3856/10000 (38.5600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 2.0676, Accuracy: 3536/8991 (39.3282%)
Done in 282.5546727180481 sec.
Server Epoch:13 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  13, local model 0, internal_epoch   1,  Average loss: 0.9652, Accuracy: 1/2 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.0715, Accuracy: 3389/10000 (33.8900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 1, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3666/4113 (89.1320%), train_poison_data_count: 4113
Global model norm: 13.97275453383102.
Norm before scaling: 13.76441560557115. Distance: 2.1256928155989665
Total norm for 5 adversaries is: 13.76441560557115. distance: 2.1256928155989665
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 4.4613, Accuracy: 2962/8991 (32.9441%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2213/2275 (97.2747%), train_poison_data_count: 2275
Global model norm: 13.97275453383102.
Norm before scaling: 13.909741047053815. Distance: 2.050908082945494
Total norm for 5 adversaries is: 13.909741047053815. distance: 2.050908082945494
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 43.2093, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 3, internal_epoch   1,  Average loss: 0.0114, Accuracy: 1167/1293 (90.2552%), train_poison_data_count: 1293
Global model norm: 13.97275453383102.
Norm before scaling: 13.92417099298184. Distance: 1.5729852960363713
Total norm for 5 adversaries is: 13.92417099298184. distance: 1.5729852960363713
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 3.8263, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 7757/8146 (95.2247%), train_poison_data_count: 8146
Global model norm: 13.97275453383102.
Norm before scaling: 13.260993859054562. Distance: 2.4281109665866487
Total norm for 5 adversaries is: 13.260993859054562. distance: 2.4281109665866487
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 6.4474, Accuracy: 2769/8991 (30.7975%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5228/5399 (96.8327%), train_poison_data_count: 5399
Global model norm: 13.97275453383102.
Norm before scaling: 13.496268993073546. Distance: 1.8159968745461006
Total norm for 5 adversaries is: 13.496268993073546. distance: 1.8159968745461006
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 8.2501, Accuracy: 2150/8991 (23.9128%)
___Train Local_Simple,  epoch  13, local model 6, internal_epoch   1,  Average loss: 0.0131, Accuracy: 765/866 (88.3372%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 14.6365, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 2603/2905 (89.6041%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 4.9572, Accuracy: 2897/10000 (28.9700%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  13, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 6752/7219 (93.5310%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 5.2286, Accuracy: 4081/10000 (40.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 9, internal_epoch   1,  Average loss: 0.0079, Accuracy: 2478/2685 (92.2905%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 5.1582, Accuracy: 1898/10000 (18.9800%), Attack Success Rate:28/10000(0.280)
___Train Local_Simple,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 5147/5617 (91.6325%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 3.9982, Accuracy: 4694/10000 (46.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0049, Accuracy: 7379/8046 (91.7102%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 5.7618, Accuracy: 2896/10000 (28.9600%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  13, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5058/5087 (99.4299%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 60.3953, Accuracy: 980/10000 (9.8000%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  13, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3348/3436 (97.4389%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 7.6208, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0072, Accuracy: 1417/1481 (95.6786%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 5.8221, Accuracy: 958/10000 (9.5800%), Attack Success Rate:5/10000(0.050)
time spent on training: 260.15587520599365
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         1.
 0.         0.32658426 1.         1.         1.         0.52783991
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 2.0326, Accuracy: 4016/10000 (40.1600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 2.0364, Accuracy: 3569/8991 (39.6953%)
Done in 289.48062205314636 sec.
Server Epoch:14 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  14, local model 0, internal_epoch   1,  Average loss: 0.9495, Accuracy: 1/2 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.0398, Accuracy: 3763/10000 (37.6300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 1, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3740/4113 (90.9312%), train_poison_data_count: 4113
Global model norm: 13.979811144250348.
Norm before scaling: 13.76779299755184. Distance: 2.051200896424501
Total norm for 5 adversaries is: 13.76779299755184. distance: 2.051200896424501
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 5.9794, Accuracy: 2991/8991 (33.2666%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 2214/2275 (97.3187%), train_poison_data_count: 2275
Global model norm: 13.979811144250348.
Norm before scaling: 13.929249874820801. Distance: 2.1049263844790222
Total norm for 5 adversaries is: 13.929249874820801. distance: 2.1049263844790222
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 49.7873, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 3, internal_epoch   1,  Average loss: 0.0113, Accuracy: 1165/1293 (90.1005%), train_poison_data_count: 1293
Global model norm: 13.979811144250348.
Norm before scaling: 13.934948880170632. Distance: 1.6282521496580962
Total norm for 5 adversaries is: 13.934948880170632. distance: 1.6282521496580962
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 3.6541, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 7740/8146 (95.0160%), train_poison_data_count: 8146
Global model norm: 13.979811144250348.
Norm before scaling: 13.276150790404962. Distance: 2.4472529600505286
Total norm for 5 adversaries is: 13.276150790404962. distance: 2.4472529600505286
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 6.5244, Accuracy: 2644/8991 (29.4072%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5251/5399 (97.2588%), train_poison_data_count: 5399
Global model norm: 13.979811144250348.
Norm before scaling: 13.498215734049063. Distance: 1.7640164905694204
Total norm for 5 adversaries is: 13.498215734049063. distance: 1.7640164905694204
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 9.5555, Accuracy: 2117/8991 (23.5458%)
___Train Local_Simple,  epoch  14, local model 6, internal_epoch   1,  Average loss: 0.0134, Accuracy: 762/866 (87.9908%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 16.7693, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0067, Accuracy: 2638/2905 (90.8090%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 10.2985, Accuracy: 2885/10000 (28.8500%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  14, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 6757/7219 (93.6002%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 6.1777, Accuracy: 4058/10000 (40.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 9, internal_epoch   1,  Average loss: 0.0074, Accuracy: 2472/2685 (92.0670%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 5.2018, Accuracy: 1887/10000 (18.8700%), Attack Success Rate:38/10000(0.380)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5176/5617 (92.1488%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 4.4872, Accuracy: 4592/10000 (45.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 11, internal_epoch   1,  Average loss: 0.0049, Accuracy: 7378/8046 (91.6977%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 5.3209, Accuracy: 2870/10000 (28.7000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 5055/5087 (99.3709%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 58.0261, Accuracy: 980/10000 (9.8000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  14, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3345/3436 (97.3516%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 7.5362, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  14, local model 14, internal_epoch   1,  Average loss: 0.0074, Accuracy: 1414/1481 (95.4760%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 5.9611, Accuracy: 958/10000 (9.5800%), Attack Success Rate:4/10000(0.040)
time spent on training: 266.79725885391235
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.96183814
 0.         0.61443183 0.96183814 1.         1.         0.87657423
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.9964, Accuracy: 4177/10000 (41.7700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 2.0014, Accuracy: 3685/8991 (40.9854%)
Done in 295.61166191101074 sec.
Server Epoch:15 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.9235, Accuracy: 1/2 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.0056, Accuracy: 3803/10000 (38.0300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3716/4113 (90.3477%), train_poison_data_count: 4113
Global model norm: 13.987583649004234.
Norm before scaling: 13.784255203975306. Distance: 2.122376898620644
Total norm for 5 adversaries is: 13.784255203975306. distance: 2.122376898620644
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 4.4638, Accuracy: 3000/8991 (33.3667%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2215/2275 (97.3626%), train_poison_data_count: 2275
Global model norm: 13.987583649004234.
Norm before scaling: 13.917212256665136. Distance: 2.038374861603237
Total norm for 5 adversaries is: 13.917212256665136. distance: 2.038374861603237
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 36.6124, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 3, internal_epoch   1,  Average loss: 0.0103, Accuracy: 1170/1293 (90.4872%), train_poison_data_count: 1293
Global model norm: 13.987583649004234.
Norm before scaling: 13.941710516082946. Distance: 1.606542817377166
Total norm for 5 adversaries is: 13.941710516082946. distance: 1.606542817377166
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 3.8816, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 7744/8146 (95.0651%), train_poison_data_count: 8146
Global model norm: 13.987583649004234.
Norm before scaling: 13.282736015211801. Distance: 2.43424653288473
Total norm for 5 adversaries is: 13.282736015211801. distance: 2.43424653288473
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 5.8785, Accuracy: 2702/8991 (30.0523%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5253/5399 (97.2958%), train_poison_data_count: 5399
Global model norm: 13.987583649004234.
Norm before scaling: 13.507692194193867. Distance: 1.7729658936578143
Total norm for 5 adversaries is: 13.507692194193867. distance: 1.7729658936578143
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 7.4461, Accuracy: 2146/8991 (23.8683%)
___Train Local_Simple,  epoch  15, local model 6, internal_epoch   1,  Average loss: 0.0133, Accuracy: 772/866 (89.1455%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 15.7210, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  15, local model 7, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2639/2905 (90.8434%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 8.9769, Accuracy: 2904/10000 (29.0400%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  15, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 6781/7219 (93.9327%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 5.6155, Accuracy: 4065/10000 (40.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 9, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2510/2685 (93.4823%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 4.5921, Accuracy: 1904/10000 (19.0400%), Attack Success Rate:28/10000(0.280)
___Train Local_Simple,  epoch  15, local model 10, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5195/5617 (92.4871%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 4.3203, Accuracy: 4681/10000 (46.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 11, internal_epoch   1,  Average loss: 0.0046, Accuracy: 7402/8046 (91.9960%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 5.7716, Accuracy: 2874/10000 (28.7400%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 5065/5087 (99.5675%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 56.3358, Accuracy: 980/10000 (9.8000%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3356/3436 (97.6717%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 6.8950, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0064, Accuracy: 1417/1481 (95.6786%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 5.1669, Accuracy: 958/10000 (9.5800%), Attack Success Rate:5/10000(0.050)
time spent on training: 271.2019000053406
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.95359279 1.         0.         0.         1.         0.87489642
 0.         0.74129755 0.87489642 1.         1.         0.84890305
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 1.9579, Accuracy: 4409/10000 (44.0900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 1.9648, Accuracy: 3837/8991 (42.6760%)
Done in 299.99711418151855 sec.
Server Epoch:16 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  16, local model 0, internal_epoch   1,  Average loss: 0.8992, Accuracy: 1/2 (50.0000%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.9689, Accuracy: 3922/10000 (39.2200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 1, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3680/4113 (89.4724%), train_poison_data_count: 4113
Global model norm: 13.995527915578682.
Norm before scaling: 13.794883575667138. Distance: 2.1118663627581102
Total norm for 5 adversaries is: 13.794883575667138. distance: 2.1118663627581102
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 4.8415, Accuracy: 2995/8991 (33.3111%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2214/2275 (97.3187%), train_poison_data_count: 2275
Global model norm: 13.995527915578682.
Norm before scaling: 13.935021697576005. Distance: 2.073241957504109
Total norm for 5 adversaries is: 13.935021697576005. distance: 2.073241957504109
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 43.0543, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 3, internal_epoch   1,  Average loss: 0.0106, Accuracy: 1179/1293 (91.1833%), train_poison_data_count: 1293
Global model norm: 13.995527915578682.
Norm before scaling: 13.948934884923226. Distance: 1.618619496744398
Total norm for 5 adversaries is: 13.948934884923226. distance: 1.618619496744398
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 3.6790, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 7779/8146 (95.4947%), train_poison_data_count: 8146
Global model norm: 13.995527915578682.
Norm before scaling: 13.285777031769374. Distance: 2.4285989266930468
Total norm for 5 adversaries is: 13.285777031769374. distance: 2.4285989266930468
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 5.9421, Accuracy: 2677/8991 (29.7742%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 5, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5247/5399 (97.1847%), train_poison_data_count: 5399
Global model norm: 13.995527915578682.
Norm before scaling: 13.501937727144771. Distance: 1.7064006696976046
Total norm for 5 adversaries is: 13.501937727144771. distance: 1.7064006696976046
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 8.5506, Accuracy: 2140/8991 (23.8016%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0123, Accuracy: 772/866 (89.1455%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 13.5572, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  16, local model 7, internal_epoch   1,  Average loss: 0.0066, Accuracy: 2623/2905 (90.2926%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 5.0825, Accuracy: 2899/10000 (28.9900%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0040, Accuracy: 6813/7219 (94.3760%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 6.3650, Accuracy: 4029/10000 (40.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2524/2685 (94.0037%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 4.7076, Accuracy: 1989/10000 (19.8900%), Attack Success Rate:34/10000(0.340)
___Train Local_Simple,  epoch  16, local model 10, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5220/5617 (92.9322%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 4.3191, Accuracy: 4698/10000 (46.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0045, Accuracy: 7440/8046 (92.4683%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 4.4439, Accuracy: 3012/10000 (30.1200%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 5060/5087 (99.4692%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 52.5823, Accuracy: 980/10000 (9.8000%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3356/3436 (97.6717%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 7.9829, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  16, local model 14, internal_epoch   1,  Average loss: 0.0059, Accuracy: 1422/1481 (96.0162%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 5.4346, Accuracy: 959/10000 (9.5900%), Attack Success Rate:6/10000(0.060)
time spent on training: 274.50724387168884
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.8611321
 0.         0.33752115 0.8611321  1.         1.         0.56981183
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 1.9241, Accuracy: 4518/10000 (45.1800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 1.9315, Accuracy: 3904/8991 (43.4212%)
Done in 303.4515452384949 sec.
Server Epoch:17 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  17, local model 0, internal_epoch   1,  Average loss: 0.8763, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.9367, Accuracy: 4001/10000 (40.0100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3746/4113 (91.0771%), train_poison_data_count: 4113
Global model norm: 14.002588305311518.
Norm before scaling: 13.787012396289114. Distance: 2.00791758696448
Total norm for 5 adversaries is: 13.787012396289114. distance: 2.00791758696448
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 5.2683, Accuracy: 3035/8991 (33.7560%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2219/2275 (97.5385%), train_poison_data_count: 2275
Global model norm: 14.002588305311518.
Norm before scaling: 13.952668424955773. Distance: 2.11397113926873
Total norm for 5 adversaries is: 13.952668424955773. distance: 2.11397113926873
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 49.2724, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 3, internal_epoch   1,  Average loss: 0.0101, Accuracy: 1177/1293 (91.0286%), train_poison_data_count: 1293
Global model norm: 14.002588305311518.
Norm before scaling: 13.957912943568404. Distance: 1.6506957725712497
Total norm for 5 adversaries is: 13.957912943568404. distance: 1.6506957725712497
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 3.5838, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 7794/8146 (95.6789%), train_poison_data_count: 8146
Global model norm: 14.002588305311518.
Norm before scaling: 13.279208827522856. Distance: 2.3483188094084113
Total norm for 5 adversaries is: 13.279208827522856. distance: 2.3483188094084113
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 6.3572, Accuracy: 2744/8991 (30.5194%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 5, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5248/5399 (97.2032%), train_poison_data_count: 5399
Global model norm: 14.002588305311518.
Norm before scaling: 13.505558141299003. Distance: 1.6889509391818873
Total norm for 5 adversaries is: 13.505558141299003. distance: 1.6889509391818873
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 6.8825, Accuracy: 2148/8991 (23.8906%)
___Train Local_Simple,  epoch  17, local model 6, internal_epoch   1,  Average loss: 0.0129, Accuracy: 766/866 (88.4527%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 9.6500, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  17, local model 7, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2679/2905 (92.2203%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 8.2822, Accuracy: 2878/10000 (28.7800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  17, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6821/7219 (94.4868%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 5.6059, Accuracy: 4080/10000 (40.8000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  17, local model 9, internal_epoch   1,  Average loss: 0.0062, Accuracy: 2503/2685 (93.2216%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 5.0831, Accuracy: 1896/10000 (18.9600%), Attack Success Rate:23/10000(0.230)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5245/5617 (93.3772%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 4.3687, Accuracy: 4705/10000 (47.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 11, internal_epoch   1,  Average loss: 0.0044, Accuracy: 7454/8046 (92.6423%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 4.7973, Accuracy: 2924/10000 (29.2400%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  17, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 5062/5087 (99.5086%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 50.1875, Accuracy: 980/10000 (9.8000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3353/3436 (97.5844%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 5.9210, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  17, local model 14, internal_epoch   1,  Average loss: 0.0058, Accuracy: 1420/1481 (95.8812%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 4.8788, Accuracy: 1005/10000 (10.0500%), Attack Success Rate:8/10000(0.080)
time spent on training: 279.4510190486908
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.88164411 1.         0.         0.         1.         1.
 0.         0.82524897 1.         1.         1.         0.85354736
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 1.8819, Accuracy: 4744/10000 (47.4400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 1.8922, Accuracy: 4057/8991 (45.1229%)
Done in 308.3068308830261 sec.
Server Epoch:18 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  18, local model 0, internal_epoch   1,  Average loss: 0.8505, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.8968, Accuracy: 4154/10000 (41.5400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3756/4113 (91.3202%), train_poison_data_count: 4113
Global model norm: 14.01073371311037.
Norm before scaling: 13.797765821856983. Distance: 2.012477694559583
Total norm for 5 adversaries is: 13.797765821856983. distance: 2.012477694559583
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 4.3929, Accuracy: 3533/8991 (39.2949%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2213/2275 (97.2747%), train_poison_data_count: 2275
Global model norm: 14.01073371311037.
Norm before scaling: 13.93536880689491. Distance: 2.028562557941745
Total norm for 5 adversaries is: 13.93536880689491. distance: 2.028562557941745
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 33.8628, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 3, internal_epoch   1,  Average loss: 0.0095, Accuracy: 1182/1293 (91.4153%), train_poison_data_count: 1293
Global model norm: 14.01073371311037.
Norm before scaling: 13.972483705602247. Distance: 1.6546268066571603
Total norm for 5 adversaries is: 13.972483705602247. distance: 1.6546268066571603
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 4.7401, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0028, Accuracy: 7793/8146 (95.6666%), train_poison_data_count: 8146
Global model norm: 14.01073371311037.
Norm before scaling: 13.292514754038384. Distance: 2.3756325531889386
Total norm for 5 adversaries is: 13.292514754038384. distance: 2.3756325531889386
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 6.3710, Accuracy: 2828/8991 (31.4537%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5268/5399 (97.5736%), train_poison_data_count: 5399
Global model norm: 14.01073371311037.
Norm before scaling: 13.5116267117059. Distance: 1.6500578234395211
Total norm for 5 adversaries is: 13.5116267117059. distance: 1.6500578234395211
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 8.5263, Accuracy: 2156/8991 (23.9795%)
___Train Local_Simple,  epoch  18, local model 6, internal_epoch   1,  Average loss: 0.0107, Accuracy: 773/866 (89.2610%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 11.8084, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2679/2905 (92.2203%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 12.1413, Accuracy: 2639/10000 (26.3900%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  18, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6831/7219 (94.6253%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 5.4136, Accuracy: 4089/10000 (40.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2516/2685 (93.7058%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 4.0606, Accuracy: 2021/10000 (20.2100%), Attack Success Rate:40/10000(0.400)
___Train Local_Simple,  epoch  18, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5263/5617 (93.6977%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 4.3882, Accuracy: 4760/10000 (47.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 11, internal_epoch   1,  Average loss: 0.0042, Accuracy: 7473/8046 (92.8784%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 4.6726, Accuracy: 3017/10000 (30.1700%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0006, Accuracy: 5068/5087 (99.6265%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 48.4844, Accuracy: 980/10000 (9.8000%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  18, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3356/3436 (97.6717%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 6.2514, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0067, Accuracy: 1426/1481 (96.2863%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 4.2783, Accuracy: 958/10000 (9.5800%), Attack Success Rate:6/10000(0.060)
time spent on training: 283.3816740512848
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.85249952 1.         0.         0.         1.         0.91571077
 0.         0.83722395 0.91571077 1.         1.         0.83160242
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 1.8372, Accuracy: 5044/10000 (50.4400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 1.8523, Accuracy: 4285/8991 (47.6588%)
Done in 312.1878969669342 sec.
Server Epoch:19 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  19, local model 0, internal_epoch   1,  Average loss: 0.8280, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.8542, Accuracy: 4363/10000 (43.6300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 1, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3756/4113 (91.3202%), train_poison_data_count: 4113
Global model norm: 14.018634383753346.
Norm before scaling: 13.790991145221511. Distance: 1.936592504796135
Total norm for 5 adversaries is: 13.790991145221511. distance: 1.936592504796135
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 4.3074, Accuracy: 3623/8991 (40.2959%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 2, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2214/2275 (97.3187%), train_poison_data_count: 2275
Global model norm: 14.018634383753346.
Norm before scaling: 13.949817637136874. Distance: 2.0690724239736493
Total norm for 5 adversaries is: 13.949817637136874. distance: 2.0690724239736493
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 37.2037, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0094, Accuracy: 1190/1293 (92.0340%), train_poison_data_count: 1293
Global model norm: 14.018634383753346.
Norm before scaling: 13.973601930186803. Distance: 1.6301736635009159
Total norm for 5 adversaries is: 13.973601930186803. distance: 1.6301736635009159
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 3.7239, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0029, Accuracy: 7792/8146 (95.6543%), train_poison_data_count: 8146
Global model norm: 14.018634383753346.
Norm before scaling: 13.302504247798431. Distance: 2.383404767582043
Total norm for 5 adversaries is: 13.302504247798431. distance: 2.383404767582043
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 6.3629, Accuracy: 2719/8991 (30.2414%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5276/5399 (97.7218%), train_poison_data_count: 5399
Global model norm: 14.018634383753346.
Norm before scaling: 13.521940698325201. Distance: 1.6410995523683782
Total norm for 5 adversaries is: 13.521940698325201. distance: 1.6410995523683782
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 7.5699, Accuracy: 2124/8991 (23.6236%)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0113, Accuracy: 783/866 (90.4157%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 11.3269, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  19, local model 7, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2694/2905 (92.7367%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 8.6304, Accuracy: 2911/10000 (29.1100%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 6843/7219 (94.7915%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 5.4034, Accuracy: 4001/10000 (40.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2523/2685 (93.9665%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 6.1369, Accuracy: 1911/10000 (19.1100%), Attack Success Rate:22/10000(0.220)
___Train Local_Simple,  epoch  19, local model 10, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5231/5617 (93.1280%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 4.2320, Accuracy: 4759/10000 (47.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 11, internal_epoch   1,  Average loss: 0.0041, Accuracy: 7489/8046 (93.0773%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 4.8738, Accuracy: 2993/10000 (29.9300%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  19, local model 12, internal_epoch   1,  Average loss: 0.0006, Accuracy: 5066/5087 (99.5872%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 46.4830, Accuracy: 980/10000 (9.8000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  19, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3355/3436 (97.6426%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 6.5727, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  19, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 1426/1481 (96.2863%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 4.8295, Accuracy: 1292/10000 (12.9200%), Attack Success Rate:15/10000(0.150)
time spent on training: 287.88998103141785
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.95564435 1.         0.         0.         1.         0.78979816
 0.         0.56966102 0.78979816 1.         1.         0.8067955
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 1.7971, Accuracy: 5188/10000 (51.8800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 1.8140, Accuracy: 4383/8991 (48.7487%)
Done in 316.5827260017395 sec.
Server Epoch:20 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  20, local model 0, internal_epoch   1,  Average loss: 0.8041, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.8161, Accuracy: 4460/10000 (44.6000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3824/4113 (92.9735%), train_poison_data_count: 4113
Global model norm: 14.026249391660992.
Norm before scaling: 13.7984774426865. Distance: 1.8859345443184106
Total norm for 5 adversaries is: 13.7984774426865. distance: 1.8859345443184106
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 4.6575, Accuracy: 3578/8991 (39.7954%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 2, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2215/2275 (97.3626%), train_poison_data_count: 2275
Global model norm: 14.026249391660992.
Norm before scaling: 13.950504548167334. Distance: 2.0265190784564306
Total norm for 5 adversaries is: 13.950504548167334. distance: 2.0265190784564306
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 34.0458, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 3, internal_epoch   1,  Average loss: 0.0097, Accuracy: 1190/1293 (92.0340%), train_poison_data_count: 1293
Global model norm: 14.026249391660992.
Norm before scaling: 13.992722390843984. Distance: 1.6810808656838563
Total norm for 5 adversaries is: 13.992722390843984. distance: 1.6810808656838563
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 4.9605, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 4, internal_epoch   1,  Average loss: 0.0027, Accuracy: 7805/8146 (95.8139%), train_poison_data_count: 8146
Global model norm: 14.026249391660992.
Norm before scaling: 13.296181863544042. Distance: 2.337970066234624
Total norm for 5 adversaries is: 13.296181863544042. distance: 2.337970066234624
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 5.0862, Accuracy: 2824/8991 (31.4092%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5290/5399 (97.9811%), train_poison_data_count: 5399
Global model norm: 14.026249391660992.
Norm before scaling: 13.517887838933143. Distance: 1.5923809080043498
Total norm for 5 adversaries is: 13.517887838933143. distance: 1.5923809080043498
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 8.3619, Accuracy: 2152/8991 (23.9350%)
___Train Local_Simple,  epoch  20, local model 6, internal_epoch   1,  Average loss: 0.0107, Accuracy: 783/866 (90.4157%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 11.0095, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  20, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2710/2905 (93.2874%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 7.2485, Accuracy: 2898/10000 (28.9800%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 6831/7219 (94.6253%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 5.1510, Accuracy: 4071/10000 (40.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2566/2685 (95.5680%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 5.0037, Accuracy: 2107/10000 (21.0700%), Attack Success Rate:23/10000(0.230)
___Train Local_Simple,  epoch  20, local model 10, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5296/5617 (94.2852%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 3.8794, Accuracy: 4694/10000 (46.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0039, Accuracy: 7497/8046 (93.1767%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 5.2046, Accuracy: 2906/10000 (29.0600%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0006, Accuracy: 5070/5087 (99.6658%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 45.7458, Accuracy: 980/10000 (9.8000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3356/3436 (97.6717%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 6.1369, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  20, local model 14, internal_epoch   1,  Average loss: 0.0054, Accuracy: 1429/1481 (96.4889%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 5.0088, Accuracy: 1303/10000 (13.0300%), Attack Success Rate:20/10000(0.200)
time spent on training: 293.62198185920715
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.88396747
 0.         0.46164591 0.88396747 1.         1.         0.82056031
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 1.7544, Accuracy: 5395/10000 (53.9500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 1.7738, Accuracy: 4493/8991 (49.9722%)
Done in 322.72035574913025 sec.
Server Epoch:21 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  21, local model 0, internal_epoch   1,  Average loss: 0.7810, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.7751, Accuracy: 4622/10000 (46.2200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 1, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3828/4113 (93.0708%), train_poison_data_count: 4113
Global model norm: 14.033997264629662.
Norm before scaling: 13.805886735190967. Distance: 1.8810508369134675
Total norm for 5 adversaries is: 13.805886735190967. distance: 1.8810508369134675
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 4.7999, Accuracy: 3448/8991 (38.3495%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 2, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2220/2275 (97.5824%), train_poison_data_count: 2275
Global model norm: 14.033997264629662.
Norm before scaling: 13.964128041100246. Distance: 2.0387194114649723
Total norm for 5 adversaries is: 13.964128041100246. distance: 2.0387194114649723
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 38.4422, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 3, internal_epoch   1,  Average loss: 0.0081, Accuracy: 1189/1293 (91.9567%), train_poison_data_count: 1293
Global model norm: 14.033997264629662.
Norm before scaling: 13.995302774711927. Distance: 1.63464471695763
Total norm for 5 adversaries is: 13.995302774711927. distance: 1.63464471695763
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 4.2799, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 4, internal_epoch   1,  Average loss: 0.0026, Accuracy: 7810/8146 (95.8753%), train_poison_data_count: 8146
Global model norm: 14.033997264629662.
Norm before scaling: 13.295446801053677. Distance: 2.3103194394878788
Total norm for 5 adversaries is: 13.295446801053677. distance: 2.3103194394878788
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 5.9198, Accuracy: 2845/8991 (31.6428%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5279/5399 (97.7774%), train_poison_data_count: 5399
Global model norm: 14.033997264629662.
Norm before scaling: 13.524084577059584. Distance: 1.5753673215959096
Total norm for 5 adversaries is: 13.524084577059584. distance: 1.5753673215959096
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 7.6008, Accuracy: 2145/8991 (23.8572%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0107, Accuracy: 782/866 (90.3002%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 9.7090, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  21, local model 7, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2700/2905 (92.9432%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 6.0806, Accuracy: 2910/10000 (29.1000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  21, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 6905/7219 (95.6504%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 5.1362, Accuracy: 4084/10000 (40.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2530/2685 (94.2272%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 4.2631, Accuracy: 2066/10000 (20.6600%), Attack Success Rate:30/10000(0.300)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5294/5617 (94.2496%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 3.9132, Accuracy: 4630/10000 (46.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 11, internal_epoch   1,  Average loss: 0.0036, Accuracy: 7569/8046 (94.0716%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 4.6404, Accuracy: 3082/10000 (30.8200%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 5063/5087 (99.5282%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 40.6176, Accuracy: 980/10000 (9.8000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  21, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3362/3436 (97.8463%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 6.5225, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   1,  Average loss: 0.0045, Accuracy: 1436/1481 (96.9615%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 5.1043, Accuracy: 1399/10000 (13.9900%), Attack Success Rate:25/10000(0.250)
time spent on training: 297.5400290489197
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.64864016
 0.         0.23988704 0.64864016 1.         1.         0.48532573
 1.         0.         0.70401122]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 1.7195, Accuracy: 5519/10000 (55.1900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 1.7399, Accuracy: 4555/8991 (50.6618%)
Done in 327.002760887146 sec.
Server Epoch:22 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  22, local model 0, internal_epoch   1,  Average loss: 0.7615, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.7423, Accuracy: 4755/10000 (47.5500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3813/4113 (92.7061%), train_poison_data_count: 4113
Global model norm: 14.040504716892414.
Norm before scaling: 13.823599519897972. Distance: 1.9085866646121807
Total norm for 5 adversaries is: 13.823599519897972. distance: 1.9085866646121807
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 5.1872, Accuracy: 3182/8991 (35.3909%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 2, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2214/2275 (97.3187%), train_poison_data_count: 2275
Global model norm: 14.040504716892414.
Norm before scaling: 13.967701302916668. Distance: 2.0296213516603836
Total norm for 5 adversaries is: 13.967701302916668. distance: 2.0296213516603836
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 36.8013, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 3, internal_epoch   1,  Average loss: 0.0098, Accuracy: 1185/1293 (91.6473%), train_poison_data_count: 1293
Global model norm: 14.040504716892414.
Norm before scaling: 14.016525869006323. Distance: 1.7488506493769826
Total norm for 5 adversaries is: 14.016525869006323. distance: 1.7488506493769826
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 6.2210, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0027, Accuracy: 7812/8146 (95.8998%), train_poison_data_count: 8146
Global model norm: 14.040504716892414.
Norm before scaling: 13.320250641351967. Distance: 2.369487790477341
Total norm for 5 adversaries is: 13.320250641351967. distance: 2.369487790477341
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 6.2706, Accuracy: 2603/8991 (28.9512%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5273/5399 (97.6662%), train_poison_data_count: 5399
Global model norm: 14.040504716892414.
Norm before scaling: 13.533755451503243. Distance: 1.567700999634615
Total norm for 5 adversaries is: 13.533755451503243. distance: 1.567700999634615
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 6.9307, Accuracy: 2155/8991 (23.9684%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0104, Accuracy: 781/866 (90.1848%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 7.1242, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2718/2905 (93.5628%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 7.9438, Accuracy: 2858/10000 (28.5800%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0032, Accuracy: 6892/7219 (95.4703%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 5.4389, Accuracy: 4053/10000 (40.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2544/2685 (94.7486%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 4.1334, Accuracy: 2142/10000 (21.4200%), Attack Success Rate:22/10000(0.220)
___Train Local_Simple,  epoch  22, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5313/5617 (94.5879%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 3.8924, Accuracy: 4778/10000 (47.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 11, internal_epoch   1,  Average loss: 0.0035, Accuracy: 7595/8046 (94.3947%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 5.6574, Accuracy: 2863/10000 (28.6300%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  22, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 5071/5087 (99.6855%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 43.9122, Accuracy: 980/10000 (9.8000%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  22, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3362/3436 (97.8463%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 6.0503, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  22, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 1428/1481 (96.4213%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 4.0788, Accuracy: 1613/10000 (16.1300%), Attack Success Rate:29/10000(0.290)
time spent on training: 306.30283188819885
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.92879534 1.         0.         0.         1.         0.91674278
 0.         0.48651602 0.91674278 1.         1.         0.83292173
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 1.6768, Accuracy: 5682/10000 (56.8200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 1.6994, Accuracy: 4674/8991 (51.9853%)
Done in 336.18251395225525 sec.
Server Epoch:23 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  23, local model 0, internal_epoch   1,  Average loss: 0.7355, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.7015, Accuracy: 4889/10000 (48.8900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 1, internal_epoch   1,  Average loss: 0.0050, Accuracy: 3853/4113 (93.6786%), train_poison_data_count: 4113
Global model norm: 14.048427203241138.
Norm before scaling: 13.81544428726388. Distance: 1.8196170116767292
Total norm for 5 adversaries is: 13.81544428726388. distance: 1.8196170116767292
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 4.1598, Accuracy: 3546/8991 (39.4394%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 2, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2218/2275 (97.4945%), train_poison_data_count: 2275
Global model norm: 14.048427203241138.
Norm before scaling: 13.972095472916612. Distance: 2.0351041175769513
Total norm for 5 adversaries is: 13.972095472916612. distance: 2.0351041175769513
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 33.5620, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   1,  Average loss: 0.0078, Accuracy: 1190/1293 (92.0340%), train_poison_data_count: 1293
Global model norm: 14.048427203241138.
Norm before scaling: 14.000160216368396. Distance: 1.631725405699845
Total norm for 5 adversaries is: 14.000160216368396. distance: 1.631725405699845
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 3.4371, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 4, internal_epoch   1,  Average loss: 0.0025, Accuracy: 7835/8146 (96.1822%), train_poison_data_count: 8146
Global model norm: 14.048427203241138.
Norm before scaling: 13.305248309158284. Distance: 2.270775248866668
Total norm for 5 adversaries is: 13.305248309158284. distance: 2.270775248866668
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 6.3770, Accuracy: 2605/8991 (28.9734%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 5, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5286/5399 (97.9070%), train_poison_data_count: 5399
Global model norm: 14.048427203241138.
Norm before scaling: 13.529898983507092. Distance: 1.518224944102815
Total norm for 5 adversaries is: 13.529898983507092. distance: 1.518224944102815
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 7.4731, Accuracy: 2152/8991 (23.9350%)
___Train Local_Simple,  epoch  23, local model 6, internal_epoch   1,  Average loss: 0.0112, Accuracy: 785/866 (90.6467%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 12.8508, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  23, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2715/2905 (93.4596%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.3195, Accuracy: 2902/10000 (29.0200%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  23, local model 8, internal_epoch   1,  Average loss: 0.0032, Accuracy: 6895/7219 (95.5118%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.2191, Accuracy: 4081/10000 (40.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2560/2685 (95.3445%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.7777, Accuracy: 2240/10000 (22.4000%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5296/5617 (94.2852%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.0818, Accuracy: 4758/10000 (47.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 11, internal_epoch   1,  Average loss: 0.0036, Accuracy: 7549/8046 (93.8230%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 4.8439, Accuracy: 2996/10000 (29.9600%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 5071/5087 (99.6855%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 40.3567, Accuracy: 980/10000 (9.8000%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  23, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3365/3436 (97.9336%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.5463, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   1,  Average loss: 0.0045, Accuracy: 1431/1481 (96.6239%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 5.0787, Accuracy: 1534/10000 (15.3400%), Attack Success Rate:12/10000(0.120)
time spent on training: 307.96308302879333
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.71418589
 0.         0.28073287 0.71418589 1.         1.         0.84374237
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 1.6383, Accuracy: 5792/10000 (57.9200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 1.6622, Accuracy: 4735/8991 (52.6638%)
Done in 336.763778924942 sec.
Server Epoch:24 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  24, local model 0, internal_epoch   1,  Average loss: 0.7063, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.6671, Accuracy: 4957/10000 (49.5700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3862/4113 (93.8974%), train_poison_data_count: 4113
Global model norm: 14.055829581168226.
Norm before scaling: 13.812112794169732. Distance: 1.7497167358027115
Total norm for 5 adversaries is: 13.812112794169732. distance: 1.7497167358027115
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 5.1907, Accuracy: 3439/8991 (38.2494%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 2, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2221/2275 (97.6264%), train_poison_data_count: 2275
Global model norm: 14.055829581168226.
Norm before scaling: 13.966820773516472. Distance: 1.9810429630348179
Total norm for 5 adversaries is: 13.966820773516472. distance: 1.9810429630348179
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 28.6941, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   1,  Average loss: 0.0075, Accuracy: 1197/1293 (92.5754%), train_poison_data_count: 1293
Global model norm: 14.055829581168226.
Norm before scaling: 14.007293980921824. Distance: 1.6008856855202491
Total norm for 5 adversaries is: 14.007293980921824. distance: 1.6008856855202491
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 3.5063, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 4, internal_epoch   1,  Average loss: 0.0024, Accuracy: 7858/8146 (96.4645%), train_poison_data_count: 8146
Global model norm: 14.055829581168226.
Norm before scaling: 13.308217107416192. Distance: 2.234420455790359
Total norm for 5 adversaries is: 13.308217107416192. distance: 2.234420455790359
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 6.5947, Accuracy: 2724/8991 (30.2970%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5284/5399 (97.8700%), train_poison_data_count: 5399
Global model norm: 14.055829581168226.
Norm before scaling: 13.529896727941052. Distance: 1.5084920350074065
Total norm for 5 adversaries is: 13.529896727941052. distance: 1.5084920350074065
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 6.8783, Accuracy: 2152/8991 (23.9350%)
___Train Local_Simple,  epoch  24, local model 6, internal_epoch   1,  Average loss: 0.0099, Accuracy: 787/866 (90.8776%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 8.9704, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  24, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2758/2905 (94.9398%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 7.7042, Accuracy: 2909/10000 (29.0900%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0032, Accuracy: 6882/7219 (95.3318%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.4730, Accuracy: 4099/10000 (40.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 9, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2567/2685 (95.6052%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.3742, Accuracy: 2310/10000 (23.1000%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch  24, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5332/5617 (94.9261%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.2013, Accuracy: 4754/10000 (47.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 11, internal_epoch   1,  Average loss: 0.0034, Accuracy: 7599/8046 (94.4444%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.9672, Accuracy: 2924/10000 (29.2400%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   1,  Average loss: 0.0004, Accuracy: 5072/5087 (99.7051%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 39.3548, Accuracy: 980/10000 (9.8000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3364/3436 (97.9045%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 6.9712, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  24, local model 14, internal_epoch   1,  Average loss: 0.0043, Accuracy: 1437/1481 (97.0290%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 4.3093, Accuracy: 1526/10000 (15.2600%), Attack Success Rate:26/10000(0.260)
time spent on training: 313.2704839706421
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.93433758 1.         0.         0.         1.         0.9311102
 0.         0.46713556 0.9311102  1.         1.         0.7882996
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 1.5940, Accuracy: 5977/10000 (59.7700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 1.6207, Accuracy: 4877/8991 (54.2431%)
Done in 342.0377550125122 sec.
Server Epoch:25 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   1,  Average loss: 0.6772, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.6262, Accuracy: 5105/10000 (51.0500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3809/4113 (92.6088%), train_poison_data_count: 4113
Global model norm: 14.063728787459837.
Norm before scaling: 13.860239786823394. Distance: 1.9435532056288944
Total norm for 5 adversaries is: 13.860239786823394. distance: 1.9435532056288944
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 4.5204, Accuracy: 3476/8991 (38.6609%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 2, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2217/2275 (97.4505%), train_poison_data_count: 2275
Global model norm: 14.063728787459837.
Norm before scaling: 13.977804846266544. Distance: 1.9920709314088594
Total norm for 5 adversaries is: 13.977804846266544. distance: 1.9920709314088594
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 31.5208, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0084, Accuracy: 1194/1293 (92.3434%), train_poison_data_count: 1293
Global model norm: 14.063728787459837.
Norm before scaling: 14.02270029834577. Distance: 1.669940649451297
Total norm for 5 adversaries is: 14.02270029834577. distance: 1.669940649451297
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 4.0562, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0024, Accuracy: 7838/8146 (96.2190%), train_poison_data_count: 8146
Global model norm: 14.063728787459837.
Norm before scaling: 13.318709237274845. Distance: 2.2649483558207044
Total norm for 5 adversaries is: 13.318709237274845. distance: 2.2649483558207044
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 6.0801, Accuracy: 2777/8991 (30.8864%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 5, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5280/5399 (97.7959%), train_poison_data_count: 5399
Global model norm: 14.063728787459837.
Norm before scaling: 13.549393891576905. Distance: 1.538885270966379
Total norm for 5 adversaries is: 13.549393891576905. distance: 1.538885270966379
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 5.2639, Accuracy: 2139/8991 (23.7905%)
___Train Local_Simple,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0109, Accuracy: 790/866 (91.2240%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 8.2121, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  25, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2725/2905 (93.8038%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 6.0077, Accuracy: 2910/10000 (29.1000%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0031, Accuracy: 6898/7219 (95.5534%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.4122, Accuracy: 4104/10000 (41.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 2553/2685 (95.0838%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.7299, Accuracy: 2165/10000 (21.6500%), Attack Success Rate:26/10000(0.260)
___Train Local_Simple,  epoch  25, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5331/5617 (94.9083%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 3.7646, Accuracy: 4694/10000 (46.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 11, internal_epoch   1,  Average loss: 0.0035, Accuracy: 7569/8046 (94.0716%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 5.4486, Accuracy: 2911/10000 (29.1100%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0004, Accuracy: 5074/5087 (99.7444%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 38.7584, Accuracy: 980/10000 (9.8000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  25, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3371/3436 (98.1083%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 6.6399, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  25, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 1441/1481 (97.2991%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 4.8556, Accuracy: 1586/10000 (15.8600%), Attack Success Rate:25/10000(0.250)
time spent on training: 318.60208892822266
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.86941281
 0.         0.4378742  0.86941281 1.         1.         0.80197044
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 1.5515, Accuracy: 6122/10000 (61.2200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 1.5806, Accuracy: 4977/8991 (55.3554%)
Done in 347.36943006515503 sec.
Server Epoch:26 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  26, local model 0, internal_epoch   1,  Average loss: 0.6532, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.5857, Accuracy: 5255/10000 (52.5500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3829/4113 (93.0951%), train_poison_data_count: 4113
Global model norm: 14.071582353510944.
Norm before scaling: 13.854224795264958. Distance: 1.8731651865454406
Total norm for 5 adversaries is: 13.854224795264958. distance: 1.8731651865454406
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 4.5748, Accuracy: 3721/8991 (41.3858%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 2225/2275 (97.8022%), train_poison_data_count: 2275
Global model norm: 14.071582353510944.
Norm before scaling: 14.002401963312847. Distance: 2.054227248014887
Total norm for 5 adversaries is: 14.002401963312847. distance: 2.054227248014887
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 39.6538, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0074, Accuracy: 1199/1293 (92.7301%), train_poison_data_count: 1293
Global model norm: 14.071582353510944.
Norm before scaling: 14.0200553024442. Distance: 1.5727741437934608
Total norm for 5 adversaries is: 14.0200553024442. distance: 1.5727741437934608
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 3.6836, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0023, Accuracy: 7882/8146 (96.7591%), train_poison_data_count: 8146
Global model norm: 14.071582353510944.
Norm before scaling: 13.318660546391293. Distance: 2.218833277039446
Total norm for 5 adversaries is: 13.318660546391293. distance: 2.218833277039446
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 6.7721, Accuracy: 2644/8991 (29.4072%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 5, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5291/5399 (97.9996%), train_poison_data_count: 5399
Global model norm: 14.071582353510944.
Norm before scaling: 13.540636291428768. Distance: 1.4538424781780799
Total norm for 5 adversaries is: 13.540636291428768. distance: 1.4538424781780799
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 6.4159, Accuracy: 2154/8991 (23.9573%)
___Train Local_Simple,  epoch  26, local model 6, internal_epoch   1,  Average loss: 0.0089, Accuracy: 793/866 (91.5704%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 10.1040, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  26, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2757/2905 (94.9053%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 7.0599, Accuracy: 2902/10000 (29.0200%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   1,  Average loss: 0.0029, Accuracy: 6912/7219 (95.7473%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.6323, Accuracy: 4099/10000 (40.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2561/2685 (95.3818%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.3003, Accuracy: 2524/10000 (25.2400%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  26, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5339/5617 (95.0507%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.8595, Accuracy: 4761/10000 (47.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0036, Accuracy: 7545/8046 (93.7733%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 4.7344, Accuracy: 2999/10000 (29.9900%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   1,  Average loss: 0.0004, Accuracy: 5072/5087 (99.7051%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 36.9140, Accuracy: 980/10000 (9.8000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3364/3436 (97.9045%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 6.3012, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 1438/1481 (97.0966%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 3.9463, Accuracy: 1744/10000 (17.4400%), Attack Success Rate:37/10000(0.370)
time spent on training: 324.55455684661865
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.955505   1.         0.         0.         1.         1.
 0.         0.4294823  1.         1.         1.         0.75652377
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 1.5082, Accuracy: 6243/10000 (62.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 1.5416, Accuracy: 5046/8991 (56.1228%)
Done in 353.244891166687 sec.
Server Epoch:27 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.6352, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.5433, Accuracy: 5445/10000 (54.4500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 1, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3889/4113 (94.5539%), train_poison_data_count: 4113
Global model norm: 14.079569718115168.
Norm before scaling: 13.826010608123282. Distance: 1.685850538215333
Total norm for 5 adversaries is: 13.826010608123282. distance: 1.685850538215333
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 4.9707, Accuracy: 3742/8991 (41.6194%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2220/2275 (97.5824%), train_poison_data_count: 2275
Global model norm: 14.079569718115168.
Norm before scaling: 14.001707245408783. Distance: 2.014524647417775
Total norm for 5 adversaries is: 14.001707245408783. distance: 2.014524647417775
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 36.7121, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   1,  Average loss: 0.0089, Accuracy: 1202/1293 (92.9621%), train_poison_data_count: 1293
Global model norm: 14.079569718115168.
Norm before scaling: 14.044266064901997. Distance: 1.6763723615779627
Total norm for 5 adversaries is: 14.044266064901997. distance: 1.6763723615779627
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 5.3059, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 4, internal_epoch   1,  Average loss: 0.0022, Accuracy: 7861/8146 (96.5014%), train_poison_data_count: 8146
Global model norm: 14.079569718115168.
Norm before scaling: 13.32444778643665. Distance: 2.2347104547682215
Total norm for 5 adversaries is: 13.32444778643665. distance: 2.2347104547682215
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 5.8684, Accuracy: 2803/8991 (31.1756%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 5, internal_epoch   1,  Average loss: 0.0017, Accuracy: 5299/5399 (98.1478%), train_poison_data_count: 5399
Global model norm: 14.079569718115168.
Norm before scaling: 13.54673589263209. Distance: 1.435246068877654
Total norm for 5 adversaries is: 13.54673589263209. distance: 1.435246068877654
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 6.7597, Accuracy: 2132/8991 (23.7126%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.0092, Accuracy: 792/866 (91.4550%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 8.1816, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  27, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 2746/2905 (94.5267%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 7.8519, Accuracy: 2911/10000 (29.1100%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  27, local model 8, internal_epoch   1,  Average loss: 0.0029, Accuracy: 6888/7219 (95.4149%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.3237, Accuracy: 4095/10000 (40.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 2574/2685 (95.8659%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.7189, Accuracy: 2304/10000 (23.0400%), Attack Success Rate:25/10000(0.250)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5347/5617 (95.1932%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.5014, Accuracy: 4717/10000 (47.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 11, internal_epoch   1,  Average loss: 0.0033, Accuracy: 7600/8046 (94.4569%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 4.2987, Accuracy: 3109/10000 (31.0900%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  27, local model 12, internal_epoch   1,  Average loss: 0.0004, Accuracy: 5080/5087 (99.8624%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 35.6082, Accuracy: 980/10000 (9.8000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  27, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3362/3436 (97.8463%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 6.7757, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 1443/1481 (97.4342%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 3.9732, Accuracy: 1864/10000 (18.6400%), Attack Success Rate:34/10000(0.340)
time spent on training: 329.67909693717957
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.87139588
 0.         0.74592138 0.87139588 1.         1.         0.88772138
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 1.4674, Accuracy: 6277/10000 (62.7700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 1.5056, Accuracy: 5110/8991 (56.8346%)
Done in 358.6306059360504 sec.
Server Epoch:28 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  28, local model 0, internal_epoch   1,  Average loss: 0.6049, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.5049, Accuracy: 5524/10000 (55.2400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 1, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3892/4113 (94.6268%), train_poison_data_count: 4113
Global model norm: 14.08764624532425.
Norm before scaling: 13.830661622920806. Distance: 1.6709243353258565
Total norm for 5 adversaries is: 13.830661622920806. distance: 1.6709243353258565
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 5.0266, Accuracy: 3832/8991 (42.6204%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2217/2275 (97.4505%), train_poison_data_count: 2275
Global model norm: 14.08764624532425.
Norm before scaling: 13.994321488930675. Distance: 1.9855329484167865
Total norm for 5 adversaries is: 13.994321488930675. distance: 1.9855329484167865
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 26.9718, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   1,  Average loss: 0.0081, Accuracy: 1198/1293 (92.6527%), train_poison_data_count: 1293
Global model norm: 14.08764624532425.
Norm before scaling: 14.05180691540738. Distance: 1.678652422264046
Total norm for 5 adversaries is: 14.05180691540738. distance: 1.678652422264046
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 5.2092, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 4, internal_epoch   1,  Average loss: 0.0021, Accuracy: 7874/8146 (96.6609%), train_poison_data_count: 8146
Global model norm: 14.08764624532425.
Norm before scaling: 13.328053446283601. Distance: 2.1854450928251805
Total norm for 5 adversaries is: 13.328053446283601. distance: 2.1854450928251805
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 6.8247, Accuracy: 2558/8991 (28.4507%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 5, internal_epoch   1,  Average loss: 0.0016, Accuracy: 5299/5399 (98.1478%), train_poison_data_count: 5399
Global model norm: 14.08764624532425.
Norm before scaling: 13.545967115627302. Distance: 1.3878283292627411
Total norm for 5 adversaries is: 13.545967115627302. distance: 1.3878283292627411
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 6.4451, Accuracy: 2143/8991 (23.8349%)
___Train Local_Simple,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0076, Accuracy: 790/866 (91.2240%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 9.2652, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  28, local model 7, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2770/2905 (95.3528%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 7.0402, Accuracy: 2883/10000 (28.8300%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  28, local model 8, internal_epoch   1,  Average loss: 0.0028, Accuracy: 6928/7219 (95.9690%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 5.1504, Accuracy: 4101/10000 (41.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 9, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2581/2685 (96.1266%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.4061, Accuracy: 2641/10000 (26.4100%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  28, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5354/5617 (95.3178%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 3.2281, Accuracy: 4652/10000 (46.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 11, internal_epoch   1,  Average loss: 0.0032, Accuracy: 7603/8046 (94.4942%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.6347, Accuracy: 3167/10000 (31.6700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  28, local model 12, internal_epoch   1,  Average loss: 0.0004, Accuracy: 5075/5087 (99.7641%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 32.5937, Accuracy: 980/10000 (9.8000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  28, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3367/3436 (97.9919%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 6.7384, Accuracy: 1009/10000 (10.0900%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  28, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 1440/1481 (97.2316%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 4.0636, Accuracy: 1716/10000 (17.1600%), Attack Success Rate:28/10000(0.280)
time spent on training: 337.50495886802673
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.92325868
 0.         0.64890313 0.92325868 1.         1.         1.
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 1.4234, Accuracy: 6369/10000 (63.6900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 1.4658, Accuracy: 5176/8991 (57.5687%)
Done in 366.9070279598236 sec.
Server Epoch:29 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  29, local model 0, internal_epoch   1,  Average loss: 0.5833, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.4621, Accuracy: 5671/10000 (56.7100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 1, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3872/4113 (94.1405%), train_poison_data_count: 4113
Global model norm: 14.095910289500583.
Norm before scaling: 13.849386131371322. Distance: 1.7088641838315732
Total norm for 5 adversaries is: 13.849386131371322. distance: 1.7088641838315732
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 4.6934, Accuracy: 3669/8991 (40.8075%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 2, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2220/2275 (97.5824%), train_poison_data_count: 2275
Global model norm: 14.095910289500583.
Norm before scaling: 14.002045073322382. Distance: 1.9839555792719483
Total norm for 5 adversaries is: 14.002045073322382. distance: 1.9839555792719483
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 27.9611, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   1,  Average loss: 0.0077, Accuracy: 1201/1293 (92.8848%), train_poison_data_count: 1293
Global model norm: 14.095910289500583.
Norm before scaling: 14.044356242303959. Distance: 1.5992459546912074
Total norm for 5 adversaries is: 14.044356242303959. distance: 1.5992459546912074
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 3.6120, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 4, internal_epoch   1,  Average loss: 0.0022, Accuracy: 7880/8146 (96.7346%), train_poison_data_count: 8146
Global model norm: 14.095910289500583.
Norm before scaling: 13.321927023671291. Distance: 2.1717193328178177
Total norm for 5 adversaries is: 13.321927023671291. distance: 2.1717193328178177
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 5.6123, Accuracy: 2726/8991 (30.3192%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 5, internal_epoch   1,  Average loss: 0.0014, Accuracy: 5307/5399 (98.2960%), train_poison_data_count: 5399
Global model norm: 14.095910289500583.
Norm before scaling: 13.552891856926582. Distance: 1.3590544837966112
Total norm for 5 adversaries is: 13.552891856926582. distance: 1.3590544837966112
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 7.8172, Accuracy: 2154/8991 (23.9573%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0088, Accuracy: 799/866 (92.2633%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 9.3698, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  29, local model 7, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2772/2905 (95.4217%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 7.4169, Accuracy: 2867/10000 (28.6700%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   1,  Average loss: 0.0028, Accuracy: 6920/7219 (95.8582%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.2812, Accuracy: 4096/10000 (40.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2564/2685 (95.4935%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.2415, Accuracy: 2432/10000 (24.3200%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch  29, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5362/5617 (95.4602%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.5999, Accuracy: 4699/10000 (46.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 11, internal_epoch   1,  Average loss: 0.0030, Accuracy: 7648/8046 (95.0534%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 4.6715, Accuracy: 3306/10000 (33.0600%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  29, local model 12, internal_epoch   1,  Average loss: 0.0004, Accuracy: 5073/5087 (99.7248%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 31.6482, Accuracy: 980/10000 (9.8000%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  29, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3369/3436 (98.0501%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 6.4466, Accuracy: 1081/10000 (10.8100%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  29, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 1446/1481 (97.6367%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 3.7724, Accuracy: 1860/10000 (18.6000%), Attack Success Rate:23/10000(0.230)
time spent on training: 341.68790197372437
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.90894792
 0.         0.         0.90894792 1.         1.         1.
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 1.3922, Accuracy: 6406/10000 (64.0600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 1.4349, Accuracy: 5194/8991 (57.7689%)
Done in 370.43356680870056 sec.
Server Epoch:30 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  30, local model 0, internal_epoch   1,  Average loss: 0.5558, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.4325, Accuracy: 5759/10000 (57.5900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3881/4113 (94.3593%), train_poison_data_count: 4113
Global model norm: 14.103568503440894.
Norm before scaling: 13.838715819829243. Distance: 1.6215504198401796
Total norm for 5 adversaries is: 13.838715819829243. distance: 1.6215504198401796
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 4.4007, Accuracy: 3735/8991 (41.5415%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 2, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2221/2275 (97.6264%), train_poison_data_count: 2275
Global model norm: 14.103568503440894.
Norm before scaling: 14.000829399608907. Distance: 1.9501967795437647
Total norm for 5 adversaries is: 14.000829399608907. distance: 1.9501967795437647
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 24.0152, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   1,  Average loss: 0.0070, Accuracy: 1199/1293 (92.7301%), train_poison_data_count: 1293
Global model norm: 14.103568503440894.
Norm before scaling: 14.056140597652563. Distance: 1.6222083982041209
Total norm for 5 adversaries is: 14.056140597652563. distance: 1.6222083982041209
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 3.5407, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.0021, Accuracy: 7881/8146 (96.7469%), train_poison_data_count: 8146
Global model norm: 14.103568503440894.
Norm before scaling: 13.334099811139764. Distance: 2.175682079308323
Total norm for 5 adversaries is: 13.334099811139764. distance: 2.175682079308323
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 5.8175, Accuracy: 2691/8991 (29.9299%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 5, internal_epoch   1,  Average loss: 0.0015, Accuracy: 5298/5399 (98.1293%), train_poison_data_count: 5399
Global model norm: 14.103568503440894.
Norm before scaling: 13.558772124114775. Distance: 1.3723331077568703
Total norm for 5 adversaries is: 13.558772124114775. distance: 1.3723331077568703
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 5.6208, Accuracy: 2142/8991 (23.8238%)
___Train Local_Simple,  epoch  30, local model 6, internal_epoch   1,  Average loss: 0.0090, Accuracy: 794/866 (91.6859%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 8.9631, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  30, local model 7, internal_epoch   1,  Average loss: 0.0037, Accuracy: 2762/2905 (95.0775%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 7.2728, Accuracy: 2915/10000 (29.1500%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0026, Accuracy: 6935/7219 (96.0659%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.7009, Accuracy: 4081/10000 (40.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2562/2685 (95.4190%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.6090, Accuracy: 2640/10000 (26.4000%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5366/5617 (95.5314%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 3.3638, Accuracy: 4640/10000 (46.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0030, Accuracy: 7674/8046 (95.3766%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 5.5063, Accuracy: 2942/10000 (29.4200%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  30, local model 12, internal_epoch   1,  Average loss: 0.0003, Accuracy: 5076/5087 (99.7838%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 31.9354, Accuracy: 980/10000 (9.8000%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch  30, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3364/3436 (97.9045%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 5.9767, Accuracy: 1075/10000 (10.7500%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch  30, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 1441/1481 (97.2991%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 4.0148, Accuracy: 1873/10000 (18.7300%), Attack Success Rate:39/10000(0.390)
time spent on training: 350.52124857902527
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.83300424 1.         0.         0.         1.         1.
 0.         0.0287431  1.         1.         1.         0.752264
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 1.3556, Accuracy: 6539/10000 (65.3900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 1.4004, Accuracy: 5246/8991 (58.3472%)
Done in 379.1366858482361 sec.
Server Epoch:31 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  31, local model 0, internal_epoch   1,  Average loss: 0.5418, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.3954, Accuracy: 5935/10000 (59.3500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3885/4113 (94.4566%), train_poison_data_count: 4113
Global model norm: 14.1108019203361.
Norm before scaling: 13.852273560253058. Distance: 1.6403260458185063
Total norm for 5 adversaries is: 13.852273560253058. distance: 1.6403260458185063
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 4.4183, Accuracy: 3624/8991 (40.3070%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 2222/2275 (97.6703%), train_poison_data_count: 2275
Global model norm: 14.1108019203361.
Norm before scaling: 14.004313758017842. Distance: 1.9252016383002621
Total norm for 5 adversaries is: 14.004313758017842. distance: 1.9252016383002621
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 22.8646, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   1,  Average loss: 0.0078, Accuracy: 1201/1293 (92.8848%), train_poison_data_count: 1293
Global model norm: 14.1108019203361.
Norm before scaling: 14.073277662472202. Distance: 1.6784303440643877
Total norm for 5 adversaries is: 14.073277662472202. distance: 1.6784303440643877
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 4.8912, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0021, Accuracy: 7878/8146 (96.7100%), train_poison_data_count: 8146
Global model norm: 14.1108019203361.
Norm before scaling: 13.348614201430529. Distance: 2.208348244190859
Total norm for 5 adversaries is: 13.348614201430529. distance: 2.208348244190859
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 6.4609, Accuracy: 2644/8991 (29.4072%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 5, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5312/5399 (98.3886%), train_poison_data_count: 5399
Global model norm: 14.1108019203361.
Norm before scaling: 13.554890691020264. Distance: 1.3067345920411173
Total norm for 5 adversaries is: 13.554890691020264. distance: 1.3067345920411173
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 6.7079, Accuracy: 2156/8991 (23.9795%)
___Train Local_Simple,  epoch  31, local model 6, internal_epoch   1,  Average loss: 0.0087, Accuracy: 795/866 (91.8014%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 8.9995, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0037, Accuracy: 2768/2905 (95.2840%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 7.2805, Accuracy: 2894/10000 (28.9400%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  31, local model 8, internal_epoch   1,  Average loss: 0.0026, Accuracy: 6933/7219 (96.0382%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.9895, Accuracy: 4095/10000 (40.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2587/2685 (96.3501%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.8957, Accuracy: 2409/10000 (24.0900%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch  31, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5363/5617 (95.4780%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 3.6634, Accuracy: 4795/10000 (47.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0031, Accuracy: 7616/8046 (94.6557%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.7588, Accuracy: 3042/10000 (30.4200%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0003, Accuracy: 5070/5087 (99.6658%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 31.5568, Accuracy: 980/10000 (9.8000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  31, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3371/3436 (98.1083%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 6.2427, Accuracy: 1091/10000 (10.9100%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 1441/1481 (97.2991%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 4.1199, Accuracy: 1822/10000 (18.2200%), Attack Success Rate:28/10000(0.280)
time spent on training: 352.478031873703
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.96116915
 0.         0.09500314 0.96116915 1.         1.         0.8847745
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 1.3217, Accuracy: 6587/10000 (65.8700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 1.3687, Accuracy: 5273/8991 (58.6475%)
Done in 381.4220497608185 sec.
Server Epoch:32 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  32, local model 0, internal_epoch   1,  Average loss: 0.5155, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.3636, Accuracy: 6020/10000 (60.2000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3908/4113 (95.0158%), train_poison_data_count: 4113
Global model norm: 14.118504473884673.
Norm before scaling: 13.8490324598234. Distance: 1.586837813672987
Total norm for 5 adversaries is: 13.8490324598234. distance: 1.586837813672987
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 4.5429, Accuracy: 3855/8991 (42.8762%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 2222/2275 (97.6703%), train_poison_data_count: 2275
Global model norm: 14.118504473884673.
Norm before scaling: 14.021626254026927. Distance: 1.9677143097506211
Total norm for 5 adversaries is: 14.021626254026927. distance: 1.9677143097506211
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 27.7528, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   1,  Average loss: 0.0081, Accuracy: 1198/1293 (92.6527%), train_poison_data_count: 1293
Global model norm: 14.118504473884673.
Norm before scaling: 14.069591853248344. Distance: 1.6733318648135567
Total norm for 5 adversaries is: 14.069591853248344. distance: 1.6733318648135567
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 3.3142, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 4, internal_epoch   1,  Average loss: 0.0020, Accuracy: 7886/8146 (96.8082%), train_poison_data_count: 8146
Global model norm: 14.118504473884673.
Norm before scaling: 13.341299220562371. Distance: 2.152877159969414
Total norm for 5 adversaries is: 13.341299220562371. distance: 2.152877159969414
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 5.5486, Accuracy: 2781/8991 (30.9309%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 5, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5317/5399 (98.4812%), train_poison_data_count: 5399
Global model norm: 14.118504473884673.
Norm before scaling: 13.558963437591869. Distance: 1.2704376740854535
Total norm for 5 adversaries is: 13.558963437591869. distance: 1.2704376740854535
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 6.4078, Accuracy: 2155/8991 (23.9684%)
___Train Local_Simple,  epoch  32, local model 6, internal_epoch   1,  Average loss: 0.0085, Accuracy: 793/866 (91.5704%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 7.4304, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  32, local model 7, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2783/2905 (95.8003%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 8.1101, Accuracy: 2864/10000 (28.6400%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   1,  Average loss: 0.0026, Accuracy: 6926/7219 (95.9413%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 4.0800, Accuracy: 4102/10000 (41.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 9, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2589/2685 (96.4246%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 4.6402, Accuracy: 2391/10000 (23.9100%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch  32, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5388/5617 (95.9231%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.6187, Accuracy: 4792/10000 (47.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 11, internal_epoch   1,  Average loss: 0.0028, Accuracy: 7698/8046 (95.6749%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 4.7389, Accuracy: 3002/10000 (30.0200%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  32, local model 12, internal_epoch   1,  Average loss: 0.0003, Accuracy: 5079/5087 (99.8427%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 28.5332, Accuracy: 980/10000 (9.8000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  32, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3373/3436 (98.1665%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 6.0479, Accuracy: 1189/10000 (11.8900%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch  32, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 1442/1481 (97.3666%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 3.4423, Accuracy: 1951/10000 (19.5100%), Attack Success Rate:32/10000(0.320)
time spent on training: 364.2967767715454
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.9523926
 0.         0.03966655 0.9523926  1.         1.         0.97093041
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 1.2872, Accuracy: 6672/10000 (66.7200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 1.3361, Accuracy: 5318/8991 (59.1480%)
Done in 393.4751567840576 sec.
Server Epoch:33 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  33, local model 0, internal_epoch   1,  Average loss: 0.4911, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.3314, Accuracy: 6125/10000 (61.2500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3883/4113 (94.4080%), train_poison_data_count: 4113
Global model norm: 14.12592143876429.
Norm before scaling: 13.867948372611924. Distance: 1.623474285160574
Total norm for 5 adversaries is: 13.867948372611924. distance: 1.623474285160574
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 4.5738, Accuracy: 3776/8991 (41.9976%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 2219/2275 (97.5385%), train_poison_data_count: 2275
Global model norm: 14.12592143876429.
Norm before scaling: 14.020779583597909. Distance: 1.940787571779352
Total norm for 5 adversaries is: 14.020779583597909. distance: 1.940787571779352
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 25.0130, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   1,  Average loss: 0.0088, Accuracy: 1195/1293 (92.4207%), train_poison_data_count: 1293
Global model norm: 14.12592143876429.
Norm before scaling: 14.096239906166023. Distance: 1.7290890534535661
Total norm for 5 adversaries is: 14.096239906166023. distance: 1.7290890534535661
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 5.6852, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0019, Accuracy: 7911/8146 (97.1151%), train_poison_data_count: 8146
Global model norm: 14.12592143876429.
Norm before scaling: 13.345787017929279. Distance: 2.142359900684588
Total norm for 5 adversaries is: 13.345787017929279. distance: 2.142359900684588
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 6.1941, Accuracy: 2808/8991 (31.2312%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 5, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5312/5399 (98.3886%), train_poison_data_count: 5399
Global model norm: 14.12592143876429.
Norm before scaling: 13.56496649608981. Distance: 1.2638080411537778
Total norm for 5 adversaries is: 13.56496649608981. distance: 1.2638080411537778
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 5.6075, Accuracy: 2145/8991 (23.8572%)
___Train Local_Simple,  epoch  33, local model 6, internal_epoch   1,  Average loss: 0.0074, Accuracy: 794/866 (91.6859%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 8.8868, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  33, local model 7, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2790/2905 (96.0413%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 9.5150, Accuracy: 2904/10000 (29.0400%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  33, local model 8, internal_epoch   1,  Average loss: 0.0025, Accuracy: 6956/7219 (96.3568%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.9440, Accuracy: 4085/10000 (40.8500%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  33, local model 9, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2593/2685 (96.5736%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.8671, Accuracy: 2398/10000 (23.9800%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch  33, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5407/5617 (96.2613%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 4.2161, Accuracy: 4793/10000 (47.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 11, internal_epoch   1,  Average loss: 0.0028, Accuracy: 7706/8046 (95.7743%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 5.1404, Accuracy: 3022/10000 (30.2200%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  33, local model 12, internal_epoch   1,  Average loss: 0.0003, Accuracy: 5079/5087 (99.8427%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 27.3717, Accuracy: 980/10000 (9.8000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  33, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3375/3436 (98.2247%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 6.1574, Accuracy: 1193/10000 (11.9300%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 1450/1481 (97.9068%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 3.9509, Accuracy: 2045/10000 (20.4500%), Attack Success Rate:34/10000(0.340)
time spent on training: 366.26824021339417
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.97819931 1.         0.         0.         1.         0.92036841
 0.         0.13754733 0.92036841 1.         1.         0.73060499
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 1.2555, Accuracy: 6743/10000 (67.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 1.3058, Accuracy: 5371/8991 (59.7375%)
Done in 394.8125078678131 sec.
Server Epoch:34 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.4651, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.3013, Accuracy: 6194/10000 (61.9400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3910/4113 (95.0644%), train_poison_data_count: 4113
Global model norm: 14.133047866337519.
Norm before scaling: 13.844477442795105. Distance: 1.5209667025400642
Total norm for 5 adversaries is: 13.844477442795105. distance: 1.5209667025400642
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 4.2187, Accuracy: 3651/8991 (40.6073%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 2, internal_epoch   1,  Average loss: 0.0016, Accuracy: 2221/2275 (97.6264%), train_poison_data_count: 2275
Global model norm: 14.133047866337519.
Norm before scaling: 14.024020161119713. Distance: 1.9413896095591234
Total norm for 5 adversaries is: 14.024020161119713. distance: 1.9413896095591234
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 23.1838, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   1,  Average loss: 0.0066, Accuracy: 1203/1293 (93.0394%), train_poison_data_count: 1293
Global model norm: 14.133047866337519.
Norm before scaling: 14.08267920666005. Distance: 1.6298206424912753
Total norm for 5 adversaries is: 14.08267920666005. distance: 1.6298206424912753
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 3.4342, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 4, internal_epoch   1,  Average loss: 0.0019, Accuracy: 7909/8146 (97.0906%), train_poison_data_count: 8146
Global model norm: 14.133047866337519.
Norm before scaling: 13.344673357067828. Distance: 2.128535863171416
Total norm for 5 adversaries is: 13.344673357067828. distance: 2.128535863171416
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 6.1957, Accuracy: 2752/8991 (30.6084%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 5, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5316/5399 (98.4627%), train_poison_data_count: 5399
Global model norm: 14.133047866337519.
Norm before scaling: 13.56477357995299. Distance: 1.238828423843978
Total norm for 5 adversaries is: 13.56477357995299. distance: 1.238828423843978
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 5.1508, Accuracy: 2028/8991 (22.5559%)
___Train Local_Simple,  epoch  34, local model 6, internal_epoch   1,  Average loss: 0.0075, Accuracy: 801/866 (92.4942%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 9.1749, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  34, local model 7, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2784/2905 (95.8348%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 6.5532, Accuracy: 2906/10000 (29.0600%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  34, local model 8, internal_epoch   1,  Average loss: 0.0024, Accuracy: 6971/7219 (96.5646%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.5129, Accuracy: 4092/10000 (40.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 9, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2605/2685 (97.0205%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.6929, Accuracy: 2692/10000 (26.9200%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  34, local model 10, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5386/5617 (95.8875%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.7668, Accuracy: 4783/10000 (47.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 11, internal_epoch   1,  Average loss: 0.0029, Accuracy: 7714/8046 (95.8737%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 4.9929, Accuracy: 3076/10000 (30.7600%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  34, local model 12, internal_epoch   1,  Average loss: 0.0003, Accuracy: 5071/5087 (99.6855%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 29.3058, Accuracy: 980/10000 (9.8000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  34, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3383/3436 (98.4575%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 5.8201, Accuracy: 1151/10000 (11.5100%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  34, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 1447/1481 (97.7043%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 3.0234, Accuracy: 2093/10000 (20.9300%), Attack Success Rate:24/10000(0.240)
time spent on training: 393.63744282722473
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.93125165 1.         0.         0.         1.         0.95048864
 0.         0.06152535 0.95048864 1.         1.         0.71157543
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 1.2256, Accuracy: 6790/10000 (67.9000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 1.2789, Accuracy: 5397/8991 (60.0267%)
Done in 426.8581500053406 sec.
Server Epoch:35 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  35, local model 0, internal_epoch   1,  Average loss: 0.4493, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.2705, Accuracy: 6282/10000 (62.8200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3910/4113 (95.0644%), train_poison_data_count: 4113
Global model norm: 14.139958116180676.
Norm before scaling: 13.86661475489754. Distance: 1.5477830167689175
Total norm for 5 adversaries is: 13.86661475489754. distance: 1.5477830167689175
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 4.3922, Accuracy: 3781/8991 (42.0532%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 2221/2275 (97.6264%), train_poison_data_count: 2275
Global model norm: 14.139958116180676.
Norm before scaling: 14.034493596067044. Distance: 1.9458120539588775
Total norm for 5 adversaries is: 14.034493596067044. distance: 1.9458120539588775
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 25.7528, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   1,  Average loss: 0.0069, Accuracy: 1202/1293 (92.9621%), train_poison_data_count: 1293
Global model norm: 14.139958116180676.
Norm before scaling: 14.100579410849743. Distance: 1.6182799404279318
Total norm for 5 adversaries is: 14.100579410849743. distance: 1.6182799404279318
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 4.7699, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 7925/8146 (97.2870%), train_poison_data_count: 8146
Global model norm: 14.139958116180676.
Norm before scaling: 13.345298802277538. Distance: 2.036761860451581
Total norm for 5 adversaries is: 13.345298802277538. distance: 2.036761860451581
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 5.7427, Accuracy: 2775/8991 (30.8642%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 5, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5318/5399 (98.4997%), train_poison_data_count: 5399
Global model norm: 14.139958116180676.
Norm before scaling: 13.575101702398724. Distance: 1.2127158611889464
Total norm for 5 adversaries is: 13.575101702398724. distance: 1.2127158611889464
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 6.1270, Accuracy: 2156/8991 (23.9795%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   1,  Average loss: 0.0074, Accuracy: 802/866 (92.6097%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 10.0241, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  35, local model 7, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2787/2905 (95.9380%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 8.1291, Accuracy: 2908/10000 (29.0800%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0024, Accuracy: 6968/7219 (96.5231%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 5.0917, Accuracy: 4076/10000 (40.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 9, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2599/2685 (96.7970%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.4171, Accuracy: 2477/10000 (24.7700%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch  35, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5389/5617 (95.9409%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.6876, Accuracy: 4748/10000 (47.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 11, internal_epoch   1,  Average loss: 0.0028, Accuracy: 7680/8046 (95.4512%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 4.3426, Accuracy: 3200/10000 (32.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0003, Accuracy: 5075/5087 (99.7641%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 27.6638, Accuracy: 980/10000 (9.8000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  35, local model 13, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3382/3436 (98.4284%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 6.2235, Accuracy: 1193/10000 (11.9300%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch  35, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 1452/1481 (98.0419%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 3.6208, Accuracy: 2164/10000 (21.6400%), Attack Success Rate:27/10000(0.270)
time spent on training: 375.27717995643616
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         0.88617479 0.         0.         1.         1.
 0.         0.         1.         1.         1.         0.95884255
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 1.1941, Accuracy: 6864/10000 (68.6400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 1.2487, Accuracy: 5447/8991 (60.5828%)
Done in 403.96267199516296 sec.
Server Epoch:36 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  36, local model 0, internal_epoch   1,  Average loss: 0.4287, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.2393, Accuracy: 6407/10000 (64.0700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 1, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3922/4113 (95.3562%), train_poison_data_count: 4113
Global model norm: 14.147162141407494.
Norm before scaling: 13.869635017284892. Distance: 1.5583696323729794
Total norm for 5 adversaries is: 13.869635017284892. distance: 1.5583696323729794
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 4.9801, Accuracy: 3732/8991 (41.5082%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 2221/2275 (97.6264%), train_poison_data_count: 2275
Global model norm: 14.147162141407494.
Norm before scaling: 14.033656400343093. Distance: 1.9532412074804304
Total norm for 5 adversaries is: 14.033656400343093. distance: 1.9532412074804304
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 22.5701, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 1204/1293 (93.1168%), train_poison_data_count: 1293
Global model norm: 14.147162141407494.
Norm before scaling: 14.089520481632572. Distance: 1.570583263226724
Total norm for 5 adversaries is: 14.089520481632572. distance: 1.570583263226724
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 3.4128, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 7934/8146 (97.3975%), train_poison_data_count: 8146
Global model norm: 14.147162141407494.
Norm before scaling: 13.346853141079032. Distance: 2.0474557998972673
Total norm for 5 adversaries is: 13.346853141079032. distance: 2.0474557998972673
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 5.9934, Accuracy: 2786/8991 (30.9865%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 5, internal_epoch   1,  Average loss: 0.0013, Accuracy: 5305/5399 (98.2589%), train_poison_data_count: 5399
Global model norm: 14.147162141407494.
Norm before scaling: 13.584970449696996. Distance: 1.2426385120731278
Total norm for 5 adversaries is: 13.584970449696996. distance: 1.2426385120731278
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 5.3217, Accuracy: 2158/8991 (24.0018%)
___Train Local_Simple,  epoch  36, local model 6, internal_epoch   1,  Average loss: 0.0080, Accuracy: 799/866 (92.2633%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 7.3583, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  36, local model 7, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2786/2905 (95.9036%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 7.9959, Accuracy: 2908/10000 (29.0800%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  36, local model 8, internal_epoch   1,  Average loss: 0.0023, Accuracy: 6970/7219 (96.5508%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.5947, Accuracy: 4109/10000 (41.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 9, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2595/2685 (96.6480%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.3289, Accuracy: 2637/10000 (26.3700%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5407/5617 (96.2613%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.6473, Accuracy: 4721/10000 (47.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 11, internal_epoch   1,  Average loss: 0.0026, Accuracy: 7721/8046 (95.9607%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 4.1081, Accuracy: 3264/10000 (32.6400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  36, local model 12, internal_epoch   1,  Average loss: 0.0003, Accuracy: 5077/5087 (99.8034%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 26.1750, Accuracy: 980/10000 (9.8000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  36, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3381/3436 (98.3993%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 5.9168, Accuracy: 1335/10000 (13.3500%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1450/1481 (97.9068%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 3.4342, Accuracy: 2208/10000 (22.0800%), Attack Success Rate:21/10000(0.210)
time spent on training: 380.025741815567
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         0.63451536 0.         0.         1.         0.93688643
 0.         0.         0.93688643 1.         1.         0.89323536
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 1.1652, Accuracy: 6902/10000 (69.0200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 1.2230, Accuracy: 5472/8991 (60.8609%)
Done in 409.7055130004883 sec.
Server Epoch:37 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.4126, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.2108, Accuracy: 6473/10000 (64.7300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3891/4113 (94.6025%), train_poison_data_count: 4113
Global model norm: 14.153807844154795.
Norm before scaling: 13.879626903081725. Distance: 1.5728511501924207
Total norm for 5 adversaries is: 13.879626903081725. distance: 1.5728511501924207
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 3.9941, Accuracy: 3780/8991 (42.0420%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2223/2275 (97.7143%), train_poison_data_count: 2275
Global model norm: 14.153807844154795.
Norm before scaling: 14.036330902521433. Distance: 1.907639481730678
Total norm for 5 adversaries is: 14.036330902521433. distance: 1.907639481730678
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 21.6539, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   1,  Average loss: 0.0066, Accuracy: 1206/1293 (93.2715%), train_poison_data_count: 1293
Global model norm: 14.153807844154795.
Norm before scaling: 14.105086341223133. Distance: 1.627537653263333
Total norm for 5 adversaries is: 14.105086341223133. distance: 1.627537653263333
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 4.2421, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 7932/8146 (97.3729%), train_poison_data_count: 8146
Global model norm: 14.153807844154795.
Norm before scaling: 13.346847996453308. Distance: 2.047021642193159
Total norm for 5 adversaries is: 13.346847996453308. distance: 2.047021642193159
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 5.6591, Accuracy: 2786/8991 (30.9865%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5317/5399 (98.4812%), train_poison_data_count: 5399
Global model norm: 14.153807844154795.
Norm before scaling: 13.585952662261523. Distance: 1.2027288007467651
Total norm for 5 adversaries is: 13.585952662261523. distance: 1.2027288007467651
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 5.5618, Accuracy: 2139/8991 (23.7905%)
___Train Local_Simple,  epoch  37, local model 6, internal_epoch   1,  Average loss: 0.0088, Accuracy: 801/866 (92.4942%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 5.9969, Accuracy: 1014/10000 (10.1400%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  37, local model 7, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2792/2905 (96.1102%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 7.4715, Accuracy: 2905/10000 (29.0500%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  37, local model 8, internal_epoch   1,  Average loss: 0.0023, Accuracy: 6970/7219 (96.5508%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.8726, Accuracy: 4099/10000 (40.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 9, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2589/2685 (96.4246%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.1647, Accuracy: 2643/10000 (26.4300%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch  37, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5423/5617 (96.5462%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.7476, Accuracy: 4719/10000 (47.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 11, internal_epoch   1,  Average loss: 0.0026, Accuracy: 7713/8046 (95.8613%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 4.8534, Accuracy: 3021/10000 (30.2100%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  37, local model 12, internal_epoch   1,  Average loss: 0.0003, Accuracy: 5075/5087 (99.7641%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 25.5797, Accuracy: 980/10000 (9.8000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3380/3436 (98.3702%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 5.7375, Accuracy: 1390/10000 (13.9000%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch  37, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 1445/1481 (97.5692%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 3.1772, Accuracy: 2274/10000 (22.7400%), Attack Success Rate:11/10000(0.110)
time spent on training: 388.9554171562195
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         0.99418226 0.         0.         1.         1.
 0.         0.         1.         1.         1.         0.88101397
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 1.1382, Accuracy: 6950/10000 (69.5000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 1.1978, Accuracy: 5501/8991 (61.1834%)
Done in 417.3754389286041 sec.
Server Epoch:38 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  38, local model 0, internal_epoch   1,  Average loss: 0.3955, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.1828, Accuracy: 6567/10000 (65.6700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3934/4113 (95.6479%), train_poison_data_count: 4113
Global model norm: 14.160805480806323.
Norm before scaling: 13.871688860086744. Distance: 1.4290354758384531
Total norm for 5 adversaries is: 13.871688860086744. distance: 1.4290354758384531
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 4.0387, Accuracy: 4000/8991 (44.4889%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 2, internal_epoch   1,  Average loss: 0.0014, Accuracy: 2219/2275 (97.5385%), train_poison_data_count: 2275
Global model norm: 14.160805480806323.
Norm before scaling: 14.056094461261502. Distance: 1.9899027569652077
Total norm for 5 adversaries is: 14.056094461261502. distance: 1.9899027569652077
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 26.4895, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   1,  Average loss: 0.0065, Accuracy: 1208/1293 (93.4261%), train_poison_data_count: 1293
Global model norm: 14.160805480806323.
Norm before scaling: 14.10507173700491. Distance: 1.5450696331986125
Total norm for 5 adversaries is: 14.10507173700491. distance: 1.5450696331986125
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 3.9443, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 7927/8146 (97.3116%), train_poison_data_count: 8146
Global model norm: 14.160805480806323.
Norm before scaling: 13.365279328480954. Distance: 2.0886027136146796
Total norm for 5 adversaries is: 13.365279328480954. distance: 2.0886027136146796
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 5.5725, Accuracy: 2746/8991 (30.5417%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 5, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5313/5399 (98.4071%), train_poison_data_count: 5399
Global model norm: 14.160805480806323.
Norm before scaling: 13.58413812480387. Distance: 1.1641488267263909
Total norm for 5 adversaries is: 13.58413812480387. distance: 1.1641488267263909
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 4.9583, Accuracy: 2154/8991 (23.9573%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   1,  Average loss: 0.0074, Accuracy: 802/866 (92.6097%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 6.1027, Accuracy: 1034/10000 (10.3400%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  38, local model 7, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2775/2905 (95.5250%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 5.8086, Accuracy: 2884/10000 (28.8400%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  38, local model 8, internal_epoch   1,  Average loss: 0.0023, Accuracy: 6984/7219 (96.7447%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.5977, Accuracy: 4099/10000 (40.9900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  38, local model 9, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2603/2685 (96.9460%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.5481, Accuracy: 2513/10000 (25.1300%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch  38, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5419/5617 (96.4750%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.4766, Accuracy: 4789/10000 (47.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 11, internal_epoch   1,  Average loss: 0.0027, Accuracy: 7729/8046 (96.0602%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 4.1940, Accuracy: 3088/10000 (30.8800%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  38, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5078/5087 (99.8231%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 23.4796, Accuracy: 980/10000 (9.8000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  38, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3379/3436 (98.3411%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 6.2156, Accuracy: 1383/10000 (13.8300%), Attack Success Rate:17/10000(0.170)
___Train Local_Simple,  epoch  38, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 1448/1481 (97.7718%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 3.1890, Accuracy: 2351/10000 (23.5100%), Attack Success Rate:21/10000(0.210)
time spent on training: 390.86134696006775
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         1.         0.         0.         1.         0.94145026
 0.         0.         0.94145026 1.         1.         0.97572987
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 1.1121, Accuracy: 7003/10000 (70.0300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 1.1726, Accuracy: 5531/8991 (61.5171%)
Done in 419.3995339870453 sec.
Server Epoch:39 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  39, local model 0, internal_epoch   1,  Average loss: 0.3747, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.1570, Accuracy: 6645/10000 (66.4500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3926/4113 (95.4534%), train_poison_data_count: 4113
Global model norm: 14.167763043033812.
Norm before scaling: 13.864654258051749. Distance: 1.4299816391839864
Total norm for 5 adversaries is: 13.864654258051749. distance: 1.4299816391839864
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 4.3462, Accuracy: 3731/8991 (41.4971%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 2, internal_epoch   1,  Average loss: 0.0014, Accuracy: 2222/2275 (97.6703%), train_poison_data_count: 2275
Global model norm: 14.167763043033812.
Norm before scaling: 14.044746823281583. Distance: 1.9129357583266144
Total norm for 5 adversaries is: 14.044746823281583. distance: 1.9129357583266144
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 20.0305, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0068, Accuracy: 1204/1293 (93.1168%), train_poison_data_count: 1293
Global model norm: 14.167763043033812.
Norm before scaling: 14.119692184940185. Distance: 1.6584085038494765
Total norm for 5 adversaries is: 14.119692184940185. distance: 1.6584085038494765
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 4.2214, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 7936/8146 (97.4220%), train_poison_data_count: 8146
Global model norm: 14.167763043033812.
Norm before scaling: 13.369366466545708. Distance: 2.0612874946399597
Total norm for 5 adversaries is: 13.369366466545708. distance: 2.0612874946399597
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 5.7768, Accuracy: 2811/8991 (31.2646%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5307/5399 (98.2960%), train_poison_data_count: 5399
Global model norm: 14.167763043033812.
Norm before scaling: 13.60460010595566. Distance: 1.2295778955184014
Total norm for 5 adversaries is: 13.60460010595566. distance: 1.2295778955184014
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 4.2873, Accuracy: 2155/8991 (23.9684%)
___Train Local_Simple,  epoch  39, local model 6, internal_epoch   1,  Average loss: 0.0085, Accuracy: 804/866 (92.8406%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 5.9706, Accuracy: 1053/10000 (10.5300%), Attack Success Rate:13/10000(0.130)
___Train Local_Simple,  epoch  39, local model 7, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2792/2905 (96.1102%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 8.1492, Accuracy: 2918/10000 (29.1800%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  39, local model 8, internal_epoch   1,  Average loss: 0.0024, Accuracy: 6963/7219 (96.4538%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.4364, Accuracy: 4066/10000 (40.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 9, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2602/2685 (96.9088%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.4799, Accuracy: 2613/10000 (26.1300%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch  39, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5399/5617 (96.1189%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.3343, Accuracy: 4728/10000 (47.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 11, internal_epoch   1,  Average loss: 0.0027, Accuracy: 7707/8046 (95.7867%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 4.6249, Accuracy: 3111/10000 (31.1100%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  39, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5085/5087 (99.9607%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 22.8125, Accuracy: 980/10000 (9.8000%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3390/3436 (98.6612%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 6.5726, Accuracy: 1128/10000 (11.2800%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1453/1481 (98.1094%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 3.4451, Accuracy: 2244/10000 (22.4400%), Attack Success Rate:35/10000(0.350)
time spent on training: 399.91744017601013
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         0.8474292  0.         0.         1.         0.97676754
 0.         0.         0.97676754 1.         1.         0.78321674
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 1.0846, Accuracy: 7060/10000 (70.6000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 1.1466, Accuracy: 5569/8991 (61.9397%)
Done in 427.75256395339966 sec.
Server Epoch:40 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  40, local model 0, internal_epoch   1,  Average loss: 0.3611, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.1278, Accuracy: 6724/10000 (67.2400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3916/4113 (95.2103%), train_poison_data_count: 4113
Global model norm: 14.174314042974608.
Norm before scaling: 13.88953854546145. Distance: 1.4774014143479868
Total norm for 5 adversaries is: 13.88953854546145. distance: 1.4774014143479868
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 3.6119, Accuracy: 4052/8991 (45.0673%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 2221/2275 (97.6264%), train_poison_data_count: 2275
Global model norm: 14.174314042974608.
Norm before scaling: 14.054838950511126. Distance: 1.9120566309199554
Total norm for 5 adversaries is: 14.054838950511126. distance: 1.9120566309199554
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 21.2505, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   1,  Average loss: 0.0064, Accuracy: 1203/1293 (93.0394%), train_poison_data_count: 1293
Global model norm: 14.174314042974608.
Norm before scaling: 14.128711314144596. Distance: 1.66662758145597
Total norm for 5 adversaries is: 14.128711314144596. distance: 1.66662758145597
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 4.2682, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 7941/8146 (97.4834%), train_poison_data_count: 8146
Global model norm: 14.174314042974608.
Norm before scaling: 13.366543101613996. Distance: 2.022604045289991
Total norm for 5 adversaries is: 13.366543101613996. distance: 2.022604045289991
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 5.9927, Accuracy: 2751/8991 (30.5973%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5325/5399 (98.6294%), train_poison_data_count: 5399
Global model norm: 14.174314042974608.
Norm before scaling: 13.599606429744403. Distance: 1.1400444957348153
Total norm for 5 adversaries is: 13.599606429744403. distance: 1.1400444957348153
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 6.2759, Accuracy: 2157/8991 (23.9907%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0072, Accuracy: 799/866 (92.2633%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 5.3993, Accuracy: 1015/10000 (10.1500%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  40, local model 7, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2812/2905 (96.7986%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 7.4760, Accuracy: 2908/10000 (29.0800%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0022, Accuracy: 6993/7219 (96.8694%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.0284, Accuracy: 4079/10000 (40.7900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  40, local model 9, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2597/2685 (96.7225%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.0138, Accuracy: 2619/10000 (26.1900%), Attack Success Rate:10/10000(0.100)
___Train Local_Simple,  epoch  40, local model 10, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5409/5617 (96.2970%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.3331, Accuracy: 4779/10000 (47.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0026, Accuracy: 7715/8046 (95.8862%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 4.4913, Accuracy: 3023/10000 (30.2300%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5081/5087 (99.8821%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 22.2562, Accuracy: 980/10000 (9.8000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  40, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3390/3436 (98.6612%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 5.8499, Accuracy: 1545/10000 (15.4500%), Attack Success Rate:28/10000(0.280)
___Train Local_Simple,  epoch  40, local model 14, internal_epoch   1,  Average loss: 0.0019, Accuracy: 1449/1481 (97.8393%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 3.3115, Accuracy: 2315/10000 (23.1500%), Attack Success Rate:19/10000(0.190)
time spent on training: 438.7414948940277
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.        0.9535683 0.        0.        1.        1.        0.
 0.        1.        1.        1.        1.        1.        0.
 1.       ]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 1.0584, Accuracy: 7099/10000 (70.9900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 1.1237, Accuracy: 5603/8991 (62.3179%)
Done in 468.9065511226654 sec.
Server Epoch:41 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  41, local model 0, internal_epoch   1,  Average loss: 0.3428, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.1014, Accuracy: 6792/10000 (67.9200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3955/4113 (96.1585%), train_poison_data_count: 4113
Global model norm: 14.181387101137346.
Norm before scaling: 13.871173502833246. Distance: 1.375415132451042
Total norm for 5 adversaries is: 13.871173502833246. distance: 1.375415132451042
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 4.4357, Accuracy: 4006/8991 (44.5557%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2223/2275 (97.7143%), train_poison_data_count: 2275
Global model norm: 14.181387101137346.
Norm before scaling: 14.057597886894097. Distance: 1.920043693085059
Total norm for 5 adversaries is: 14.057597886894097. distance: 1.920043693085059
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 18.9380, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0065, Accuracy: 1207/1293 (93.3488%), train_poison_data_count: 1293
Global model norm: 14.181387101137346.
Norm before scaling: 14.134056226368857. Distance: 1.627569368117583
Total norm for 5 adversaries is: 14.134056226368857. distance: 1.627569368117583
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 4.7879, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 7941/8146 (97.4834%), train_poison_data_count: 8146
Global model norm: 14.181387101137346.
Norm before scaling: 13.379542639974014. Distance: 2.063480722014265
Total norm for 5 adversaries is: 13.379542639974014. distance: 2.063480722014265
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 6.1204, Accuracy: 2789/8991 (31.0199%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 5, internal_epoch   1,  Average loss: 0.0011, Accuracy: 5309/5399 (98.3330%), train_poison_data_count: 5399
Global model norm: 14.181387101137346.
Norm before scaling: 13.599624942768987. Distance: 1.156279589300184
Total norm for 5 adversaries is: 13.599624942768987. distance: 1.156279589300184
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 4.1223, Accuracy: 2156/8991 (23.9795%)
___Train Local_Simple,  epoch  41, local model 6, internal_epoch   1,  Average loss: 0.0076, Accuracy: 801/866 (92.4942%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 6.4253, Accuracy: 1013/10000 (10.1300%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  41, local model 7, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2802/2905 (96.4544%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 7.9897, Accuracy: 2901/10000 (29.0100%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  41, local model 8, internal_epoch   1,  Average loss: 0.0021, Accuracy: 6996/7219 (96.9109%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 4.3680, Accuracy: 4096/10000 (40.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 9, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2602/2685 (96.9088%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 4.9324, Accuracy: 2418/10000 (24.1800%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch  41, local model 10, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5443/5617 (96.9023%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.2085, Accuracy: 4706/10000 (47.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 11, internal_epoch   1,  Average loss: 0.0025, Accuracy: 7745/8046 (96.2590%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 4.4417, Accuracy: 3140/10000 (31.4000%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  41, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5080/5087 (99.8624%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 20.3769, Accuracy: 980/10000 (9.8000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  41, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3395/3436 (98.8068%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 6.1322, Accuracy: 1369/10000 (13.6900%), Attack Success Rate:21/10000(0.210)
___Train Local_Simple,  epoch  41, local model 14, internal_epoch   1,  Average loss: 0.0017, Accuracy: 1455/1481 (98.2444%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 3.3140, Accuracy: 2525/10000 (25.2500%), Attack Success Rate:13/10000(0.130)
time spent on training: 454.4588360786438
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         0.83452912 0.         0.         1.         1.
 0.         0.         1.         1.         1.         0.93534831
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 1.0325, Accuracy: 7130/10000 (71.3000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 1.1007, Accuracy: 5629/8991 (62.6071%)
Done in 487.17016196250916 sec.
Server Epoch:42 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  42, local model 0, internal_epoch   1,  Average loss: 0.3268, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.0753, Accuracy: 6850/10000 (68.5000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3941/4113 (95.8181%), train_poison_data_count: 4113
Global model norm: 14.1880425840975.
Norm before scaling: 13.884490195652273. Distance: 1.3886237585474437
Total norm for 5 adversaries is: 13.884490195652273. distance: 1.3886237585474437
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 3.8135, Accuracy: 4130/8991 (45.9348%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 2, internal_epoch   1,  Average loss: 0.0014, Accuracy: 2221/2275 (97.6264%), train_poison_data_count: 2275
Global model norm: 14.1880425840975.
Norm before scaling: 14.065029611891987. Distance: 1.911251386064385
Total norm for 5 adversaries is: 14.065029611891987. distance: 1.911251386064385
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 19.9479, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 1211/1293 (93.6582%), train_poison_data_count: 1293
Global model norm: 14.1880425840975.
Norm before scaling: 14.133176884295104. Distance: 1.511970203393677
Total norm for 5 adversaries is: 14.133176884295104. distance: 1.511970203393677
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 3.2470, Accuracy: 1178/8991 (13.1020%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 7935/8146 (97.4098%), train_poison_data_count: 8146
Global model norm: 14.1880425840975.
Norm before scaling: 13.375990786353045. Distance: 2.0289714063920523
Total norm for 5 adversaries is: 13.375990786353045. distance: 2.0289714063920523
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 5.5590, Accuracy: 2683/8991 (29.8410%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 5, internal_epoch   1,  Average loss: 0.0012, Accuracy: 5317/5399 (98.4812%), train_poison_data_count: 5399
Global model norm: 14.1880425840975.
Norm before scaling: 13.599682725683634. Distance: 1.1120998605924783
Total norm for 5 adversaries is: 13.599682725683634. distance: 1.1120998605924783
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 3.8273, Accuracy: 2202/8991 (24.4912%)
___Train Local_Simple,  epoch  42, local model 6, internal_epoch   1,  Average loss: 0.0077, Accuracy: 800/866 (92.3788%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.7796, Accuracy: 1054/10000 (10.5400%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  42, local model 7, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2809/2905 (96.6954%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 6.8593, Accuracy: 2911/10000 (29.1100%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  42, local model 8, internal_epoch   1,  Average loss: 0.0022, Accuracy: 6999/7219 (96.9525%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.0401, Accuracy: 4106/10000 (41.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 9, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2613/2685 (97.3184%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.2637, Accuracy: 2557/10000 (25.5700%), Attack Success Rate:18/10000(0.180)
___Train Local_Simple,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5416/5617 (96.4216%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 3.4550, Accuracy: 4746/10000 (47.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 11, internal_epoch   1,  Average loss: 0.0027, Accuracy: 7705/8046 (95.7619%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 4.6552, Accuracy: 3115/10000 (31.1500%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  42, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5080/5087 (99.8624%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 20.8721, Accuracy: 980/10000 (9.8000%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch  42, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3387/3436 (98.5739%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 5.8064, Accuracy: 1576/10000 (15.7600%), Attack Success Rate:22/10000(0.220)
___Train Local_Simple,  epoch  42, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1453/1481 (98.1094%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.9306, Accuracy: 2511/10000 (25.1100%), Attack Success Rate:10/10000(0.100)
time spent on training: 464.1825511455536
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         0.63248246 0.         0.         1.         1.
 0.         0.         1.         1.         1.         0.82143976
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 1.0088, Accuracy: 7174/10000 (71.7400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 1.0799, Accuracy: 5658/8991 (62.9296%)
Done in 494.4981710910797 sec.
Server Epoch:43 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  43, local model 0, internal_epoch   1,  Average loss: 0.3161, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.0493, Accuracy: 6904/10000 (69.0400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3954/4113 (96.1342%), train_poison_data_count: 4113
Global model norm: 14.194253666825992.
Norm before scaling: 13.879478487886464. Distance: 1.3751822697601075
Total norm for 5 adversaries is: 13.879478487886464. distance: 1.3751822697601075
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 4.7215, Accuracy: 3888/8991 (43.2432%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2221/2275 (97.6264%), train_poison_data_count: 2275
Global model norm: 14.194253666825992.
Norm before scaling: 14.071427830066067. Distance: 1.9417767238396286
Total norm for 5 adversaries is: 14.071427830066067. distance: 1.9417767238396286
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 20.6901, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   1,  Average loss: 0.0068, Accuracy: 1208/1293 (93.4261%), train_poison_data_count: 1293
Global model norm: 14.194253666825992.
Norm before scaling: 14.14138518761207. Distance: 1.6219879258079188
Total norm for 5 adversaries is: 14.14138518761207. distance: 1.6219879258079188
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 4.3292, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 7934/8146 (97.3975%), train_poison_data_count: 8146
Global model norm: 14.194253666825992.
Norm before scaling: 13.387007127766354. Distance: 2.029613481189491
Total norm for 5 adversaries is: 13.387007127766354. distance: 2.029613481189491
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 5.6495, Accuracy: 2733/8991 (30.3971%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5318/5399 (98.4997%), train_poison_data_count: 5399
Global model norm: 14.194253666825992.
Norm before scaling: 13.601216407680406. Distance: 1.0996573998379826
Total norm for 5 adversaries is: 13.601216407680406. distance: 1.0996573998379826
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 3.9718, Accuracy: 2184/8991 (24.2910%)
___Train Local_Simple,  epoch  43, local model 6, internal_epoch   1,  Average loss: 0.0062, Accuracy: 806/866 (93.0716%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 6.5818, Accuracy: 1113/10000 (11.1300%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  43, local model 7, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2813/2905 (96.8330%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 6.7683, Accuracy: 2903/10000 (29.0300%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  43, local model 8, internal_epoch   1,  Average loss: 0.0022, Accuracy: 6978/7219 (96.6616%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.0311, Accuracy: 4092/10000 (40.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 9, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2617/2685 (97.4674%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.2291, Accuracy: 2695/10000 (26.9500%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  43, local model 10, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5436/5617 (96.7776%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 3.1614, Accuracy: 4763/10000 (47.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 11, internal_epoch   1,  Average loss: 0.0025, Accuracy: 7757/8046 (96.4082%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 4.1831, Accuracy: 3289/10000 (32.8900%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  43, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5075/5087 (99.7641%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 20.9523, Accuracy: 980/10000 (9.8000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  43, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3382/3436 (98.4284%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 5.3862, Accuracy: 1572/10000 (15.7200%), Attack Success Rate:22/10000(0.220)
___Train Local_Simple,  epoch  43, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1459/1481 (98.5145%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.9475, Accuracy: 2654/10000 (26.5400%), Attack Success Rate:11/10000(0.110)
time spent on training: 458.0240650177002
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [0.85580185 0.58345937 0.         0.         1.         1.
 0.         0.         1.         1.         1.         0.73887358
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.9880, Accuracy: 7194/10000 (71.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 1.0625, Accuracy: 5675/8991 (63.1187%)
Done in 488.04794001579285 sec.
Server Epoch:44 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  44, local model 0, internal_epoch   1,  Average loss: 0.3067, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.0265, Accuracy: 6957/10000 (69.5700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3934/4113 (95.6479%), train_poison_data_count: 4113
Global model norm: 14.200229933045703.
Norm before scaling: 13.907827223583658. Distance: 1.4572175344063003
Total norm for 5 adversaries is: 13.907827223583658. distance: 1.4572175344063003
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 3.6807, Accuracy: 3948/8991 (43.9106%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 2222/2275 (97.6703%), train_poison_data_count: 2275
Global model norm: 14.200229933045703.
Norm before scaling: 14.08233464478996. Distance: 1.987070490653681
Total norm for 5 adversaries is: 14.08233464478996. distance: 1.987070490653681
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 22.3471, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   1,  Average loss: 0.0070, Accuracy: 1208/1293 (93.4261%), train_poison_data_count: 1293
Global model norm: 14.200229933045703.
Norm before scaling: 14.152955604528335. Distance: 1.6765235377296812
Total norm for 5 adversaries is: 14.152955604528335. distance: 1.6765235377296812
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 4.3723, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 7954/8146 (97.6430%), train_poison_data_count: 8146
Global model norm: 14.200229933045703.
Norm before scaling: 13.380742346636465. Distance: 1.962226960450199
Total norm for 5 adversaries is: 13.380742346636465. distance: 1.962226960450199
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 5.7925, Accuracy: 2756/8991 (30.6529%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5328/5399 (98.6849%), train_poison_data_count: 5399
Global model norm: 14.200229933045703.
Norm before scaling: 13.602997258833367. Distance: 1.061862417666302
Total norm for 5 adversaries is: 13.602997258833367. distance: 1.061862417666302
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 4.7813, Accuracy: 2175/8991 (24.1909%)
___Train Local_Simple,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 812/866 (93.7644%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 8.5050, Accuracy: 1010/10000 (10.1000%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  44, local model 7, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2817/2905 (96.9707%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 8.3099, Accuracy: 2900/10000 (29.0000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  44, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 6988/7219 (96.8001%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.2148, Accuracy: 4020/10000 (40.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2630/2685 (97.9516%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.3855, Accuracy: 2646/10000 (26.4600%), Attack Success Rate:11/10000(0.110)
___Train Local_Simple,  epoch  44, local model 10, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5434/5617 (96.7420%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.1560, Accuracy: 4783/10000 (47.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 11, internal_epoch   1,  Average loss: 0.0024, Accuracy: 7755/8046 (96.3833%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 4.6022, Accuracy: 3153/10000 (31.5300%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  44, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5076/5087 (99.7838%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 21.1363, Accuracy: 980/10000 (9.8000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  44, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3384/3436 (98.4866%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 5.9423, Accuracy: 1456/10000 (14.5600%), Attack Success Rate:24/10000(0.240)
___Train Local_Simple,  epoch  44, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1451/1481 (97.9743%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 3.2316, Accuracy: 2581/10000 (25.8100%), Attack Success Rate:10/10000(0.100)
time spent on training: 462.8978669643402
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         0.94848192 0.         0.         1.         1.
 0.         0.         0.86043074 1.         0.86043074 0.79165411
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.9658, Accuracy: 7227/10000 (72.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 1.0420, Accuracy: 5702/8991 (63.4190%)
Done in 493.0759868621826 sec.
Server Epoch:45 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  45, local model 0, internal_epoch   1,  Average loss: 0.2927, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.0033, Accuracy: 7026/10000 (70.2600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3960/4113 (96.2801%), train_poison_data_count: 4113
Global model norm: 14.206252019288792.
Norm before scaling: 13.899734033468837. Distance: 1.3719256015908274
Total norm for 5 adversaries is: 13.899734033468837. distance: 1.3719256015908274
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 4.6861, Accuracy: 3794/8991 (42.1978%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 2, internal_epoch   1,  Average loss: 0.0014, Accuracy: 2225/2275 (97.8022%), train_poison_data_count: 2275
Global model norm: 14.206252019288792.
Norm before scaling: 14.073295552395612. Distance: 1.8696363025039782
Total norm for 5 adversaries is: 14.073295552395612. distance: 1.8696363025039782
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 18.0550, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 1217/1293 (94.1222%), train_poison_data_count: 1293
Global model norm: 14.206252019288792.
Norm before scaling: 14.156904799115198. Distance: 1.590495882620784
Total norm for 5 adversaries is: 14.156904799115198. distance: 1.590495882620784
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 3.9558, Accuracy: 1052/8991 (11.7006%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 7942/8146 (97.4957%), train_poison_data_count: 8146
Global model norm: 14.206252019288792.
Norm before scaling: 13.389071753920831. Distance: 2.0025411198236287
Total norm for 5 adversaries is: 13.389071753920831. distance: 2.0025411198236287
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 5.5289, Accuracy: 2716/8991 (30.2080%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5334/5399 (98.7961%), train_poison_data_count: 5399
Global model norm: 14.206252019288792.
Norm before scaling: 13.608873255138137. Distance: 1.0438855317344728
Total norm for 5 adversaries is: 13.608873255138137. distance: 1.0438855317344728
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 3.9251, Accuracy: 2238/8991 (24.8916%)
___Train Local_Simple,  epoch  45, local model 6, internal_epoch   1,  Average loss: 0.0063, Accuracy: 803/866 (92.7252%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 5.8481, Accuracy: 1405/10000 (14.0500%), Attack Success Rate:30/10000(0.300)
___Train Local_Simple,  epoch  45, local model 7, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2820/2905 (97.0740%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 7.1270, Accuracy: 2873/10000 (28.7300%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  45, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 7013/7219 (97.1464%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.9713, Accuracy: 4105/10000 (41.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 9, internal_epoch   1,  Average loss: 0.0017, Accuracy: 2618/2685 (97.5047%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 4.5692, Accuracy: 2690/10000 (26.9000%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  45, local model 10, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5454/5617 (97.0981%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 3.3982, Accuracy: 4749/10000 (47.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 11, internal_epoch   1,  Average loss: 0.0024, Accuracy: 7742/8046 (96.2217%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 4.5870, Accuracy: 3154/10000 (31.5400%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  45, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5077/5087 (99.8034%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 20.6587, Accuracy: 980/10000 (9.8000%), Attack Success Rate:8/10000(0.080)
___Train Local_Simple,  epoch  45, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3389/3436 (98.6321%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 5.8248, Accuracy: 1500/10000 (15.0000%), Attack Success Rate:26/10000(0.260)
___Train Local_Simple,  epoch  45, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1456/1481 (98.3120%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.6653, Accuracy: 2815/10000 (28.1500%), Attack Success Rate:5/10000(0.050)
time spent on training: 466.5941278934479
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         0.90750399 0.         0.         1.         1.
 0.         0.41854227 1.         0.83108816 1.         0.81539923
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.9393, Accuracy: 7288/10000 (72.8800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 1.0184, Accuracy: 5757/8991 (64.0307%)
Done in 496.09766721725464 sec.
Server Epoch:46 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  46, local model 0, internal_epoch   1,  Average loss: 0.2801, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.9753, Accuracy: 7091/10000 (70.9100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3943/4113 (95.8668%), train_poison_data_count: 4113
Global model norm: 14.212569484356312.
Norm before scaling: 13.900782369646727. Distance: 1.385887262063888
Total norm for 5 adversaries is: 13.900782369646727. distance: 1.385887262063888
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 4.8811, Accuracy: 3672/8991 (40.8408%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0014, Accuracy: 2221/2275 (97.6264%), train_poison_data_count: 2275
Global model norm: 14.212569484356312.
Norm before scaling: 14.080377633492569. Distance: 1.953207761918394
Total norm for 5 adversaries is: 14.080377633492569. distance: 1.953207761918394
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 17.4398, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 1215/1293 (93.9675%), train_poison_data_count: 1293
Global model norm: 14.212569484356312.
Norm before scaling: 14.166865867261416. Distance: 1.6252162496022464
Total norm for 5 adversaries is: 14.166865867261416. distance: 1.6252162496022464
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 4.3363, Accuracy: 1027/8991 (11.4225%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 7954/8146 (97.6430%), train_poison_data_count: 8146
Global model norm: 14.212569484356312.
Norm before scaling: 13.39124886874441. Distance: 1.9762496399079874
Total norm for 5 adversaries is: 13.39124886874441. distance: 1.9762496399079874
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 5.1907, Accuracy: 2783/8991 (30.9532%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5323/5399 (98.5923%), train_poison_data_count: 5399
Global model norm: 14.212569484356312.
Norm before scaling: 13.615467901857924. Distance: 1.0489022852076735
Total norm for 5 adversaries is: 13.615467901857924. distance: 1.0489022852076735
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 3.9677, Accuracy: 2228/8991 (24.7803%)
___Train Local_Simple,  epoch  46, local model 6, internal_epoch   1,  Average loss: 0.0065, Accuracy: 808/866 (93.3025%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 5.1328, Accuracy: 1659/10000 (16.5900%), Attack Success Rate:29/10000(0.290)
___Train Local_Simple,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2804/2905 (96.5232%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 6.4689, Accuracy: 2909/10000 (29.0900%), Attack Success Rate:7/10000(0.070)
___Train Local_Simple,  epoch  46, local model 8, internal_epoch   1,  Average loss: 0.0021, Accuracy: 7007/7219 (97.0633%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.5215, Accuracy: 4094/10000 (40.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2613/2685 (97.3184%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.8784, Accuracy: 2725/10000 (27.2500%), Attack Success Rate:12/10000(0.120)
___Train Local_Simple,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5437/5617 (96.7954%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 2.9292, Accuracy: 4724/10000 (47.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 11, internal_epoch   1,  Average loss: 0.0023, Accuracy: 7761/8046 (96.4579%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 4.2446, Accuracy: 3366/10000 (33.6600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  46, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5076/5087 (99.7838%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 18.5671, Accuracy: 980/10000 (9.8000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  46, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3396/3436 (98.8359%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 5.9470, Accuracy: 1484/10000 (14.8400%), Attack Success Rate:24/10000(0.240)
___Train Local_Simple,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1460/1481 (98.5820%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 3.6058, Accuracy: 2352/10000 (23.5200%), Attack Success Rate:20/10000(0.200)
time spent on training: 468.1967649459839
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1. 1. 0. 0. 1. 1. 0. 0. 1. 1. 1. 1. 1. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.9169, Accuracy: 7333/10000 (73.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.9977, Accuracy: 5789/8991 (64.3866%)
Done in 498.66305208206177 sec.
Server Epoch:47 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  47, local model 0, internal_epoch   1,  Average loss: 0.2630, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.9532, Accuracy: 7147/10000 (71.4700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3964/4113 (96.3773%), train_poison_data_count: 4113
Global model norm: 14.21905208727861.
Norm before scaling: 13.905162022924761. Distance: 1.3685937243567328
Total norm for 5 adversaries is: 13.905162022924761. distance: 1.3685937243567328
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 4.1149, Accuracy: 3973/8991 (44.1886%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2220/2275 (97.5824%), train_poison_data_count: 2275
Global model norm: 14.21905208727861.
Norm before scaling: 14.089171755010566. Distance: 1.992443831165416
Total norm for 5 adversaries is: 14.089171755010566. distance: 1.992443831165416
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 17.7796, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   1,  Average loss: 0.0071, Accuracy: 1220/1293 (94.3542%), train_poison_data_count: 1293
Global model norm: 14.21905208727861.
Norm before scaling: 14.17084187334733. Distance: 1.6733166192399116
Total norm for 5 adversaries is: 14.17084187334733. distance: 1.6733166192399116
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 4.1194, Accuracy: 1010/8991 (11.2335%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 7961/8146 (97.7289%), train_poison_data_count: 8146
Global model norm: 14.21905208727861.
Norm before scaling: 13.391407252712757. Distance: 1.9375874284276577
Total norm for 5 adversaries is: 13.391407252712757. distance: 1.9375874284276577
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 5.8559, Accuracy: 2754/8991 (30.6306%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5329/5399 (98.7035%), train_poison_data_count: 5399
Global model norm: 14.21905208727861.
Norm before scaling: 13.613744723997003. Distance: 1.0286405088391501
Total norm for 5 adversaries is: 13.613744723997003. distance: 1.0286405088391501
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 4.5754, Accuracy: 2181/8991 (24.2576%)
___Train Local_Simple,  epoch  47, local model 6, internal_epoch   1,  Average loss: 0.0058, Accuracy: 807/866 (93.1871%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 6.6410, Accuracy: 1579/10000 (15.7900%), Attack Success Rate:31/10000(0.310)
___Train Local_Simple,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2809/2905 (96.6954%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 5.8432, Accuracy: 2909/10000 (29.0900%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  47, local model 8, internal_epoch   1,  Average loss: 0.0019, Accuracy: 7025/7219 (97.3126%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 4.5671, Accuracy: 4033/10000 (40.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 9, internal_epoch   1,  Average loss: 0.0018, Accuracy: 2620/2685 (97.5791%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.6969, Accuracy: 2723/10000 (27.2300%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  47, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5432/5617 (96.7064%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.2147, Accuracy: 4787/10000 (47.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 11, internal_epoch   1,  Average loss: 0.0022, Accuracy: 7778/8046 (96.6692%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 4.4973, Accuracy: 3156/10000 (31.5600%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  47, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5078/5087 (99.8231%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 17.9876, Accuracy: 980/10000 (9.8000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  47, local model 13, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3382/3436 (98.4284%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 5.9691, Accuracy: 1438/10000 (14.3800%), Attack Success Rate:19/10000(0.190)
___Train Local_Simple,  epoch  47, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1456/1481 (98.3120%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 3.4339, Accuracy: 2569/10000 (25.6900%), Attack Success Rate:14/10000(0.140)
time spent on training: 472.2837059497833
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         0.78618441 0.         0.         1.         1.
 0.         0.         1.         1.         1.         0.9404319
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.8966, Accuracy: 7375/10000 (73.7500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.9780, Accuracy: 5823/8991 (64.7648%)
Done in 501.8295431137085 sec.
Server Epoch:48 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  48, local model 0, internal_epoch   1,  Average loss: 0.2488, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.9324, Accuracy: 7194/10000 (71.9400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3969/4113 (96.4989%), train_poison_data_count: 4113
Global model norm: 14.225083904320597.
Norm before scaling: 13.902215333770494. Distance: 1.3307778734623632
Total norm for 5 adversaries is: 13.902215333770494. distance: 1.3307778734623632
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 4.3519, Accuracy: 4047/8991 (45.0117%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 2223/2275 (97.7143%), train_poison_data_count: 2275
Global model norm: 14.225083904320597.
Norm before scaling: 14.101918494467672. Distance: 1.998719282170685
Total norm for 5 adversaries is: 14.101918494467672. distance: 1.998719282170685
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 20.1942, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   1,  Average loss: 0.0056, Accuracy: 1205/1293 (93.1941%), train_poison_data_count: 1293
Global model norm: 14.225083904320597.
Norm before scaling: 14.172919355813969. Distance: 1.5614122800883323
Total norm for 5 adversaries is: 14.172919355813969. distance: 1.5614122800883323
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 4.3148, Accuracy: 1131/8991 (12.5792%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 7968/8146 (97.8149%), train_poison_data_count: 8146
Global model norm: 14.225083904320597.
Norm before scaling: 13.384946173131112. Distance: 1.8898850561439977
Total norm for 5 adversaries is: 13.384946173131112. distance: 1.8898850561439977
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 5.9089, Accuracy: 2699/8991 (30.0189%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 5327/5399 (98.6664%), train_poison_data_count: 5399
Global model norm: 14.225083904320597.
Norm before scaling: 13.627328656186103. Distance: 1.0466454667072422
Total norm for 5 adversaries is: 13.627328656186103. distance: 1.0466454667072422
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 4.1209, Accuracy: 2197/8991 (24.4355%)
___Train Local_Simple,  epoch  48, local model 6, internal_epoch   1,  Average loss: 0.0064, Accuracy: 808/866 (93.3025%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 5.7144, Accuracy: 1505/10000 (15.0500%), Attack Success Rate:33/10000(0.330)
___Train Local_Simple,  epoch  48, local model 7, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2809/2905 (96.6954%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 6.3625, Accuracy: 2914/10000 (29.1400%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch  48, local model 8, internal_epoch   1,  Average loss: 0.0021, Accuracy: 7004/7219 (97.0217%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 4.2064, Accuracy: 4054/10000 (40.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 9, internal_epoch   1,  Average loss: 0.0018, Accuracy: 2615/2685 (97.3929%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.7762, Accuracy: 2658/10000 (26.5800%), Attack Success Rate:14/10000(0.140)
___Train Local_Simple,  epoch  48, local model 10, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5464/5617 (97.2761%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.5343, Accuracy: 4808/10000 (48.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 11, internal_epoch   1,  Average loss: 0.0024, Accuracy: 7747/8046 (96.2839%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.8115, Accuracy: 3221/10000 (32.2100%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  48, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5073/5087 (99.7248%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 20.6444, Accuracy: 980/10000 (9.8000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  48, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3391/3436 (98.6903%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 5.9340, Accuracy: 1466/10000 (14.6600%), Attack Success Rate:20/10000(0.200)
___Train Local_Simple,  epoch  48, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1461/1481 (98.6496%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 3.1151, Accuracy: 2783/10000 (27.8300%), Attack Success Rate:9/10000(0.090)
time spent on training: 472.4304893016815
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         0.58117241 0.         0.         1.         1.
 0.         0.         1.         1.         1.         0.80261242
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.8791, Accuracy: 7409/10000 (74.0900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.9621, Accuracy: 5857/8991 (65.1429%)
Done in 501.8063681125641 sec.
Server Epoch:49 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  49, local model 0, internal_epoch   1,  Average loss: 0.2383, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.9139, Accuracy: 7236/10000 (72.3600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3977/4113 (96.6934%), train_poison_data_count: 4113
Global model norm: 14.230604390480377.
Norm before scaling: 13.902612651937213. Distance: 1.283282412513718
Total norm for 5 adversaries is: 13.902612651937213. distance: 1.283282412513718
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 4.3207, Accuracy: 4154/8991 (46.2018%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 2224/2275 (97.7582%), train_poison_data_count: 2275
Global model norm: 14.230604390480377.
Norm before scaling: 14.101317410439385. Distance: 1.9814557807988011
Total norm for 5 adversaries is: 14.101317410439385. distance: 1.9814557807988011
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 17.2755, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 1213/1293 (93.8128%), train_poison_data_count: 1293
Global model norm: 14.230604390480377.
Norm before scaling: 14.186658388962398. Distance: 1.5968783473746793
Total norm for 5 adversaries is: 14.186658388962398. distance: 1.5968783473746793
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 4.8265, Accuracy: 1102/8991 (12.2567%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 7960/8146 (97.7167%), train_poison_data_count: 8146
Global model norm: 14.230604390480377.
Norm before scaling: 13.401149962316667. Distance: 1.9936186194107575
Total norm for 5 adversaries is: 13.401149962316667. distance: 1.9936186194107575
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 5.3262, Accuracy: 2819/8991 (31.3536%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5322/5399 (98.5738%), train_poison_data_count: 5399
Global model norm: 14.230604390480377.
Norm before scaling: 13.620486010424013. Distance: 0.998623347410085
Total norm for 5 adversaries is: 13.620486010424013. distance: 0.998623347410085
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 4.0879, Accuracy: 2227/8991 (24.7692%)
___Train Local_Simple,  epoch  49, local model 6, internal_epoch   1,  Average loss: 0.0053, Accuracy: 809/866 (93.4180%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 6.5078, Accuracy: 1675/10000 (16.7500%), Attack Success Rate:28/10000(0.280)
___Train Local_Simple,  epoch  49, local model 7, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2822/2905 (97.1429%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 6.0626, Accuracy: 2910/10000 (29.1000%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch  49, local model 8, internal_epoch   1,  Average loss: 0.0019, Accuracy: 7020/7219 (97.2434%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 4.2587, Accuracy: 4109/10000 (41.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 9, internal_epoch   1,  Average loss: 0.0018, Accuracy: 2619/2685 (97.5419%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 3.7512, Accuracy: 2581/10000 (25.8100%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5456/5617 (97.1337%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.9082, Accuracy: 4780/10000 (47.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 11, internal_epoch   1,  Average loss: 0.0024, Accuracy: 7776/8046 (96.6443%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 4.4250, Accuracy: 3043/10000 (30.4300%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  49, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5081/5087 (99.8821%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 16.5844, Accuracy: 980/10000 (9.8000%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3387/3436 (98.5739%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 5.7987, Accuracy: 1458/10000 (14.5800%), Attack Success Rate:23/10000(0.230)
___Train Local_Simple,  epoch  49, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1459/1481 (98.5145%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 2.8673, Accuracy: 2783/10000 (27.8300%), Attack Success Rate:3/10000(0.030)
time spent on training: 474.25017404556274
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.         0.6091222  0.         0.         1.         1.
 0.         0.         1.         1.         1.         0.86528466
 1.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.8604, Accuracy: 7441/10000 (74.4100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.9460, Accuracy: 5888/8991 (65.4877%)
Done in 504.05316615104675 sec.
Server Epoch:50 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.2306, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.8933, Accuracy: 7287/10000 (72.8700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3970/4113 (96.5232%), train_poison_data_count: 4113
Global model norm: 14.236153819115732.
Norm before scaling: 13.904477261480888. Distance: 1.295172113373664
Total norm for 5 adversaries is: 13.904477261480888. distance: 1.295172113373664
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 3.8579, Accuracy: 4209/8991 (46.8135%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 2222/2275 (97.6703%), train_poison_data_count: 2275
Global model norm: 14.236153819115732.
Norm before scaling: 14.114022909865044. Distance: 2.013550037801451
Total norm for 5 adversaries is: 14.114022909865044. distance: 2.013550037801451
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 21.3247, Accuracy: 982/8991 (10.9220%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 1226/1293 (94.8183%), train_poison_data_count: 1293
Global model norm: 14.236153819115732.
Norm before scaling: 14.169553455108863. Distance: 1.5032917302980304
Total norm for 5 adversaries is: 14.169553455108863. distance: 1.5032917302980304
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 3.3226, Accuracy: 1189/8991 (13.2243%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 4, internal_epoch   1,  Average loss: 0.0014, Accuracy: 7978/8146 (97.9376%), train_poison_data_count: 8146
Global model norm: 14.236153819115732.
Norm before scaling: 13.384453115651686. Distance: 1.8792301779063563
Total norm for 5 adversaries is: 13.384453115651686. distance: 1.8792301779063563
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 5.7129, Accuracy: 2708/8991 (30.1190%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 5330/5399 (98.7220%), train_poison_data_count: 5399
Global model norm: 14.236153819115732.
Norm before scaling: 13.630499893391658. Distance: 1.0079378153640273
Total norm for 5 adversaries is: 13.630499893391658. distance: 1.0079378153640273
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 3.9026, Accuracy: 2331/8991 (25.9259%)
___Train Local_Simple,  epoch  50, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 812/866 (93.7644%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 6.3985, Accuracy: 1288/10000 (12.8800%), Attack Success Rate:16/10000(0.160)
___Train Local_Simple,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0022, Accuracy: 2815/2905 (96.9019%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 7.9357, Accuracy: 2884/10000 (28.8400%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch  50, local model 8, internal_epoch   1,  Average loss: 0.0019, Accuracy: 7029/7219 (97.3681%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.9078, Accuracy: 4090/10000 (40.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2614/2685 (97.3557%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 3.6427, Accuracy: 2678/10000 (26.7800%), Attack Success Rate:15/10000(0.150)
___Train Local_Simple,  epoch  50, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5438/5617 (96.8132%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.6964, Accuracy: 4700/10000 (47.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 11, internal_epoch   1,  Average loss: 0.0023, Accuracy: 7776/8046 (96.6443%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 4.2575, Accuracy: 3185/10000 (31.8500%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch  50, local model 12, internal_epoch   1,  Average loss: 0.0002, Accuracy: 5078/5087 (99.8231%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 19.0685, Accuracy: 980/10000 (9.8000%), Attack Success Rate:4/10000(0.040)
___Train Local_Simple,  epoch  50, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3390/3436 (98.6612%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 6.4937, Accuracy: 1468/10000 (14.6800%), Attack Success Rate:35/10000(0.350)
___Train Local_Simple,  epoch  50, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1457/1481 (98.3795%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 2.6204, Accuracy: 3014/10000 (30.1400%), Attack Success Rate:4/10000(0.040)
time spent on training: 550.3157930374146
[foolsgold agg] training data poison_ratio: 0.3624039610722213  data num: [2, 4113, 2275, 1293, 8146, 5399, 866, 2905, 7219, 2685, 5617, 8046, 5087, 3436, 1481]
[foolsgold agg] considering poison per batch poison_fraction: 0.3624039610722212
[foolsgold agg] wv: [1.        1.        0.        0.        1.        1.        0.
 0.        1.        1.        1.        0.7176769 1.        0.
 0.8562757]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.8466, Accuracy: 7454/10000 (74.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.9357, Accuracy: 5896/8991 (65.5767%)
Done in 579.7874448299408 sec.
Server Epoch:51 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  51, local model 0, internal_epoch   1,  Average loss: 0.2196, Accuracy: 2/2 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.8787, Accuracy: 7301/10000 (73.0100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 1, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3959/4113 (96.2558%), train_poison_data_count: 4113
Global model norm: 14.241960901413218.
Norm before scaling: 13.911432496388088. Distance: 1.3114133605437015
Total norm for 5 adversaries is: 13.911432496388088. distance: 1.3114133605437015
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 3.5823, Accuracy: 4077/8991 (45.3453%)
poison local model 2 index 1 
poison_now
