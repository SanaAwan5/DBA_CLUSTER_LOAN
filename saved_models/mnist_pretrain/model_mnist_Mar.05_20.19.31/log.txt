current path: saved_models/mnist_pretrain/model_mnist_Mar.05_20.19.31
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   1, local model 0, internal_epoch   1,  Average loss: 0.0365, Accuracy: 1110/3010 (36.8771%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.2957, Accuracy: 5122/10000 (51.2200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 1, internal_epoch   1,  Average loss: 0.0143, Accuracy: 4502/5805 (77.5538%), train_poison_data_count: 5805
Global model norm: 13.89800383141575.
Norm before scaling: 13.558224615041382. Distance: 2.7253882385304693
Total norm for 5 adversaries is: 13.558224615041382. distance: 2.7253882385304693
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 2.4666, Accuracy: 4414/8991 (49.0935%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 2, internal_epoch   1,  Average loss: 0.0244, Accuracy: 2853/4779 (59.6987%), train_poison_data_count: 4779
Global model norm: 13.89800383141575.
Norm before scaling: 13.785533144288095. Distance: 2.9532467448656523
Total norm for 5 adversaries is: 13.785533144288095. distance: 2.9532467448656523
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 1.0396, Accuracy: 6072/8991 (67.5342%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 3, internal_epoch   1,  Average loss: 0.0219, Accuracy: 3269/5123 (63.8103%), train_poison_data_count: 5123
Global model norm: 13.89800383141575.
Norm before scaling: 13.738718849655626. Distance: 2.9580021704200896
Total norm for 5 adversaries is: 13.738718849655626. distance: 2.9580021704200896
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 1.2668, Accuracy: 6121/8991 (68.0792%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 4, internal_epoch   1,  Average loss: 0.0259, Accuracy: 2597/4462 (58.2026%), train_poison_data_count: 4462
Global model norm: 13.89800383141575.
Norm before scaling: 13.752512754244734. Distance: 2.7095543578728627
Total norm for 5 adversaries is: 13.752512754244734. distance: 2.7095543578728627
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 1.6630, Accuracy: 5281/8991 (58.7365%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 5, internal_epoch   1,  Average loss: 0.0221, Accuracy: 2532/3841 (65.9203%), train_poison_data_count: 3841
Global model norm: 13.89800383141575.
Norm before scaling: 13.775380517373648. Distance: 2.4734328076528356
Total norm for 5 adversaries is: 13.775380517373648. distance: 2.4734328076528356
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 2.4929, Accuracy: 4648/8991 (51.6961%)
___Train Local_Simple,  epoch   1, local model 6, internal_epoch   1,  Average loss: 0.0302, Accuracy: 1448/2945 (49.1681%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.6403, Accuracy: 2762/10000 (27.6200%), Attack Success Rate:9/10000(0.090)
___Train Local_Simple,  epoch   1, local model 7, internal_epoch   1,  Average loss: 0.0235, Accuracy: 1805/2756 (65.4935%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.5760, Accuracy: 2131/10000 (21.3100%), Attack Success Rate:22/10000(0.220)
___Train Local_Simple,  epoch   1, local model 8, internal_epoch   1,  Average loss: 0.0343, Accuracy: 1470/3437 (42.7699%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.0911, Accuracy: 4426/10000 (44.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 9, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3937/5809 (67.7741%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.3409, Accuracy: 3566/10000 (35.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 10, internal_epoch   1,  Average loss: 0.0229, Accuracy: 1707/2592 (65.8565%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.7183, Accuracy: 2809/10000 (28.0900%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0354, Accuracy: 1057/2510 (42.1116%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.0358, Accuracy: 4809/10000 (48.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 12, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3320/4373 (75.9204%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.9362, Accuracy: 3105/10000 (31.0500%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   1, local model 13, internal_epoch   1,  Average loss: 0.0207, Accuracy: 3051/4339 (70.3157%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.8264, Accuracy: 5141/10000 (51.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 14, internal_epoch   1,  Average loss: 0.0298, Accuracy: 1383/2782 (49.7124%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 3.3099, Accuracy: 2677/10000 (26.7700%), Attack Success Rate:8/10000(0.080)
time spent on training: 177.24823093414307
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.27260745 0.18568366 0.32291143 0.94253013
 0.27260745 0.         0.         0.92370476 1.         0.18568366
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2945, Accuracy: 1079/10000 (10.7900%), Attack Success Rate:6/10000(0.060)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2919, Accuracy: 1052/8991 (11.7006%)
Done in 207.9096429347992 sec.
Server Epoch:2 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   2, local model 0, internal_epoch   1,  Average loss: 0.0335, Accuracy: 1305/3010 (43.3555%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.0726, Accuracy: 5295/10000 (52.9500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 1, internal_epoch   1,  Average loss: 0.0134, Accuracy: 4612/5805 (79.4488%), train_poison_data_count: 5805
Global model norm: 13.90342207025565.
Norm before scaling: 13.566125622457463. Distance: 2.7146405260604913
Total norm for 5 adversaries is: 13.566125622457463. distance: 2.7146405260604913
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 2.4136, Accuracy: 4728/8991 (52.5859%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 2, internal_epoch   1,  Average loss: 0.0223, Accuracy: 3006/4779 (62.9002%), train_poison_data_count: 4779
Global model norm: 13.90342207025565.
Norm before scaling: 13.808494850246962. Distance: 2.9558102948094227
Total norm for 5 adversaries is: 13.808494850246962. distance: 2.9558102948094227
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 1.1179, Accuracy: 6155/8991 (68.4573%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 3, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3484/5123 (68.0070%), train_poison_data_count: 5123
Global model norm: 13.90342207025565.
Norm before scaling: 13.753814722962998. Distance: 2.924112860321479
Total norm for 5 adversaries is: 13.753814722962998. distance: 2.924112860321479
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 1.1901, Accuracy: 6540/8991 (72.7394%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 4, internal_epoch   1,  Average loss: 0.0241, Accuracy: 2691/4462 (60.3093%), train_poison_data_count: 4462
Global model norm: 13.90342207025565.
Norm before scaling: 13.786599572004297. Distance: 2.7581985678889738
Total norm for 5 adversaries is: 13.786599572004297. distance: 2.7581985678889738
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 1.5640, Accuracy: 5774/8991 (64.2198%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 5, internal_epoch   1,  Average loss: 0.0208, Accuracy: 2549/3841 (66.3629%), train_poison_data_count: 3841
Global model norm: 13.90342207025565.
Norm before scaling: 13.803215669451188. Distance: 2.5104451369152496
Total norm for 5 adversaries is: 13.803215669451188. distance: 2.5104451369152496
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 2.4964, Accuracy: 4886/8991 (54.3432%)
___Train Local_Simple,  epoch   2, local model 6, internal_epoch   1,  Average loss: 0.0281, Accuracy: 1568/2945 (53.2428%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.7514, Accuracy: 3978/10000 (39.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 7, internal_epoch   1,  Average loss: 0.0213, Accuracy: 1893/2756 (68.6865%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.6411, Accuracy: 3415/10000 (34.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 8, internal_epoch   1,  Average loss: 0.0309, Accuracy: 1686/3437 (49.0544%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.3992, Accuracy: 5365/10000 (53.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 9, internal_epoch   1,  Average loss: 0.0164, Accuracy: 4172/5809 (71.8196%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 3.3360, Accuracy: 3678/10000 (36.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 10, internal_epoch   1,  Average loss: 0.0210, Accuracy: 1800/2592 (69.4444%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.7224, Accuracy: 2875/10000 (28.7500%), Attack Success Rate:6/10000(0.060)
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0334, Accuracy: 1143/2510 (45.5378%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.4943, Accuracy: 5406/10000 (54.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 12, internal_epoch   1,  Average loss: 0.0143, Accuracy: 3485/4373 (79.6936%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 4.5336, Accuracy: 3538/10000 (35.3800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   2, local model 13, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3209/4339 (73.9571%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.4644, Accuracy: 4662/10000 (46.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 14, internal_epoch   1,  Average loss: 0.0298, Accuracy: 1427/2782 (51.2940%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 3.1539, Accuracy: 2575/10000 (25.7500%), Attack Success Rate:13/10000(0.130)
time spent on training: 179.69352793693542
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.49696695 0.38899999 0.47036718 0.74154861
 0.49696695 0.         0.         1.         1.         0.38899999
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2813, Accuracy: 1630/10000 (16.3000%), Attack Success Rate:36/10000(0.360)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2759, Accuracy: 1603/8991 (17.8289%)
Done in 210.8684618473053 sec.
Server Epoch:3 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   3, local model 0, internal_epoch   1,  Average loss: 0.0298, Accuracy: 1501/3010 (49.8671%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.9006, Accuracy: 5963/10000 (59.6300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 1, internal_epoch   1,  Average loss: 0.0121, Accuracy: 4726/5805 (81.4126%), train_poison_data_count: 5805
Global model norm: 13.910445842604725.
Norm before scaling: 13.562443746283106. Distance: 2.6153992877954275
Total norm for 5 adversaries is: 13.562443746283106. distance: 2.6153992877954275
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 2.4178, Accuracy: 4870/8991 (54.1653%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 2, internal_epoch   1,  Average loss: 0.0207, Accuracy: 3117/4779 (65.2228%), train_poison_data_count: 4779
Global model norm: 13.910445842604725.
Norm before scaling: 13.809701489337463. Distance: 2.882487457062825
Total norm for 5 adversaries is: 13.809701489337463. distance: 2.882487457062825
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5810, Accuracy: 7310/8991 (81.3035%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 3, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3670/5123 (71.6377%), train_poison_data_count: 5123
Global model norm: 13.910445842604725.
Norm before scaling: 13.791017146340732. Distance: 2.9632057218533467
Total norm for 5 adversaries is: 13.791017146340732. distance: 2.9632057218533467
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 1.0417, Accuracy: 6859/8991 (76.2874%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 4, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2894/4462 (64.8588%), train_poison_data_count: 4462
Global model norm: 13.910445842604725.
Norm before scaling: 13.829452950890662. Distance: 2.8106378960732417
Total norm for 5 adversaries is: 13.829452950890662. distance: 2.8106378960732417
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 1.2085, Accuracy: 6345/8991 (70.5706%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 5, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2728/3841 (71.0232%), train_poison_data_count: 3841
Global model norm: 13.910445842604725.
Norm before scaling: 13.828076447654876. Distance: 2.5167779590512183
Total norm for 5 adversaries is: 13.828076447654876. distance: 2.5167779590512183
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 2.5386, Accuracy: 4795/8991 (53.3311%)
___Train Local_Simple,  epoch   3, local model 6, internal_epoch   1,  Average loss: 0.0264, Accuracy: 1698/2945 (57.6570%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.5241, Accuracy: 4234/10000 (42.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 7, internal_epoch   1,  Average loss: 0.0207, Accuracy: 1983/2756 (71.9521%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.8334, Accuracy: 3003/10000 (30.0300%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   3, local model 8, internal_epoch   1,  Average loss: 0.0281, Accuracy: 1882/3437 (54.7571%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.3519, Accuracy: 5580/10000 (55.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 9, internal_epoch   1,  Average loss: 0.0149, Accuracy: 4347/5809 (74.8322%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 3.3942, Accuracy: 3662/10000 (36.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 10, internal_epoch   1,  Average loss: 0.0195, Accuracy: 1908/2592 (73.6111%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.4002, Accuracy: 3277/10000 (32.7700%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   3, local model 11, internal_epoch   1,  Average loss: 0.0299, Accuracy: 1380/2510 (54.9801%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.2649, Accuracy: 5912/10000 (59.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 12, internal_epoch   1,  Average loss: 0.0136, Accuracy: 3522/4373 (80.5397%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 3.2854, Accuracy: 3257/10000 (32.5700%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch   3, local model 13, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3293/4339 (75.8931%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.5472, Accuracy: 5204/10000 (52.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 14, internal_epoch   1,  Average loss: 0.0268, Accuracy: 1590/2782 (57.1531%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.9735, Accuracy: 2938/10000 (29.3800%), Attack Success Rate:2/10000(0.020)
time spent on training: 185.31674194335938
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.20255357 0.20255357 0.15048575 0.6459926
 0.33117498 0.         0.         0.70578474 1.         0.28461727
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.2671, Accuracy: 2406/10000 (24.0600%), Attack Success Rate:14/10000(0.140)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.2602, Accuracy: 2386/8991 (26.5376%)
Done in 216.0071370601654 sec.
Server Epoch:4 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   4, local model 0, internal_epoch   1,  Average loss: 0.0278, Accuracy: 1639/3010 (54.4518%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.9212, Accuracy: 6584/10000 (65.8400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 1, internal_epoch   1,  Average loss: 0.0115, Accuracy: 4809/5805 (82.8424%), train_poison_data_count: 5805
Global model norm: 13.916512189605465.
Norm before scaling: 13.601021761939432. Distance: 2.6996121375216475
Total norm for 5 adversaries is: 13.601021761939432. distance: 2.6996121375216475
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 3.1401, Accuracy: 4431/8991 (49.2826%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 2, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3250/4779 (68.0059%), train_poison_data_count: 4779
Global model norm: 13.916512189605465.
Norm before scaling: 13.83473535503119. Distance: 2.8815708536164126
Total norm for 5 adversaries is: 13.83473535503119. distance: 2.8815708536164126
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5120, Accuracy: 7404/8991 (82.3490%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 3, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3782/5123 (73.8239%), train_poison_data_count: 5123
Global model norm: 13.916512189605465.
Norm before scaling: 13.800669026397665. Distance: 2.9338261782715627
Total norm for 5 adversaries is: 13.800669026397665. distance: 2.9338261782715627
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.9889, Accuracy: 7046/8991 (78.3673%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 4, internal_epoch   1,  Average loss: 0.0196, Accuracy: 3042/4462 (68.1757%), train_poison_data_count: 4462
Global model norm: 13.916512189605465.
Norm before scaling: 13.836584299005176. Distance: 2.746759499474849
Total norm for 5 adversaries is: 13.836584299005176. distance: 2.746759499474849
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 1.5153, Accuracy: 6027/8991 (67.0337%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 5, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2907/3841 (75.6834%), train_poison_data_count: 3841
Global model norm: 13.916512189605465.
Norm before scaling: 13.841873351744777. Distance: 2.4852620586474554
Total norm for 5 adversaries is: 13.841873351744777. distance: 2.4852620586474554
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 2.3869, Accuracy: 5180/8991 (57.6132%)
___Train Local_Simple,  epoch   4, local model 6, internal_epoch   1,  Average loss: 0.0238, Accuracy: 1843/2945 (62.5806%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.5876, Accuracy: 4567/10000 (45.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 7, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2085/2756 (75.6531%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.6023, Accuracy: 3166/10000 (31.6600%), Attack Success Rate:3/10000(0.030)
___Train Local_Simple,  epoch   4, local model 8, internal_epoch   1,  Average loss: 0.0266, Accuracy: 2004/3437 (58.3067%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.3530, Accuracy: 5956/10000 (59.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 9, internal_epoch   1,  Average loss: 0.0138, Accuracy: 4501/5809 (77.4832%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.9807, Accuracy: 3921/10000 (39.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 10, internal_epoch   1,  Average loss: 0.0190, Accuracy: 1950/2592 (75.2315%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.6139, Accuracy: 3045/10000 (30.4500%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   4, local model 11, internal_epoch   1,  Average loss: 0.0280, Accuracy: 1470/2510 (58.5657%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.2561, Accuracy: 6159/10000 (61.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 12, internal_epoch   1,  Average loss: 0.0122, Accuracy: 3625/4373 (82.8950%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 3.5498, Accuracy: 3428/10000 (34.2800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3358/4339 (77.3911%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.5011, Accuracy: 5261/10000 (52.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 14, internal_epoch   1,  Average loss: 0.0245, Accuracy: 1696/2782 (60.9633%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.7929, Accuracy: 3844/10000 (38.4400%), Attack Success Rate:0/10000(0.000)
time spent on training: 190.58470392227173
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.02600568 0.02600568 0.17268944 0.36304113
 0.46390613 0.         0.         0.55333662 1.         0.13945223
 0.9566949  1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 2.2521, Accuracy: 2772/10000 (27.7200%), Attack Success Rate:10/10000(0.100)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 2.2439, Accuracy: 2757/8991 (30.6640%)
Done in 220.5686001777649 sec.
Server Epoch:5 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   5, local model 0, internal_epoch   1,  Average loss: 0.0264, Accuracy: 1730/3010 (57.4751%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.5670, Accuracy: 6382/10000 (63.8200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 1, internal_epoch   1,  Average loss: 0.0111, Accuracy: 4835/5805 (83.2903%), train_poison_data_count: 5805
Global model norm: 13.921942953678153.
Norm before scaling: 13.594431892918914. Distance: 2.630330984950956
Total norm for 5 adversaries is: 13.594431892918914. distance: 2.630330984950956
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 2.5464, Accuracy: 4864/8991 (54.0985%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 2, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3401/4779 (71.1655%), train_poison_data_count: 4779
Global model norm: 13.921942953678153.
Norm before scaling: 13.844797064663632. Distance: 2.8562077558803347
Total norm for 5 adversaries is: 13.844797064663632. distance: 2.8562077558803347
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5481, Accuracy: 7213/8991 (80.2247%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 3, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3843/5123 (75.0146%), train_poison_data_count: 5123
Global model norm: 13.921942953678153.
Norm before scaling: 13.797075730242792. Distance: 2.8598554030458545
Total norm for 5 adversaries is: 13.797075730242792. distance: 2.8598554030458545
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 1.1447, Accuracy: 6847/8991 (76.1539%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3121/4462 (69.9462%), train_poison_data_count: 4462
Global model norm: 13.921942953678153.
Norm before scaling: 13.852769793692207. Distance: 2.7497992008766023
Total norm for 5 adversaries is: 13.852769793692207. distance: 2.7497992008766023
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 1.2695, Accuracy: 6305/8991 (70.1257%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 5, internal_epoch   1,  Average loss: 0.0158, Accuracy: 2931/3841 (76.3083%), train_poison_data_count: 3841
Global model norm: 13.921942953678153.
Norm before scaling: 13.85081009131043. Distance: 2.453732943677188
Total norm for 5 adversaries is: 13.85081009131043. distance: 2.453732943677188
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 2.3446, Accuracy: 6007/8991 (66.8113%)
___Train Local_Simple,  epoch   5, local model 6, internal_epoch   1,  Average loss: 0.0226, Accuracy: 1918/2945 (65.1273%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.2393, Accuracy: 4780/10000 (47.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2071/2756 (75.1451%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.5649, Accuracy: 4510/10000 (45.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 8, internal_epoch   1,  Average loss: 0.0243, Accuracy: 2085/3437 (60.6634%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.2005, Accuracy: 5997/10000 (59.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 9, internal_epoch   1,  Average loss: 0.0132, Accuracy: 4559/5809 (78.4817%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 3.6107, Accuracy: 3567/10000 (35.6700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   5, local model 10, internal_epoch   1,  Average loss: 0.0179, Accuracy: 1964/2592 (75.7716%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.3643, Accuracy: 3665/10000 (36.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 11, internal_epoch   1,  Average loss: 0.0263, Accuracy: 1560/2510 (62.1514%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.8884, Accuracy: 6885/10000 (68.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 12, internal_epoch   1,  Average loss: 0.0117, Accuracy: 3628/4373 (82.9636%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 3.1078, Accuracy: 3363/10000 (33.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 13, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3452/4339 (79.5575%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.3299, Accuracy: 5286/10000 (52.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0228, Accuracy: 1768/2782 (63.5514%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.8235, Accuracy: 4419/10000 (44.1900%), Attack Success Rate:0/10000(0.000)
time spent on training: 197.01931500434875
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.09950675 0.09950675 0.22454517 0.85367435
 0.54118062 0.         0.         0.90799729 1.         0.22771787
 1.         1.         0.95859608]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.2297, Accuracy: 3068/10000 (30.6800%), Attack Success Rate:5/10000(0.050)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 2.2189, Accuracy: 3056/8991 (33.9895%)
Done in 227.3779399394989 sec.
Server Epoch:6 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   6, local model 0, internal_epoch   1,  Average loss: 0.0243, Accuracy: 1836/3010 (60.9967%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.4322, Accuracy: 6385/10000 (63.8500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 1, internal_epoch   1,  Average loss: 0.0104, Accuracy: 4960/5805 (85.4436%), train_poison_data_count: 5805
Global model norm: 13.929422954758.
Norm before scaling: 13.599262531705534. Distance: 2.5856338737617683
Total norm for 5 adversaries is: 13.599262531705534. distance: 2.5856338737617683
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 2.4441, Accuracy: 4836/8991 (53.7871%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 2, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3541/4779 (74.0950%), train_poison_data_count: 4779
Global model norm: 13.929422954758.
Norm before scaling: 13.856527592928675. Distance: 2.83036083549544
Total norm for 5 adversaries is: 13.856527592928675. distance: 2.83036083549544
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.7448, Accuracy: 6560/8991 (72.9619%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 3, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3987/5123 (77.8255%), train_poison_data_count: 5123
Global model norm: 13.929422954758.
Norm before scaling: 13.813392575798495. Distance: 2.8485400760530597
Total norm for 5 adversaries is: 13.813392575798495. distance: 2.8485400760530597
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.9765, Accuracy: 6607/8991 (73.4846%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3175/4462 (71.1564%), train_poison_data_count: 4462
Global model norm: 13.929422954758.
Norm before scaling: 13.873034088803413. Distance: 2.7377344910683368
Total norm for 5 adversaries is: 13.873034088803413. distance: 2.7377344910683368
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 1.3955, Accuracy: 6359/8991 (70.7263%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 5, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3052/3841 (79.4585%), train_poison_data_count: 3841
Global model norm: 13.929422954758.
Norm before scaling: 13.876176663929936. Distance: 2.476401723943846
Total norm for 5 adversaries is: 13.876176663929936. distance: 2.476401723943846
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 2.5903, Accuracy: 5446/8991 (60.5717%)
___Train Local_Simple,  epoch   6, local model 6, internal_epoch   1,  Average loss: 0.0210, Accuracy: 1998/2945 (67.8438%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.9122, Accuracy: 5235/10000 (52.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 7, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2155/2756 (78.1930%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.8201, Accuracy: 2985/10000 (29.8500%), Attack Success Rate:5/10000(0.050)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0225, Accuracy: 2253/3437 (65.5514%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.9798, Accuracy: 6203/10000 (62.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 9, internal_epoch   1,  Average loss: 0.0120, Accuracy: 4719/5809 (81.2360%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.8658, Accuracy: 4083/10000 (40.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 10, internal_epoch   1,  Average loss: 0.0162, Accuracy: 2020/2592 (77.9321%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.5281, Accuracy: 3280/10000 (32.8000%), Attack Success Rate:2/10000(0.020)
___Train Local_Simple,  epoch   6, local model 11, internal_epoch   1,  Average loss: 0.0243, Accuracy: 1680/2510 (66.9323%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.9793, Accuracy: 6389/10000 (63.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 12, internal_epoch   1,  Average loss: 0.0106, Accuracy: 3715/4373 (84.9531%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 3.3777, Accuracy: 3473/10000 (34.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 13, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3491/4339 (80.4563%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.5202, Accuracy: 5250/10000 (52.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 14, internal_epoch   1,  Average loss: 0.0215, Accuracy: 1828/2782 (65.7081%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.5289, Accuracy: 4861/10000 (48.6100%), Attack Success Rate:0/10000(0.000)
time spent on training: 201.26585292816162
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.01304008 0.         0.         0.49327215
 0.16526942 0.         0.         0.05243319 0.96719906 0.
 0.67358544 1.         0.72625437]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 2.2145, Accuracy: 3168/10000 (31.6800%), Attack Success Rate:4/10000(0.040)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 2.2038, Accuracy: 3159/8991 (35.1351%)
Done in 231.01478385925293 sec.
Server Epoch:7 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   7, local model 0, internal_epoch   1,  Average loss: 0.0229, Accuracy: 1916/3010 (63.6545%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.5313, Accuracy: 6554/10000 (65.5400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 1, internal_epoch   1,  Average loss: 0.0102, Accuracy: 4953/5805 (85.3230%), train_poison_data_count: 5805
Global model norm: 13.933469454695118.
Norm before scaling: 13.609571208043143. Distance: 2.5866123943763695
Total norm for 5 adversaries is: 13.609571208043143. distance: 2.5866123943763695
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 2.6800, Accuracy: 4730/8991 (52.6082%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 2, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3593/4779 (75.1831%), train_poison_data_count: 4779
Global model norm: 13.933469454695118.
Norm before scaling: 13.898402367858914. Distance: 2.9274180663229807
Total norm for 5 adversaries is: 13.898402367858914. distance: 2.9274180663229807
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5734, Accuracy: 7094/8991 (78.9011%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 3, internal_epoch   1,  Average loss: 0.0143, Accuracy: 4025/5123 (78.5672%), train_poison_data_count: 5123
Global model norm: 13.933469454695118.
Norm before scaling: 13.837513364873288. Distance: 2.8730196559298675
Total norm for 5 adversaries is: 13.837513364873288. distance: 2.8730196559298675
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.8950, Accuracy: 7073/8991 (78.6676%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 4, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3336/4462 (74.7647%), train_poison_data_count: 4462
Global model norm: 13.933469454695118.
Norm before scaling: 13.874936215365775. Distance: 2.692718673086083
Total norm for 5 adversaries is: 13.874936215365775. distance: 2.692718673086083
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 1.1442, Accuracy: 6823/8991 (75.8870%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 5, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3030/3841 (78.8857%), train_poison_data_count: 3841
Global model norm: 13.933469454695118.
Norm before scaling: 13.875780238302987. Distance: 2.447526508378675
Total norm for 5 adversaries is: 13.875780238302987. distance: 2.447526508378675
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 2.4365, Accuracy: 5224/8991 (58.1025%)
___Train Local_Simple,  epoch   7, local model 6, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2015/2945 (68.4211%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.8264, Accuracy: 5168/10000 (51.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0174, Accuracy: 2147/2756 (77.9028%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.3961, Accuracy: 4601/10000 (46.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 8, internal_epoch   1,  Average loss: 0.0213, Accuracy: 2298/3437 (66.8606%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.0748, Accuracy: 6462/10000 (64.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 9, internal_epoch   1,  Average loss: 0.0117, Accuracy: 4817/5809 (82.9231%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.7641, Accuracy: 4288/10000 (42.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2028/2592 (78.2407%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.3662, Accuracy: 3706/10000 (37.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 11, internal_epoch   1,  Average loss: 0.0240, Accuracy: 1682/2510 (67.0120%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.8578, Accuracy: 6853/10000 (68.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 12, internal_epoch   1,  Average loss: 0.0101, Accuracy: 3769/4373 (86.1880%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 3.2536, Accuracy: 3572/10000 (35.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 13, internal_epoch   1,  Average loss: 0.0134, Accuracy: 3528/4339 (81.3091%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.0390, Accuracy: 5281/10000 (52.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 14, internal_epoch   1,  Average loss: 0.0201, Accuracy: 1909/2782 (68.6197%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.8558, Accuracy: 4650/10000 (46.5000%), Attack Success Rate:0/10000(0.000)
time spent on training: 208.5943100452423
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.07663638 0.37286991
 0.07823517 0.         0.         0.31206886 1.         0.07823517
 1.         1.         0.81316403]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 2.1950, Accuracy: 3320/10000 (33.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 2.1833, Accuracy: 3315/8991 (36.8702%)
Done in 238.63988089561462 sec.
Server Epoch:8 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   8, local model 0, internal_epoch   1,  Average loss: 0.0229, Accuracy: 1905/3010 (63.2890%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.5614, Accuracy: 6624/10000 (66.2400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 1, internal_epoch   1,  Average loss: 0.0098, Accuracy: 5019/5805 (86.4599%), train_poison_data_count: 5805
Global model norm: 13.938549327266191.
Norm before scaling: 13.609967539662394. Distance: 2.5433130924757656
Total norm for 5 adversaries is: 13.609967539662394. distance: 2.5433130924757656
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 2.3592, Accuracy: 4929/8991 (54.8215%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 2, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3670/4779 (76.7943%), train_poison_data_count: 4779
Global model norm: 13.938549327266191.
Norm before scaling: 13.870464511565629. Distance: 2.779874311391396
Total norm for 5 adversaries is: 13.870464511565629. distance: 2.779874311391396
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.5560, Accuracy: 7287/8991 (81.0477%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 3, internal_epoch   1,  Average loss: 0.0137, Accuracy: 4161/5123 (81.2219%), train_poison_data_count: 5123
Global model norm: 13.938549327266191.
Norm before scaling: 13.794811677715387. Distance: 2.6902979989890077
Total norm for 5 adversaries is: 13.794811677715387. distance: 2.6902979989890077
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.9927, Accuracy: 6500/8991 (72.2945%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 4, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3413/4462 (76.4904%), train_poison_data_count: 4462
Global model norm: 13.938549327266191.
Norm before scaling: 13.884988025059823. Distance: 2.680108307030623
Total norm for 5 adversaries is: 13.884988025059823. distance: 2.680108307030623
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 1.1928, Accuracy: 6596/8991 (73.3623%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 5, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3140/3841 (81.7495%), train_poison_data_count: 3841
Global model norm: 13.938549327266191.
Norm before scaling: 13.870794535283084. Distance: 2.3647886906878646
Total norm for 5 adversaries is: 13.870794535283084. distance: 2.3647886906878646
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 2.0353, Accuracy: 5411/8991 (60.1824%)
___Train Local_Simple,  epoch   8, local model 6, internal_epoch   1,  Average loss: 0.0202, Accuracy: 1997/2945 (67.8098%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.5572, Accuracy: 5339/10000 (53.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 7, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2191/2756 (79.4993%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.3026, Accuracy: 4670/10000 (46.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 8, internal_epoch   1,  Average loss: 0.0205, Accuracy: 2320/3437 (67.5007%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.1912, Accuracy: 5972/10000 (59.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0111, Accuracy: 4828/5809 (83.1124%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 3.2294, Accuracy: 4133/10000 (41.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 10, internal_epoch   1,  Average loss: 0.0144, Accuracy: 2089/2592 (80.5941%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.2925, Accuracy: 3891/10000 (38.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 11, internal_epoch   1,  Average loss: 0.0224, Accuracy: 1730/2510 (68.9243%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.0740, Accuracy: 6117/10000 (61.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0098, Accuracy: 3831/4373 (87.6058%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 3.3312, Accuracy: 3278/10000 (32.7800%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch   8, local model 13, internal_epoch   1,  Average loss: 0.0129, Accuracy: 3553/4339 (81.8852%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.0364, Accuracy: 5332/10000 (53.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 14, internal_epoch   1,  Average loss: 0.0198, Accuracy: 1914/2782 (68.7994%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.7773, Accuracy: 4956/10000 (49.5600%), Attack Success Rate:0/10000(0.000)
time spent on training: 215.0453701019287
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.08725625 0.56120986
 0.         0.         0.         0.41890035 1.         0.
 1.         1.         0.65187507]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 2.1741, Accuracy: 3405/10000 (34.0500%), Attack Success Rate:3/10000(0.030)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 2.1620, Accuracy: 3407/8991 (37.8934%)
Done in 244.69344186782837 sec.
Server Epoch:9 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   9, local model 0, internal_epoch   1,  Average loss: 0.0208, Accuracy: 2028/3010 (67.3754%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.5393, Accuracy: 6377/10000 (63.7700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 1, internal_epoch   1,  Average loss: 0.0099, Accuracy: 5016/5805 (86.4083%), train_poison_data_count: 5805
Global model norm: 13.943811740849695.
Norm before scaling: 13.633311684986888. Distance: 2.613127152214633
Total norm for 5 adversaries is: 13.633311684986888. distance: 2.613127152214633
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 2.3587, Accuracy: 4847/8991 (53.9095%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 2, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3647/4779 (76.3130%), train_poison_data_count: 4779
Global model norm: 13.943811740849695.
Norm before scaling: 13.887584031586451. Distance: 2.7911346175266285
Total norm for 5 adversaries is: 13.887584031586451. distance: 2.7911346175266285
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.5961, Accuracy: 7046/8991 (78.3673%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 3, internal_epoch   1,  Average loss: 0.0136, Accuracy: 4037/5123 (78.8015%), train_poison_data_count: 5123
Global model norm: 13.943811740849695.
Norm before scaling: 13.813193187321803. Distance: 2.721875465997422
Total norm for 5 adversaries is: 13.813193187321803. distance: 2.721875465997422
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.9254, Accuracy: 7311/8991 (81.3146%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 4, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3367/4462 (75.4594%), train_poison_data_count: 4462
Global model norm: 13.943811740849695.
Norm before scaling: 13.887840584081717. Distance: 2.6586349551370367
Total norm for 5 adversaries is: 13.887840584081717. distance: 2.6586349551370367
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 1.2221, Accuracy: 6386/8991 (71.0266%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 5, internal_epoch   1,  Average loss: 0.0134, Accuracy: 3147/3841 (81.9318%), train_poison_data_count: 3841
Global model norm: 13.943811740849695.
Norm before scaling: 13.897822125745716. Distance: 2.420746177203087
Total norm for 5 adversaries is: 13.897822125745716. distance: 2.420746177203087
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 2.2658, Accuracy: 5725/8991 (63.6748%)
___Train Local_Simple,  epoch   9, local model 6, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2102/2945 (71.3752%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.6275, Accuracy: 6010/10000 (60.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 7, internal_epoch   1,  Average loss: 0.0154, Accuracy: 2194/2756 (79.6081%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.6071, Accuracy: 4879/10000 (48.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 8, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2386/3437 (69.4210%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.9462, Accuracy: 6873/10000 (68.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 9, internal_epoch   1,  Average loss: 0.0107, Accuracy: 4820/5809 (82.9747%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.2351, Accuracy: 4613/10000 (46.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 10, internal_epoch   1,  Average loss: 0.0141, Accuracy: 2108/2592 (81.3272%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.4924, Accuracy: 3740/10000 (37.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 11, internal_epoch   1,  Average loss: 0.0217, Accuracy: 1768/2510 (70.4382%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.0610, Accuracy: 6574/10000 (65.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 12, internal_epoch   1,  Average loss: 0.0093, Accuracy: 3779/4373 (86.4166%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.5836, Accuracy: 3588/10000 (35.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3568/4339 (82.2309%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.9269, Accuracy: 5289/10000 (52.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 14, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2026/2782 (72.8253%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 3.3517, Accuracy: 4632/10000 (46.3200%), Attack Success Rate:0/10000(0.000)
time spent on training: 278.4442870616913
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.11018974 0.11018974 0.         0.80213278
 0.33182273 0.         0.         0.67906027 1.         0.42859459
 0.88221966 1.         0.77069669]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 2.1421, Accuracy: 3454/10000 (34.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 2.1282, Accuracy: 3459/8991 (38.4718%)
Done in 317.3126702308655 sec.
Server Epoch:10 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  10, local model 0, internal_epoch   1,  Average loss: 0.0200, Accuracy: 2058/3010 (68.3721%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.5178, Accuracy: 6557/10000 (65.5700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 1, internal_epoch   1,  Average loss: 0.0093, Accuracy: 5055/5805 (87.0801%), train_poison_data_count: 5805
Global model norm: 13.95159500465191.
Norm before scaling: 13.630122070661466. Distance: 2.532284654685799
Total norm for 5 adversaries is: 13.630122070661466. distance: 2.532284654685799
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 2.3231, Accuracy: 4867/8991 (54.1319%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 2, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3791/4779 (79.3262%), train_poison_data_count: 4779
Global model norm: 13.95159500465191.
Norm before scaling: 13.883459862860981. Distance: 2.705271139041331
Total norm for 5 adversaries is: 13.883459862860981. distance: 2.705271139041331
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.4582, Accuracy: 7643/8991 (85.0072%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 3, internal_epoch   1,  Average loss: 0.0123, Accuracy: 4221/5123 (82.3931%), train_poison_data_count: 5123
Global model norm: 13.95159500465191.
Norm before scaling: 13.819947043288439. Distance: 2.6650048879610795
Total norm for 5 adversaries is: 13.819947043288439. distance: 2.6650048879610795
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.7315, Accuracy: 7149/8991 (79.5128%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 4, internal_epoch   1,  Average loss: 0.0138, Accuracy: 3487/4462 (78.1488%), train_poison_data_count: 4462
Global model norm: 13.95159500465191.
Norm before scaling: 13.886818191451269. Distance: 2.573435454376464
Total norm for 5 adversaries is: 13.886818191451269. distance: 2.573435454376464
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 1.0410, Accuracy: 6755/8991 (75.1307%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 5, internal_epoch   1,  Average loss: 0.0118, Accuracy: 3239/3841 (84.3270%), train_poison_data_count: 3841
Global model norm: 13.95159500465191.
Norm before scaling: 13.884767136068634. Distance: 2.274627374168063
Total norm for 5 adversaries is: 13.884767136068634. distance: 2.274627374168063
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 2.2097, Accuracy: 6208/8991 (69.0468%)
___Train Local_Simple,  epoch  10, local model 6, internal_epoch   1,  Average loss: 0.0179, Accuracy: 2140/2945 (72.6655%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.5600, Accuracy: 5596/10000 (55.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 7, internal_epoch   1,  Average loss: 0.0155, Accuracy: 2230/2756 (80.9144%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.1328, Accuracy: 4725/10000 (47.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 8, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2496/3437 (72.6215%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.6997, Accuracy: 7645/10000 (76.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 9, internal_epoch   1,  Average loss: 0.0105, Accuracy: 4871/5809 (83.8526%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 3.3052, Accuracy: 4061/10000 (40.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 10, internal_epoch   1,  Average loss: 0.0130, Accuracy: 2132/2592 (82.2531%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.5470, Accuracy: 3573/10000 (35.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0207, Accuracy: 1785/2510 (71.1155%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.8232, Accuracy: 7136/10000 (71.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0084, Accuracy: 3874/4373 (88.5891%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 3.6208, Accuracy: 3521/10000 (35.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0117, Accuracy: 3629/4339 (83.6368%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.4173, Accuracy: 5686/10000 (56.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0175, Accuracy: 1987/2782 (71.4234%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.8973, Accuracy: 5358/10000 (53.5800%), Attack Success Rate:0/10000(0.000)
time spent on training: 297.35497879981995
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.06655273 0.3106076
 0.09390112 0.         0.         0.74478673 1.         0.21547037
 1.         1.         0.41142335]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 2.1150, Accuracy: 3502/10000 (35.0200%), Attack Success Rate:2/10000(0.020)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 2.1011, Accuracy: 3507/8991 (39.0057%)
Done in 335.65318989753723 sec.
Server Epoch:11 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  11, local model 0, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2064/3010 (68.5714%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.3896, Accuracy: 7056/10000 (70.5600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 1, internal_epoch   1,  Average loss: 0.0089, Accuracy: 5092/5805 (87.7175%), train_poison_data_count: 5805
Global model norm: 13.957623242587946.
Norm before scaling: 13.614235081361933. Distance: 2.434600181105637
Total norm for 5 adversaries is: 13.614235081361933. distance: 2.434600181105637
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 2.2562, Accuracy: 4817/8991 (53.5758%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 2, internal_epoch   1,  Average loss: 0.0135, Accuracy: 3822/4779 (79.9749%), train_poison_data_count: 4779
Global model norm: 13.957623242587946.
Norm before scaling: 13.89980593758557. Distance: 2.7256709611425087
Total norm for 5 adversaries is: 13.89980593758557. distance: 2.7256709611425087
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.3945, Accuracy: 7932/8991 (88.2216%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 3, internal_epoch   1,  Average loss: 0.0123, Accuracy: 4196/5123 (81.9051%), train_poison_data_count: 5123
Global model norm: 13.957623242587946.
Norm before scaling: 13.845523901409155. Distance: 2.7091060025304987
Total norm for 5 adversaries is: 13.845523901409155. distance: 2.7091060025304987
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.9360, Accuracy: 6997/8991 (77.8223%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 4, internal_epoch   1,  Average loss: 0.0135, Accuracy: 3513/4462 (78.7315%), train_poison_data_count: 4462
Global model norm: 13.957623242587946.
Norm before scaling: 13.90094702259526. Distance: 2.5659301873668405
Total norm for 5 adversaries is: 13.90094702259526. distance: 2.5659301873668405
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 1.0880, Accuracy: 6678/8991 (74.2743%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 5, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3211/3841 (83.5980%), train_poison_data_count: 3841
Global model norm: 13.957623242587946.
Norm before scaling: 13.917806491125463. Distance: 2.3621500634079338
Total norm for 5 adversaries is: 13.917806491125463. distance: 2.3621500634079338
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 2.0832, Accuracy: 6319/8991 (70.2814%)
___Train Local_Simple,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2202/2945 (74.7708%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.7691, Accuracy: 5549/10000 (55.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 7, internal_epoch   1,  Average loss: 0.0150, Accuracy: 2268/2756 (82.2932%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.2333, Accuracy: 4881/10000 (48.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 8, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2488/3437 (72.3887%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.8166, Accuracy: 7241/10000 (72.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 9, internal_epoch   1,  Average loss: 0.0095, Accuracy: 4935/5809 (84.9544%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.4249, Accuracy: 5007/10000 (50.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 10, internal_epoch   1,  Average loss: 0.0128, Accuracy: 2108/2592 (81.3272%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.2146, Accuracy: 4161/10000 (41.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0193, Accuracy: 1833/2510 (73.0279%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.9912, Accuracy: 6940/10000 (69.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 12, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3909/4373 (89.3894%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.8358, Accuracy: 3594/10000 (35.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 13, internal_epoch   1,  Average loss: 0.0109, Accuracy: 3670/4339 (84.5817%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.8838, Accuracy: 5668/10000 (56.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0164, Accuracy: 2063/2782 (74.1553%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.1999, Accuracy: 5661/10000 (56.6100%), Attack Success Rate:0/10000(0.000)
time spent on training: 302.15914607048035
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.14607618 0.70926301
 0.13934818 0.         0.         0.35182188 1.         0.08667144
 1.         1.         0.43831262]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 2.0864, Accuracy: 3600/10000 (36.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 2.0722, Accuracy: 3607/8991 (40.1179%)
Done in 340.67605996131897 sec.
Server Epoch:12 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  12, local model 0, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2157/3010 (71.6611%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.5976, Accuracy: 6818/10000 (68.1800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   1,  Average loss: 0.0085, Accuracy: 5105/5805 (87.9414%), train_poison_data_count: 5805
Global model norm: 13.963807326050532.
Norm before scaling: 13.626384139842914. Distance: 2.4313514629462456
Total norm for 5 adversaries is: 13.626384139842914. distance: 2.4313514629462456
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 2.1822, Accuracy: 5101/8991 (56.7345%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0127, Accuracy: 3874/4779 (81.0630%), train_poison_data_count: 4779
Global model norm: 13.963807326050532.
Norm before scaling: 13.88851023518125. Distance: 2.628796057921163
Total norm for 5 adversaries is: 13.88851023518125. distance: 2.628796057921163
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.4700, Accuracy: 7630/8991 (84.8626%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 3, internal_epoch   1,  Average loss: 0.0119, Accuracy: 4238/5123 (82.7250%), train_poison_data_count: 5123
Global model norm: 13.963807326050532.
Norm before scaling: 13.829802709842395. Distance: 2.6165774417251484
Total norm for 5 adversaries is: 13.829802709842395. distance: 2.6165774417251484
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.9746, Accuracy: 6864/8991 (76.3430%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3511/4462 (78.6867%), train_poison_data_count: 4462
Global model norm: 13.963807326050532.
Norm before scaling: 13.910612575005965. Distance: 2.5636499197335247
Total norm for 5 adversaries is: 13.910612575005965. distance: 2.5636499197335247
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.1029, Accuracy: 6792/8991 (75.5422%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 5, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3227/3841 (84.0146%), train_poison_data_count: 3841
Global model norm: 13.963807326050532.
Norm before scaling: 13.913340340432665. Distance: 2.2905992160402415
Total norm for 5 adversaries is: 13.913340340432665. distance: 2.2905992160402415
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 2.2612, Accuracy: 6357/8991 (70.7040%)
___Train Local_Simple,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2226/2945 (75.5857%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.4637, Accuracy: 6235/10000 (62.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 7, internal_epoch   1,  Average loss: 0.0136, Accuracy: 2307/2756 (83.7083%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.1246, Accuracy: 4900/10000 (49.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 8, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2573/3437 (74.8618%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7637, Accuracy: 7101/10000 (71.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 9, internal_epoch   1,  Average loss: 0.0094, Accuracy: 5013/5809 (86.2971%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.9700, Accuracy: 4692/10000 (46.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 10, internal_epoch   1,  Average loss: 0.0127, Accuracy: 2115/2592 (81.5972%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.1302, Accuracy: 4383/10000 (43.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0193, Accuracy: 1854/2510 (73.8645%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.8321, Accuracy: 6948/10000 (69.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 12, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3903/4373 (89.2522%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 3.0599, Accuracy: 3941/10000 (39.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 13, internal_epoch   1,  Average loss: 0.0106, Accuracy: 3700/4339 (85.2731%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.7857, Accuracy: 5546/10000 (55.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 14, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2115/2782 (76.0244%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 2.3143, Accuracy: 5418/10000 (54.1800%), Attack Success Rate:0/10000(0.000)
time spent on training: 311.84108686447144
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.11759638 0.45852736
 0.28115409 0.         0.         0.3737868  1.         0.26569821
 1.         1.         0.61134461]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 2.0543, Accuracy: 3666/10000 (36.6600%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 2.0397, Accuracy: 3674/8991 (40.8631%)
Done in 353.5071828365326 sec.
Server Epoch:13 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  13, local model 0, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2169/3010 (72.0598%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.2969, Accuracy: 6746/10000 (67.4600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 1, internal_epoch   1,  Average loss: 0.0084, Accuracy: 5113/5805 (88.0792%), train_poison_data_count: 5805
Global model norm: 13.9705003840752.
Norm before scaling: 13.63887591252397. Distance: 2.4490369032621864
Total norm for 5 adversaries is: 13.63887591252397. distance: 2.4490369032621864
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 2.2890, Accuracy: 4828/8991 (53.6981%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 2, internal_epoch   1,  Average loss: 0.0122, Accuracy: 3939/4779 (82.4231%), train_poison_data_count: 4779
Global model norm: 13.9705003840752.
Norm before scaling: 13.908876046817808. Distance: 2.647391863983879
Total norm for 5 adversaries is: 13.908876046817808. distance: 2.647391863983879
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.5173, Accuracy: 7427/8991 (82.6048%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 3, internal_epoch   1,  Average loss: 0.0117, Accuracy: 4299/5123 (83.9157%), train_poison_data_count: 5123
Global model norm: 13.9705003840752.
Norm before scaling: 13.863482669711765. Distance: 2.677098661346688
Total norm for 5 adversaries is: 13.863482669711765. distance: 2.677098661346688
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.8562, Accuracy: 7173/8991 (79.7798%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0123, Accuracy: 3588/4462 (80.4124%), train_poison_data_count: 4462
Global model norm: 13.9705003840752.
Norm before scaling: 13.887106073184961. Distance: 2.4188701077391515
Total norm for 5 adversaries is: 13.887106073184961. distance: 2.4188701077391515
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.0847, Accuracy: 6678/8991 (74.2743%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 5, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3316/3841 (86.3317%), train_poison_data_count: 3841
Global model norm: 13.9705003840752.
Norm before scaling: 13.913106740932102. Distance: 2.2425623989035564
Total norm for 5 adversaries is: 13.913106740932102. distance: 2.2425623989035564
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 2.2041, Accuracy: 5804/8991 (64.5534%)
___Train Local_Simple,  epoch  13, local model 6, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2237/2945 (75.9593%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.5808, Accuracy: 6170/10000 (61.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0133, Accuracy: 2300/2756 (83.4543%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.0480, Accuracy: 5162/10000 (51.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 8, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2564/3437 (74.5999%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.8331, Accuracy: 7139/10000 (71.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 9, internal_epoch   1,  Average loss: 0.0091, Accuracy: 5062/5809 (87.1406%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.6158, Accuracy: 4579/10000 (45.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0114, Accuracy: 2168/2592 (83.6420%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.8947, Accuracy: 5616/10000 (56.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0183, Accuracy: 1877/2510 (74.7809%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.8575, Accuracy: 6863/10000 (68.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 12, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3916/4373 (89.5495%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 3.0211, Accuracy: 3649/10000 (36.4900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  13, local model 13, internal_epoch   1,  Average loss: 0.0105, Accuracy: 3736/4339 (86.1028%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.6886, Accuracy: 5795/10000 (57.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0143, Accuracy: 2172/2782 (78.0733%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.3464, Accuracy: 6018/10000 (60.1800%), Attack Success Rate:0/10000(0.000)
time spent on training: 295.593453168869
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.0433545  1.
 0.14921976 0.         0.         0.76457262 1.         0.09206632
 1.         1.         0.28587145]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 2.0188, Accuracy: 3780/10000 (37.8000%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 2.0036, Accuracy: 3792/8991 (42.1755%)
Done in 325.60608100891113 sec.
Server Epoch:14 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  14, local model 0, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2197/3010 (72.9900%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.2946, Accuracy: 7036/10000 (70.3600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 1, internal_epoch   1,  Average loss: 0.0082, Accuracy: 5183/5805 (89.2851%), train_poison_data_count: 5805
Global model norm: 13.977722426889299.
Norm before scaling: 13.649147403904598. Distance: 2.4151239623168275
Total norm for 5 adversaries is: 13.649147403904598. distance: 2.4151239623168275
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 2.3693, Accuracy: 4938/8991 (54.9216%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3946/4779 (82.5696%), train_poison_data_count: 4779
Global model norm: 13.977722426889299.
Norm before scaling: 13.904974923987412. Distance: 2.5924277554693558
Total norm for 5 adversaries is: 13.904974923987412. distance: 2.5924277554693558
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.5643, Accuracy: 7408/8991 (82.3935%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 3, internal_epoch   1,  Average loss: 0.0111, Accuracy: 4310/5123 (84.1304%), train_poison_data_count: 5123
Global model norm: 13.977722426889299.
Norm before scaling: 13.841177191090223. Distance: 2.559435151339997
Total norm for 5 adversaries is: 13.841177191090223. distance: 2.559435151339997
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.7709, Accuracy: 7146/8991 (79.4795%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3621/4462 (81.1519%), train_poison_data_count: 4462
Global model norm: 13.977722426889299.
Norm before scaling: 13.912676819862716. Distance: 2.452825540135412
Total norm for 5 adversaries is: 13.912676819862716. distance: 2.452825540135412
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.2020, Accuracy: 6685/8991 (74.3521%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 5, internal_epoch   1,  Average loss: 0.0101, Accuracy: 3347/3841 (87.1388%), train_poison_data_count: 3841
Global model norm: 13.977722426889299.
Norm before scaling: 13.92151878577673. Distance: 2.201444702029222
Total norm for 5 adversaries is: 13.92151878577673. distance: 2.201444702029222
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 2.1163, Accuracy: 6414/8991 (71.3380%)
___Train Local_Simple,  epoch  14, local model 6, internal_epoch   1,  Average loss: 0.0147, Accuracy: 2281/2945 (77.4533%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.5776, Accuracy: 5405/10000 (54.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0126, Accuracy: 2305/2756 (83.6357%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.2837, Accuracy: 5107/10000 (51.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 8, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2592/3437 (75.4146%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.7078, Accuracy: 7561/10000 (75.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 9, internal_epoch   1,  Average loss: 0.0087, Accuracy: 5039/5809 (86.7447%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 3.1838, Accuracy: 4618/10000 (46.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0107, Accuracy: 2181/2592 (84.1435%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.8827, Accuracy: 5232/10000 (52.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 11, internal_epoch   1,  Average loss: 0.0170, Accuracy: 1939/2510 (77.2510%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.5874, Accuracy: 8049/10000 (80.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3930/4373 (89.8697%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 3.0271, Accuracy: 3666/10000 (36.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 13, internal_epoch   1,  Average loss: 0.0097, Accuracy: 3753/4339 (86.4946%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.7368, Accuracy: 5743/10000 (57.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 14, internal_epoch   1,  Average loss: 0.0141, Accuracy: 2188/2782 (78.6485%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.4693, Accuracy: 5149/10000 (51.4900%), Attack Success Rate:0/10000(0.000)
time spent on training: 241.73172211647034
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.02218881 1.
 0.35712025 0.         0.         0.81859825 1.         0.73126498
 1.         1.         0.35712025]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.9734, Accuracy: 3901/10000 (39.0100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 1.9568, Accuracy: 3920/8991 (43.5992%)
Done in 270.97282814979553 sec.
Server Epoch:15 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2227/3010 (73.9867%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.4412, Accuracy: 6634/10000 (66.3400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0076, Accuracy: 5241/5805 (90.2842%), train_poison_data_count: 5805
Global model norm: 13.986820011468051.
Norm before scaling: 13.644825361845912. Distance: 2.3462030416432347
Total norm for 5 adversaries is: 13.644825361845912. distance: 2.3462030416432347
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 2.4402, Accuracy: 4958/8991 (55.1440%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 2, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3964/4779 (82.9462%), train_poison_data_count: 4779
Global model norm: 13.986820011468051.
Norm before scaling: 13.901085329564873. Distance: 2.5123977336662575
Total norm for 5 adversaries is: 13.901085329564873. distance: 2.5123977336662575
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.4010, Accuracy: 7878/8991 (87.6210%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 3, internal_epoch   1,  Average loss: 0.0105, Accuracy: 4375/5123 (85.3992%), train_poison_data_count: 5123
Global model norm: 13.986820011468051.
Norm before scaling: 13.847470026956582. Distance: 2.5187264983261604
Total norm for 5 adversaries is: 13.847470026956582. distance: 2.5187264983261604
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.6094, Accuracy: 7349/8991 (81.7373%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3608/4462 (80.8606%), train_poison_data_count: 4462
Global model norm: 13.986820011468051.
Norm before scaling: 13.93584565749252. Distance: 2.4839011646148386
Total norm for 5 adversaries is: 13.93584565749252. distance: 2.4839011646148386
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.1197, Accuracy: 6777/8991 (75.3754%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 5, internal_epoch   1,  Average loss: 0.0099, Accuracy: 3323/3841 (86.5139%), train_poison_data_count: 3841
Global model norm: 13.986820011468051.
Norm before scaling: 13.927869540125576. Distance: 2.152851910152182
Total norm for 5 adversaries is: 13.927869540125576. distance: 2.152851910152182
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 2.2096, Accuracy: 6182/8991 (68.7576%)
___Train Local_Simple,  epoch  15, local model 6, internal_epoch   1,  Average loss: 0.0143, Accuracy: 2326/2945 (78.9813%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.4028, Accuracy: 5956/10000 (59.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 7, internal_epoch   1,  Average loss: 0.0121, Accuracy: 2332/2756 (84.6154%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.0843, Accuracy: 4228/10000 (42.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 8, internal_epoch   1,  Average loss: 0.0150, Accuracy: 2628/3437 (76.4620%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.7593, Accuracy: 7375/10000 (73.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 9, internal_epoch   1,  Average loss: 0.0083, Accuracy: 5088/5809 (87.5882%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.5926, Accuracy: 4875/10000 (48.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 10, internal_epoch   1,  Average loss: 0.0102, Accuracy: 2201/2592 (84.9151%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.1119, Accuracy: 4553/10000 (45.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 11, internal_epoch   1,  Average loss: 0.0166, Accuracy: 1932/2510 (76.9721%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8990, Accuracy: 6704/10000 (67.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3984/4373 (91.1045%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 3.1044, Accuracy: 3539/10000 (35.3900%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0094, Accuracy: 3764/4339 (86.7481%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.9050, Accuracy: 5276/10000 (52.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0140, Accuracy: 2138/2782 (76.8512%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 2.5467, Accuracy: 5739/10000 (57.3900%), Attack Success Rate:0/10000(0.000)
time spent on training: 247.16094207763672
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.00629571 0.71626597
 0.         0.         0.         0.88014919 1.         0.
 1.         1.         0.60093311]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 1.9352, Accuracy: 4031/10000 (40.3100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 1.9190, Accuracy: 4044/8991 (44.9783%)
Done in 276.1366310119629 sec.
Server Epoch:16 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  16, local model 0, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2246/3010 (74.6179%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0976, Accuracy: 6777/10000 (67.7700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 1, internal_epoch   1,  Average loss: 0.0076, Accuracy: 5223/5805 (89.9742%), train_poison_data_count: 5805
Global model norm: 13.994135582038519.
Norm before scaling: 13.658342074627472. Distance: 2.3654192372663636
Total norm for 5 adversaries is: 13.658342074627472. distance: 2.3654192372663636
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 2.1921, Accuracy: 4967/8991 (55.2441%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 2, internal_epoch   1,  Average loss: 0.0106, Accuracy: 4014/4779 (83.9925%), train_poison_data_count: 4779
Global model norm: 13.994135582038519.
Norm before scaling: 13.908466291087327. Distance: 2.4841483150684307
Total norm for 5 adversaries is: 13.908466291087327. distance: 2.4841483150684307
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.4354, Accuracy: 7682/8991 (85.4410%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 3, internal_epoch   1,  Average loss: 0.0102, Accuracy: 4379/5123 (85.4773%), train_poison_data_count: 5123
Global model norm: 13.994135582038519.
Norm before scaling: 13.86017703517127. Distance: 2.5117059354321727
Total norm for 5 adversaries is: 13.86017703517127. distance: 2.5117059354321727
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.6438, Accuracy: 7270/8991 (80.8586%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3699/4462 (82.9000%), train_poison_data_count: 4462
Global model norm: 13.994135582038519.
Norm before scaling: 13.914757755650562. Distance: 2.3369699703404296
Total norm for 5 adversaries is: 13.914757755650562. distance: 2.3369699703404296
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.0485, Accuracy: 6922/8991 (76.9881%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 5, internal_epoch   1,  Average loss: 0.0098, Accuracy: 3323/3841 (86.5139%), train_poison_data_count: 3841
Global model norm: 13.994135582038519.
Norm before scaling: 13.933732280464982. Distance: 2.130361413157727
Total norm for 5 adversaries is: 13.933732280464982. distance: 2.130361413157727
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 2.2197, Accuracy: 5783/8991 (64.3199%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0136, Accuracy: 2346/2945 (79.6604%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.4424, Accuracy: 6535/10000 (65.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 7, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2358/2756 (85.5588%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.0017, Accuracy: 4695/10000 (46.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0146, Accuracy: 2646/3437 (76.9857%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8452, Accuracy: 7213/10000 (72.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 9, internal_epoch   1,  Average loss: 0.0082, Accuracy: 5133/5809 (88.3629%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.7746, Accuracy: 4669/10000 (46.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 10, internal_epoch   1,  Average loss: 0.0100, Accuracy: 2193/2592 (84.6065%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.9032, Accuracy: 5053/10000 (50.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0161, Accuracy: 1976/2510 (78.7251%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8603, Accuracy: 7133/10000 (71.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4006/4373 (91.6076%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.7360, Accuracy: 3595/10000 (35.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0090, Accuracy: 3795/4339 (87.4625%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.6641, Accuracy: 6188/10000 (61.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 14, internal_epoch   1,  Average loss: 0.0133, Accuracy: 2191/2782 (78.7563%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 2.2455, Accuracy: 6186/10000 (61.8600%), Attack Success Rate:0/10000(0.000)
time spent on training: 254.45470190048218
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.02795811 0.61400379
 0.14022818 0.         0.         0.26957432 1.         0.2150812
 0.67009154 1.         0.15051437]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 1.9030, Accuracy: 4130/10000 (41.3000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 1.8870, Accuracy: 4140/8991 (46.0460%)
Done in 283.43266677856445 sec.
Server Epoch:17 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  17, local model 0, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2251/3010 (74.7841%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.3206, Accuracy: 6876/10000 (68.7600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 1, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5203/5805 (89.6296%), train_poison_data_count: 5805
Global model norm: 13.99970899006978.
Norm before scaling: 13.661486566620813. Distance: 2.3170822726720988
Total norm for 5 adversaries is: 13.661486566620813. distance: 2.3170822726720988
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 2.2556, Accuracy: 4917/8991 (54.6880%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0103, Accuracy: 4057/4779 (84.8922%), train_poison_data_count: 4779
Global model norm: 13.99970899006978.
Norm before scaling: 13.8980153594899. Distance: 2.4069874611858
Total norm for 5 adversaries is: 13.8980153594899. distance: 2.4069874611858
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.4166, Accuracy: 7785/8991 (86.5866%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 3, internal_epoch   1,  Average loss: 0.0100, Accuracy: 4360/5123 (85.1064%), train_poison_data_count: 5123
Global model norm: 13.99970899006978.
Norm before scaling: 13.857415130592086. Distance: 2.4687345480133516
Total norm for 5 adversaries is: 13.857415130592086. distance: 2.4687345480133516
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.8044, Accuracy: 7213/8991 (80.2247%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3726/4462 (83.5052%), train_poison_data_count: 4462
Global model norm: 13.99970899006978.
Norm before scaling: 13.927414328332695. Distance: 2.3512866089651383
Total norm for 5 adversaries is: 13.927414328332695. distance: 2.3512866089651383
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.0485, Accuracy: 6958/8991 (77.3885%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 5, internal_epoch   1,  Average loss: 0.0091, Accuracy: 3370/3841 (87.7376%), train_poison_data_count: 3841
Global model norm: 13.99970899006978.
Norm before scaling: 13.930528205666402. Distance: 2.0703025961585046
Total norm for 5 adversaries is: 13.930528205666402. distance: 2.0703025961585046
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 2.0714, Accuracy: 5931/8991 (65.9660%)
___Train Local_Simple,  epoch  17, local model 6, internal_epoch   1,  Average loss: 0.0132, Accuracy: 2368/2945 (80.4075%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.3241, Accuracy: 6175/10000 (61.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 7, internal_epoch   1,  Average loss: 0.0117, Accuracy: 2379/2756 (86.3208%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.0592, Accuracy: 5126/10000 (51.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 8, internal_epoch   1,  Average loss: 0.0140, Accuracy: 2695/3437 (78.4114%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.5705, Accuracy: 8105/10000 (81.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 9, internal_epoch   1,  Average loss: 0.0077, Accuracy: 5160/5809 (88.8277%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.6416, Accuracy: 4992/10000 (49.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2199/2592 (84.8380%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.7602, Accuracy: 5654/10000 (56.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 11, internal_epoch   1,  Average loss: 0.0159, Accuracy: 1953/2510 (77.8088%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.5988, Accuracy: 8077/10000 (80.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 12, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3989/4373 (91.2188%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 3.0877, Accuracy: 3567/10000 (35.6700%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0088, Accuracy: 3807/4339 (87.7391%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.2629, Accuracy: 5366/10000 (53.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 14, internal_epoch   1,  Average loss: 0.0125, Accuracy: 2211/2782 (79.4752%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 2.1104, Accuracy: 5591/10000 (55.9100%), Attack Success Rate:0/10000(0.000)
time spent on training: 258.30628299713135
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.0964424  0.95322388
 0.26721179 0.         0.         0.37467998 0.96814015 0.25281139
 1.         1.         0.61783824]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 1.8592, Accuracy: 4265/10000 (42.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 1.8421, Accuracy: 4278/8991 (47.5809%)
Done in 287.09843587875366 sec.
Server Epoch:18 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  18, local model 0, internal_epoch   1,  Average loss: 0.0149, Accuracy: 2296/3010 (76.2791%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.2650, Accuracy: 7003/10000 (70.0300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 1, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5259/5805 (90.5943%), train_poison_data_count: 5805
Global model norm: 14.007815223263817.
Norm before scaling: 13.661143667844085. Distance: 2.2635377938005856
Total norm for 5 adversaries is: 13.661143667844085. distance: 2.2635377938005856
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 2.2279, Accuracy: 5004/8991 (55.6557%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 2, internal_epoch   1,  Average loss: 0.0103, Accuracy: 4051/4779 (84.7667%), train_poison_data_count: 4779
Global model norm: 14.007815223263817.
Norm before scaling: 13.918431944825336. Distance: 2.4381075370923977
Total norm for 5 adversaries is: 13.918431944825336. distance: 2.4381075370923977
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.3787, Accuracy: 7895/8991 (87.8100%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 3, internal_epoch   1,  Average loss: 0.0096, Accuracy: 4415/5123 (86.1800%), train_poison_data_count: 5123
Global model norm: 14.007815223263817.
Norm before scaling: 13.876465316241436. Distance: 2.4752016389956037
Total norm for 5 adversaries is: 13.876465316241436. distance: 2.4752016389956037
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.7864, Accuracy: 7328/8991 (81.5037%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0107, Accuracy: 3740/4462 (83.8189%), train_poison_data_count: 4462
Global model norm: 14.007815223263817.
Norm before scaling: 13.935130649223835. Distance: 2.3330360177763434
Total norm for 5 adversaries is: 13.935130649223835. distance: 2.3330360177763434
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 1.0186, Accuracy: 6888/8991 (76.6099%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 5, internal_epoch   1,  Average loss: 0.0088, Accuracy: 3363/3841 (87.5553%), train_poison_data_count: 3841
Global model norm: 14.007815223263817.
Norm before scaling: 13.947523677988393. Distance: 2.066578848829082
Total norm for 5 adversaries is: 13.947523677988393. distance: 2.066578848829082
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 2.0910, Accuracy: 6378/8991 (70.9376%)
___Train Local_Simple,  epoch  18, local model 6, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2382/2945 (80.8829%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.3481, Accuracy: 5757/10000 (57.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0112, Accuracy: 2372/2756 (86.0668%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.5903, Accuracy: 5272/10000 (52.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 8, internal_epoch   1,  Average loss: 0.0140, Accuracy: 2678/3437 (77.9168%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9271, Accuracy: 6920/10000 (69.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 9, internal_epoch   1,  Average loss: 0.0074, Accuracy: 5216/5809 (89.7917%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 2.4315, Accuracy: 5200/10000 (52.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 10, internal_epoch   1,  Average loss: 0.0093, Accuracy: 2211/2592 (85.3009%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.7253, Accuracy: 5851/10000 (58.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 11, internal_epoch   1,  Average loss: 0.0150, Accuracy: 2002/2510 (79.7610%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7289, Accuracy: 7269/10000 (72.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3999/4373 (91.4475%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 3.0764, Accuracy: 3732/10000 (37.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 13, internal_epoch   1,  Average loss: 0.0084, Accuracy: 3805/4339 (87.6930%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.6070, Accuracy: 5999/10000 (59.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0122, Accuracy: 2232/2782 (80.2301%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.8043, Accuracy: 6118/10000 (61.1800%), Attack Success Rate:0/10000(0.000)
time spent on training: 264.0083179473877
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.16950126 0.8242765
 0.16073822 0.         0.         0.57718751 1.         0.15936968
 1.         1.         0.35947922]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 1.8189, Accuracy: 4330/10000 (43.3000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 1.8009, Accuracy: 4343/8991 (48.3039%)
Done in 292.777930021286 sec.
Server Epoch:19 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  19, local model 0, internal_epoch   1,  Average loss: 0.0144, Accuracy: 2290/3010 (76.0797%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.1632, Accuracy: 7105/10000 (71.0500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 1, internal_epoch   1,  Average loss: 0.0069, Accuracy: 5253/5805 (90.4910%), train_poison_data_count: 5805
Global model norm: 14.01553409338551.
Norm before scaling: 13.680026030041653. Distance: 2.303807598186726
Total norm for 5 adversaries is: 13.680026030041653. distance: 2.303807598186726
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 2.3122, Accuracy: 5060/8991 (56.2785%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 2, internal_epoch   1,  Average loss: 0.0097, Accuracy: 4098/4779 (85.7502%), train_poison_data_count: 4779
Global model norm: 14.01553409338551.
Norm before scaling: 13.922887694649143. Distance: 2.386735132538906
Total norm for 5 adversaries is: 13.922887694649143. distance: 2.386735132538906
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.4518, Accuracy: 7672/8991 (85.3298%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0092, Accuracy: 4474/5123 (87.3316%), train_poison_data_count: 5123
Global model norm: 14.01553409338551.
Norm before scaling: 13.841233965598216. Distance: 2.318973758728342
Total norm for 5 adversaries is: 13.841233965598216. distance: 2.318973758728342
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.6458, Accuracy: 7238/8991 (80.5027%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0105, Accuracy: 3788/4462 (84.8947%), train_poison_data_count: 4462
Global model norm: 14.01553409338551.
Norm before scaling: 13.933129964071359. Distance: 2.2748855226659983
Total norm for 5 adversaries is: 13.933129964071359. distance: 2.2748855226659983
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.0014, Accuracy: 6852/8991 (76.2095%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 5, internal_epoch   1,  Average loss: 0.0084, Accuracy: 3403/3841 (88.5967%), train_poison_data_count: 3841
Global model norm: 14.01553409338551.
Norm before scaling: 13.94095640560323. Distance: 2.003515848720194
Total norm for 5 adversaries is: 13.94095640560323. distance: 2.003515848720194
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.9269, Accuracy: 6464/8991 (71.8941%)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0122, Accuracy: 2400/2945 (81.4941%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.4296, Accuracy: 5727/10000 (57.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 7, internal_epoch   1,  Average loss: 0.0109, Accuracy: 2407/2756 (87.3367%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.7950, Accuracy: 5254/10000 (52.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0136, Accuracy: 2723/3437 (79.2261%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8715, Accuracy: 6863/10000 (68.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 9, internal_epoch   1,  Average loss: 0.0073, Accuracy: 5212/5809 (89.7228%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.7545, Accuracy: 4897/10000 (48.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 10, internal_epoch   1,  Average loss: 0.0091, Accuracy: 2216/2592 (85.4938%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.7463, Accuracy: 5826/10000 (58.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 11, internal_epoch   1,  Average loss: 0.0140, Accuracy: 2044/2510 (81.4343%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8336, Accuracy: 7055/10000 (70.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3979/4373 (90.9902%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 3.0205, Accuracy: 3750/10000 (37.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 13, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3875/4339 (89.3063%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.9053, Accuracy: 5600/10000 (56.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 14, internal_epoch   1,  Average loss: 0.0113, Accuracy: 2279/2782 (81.9195%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 2.3464, Accuracy: 5590/10000 (55.9000%), Attack Success Rate:0/10000(0.000)
time spent on training: 268.79449701309204
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.         1.
 0.21979657 0.         0.         0.         1.         1.
 1.         1.         0.82079626]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 1.7664, Accuracy: 4583/10000 (45.8300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 1.7471, Accuracy: 4596/8991 (51.1178%)
Done in 297.5467600822449 sec.
Server Epoch:20 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  20, local model 0, internal_epoch   1,  Average loss: 0.0138, Accuracy: 2360/3010 (78.4053%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.2508, Accuracy: 6857/10000 (68.5700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 1, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5313/5805 (91.5245%), train_poison_data_count: 5805
Global model norm: 14.024606062036556.
Norm before scaling: 13.666819936001422. Distance: 2.1917538290737673
Total norm for 5 adversaries is: 13.666819936001422. distance: 2.1917538290737673
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 2.0579, Accuracy: 5113/8991 (56.8680%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 2, internal_epoch   1,  Average loss: 0.0097, Accuracy: 4112/4779 (86.0431%), train_poison_data_count: 4779
Global model norm: 14.024606062036556.
Norm before scaling: 13.931116395620284. Distance: 2.3849756646664186
Total norm for 5 adversaries is: 13.931116395620284. distance: 2.3849756646664186
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.6412, Accuracy: 7095/8991 (78.9122%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 3, internal_epoch   1,  Average loss: 0.0091, Accuracy: 4476/5123 (87.3707%), train_poison_data_count: 5123
Global model norm: 14.024606062036556.
Norm before scaling: 13.855740764175096. Distance: 2.321144134786098
Total norm for 5 adversaries is: 13.855740764175096. distance: 2.321144134786098
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.5300, Accuracy: 7376/8991 (82.0376%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 4, internal_epoch   1,  Average loss: 0.0098, Accuracy: 3772/4462 (84.5361%), train_poison_data_count: 4462
Global model norm: 14.024606062036556.
Norm before scaling: 13.953845647333546. Distance: 2.2848226711321136
Total norm for 5 adversaries is: 13.953845647333546. distance: 2.2848226711321136
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.9199, Accuracy: 7130/8991 (79.3015%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 5, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3411/3841 (88.8050%), train_poison_data_count: 3841
Global model norm: 14.024606062036556.
Norm before scaling: 13.947609557839282. Distance: 1.9622403258533418
Total norm for 5 adversaries is: 13.947609557839282. distance: 1.9622403258533418
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 2.1449, Accuracy: 5795/8991 (64.4533%)
___Train Local_Simple,  epoch  20, local model 6, internal_epoch   1,  Average loss: 0.0117, Accuracy: 2451/2945 (83.2258%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.2271, Accuracy: 6149/10000 (61.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 7, internal_epoch   1,  Average loss: 0.0100, Accuracy: 2438/2756 (88.4615%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.5204, Accuracy: 5572/10000 (55.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0124, Accuracy: 2793/3437 (81.2627%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6879, Accuracy: 7702/10000 (77.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 5207/5809 (89.6368%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.3194, Accuracy: 5031/10000 (50.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 10, internal_epoch   1,  Average loss: 0.0086, Accuracy: 2239/2592 (86.3812%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.6994, Accuracy: 5555/10000 (55.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0136, Accuracy: 2038/2510 (81.1952%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.5881, Accuracy: 7880/10000 (78.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4063/4373 (92.9110%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.9024, Accuracy: 3654/10000 (36.5400%), Attack Success Rate:1/10000(0.010)
___Train Local_Simple,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3842/4339 (88.5457%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.6395, Accuracy: 5934/10000 (59.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 14, internal_epoch   1,  Average loss: 0.0112, Accuracy: 2284/2782 (82.0992%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 2.3674, Accuracy: 5852/10000 (58.5200%), Attack Success Rate:0/10000(0.000)
time spent on training: 272.75292801856995
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.36934663
 0.10837096 0.         0.         0.         1.         0.10837096
 1.         1.         0.60538777]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 1.7304, Accuracy: 4806/10000 (48.0600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 1.7122, Accuracy: 4813/8991 (53.5313%)
Done in 301.70086193084717 sec.
Server Epoch:21 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  21, local model 0, internal_epoch   1,  Average loss: 0.0135, Accuracy: 2375/3010 (78.9037%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.2136, Accuracy: 6622/10000 (66.2200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5316/5805 (91.5762%), train_poison_data_count: 5805
Global model norm: 14.030329956612077.
Norm before scaling: 13.670592015694504. Distance: 2.170320681947208
Total norm for 5 adversaries is: 13.670592015694504. distance: 2.170320681947208
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 1.9367, Accuracy: 5120/8991 (56.9458%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 2, internal_epoch   1,  Average loss: 0.0091, Accuracy: 4139/4779 (86.6081%), train_poison_data_count: 4779
Global model norm: 14.030329956612077.
Norm before scaling: 13.928630932132371. Distance: 2.325491523059592
Total norm for 5 adversaries is: 13.928630932132371. distance: 2.325491523059592
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.6653, Accuracy: 7069/8991 (78.6231%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 3, internal_epoch   1,  Average loss: 0.0092, Accuracy: 4484/5123 (87.5268%), train_poison_data_count: 5123
Global model norm: 14.030329956612077.
Norm before scaling: 13.867287081508646. Distance: 2.3308357995785904
Total norm for 5 adversaries is: 13.867287081508646. distance: 2.3308357995785904
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.7035, Accuracy: 7206/8991 (80.1468%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 4, internal_epoch   1,  Average loss: 0.0096, Accuracy: 3807/4462 (85.3205%), train_poison_data_count: 4462
Global model norm: 14.030329956612077.
Norm before scaling: 13.932652472937113. Distance: 2.177924752574054
Total norm for 5 adversaries is: 13.932652472937113. distance: 2.177924752574054
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.8762, Accuracy: 7122/8991 (79.2125%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 5, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3446/3841 (89.7162%), train_poison_data_count: 3841
Global model norm: 14.030329956612077.
Norm before scaling: 13.948923398931468. Distance: 1.9318500092888378
Total norm for 5 adversaries is: 13.948923398931468. distance: 1.9318500092888378
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 2.1802, Accuracy: 6196/8991 (68.9134%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2436/2945 (82.7165%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.4016, Accuracy: 6084/10000 (60.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 7, internal_epoch   1,  Average loss: 0.0098, Accuracy: 2423/2756 (87.9173%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.8078, Accuracy: 5159/10000 (51.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 8, internal_epoch   1,  Average loss: 0.0125, Accuracy: 2783/3437 (80.9718%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6658, Accuracy: 7770/10000 (77.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 9, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5259/5809 (90.5319%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.5785, Accuracy: 4984/10000 (49.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0080, Accuracy: 2273/2592 (87.6929%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.8098, Accuracy: 5696/10000 (56.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 11, internal_epoch   1,  Average loss: 0.0133, Accuracy: 2097/2510 (83.5458%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6669, Accuracy: 7651/10000 (76.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4036/4373 (92.2936%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 2.7739, Accuracy: 3769/10000 (37.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 13, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3894/4339 (89.7442%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.5162, Accuracy: 6059/10000 (60.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   1,  Average loss: 0.0108, Accuracy: 2295/2782 (82.4946%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.8203, Accuracy: 6228/10000 (62.2800%), Attack Success Rate:0/10000(0.000)
time spent on training: 279.86127495765686
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.51042602
 0.08699332 0.         0.         0.12999629 1.         0.
 0.85498376 1.         0.1556874 ]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 1.7018, Accuracy: 4919/10000 (49.1900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 1.6846, Accuracy: 4924/8991 (54.7659%)
Done in 312.35500502586365 sec.
Server Epoch:22 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  22, local model 0, internal_epoch   1,  Average loss: 0.0131, Accuracy: 2409/3010 (80.0332%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.1434, Accuracy: 7178/10000 (71.7800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 1, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5302/5805 (91.3351%), train_poison_data_count: 5805
Global model norm: 14.035400864136093.
Norm before scaling: 13.672561924707487. Distance: 2.143658347436612
Total norm for 5 adversaries is: 13.672561924707487. distance: 2.143658347436612
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.7045, Accuracy: 5414/8991 (60.2158%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 2, internal_epoch   1,  Average loss: 0.0095, Accuracy: 4068/4779 (85.1224%), train_poison_data_count: 4779
Global model norm: 14.035400864136093.
Norm before scaling: 13.933588274459256. Distance: 2.3397098560266363
Total norm for 5 adversaries is: 13.933588274459256. distance: 2.3397098560266363
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.3943, Accuracy: 7830/8991 (87.0871%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 3, internal_epoch   1,  Average loss: 0.0084, Accuracy: 4565/5123 (89.1079%), train_poison_data_count: 5123
Global model norm: 14.035400864136093.
Norm before scaling: 13.854260039433155. Distance: 2.2528411093810927
Total norm for 5 adversaries is: 13.854260039433155. distance: 2.2528411093810927
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.5919, Accuracy: 7090/8991 (78.8566%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0096, Accuracy: 3824/4462 (85.7015%), train_poison_data_count: 4462
Global model norm: 14.035400864136093.
Norm before scaling: 13.93577339186085. Distance: 2.166933764598039
Total norm for 5 adversaries is: 13.93577339186085. distance: 2.166933764598039
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.9899, Accuracy: 6992/8991 (77.7667%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 5, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3461/3841 (90.1067%), train_poison_data_count: 3841
Global model norm: 14.035400864136093.
Norm before scaling: 13.947080048171989. Distance: 1.8903296373914493
Total norm for 5 adversaries is: 13.947080048171989. distance: 1.8903296373914493
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.9283, Accuracy: 6357/8991 (70.7040%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0112, Accuracy: 2461/2945 (83.5654%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.2525, Accuracy: 6354/10000 (63.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0099, Accuracy: 2423/2756 (87.9173%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.5846, Accuracy: 5325/10000 (53.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0122, Accuracy: 2795/3437 (81.3209%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6498, Accuracy: 7740/10000 (77.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.0068, Accuracy: 5227/5809 (89.9811%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 2.8747, Accuracy: 4901/10000 (49.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 10, internal_epoch   1,  Average loss: 0.0079, Accuracy: 2273/2592 (87.6929%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.6452, Accuracy: 6007/10000 (60.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 11, internal_epoch   1,  Average loss: 0.0134, Accuracy: 2035/2510 (81.0757%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6550, Accuracy: 7637/10000 (76.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 12, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4085/4373 (93.4141%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 2.5539, Accuracy: 4117/10000 (41.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 13, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3855/4339 (88.8454%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.9093, Accuracy: 5536/10000 (55.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 14, internal_epoch   1,  Average loss: 0.0102, Accuracy: 2342/2782 (84.1840%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 2.2295, Accuracy: 5898/10000 (58.9800%), Attack Success Rate:0/10000(0.000)
time spent on training: 286.8170521259308
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.34988356 1.
 0.         0.         0.         0.4455751  1.         0.
 1.         1.         0.62837726]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 1.6579, Accuracy: 4999/10000 (49.9900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 1.6391, Accuracy: 5004/8991 (55.6557%)
Done in 316.0985689163208 sec.
Server Epoch:23 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  23, local model 0, internal_epoch   1,  Average loss: 0.0133, Accuracy: 2380/3010 (79.0698%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.0189, Accuracy: 7263/10000 (72.6300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 1, internal_epoch   1,  Average loss: 0.0062, Accuracy: 5316/5805 (91.5762%), train_poison_data_count: 5805
Global model norm: 14.04354679790825.
Norm before scaling: 13.682839911079371. Distance: 2.149044214758576
Total norm for 5 adversaries is: 13.682839911079371. distance: 2.149044214758576
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 1.7850, Accuracy: 5251/8991 (58.4028%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 2, internal_epoch   1,  Average loss: 0.0089, Accuracy: 4166/4779 (87.1730%), train_poison_data_count: 4779
Global model norm: 14.04354679790825.
Norm before scaling: 13.944042637386124. Distance: 2.2975113175438207
Total norm for 5 adversaries is: 13.944042637386124. distance: 2.2975113175438207
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.3419, Accuracy: 7975/8991 (88.6998%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4575/5123 (89.3031%), train_poison_data_count: 5123
Global model norm: 14.04354679790825.
Norm before scaling: 13.857710229778222. Distance: 2.2286521341571026
Total norm for 5 adversaries is: 13.857710229778222. distance: 2.2286521341571026
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.7214, Accuracy: 7043/8991 (78.3339%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 4, internal_epoch   1,  Average loss: 0.0091, Accuracy: 3852/4462 (86.3290%), train_poison_data_count: 4462
Global model norm: 14.04354679790825.
Norm before scaling: 13.934720570500497. Distance: 2.115010060315746
Total norm for 5 adversaries is: 13.934720570500497. distance: 2.115010060315746
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.8272, Accuracy: 7057/8991 (78.4896%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 5, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3429/3841 (89.2736%), train_poison_data_count: 3841
Global model norm: 14.04354679790825.
Norm before scaling: 13.965982798826202. Distance: 1.9272261145681853
Total norm for 5 adversaries is: 13.965982798826202. distance: 1.9272261145681853
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 1.8978, Accuracy: 6355/8991 (70.6818%)
___Train Local_Simple,  epoch  23, local model 6, internal_epoch   1,  Average loss: 0.0107, Accuracy: 2472/2945 (83.9389%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.1892, Accuracy: 6489/10000 (64.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 7, internal_epoch   1,  Average loss: 0.0099, Accuracy: 2429/2756 (88.1350%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.9835, Accuracy: 5470/10000 (54.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 8, internal_epoch   1,  Average loss: 0.0120, Accuracy: 2801/3437 (81.4955%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.7168, Accuracy: 7421/10000 (74.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 9, internal_epoch   1,  Average loss: 0.0065, Accuracy: 5269/5809 (90.7041%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.6681, Accuracy: 5071/10000 (50.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   1,  Average loss: 0.0078, Accuracy: 2267/2592 (87.4614%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.5841, Accuracy: 6155/10000 (61.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 11, internal_epoch   1,  Average loss: 0.0124, Accuracy: 2108/2510 (83.9841%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.5920, Accuracy: 7894/10000 (78.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4036/4373 (92.2936%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.1901, Accuracy: 4130/10000 (41.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 13, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3887/4339 (89.5829%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.4883, Accuracy: 6590/10000 (65.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   1,  Average loss: 0.0102, Accuracy: 2323/2782 (83.5011%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 2.0689, Accuracy: 5996/10000 (59.9600%), Attack Success Rate:0/10000(0.000)
time spent on training: 291.0944859981537
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.         1.
 0.37605    0.         0.         0.85714972 1.         0.39995975
 1.         1.         0.29739373]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 1.6112, Accuracy: 5129/10000 (51.2900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 1.5894, Accuracy: 5134/8991 (57.1015%)
Done in 319.8008761405945 sec.
Server Epoch:24 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  24, local model 0, internal_epoch   1,  Average loss: 0.0131, Accuracy: 2400/3010 (79.7342%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.1869, Accuracy: 7151/10000 (71.5100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 1, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5317/5805 (91.5935%), train_poison_data_count: 5805
Global model norm: 14.052644658547873.
Norm before scaling: 13.689175995242042. Distance: 2.1285757385714996
Total norm for 5 adversaries is: 13.689175995242042. distance: 2.1285757385714996
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 1.7161, Accuracy: 5198/8991 (57.8134%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 2, internal_epoch   1,  Average loss: 0.0088, Accuracy: 4149/4779 (86.8173%), train_poison_data_count: 4779
Global model norm: 14.052644658547873.
Norm before scaling: 13.934670199518033. Distance: 2.2358852164435543
Total norm for 5 adversaries is: 13.934670199518033. distance: 2.2358852164435543
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.5041, Accuracy: 7407/8991 (82.3824%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4575/5123 (89.3031%), train_poison_data_count: 5123
Global model norm: 14.052644658547873.
Norm before scaling: 13.871132251425024. Distance: 2.224015877639573
Total norm for 5 adversaries is: 13.871132251425024. distance: 2.224015877639573
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.6328, Accuracy: 7095/8991 (78.9122%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 4, internal_epoch   1,  Average loss: 0.0091, Accuracy: 3849/4462 (86.2618%), train_poison_data_count: 4462
Global model norm: 14.052644658547873.
Norm before scaling: 13.953213032512048. Distance: 2.1307752332149965
Total norm for 5 adversaries is: 13.953213032512048. distance: 2.1307752332149965
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.9548, Accuracy: 7057/8991 (78.4896%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 5, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3444/3841 (89.6641%), train_poison_data_count: 3841
Global model norm: 14.052644658547873.
Norm before scaling: 13.951949357317085. Distance: 1.8265538433251614
Total norm for 5 adversaries is: 13.951949357317085. distance: 1.8265538433251614
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 1.6457, Accuracy: 6428/8991 (71.4937%)
___Train Local_Simple,  epoch  24, local model 6, internal_epoch   1,  Average loss: 0.0105, Accuracy: 2481/2945 (84.2445%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.1620, Accuracy: 6274/10000 (62.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 7, internal_epoch   1,  Average loss: 0.0086, Accuracy: 2466/2756 (89.4775%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.6310, Accuracy: 5641/10000 (56.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0113, Accuracy: 2839/3437 (82.6011%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.8335, Accuracy: 7315/10000 (73.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 9, internal_epoch   1,  Average loss: 0.0064, Accuracy: 5277/5809 (90.8418%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.0952, Accuracy: 5309/10000 (53.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 10, internal_epoch   1,  Average loss: 0.0072, Accuracy: 2294/2592 (88.5031%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.6978, Accuracy: 5557/10000 (55.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 11, internal_epoch   1,  Average loss: 0.0122, Accuracy: 2108/2510 (83.9841%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.7307, Accuracy: 7337/10000 (73.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4105/4373 (93.8715%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.7422, Accuracy: 3843/10000 (38.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3929/4339 (90.5508%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.6072, Accuracy: 5929/10000 (59.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 14, internal_epoch   1,  Average loss: 0.0095, Accuracy: 2340/2782 (84.1121%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.0588, Accuracy: 6033/10000 (60.3300%), Attack Success Rate:0/10000(0.000)
time spent on training: 293.5226409435272
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.67324988
 0.         0.         0.         1.         1.         0.56579717
 1.         1.         0.02229062]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 1.5715, Accuracy: 5246/10000 (52.4600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 1.5496, Accuracy: 5249/8991 (58.3806%)
Done in 322.8194417953491 sec.
Server Epoch:25 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   1,  Average loss: 0.0124, Accuracy: 2430/3010 (80.7309%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.0742, Accuracy: 7033/10000 (70.3300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 5298/5805 (91.2661%), train_poison_data_count: 5805
Global model norm: 14.060541313245531.
Norm before scaling: 13.699214851546351. Distance: 2.1249876582965364
Total norm for 5 adversaries is: 13.699214851546351. distance: 2.1249876582965364
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.8552, Accuracy: 5133/8991 (57.0904%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 2, internal_epoch   1,  Average loss: 0.0084, Accuracy: 4196/4779 (87.8008%), train_poison_data_count: 4779
Global model norm: 14.060541313245531.
Norm before scaling: 13.942279081846474. Distance: 2.2161379200263265
Total norm for 5 adversaries is: 13.942279081846474. distance: 2.2161379200263265
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.5075, Accuracy: 7514/8991 (83.5725%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0079, Accuracy: 4571/5123 (89.2251%), train_poison_data_count: 5123
Global model norm: 14.060541313245531.
Norm before scaling: 13.886168238033159. Distance: 2.226572244187834
Total norm for 5 adversaries is: 13.886168238033159. distance: 2.226572244187834
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.5329, Accuracy: 7465/8991 (83.0275%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0092, Accuracy: 3849/4462 (86.2618%), train_poison_data_count: 4462
Global model norm: 14.060541313245531.
Norm before scaling: 13.949042634004437. Distance: 2.09328387181755
Total norm for 5 adversaries is: 13.949042634004437. distance: 2.09328387181755
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.7686, Accuracy: 7101/8991 (78.9790%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 5, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3482/3841 (90.6535%), train_poison_data_count: 3841
Global model norm: 14.060541313245531.
Norm before scaling: 13.938070379654535. Distance: 1.716304356880439
Total norm for 5 adversaries is: 13.938070379654535. distance: 1.716304356880439
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.9226, Accuracy: 6395/8991 (71.1267%)
___Train Local_Simple,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0102, Accuracy: 2499/2945 (84.8557%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.1218, Accuracy: 6704/10000 (67.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 7, internal_epoch   1,  Average loss: 0.0089, Accuracy: 2455/2756 (89.0784%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.4478, Accuracy: 5703/10000 (57.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0118, Accuracy: 2824/3437 (82.1647%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6566, Accuracy: 7727/10000 (77.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 9, internal_epoch   1,  Average loss: 0.0063, Accuracy: 5335/5809 (91.8402%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.4359, Accuracy: 5082/10000 (50.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 10, internal_epoch   1,  Average loss: 0.0071, Accuracy: 2296/2592 (88.5802%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.5721, Accuracy: 5760/10000 (57.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 11, internal_epoch   1,  Average loss: 0.0120, Accuracy: 2095/2510 (83.4661%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.5896, Accuracy: 7832/10000 (78.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4093/4373 (93.5971%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 2.2174, Accuracy: 4261/10000 (42.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 13, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3908/4339 (90.0668%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.6622, Accuracy: 5830/10000 (58.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 14, internal_epoch   1,  Average loss: 0.0093, Accuracy: 2374/2782 (85.3343%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.8612, Accuracy: 6066/10000 (60.6600%), Attack Success Rate:0/10000(0.000)
time spent on training: 298.83801198005676
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.        0.        0.        0.        0.        1.        0.
 0.        0.        1.        1.        0.        1.        1.
 0.2021835]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 1.5323, Accuracy: 5346/10000 (53.4600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 1.5105, Accuracy: 5348/8991 (59.4817%)
Done in 327.3961160182953 sec.
Server Epoch:26 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  26, local model 0, internal_epoch   1,  Average loss: 0.0120, Accuracy: 2448/3010 (81.3289%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.9925, Accuracy: 7202/10000 (72.0200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5351/5805 (92.1792%), train_poison_data_count: 5805
Global model norm: 14.068269215879711.
Norm before scaling: 13.682033614314875. Distance: 2.0108275578343835
Total norm for 5 adversaries is: 13.682033614314875. distance: 2.0108275578343835
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.6592, Accuracy: 5279/8991 (58.7143%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 2, internal_epoch   1,  Average loss: 0.0081, Accuracy: 4212/4779 (88.1356%), train_poison_data_count: 4779
Global model norm: 14.068269215879711.
Norm before scaling: 13.944513172995174. Distance: 2.170153367735988
Total norm for 5 adversaries is: 13.944513172995174. distance: 2.170153367735988
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2903, Accuracy: 8178/8991 (90.9576%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0077, Accuracy: 4586/5123 (89.5179%), train_poison_data_count: 5123
Global model norm: 14.068269215879711.
Norm before scaling: 13.874563949193988. Distance: 2.1620947088693523
Total norm for 5 adversaries is: 13.874563949193988. distance: 2.1620947088693523
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.7340, Accuracy: 6897/8991 (76.7100%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0086, Accuracy: 3877/4462 (86.8893%), train_poison_data_count: 4462
Global model norm: 14.068269215879711.
Norm before scaling: 13.962709627140283. Distance: 2.088743686814872
Total norm for 5 adversaries is: 13.962709627140283. distance: 2.088743686814872
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.8934, Accuracy: 7133/8991 (79.3349%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 5, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3499/3841 (91.0961%), train_poison_data_count: 3841
Global model norm: 14.068269215879711.
Norm before scaling: 13.948389563355793. Distance: 1.7178301343729223
Total norm for 5 adversaries is: 13.948389563355793. distance: 1.7178301343729223
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.7754, Accuracy: 6501/8991 (72.3056%)
___Train Local_Simple,  epoch  26, local model 6, internal_epoch   1,  Average loss: 0.0095, Accuracy: 2531/2945 (85.9423%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.9874, Accuracy: 6843/10000 (68.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 7, internal_epoch   1,  Average loss: 0.0088, Accuracy: 2467/2756 (89.5138%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.4697, Accuracy: 5619/10000 (56.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   1,  Average loss: 0.0109, Accuracy: 2850/3437 (82.9212%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.5162, Accuracy: 8204/10000 (82.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 9, internal_epoch   1,  Average loss: 0.0061, Accuracy: 5300/5809 (91.2377%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.4112, Accuracy: 5067/10000 (50.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 10, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2314/2592 (89.2747%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.5797, Accuracy: 6206/10000 (62.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0117, Accuracy: 2118/2510 (84.3825%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.5322, Accuracy: 8181/10000 (81.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4118/4373 (94.1688%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.7640, Accuracy: 3939/10000 (39.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3963/4339 (91.3344%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.4672, Accuracy: 6343/10000 (63.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0088, Accuracy: 2385/2782 (85.7297%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 2.1358, Accuracy: 5927/10000 (59.2700%), Attack Success Rate:0/10000(0.000)
time spent on training: 303.1245210170746
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.63835595
 0.         0.         0.         0.71692089 1.         0.31179719
 1.         1.         0.69120182]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 1.4917, Accuracy: 5434/10000 (54.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 1.4695, Accuracy: 5433/8991 (60.4271%)
Done in 331.75042390823364 sec.
Server Epoch:27 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0119, Accuracy: 2433/3010 (80.8306%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.1109, Accuracy: 7074/10000 (70.7400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 1, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5358/5805 (92.2997%), train_poison_data_count: 5805
Global model norm: 14.076249246396559.
Norm before scaling: 13.69820344380571. Distance: 2.0367194851375374
Total norm for 5 adversaries is: 13.69820344380571. distance: 2.0367194851375374
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 1.6447, Accuracy: 5371/8991 (59.7375%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0080, Accuracy: 4230/4779 (88.5122%), train_poison_data_count: 4779
Global model norm: 14.076249246396559.
Norm before scaling: 13.935131196717402. Distance: 2.1129857560059957
Total norm for 5 adversaries is: 13.935131196717402. distance: 2.1129857560059957
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.3102, Accuracy: 8180/8991 (90.9799%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   1,  Average loss: 0.0078, Accuracy: 4590/5123 (89.5959%), train_poison_data_count: 5123
Global model norm: 14.076249246396559.
Norm before scaling: 13.874495213579506. Distance: 2.131527691869964
Total norm for 5 adversaries is: 13.874495213579506. distance: 2.131527691869964
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.5368, Accuracy: 7430/8991 (82.6382%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 4, internal_epoch   1,  Average loss: 0.0084, Accuracy: 3901/4462 (87.4272%), train_poison_data_count: 4462
Global model norm: 14.076249246396559.
Norm before scaling: 13.963481686197797. Distance: 2.045548453246429
Total norm for 5 adversaries is: 13.963481686197797. distance: 2.045548453246429
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.8252, Accuracy: 7102/8991 (78.9901%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 5, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3492/3841 (90.9138%), train_poison_data_count: 3841
Global model norm: 14.076249246396559.
Norm before scaling: 13.969036739401819. Distance: 1.7381580780623769
Total norm for 5 adversaries is: 13.969036739401819. distance: 1.7381580780623769
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 1.8495, Accuracy: 6552/8991 (72.8729%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2498/2945 (84.8217%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.0732, Accuracy: 6765/10000 (67.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 7, internal_epoch   1,  Average loss: 0.0083, Accuracy: 2462/2756 (89.3324%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.5271, Accuracy: 5734/10000 (57.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 8, internal_epoch   1,  Average loss: 0.0106, Accuracy: 2876/3437 (83.6776%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4625, Accuracy: 8480/10000 (84.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 9, internal_epoch   1,  Average loss: 0.0057, Accuracy: 5341/5809 (91.9435%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.2119, Accuracy: 5308/10000 (53.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2322/2592 (89.5833%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.6343, Accuracy: 5472/10000 (54.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 11, internal_epoch   1,  Average loss: 0.0113, Accuracy: 2133/2510 (84.9801%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.5592, Accuracy: 8121/10000 (81.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 12, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4123/4373 (94.2831%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 2.2606, Accuracy: 4243/10000 (42.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 13, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3958/4339 (91.2192%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.5276, Accuracy: 6392/10000 (63.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.0088, Accuracy: 2403/2782 (86.3767%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.9999, Accuracy: 6081/10000 (60.8100%), Attack Success Rate:0/10000(0.000)
time spent on training: 308.81792402267456
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.18167466 1.
 0.1368472  0.         0.         1.         1.         0.55707479
 1.         1.         0.40014272]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 1.4409, Accuracy: 5609/10000 (56.0900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 1.4171, Accuracy: 5608/8991 (62.3735%)
Done in 337.35015988349915 sec.
Server Epoch:28 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  28, local model 0, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2441/3010 (81.0963%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.0368, Accuracy: 7013/10000 (70.1300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 1, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5352/5805 (92.1964%), train_poison_data_count: 5805
Global model norm: 14.086049075750557.
Norm before scaling: 13.700987976536696. Distance: 1.9989291542975596
Total norm for 5 adversaries is: 13.700987976536696. distance: 1.9989291542975596
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.7690, Accuracy: 5285/8991 (58.7810%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0076, Accuracy: 4250/4779 (88.9307%), train_poison_data_count: 4779
Global model norm: 14.086049075750557.
Norm before scaling: 13.933714758901226. Distance: 2.0439902208172698
Total norm for 5 adversaries is: 13.933714758901226. distance: 2.0439902208172698
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.2752, Accuracy: 8253/8991 (91.7918%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4629/5123 (90.3572%), train_poison_data_count: 5123
Global model norm: 14.086049075750557.
Norm before scaling: 13.870818186681301. Distance: 2.0499414668216795
Total norm for 5 adversaries is: 13.870818186681301. distance: 2.0499414668216795
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.5580, Accuracy: 7382/8991 (82.1043%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 4, internal_epoch   1,  Average loss: 0.0082, Accuracy: 3914/4462 (87.7185%), train_poison_data_count: 4462
Global model norm: 14.086049075750557.
Norm before scaling: 13.953366131210116. Distance: 1.9758468357602492
Total norm for 5 adversaries is: 13.953366131210116. distance: 1.9758468357602492
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.8863, Accuracy: 7004/8991 (77.9001%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 5, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3487/3841 (90.7837%), train_poison_data_count: 3841
Global model norm: 14.086049075750557.
Norm before scaling: 13.982593614717405. Distance: 1.7368871005783997
Total norm for 5 adversaries is: 13.982593614717405. distance: 1.7368871005783997
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.8086, Accuracy: 6392/8991 (71.0933%)
___Train Local_Simple,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0091, Accuracy: 2536/2945 (86.1121%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.0637, Accuracy: 6564/10000 (65.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 7, internal_epoch   1,  Average loss: 0.0077, Accuracy: 2493/2756 (90.4572%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.3075, Accuracy: 6273/10000 (62.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 8, internal_epoch   1,  Average loss: 0.0105, Accuracy: 2866/3437 (83.3867%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6485, Accuracy: 7743/10000 (77.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 9, internal_epoch   1,  Average loss: 0.0055, Accuracy: 5354/5809 (92.1673%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.3273, Accuracy: 5280/10000 (52.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 10, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2334/2592 (90.0463%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.4764, Accuracy: 6077/10000 (60.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 11, internal_epoch   1,  Average loss: 0.0106, Accuracy: 2166/2510 (86.2948%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.4803, Accuracy: 8605/10000 (86.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4135/4373 (94.5575%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.6414, Accuracy: 4030/10000 (40.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 13, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3965/4339 (91.3805%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.4451, Accuracy: 6305/10000 (63.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 14, internal_epoch   1,  Average loss: 0.0087, Accuracy: 2393/2782 (86.0173%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 2.0873, Accuracy: 6088/10000 (60.8800%), Attack Success Rate:0/10000(0.000)
time spent on training: 314.0677089691162
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.57454544
 0.         0.         0.         0.87558174 1.         0.
 1.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 1.4102, Accuracy: 5678/10000 (56.7800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 1.3878, Accuracy: 5675/8991 (63.1187%)
Done in 342.82688784599304 sec.
Server Epoch:29 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  29, local model 0, internal_epoch   1,  Average loss: 0.0110, Accuracy: 2472/3010 (82.1262%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.1193, Accuracy: 7026/10000 (70.2600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 1, internal_epoch   1,  Average loss: 0.0052, Accuracy: 5394/5805 (92.9199%), train_poison_data_count: 5805
Global model norm: 14.092647264058648.
Norm before scaling: 13.692422060212722. Distance: 1.9177958299802151
Total norm for 5 adversaries is: 13.692422060212722. distance: 1.9177958299802151
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 1.7555, Accuracy: 5332/8991 (59.3037%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 2, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4284/4779 (89.6422%), train_poison_data_count: 4779
Global model norm: 14.092647264058648.
Norm before scaling: 13.940247679689689. Distance: 2.036426462637906
Total norm for 5 adversaries is: 13.940247679689689. distance: 2.036426462637906
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.2607, Accuracy: 8299/8991 (92.3034%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4620/5123 (90.1815%), train_poison_data_count: 5123
Global model norm: 14.092647264058648.
Norm before scaling: 13.885166601899309. Distance: 2.0617882627598068
Total norm for 5 adversaries is: 13.885166601899309. distance: 2.0617882627598068
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.6423, Accuracy: 7376/8991 (82.0376%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 4, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3944/4462 (88.3909%), train_poison_data_count: 4462
Global model norm: 14.092647264058648.
Norm before scaling: 13.946940556226167. Distance: 1.9067262148505846
Total norm for 5 adversaries is: 13.946940556226167. distance: 1.9067262148505846
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.8868, Accuracy: 7013/8991 (78.0002%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 5, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3488/3841 (90.8097%), train_poison_data_count: 3841
Global model norm: 14.092647264058648.
Norm before scaling: 13.985087490578692. Distance: 1.7205543064015316
Total norm for 5 adversaries is: 13.985087490578692. distance: 1.7205543064015316
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 1.7577, Accuracy: 6528/8991 (72.6059%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0094, Accuracy: 2530/2945 (85.9083%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.1484, Accuracy: 6616/10000 (66.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 7, internal_epoch   1,  Average loss: 0.0081, Accuracy: 2471/2756 (89.6589%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.3804, Accuracy: 6129/10000 (61.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   1,  Average loss: 0.0103, Accuracy: 2884/3437 (83.9104%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.5841, Accuracy: 7957/10000 (79.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 9, internal_epoch   1,  Average loss: 0.0054, Accuracy: 5348/5809 (92.0640%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.4149, Accuracy: 5170/10000 (51.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 10, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2353/2592 (90.7793%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.7111, Accuracy: 5824/10000 (58.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 11, internal_epoch   1,  Average loss: 0.0105, Accuracy: 2148/2510 (85.5777%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.4904, Accuracy: 8393/10000 (83.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4129/4373 (94.4203%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 2.4279, Accuracy: 4211/10000 (42.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 13, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3989/4339 (91.9336%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.6017, Accuracy: 6218/10000 (62.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 14, internal_epoch   1,  Average loss: 0.0085, Accuracy: 2413/2782 (86.7362%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.8557, Accuracy: 6106/10000 (61.0600%), Attack Success Rate:0/10000(0.000)
time spent on training: 318.2553918361664
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.47180064 1.
 0.2349691  0.         0.         0.75400258 1.         0.23560457
 1.         1.         0.41123615]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 1.3649, Accuracy: 5848/10000 (58.4800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 1.3409, Accuracy: 5841/8991 (64.9650%)
Done in 346.7994661331177 sec.
Server Epoch:30 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  30, local model 0, internal_epoch   1,  Average loss: 0.0110, Accuracy: 2490/3010 (82.7243%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.0494, Accuracy: 7245/10000 (72.4500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 1, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5398/5805 (92.9888%), train_poison_data_count: 5805
Global model norm: 14.102000728993985.
Norm before scaling: 13.70839597616212. Distance: 1.9541448753242692
Total norm for 5 adversaries is: 13.70839597616212. distance: 1.9541448753242692
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.5677, Accuracy: 5357/8991 (59.5818%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 2, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4282/4779 (89.6003%), train_poison_data_count: 4779
Global model norm: 14.102000728993985.
Norm before scaling: 13.951072755536524. Distance: 2.042761243270803
Total norm for 5 adversaries is: 13.951072755536524. distance: 2.042761243270803
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.5653, Accuracy: 7262/8991 (80.7697%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4619/5123 (90.1620%), train_poison_data_count: 5123
Global model norm: 14.102000728993985.
Norm before scaling: 13.894659737246796. Distance: 2.0789802340273855
Total norm for 5 adversaries is: 13.894659737246796. distance: 2.0789802340273855
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.5892, Accuracy: 7330/8991 (81.5260%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3915/4462 (87.7409%), train_poison_data_count: 4462
Global model norm: 14.102000728993985.
Norm before scaling: 13.971378497279995. Distance: 1.9592646420199296
Total norm for 5 adversaries is: 13.971378497279995. distance: 1.9592646420199296
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.8637, Accuracy: 6974/8991 (77.5665%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 5, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3523/3841 (91.7209%), train_poison_data_count: 3841
Global model norm: 14.102000728993985.
Norm before scaling: 13.990588158002362. Distance: 1.687431122115915
Total norm for 5 adversaries is: 13.990588158002362. distance: 1.687431122115915
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.7552, Accuracy: 6450/8991 (71.7384%)
___Train Local_Simple,  epoch  30, local model 6, internal_epoch   1,  Average loss: 0.0092, Accuracy: 2529/2945 (85.8744%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.1161, Accuracy: 6571/10000 (65.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 2491/2756 (90.3846%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.4523, Accuracy: 5946/10000 (59.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0098, Accuracy: 2895/3437 (84.2304%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.4651, Accuracy: 8449/10000 (84.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 9, internal_epoch   1,  Average loss: 0.0056, Accuracy: 5348/5809 (92.0640%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.5133, Accuracy: 5056/10000 (50.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2366/2592 (91.2809%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.5043, Accuracy: 5900/10000 (59.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0107, Accuracy: 2167/2510 (86.3347%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5493, Accuracy: 7877/10000 (78.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 12, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4152/4373 (94.9463%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 2.1942, Accuracy: 4373/10000 (43.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 13, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4006/4339 (92.3254%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.5672, Accuracy: 6321/10000 (63.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 14, internal_epoch   1,  Average loss: 0.0083, Accuracy: 2376/2782 (85.4062%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.9846, Accuracy: 6149/10000 (61.4900%), Attack Success Rate:0/10000(0.000)
time spent on training: 323.8339340686798
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.29909963 0.74773681
 0.25444578 0.         0.         0.6566875  1.         1.
 1.         1.         0.37051966]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 1.3180, Accuracy: 6018/10000 (60.1800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 1.2932, Accuracy: 6011/8991 (66.8557%)
Done in 352.3938159942627 sec.
Server Epoch:31 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  31, local model 0, internal_epoch   1,  Average loss: 0.0109, Accuracy: 2466/3010 (81.9269%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.0509, Accuracy: 6960/10000 (69.6000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 1, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5394/5805 (92.9199%), train_poison_data_count: 5805
Global model norm: 14.111709688829235.
Norm before scaling: 13.721215098321798. Distance: 1.9567276953365023
Total norm for 5 adversaries is: 13.721215098321798. distance: 1.9567276953365023
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.5793, Accuracy: 5319/8991 (59.1592%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 2, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4318/4779 (90.3536%), train_poison_data_count: 4779
Global model norm: 14.111709688829235.
Norm before scaling: 13.941660170355037. Distance: 1.9566689039712535
Total norm for 5 adversaries is: 13.941660170355037. distance: 1.9566689039712535
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.3009, Accuracy: 8148/8991 (90.6240%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   1,  Average loss: 0.0069, Accuracy: 4637/5123 (90.5134%), train_poison_data_count: 5123
Global model norm: 14.111709688829235.
Norm before scaling: 13.88831577051034. Distance: 1.9991013176771764
Total norm for 5 adversaries is: 13.88831577051034. distance: 1.9991013176771764
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.4740, Accuracy: 7610/8991 (84.6402%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3930/4462 (88.0771%), train_poison_data_count: 4462
Global model norm: 14.111709688829235.
Norm before scaling: 13.972325356020457. Distance: 1.9136201308403584
Total norm for 5 adversaries is: 13.972325356020457. distance: 1.9136201308403584
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.8185, Accuracy: 7114/8991 (79.1236%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 5, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3538/3841 (92.1114%), train_poison_data_count: 3841
Global model norm: 14.111709688829235.
Norm before scaling: 13.978488744603538. Distance: 1.5931013694737663
Total norm for 5 adversaries is: 13.978488744603538. distance: 1.5931013694737663
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.6288, Accuracy: 6424/8991 (71.4492%)
___Train Local_Simple,  epoch  31, local model 6, internal_epoch   1,  Average loss: 0.0085, Accuracy: 2563/2945 (87.0289%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.0947, Accuracy: 6857/10000 (68.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2520/2756 (91.4369%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.4430, Accuracy: 6029/10000 (60.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 8, internal_epoch   1,  Average loss: 0.0098, Accuracy: 2911/3437 (84.6960%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.4933, Accuracy: 8248/10000 (82.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 5377/5809 (92.5633%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.1992, Accuracy: 5525/10000 (55.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2356/2592 (90.8951%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.3868, Accuracy: 6388/10000 (63.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0099, Accuracy: 2176/2510 (86.6932%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.5208, Accuracy: 8067/10000 (80.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4146/4373 (94.8091%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.0867, Accuracy: 4900/10000 (49.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 13, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4007/4339 (92.3485%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.1270, Accuracy: 6917/10000 (69.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0077, Accuracy: 2445/2782 (87.8864%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 2.0220, Accuracy: 6323/10000 (63.2300%), Attack Success Rate:0/10000(0.000)
time spent on training: 328.48987889289856
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.21503345 1.
 0.38251822 0.         0.         0.23793466 1.         0.56502588
 1.         1.         0.3638878 ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 1.2777, Accuracy: 6138/10000 (61.3800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 1.2506, Accuracy: 6127/8991 (68.1459%)
Done in 357.48112416267395 sec.
Server Epoch:32 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  32, local model 0, internal_epoch   1,  Average loss: 0.0115, Accuracy: 2462/3010 (81.7940%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.1710, Accuracy: 6827/10000 (68.2700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 1, internal_epoch   1,  Average loss: 0.0050, Accuracy: 5425/5805 (93.4539%), train_poison_data_count: 5805
Global model norm: 14.120154705983163.
Norm before scaling: 13.723604703204064. Distance: 1.909896552095537
Total norm for 5 adversaries is: 13.723604703204064. distance: 1.909896552095537
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 1.6081, Accuracy: 5653/8991 (62.8740%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 2, internal_epoch   1,  Average loss: 0.0070, Accuracy: 4306/4779 (90.1025%), train_poison_data_count: 4779
Global model norm: 14.120154705983163.
Norm before scaling: 13.959933030806752. Distance: 1.9723130333578756
Total norm for 5 adversaries is: 13.959933030806752. distance: 1.9723130333578756
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.3360, Accuracy: 8022/8991 (89.2226%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   1,  Average loss: 0.0068, Accuracy: 4654/5123 (90.8452%), train_poison_data_count: 5123
Global model norm: 14.120154705983163.
Norm before scaling: 13.90923587589797. Distance: 2.039571296674561
Total norm for 5 adversaries is: 13.90923587589797. distance: 2.039571296674561
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.6029, Accuracy: 7332/8991 (81.5482%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 4, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3947/4462 (88.4581%), train_poison_data_count: 4462
Global model norm: 14.120154705983163.
Norm before scaling: 13.994367828973811. Distance: 1.9455224961759838
Total norm for 5 adversaries is: 13.994367828973811. distance: 1.9455224961759838
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.8656, Accuracy: 6862/8991 (76.3208%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 5, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3543/3841 (92.2416%), train_poison_data_count: 3841
Global model norm: 14.120154705983163.
Norm before scaling: 13.97082968299485. Distance: 1.5300937101550607
Total norm for 5 adversaries is: 13.97082968299485. distance: 1.5300937101550607
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 1.7501, Accuracy: 6483/8991 (72.1054%)
___Train Local_Simple,  epoch  32, local model 6, internal_epoch   1,  Average loss: 0.0087, Accuracy: 2546/2945 (86.4516%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.1808, Accuracy: 6338/10000 (63.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 7, internal_epoch   1,  Average loss: 0.0074, Accuracy: 2480/2756 (89.9855%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.2311, Accuracy: 6400/10000 (64.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   1,  Average loss: 0.0092, Accuracy: 2924/3437 (85.0742%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6119, Accuracy: 7867/10000 (78.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 9, internal_epoch   1,  Average loss: 0.0051, Accuracy: 5386/5809 (92.7182%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.5123, Accuracy: 4892/10000 (48.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2375/2592 (91.6281%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.5061, Accuracy: 5892/10000 (58.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 11, internal_epoch   1,  Average loss: 0.0098, Accuracy: 2178/2510 (86.7729%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4744, Accuracy: 8182/10000 (81.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4151/4373 (94.9234%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 2.1949, Accuracy: 4822/10000 (48.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 13, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4007/4339 (92.3485%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.7917, Accuracy: 5755/10000 (57.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 14, internal_epoch   1,  Average loss: 0.0080, Accuracy: 2441/2782 (87.7426%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.8288, Accuracy: 6115/10000 (61.1500%), Attack Success Rate:0/10000(0.000)
time spent on training: 334.6496388912201
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.71017385 1.
 0.13599314 0.         0.         1.         1.         1.
 1.         1.         0.8172811 ]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 1.2297, Accuracy: 6204/10000 (62.0400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 1.1999, Accuracy: 6191/8991 (68.8577%)
Done in 363.21342182159424 sec.
Server Epoch:33 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  33, local model 0, internal_epoch   1,  Average loss: 0.0102, Accuracy: 2498/3010 (82.9900%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.9592, Accuracy: 7282/10000 (72.8200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5416/5805 (93.2989%), train_poison_data_count: 5805
Global model norm: 14.13203241610919.
Norm before scaling: 13.731632240889043. Distance: 1.8693645347167085
Total norm for 5 adversaries is: 13.731632240889043. distance: 1.8693645347167085
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 1.4372, Accuracy: 5555/8991 (61.7840%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4302/4779 (90.0188%), train_poison_data_count: 4779
Global model norm: 14.13203241610919.
Norm before scaling: 13.96794982939599. Distance: 1.9542142958486208
Total norm for 5 adversaries is: 13.96794982939599. distance: 1.9542142958486208
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.3179, Accuracy: 8042/8991 (89.4450%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4705/5123 (91.8407%), train_poison_data_count: 5123
Global model norm: 14.13203241610919.
Norm before scaling: 13.896704391485628. Distance: 1.914486834142311
Total norm for 5 adversaries is: 13.896704391485628. distance: 1.914486834142311
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.5624, Accuracy: 7290/8991 (81.0811%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0072, Accuracy: 3961/4462 (88.7719%), train_poison_data_count: 4462
Global model norm: 14.13203241610919.
Norm before scaling: 13.96988108448488. Distance: 1.8071621528706794
Total norm for 5 adversaries is: 13.96988108448488. distance: 1.8071621528706794
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.7725, Accuracy: 7139/8991 (79.4016%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 5, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3549/3841 (92.3978%), train_poison_data_count: 3841
Global model norm: 14.13203241610919.
Norm before scaling: 13.991529354461498. Distance: 1.5444541251994444
Total norm for 5 adversaries is: 13.991529354461498. distance: 1.5444541251994444
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 1.6697, Accuracy: 6468/8991 (71.9386%)
___Train Local_Simple,  epoch  33, local model 6, internal_epoch   1,  Average loss: 0.0080, Accuracy: 2584/2945 (87.7419%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.0409, Accuracy: 6681/10000 (66.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 7, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2505/2756 (90.8926%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.1557, Accuracy: 7090/10000 (70.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 8, internal_epoch   1,  Average loss: 0.0091, Accuracy: 2958/3437 (86.0634%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5121, Accuracy: 8157/10000 (81.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 9, internal_epoch   1,  Average loss: 0.0049, Accuracy: 5396/5809 (92.8903%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.3542, Accuracy: 5416/10000 (54.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 10, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2372/2592 (91.5123%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.4174, Accuracy: 6397/10000 (63.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 11, internal_epoch   1,  Average loss: 0.0096, Accuracy: 2164/2510 (86.2151%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5674, Accuracy: 7835/10000 (78.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 12, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4158/4373 (95.0835%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 2.3963, Accuracy: 4226/10000 (42.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 13, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4035/4339 (92.9938%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.5008, Accuracy: 6421/10000 (64.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0074, Accuracy: 2464/2782 (88.5694%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.8533, Accuracy: 5817/10000 (58.1700%), Attack Success Rate:0/10000(0.000)
time spent on training: 337.07242798805237
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.53273056 1.
 0.49482294 0.         0.         1.         1.         0.64505951
 1.         1.         0.65201822]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 1.1803, Accuracy: 6312/10000 (63.1200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 1.1480, Accuracy: 6305/8991 (70.1257%)
Done in 365.6430757045746 sec.
Server Epoch:34 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0099, Accuracy: 2527/3010 (83.9535%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.9218, Accuracy: 7301/10000 (73.0100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 1, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5423/5805 (93.4195%), train_poison_data_count: 5805
Global model norm: 14.143381766845382.
Norm before scaling: 13.727193332651515. Distance: 1.8425946899471703
Total norm for 5 adversaries is: 13.727193332651515. distance: 1.8425946899471703
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1.8548, Accuracy: 5308/8991 (59.0368%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 2, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4348/4779 (90.9814%), train_poison_data_count: 4779
Global model norm: 14.143381766845382.
Norm before scaling: 13.96994061271043. Distance: 1.9009006674398177
Total norm for 5 adversaries is: 13.96994061271043. distance: 1.9009006674398177
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2558, Accuracy: 8269/8991 (91.9697%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4675/5123 (91.2551%), train_poison_data_count: 5123
Global model norm: 14.143381766845382.
Norm before scaling: 13.911640348377944. Distance: 1.95301342454741
Total norm for 5 adversaries is: 13.911640348377944. distance: 1.95301342454741
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.4264, Accuracy: 7714/8991 (85.7969%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 4, internal_epoch   1,  Average loss: 0.0071, Accuracy: 4000/4462 (89.6459%), train_poison_data_count: 4462
Global model norm: 14.143381766845382.
Norm before scaling: 13.973561527145815. Distance: 1.7883015976027778
Total norm for 5 adversaries is: 13.973561527145815. distance: 1.7883015976027778
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.9463, Accuracy: 6809/8991 (75.7313%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3561/3841 (92.7102%), train_poison_data_count: 3841
Global model norm: 14.143381766845382.
Norm before scaling: 13.977184232782669. Distance: 1.4442688344104067
Total norm for 5 adversaries is: 13.977184232782669. distance: 1.4442688344104067
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1.5584, Accuracy: 6580/8991 (73.1843%)
___Train Local_Simple,  epoch  34, local model 6, internal_epoch   1,  Average loss: 0.0074, Accuracy: 2608/2945 (88.5569%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.9580, Accuracy: 7019/10000 (70.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 7, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2542/2756 (92.2351%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.3369, Accuracy: 6385/10000 (63.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 8, internal_epoch   1,  Average loss: 0.0092, Accuracy: 2927/3437 (85.1615%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4829, Accuracy: 8269/10000 (82.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5396/5809 (92.8903%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 2.2370, Accuracy: 5155/10000 (51.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2372/2592 (91.5123%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.3405, Accuracy: 6519/10000 (65.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 11, internal_epoch   1,  Average loss: 0.0088, Accuracy: 2198/2510 (87.5697%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6629, Accuracy: 7614/10000 (76.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 12, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4153/4373 (94.9691%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.7316, Accuracy: 4891/10000 (48.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4059/4339 (93.5469%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.3187, Accuracy: 6619/10000 (66.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 14, internal_epoch   1,  Average loss: 0.0072, Accuracy: 2458/2782 (88.3537%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.6842, Accuracy: 6264/10000 (62.6400%), Attack Success Rate:0/10000(0.000)
time spent on training: 342.6649453639984
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.97244777
 0.         0.         0.         0.         1.         0.40793742
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 1.1476, Accuracy: 6397/10000 (63.9700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 1.1149, Accuracy: 6383/8991 (70.9932%)
Done in 371.05174016952515 sec.
Server Epoch:35 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  35, local model 0, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2565/3010 (85.2159%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8706, Accuracy: 7209/10000 (72.0900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5449/5805 (93.8674%), train_poison_data_count: 5805
Global model norm: 14.150747412901907.
Norm before scaling: 13.71949797309614. Distance: 1.7427066320337663
Total norm for 5 adversaries is: 13.71949797309614. distance: 1.7427066320337663
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.5042, Accuracy: 5631/8991 (62.6293%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 2, internal_epoch   1,  Average loss: 0.0066, Accuracy: 4324/4779 (90.4792%), train_poison_data_count: 4779
Global model norm: 14.150747412901907.
Norm before scaling: 13.975214680505303. Distance: 1.9091205558497841
Total norm for 5 adversaries is: 13.975214680505303. distance: 1.9091205558497841
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.3002, Accuracy: 8151/8991 (90.6573%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4707/5123 (91.8798%), train_poison_data_count: 5123
Global model norm: 14.150747412901907.
Norm before scaling: 13.909026342413236. Distance: 1.882717842476799
Total norm for 5 adversaries is: 13.909026342413236. distance: 1.882717842476799
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.4777, Accuracy: 7500/8991 (83.4168%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 4, internal_epoch   1,  Average loss: 0.0070, Accuracy: 3993/4462 (89.4890%), train_poison_data_count: 4462
Global model norm: 14.150747412901907.
Norm before scaling: 13.982522681968295. Distance: 1.7769748179079534
Total norm for 5 adversaries is: 13.982522681968295. distance: 1.7769748179079534
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.8591, Accuracy: 6992/8991 (77.7667%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 5, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3560/3841 (92.6842%), train_poison_data_count: 3841
Global model norm: 14.150747412901907.
Norm before scaling: 13.97990392037967. Distance: 1.4272156071677684
Total norm for 5 adversaries is: 13.97990392037967. distance: 1.4272156071677684
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.5198, Accuracy: 6379/8991 (70.9487%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   1,  Average loss: 0.0075, Accuracy: 2607/2945 (88.5229%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8606, Accuracy: 7264/10000 (72.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 7, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2516/2756 (91.2917%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.0314, Accuracy: 7087/10000 (70.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0089, Accuracy: 2947/3437 (85.7434%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4188, Accuracy: 8607/10000 (86.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 9, internal_epoch   1,  Average loss: 0.0047, Accuracy: 5403/5809 (93.0108%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.0980, Accuracy: 5725/10000 (57.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2390/2592 (92.2068%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.1722, Accuracy: 6852/10000 (68.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 11, internal_epoch   1,  Average loss: 0.0089, Accuracy: 2211/2510 (88.0876%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.4847, Accuracy: 8251/10000 (82.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4126/4373 (94.3517%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 2.0097, Accuracy: 4522/10000 (45.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4042/4339 (93.1551%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.5361, Accuracy: 6459/10000 (64.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 14, internal_epoch   1,  Average loss: 0.0070, Accuracy: 2458/2782 (88.3537%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.8571, Accuracy: 5922/10000 (59.2200%), Attack Success Rate:0/10000(0.000)
time spent on training: 347.5972571372986
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.19369722 0.         0.         0.         0.3052471  0.9472241
 0.         0.         0.19369722 0.31958714 0.71197958 0.5537453
 1.         1.         0.96162742]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 1.1124, Accuracy: 6463/10000 (64.6300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 1.0787, Accuracy: 6443/8991 (71.6605%)
Done in 376.582524061203 sec.
Server Epoch:36 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  36, local model 0, internal_epoch   1,  Average loss: 0.0094, Accuracy: 2556/3010 (84.9169%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.8503, Accuracy: 7432/10000 (74.3200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5419/5805 (93.3506%), train_poison_data_count: 5805
Global model norm: 14.15990193737148.
Norm before scaling: 13.736639016325782. Distance: 1.7856245699552526
Total norm for 5 adversaries is: 13.736639016325782. distance: 1.7856245699552526
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 1.2740, Accuracy: 5836/8991 (64.9094%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 2, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4354/4779 (91.1069%), train_poison_data_count: 4779
Global model norm: 14.15990193737148.
Norm before scaling: 13.9636122708763. Distance: 1.8100982406468569
Total norm for 5 adversaries is: 13.9636122708763. distance: 1.8100982406468569
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.3420, Accuracy: 7988/8991 (88.8444%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4683/5123 (91.4113%), train_poison_data_count: 5123
Global model norm: 14.15990193737148.
Norm before scaling: 13.92133135863359. Distance: 1.907975400926055
Total norm for 5 adversaries is: 13.92133135863359. distance: 1.907975400926055
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.4617, Accuracy: 7620/8991 (84.7514%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4016/4462 (90.0045%), train_poison_data_count: 4462
Global model norm: 14.15990193737148.
Norm before scaling: 13.987220926372903. Distance: 1.7394737696455886
Total norm for 5 adversaries is: 13.987220926372903. distance: 1.7394737696455886
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.7855, Accuracy: 7218/8991 (80.2803%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 5, internal_epoch   1,  Average loss: 0.0052, Accuracy: 3553/3841 (92.5020%), train_poison_data_count: 3841
Global model norm: 14.15990193737148.
Norm before scaling: 14.001235362453011. Distance: 1.4724175135722517
Total norm for 5 adversaries is: 14.001235362453011. distance: 1.4724175135722517
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 1.4376, Accuracy: 6635/8991 (73.7960%)
___Train Local_Simple,  epoch  36, local model 6, internal_epoch   1,  Average loss: 0.0082, Accuracy: 2558/2945 (86.8591%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.0168, Accuracy: 6547/10000 (65.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 7, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2538/2756 (92.0900%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9945, Accuracy: 7429/10000 (74.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 8, internal_epoch   1,  Average loss: 0.0084, Accuracy: 3011/3437 (87.6055%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5918, Accuracy: 7794/10000 (77.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 9, internal_epoch   1,  Average loss: 0.0048, Accuracy: 5405/5809 (93.0453%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 2.0837, Accuracy: 5239/10000 (52.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2396/2592 (92.4383%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.3197, Accuracy: 6562/10000 (65.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 11, internal_epoch   1,  Average loss: 0.0087, Accuracy: 2219/2510 (88.4064%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6340, Accuracy: 7721/10000 (77.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 12, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4168/4373 (95.3121%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.7952, Accuracy: 4816/10000 (48.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4019/4339 (92.6250%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.2101, Accuracy: 6873/10000 (68.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2476/2782 (89.0007%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.7754, Accuracy: 6160/10000 (61.6000%), Attack Success Rate:0/10000(0.000)
time spent on training: 352.49805092811584
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [1.         0.         0.09790702 0.09790702 0.36012498 1.
 0.09724243 0.         0.73098391 1.         1.         0.42759934
 1.         1.         0.09724243]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 1.0721, Accuracy: 6536/10000 (65.3600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 1.0384, Accuracy: 6495/8991 (72.2389%)
Done in 380.8981189727783 sec.
Server Epoch:37 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.0093, Accuracy: 2558/3010 (84.9834%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.8012, Accuracy: 7914/10000 (79.1400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 1, internal_epoch   1,  Average loss: 0.0044, Accuracy: 5434/5805 (93.6090%), train_poison_data_count: 5805
Global model norm: 14.172336894691737.
Norm before scaling: 13.737519860014649. Distance: 1.7196198776400642
Total norm for 5 adversaries is: 13.737519860014649. distance: 1.7196198776400642
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.4131, Accuracy: 5714/8991 (63.5524%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 2, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4402/4779 (92.1113%), train_poison_data_count: 4779
Global model norm: 14.172336894691737.
Norm before scaling: 13.962386147385802. Distance: 1.758362883128172
Total norm for 5 adversaries is: 13.962386147385802. distance: 1.758362883128172
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.3825, Accuracy: 7782/8991 (86.5532%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4694/5123 (91.6260%), train_poison_data_count: 5123
Global model norm: 14.172336894691737.
Norm before scaling: 13.912016009663194. Distance: 1.8366131776935335
Total norm for 5 adversaries is: 13.912016009663194. distance: 1.8366131776935335
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.5158, Accuracy: 7417/8991 (82.4936%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 4, internal_epoch   1,  Average loss: 0.0064, Accuracy: 4025/4462 (90.2062%), train_poison_data_count: 4462
Global model norm: 14.172336894691737.
Norm before scaling: 13.982218212696473. Distance: 1.6874814915525076
Total norm for 5 adversaries is: 13.982218212696473. distance: 1.6874814915525076
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.9170, Accuracy: 6817/8991 (75.8203%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3577/3841 (93.1268%), train_poison_data_count: 3841
Global model norm: 14.172336894691737.
Norm before scaling: 13.99972969884151. Distance: 1.40543197575244
Total norm for 5 adversaries is: 13.99972969884151. distance: 1.40543197575244
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.4724, Accuracy: 6563/8991 (72.9952%)
___Train Local_Simple,  epoch  37, local model 6, internal_epoch   1,  Average loss: 0.0074, Accuracy: 2612/2945 (88.6927%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.9284, Accuracy: 6940/10000 (69.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2520/2756 (91.4369%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.9632, Accuracy: 7120/10000 (71.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 8, internal_epoch   1,  Average loss: 0.0083, Accuracy: 2988/3437 (86.9363%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.4247, Accuracy: 8599/10000 (85.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 9, internal_epoch   1,  Average loss: 0.0046, Accuracy: 5418/5809 (93.2691%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.8304, Accuracy: 5617/10000 (56.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 10, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2393/2592 (92.3225%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.4915, Accuracy: 6262/10000 (62.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 11, internal_epoch   1,  Average loss: 0.0088, Accuracy: 2210/2510 (88.0478%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6058, Accuracy: 7907/10000 (79.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 12, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4189/4373 (95.7924%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.5414, Accuracy: 5816/10000 (58.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4054/4339 (93.4317%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.2684, Accuracy: 6517/10000 (65.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 14, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2491/2782 (89.5399%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.6266, Accuracy: 6418/10000 (64.1800%), Attack Success Rate:0/10000(0.000)
time spent on training: 357.38794207572937
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.45671171 0.76688788
 0.39803185 0.         0.         0.45671171 1.         0.55665189
 1.         1.         0.53810127]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 1.0391, Accuracy: 6635/10000 (66.3500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 1.0054, Accuracy: 6574/8991 (73.1176%)
Done in 385.76268100738525 sec.
Server Epoch:38 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  38, local model 0, internal_epoch   1,  Average loss: 0.0090, Accuracy: 2596/3010 (86.2458%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.7896, Accuracy: 7698/10000 (76.9800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 1, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5449/5805 (93.8674%), train_poison_data_count: 5805
Global model norm: 14.181179436835519.
Norm before scaling: 13.753070280438179. Distance: 1.7426905568598183
Total norm for 5 adversaries is: 13.753070280438179. distance: 1.7426905568598183
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.3779, Accuracy: 5761/8991 (64.0752%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 2, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4370/4779 (91.4417%), train_poison_data_count: 4779
Global model norm: 14.181179436835519.
Norm before scaling: 13.973977017707101. Distance: 1.7683521241110387
Total norm for 5 adversaries is: 13.973977017707101. distance: 1.7683521241110387
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.2573, Accuracy: 8240/8991 (91.6472%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4721/5123 (92.1530%), train_poison_data_count: 5123
Global model norm: 14.181179436835519.
Norm before scaling: 13.916313182125782. Distance: 1.804496920212263
Total norm for 5 adversaries is: 13.916313182125782. distance: 1.804496920212263
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.5972, Accuracy: 7437/8991 (82.7160%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 4, internal_epoch   1,  Average loss: 0.0062, Accuracy: 4047/4462 (90.6992%), train_poison_data_count: 4462
Global model norm: 14.181179436835519.
Norm before scaling: 13.985192233453233. Distance: 1.6523863874845712
Total norm for 5 adversaries is: 13.985192233453233. distance: 1.6523863874845712
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.8479, Accuracy: 7084/8991 (78.7899%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3579/3841 (93.1789%), train_poison_data_count: 3841
Global model norm: 14.181179436835519.
Norm before scaling: 14.007171973643315. Distance: 1.4015456029581506
Total norm for 5 adversaries is: 14.007171973643315. distance: 1.4015456029581506
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.4755, Accuracy: 6570/8991 (73.0731%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   1,  Average loss: 0.0074, Accuracy: 2599/2945 (88.2513%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.8661, Accuracy: 7344/10000 (73.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2543/2756 (92.2714%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.1226, Accuracy: 6687/10000 (66.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 8, internal_epoch   1,  Average loss: 0.0083, Accuracy: 2997/3437 (87.1981%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4299, Accuracy: 8592/10000 (85.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 9, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5413/5809 (93.1830%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 2.1808, Accuracy: 5428/10000 (54.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2404/2592 (92.7469%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.1725, Accuracy: 7119/10000 (71.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 2239/2510 (89.2032%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.4279, Accuracy: 8645/10000 (86.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 12, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4181/4373 (95.6094%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.8343, Accuracy: 4845/10000 (48.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 13, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4045/4339 (93.2242%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.4471, Accuracy: 6271/10000 (62.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2488/2782 (89.4321%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.6230, Accuracy: 6235/10000 (62.3500%), Attack Success Rate:0/10000(0.000)
time spent on training: 364.39357590675354
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.39111438 1.
 0.27436    0.         0.         0.97381674 1.         1.
 1.         1.         0.39111438]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 1.0059, Accuracy: 6714/10000 (67.1400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.9679, Accuracy: 6657/8991 (74.0407%)
Done in 393.1144549846649 sec.
Server Epoch:39 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  39, local model 0, internal_epoch   1,  Average loss: 0.0087, Accuracy: 2597/3010 (86.2791%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.9031, Accuracy: 7147/10000 (71.4700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 1, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5461/5805 (94.0741%), train_poison_data_count: 5805
Global model norm: 14.19145732254091.
Norm before scaling: 13.752851155923713. Distance: 1.6940473767020532
Total norm for 5 adversaries is: 13.752851155923713. distance: 1.6940473767020532
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.4725, Accuracy: 5610/8991 (62.3957%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4419/4779 (92.4670%), train_poison_data_count: 4779
Global model norm: 14.19145732254091.
Norm before scaling: 13.968169402957804. Distance: 1.7066272109035587
Total norm for 5 adversaries is: 13.968169402957804. distance: 1.7066272109035587
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.3729, Accuracy: 7897/8991 (87.8323%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4704/5123 (91.8212%), train_poison_data_count: 5123
Global model norm: 14.19145732254091.
Norm before scaling: 13.92059477839848. Distance: 1.798284027948636
Total norm for 5 adversaries is: 13.92059477839848. distance: 1.798284027948636
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.4352, Accuracy: 7690/8991 (85.5300%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 4, internal_epoch   1,  Average loss: 0.0063, Accuracy: 4029/4462 (90.2958%), train_poison_data_count: 4462
Global model norm: 14.19145732254091.
Norm before scaling: 13.997428112850377. Distance: 1.6635081482697165
Total norm for 5 adversaries is: 13.997428112850377. distance: 1.6635081482697165
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.8487, Accuracy: 6911/8991 (76.8658%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3612/3841 (94.0380%), train_poison_data_count: 3841
Global model norm: 14.19145732254091.
Norm before scaling: 14.00946978048325. Distance: 1.3699811023606112
Total norm for 5 adversaries is: 14.00946978048325. distance: 1.3699811023606112
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.5894, Accuracy: 6287/8991 (69.9255%)
___Train Local_Simple,  epoch  39, local model 6, internal_epoch   1,  Average loss: 0.0070, Accuracy: 2629/2945 (89.2699%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.8520, Accuracy: 7534/10000 (75.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 7, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2559/2756 (92.8520%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.0328, Accuracy: 7140/10000 (71.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 8, internal_epoch   1,  Average loss: 0.0082, Accuracy: 2995/3437 (87.1399%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4477, Accuracy: 8507/10000 (85.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 9, internal_epoch   1,  Average loss: 0.0045, Accuracy: 5422/5809 (93.3379%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.5551, Accuracy: 5983/10000 (59.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 10, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2419/2592 (93.3256%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.2355, Accuracy: 6819/10000 (68.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 11, internal_epoch   1,  Average loss: 0.0077, Accuracy: 2236/2510 (89.0837%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5684, Accuracy: 8002/10000 (80.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 12, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4189/4373 (95.7924%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 2.1256, Accuracy: 4400/10000 (44.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4073/4339 (93.8696%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.2654, Accuracy: 7126/10000 (71.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2497/2782 (89.7556%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.6477, Accuracy: 6244/10000 (62.4400%), Attack Success Rate:0/10000(0.000)
time spent on training: 365.51052021980286
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.80534582 0.99324875
 0.54220939 0.         0.         1.         1.         0.74622291
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.9731, Accuracy: 6797/10000 (67.9700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.9269, Accuracy: 6753/8991 (75.1084%)
Done in 395.03603982925415 sec.
Server Epoch:40 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  40, local model 0, internal_epoch   1,  Average loss: 0.0087, Accuracy: 2605/3010 (86.5449%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.7728, Accuracy: 7862/10000 (78.6200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 1, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5471/5805 (94.2463%), train_poison_data_count: 5805
Global model norm: 14.203321063175077.
Norm before scaling: 13.752049518773443. Distance: 1.6693581148162697
Total norm for 5 adversaries is: 13.752049518773443. distance: 1.6693581148162697
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 1.3184, Accuracy: 5971/8991 (66.4109%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 2, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4398/4779 (92.0276%), train_poison_data_count: 4779
Global model norm: 14.203321063175077.
Norm before scaling: 13.982525955795404. Distance: 1.690137497426801
Total norm for 5 adversaries is: 13.982525955795404. distance: 1.690137497426801
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.2819, Accuracy: 8226/8991 (91.4915%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   1,  Average loss: 0.0058, Accuracy: 4705/5123 (91.8407%), train_poison_data_count: 5123
Global model norm: 14.203321063175077.
Norm before scaling: 13.93651847633443. Distance: 1.7772629268839895
Total norm for 5 adversaries is: 13.93651847633443. distance: 1.7772629268839895
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.5820, Accuracy: 7348/8991 (81.7262%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4046/4462 (90.6768%), train_poison_data_count: 4462
Global model norm: 14.203321063175077.
Norm before scaling: 14.001486018197262. Distance: 1.6395728234128322
Total norm for 5 adversaries is: 14.001486018197262. distance: 1.6395728234128322
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.8047, Accuracy: 6979/8991 (77.6221%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3605/3841 (93.8558%), train_poison_data_count: 3841
Global model norm: 14.203321063175077.
Norm before scaling: 14.008212269462799. Distance: 1.3215777412378182
Total norm for 5 adversaries is: 14.008212269462799. distance: 1.3215777412378182
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 1.4867, Accuracy: 6574/8991 (73.1176%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0067, Accuracy: 2651/2945 (90.0170%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.8973, Accuracy: 7241/10000 (72.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 7, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2549/2756 (92.4891%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.1984, Accuracy: 6690/10000 (66.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3011/3437 (87.6055%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.4264, Accuracy: 8691/10000 (86.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5448/5809 (93.7855%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.7040, Accuracy: 5885/10000 (58.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2425/2592 (93.5571%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.0397, Accuracy: 7252/10000 (72.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0077, Accuracy: 2249/2510 (89.6016%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5155, Accuracy: 8222/10000 (82.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4184/4373 (95.6780%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.5924, Accuracy: 5820/10000 (58.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4069/4339 (93.7774%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.3730, Accuracy: 6250/10000 (62.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 14, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2526/2782 (90.7980%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.7005, Accuracy: 6138/10000 (61.3800%), Attack Success Rate:0/10000(0.000)
time spent on training: 369.24875020980835
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.67475507
 0.         0.         0.         1.         0.97264763 1.
 1.         1.         0.        ]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.9489, Accuracy: 6841/10000 (68.4100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.9056, Accuracy: 6778/8991 (75.3865%)
Done in 398.2751181125641 sec.
Server Epoch:41 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  41, local model 0, internal_epoch   1,  Average loss: 0.0089, Accuracy: 2578/3010 (85.6478%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.8008, Accuracy: 7317/10000 (73.1700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 1, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5451/5805 (93.9018%), train_poison_data_count: 5805
Global model norm: 14.210869854498153.
Norm before scaling: 13.754554133064948. Distance: 1.665046866390253
Total norm for 5 adversaries is: 13.754554133064948. distance: 1.665046866390253
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 1.3616, Accuracy: 5762/8991 (64.0863%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 2, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4398/4779 (92.0276%), train_poison_data_count: 4779
Global model norm: 14.210869854498153.
Norm before scaling: 13.990073908623572. Distance: 1.677337848313587
Total norm for 5 adversaries is: 13.990073908623572. distance: 1.677337848313587
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.3623, Accuracy: 7918/8991 (88.0658%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4739/5123 (92.5044%), train_poison_data_count: 5123
Global model norm: 14.210869854498153.
Norm before scaling: 13.914077304701557. Distance: 1.6948745794790199
Total norm for 5 adversaries is: 13.914077304701557. distance: 1.6948745794790199
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.5235, Accuracy: 7442/8991 (82.7717%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 4045/4462 (90.6544%), train_poison_data_count: 4462
Global model norm: 14.210869854498153.
Norm before scaling: 14.004598134930486. Distance: 1.614301234386506
Total norm for 5 adversaries is: 14.004598134930486. distance: 1.614301234386506
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.8357, Accuracy: 6847/8991 (76.1539%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 5, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3596/3841 (93.6215%), train_poison_data_count: 3841
Global model norm: 14.210869854498153.
Norm before scaling: 14.019917624934925. Distance: 1.335672452634372
Total norm for 5 adversaries is: 14.019917624934925. distance: 1.335672452634372
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 1.3505, Accuracy: 6602/8991 (73.4290%)
___Train Local_Simple,  epoch  41, local model 6, internal_epoch   1,  Average loss: 0.0066, Accuracy: 2640/2945 (89.6435%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.7824, Accuracy: 7509/10000 (75.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2568/2756 (93.1785%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.9859, Accuracy: 7324/10000 (73.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 8, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3041/3437 (88.4783%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4936, Accuracy: 8317/10000 (83.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 9, internal_epoch   1,  Average loss: 0.0041, Accuracy: 5470/5809 (94.1642%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.7626, Accuracy: 5522/10000 (55.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2414/2592 (93.1327%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.2876, Accuracy: 6630/10000 (66.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 2238/2510 (89.1633%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.4755, Accuracy: 8024/10000 (80.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 12, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4186/4373 (95.7238%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.9455, Accuracy: 4953/10000 (49.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 13, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4076/4339 (93.9387%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.3864, Accuracy: 6536/10000 (65.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 14, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2510/2782 (90.2229%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.4865, Accuracy: 6221/10000 (62.2100%), Attack Success Rate:0/10000(0.000)
time spent on training: 376.04936003685
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.05755102 0.05755102 0.32588664 0.26243019
 0.19537153 0.         0.         0.81291511 0.93803338 0.20410361
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.9273, Accuracy: 6882/10000 (68.8200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.8816, Accuracy: 6821/8991 (75.8648%)
Done in 404.39954900741577 sec.
Server Epoch:42 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  42, local model 0, internal_epoch   1,  Average loss: 0.0082, Accuracy: 2620/3010 (87.0432%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.9646, Accuracy: 6873/10000 (68.7300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 1, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5479/5805 (94.3842%), train_poison_data_count: 5805
Global model norm: 14.218818681152806.
Norm before scaling: 13.757824145544475. Distance: 1.6303076261886624
Total norm for 5 adversaries is: 13.757824145544475. distance: 1.6303076261886624
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 1.1308, Accuracy: 6173/8991 (68.6575%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 2, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4403/4779 (92.1322%), train_poison_data_count: 4779
Global model norm: 14.218818681152806.
Norm before scaling: 13.996508026592796. Distance: 1.6989404910905048
Total norm for 5 adversaries is: 13.996508026592796. distance: 1.6989404910905048
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.3611, Accuracy: 7917/8991 (88.0547%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4759/5123 (92.8948%), train_poison_data_count: 5123
Global model norm: 14.218818681152806.
Norm before scaling: 13.923464152426517. Distance: 1.6877314091007303
Total norm for 5 adversaries is: 13.923464152426517. distance: 1.6877314091007303
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.5625, Accuracy: 7346/8991 (81.7039%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 4, internal_epoch   1,  Average loss: 0.0060, Accuracy: 4030/4462 (90.3182%), train_poison_data_count: 4462
Global model norm: 14.218818681152806.
Norm before scaling: 13.996469324956674. Distance: 1.5665569280513503
Total norm for 5 adversaries is: 13.996469324956674. distance: 1.5665569280513503
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.7627, Accuracy: 7045/8991 (78.3561%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3625/3841 (94.3765%), train_poison_data_count: 3841
Global model norm: 14.218818681152806.
Norm before scaling: 14.007104433442873. Distance: 1.256986026649832
Total norm for 5 adversaries is: 14.007104433442873. distance: 1.256986026649832
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 1.3601, Accuracy: 6527/8991 (72.5948%)
___Train Local_Simple,  epoch  42, local model 6, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2635/2945 (89.4737%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.8095, Accuracy: 7661/10000 (76.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2568/2756 (93.1785%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.0142, Accuracy: 7061/10000 (70.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 8, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3045/3437 (88.5947%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4265, Accuracy: 8583/10000 (85.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 9, internal_epoch   1,  Average loss: 0.0042, Accuracy: 5464/5809 (94.0609%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 2.2007, Accuracy: 5284/10000 (52.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 2437/2592 (94.0201%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.3217, Accuracy: 6269/10000 (62.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 2250/2510 (89.6414%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4317, Accuracy: 8518/10000 (85.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 12, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4201/4373 (96.0668%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.6774, Accuracy: 5620/10000 (56.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4086/4339 (94.1692%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.2732, Accuracy: 6748/10000 (67.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 14, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2554/2782 (91.8045%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.5837, Accuracy: 6190/10000 (61.9000%), Attack Success Rate:0/10000(0.000)
time spent on training: 383.66058802604675
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.33481445 1.
 0.52083176 0.         0.         0.95473325 0.92176963 0.62922343
 1.         1.         0.3420929 ]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.9001, Accuracy: 6967/10000 (69.6700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.8500, Accuracy: 6903/8991 (76.7768%)
Done in 412.1343619823456 sec.
Server Epoch:43 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  43, local model 0, internal_epoch   1,  Average loss: 0.0081, Accuracy: 2630/3010 (87.3754%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.7289, Accuracy: 7894/10000 (78.9400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5487/5805 (94.5220%), train_poison_data_count: 5805
Global model norm: 14.227997507939671.
Norm before scaling: 13.758447999589993. Distance: 1.5984333265740438
Total norm for 5 adversaries is: 13.758447999589993. distance: 1.5984333265740438
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 1.2544, Accuracy: 5927/8991 (65.9215%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 2, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4409/4779 (92.2578%), train_poison_data_count: 4779
Global model norm: 14.227997507939671.
Norm before scaling: 13.97168647913662. Distance: 1.58575746613702
Total norm for 5 adversaries is: 13.97168647913662. distance: 1.58575746613702
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.3449, Accuracy: 8000/8991 (88.9779%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4737/5123 (92.4654%), train_poison_data_count: 5123
Global model norm: 14.227997507939671.
Norm before scaling: 13.936522855846198. Distance: 1.693589842709376
Total norm for 5 adversaries is: 13.936522855846198. distance: 1.693589842709376
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.6068, Accuracy: 7309/8991 (81.2924%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 4, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4096/4462 (91.7974%), train_poison_data_count: 4462
Global model norm: 14.227997507939671.
Norm before scaling: 13.992397969173632. Distance: 1.48716778291031
Total norm for 5 adversaries is: 13.992397969173632. distance: 1.48716778291031
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.7607, Accuracy: 7054/8991 (78.4562%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 5, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3608/3841 (93.9339%), train_poison_data_count: 3841
Global model norm: 14.227997507939671.
Norm before scaling: 14.02173181217981. Distance: 1.2916443833100508
Total norm for 5 adversaries is: 14.02173181217981. distance: 1.2916443833100508
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 1.2735, Accuracy: 6344/8991 (70.5594%)
___Train Local_Simple,  epoch  43, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2673/2945 (90.7640%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.7677, Accuracy: 7526/10000 (75.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 7, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2569/2756 (93.2148%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.0292, Accuracy: 7171/10000 (71.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 8, internal_epoch   1,  Average loss: 0.0075, Accuracy: 3037/3437 (88.3619%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5928, Accuracy: 8010/10000 (80.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5457/5809 (93.9404%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.0578, Accuracy: 5351/10000 (53.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 10, internal_epoch   1,  Average loss: 0.0041, Accuracy: 2425/2592 (93.5571%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.0871, Accuracy: 7047/10000 (70.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 2252/2510 (89.7211%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.4961, Accuracy: 8431/10000 (84.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 12, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4167/4373 (95.2893%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 2.1071, Accuracy: 5096/10000 (50.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4099/4339 (94.4688%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.3189, Accuracy: 6540/10000 (65.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 14, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2536/2782 (91.1574%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.5069, Accuracy: 6254/10000 (62.5400%), Attack Success Rate:0/10000(0.000)
time spent on training: 383.4226679801941
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.01701547 0.         0.         0.         1.         1.
 0.68585957 0.         0.01701547 1.         1.         0.88421969
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.8664, Accuracy: 7073/10000 (70.7300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.8076, Accuracy: 7010/8991 (77.9669%)
Done in 411.76531529426575 sec.
Server Epoch:44 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  44, local model 0, internal_epoch   1,  Average loss: 0.0086, Accuracy: 2577/3010 (85.6146%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.7722, Accuracy: 7587/10000 (75.8700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5490/5805 (94.5736%), train_poison_data_count: 5805
Global model norm: 14.24025567157405.
Norm before scaling: 13.765771871556153. Distance: 1.5752613032519238
Total norm for 5 adversaries is: 13.765771871556153. distance: 1.5752613032519238
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.2304, Accuracy: 6021/8991 (66.9670%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 2, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4426/4779 (92.6135%), train_poison_data_count: 4779
Global model norm: 14.24025567157405.
Norm before scaling: 13.996425172255202. Distance: 1.5924258996081413
Total norm for 5 adversaries is: 13.996425172255202. distance: 1.5924258996081413
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.3048, Accuracy: 8128/8991 (90.4015%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   1,  Average loss: 0.0053, Accuracy: 4750/5123 (92.7191%), train_poison_data_count: 5123
Global model norm: 14.24025567157405.
Norm before scaling: 13.931448816016275. Distance: 1.6347804279637062
Total norm for 5 adversaries is: 13.931448816016275. distance: 1.6347804279637062
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.6140, Accuracy: 7332/8991 (81.5482%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4089/4462 (91.6405%), train_poison_data_count: 4462
Global model norm: 14.24025567157405.
Norm before scaling: 14.002053791354202. Distance: 1.4900730190690632
Total norm for 5 adversaries is: 14.002053791354202. distance: 1.4900730190690632
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.7436, Accuracy: 6949/8991 (77.2884%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 5, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3643/3841 (94.8451%), train_poison_data_count: 3841
Global model norm: 14.24025567157405.
Norm before scaling: 14.013234014283158. Distance: 1.191347864940445
Total norm for 5 adversaries is: 14.013234014283158. distance: 1.191347864940445
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.4487, Accuracy: 6605/8991 (73.4624%)
___Train Local_Simple,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2674/2945 (90.7980%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.7154, Accuracy: 7588/10000 (75.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 7, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2582/2756 (93.6865%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.0104, Accuracy: 7218/10000 (72.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 8, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3058/3437 (88.9729%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6291, Accuracy: 8062/10000 (80.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 5476/5809 (94.2675%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.1257, Accuracy: 5037/10000 (50.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2436/2592 (93.9815%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.3645, Accuracy: 6160/10000 (61.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 2259/2510 (90.0000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.4244, Accuracy: 8472/10000 (84.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 12, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4197/4373 (95.9753%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 2.5752, Accuracy: 4124/10000 (41.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4070/4339 (93.8004%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.2967, Accuracy: 6312/10000 (63.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 14, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2505/2782 (90.0431%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.2994, Accuracy: 6839/10000 (68.3900%), Attack Success Rate:0/10000(0.000)
time spent on training: 390.84478187561035
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.34747317 0.2486609
 0.         0.         0.         0.98767577 0.15530304 0.48181349
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.8495, Accuracy: 7115/10000 (71.1500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.7883, Accuracy: 7054/8991 (78.4562%)
Done in 419.6527507305145 sec.
Server Epoch:45 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  45, local model 0, internal_epoch   1,  Average loss: 0.0082, Accuracy: 2591/3010 (86.0797%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.7388, Accuracy: 7455/10000 (74.5500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5484/5805 (94.4703%), train_poison_data_count: 5805
Global model norm: 14.247231197736555.
Norm before scaling: 13.781616482868015. Distance: 1.5900513609502036
Total norm for 5 adversaries is: 13.781616482868015. distance: 1.5900513609502036
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 1.2007, Accuracy: 6097/8991 (67.8123%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 2, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4408/4779 (92.2369%), train_poison_data_count: 4779
Global model norm: 14.247231197736555.
Norm before scaling: 13.99529078163437. Distance: 1.5867797419115295
Total norm for 5 adversaries is: 13.99529078163437. distance: 1.5867797419115295
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.2421, Accuracy: 8314/8991 (92.4702%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 4716/5123 (92.0554%), train_poison_data_count: 5123
Global model norm: 14.247231197736555.
Norm before scaling: 13.958542065933868. Distance: 1.7024584524543833
Total norm for 5 adversaries is: 13.958542065933868. distance: 1.7024584524543833
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.4674, Accuracy: 7545/8991 (83.9173%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 4, internal_epoch   1,  Average loss: 0.0059, Accuracy: 4044/4462 (90.6320%), train_poison_data_count: 4462
Global model norm: 14.247231197736555.
Norm before scaling: 14.025862103245483. Distance: 1.5396775309334987
Total norm for 5 adversaries is: 14.025862103245483. distance: 1.5396775309334987
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.6534, Accuracy: 7196/8991 (80.0356%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3620/3841 (94.2463%), train_poison_data_count: 3841
Global model norm: 14.247231197736555.
Norm before scaling: 14.034374543357542. Distance: 1.2490856164125024
Total norm for 5 adversaries is: 14.034374543357542. distance: 1.2490856164125024
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 1.3212, Accuracy: 6641/8991 (73.8628%)
___Train Local_Simple,  epoch  45, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2686/2945 (91.2054%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.7426, Accuracy: 7673/10000 (76.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 7, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2558/2756 (92.8157%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.7969, Accuracy: 7679/10000 (76.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 8, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3056/3437 (88.9148%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4649, Accuracy: 8316/10000 (83.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 5461/5809 (94.0093%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 2.0308, Accuracy: 5422/10000 (54.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 2439/2592 (94.0972%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.1558, Accuracy: 6610/10000 (66.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2264/2510 (90.1992%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3624, Accuracy: 8917/10000 (89.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 12, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4202/4373 (96.0896%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.9063, Accuracy: 5000/10000 (50.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 13, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4097/4339 (94.4227%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.2548, Accuracy: 6643/10000 (66.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 14, internal_epoch   1,  Average loss: 0.0058, Accuracy: 2499/2782 (89.8275%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.4865, Accuracy: 6099/10000 (60.9900%), Attack Success Rate:0/10000(0.000)
time spent on training: 393.53490591049194
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.33308301 0.         0.         0.         0.25655139 1.
 0.41874744 0.         0.33308301 0.25655139 0.96057112 0.68561308
 1.         1.         0.65822155]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.8212, Accuracy: 7197/10000 (71.9700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.7620, Accuracy: 7103/8991 (79.0012%)
Done in 421.86085200309753 sec.
Server Epoch:46 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  46, local model 0, internal_epoch   1,  Average loss: 0.0078, Accuracy: 2627/3010 (87.2757%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6353, Accuracy: 8176/10000 (81.7600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5507/5805 (94.8665%), train_poison_data_count: 5805
Global model norm: 14.256204960746478.
Norm before scaling: 13.778832740455671. Distance: 1.5364580919513404
Total norm for 5 adversaries is: 13.778832740455671. distance: 1.5364580919513404
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 1.1905, Accuracy: 6013/8991 (66.8780%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4438/4779 (92.8646%), train_poison_data_count: 4779
Global model norm: 14.256204960746478.
Norm before scaling: 13.998087616141703. Distance: 1.5295049883838125
Total norm for 5 adversaries is: 13.998087616141703. distance: 1.5295049883838125
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.3462, Accuracy: 7988/8991 (88.8444%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4773/5123 (93.1681%), train_poison_data_count: 5123
Global model norm: 14.256204960746478.
Norm before scaling: 13.943877946171732. Distance: 1.609099947933874
Total norm for 5 adversaries is: 13.943877946171732. distance: 1.609099947933874
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.6006, Accuracy: 7345/8991 (81.6928%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 4091/4462 (91.6853%), train_poison_data_count: 4462
Global model norm: 14.256204960746478.
Norm before scaling: 14.019108402128325. Distance: 1.4850535397880398
Total norm for 5 adversaries is: 14.019108402128325. distance: 1.4850535397880398
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.6740, Accuracy: 7189/8991 (79.9577%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 5, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3642/3841 (94.8191%), train_poison_data_count: 3841
Global model norm: 14.256204960746478.
Norm before scaling: 14.02711422466074. Distance: 1.1818109058609647
Total norm for 5 adversaries is: 14.02711422466074. distance: 1.1818109058609647
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 1.4485, Accuracy: 6558/8991 (72.9396%)
___Train Local_Simple,  epoch  46, local model 6, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2661/2945 (90.3565%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.7175, Accuracy: 7841/10000 (78.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2581/2756 (93.6502%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.1212, Accuracy: 6779/10000 (67.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3084/3437 (89.7294%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3616, Accuracy: 8717/10000 (87.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 9, internal_epoch   1,  Average loss: 0.0038, Accuracy: 5471/5809 (94.1814%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.9370, Accuracy: 5718/10000 (57.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2437/2592 (94.0201%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.9867, Accuracy: 7003/10000 (70.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2281/2510 (90.8765%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4509, Accuracy: 8494/10000 (84.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 12, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4208/4373 (96.2268%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.7030, Accuracy: 5249/10000 (52.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4104/4339 (94.5840%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.2283, Accuracy: 6779/10000 (67.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2547/2782 (91.5528%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.5065, Accuracy: 6468/10000 (64.6800%), Attack Success Rate:0/10000(0.000)
time spent on training: 400.00371193885803
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.02204441 0.02204441 0.34649263 0.58265832
 0.10977654 0.         0.         0.34649263 1.         0.9136457
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.7995, Accuracy: 7245/10000 (72.4500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.7386, Accuracy: 7144/8991 (79.4572%)
Done in 428.3136510848999 sec.
Server Epoch:47 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  47, local model 0, internal_epoch   1,  Average loss: 0.0075, Accuracy: 2663/3010 (88.4718%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6855, Accuracy: 7988/10000 (79.8800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 1, internal_epoch   1,  Average loss: 0.0035, Accuracy: 5515/5805 (95.0043%), train_poison_data_count: 5805
Global model norm: 14.263955226415003.
Norm before scaling: 13.769994451428904. Distance: 1.508018202907071
Total norm for 5 adversaries is: 13.769994451428904. distance: 1.508018202907071
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 1.4011, Accuracy: 5786/8991 (64.3532%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 2, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4441/4779 (92.9274%), train_poison_data_count: 4779
Global model norm: 14.263955226415003.
Norm before scaling: 13.995738334518844. Distance: 1.5064855082790087
Total norm for 5 adversaries is: 13.995738334518844. distance: 1.5064855082790087
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.3203, Accuracy: 8025/8991 (89.2559%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4765/5123 (93.0119%), train_poison_data_count: 5123
Global model norm: 14.263955226415003.
Norm before scaling: 13.93436030446775. Distance: 1.5741443853112347
Total norm for 5 adversaries is: 13.93436030446775. distance: 1.5741443853112347
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.3949, Accuracy: 7862/8991 (87.4430%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4094/4462 (91.7526%), train_poison_data_count: 4462
Global model norm: 14.263955226415003.
Norm before scaling: 14.009608105250315. Distance: 1.4347007697340715
Total norm for 5 adversaries is: 14.009608105250315. distance: 1.4347007697340715
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.7181, Accuracy: 7108/8991 (79.0568%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3639/3841 (94.7410%), train_poison_data_count: 3841
Global model norm: 14.263955226415003.
Norm before scaling: 14.045800088356316. Distance: 1.2174603412286578
Total norm for 5 adversaries is: 14.045800088356316. distance: 1.2174603412286578
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 1.4971, Accuracy: 6524/8991 (72.5615%)
___Train Local_Simple,  epoch  47, local model 6, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2693/2945 (91.4431%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6422, Accuracy: 8067/10000 (80.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2600/2756 (94.3396%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.9134, Accuracy: 7450/10000 (74.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3091/3437 (89.9331%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3414, Accuracy: 8852/10000 (88.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 9, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5483/5809 (94.3880%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.7563, Accuracy: 5770/10000 (57.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2441/2592 (94.1744%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.0621, Accuracy: 6921/10000 (69.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2275/2510 (90.6375%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.4341, Accuracy: 8574/10000 (85.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 12, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4229/4373 (96.7071%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.7832, Accuracy: 5349/10000 (53.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4092/4339 (94.3074%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.2689, Accuracy: 6708/10000 (67.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 14, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2547/2782 (91.5528%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.7175, Accuracy: 5806/10000 (58.0600%), Attack Success Rate:0/10000(0.000)
time spent on training: 404.4807162284851
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.20193964 0.         0.         0.46712008 0.58433666
 0.35711189 0.         0.         0.92740575 0.9839857  0.48027111
 1.         1.         0.53655327]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.7749, Accuracy: 7300/10000 (73.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.7125, Accuracy: 7191/8991 (79.9800%)
Done in 432.87637400627136 sec.
Server Epoch:48 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  48, local model 0, internal_epoch   1,  Average loss: 0.0077, Accuracy: 2645/3010 (87.8738%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.7035, Accuracy: 7645/10000 (76.4500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5529/5805 (95.2455%), train_poison_data_count: 5805
Global model norm: 14.272184002669482.
Norm before scaling: 13.768182558062936. Distance: 1.4474155281468433
Total norm for 5 adversaries is: 13.768182558062936. distance: 1.4474155281468433
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1.0432, Accuracy: 6362/8991 (70.7596%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 2, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4441/4779 (92.9274%), train_poison_data_count: 4779
Global model norm: 14.272184002669482.
Norm before scaling: 14.001331266050371. Distance: 1.519414902182335
Total norm for 5 adversaries is: 14.001331266050371. distance: 1.519414902182335
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.3296, Accuracy: 8024/8991 (89.2448%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4758/5123 (92.8753%), train_poison_data_count: 5123
Global model norm: 14.272184002669482.
Norm before scaling: 13.939592007723787. Distance: 1.560378656403978
Total norm for 5 adversaries is: 13.939592007723787. distance: 1.560378656403978
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.4469, Accuracy: 7542/8991 (83.8839%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4084/4462 (91.5285%), train_poison_data_count: 4462
Global model norm: 14.272184002669482.
Norm before scaling: 14.030247845788677. Distance: 1.4538948726875085
Total norm for 5 adversaries is: 14.030247845788677. distance: 1.4538948726875085
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.6619, Accuracy: 7235/8991 (80.4694%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3649/3841 (95.0013%), train_poison_data_count: 3841
Global model norm: 14.272184002669482.
Norm before scaling: 14.022776468577659. Distance: 1.1161014640036315
Total norm for 5 adversaries is: 14.022776468577659. distance: 1.1161014640036315
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1.2569, Accuracy: 6612/8991 (73.5402%)
___Train Local_Simple,  epoch  48, local model 6, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2689/2945 (91.3073%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.7177, Accuracy: 8044/10000 (80.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 7, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2592/2756 (94.0493%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.9611, Accuracy: 7197/10000 (71.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 8, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3078/3437 (89.5548%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.7584, Accuracy: 7613/10000 (76.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 9, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5482/5809 (94.3708%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.6252, Accuracy: 6011/10000 (60.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 10, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2435/2592 (93.9429%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.9325, Accuracy: 7274/10000 (72.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2258/2510 (89.9602%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.4821, Accuracy: 8168/10000 (81.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 12, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4213/4373 (96.3412%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.5435, Accuracy: 5949/10000 (59.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4088/4339 (94.2153%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.1318, Accuracy: 6891/10000 (68.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2567/2782 (92.2717%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.2709, Accuracy: 6998/10000 (69.9800%), Attack Success Rate:0/10000(0.000)
time spent on training: 409.1476900577545
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.54789424 0.4683374  0.         0.         0.30065963 1.
 0.50174916 0.71190488 0.54789424 1.         1.         0.50174916
 1.         1.         0.30065963]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.7413, Accuracy: 7385/10000 (73.8500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.6766, Accuracy: 7261/8991 (80.7585%)
Done in 437.45999789237976 sec.
Server Epoch:49 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  49, local model 0, internal_epoch   1,  Average loss: 0.0075, Accuracy: 2634/3010 (87.5083%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.7579, Accuracy: 7496/10000 (74.9600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5528/5805 (95.2283%), train_poison_data_count: 5805
Global model norm: 14.283542707786337.
Norm before scaling: 13.786243736327233. Distance: 1.4555879455016945
Total norm for 5 adversaries is: 13.786243736327233. distance: 1.4555879455016945
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 1.4255, Accuracy: 5856/8991 (65.1318%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4464/4779 (93.4087%), train_poison_data_count: 4779
Global model norm: 14.283542707786337.
Norm before scaling: 14.0053896747433. Distance: 1.4756425686363566
Total norm for 5 adversaries is: 14.0053896747433. distance: 1.4756425686363566
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.3697, Accuracy: 7941/8991 (88.3217%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4772/5123 (93.1485%), train_poison_data_count: 5123
Global model norm: 14.283542707786337.
Norm before scaling: 13.942498512480029. Distance: 1.5138055951519436
Total norm for 5 adversaries is: 13.942498512480029. distance: 1.5138055951519436
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.3601, Accuracy: 7828/8991 (87.0648%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 4, internal_epoch   1,  Average loss: 0.0051, Accuracy: 4113/4462 (92.1784%), train_poison_data_count: 4462
Global model norm: 14.283542707786337.
Norm before scaling: 14.011684446396536. Distance: 1.3833209466188134
Total norm for 5 adversaries is: 14.011684446396536. distance: 1.3833209466188134
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.6783, Accuracy: 7142/8991 (79.4350%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3651/3841 (95.0534%), train_poison_data_count: 3841
Global model norm: 14.283542707786337.
Norm before scaling: 14.035763428802042. Distance: 1.114215285002002
Total norm for 5 adversaries is: 14.035763428802042. distance: 1.114215285002002
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 1.1409, Accuracy: 6641/8991 (73.8628%)
___Train Local_Simple,  epoch  49, local model 6, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2720/2945 (92.3599%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.7177, Accuracy: 7813/10000 (78.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 7, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2597/2756 (94.2308%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.9086, Accuracy: 7522/10000 (75.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 8, internal_epoch   1,  Average loss: 0.0066, Accuracy: 3083/3437 (89.7003%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3099, Accuracy: 9054/10000 (90.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 9, internal_epoch   1,  Average loss: 0.0037, Accuracy: 5494/5809 (94.5774%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.9192, Accuracy: 5682/10000 (56.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2450/2592 (94.5216%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.0580, Accuracy: 7006/10000 (70.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 11, internal_epoch   1,  Average loss: 0.0064, Accuracy: 2292/2510 (91.3147%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.3922, Accuracy: 8783/10000 (87.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 12, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4222/4373 (96.5470%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.6419, Accuracy: 5185/10000 (51.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4109/4339 (94.6992%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.1152, Accuracy: 6760/10000 (67.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2570/2782 (92.3796%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.2584, Accuracy: 6673/10000 (66.7300%), Attack Success Rate:0/10000(0.000)
time spent on training: 414.24835681915283
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.42656399 0.30018048 0.07002943 0.28266749 0.51416414 1.
 0.07002943 0.30018048 0.42656399 1.         1.         0.5647998
 1.         1.         0.54632752]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.7163, Accuracy: 7448/10000 (74.4800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.6505, Accuracy: 7316/8991 (81.3703%)
Done in 442.4543151855469 sec.
Server Epoch:50 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0073, Accuracy: 2644/3010 (87.8405%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.7214, Accuracy: 7666/10000 (76.6600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5521/5805 (95.1077%), train_poison_data_count: 5805
Global model norm: 14.294255117707854.
Norm before scaling: 13.795601428513875. Distance: 1.4503165557219388
Total norm for 5 adversaries is: 13.795601428513875. distance: 1.4503165557219388
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 1.1290, Accuracy: 6163/8991 (68.5463%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 2, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4457/4779 (93.2622%), train_poison_data_count: 4779
Global model norm: 14.294255117707854.
Norm before scaling: 14.003455689230226. Distance: 1.4508726650970882
Total norm for 5 adversaries is: 14.003455689230226. distance: 1.4508726650970882
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.2614, Accuracy: 8277/8991 (92.0587%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4797/5123 (93.6365%), train_poison_data_count: 5123
Global model norm: 14.294255117707854.
Norm before scaling: 13.955649836303419. Distance: 1.515359049007547
Total norm for 5 adversaries is: 13.955649836303419. distance: 1.515359049007547
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.4860, Accuracy: 7549/8991 (83.9617%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4104/4462 (91.9767%), train_poison_data_count: 4462
Global model norm: 14.294255117707854.
Norm before scaling: 14.014964688842145. Distance: 1.3484680826513857
Total norm for 5 adversaries is: 14.014964688842145. distance: 1.3484680826513857
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.6943, Accuracy: 7209/8991 (80.1802%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3660/3841 (95.2877%), train_poison_data_count: 3841
Global model norm: 14.294255117707854.
Norm before scaling: 14.022793878858282. Distance: 1.0627287450157674
Total norm for 5 adversaries is: 14.022793878858282. distance: 1.0627287450157674
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 1.2150, Accuracy: 6552/8991 (72.8729%)
___Train Local_Simple,  epoch  50, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2685/2945 (91.1715%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.7813, Accuracy: 7508/10000 (75.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2600/2756 (94.3396%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.0434, Accuracy: 7134/10000 (71.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 8, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3094/3437 (90.0204%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.4112, Accuracy: 8552/10000 (85.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 5477/5809 (94.2847%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.6329, Accuracy: 5943/10000 (59.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2442/2592 (94.2130%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.8830, Accuracy: 7386/10000 (73.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2287/2510 (91.1155%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.4165, Accuracy: 8542/10000 (85.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 12, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4207/4373 (96.2040%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.3624, Accuracy: 5956/10000 (59.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4113/4339 (94.7914%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.1946, Accuracy: 6763/10000 (67.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 14, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2557/2782 (91.9123%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.5421, Accuracy: 6105/10000 (61.0500%), Attack Success Rate:0/10000(0.000)
time spent on training: 418.9324049949646
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.03031576 0.11179862 0.16632814 0.9242093
 0.03031576 0.         0.         0.8523319  1.         0.60967021
 1.         1.         0.92277974]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.6967, Accuracy: 7492/10000 (74.9200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 0.6311, Accuracy: 7348/8991 (81.7262%)
Done in 447.51711678504944 sec.
Server Epoch:51 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  51, local model 0, internal_epoch   1,  Average loss: 0.0072, Accuracy: 2656/3010 (88.2392%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.5847, Accuracy: 8272/10000 (82.7200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5529/5805 (95.2455%), train_poison_data_count: 5805
Global model norm: 14.3020455771344.
Norm before scaling: 13.803151000371708. Distance: 1.44352760418567
Total norm for 5 adversaries is: 13.803151000371708. distance: 1.44352760418567
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.9849, Accuracy: 6362/8991 (70.7596%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 2, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4443/4779 (92.9692%), train_poison_data_count: 4779
Global model norm: 14.3020455771344.
Norm before scaling: 14.007760757886869. Distance: 1.4536382117550566
Total norm for 5 adversaries is: 14.007760757886869. distance: 1.4536382117550566
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.2693, Accuracy: 8237/8991 (91.6138%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4787/5123 (93.4413%), train_poison_data_count: 5123
Global model norm: 14.3020455771344.
Norm before scaling: 13.950962834645926. Distance: 1.475989821050017
Total norm for 5 adversaries is: 13.950962834645926. distance: 1.475989821050017
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.4499, Accuracy: 7652/8991 (85.1073%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4135/4462 (92.6714%), train_poison_data_count: 4462
Global model norm: 14.3020455771344.
Norm before scaling: 14.02805351431162. Distance: 1.3552621469605992
Total norm for 5 adversaries is: 14.02805351431162. distance: 1.3552621469605992
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.6773, Accuracy: 7185/8991 (79.9132%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3661/3841 (95.3137%), train_poison_data_count: 3841
Global model norm: 14.3020455771344.
Norm before scaling: 14.030053714314942. Distance: 1.0683155225160794
Total norm for 5 adversaries is: 14.030053714314942. distance: 1.0683155225160794
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 1.1767, Accuracy: 6579/8991 (73.1732%)
___Train Local_Simple,  epoch  51, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2728/2945 (92.6316%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.7115, Accuracy: 8053/10000 (80.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 7, internal_epoch   1,  Average loss: 0.0041, Accuracy: 2592/2756 (94.0493%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.9035, Accuracy: 7249/10000 (72.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 8, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3072/3437 (89.3803%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4427, Accuracy: 8401/10000 (84.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5503/5809 (94.7323%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.8317, Accuracy: 5657/10000 (56.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 2450/2592 (94.5216%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.9739, Accuracy: 6941/10000 (69.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2313/2510 (92.1514%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3506, Accuracy: 8918/10000 (89.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 12, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4239/4373 (96.9357%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.3073, Accuracy: 6362/10000 (63.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4128/4339 (95.1371%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.4636, Accuracy: 6303/10000 (63.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2563/2782 (92.1280%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.3168, Accuracy: 6798/10000 (67.9800%), Attack Success Rate:0/10000(0.000)
time spent on training: 421.91241669654846
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.33082278 0.         0.11634836 0.11634836 1.         1.
 1.         0.         0.33082278 1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 0.6714, Accuracy: 7572/10000 (75.7200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 0.6019, Accuracy: 7424/8991 (82.5715%)
Done in 450.3677477836609 sec.
Server Epoch:52 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  52, local model 0, internal_epoch   1,  Average loss: 0.0069, Accuracy: 2671/3010 (88.7375%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6636, Accuracy: 7737/10000 (77.3700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5536/5805 (95.3661%), train_poison_data_count: 5805
Global model norm: 14.314731207431581.
Norm before scaling: 13.81222823898379. Distance: 1.4360916868495306
Total norm for 5 adversaries is: 13.81222823898379. distance: 1.4360916868495306
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 1.1230, Accuracy: 6058/8991 (67.3785%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4459/4779 (93.3040%), train_poison_data_count: 4779
Global model norm: 14.314731207431581.
Norm before scaling: 14.014769801284922. Distance: 1.3994271383586379
Total norm for 5 adversaries is: 14.014769801284922. distance: 1.3994271383586379
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.2245, Accuracy: 8395/8991 (93.3711%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4804/5123 (93.7732%), train_poison_data_count: 5123
Global model norm: 14.314731207431581.
Norm before scaling: 13.943134896506864. Distance: 1.4206221374133798
Total norm for 5 adversaries is: 13.943134896506864. distance: 1.4206221374133798
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.3407, Accuracy: 7863/8991 (87.4541%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4119/4462 (92.3129%), train_poison_data_count: 4462
Global model norm: 14.314731207431581.
Norm before scaling: 14.029935711518279. Distance: 1.3211401878781113
Total norm for 5 adversaries is: 14.029935711518279. distance: 1.3211401878781113
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.5634, Accuracy: 7291/8991 (81.0922%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 5, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3647/3841 (94.9492%), train_poison_data_count: 3841
Global model norm: 14.314731207431581.
Norm before scaling: 14.055591836178026. Distance: 1.0946491360400945
Total norm for 5 adversaries is: 14.055591836178026. distance: 1.0946491360400945
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 1.1226, Accuracy: 6540/8991 (72.7394%)
___Train Local_Simple,  epoch  52, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2733/2945 (92.8014%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6325, Accuracy: 7947/10000 (79.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 7, internal_epoch   1,  Average loss: 0.0035, Accuracy: 2625/2756 (95.2467%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.1295, Accuracy: 6819/10000 (68.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3107/3437 (90.3986%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3734, Accuracy: 8693/10000 (86.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5514/5809 (94.9217%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.7240, Accuracy: 5878/10000 (58.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 2455/2592 (94.7145%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.0742, Accuracy: 6981/10000 (69.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 2302/2510 (91.7131%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.4666, Accuracy: 8373/10000 (83.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 12, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4231/4373 (96.7528%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.5301, Accuracy: 5652/10000 (56.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4123/4339 (95.0219%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.1519, Accuracy: 6815/10000 (68.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 14, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2572/2782 (92.4515%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.3351, Accuracy: 6771/10000 (67.7100%), Attack Success Rate:0/10000(0.000)
time spent on training: 426.92635202407837
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.17652423 1.
 0.03798557 0.         0.         1.         1.         0.57971718
 1.         1.         0.40671773]
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 0.6623, Accuracy: 7576/10000 (75.7600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 0.5892, Accuracy: 7437/8991 (82.7160%)
Done in 455.16418409347534 sec.
Server Epoch:53 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  53, local model 0, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2669/3010 (88.6711%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6066, Accuracy: 8208/10000 (82.0800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5537/5805 (95.3833%), train_poison_data_count: 5805
Global model norm: 14.321898993202137.
Norm before scaling: 13.816272065188095. Distance: 1.4264769646529258
Total norm for 5 adversaries is: 13.816272065188095. distance: 1.4264769646529258
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 1.0738, Accuracy: 6220/8991 (69.1803%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 2, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4466/4779 (93.4505%), train_poison_data_count: 4779
Global model norm: 14.321898993202137.
Norm before scaling: 14.02872245469763. Distance: 1.413768927517442
Total norm for 5 adversaries is: 14.02872245469763. distance: 1.413768927517442
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.2454, Accuracy: 8268/8991 (91.9586%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4804/5123 (93.7732%), train_poison_data_count: 5123
Global model norm: 14.321898993202137.
Norm before scaling: 13.952249018905407. Distance: 1.399542132504925
Total norm for 5 adversaries is: 13.952249018905407. distance: 1.399542132504925
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.3431, Accuracy: 7999/8991 (88.9667%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 4, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4121/4462 (92.3577%), train_poison_data_count: 4462
Global model norm: 14.321898993202137.
Norm before scaling: 14.029149907216068. Distance: 1.301750578005263
Total norm for 5 adversaries is: 14.029149907216068. distance: 1.301750578005263
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.7162, Accuracy: 7131/8991 (79.3126%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 5, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3671/3841 (95.5741%), train_poison_data_count: 3841
Global model norm: 14.321898993202137.
Norm before scaling: 14.04255747398444. Distance: 1.0276778805500657
Total norm for 5 adversaries is: 14.04255747398444. distance: 1.0276778805500657
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 1.0754, Accuracy: 6650/8991 (73.9629%)
___Train Local_Simple,  epoch  53, local model 6, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2718/2945 (92.2920%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6672, Accuracy: 7806/10000 (78.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2607/2756 (94.5936%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.8087, Accuracy: 7647/10000 (76.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3138/3437 (91.3006%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3928, Accuracy: 8716/10000 (87.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5522/5809 (95.0594%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.5065, Accuracy: 6013/10000 (60.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2458/2592 (94.8302%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.8622, Accuracy: 7298/10000 (72.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 11, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2290/2510 (91.2351%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.5583, Accuracy: 8063/10000 (80.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 12, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4241/4373 (96.9815%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.4702, Accuracy: 5858/10000 (58.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4114/4339 (94.8145%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.1312, Accuracy: 6866/10000 (68.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2578/2782 (92.6671%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.4333, Accuracy: 6869/10000 (68.6900%), Attack Success Rate:0/10000(0.000)
time spent on training: 431.3836147785187
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.31534759 0.37193779
 0.15953996 0.         0.         0.32542168 1.         0.15953996
 1.         1.         0.9125797 ]
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 0.6489, Accuracy: 7616/10000 (76.1600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 0.5787, Accuracy: 7459/8991 (82.9607%)
Done in 459.5046660900116 sec.
Server Epoch:54 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  54, local model 0, internal_epoch   1,  Average loss: 0.0071, Accuracy: 2661/3010 (88.4053%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.5897, Accuracy: 8111/10000 (81.1100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 1, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5538/5805 (95.4005%), train_poison_data_count: 5805
Global model norm: 14.327231476024185.
Norm before scaling: 13.803697638004294. Distance: 1.408533234864645
Total norm for 5 adversaries is: 13.803697638004294. distance: 1.408533234864645
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 1.0439, Accuracy: 6304/8991 (70.1146%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4493/4779 (94.0155%), train_poison_data_count: 4779
Global model norm: 14.327231476024185.
Norm before scaling: 14.005371153331787. Distance: 1.3607908307827905
Total norm for 5 adversaries is: 14.005371153331787. distance: 1.3607908307827905
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.2634, Accuracy: 8243/8991 (91.6806%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4806/5123 (93.8122%), train_poison_data_count: 5123
Global model norm: 14.327231476024185.
Norm before scaling: 13.958820269996965. Distance: 1.420779466400319
Total norm for 5 adversaries is: 13.958820269996965. distance: 1.420779466400319
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.3962, Accuracy: 7843/8991 (87.2317%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 4, internal_epoch   1,  Average loss: 0.0049, Accuracy: 4115/4462 (92.2232%), train_poison_data_count: 4462
Global model norm: 14.327231476024185.
Norm before scaling: 14.034008137357413. Distance: 1.2891410572506008
Total norm for 5 adversaries is: 14.034008137357413. distance: 1.2891410572506008
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.6274, Accuracy: 7236/8991 (80.4805%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 5, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3644/3841 (94.8711%), train_poison_data_count: 3841
Global model norm: 14.327231476024185.
Norm before scaling: 14.040963326034538. Distance: 1.0681648704984716
Total norm for 5 adversaries is: 14.040963326034538. distance: 1.0681648704984716
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 1.0137, Accuracy: 6543/8991 (72.7728%)
___Train Local_Simple,  epoch  54, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2721/2945 (92.3939%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6194, Accuracy: 8162/10000 (81.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 7, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2609/2756 (94.6662%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.8819, Accuracy: 7479/10000 (74.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3105/3437 (90.3404%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.3541, Accuracy: 8796/10000 (87.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5521/5809 (95.0422%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.6022, Accuracy: 6093/10000 (60.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2461/2592 (94.9460%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.8087, Accuracy: 7314/10000 (73.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 11, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2306/2510 (91.8725%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.3468, Accuracy: 8938/10000 (89.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 12, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4227/4373 (96.6613%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.6874, Accuracy: 4932/10000 (49.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 13, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4107/4339 (94.6531%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.0197, Accuracy: 6897/10000 (68.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2579/2782 (92.7031%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.3461, Accuracy: 6818/10000 (68.1800%), Attack Success Rate:0/10000(0.000)
time spent on training: 436.8865339756012
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.19505813 1.
 0.24169028 0.         0.         0.19505813 0.9140259  0.44241177
 1.         1.         0.45263718]
___Test Target_Simple poisoned: False, epoch: 54: Average loss: 0.6367, Accuracy: 7648/10000 (76.4800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 54: Average loss: 0.5656, Accuracy: 7485/8991 (83.2499%)
Done in 465.2508807182312 sec.
Server Epoch:55 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  55, local model 0, internal_epoch   1,  Average loss: 0.0067, Accuracy: 2685/3010 (89.2027%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.7093, Accuracy: 7784/10000 (77.8400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  55, local model 1, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5527/5805 (95.2110%), train_poison_data_count: 5805
Global model norm: 14.332747218250436.
Norm before scaling: 13.810204224509363. Distance: 1.3813514534125082
Total norm for 5 adversaries is: 13.810204224509363. distance: 1.3813514534125082
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 1.0336, Accuracy: 6365/8991 (70.7930%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  55, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4471/4779 (93.5551%), train_poison_data_count: 4779
Global model norm: 14.332747218250436.
Norm before scaling: 14.024719757707338. Distance: 1.3727655027504468
Total norm for 5 adversaries is: 14.024719757707338. distance: 1.3727655027504468
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.2945, Accuracy: 8154/8991 (90.6907%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4811/5123 (93.9098%), train_poison_data_count: 5123
Global model norm: 14.332747218250436.
Norm before scaling: 13.960817273545002. Distance: 1.386799124953943
Total norm for 5 adversaries is: 13.960817273545002. distance: 1.386799124953943
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.2888, Accuracy: 8164/8991 (90.8019%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  55, local model 4, internal_epoch   1,  Average loss: 0.0046, Accuracy: 4149/4462 (92.9852%), train_poison_data_count: 4462
Global model norm: 14.332747218250436.
Norm before scaling: 14.029213534530756. Distance: 1.2744728980970952
Total norm for 5 adversaries is: 14.029213534530756. distance: 1.2744728980970952
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.6118, Accuracy: 7153/8991 (79.5573%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3689/3841 (96.0427%), train_poison_data_count: 3841
Global model norm: 14.332747218250436.
Norm before scaling: 14.040527539028536. Distance: 0.9966921037651468
Total norm for 5 adversaries is: 14.040527539028536. distance: 0.9966921037651468
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 1.2156, Accuracy: 6517/8991 (72.4836%)
___Train Local_Simple,  epoch  55, local model 6, internal_epoch   1,  Average loss: 0.0047, Accuracy: 2732/2945 (92.7674%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6777, Accuracy: 7881/10000 (78.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 7, internal_epoch   1,  Average loss: 0.0037, Accuracy: 2604/2756 (94.4848%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.8154, Accuracy: 7355/10000 (73.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 8, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3119/3437 (90.7477%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3690, Accuracy: 8906/10000 (89.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5510/5809 (94.8528%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.6110, Accuracy: 6025/10000 (60.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 10, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2466/2592 (95.1389%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.8187, Accuracy: 7466/10000 (74.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 11, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2292/2510 (91.3147%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.3786, Accuracy: 8717/10000 (87.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 12, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4221/4373 (96.5241%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.4104, Accuracy: 5793/10000 (57.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4134/4339 (95.2754%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.9712, Accuracy: 7016/10000 (70.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 14, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2558/2782 (91.9482%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.2612, Accuracy: 6984/10000 (69.8400%), Attack Success Rate:0/10000(0.000)
time spent on training: 441.00046372413635
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.14711026 0.03295779 0.         0.15140419 0.30026098 0.9077004
 0.         0.03295779 0.14711026 1.         1.         1.
 1.         1.         0.30026098]
___Test Target_Simple poisoned: False, epoch: 55: Average loss: 0.6228, Accuracy: 7684/10000 (76.8400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 55: Average loss: 0.5525, Accuracy: 7510/8991 (83.5280%)
Done in 469.3888130187988 sec.
Server Epoch:56 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  56, local model 0, internal_epoch   1,  Average loss: 0.0066, Accuracy: 2705/3010 (89.8671%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.5308, Accuracy: 8366/10000 (83.6600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  56, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5535/5805 (95.3488%), train_poison_data_count: 5805
Global model norm: 14.340561988278159.
Norm before scaling: 13.817615511117898. Distance: 1.3823956653344887
Total norm for 5 adversaries is: 13.817615511117898. distance: 1.3823956653344887
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 1.2173, Accuracy: 6086/8991 (67.6899%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  56, local model 2, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4482/4779 (93.7853%), train_poison_data_count: 4779
Global model norm: 14.340561988278159.
Norm before scaling: 14.014496518637351. Distance: 1.3189855374258421
Total norm for 5 adversaries is: 14.014496518637351. distance: 1.3189855374258421
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.2849, Accuracy: 8106/8991 (90.1568%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4805/5123 (93.7927%), train_poison_data_count: 5123
Global model norm: 14.340561988278159.
Norm before scaling: 13.951158613540176. Distance: 1.3530779594719864
Total norm for 5 adversaries is: 13.951158613540176. distance: 1.3530779594719864
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.4035, Accuracy: 7688/8991 (85.5077%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  56, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4147/4462 (92.9404%), train_poison_data_count: 4462
Global model norm: 14.340561988278159.
Norm before scaling: 14.032855037654045. Distance: 1.2599742154858844
Total norm for 5 adversaries is: 14.032855037654045. distance: 1.2599742154858844
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.7253, Accuracy: 6829/8991 (75.9537%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  56, local model 5, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3673/3841 (95.6261%), train_poison_data_count: 3841
Global model norm: 14.340561988278159.
Norm before scaling: 14.051846550524674. Distance: 1.0112581124941071
Total norm for 5 adversaries is: 14.051846550524674. distance: 1.0112581124941071
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.9481, Accuracy: 6917/8991 (76.9325%)
___Train Local_Simple,  epoch  56, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2755/2945 (93.5484%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6104, Accuracy: 8266/10000 (82.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 7, internal_epoch   1,  Average loss: 0.0035, Accuracy: 2613/2756 (94.8113%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.8790, Accuracy: 7321/10000 (73.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 8, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3089/3437 (89.8749%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.3632, Accuracy: 8743/10000 (87.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 9, internal_epoch   1,  Average loss: 0.0034, Accuracy: 5533/5809 (95.2488%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.4858, Accuracy: 6209/10000 (62.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 2469/2592 (95.2546%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.8316, Accuracy: 7345/10000 (73.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 11, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2327/2510 (92.7092%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.3491, Accuracy: 8758/10000 (87.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 12, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4242/4373 (97.0043%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.6848, Accuracy: 5329/10000 (53.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4123/4339 (95.0219%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.2842, Accuracy: 6663/10000 (66.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 14, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2579/2782 (92.7031%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.0933, Accuracy: 7224/10000 (72.2400%), Attack Success Rate:0/10000(0.000)
time spent on training: 443.5202100276947
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.16140262 0.30982169 0.30844445
 0.         0.         0.         1.         0.96764455 0.88287822
 1.         1.         0.30982169]
___Test Target_Simple poisoned: False, epoch: 56: Average loss: 0.6046, Accuracy: 7742/10000 (77.4200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 56: Average loss: 0.5398, Accuracy: 7545/8991 (83.9173%)
Done in 472.4866786003113 sec.
Server Epoch:57 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  57, local model 0, internal_epoch   1,  Average loss: 0.0071, Accuracy: 2661/3010 (88.4053%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.5996, Accuracy: 8037/10000 (80.3700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  57, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5562/5805 (95.8140%), train_poison_data_count: 5805
Global model norm: 14.346734162447204.
Norm before scaling: 13.81063181123118. Distance: 1.337146814007721
Total norm for 5 adversaries is: 13.81063181123118. distance: 1.337146814007721
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.9446, Accuracy: 6381/8991 (70.9710%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  57, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4490/4779 (93.9527%), train_poison_data_count: 4779
Global model norm: 14.346734162447204.
Norm before scaling: 14.016970566680502. Distance: 1.315953253165053
Total norm for 5 adversaries is: 14.016970566680502. distance: 1.315953253165053
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.2246, Accuracy: 8349/8991 (92.8595%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4799/5123 (93.6756%), train_poison_data_count: 5123
Global model norm: 14.346734162447204.
Norm before scaling: 13.97113767694962. Distance: 1.4346065425777328
Total norm for 5 adversaries is: 13.97113767694962. distance: 1.4346065425777328
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.3683, Accuracy: 7911/8991 (87.9880%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  57, local model 4, internal_epoch   1,  Average loss: 0.0047, Accuracy: 4131/4462 (92.5818%), train_poison_data_count: 4462
Global model norm: 14.346734162447204.
Norm before scaling: 14.036543427482478. Distance: 1.2467759994173306
Total norm for 5 adversaries is: 14.036543427482478. distance: 1.2467759994173306
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.5564, Accuracy: 7309/8991 (81.2924%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  57, local model 5, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3687/3841 (95.9906%), train_poison_data_count: 3841
Global model norm: 14.346734162447204.
Norm before scaling: 14.060156054654941. Distance: 1.0220854469606109
Total norm for 5 adversaries is: 14.060156054654941. distance: 1.0220854469606109
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 1.1966, Accuracy: 6684/8991 (74.3410%)
___Train Local_Simple,  epoch  57, local model 6, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2743/2945 (93.1409%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.5675, Accuracy: 8227/10000 (82.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 7, internal_epoch   1,  Average loss: 0.0035, Accuracy: 2613/2756 (94.8113%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.0396, Accuracy: 6963/10000 (69.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3108/3437 (90.4277%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.3670, Accuracy: 8723/10000 (87.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 9, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5524/5809 (95.0938%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.9017, Accuracy: 5723/10000 (57.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 10, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2459/2592 (94.8688%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.8125, Accuracy: 7233/10000 (72.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2318/2510 (92.3506%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.3588, Accuracy: 8820/10000 (88.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 12, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4236/4373 (96.8671%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.3502, Accuracy: 5966/10000 (59.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4118/4339 (94.9067%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.0918, Accuracy: 6641/10000 (66.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 14, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2599/2782 (93.4220%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.2683, Accuracy: 7415/10000 (74.1500%), Attack Success Rate:0/10000(0.000)
time spent on training: 447.88444089889526
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.10501569 1.
 0.12762115 0.         0.         0.10501569 0.96355302 0.12762115
 1.         1.         0.90869311]
___Test Target_Simple poisoned: False, epoch: 57: Average loss: 0.5939, Accuracy: 7766/10000 (77.6600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 57: Average loss: 0.5315, Accuracy: 7554/8991 (84.0174%)
Done in 476.47671604156494 sec.
Server Epoch:58 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  58, local model 0, internal_epoch   1,  Average loss: 0.0065, Accuracy: 2698/3010 (89.6346%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6251, Accuracy: 7969/10000 (79.6900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  58, local model 1, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5546/5805 (95.5383%), train_poison_data_count: 5805
Global model norm: 14.351733144909549.
Norm before scaling: 13.818561863578244. Distance: 1.3574537973286676
Total norm for 5 adversaries is: 13.818561863578244. distance: 1.3574537973286676
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.9154, Accuracy: 6506/8991 (72.3613%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  58, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4480/4779 (93.7435%), train_poison_data_count: 4779
Global model norm: 14.351733144909549.
Norm before scaling: 14.017483285043873. Distance: 1.3199013515659421
Total norm for 5 adversaries is: 14.017483285043873. distance: 1.3199013515659421
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.2704, Accuracy: 8213/8991 (91.3469%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4829/5123 (94.2612%), train_poison_data_count: 5123
Global model norm: 14.351733144909549.
Norm before scaling: 13.95767681039217. Distance: 1.3755320906644872
Total norm for 5 adversaries is: 13.95767681039217. distance: 1.3755320906644872
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.4735, Accuracy: 7438/8991 (82.7272%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  58, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 4116/4462 (92.2456%), train_poison_data_count: 4462
Global model norm: 14.351733144909549.
Norm before scaling: 14.072278501251915. Distance: 1.3684029979759946
Total norm for 5 adversaries is: 14.072278501251915. distance: 1.3684029979759946
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.7630, Accuracy: 7025/8991 (78.1337%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  58, local model 5, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3657/3841 (95.2096%), train_poison_data_count: 3841
Global model norm: 14.351733144909549.
Norm before scaling: 14.058796170222378. Distance: 1.0295054389102214
Total norm for 5 adversaries is: 14.058796170222378. distance: 1.0295054389102214
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 1.1564, Accuracy: 6607/8991 (73.4846%)
___Train Local_Simple,  epoch  58, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2742/2945 (93.1070%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5652, Accuracy: 8135/10000 (81.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 7, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2592/2756 (94.0493%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.8075, Accuracy: 7457/10000 (74.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3139/3437 (91.3296%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.3576, Accuracy: 8773/10000 (87.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 9, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5544/5809 (95.4381%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.6544, Accuracy: 5894/10000 (58.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 2455/2592 (94.7145%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.7458, Accuracy: 7529/10000 (75.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 11, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2320/2510 (92.4303%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.3373, Accuracy: 8958/10000 (89.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 12, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4224/4373 (96.5927%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.6303, Accuracy: 5620/10000 (56.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4133/4339 (95.2524%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.0446, Accuracy: 7063/10000 (70.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 14, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2617/2782 (94.0690%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.1363, Accuracy: 7402/10000 (74.0200%), Attack Success Rate:0/10000(0.000)
time spent on training: 454.54574704170227
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.14888052 0.         0.00116751 0.         0.         0.00116751
 0.69454345 0.         0.14888052 1.         0.22502238 0.65479428
 1.         1.         0.94362938]
___Test Target_Simple poisoned: False, epoch: 58: Average loss: 0.5808, Accuracy: 7805/10000 (78.0500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 58: Average loss: 0.5165, Accuracy: 7581/8991 (84.3177%)
Done in 482.9507761001587 sec.
Server Epoch:59 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  59, local model 0, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2705/3010 (89.8671%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6687, Accuracy: 7789/10000 (77.8900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  59, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5566/5805 (95.8829%), train_poison_data_count: 5805
Global model norm: 14.357909550153554.
Norm before scaling: 13.810941720464058. Distance: 1.307733007861375
Total norm for 5 adversaries is: 13.810941720464058. distance: 1.307733007861375
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.9160, Accuracy: 6510/8991 (72.4057%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  59, local model 2, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4472/4779 (93.5761%), train_poison_data_count: 4779
Global model norm: 14.357909550153554.
Norm before scaling: 14.02527081505191. Distance: 1.2949267541209457
Total norm for 5 adversaries is: 14.02527081505191. distance: 1.2949267541209457
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.2836, Accuracy: 8134/8991 (90.4682%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4820/5123 (94.0855%), train_poison_data_count: 5123
Global model norm: 14.357909550153554.
Norm before scaling: 13.974942808085398. Distance: 1.3833050039370336
Total norm for 5 adversaries is: 13.974942808085398. distance: 1.3833050039370336
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.3143, Accuracy: 8109/8991 (90.1902%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  59, local model 4, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4155/4462 (93.1197%), train_poison_data_count: 4462
Global model norm: 14.357909550153554.
Norm before scaling: 14.04469521723833. Distance: 1.2238886657799681
Total norm for 5 adversaries is: 14.04469521723833. distance: 1.2238886657799681
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.5627, Accuracy: 7181/8991 (79.8688%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  59, local model 5, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3669/3841 (95.5220%), train_poison_data_count: 3841
Global model norm: 14.357909550153554.
Norm before scaling: 14.060729055155711. Distance: 0.9909794880161712
Total norm for 5 adversaries is: 14.060729055155711. distance: 0.9909794880161712
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 1.0301, Accuracy: 6737/8991 (74.9305%)
___Train Local_Simple,  epoch  59, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2751/2945 (93.4126%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.5492, Accuracy: 8154/10000 (81.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 7, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2621/2756 (95.1016%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.8826, Accuracy: 7508/10000 (75.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3119/3437 (90.7477%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.4235, Accuracy: 8448/10000 (84.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 9, internal_epoch   1,  Average loss: 0.0032, Accuracy: 5527/5809 (95.1455%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.7038, Accuracy: 5818/10000 (58.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 2467/2592 (95.1775%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.8355, Accuracy: 7364/10000 (73.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 11, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2318/2510 (92.3506%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.3693, Accuracy: 8717/10000 (87.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 12, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4244/4373 (97.0501%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.2872, Accuracy: 5971/10000 (59.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4130/4339 (95.1832%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.1182, Accuracy: 6725/10000 (67.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 14, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2577/2782 (92.6312%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.0965, Accuracy: 6840/10000 (68.4000%), Attack Success Rate:0/10000(0.000)
time spent on training: 456.86500787734985
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.10131767 0.19987383 0.         0.         0.00424185 0.4331053
 0.58601799 0.19987383 0.53046179 1.         0.10131767 1.
 1.         1.         0.00424185]
___Test Target_Simple poisoned: False, epoch: 59: Average loss: 0.5674, Accuracy: 7852/10000 (78.5200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 59: Average loss: 0.5061, Accuracy: 7613/8991 (84.6736%)
Done in 485.251345872879 sec.
Server Epoch:60 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  60, local model 0, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2696/3010 (89.5681%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.5194, Accuracy: 8362/10000 (83.6200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  60, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5565/5805 (95.8656%), train_poison_data_count: 5805
Global model norm: 14.364771114428585.
Norm before scaling: 13.82239906167929. Distance: 1.3065924528676205
Total norm for 5 adversaries is: 13.82239906167929. distance: 1.3065924528676205
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.8060, Accuracy: 6739/8991 (74.9527%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  60, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4513/4779 (94.4340%), train_poison_data_count: 4779
Global model norm: 14.364771114428585.
Norm before scaling: 14.018009046819692. Distance: 1.2832905871633244
Total norm for 5 adversaries is: 14.018009046819692. distance: 1.2832905871633244
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.2703, Accuracy: 8184/8991 (91.0244%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4819/5123 (94.0660%), train_poison_data_count: 5123
Global model norm: 14.364771114428585.
Norm before scaling: 13.96031067160941. Distance: 1.312505040840278
Total norm for 5 adversaries is: 13.96031067160941. distance: 1.312505040840278
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.3540, Accuracy: 7904/8991 (87.9101%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4165/4462 (93.3438%), train_poison_data_count: 4462
Global model norm: 14.364771114428585.
Norm before scaling: 14.050721521279776. Distance: 1.2266738743846712
Total norm for 5 adversaries is: 14.050721521279776. distance: 1.2266738743846712
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.6506, Accuracy: 6891/8991 (76.6433%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  60, local model 5, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3687/3841 (95.9906%), train_poison_data_count: 3841
Global model norm: 14.364771114428585.
Norm before scaling: 14.061021515160435. Distance: 0.9742035718529319
Total norm for 5 adversaries is: 14.061021515160435. distance: 0.9742035718529319
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.9228, Accuracy: 6857/8991 (76.2652%)
___Train Local_Simple,  epoch  60, local model 6, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2725/2945 (92.5297%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6328, Accuracy: 7889/10000 (78.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 7, internal_epoch   1,  Average loss: 0.0034, Accuracy: 2611/2756 (94.7388%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.8407, Accuracy: 7562/10000 (75.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3145/3437 (91.5042%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.3455, Accuracy: 8771/10000 (87.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 5514/5809 (94.9217%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.6271, Accuracy: 5920/10000 (59.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 10, internal_epoch   1,  Average loss: 0.0031, Accuracy: 2462/2592 (94.9846%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.8114, Accuracy: 7232/10000 (72.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 11, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2319/2510 (92.3904%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.3940, Accuracy: 8580/10000 (85.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 12, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4257/4373 (97.3474%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.3553, Accuracy: 6121/10000 (61.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 13, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4129/4339 (95.1602%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.1093, Accuracy: 6702/10000 (67.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 14, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2607/2782 (93.7096%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.1292, Accuracy: 7329/10000 (73.2900%), Attack Success Rate:0/10000(0.000)
time spent on training: 461.87280321121216
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.1138792  0.22044762 0.22044762 1.         0.46016249
 0.47406    0.1138792  0.         1.         1.         0.47406
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 60: Average loss: 0.5522, Accuracy: 7892/10000 (78.9200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 60: Average loss: 0.4899, Accuracy: 7637/8991 (84.9405%)
Done in 490.00848627090454 sec.
Server Epoch:61 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  61, local model 0, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2711/3010 (90.0664%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.5828, Accuracy: 8019/10000 (80.1900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  61, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5543/5805 (95.4866%), train_poison_data_count: 5805
Global model norm: 14.373531366044466.
Norm before scaling: 13.8280637578093. Distance: 1.3157897773541551
Total norm for 5 adversaries is: 13.8280637578093. distance: 1.3157897773541551
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 1.0025, Accuracy: 6309/8991 (70.1702%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  61, local model 2, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4508/4779 (94.3294%), train_poison_data_count: 4779
Global model norm: 14.373531366044466.
Norm before scaling: 14.02367089377507. Distance: 1.255921784981513
Total norm for 5 adversaries is: 14.02367089377507. distance: 1.255921784981513
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.2771, Accuracy: 8167/8991 (90.8353%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  61, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4825/5123 (94.1831%), train_poison_data_count: 5123
Global model norm: 14.373531366044466.
Norm before scaling: 13.967023977535892. Distance: 1.3112110893651043
Total norm for 5 adversaries is: 13.967023977535892. distance: 1.3112110893651043
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.3398, Accuracy: 7995/8991 (88.9223%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  61, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4174/4462 (93.5455%), train_poison_data_count: 4462
Global model norm: 14.373531366044466.
Norm before scaling: 14.047979156582953. Distance: 1.191606698605833
Total norm for 5 adversaries is: 14.047979156582953. distance: 1.191606698605833
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.5990, Accuracy: 7239/8991 (80.5138%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  61, local model 5, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3679/3841 (95.7823%), train_poison_data_count: 3841
Global model norm: 14.373531366044466.
Norm before scaling: 14.08313210849602. Distance: 1.019661087596587
Total norm for 5 adversaries is: 14.08313210849602. distance: 1.019661087596587
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 1.0463, Accuracy: 6625/8991 (73.6848%)
___Train Local_Simple,  epoch  61, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2745/2945 (93.2088%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6328, Accuracy: 7999/10000 (79.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 7, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2624/2756 (95.2104%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.7411, Accuracy: 7610/10000 (76.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 8, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3110/3437 (90.4859%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.4114, Accuracy: 8477/10000 (84.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 9, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5534/5809 (95.2660%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 2.0896, Accuracy: 5193/10000 (51.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2478/2592 (95.6019%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.8147, Accuracy: 7241/10000 (72.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 11, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2317/2510 (92.3108%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.3472, Accuracy: 8930/10000 (89.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 12, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4235/4373 (96.8443%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 1.2049, Accuracy: 6227/10000 (62.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4112/4339 (94.7684%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.8671, Accuracy: 7240/10000 (72.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2590/2782 (93.0985%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 1.0524, Accuracy: 7337/10000 (73.3700%), Attack Success Rate:0/10000(0.000)
time spent on training: 466.2642066478729
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.         0.         0.         0.         0.42026623 0.64898067
 0.2533784  0.         0.         0.78386735 0.93300182 0.48210183
 1.         1.         0.51662   ]
___Test Target_Simple poisoned: False, epoch: 61: Average loss: 0.5406, Accuracy: 7931/10000 (79.3100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 61: Average loss: 0.4802, Accuracy: 7656/8991 (85.1518%)
Done in 495.0234749317169 sec.
Server Epoch:62 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  62, local model 0, internal_epoch   1,  Average loss: 0.0068, Accuracy: 2676/3010 (88.9037%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.5942, Accuracy: 7895/10000 (78.9500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  62, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5576/5805 (96.0551%), train_poison_data_count: 5805
Global model norm: 14.379493608113648.
Norm before scaling: 13.823882647263485. Distance: 1.2817518600471205
Total norm for 5 adversaries is: 13.823882647263485. distance: 1.2817518600471205
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.8674, Accuracy: 6562/8991 (72.9841%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  62, local model 2, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4511/4779 (94.3921%), train_poison_data_count: 4779
Global model norm: 14.379493608113648.
Norm before scaling: 14.034665921716117. Distance: 1.271289769528653
Total norm for 5 adversaries is: 14.034665921716117. distance: 1.271289769528653
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.3253, Accuracy: 8029/8991 (89.3004%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  62, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4827/5123 (94.2221%), train_poison_data_count: 5123
Global model norm: 14.379493608113648.
Norm before scaling: 13.970917603947461. Distance: 1.2947794978377343
Total norm for 5 adversaries is: 13.970917603947461. distance: 1.2947794978377343
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.3529, Accuracy: 7940/8991 (88.3105%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  62, local model 4, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4187/4462 (93.8368%), train_poison_data_count: 4462
Global model norm: 14.379493608113648.
Norm before scaling: 14.049783747084641. Distance: 1.2013487646842045
Total norm for 5 adversaries is: 14.049783747084641. distance: 1.2013487646842045
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.6972, Accuracy: 7018/8991 (78.0558%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  62, local model 5, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3696/3841 (96.2249%), train_poison_data_count: 3841
Global model norm: 14.379493608113648.
Norm before scaling: 14.069348375838276. Distance: 0.9676983262370351
Total norm for 5 adversaries is: 14.069348375838276. distance: 0.9676983262370351
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 1.1951, Accuracy: 6605/8991 (73.4624%)
___Train Local_Simple,  epoch  62, local model 6, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2751/2945 (93.4126%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.5030, Accuracy: 8252/10000 (82.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 7, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2633/2756 (95.5370%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.7887, Accuracy: 7605/10000 (76.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 8, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3106/3437 (90.3695%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.3350, Accuracy: 8822/10000 (88.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 9, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5554/5809 (95.6103%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 1.4042, Accuracy: 6181/10000 (61.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 10, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2470/2592 (95.2932%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.8600, Accuracy: 7122/10000 (71.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 11, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2320/2510 (92.4303%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2890, Accuracy: 9173/10000 (91.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 12, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4263/4373 (97.4846%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 1.4328, Accuracy: 5797/10000 (57.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4140/4339 (95.4137%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.8293, Accuracy: 7420/10000 (74.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 14, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2596/2782 (93.3142%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 1.1058, Accuracy: 7097/10000 (70.9700%), Attack Success Rate:0/10000(0.000)
time spent on training: 472.1265790462494
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.23126451 0.         0.         0.         0.62860011 0.67924671
 0.39393909 0.         0.23126451 1.         0.35599487 0.45556904
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 62: Average loss: 0.5337, Accuracy: 7951/10000 (79.5100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 62: Average loss: 0.4709, Accuracy: 7680/8991 (85.4188%)
Done in 500.5583610534668 sec.
Server Epoch:63 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  63, local model 0, internal_epoch   1,  Average loss: 0.0063, Accuracy: 2718/3010 (90.2990%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.4737, Accuracy: 8552/10000 (85.5200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  63, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5562/5805 (95.8140%), train_poison_data_count: 5805
Global model norm: 14.386673673734705.
Norm before scaling: 13.830013443615517. Distance: 1.2890444205201137
Total norm for 5 adversaries is: 13.830013443615517. distance: 1.2890444205201137
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.8250, Accuracy: 6703/8991 (74.5523%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  63, local model 2, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4502/4779 (94.2038%), train_poison_data_count: 4779
Global model norm: 14.386673673734705.
Norm before scaling: 14.029909609383125. Distance: 1.2208003867502462
Total norm for 5 adversaries is: 14.029909609383125. distance: 1.2208003867502462
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.1896, Accuracy: 8452/8991 (94.0051%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  63, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4830/5123 (94.2807%), train_poison_data_count: 5123
Global model norm: 14.386673673734705.
Norm before scaling: 13.970429936034762. Distance: 1.2963553617029235
Total norm for 5 adversaries is: 13.970429936034762. distance: 1.2963553617029235
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.4383, Accuracy: 7598/8991 (84.5067%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4156/4462 (93.1421%), train_poison_data_count: 4462
Global model norm: 14.386673673734705.
Norm before scaling: 14.046525214638272. Distance: 1.1797084174922734
Total norm for 5 adversaries is: 14.046525214638272. distance: 1.1797084174922734
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.5143, Accuracy: 7274/8991 (80.9031%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  63, local model 5, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3670/3841 (95.5480%), train_poison_data_count: 3841
Global model norm: 14.386673673734705.
Norm before scaling: 14.080056857080969. Distance: 0.9794277424781783
Total norm for 5 adversaries is: 14.080056857080969. distance: 0.9794277424781783
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 1.0251, Accuracy: 6576/8991 (73.1398%)
___Train Local_Simple,  epoch  63, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2764/2945 (93.8540%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.5608, Accuracy: 8110/10000 (81.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 7, internal_epoch   1,  Average loss: 0.0031, Accuracy: 2640/2756 (95.7910%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.6418, Accuracy: 8024/10000 (80.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 8, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3111/3437 (90.5150%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.4285, Accuracy: 8440/10000 (84.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 9, internal_epoch   1,  Average loss: 0.0031, Accuracy: 5546/5809 (95.4725%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 1.4036, Accuracy: 6115/10000 (61.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2488/2592 (95.9877%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.8003, Accuracy: 7489/10000 (74.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 11, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2337/2510 (93.1076%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.3541, Accuracy: 8938/10000 (89.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 12, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4256/4373 (97.3245%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 1.2990, Accuracy: 6107/10000 (61.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4152/4339 (95.6903%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.9393, Accuracy: 7312/10000 (73.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 2631/2782 (94.5723%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 1.3153, Accuracy: 7125/10000 (71.2500%), Attack Success Rate:0/10000(0.000)
time spent on training: 478.5384051799774
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.51726417 0.         0.08245991 0.08245991 1.         1.
 0.38435431 0.         0.51726417 1.         1.         0.38435431
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 63: Average loss: 0.5225, Accuracy: 7993/10000 (79.9300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 63: Average loss: 0.4585, Accuracy: 7715/8991 (85.8080%)
Done in 506.80594515800476 sec.
Server Epoch:64 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  64, local model 0, internal_epoch   1,  Average loss: 0.0062, Accuracy: 2723/3010 (90.4651%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.4977, Accuracy: 8412/10000 (84.1200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  64, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5550/5805 (95.6072%), train_poison_data_count: 5805
Global model norm: 14.3959489846265.
Norm before scaling: 13.864247597695135. Distance: 1.3474505281302025
Total norm for 5 adversaries is: 13.864247597695135. distance: 1.3474505281302025
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 1.2438, Accuracy: 5896/8991 (65.5767%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  64, local model 2, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4506/4779 (94.2875%), train_poison_data_count: 4779
Global model norm: 14.3959489846265.
Norm before scaling: 14.045398672766577. Distance: 1.27537277232552
Total norm for 5 adversaries is: 14.045398672766577. distance: 1.27537277232552
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.3078, Accuracy: 8073/8991 (89.7898%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  64, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4814/5123 (93.9684%), train_poison_data_count: 5123
Global model norm: 14.3959489846265.
Norm before scaling: 13.991566433906321. Distance: 1.3096460467008482
Total norm for 5 adversaries is: 13.991566433906321. distance: 1.3096460467008482
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.3913, Accuracy: 7864/8991 (87.4652%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  64, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4160/4462 (93.2317%), train_poison_data_count: 4462
Global model norm: 14.3959489846265.
Norm before scaling: 14.071150225790278. Distance: 1.2201638945727067
Total norm for 5 adversaries is: 14.071150225790278. distance: 1.2201638945727067
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.7112, Accuracy: 6953/8991 (77.3329%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  64, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3691/3841 (96.0948%), train_poison_data_count: 3841
Global model norm: 14.3959489846265.
Norm before scaling: 14.07543675776617. Distance: 0.9442027174544707
Total norm for 5 adversaries is: 14.07543675776617. distance: 0.9442027174544707
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 1.0278, Accuracy: 6605/8991 (73.4624%)
___Train Local_Simple,  epoch  64, local model 6, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2768/2945 (93.9898%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.5489, Accuracy: 8063/10000 (80.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 7, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2624/2756 (95.2104%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.7155, Accuracy: 7976/10000 (79.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 8, internal_epoch   1,  Average loss: 0.0058, Accuracy: 3123/3437 (90.8641%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.4220, Accuracy: 8555/10000 (85.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 9, internal_epoch   1,  Average loss: 0.0030, Accuracy: 5545/5809 (95.4553%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 1.3857, Accuracy: 6299/10000 (62.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 10, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2483/2592 (95.7948%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.7411, Accuracy: 7554/10000 (75.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 11, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2323/2510 (92.5498%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.4019, Accuracy: 8424/10000 (84.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 12, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4247/4373 (97.1187%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 1.2950, Accuracy: 6405/10000 (64.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4141/4339 (95.4367%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.8231, Accuracy: 7565/10000 (75.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2630/2782 (94.5363%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 1.1960, Accuracy: 7319/10000 (73.1900%), Attack Success Rate:0/10000(0.000)
time spent on training: 483.62909412384033
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.98583168 0.         0.09611648 0.09611648 1.         1.
 1.         0.         0.98583168 1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 64: Average loss: 0.5036, Accuracy: 8059/10000 (80.5900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 64: Average loss: 0.4284, Accuracy: 7816/8991 (86.9314%)
Done in 512.1343829631805 sec.
Server Epoch:65 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  65, local model 0, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2710/3010 (90.0332%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.6933, Accuracy: 7638/10000 (76.3800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  65, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5584/5805 (96.1929%), train_poison_data_count: 5805
Global model norm: 14.407871510900192.
Norm before scaling: 13.843777555347858. Distance: 1.2724639353859544
Total norm for 5 adversaries is: 13.843777555347858. distance: 1.2724639353859544
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.8168, Accuracy: 6545/8991 (72.7950%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  65, local model 2, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4492/4779 (93.9946%), train_poison_data_count: 4779
Global model norm: 14.407871510900192.
Norm before scaling: 14.045433437222687. Distance: 1.2276067479909896
Total norm for 5 adversaries is: 14.045433437222687. distance: 1.2276067479909896
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.3087, Accuracy: 8030/8991 (89.3115%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4833/5123 (94.3393%), train_poison_data_count: 5123
Global model norm: 14.407871510900192.
Norm before scaling: 14.000301902785548. Distance: 1.2932621372345798
Total norm for 5 adversaries is: 14.000301902785548. distance: 1.2932621372345798
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.4568, Accuracy: 7547/8991 (83.9395%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  65, local model 4, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4182/4462 (93.7248%), train_poison_data_count: 4462
Global model norm: 14.407871510900192.
Norm before scaling: 14.070887255751234. Distance: 1.1568343773566794
Total norm for 5 adversaries is: 14.070887255751234. distance: 1.1568343773566794
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.4982, Accuracy: 7287/8991 (81.0477%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  65, local model 5, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3690/3841 (96.0687%), train_poison_data_count: 3841
Global model norm: 14.407871510900192.
Norm before scaling: 14.093278492147473. Distance: 0.9576555668023514
Total norm for 5 adversaries is: 14.093278492147473. distance: 0.9576555668023514
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 1.0212, Accuracy: 6774/8991 (75.3420%)
___Train Local_Simple,  epoch  65, local model 6, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2775/2945 (94.2275%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.5825, Accuracy: 7953/10000 (79.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 7, internal_epoch   1,  Average loss: 0.0034, Accuracy: 2620/2756 (95.0653%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.8090, Accuracy: 7348/10000 (73.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3145/3437 (91.5042%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.3797, Accuracy: 8707/10000 (87.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 9, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5559/5809 (95.6963%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 1.6153, Accuracy: 5781/10000 (57.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2476/2592 (95.5247%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.7748, Accuracy: 7471/10000 (74.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 11, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2359/2510 (93.9841%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.3732, Accuracy: 8718/10000 (87.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 12, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4247/4373 (97.1187%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 1.3007, Accuracy: 6092/10000 (60.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4140/4339 (95.4137%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.9989, Accuracy: 6984/10000 (69.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 14, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2616/2782 (94.0331%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 1.1337, Accuracy: 7178/10000 (71.7800%), Attack Success Rate:0/10000(0.000)
time spent on training: 488.5936689376831
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.14648036 0.         0.0084058  0.03076049 0.67039192 0.60117953
 0.21372534 0.         0.14648036 0.92128779 0.22454764 0.24123668
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 65: Average loss: 0.5008, Accuracy: 8050/10000 (80.5000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 65: Average loss: 0.4233, Accuracy: 7812/8991 (86.8869%)
Done in 516.9050540924072 sec.
Server Epoch:66 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  66, local model 0, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2721/3010 (90.3987%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.4488, Accuracy: 8576/10000 (85.7600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  66, local model 1, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5559/5805 (95.7623%), train_poison_data_count: 5805
Global model norm: 14.41395399264714.
Norm before scaling: 13.861616948916044. Distance: 1.3138828712730612
Total norm for 5 adversaries is: 13.861616948916044. distance: 1.3138828712730612
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.8654, Accuracy: 6480/8991 (72.0721%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  66, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4519/4779 (94.5595%), train_poison_data_count: 4779
Global model norm: 14.41395399264714.
Norm before scaling: 14.04566212001586. Distance: 1.1897776995514648
Total norm for 5 adversaries is: 14.04566212001586. distance: 1.1897776995514648
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.2848, Accuracy: 8186/8991 (91.0466%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  66, local model 3, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4824/5123 (94.1636%), train_poison_data_count: 5123
Global model norm: 14.41395399264714.
Norm before scaling: 13.989979018549425. Distance: 1.2823999873050063
Total norm for 5 adversaries is: 13.989979018549425. distance: 1.2823999873050063
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.2711, Accuracy: 8209/8991 (91.3024%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  66, local model 4, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4171/4462 (93.4783%), train_poison_data_count: 4462
Global model norm: 14.41395399264714.
Norm before scaling: 14.063765134063273. Distance: 1.1251258779674267
Total norm for 5 adversaries is: 14.063765134063273. distance: 1.1251258779674267
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.5286, Accuracy: 7256/8991 (80.7029%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  66, local model 5, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3698/3841 (96.2770%), train_poison_data_count: 3841
Global model norm: 14.41395399264714.
Norm before scaling: 14.091153533694687. Distance: 0.9211061795522812
Total norm for 5 adversaries is: 14.091153533694687. distance: 0.9211061795522812
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.8355, Accuracy: 6772/8991 (75.3198%)
___Train Local_Simple,  epoch  66, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 2778/2945 (94.3294%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.6664, Accuracy: 7854/10000 (78.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 7, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2630/2756 (95.4282%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.9049, Accuracy: 7280/10000 (72.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3148/3437 (91.5915%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.3617, Accuracy: 8712/10000 (87.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 9, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5564/5809 (95.7824%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 1.6697, Accuracy: 5986/10000 (59.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 10, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2474/2592 (95.4475%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.6819, Accuracy: 7558/10000 (75.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 11, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2340/2510 (93.2271%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2880, Accuracy: 9180/10000 (91.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 12, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4227/4373 (96.6613%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 1.6015, Accuracy: 5010/10000 (50.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4143/4339 (95.4828%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 1.1389, Accuracy: 6720/10000 (67.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2621/2782 (94.2128%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 1.1090, Accuracy: 7163/10000 (71.6300%), Attack Success Rate:0/10000(0.000)
time spent on training: 491.15757393836975
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.14738883 0.         0.         0.         0.87553679 0.81408536
 0.78261066 0.         0.14738883 1.         0.87508618 0.35376974
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 66: Average loss: 0.4950, Accuracy: 8070/10000 (80.7000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 66: Average loss: 0.4107, Accuracy: 7851/8991 (87.3207%)
Done in 519.3885939121246 sec.
Server Epoch:67 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  67, local model 0, internal_epoch   1,  Average loss: 0.0061, Accuracy: 2719/3010 (90.3322%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.5048, Accuracy: 8425/10000 (84.2500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  67, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5573/5805 (96.0034%), train_poison_data_count: 5805
Global model norm: 14.421527961696707.
Norm before scaling: 13.864545302860751. Distance: 1.2833447429017684
Total norm for 5 adversaries is: 13.864545302860751. distance: 1.2833447429017684
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 1.2273, Accuracy: 6085/8991 (67.6788%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  67, local model 2, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4534/4779 (94.8734%), train_poison_data_count: 4779
Global model norm: 14.421527961696707.
Norm before scaling: 14.050728580141762. Distance: 1.2180564080504437
Total norm for 5 adversaries is: 14.050728580141762. distance: 1.2180564080504437
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.2118, Accuracy: 8409/8991 (93.5269%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  67, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4851/5123 (94.6906%), train_poison_data_count: 5123
Global model norm: 14.421527961696707.
Norm before scaling: 13.982026688305956. Distance: 1.214890016122492
Total norm for 5 adversaries is: 13.982026688305956. distance: 1.214890016122492
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.2994, Accuracy: 8093/8991 (90.0122%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  67, local model 4, internal_epoch   1,  Average loss: 0.0040, Accuracy: 4192/4462 (93.9489%), train_poison_data_count: 4462
Global model norm: 14.421527961696707.
Norm before scaling: 14.065899654165555. Distance: 1.116246821109564
Total norm for 5 adversaries is: 14.065899654165555. distance: 1.116246821109564
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.4435, Accuracy: 7450/8991 (82.8606%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  67, local model 5, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3679/3841 (95.7823%), train_poison_data_count: 3841
Global model norm: 14.421527961696707.
Norm before scaling: 14.09397194427517. Distance: 0.9281904846106432
Total norm for 5 adversaries is: 14.09397194427517. distance: 0.9281904846106432
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.9340, Accuracy: 6640/8991 (73.8516%)
___Train Local_Simple,  epoch  67, local model 6, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2768/2945 (93.9898%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.5958, Accuracy: 8225/10000 (82.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 7, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2630/2756 (95.4282%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.7763, Accuracy: 7537/10000 (75.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3159/3437 (91.9116%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.3369, Accuracy: 8719/10000 (87.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 9, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5572/5809 (95.9201%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 1.5069, Accuracy: 6103/10000 (61.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2485/2592 (95.8719%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.6250, Accuracy: 8022/10000 (80.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 11, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2349/2510 (93.5857%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.3628, Accuracy: 8761/10000 (87.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 12, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4259/4373 (97.3931%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 1.1001, Accuracy: 6448/10000 (64.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4156/4339 (95.7824%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 1.0617, Accuracy: 7002/10000 (70.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 14, internal_epoch   1,  Average loss: 0.0037, Accuracy: 2621/2782 (94.2128%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.9472, Accuracy: 7605/10000 (76.0500%), Attack Success Rate:0/10000(0.000)
time spent on training: 496.04672265052795
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.47172337 0.         0.         0.         0.32186024 0.87898009
 0.64027991 0.         0.47172337 0.32186024 1.         1.
 1.         1.         0.77424983]
___Test Target_Simple poisoned: False, epoch: 67: Average loss: 0.4830, Accuracy: 8105/10000 (81.0500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 67: Average loss: 0.4012, Accuracy: 7866/8991 (87.4875%)
Done in 524.3538460731506 sec.
Server Epoch:68 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  68, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2752/3010 (91.4286%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.4597, Accuracy: 8476/10000 (84.7600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5568/5805 (95.9173%), train_poison_data_count: 5805
Global model norm: 14.428739986487255.
Norm before scaling: 13.870003015233202. Distance: 1.2776744076246924
Total norm for 5 adversaries is: 13.870003015233202. distance: 1.2776744076246924
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.7947, Accuracy: 6687/8991 (74.3744%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  68, local model 2, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4505/4779 (94.2666%), train_poison_data_count: 4779
Global model norm: 14.428739986487255.
Norm before scaling: 14.069156410722535. Distance: 1.213098038339888
Total norm for 5 adversaries is: 14.069156410722535. distance: 1.213098038339888
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.2348, Accuracy: 8337/8991 (92.7261%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  68, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4860/5123 (94.8663%), train_poison_data_count: 5123
Global model norm: 14.428739986487255.
Norm before scaling: 13.98880592774736. Distance: 1.2104046048971198
Total norm for 5 adversaries is: 13.98880592774736. distance: 1.2104046048971198
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.2551, Accuracy: 8250/8991 (91.7584%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  68, local model 4, internal_epoch   1,  Average loss: 0.0043, Accuracy: 4172/4462 (93.5007%), train_poison_data_count: 4462
Global model norm: 14.428739986487255.
Norm before scaling: 14.07873899621812. Distance: 1.1493835704456967
Total norm for 5 adversaries is: 14.07873899621812. distance: 1.1493835704456967
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.4556, Accuracy: 7470/8991 (83.0831%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  68, local model 5, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3687/3841 (95.9906%), train_poison_data_count: 3841
Global model norm: 14.428739986487255.
Norm before scaling: 14.099982598476629. Distance: 0.937885395942674
Total norm for 5 adversaries is: 14.099982598476629. distance: 0.937885395942674
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.8779, Accuracy: 6748/8991 (75.0528%)
___Train Local_Simple,  epoch  68, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2777/2945 (94.2954%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.5369, Accuracy: 8191/10000 (81.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 7, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2646/2756 (96.0087%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.8055, Accuracy: 7911/10000 (79.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3158/3437 (91.8825%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.3140, Accuracy: 9023/10000 (90.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 9, internal_epoch   1,  Average loss: 0.0029, Accuracy: 5552/5809 (95.5758%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 1.4135, Accuracy: 6063/10000 (60.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 10, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2482/2592 (95.7562%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.5779, Accuracy: 8019/10000 (80.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 11, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2343/2510 (93.3466%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.3174, Accuracy: 9038/10000 (90.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 12, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4265/4373 (97.5303%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 1.3211, Accuracy: 6041/10000 (60.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4147/4339 (95.5750%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.9149, Accuracy: 7293/10000 (72.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 14, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2610/2782 (93.8174%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.9979, Accuracy: 7179/10000 (71.7900%), Attack Success Rate:0/10000(0.000)
time spent on training: 498.04918670654297
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.73292173 0.         0.         0.         0.53016976 1.
 0.33179485 0.         0.79360838 1.         0.73292173 0.33179485
 1.         1.         0.53016976]
___Test Target_Simple poisoned: False, epoch: 68: Average loss: 0.4728, Accuracy: 8133/10000 (81.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 68: Average loss: 0.3956, Accuracy: 7865/8991 (87.4764%)
Done in 527.8614068031311 sec.
Server Epoch:69 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  69, local model 0, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2766/3010 (91.8937%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.5311, Accuracy: 8241/10000 (82.4100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  69, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5585/5805 (96.2102%), train_poison_data_count: 5805
Global model norm: 14.436380186043056.
Norm before scaling: 13.866408428819762. Distance: 1.238579939669828
Total norm for 5 adversaries is: 13.866408428819762. distance: 1.238579939669828
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.6797, Accuracy: 6976/8991 (77.5887%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  69, local model 2, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4533/4779 (94.8525%), train_poison_data_count: 4779
Global model norm: 14.436380186043056.
Norm before scaling: 14.035565025010182. Distance: 1.1636918265023954
Total norm for 5 adversaries is: 14.035565025010182. distance: 1.1636918265023954
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.2464, Accuracy: 8297/8991 (92.2812%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  69, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4864/5123 (94.9444%), train_poison_data_count: 5123
Global model norm: 14.436380186043056.
Norm before scaling: 13.98892591365661. Distance: 1.202793917989371
Total norm for 5 adversaries is: 13.98892591365661. distance: 1.202793917989371
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.2601, Accuracy: 8224/8991 (91.4692%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  69, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4161/4462 (93.2541%), train_poison_data_count: 4462
Global model norm: 14.436380186043056.
Norm before scaling: 14.10050744841243. Distance: 1.1819401637227802
Total norm for 5 adversaries is: 14.10050744841243. distance: 1.1819401637227802
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.5036, Accuracy: 7267/8991 (80.8253%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  69, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3711/3841 (96.6155%), train_poison_data_count: 3841
Global model norm: 14.436380186043056.
Norm before scaling: 14.09492031068119. Distance: 0.9005280429131555
Total norm for 5 adversaries is: 14.09492031068119. distance: 0.9005280429131555
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.9126, Accuracy: 6649/8991 (73.9517%)
___Train Local_Simple,  epoch  69, local model 6, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2770/2945 (94.0577%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.5542, Accuracy: 8141/10000 (81.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 7, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2645/2756 (95.9724%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6387, Accuracy: 7850/10000 (78.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3153/3437 (91.7370%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2700, Accuracy: 9180/10000 (91.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 9, internal_epoch   1,  Average loss: 0.0028, Accuracy: 5562/5809 (95.7480%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 1.4426, Accuracy: 5967/10000 (59.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2476/2592 (95.5247%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6395, Accuracy: 7852/10000 (78.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 11, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2348/2510 (93.5458%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.3472, Accuracy: 8835/10000 (88.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 12, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4262/4373 (97.4617%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 1.1915, Accuracy: 6326/10000 (63.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4149/4339 (95.6211%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.8767, Accuracy: 7271/10000 (72.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2644/2782 (95.0395%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.9561, Accuracy: 7501/10000 (75.0100%), Attack Success Rate:0/10000(0.000)
time spent on training: 504.2085738182068
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.64100251 0.         0.         0.         0.32420071 0.51933488
 0.46436051 0.         0.64100251 0.64339576 0.73502749 0.73142554
 1.         1.         0.94499826]
___Test Target_Simple poisoned: False, epoch: 69: Average loss: 0.4556, Accuracy: 8199/10000 (81.9900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 69: Average loss: 0.3853, Accuracy: 7865/8991 (87.4764%)
Done in 532.7007019519806 sec.
Server Epoch:70 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  70, local model 0, internal_epoch   1,  Average loss: 0.0059, Accuracy: 2721/3010 (90.3987%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.5210, Accuracy: 8210/10000 (82.1000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  70, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5585/5805 (96.2102%), train_poison_data_count: 5805
Global model norm: 14.44320024527789.
Norm before scaling: 13.869745032642374. Distance: 1.2513330980387734
Total norm for 5 adversaries is: 13.869745032642374. distance: 1.2513330980387734
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.7158, Accuracy: 6846/8991 (76.1428%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  70, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4542/4779 (95.0408%), train_poison_data_count: 4779
Global model norm: 14.44320024527789.
Norm before scaling: 14.045649626752763. Distance: 1.1421601924945615
Total norm for 5 adversaries is: 14.045649626752763. distance: 1.1421601924945615
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.2326, Accuracy: 8342/8991 (92.7817%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  70, local model 3, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4840/5123 (94.4759%), train_poison_data_count: 5123
Global model norm: 14.44320024527789.
Norm before scaling: 14.016987984172545. Distance: 1.2686806514184366
Total norm for 5 adversaries is: 14.016987984172545. distance: 1.2686806514184366
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.3911, Accuracy: 7831/8991 (87.0982%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  70, local model 4, internal_epoch   1,  Average loss: 0.0039, Accuracy: 4180/4462 (93.6800%), train_poison_data_count: 4462
Global model norm: 14.44320024527789.
Norm before scaling: 14.078494051246269. Distance: 1.0898018011955095
Total norm for 5 adversaries is: 14.078494051246269. distance: 1.0898018011955095
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.4729, Accuracy: 7437/8991 (82.7160%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  70, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3696/3841 (96.2249%), train_poison_data_count: 3841
Global model norm: 14.44320024527789.
Norm before scaling: 14.10626490587521. Distance: 0.9308644066089129
Total norm for 5 adversaries is: 14.10626490587521. distance: 0.9308644066089129
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.9582, Accuracy: 6753/8991 (75.1084%)
___Train Local_Simple,  epoch  70, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2790/2945 (94.7368%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.5850, Accuracy: 7988/10000 (79.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 7, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2644/2756 (95.9361%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.7535, Accuracy: 7782/10000 (77.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 8, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3178/3437 (92.4644%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2971, Accuracy: 8982/10000 (89.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 9, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5570/5809 (95.8857%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 1.0527, Accuracy: 6497/10000 (64.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2499/2592 (96.4120%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.6321, Accuracy: 7893/10000 (78.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 11, internal_epoch   1,  Average loss: 0.0041, Accuracy: 2358/2510 (93.9442%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2598, Accuracy: 9251/10000 (92.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 12, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4255/4373 (97.3016%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 1.1526, Accuracy: 6278/10000 (62.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4161/4339 (95.8977%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.8515, Accuracy: 7462/10000 (74.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2644/2782 (95.0395%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.9025, Accuracy: 7808/10000 (78.0800%), Attack Success Rate:0/10000(0.000)
time spent on training: 511.4834051132202
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.73350143 0.         0.05800634 0.         0.         0.05800634
 1.         0.         0.73350143 1.         1.         0.56101354
 1.         1.         0.7670053 ]
___Test Target_Simple poisoned: False, epoch: 70: Average loss: 0.4428, Accuracy: 8245/10000 (82.4500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 70: Average loss: 0.3787, Accuracy: 7868/8991 (87.5097%)
Done in 539.6551728248596 sec.
Server Epoch:71 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  71, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2753/3010 (91.4618%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.5175, Accuracy: 8369/10000 (83.6900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5585/5805 (96.2102%), train_poison_data_count: 5805
Global model norm: 14.45016122483857.
Norm before scaling: 13.875144614076044. Distance: 1.2319084827163556
Total norm for 5 adversaries is: 13.875144614076044. distance: 1.2319084827163556
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.7800, Accuracy: 6709/8991 (74.6191%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  71, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4532/4779 (94.8316%), train_poison_data_count: 4779
Global model norm: 14.45016122483857.
Norm before scaling: 14.068478546845315. Distance: 1.2026616975557591
Total norm for 5 adversaries is: 14.068478546845315. distance: 1.2026616975557591
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.2848, Accuracy: 8163/8991 (90.7908%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  71, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4854/5123 (94.7492%), train_poison_data_count: 5123
Global model norm: 14.45016122483857.
Norm before scaling: 13.994091967160697. Distance: 1.1936156252182173
Total norm for 5 adversaries is: 13.994091967160697. distance: 1.1936156252182173
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.3282, Accuracy: 7999/8991 (88.9667%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  71, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4207/4462 (94.2851%), train_poison_data_count: 4462
Global model norm: 14.45016122483857.
Norm before scaling: 14.080155474931454. Distance: 1.0779663743240226
Total norm for 5 adversaries is: 14.080155474931454. distance: 1.0779663743240226
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.5442, Accuracy: 7099/8991 (78.9567%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  71, local model 5, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3688/3841 (96.0167%), train_poison_data_count: 3841
Global model norm: 14.45016122483857.
Norm before scaling: 14.117357735380617. Distance: 0.9399369673190638
Total norm for 5 adversaries is: 14.117357735380617. distance: 0.9399369673190638
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.8666, Accuracy: 6782/8991 (75.4310%)
___Train Local_Simple,  epoch  71, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 2778/2945 (94.3294%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.5549, Accuracy: 8133/10000 (81.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 7, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2638/2756 (95.7184%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.6998, Accuracy: 7802/10000 (78.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 8, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3142/3437 (91.4169%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.5354, Accuracy: 8075/10000 (80.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 9, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5572/5809 (95.9201%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 1.4715, Accuracy: 6122/10000 (61.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 10, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2500/2592 (96.4506%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.7566, Accuracy: 7303/10000 (73.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 11, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2347/2510 (93.5060%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.3596, Accuracy: 8891/10000 (88.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4251/4373 (97.2102%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 1.3031, Accuracy: 5845/10000 (58.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4155/4339 (95.7594%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.9744, Accuracy: 7233/10000 (72.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2629/2782 (94.5004%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.9597, Accuracy: 7595/10000 (75.9500%), Attack Success Rate:0/10000(0.000)
time spent on training: 514.8817629814148
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.78016518 0.         0.         0.         1.         1.
 1.         0.         0.78016518 1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 71: Average loss: 0.4361, Accuracy: 8261/10000 (82.6100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 71: Average loss: 0.3683, Accuracy: 7892/8991 (87.7767%)
Done in 543.1717638969421 sec.
Server Epoch:72 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  72, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 2743/3010 (91.1296%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.4789, Accuracy: 8441/10000 (84.4100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  72, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5602/5805 (96.5030%), train_poison_data_count: 5805
Global model norm: 14.459904448851724.
Norm before scaling: 13.873043987795349. Distance: 1.2160994733949972
Total norm for 5 adversaries is: 13.873043987795349. distance: 1.2160994733949972
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.7335, Accuracy: 6835/8991 (76.0205%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  72, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4548/4779 (95.1664%), train_poison_data_count: 4779
Global model norm: 14.459904448851724.
Norm before scaling: 14.05743941061825. Distance: 1.1273810831868698
Total norm for 5 adversaries is: 14.05743941061825. distance: 1.1273810831868698
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.1971, Accuracy: 8469/8991 (94.1942%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  72, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4873/5123 (95.1200%), train_poison_data_count: 5123
Global model norm: 14.459904448851724.
Norm before scaling: 13.998321432574961. Distance: 1.173636625540512
Total norm for 5 adversaries is: 13.998321432574961. distance: 1.173636625540512
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.2750, Accuracy: 8166/8991 (90.8242%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  72, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4203/4462 (94.1954%), train_poison_data_count: 4462
Global model norm: 14.459904448851724.
Norm before scaling: 14.084162460087871. Distance: 1.0752641619432848
Total norm for 5 adversaries is: 14.084162460087871. distance: 1.0752641619432848
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.5521, Accuracy: 7245/8991 (80.5806%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  72, local model 5, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3672/3841 (95.6001%), train_poison_data_count: 3841
Global model norm: 14.459904448851724.
Norm before scaling: 14.151835917606846. Distance: 1.0394050205687133
Total norm for 5 adversaries is: 14.151835917606846. distance: 1.0394050205687133
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.8654, Accuracy: 6747/8991 (75.0417%)
___Train Local_Simple,  epoch  72, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2777/2945 (94.2954%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.5484, Accuracy: 8397/10000 (83.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2652/2756 (96.2264%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.8474, Accuracy: 7558/10000 (75.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 8, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3185/3437 (92.6680%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.3474, Accuracy: 8802/10000 (88.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5582/5809 (96.0923%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 1.1774, Accuracy: 6346/10000 (63.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2493/2592 (96.1806%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.6339, Accuracy: 7963/10000 (79.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 11, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2338/2510 (93.1474%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.2968, Accuracy: 9114/10000 (91.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4273/4373 (97.7132%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.9150, Accuracy: 7015/10000 (70.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4161/4339 (95.8977%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 1.0908, Accuracy: 6888/10000 (68.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2643/2782 (95.0036%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 1.0925, Accuracy: 7224/10000 (72.2400%), Attack Success Rate:0/10000(0.000)
time spent on training: 521.9143800735474
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [1.         0.         0.31271182 0.31271182 0.17350175 0.46693777
 0.6549053  0.         1.         1.         1.         1.
 1.         1.         0.17350175]
___Test Target_Simple poisoned: False, epoch: 72: Average loss: 0.4201, Accuracy: 8327/10000 (83.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 72: Average loss: 0.3610, Accuracy: 7883/8991 (87.6766%)
Done in 550.3178329467773 sec.
Server Epoch:73 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2777/3010 (92.2591%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.4462, Accuracy: 8594/10000 (85.9400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  73, local model 1, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5609/5805 (96.6236%), train_poison_data_count: 5805
Global model norm: 14.468257491955125.
Norm before scaling: 13.882843275148781. Distance: 1.2077289527728412
Total norm for 5 adversaries is: 13.882843275148781. distance: 1.2077289527728412
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.6987, Accuracy: 6997/8991 (77.8223%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  73, local model 2, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4531/4779 (94.8106%), train_poison_data_count: 4779
Global model norm: 14.468257491955125.
Norm before scaling: 14.061564639031328. Distance: 1.1535015948895961
Total norm for 5 adversaries is: 14.061564639031328. distance: 1.1535015948895961
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.2318, Accuracy: 8311/8991 (92.4369%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  73, local model 3, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4857/5123 (94.8077%), train_poison_data_count: 5123
Global model norm: 14.468257491955125.
Norm before scaling: 14.008895227954719. Distance: 1.2115838571574398
Total norm for 5 adversaries is: 14.008895227954719. distance: 1.2115838571574398
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.3034, Accuracy: 8067/8991 (89.7231%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  73, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4201/4462 (94.1506%), train_poison_data_count: 4462
Global model norm: 14.468257491955125.
Norm before scaling: 14.090720923277678. Distance: 1.0733196032773364
Total norm for 5 adversaries is: 14.090720923277678. distance: 1.0733196032773364
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.4392, Accuracy: 7401/8991 (82.3156%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  73, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3701/3841 (96.3551%), train_poison_data_count: 3841
Global model norm: 14.468257491955125.
Norm before scaling: 14.126266557740992. Distance: 0.936567128487912
Total norm for 5 adversaries is: 14.126266557740992. distance: 0.936567128487912
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.8497, Accuracy: 6958/8991 (77.3885%)
___Train Local_Simple,  epoch  73, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 2791/2945 (94.7708%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.4437, Accuracy: 8458/10000 (84.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 7, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2644/2756 (95.9361%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.7124, Accuracy: 7645/10000 (76.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 8, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3166/3437 (92.1152%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.3557, Accuracy: 8832/10000 (88.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 9, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5585/5809 (96.1439%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 1.2984, Accuracy: 6039/10000 (60.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2501/2592 (96.4892%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.6208, Accuracy: 7812/10000 (78.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 11, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2364/2510 (94.1833%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.3210, Accuracy: 8967/10000 (89.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4264/4373 (97.5074%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 1.1978, Accuracy: 6335/10000 (63.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4146/4339 (95.5520%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.9634, Accuracy: 7031/10000 (70.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 14, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2645/2782 (95.0755%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.9603, Accuracy: 7447/10000 (74.4700%), Attack Success Rate:0/10000(0.000)
time spent on training: 523.9952917098999
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.68451762 0.         0.02583771 0.         0.         0.33547972
 0.86121638 0.         0.68451762 1.         1.         0.7491036
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 73: Average loss: 0.4063, Accuracy: 8392/10000 (83.9200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 73: Average loss: 0.3554, Accuracy: 7883/8991 (87.6766%)
Done in 552.5519502162933 sec.
Server Epoch:74 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  74, local model 0, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2775/3010 (92.1927%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.4530, Accuracy: 8576/10000 (85.7600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  74, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5593/5805 (96.3480%), train_poison_data_count: 5805
Global model norm: 14.475072019196917.
Norm before scaling: 13.882963077756829. Distance: 1.2097670774663594
Total norm for 5 adversaries is: 13.882963077756829. distance: 1.2097670774663594
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.8116, Accuracy: 6602/8991 (73.4290%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4542/4779 (95.0408%), train_poison_data_count: 4779
Global model norm: 14.475072019196917.
Norm before scaling: 14.06880229870749. Distance: 1.1361713467811627
Total norm for 5 adversaries is: 14.06880229870749. distance: 1.1361713467811627
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.1787, Accuracy: 8480/8991 (94.3165%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4868/5123 (95.0224%), train_poison_data_count: 5123
Global model norm: 14.475072019196917.
Norm before scaling: 14.00372537365755. Distance: 1.1762111042819834
Total norm for 5 adversaries is: 14.00372537365755. distance: 1.1762111042819834
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.3146, Accuracy: 8045/8991 (89.4784%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  74, local model 4, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4200/4462 (94.1282%), train_poison_data_count: 4462
Global model norm: 14.475072019196917.
Norm before scaling: 14.099291606449983. Distance: 1.0855323529722019
Total norm for 5 adversaries is: 14.099291606449983. distance: 1.0855323529722019
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.4852, Accuracy: 7324/8991 (81.4592%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  74, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3700/3841 (96.3291%), train_poison_data_count: 3841
Global model norm: 14.475072019196917.
Norm before scaling: 14.120266011355639. Distance: 0.9481840105998972
Total norm for 5 adversaries is: 14.120266011355639. distance: 0.9481840105998972
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.7960, Accuracy: 6889/8991 (76.6211%)
___Train Local_Simple,  epoch  74, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2786/2945 (94.6010%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.5093, Accuracy: 8381/10000 (83.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 7, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2649/2756 (96.1176%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.6299, Accuracy: 8007/10000 (80.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3197/3437 (93.0172%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.2223, Accuracy: 9336/10000 (93.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 9, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5575/5809 (95.9718%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 1.1952, Accuracy: 6402/10000 (64.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 10, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2499/2592 (96.4120%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.5097, Accuracy: 8311/10000 (83.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2356/2510 (93.8645%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.3141, Accuracy: 9091/10000 (90.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 12, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4253/4373 (97.2559%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 1.2370, Accuracy: 5859/10000 (58.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4160/4339 (95.8746%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.9180, Accuracy: 6942/10000 (69.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 14, internal_epoch   1,  Average loss: 0.0035, Accuracy: 2620/2782 (94.1769%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 1.0631, Accuracy: 7258/10000 (72.5800%), Attack Success Rate:0/10000(0.000)
time spent on training: 528.6693482398987
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.90274781 0.1630595  0.26956673 0.26956673 1.         0.67008954
 1.         0.1630595  0.90274781 1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 74: Average loss: 0.3948, Accuracy: 8441/10000 (84.4100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 74: Average loss: 0.3404, Accuracy: 7935/8991 (88.2549%)
Done in 557.3799211978912 sec.
Server Epoch:75 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  75, local model 0, internal_epoch   1,  Average loss: 0.0055, Accuracy: 2741/3010 (91.0631%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.4487, Accuracy: 8562/10000 (85.6200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5597/5805 (96.4169%), train_poison_data_count: 5805
Global model norm: 14.485111353653252.
Norm before scaling: 13.9021127096916. Distance: 1.2323603063036872
Total norm for 5 adversaries is: 13.9021127096916. distance: 1.2323603063036872
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.6617, Accuracy: 7083/8991 (78.7788%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  75, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4549/4779 (95.1873%), train_poison_data_count: 4779
Global model norm: 14.485111353653252.
Norm before scaling: 14.072360366830623. Distance: 1.1152673505995294
Total norm for 5 adversaries is: 14.072360366830623. distance: 1.1152673505995294
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.2256, Accuracy: 8340/8991 (92.7594%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  75, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4867/5123 (95.0029%), train_poison_data_count: 5123
Global model norm: 14.485111353653252.
Norm before scaling: 14.009923415264. Distance: 1.1670050584410514
Total norm for 5 adversaries is: 14.009923415264. distance: 1.1670050584410514
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.3077, Accuracy: 8093/8991 (90.0122%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  75, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4204/4462 (94.2178%), train_poison_data_count: 4462
Global model norm: 14.485111353653252.
Norm before scaling: 14.102873359259265. Distance: 1.0551632408657285
Total norm for 5 adversaries is: 14.102873359259265. distance: 1.0551632408657285
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.5190, Accuracy: 7320/8991 (81.4147%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  75, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3700/3841 (96.3291%), train_poison_data_count: 3841
Global model norm: 14.485111353653252.
Norm before scaling: 14.13897122149092. Distance: 0.9156490153525537
Total norm for 5 adversaries is: 14.13897122149092. distance: 0.9156490153525537
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.8428, Accuracy: 6744/8991 (75.0083%)
___Train Local_Simple,  epoch  75, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 2791/2945 (94.7708%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.5409, Accuracy: 8124/10000 (81.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 7, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2646/2756 (96.0087%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.7328, Accuracy: 7887/10000 (78.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3190/3437 (92.8135%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.3893, Accuracy: 8666/10000 (86.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 9, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5595/5809 (96.3161%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 1.2740, Accuracy: 6022/10000 (60.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 10, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2492/2592 (96.1420%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.5456, Accuracy: 8145/10000 (81.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 11, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2361/2510 (94.0637%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.2984, Accuracy: 9079/10000 (90.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4271/4373 (97.6675%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 1.0680, Accuracy: 6711/10000 (67.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4151/4339 (95.6672%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.9052, Accuracy: 7093/10000 (70.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2651/2782 (95.2912%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 1.1390, Accuracy: 7254/10000 (72.5400%), Attack Success Rate:0/10000(0.000)
time spent on training: 534.4839730262756
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.71333047 0.         0.27953583 0.27953583 1.         1.
 1.         0.         0.71333047 1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 75: Average loss: 0.3870, Accuracy: 8458/10000 (84.5800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 75: Average loss: 0.3294, Accuracy: 7964/8991 (88.5775%)
Done in 562.9316968917847 sec.
Server Epoch:76 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  76, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2789/3010 (92.6578%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.3957, Accuracy: 8702/10000 (87.0200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  76, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5604/5805 (96.5375%), train_poison_data_count: 5805
Global model norm: 14.494602119430045.
Norm before scaling: 13.906795328141856. Distance: 1.2026170426190603
Total norm for 5 adversaries is: 13.906795328141856. distance: 1.2026170426190603
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.6294, Accuracy: 7242/8991 (80.5472%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  76, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4530/4779 (94.7897%), train_poison_data_count: 4779
Global model norm: 14.494602119430045.
Norm before scaling: 14.092235272330047. Distance: 1.1467478772632953
Total norm for 5 adversaries is: 14.092235272330047. distance: 1.1467478772632953
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.2094, Accuracy: 8387/8991 (93.2822%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  76, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4858/5123 (94.8272%), train_poison_data_count: 5123
Global model norm: 14.494602119430045.
Norm before scaling: 14.03236191046015. Distance: 1.177920451734462
Total norm for 5 adversaries is: 14.03236191046015. distance: 1.177920451734462
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.4789, Accuracy: 7519/8991 (83.6281%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  76, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4216/4462 (94.4868%), train_poison_data_count: 4462
Global model norm: 14.494602119430045.
Norm before scaling: 14.09691210542944. Distance: 1.0249745714708562
Total norm for 5 adversaries is: 14.09691210542944. distance: 1.0249745714708562
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.4203, Accuracy: 7418/8991 (82.5047%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  76, local model 5, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3712/3841 (96.6415%), train_poison_data_count: 3841
Global model norm: 14.494602119430045.
Norm before scaling: 14.14080250665522. Distance: 0.9485837280065734
Total norm for 5 adversaries is: 14.14080250665522. distance: 0.9485837280065734
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.8743, Accuracy: 6821/8991 (75.8648%)
___Train Local_Simple,  epoch  76, local model 6, internal_epoch   1,  Average loss: 0.0035, Accuracy: 2780/2945 (94.3973%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.5086, Accuracy: 8295/10000 (82.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 7, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2652/2756 (96.2264%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.7217, Accuracy: 7829/10000 (78.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3193/3437 (92.9008%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.2558, Accuracy: 9181/10000 (91.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 9, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5590/5809 (96.2300%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 1.2076, Accuracy: 6223/10000 (62.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2490/2592 (96.0648%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.6292, Accuracy: 7859/10000 (78.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 11, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2368/2510 (94.3426%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.3596, Accuracy: 8720/10000 (87.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4274/4373 (97.7361%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.9760, Accuracy: 6789/10000 (67.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4168/4339 (96.0590%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.7928, Accuracy: 7484/10000 (74.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2649/2782 (95.2193%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.8138, Accuracy: 7737/10000 (77.3700%), Attack Success Rate:0/10000(0.000)
time spent on training: 537.8741970062256
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.64433738 0.         0.01233636 0.58904333 0.93177229 0.01233636
 0.51682784 0.         0.64433738 1.         1.         0.55319356
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 76: Average loss: 0.3807, Accuracy: 8496/10000 (84.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 76: Average loss: 0.3228, Accuracy: 7992/8991 (88.8889%)
Done in 566.3115351200104 sec.
Server Epoch:77 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  77, local model 0, internal_epoch   1,  Average loss: 0.0053, Accuracy: 2761/3010 (91.7276%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.3703, Accuracy: 8848/10000 (88.4800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  77, local model 1, internal_epoch   1,  Average loss: 0.0026, Accuracy: 5574/5805 (96.0207%), train_poison_data_count: 5805
Global model norm: 14.501893018604395.
Norm before scaling: 13.923606619301713. Distance: 1.2624625738658501
Total norm for 5 adversaries is: 13.923606619301713. distance: 1.2624625738658501
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.8084, Accuracy: 6609/8991 (73.5068%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  77, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4551/4779 (95.2291%), train_poison_data_count: 4779
Global model norm: 14.501893018604395.
Norm before scaling: 14.076137050957687. Distance: 1.0957739496035488
Total norm for 5 adversaries is: 14.076137050957687. distance: 1.0957739496035488
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.1805, Accuracy: 8444/8991 (93.9161%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4882/5123 (95.2957%), train_poison_data_count: 5123
Global model norm: 14.501893018604395.
Norm before scaling: 14.018106468420081. Distance: 1.1178087761155473
Total norm for 5 adversaries is: 14.018106468420081. distance: 1.1178087761155473
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.3300, Accuracy: 8030/8991 (89.3115%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  77, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4222/4462 (94.6212%), train_poison_data_count: 4462
Global model norm: 14.501893018604395.
Norm before scaling: 14.108928348065964. Distance: 1.0435928020767131
Total norm for 5 adversaries is: 14.108928348065964. distance: 1.0435928020767131
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.4649, Accuracy: 7317/8991 (81.3814%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  77, local model 5, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3708/3841 (96.5374%), train_poison_data_count: 3841
Global model norm: 14.501893018604395.
Norm before scaling: 14.149914399551978. Distance: 0.9413516080201808
Total norm for 5 adversaries is: 14.149914399551978. distance: 0.9413516080201808
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.7177, Accuracy: 7126/8991 (79.2570%)
___Train Local_Simple,  epoch  77, local model 6, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2791/2945 (94.7708%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.5110, Accuracy: 8224/10000 (82.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2655/2756 (96.3353%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.5920, Accuracy: 7925/10000 (79.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3201/3437 (93.1335%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.2945, Accuracy: 9085/10000 (90.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 9, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5580/5809 (96.0578%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 1.0060, Accuracy: 6624/10000 (66.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2504/2592 (96.6049%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.6368, Accuracy: 7868/10000 (78.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 11, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2375/2510 (94.6215%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.2667, Accuracy: 9175/10000 (91.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4269/4373 (97.6218%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 1.3210, Accuracy: 5787/10000 (57.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4160/4339 (95.8746%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.7841, Accuracy: 7372/10000 (73.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 14, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2657/2782 (95.5068%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.8804, Accuracy: 7365/10000 (73.6500%), Attack Success Rate:0/10000(0.000)
time spent on training: 543.754378080368
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.6953292  0.         0.         0.         0.85004473 1.
 1.         0.         0.6953292  1.         1.         0.9684294
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 77: Average loss: 0.3691, Accuracy: 8537/10000 (85.3700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 77: Average loss: 0.3170, Accuracy: 7999/8991 (88.9667%)
Done in 571.9759922027588 sec.
Server Epoch:78 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0054, Accuracy: 2757/3010 (91.5947%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.3931, Accuracy: 8762/10000 (87.6200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5612/5805 (96.6753%), train_poison_data_count: 5805
Global model norm: 14.510039438500364.
Norm before scaling: 13.911070530364702. Distance: 1.1818070223588193
Total norm for 5 adversaries is: 13.911070530364702. distance: 1.1818070223588193
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.6609, Accuracy: 7025/8991 (78.1337%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4534/4779 (94.8734%), train_poison_data_count: 4779
Global model norm: 14.510039438500364.
Norm before scaling: 14.08434392850744. Distance: 1.0985489876875334
Total norm for 5 adversaries is: 14.08434392850744. distance: 1.0985489876875334
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.2314, Accuracy: 8301/8991 (92.3257%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4867/5123 (95.0029%), train_poison_data_count: 5123
Global model norm: 14.510039438500364.
Norm before scaling: 14.027728821991118. Distance: 1.1348441485814336
Total norm for 5 adversaries is: 14.027728821991118. distance: 1.1348441485814336
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.2337, Accuracy: 8284/8991 (92.1366%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4221/4462 (94.5988%), train_poison_data_count: 4462
Global model norm: 14.510039438500364.
Norm before scaling: 14.11225572751394. Distance: 1.0537238345625226
Total norm for 5 adversaries is: 14.11225572751394. distance: 1.0537238345625226
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.3520, Accuracy: 7950/8991 (88.4218%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3716/3841 (96.7456%), train_poison_data_count: 3841
Global model norm: 14.510039438500364.
Norm before scaling: 14.156961385271293. Distance: 0.9081181640262693
Total norm for 5 adversaries is: 14.156961385271293. distance: 0.9081181640262693
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.9655, Accuracy: 6837/8991 (76.0427%)
___Train Local_Simple,  epoch  78, local model 6, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2798/2945 (95.0085%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.4290, Accuracy: 8438/10000 (84.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 7, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2653/2756 (96.2627%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.5193, Accuracy: 8098/10000 (80.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3204/3437 (93.2208%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.3449, Accuracy: 8844/10000 (88.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 9, internal_epoch   1,  Average loss: 0.0027, Accuracy: 5579/5809 (96.0406%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 1.2076, Accuracy: 6369/10000 (63.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2507/2592 (96.7207%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.7178, Accuracy: 7808/10000 (78.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 11, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2377/2510 (94.7012%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.2674, Accuracy: 9158/10000 (91.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 12, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4252/4373 (97.2330%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.8435, Accuracy: 7305/10000 (73.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4161/4339 (95.8977%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.6350, Accuracy: 7677/10000 (76.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2657/2782 (95.5068%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.9444, Accuracy: 7522/10000 (75.2200%), Attack Success Rate:0/10000(0.000)
time spent on training: 549.1765162944794
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.37869856 0.         0.22983232 0.22983232 1.         0.89271447
 1.         0.         0.37869856 1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 78: Average loss: 0.3657, Accuracy: 8557/10000 (85.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 78: Average loss: 0.3113, Accuracy: 8024/8991 (89.2448%)
Done in 577.5951480865479 sec.
Server Epoch:79 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  79, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2797/3010 (92.9236%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.4386, Accuracy: 8613/10000 (86.1300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5607/5805 (96.5891%), train_poison_data_count: 5805
Global model norm: 14.518236990842436.
Norm before scaling: 13.920734534340706. Distance: 1.2093500376251816
Total norm for 5 adversaries is: 13.920734534340706. distance: 1.2093500376251816
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.7786, Accuracy: 6724/8991 (74.7859%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  79, local model 2, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4539/4779 (94.9780%), train_poison_data_count: 4779
Global model norm: 14.518236990842436.
Norm before scaling: 14.099005351594732. Distance: 1.0691408859102087
Total norm for 5 adversaries is: 14.099005351594732. distance: 1.0691408859102087
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.1768, Accuracy: 8498/8991 (94.5167%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  79, local model 3, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4875/5123 (95.1591%), train_poison_data_count: 5123
Global model norm: 14.518236990842436.
Norm before scaling: 14.032575582915433. Distance: 1.1273631072414747
Total norm for 5 adversaries is: 14.032575582915433. distance: 1.1273631072414747
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.2598, Accuracy: 8221/8991 (91.4359%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4237/4462 (94.9574%), train_poison_data_count: 4462
Global model norm: 14.518236990842436.
Norm before scaling: 14.123519954953466. Distance: 1.013738611630067
Total norm for 5 adversaries is: 14.123519954953466. distance: 1.013738611630067
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.3971, Accuracy: 7608/8991 (84.6180%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  79, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3718/3841 (96.7977%), train_poison_data_count: 3841
Global model norm: 14.518236990842436.
Norm before scaling: 14.150975472084015. Distance: 0.8686127506215283
Total norm for 5 adversaries is: 14.150975472084015. distance: 0.8686127506215283
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.7653, Accuracy: 7017/8991 (78.0447%)
___Train Local_Simple,  epoch  79, local model 6, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2799/2945 (95.0424%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.4854, Accuracy: 8289/10000 (82.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 7, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2651/2756 (96.1901%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.5327, Accuracy: 8178/10000 (81.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 8, internal_epoch   1,  Average loss: 0.0044, Accuracy: 3188/3437 (92.7553%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.3368, Accuracy: 8816/10000 (88.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 9, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5587/5809 (96.1783%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 1.3210, Accuracy: 6319/10000 (63.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2510/2592 (96.8364%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.4715, Accuracy: 8477/10000 (84.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 11, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2362/2510 (94.1036%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.2753, Accuracy: 9216/10000 (92.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4274/4373 (97.7361%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 1.0934, Accuracy: 6453/10000 (64.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4178/4339 (96.2895%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.7102, Accuracy: 7516/10000 (75.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 14, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2642/2782 (94.9676%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.9166, Accuracy: 7487/10000 (74.8700%), Attack Success Rate:0/10000(0.000)
time spent on training: 552.390184879303
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [1.         0.82874458 0.35933164 0.56970029 0.65897028 0.35933164
 1.         0.82874458 1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 79: Average loss: 0.3583, Accuracy: 8594/10000 (85.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 79: Average loss: 0.3008, Accuracy: 8059/8991 (89.6341%)
Done in 580.6670818328857 sec.
Server Epoch:80 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  80, local model 0, internal_epoch   1,  Average loss: 0.0050, Accuracy: 2760/3010 (91.6944%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.3448, Accuracy: 8930/10000 (89.3000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5607/5805 (96.5891%), train_poison_data_count: 5805
Global model norm: 14.528357827102957.
Norm before scaling: 13.931016175064972. Distance: 1.1989874104084635
Total norm for 5 adversaries is: 13.931016175064972. distance: 1.1989874104084635
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.7515, Accuracy: 6790/8991 (75.5200%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  80, local model 2, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4550/4779 (95.2082%), train_poison_data_count: 4779
Global model norm: 14.528357827102957.
Norm before scaling: 14.091530364986754. Distance: 1.0818460905112068
Total norm for 5 adversaries is: 14.091530364986754. distance: 1.0818460905112068
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.2387, Accuracy: 8321/8991 (92.5481%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4879/5123 (95.2372%), train_poison_data_count: 5123
Global model norm: 14.528357827102957.
Norm before scaling: 14.039022285348636. Distance: 1.1273012995245184
Total norm for 5 adversaries is: 14.039022285348636. distance: 1.1273012995245184
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.3607, Accuracy: 7795/8991 (86.6978%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  80, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4219/4462 (94.5540%), train_poison_data_count: 4462
Global model norm: 14.528357827102957.
Norm before scaling: 14.11960843243028. Distance: 1.014595390159411
Total norm for 5 adversaries is: 14.11960843243028. distance: 1.014595390159411
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.3586, Accuracy: 7899/8991 (87.8545%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  80, local model 5, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3701/3841 (96.3551%), train_poison_data_count: 3841
Global model norm: 14.528357827102957.
Norm before scaling: 14.162990018173522. Distance: 0.8881509448777829
Total norm for 5 adversaries is: 14.162990018173522. distance: 0.8881509448777829
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.6536, Accuracy: 7208/8991 (80.1691%)
___Train Local_Simple,  epoch  80, local model 6, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2804/2945 (95.2122%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.4650, Accuracy: 8373/10000 (83.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2656/2756 (96.3716%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.5821, Accuracy: 8019/10000 (80.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 3196/3437 (92.9881%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.2839, Accuracy: 8975/10000 (89.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 9, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5601/5809 (96.4193%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 1.1228, Accuracy: 6304/10000 (63.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 10, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2511/2592 (96.8750%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.6333, Accuracy: 7990/10000 (79.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 11, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2374/2510 (94.5817%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.3325, Accuracy: 8898/10000 (88.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4270/4373 (97.6446%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 1.1641, Accuracy: 6405/10000 (64.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4164/4339 (95.9668%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 1.0089, Accuracy: 6762/10000 (67.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2661/2782 (95.6506%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.6688, Accuracy: 8050/10000 (80.5000%), Attack Success Rate:0/10000(0.000)
time spent on training: 553.5461568832397
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.5787581  0.05980776 0.         0.         0.48003879 0.522792
 1.         0.05980776 1.         1.         0.5787581  1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 80: Average loss: 0.3479, Accuracy: 8643/10000 (86.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 80: Average loss: 0.2975, Accuracy: 8057/8991 (89.6118%)
Done in 583.1334638595581 sec.
Server Epoch:81 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  81, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2782/3010 (92.4252%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.3670, Accuracy: 8852/10000 (88.5200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  81, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5625/5805 (96.8992%), train_poison_data_count: 5805
Global model norm: 14.535403997149565.
Norm before scaling: 13.927292716887766. Distance: 1.1475356317111696
Total norm for 5 adversaries is: 13.927292716887766. distance: 1.1475356317111696
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.6750, Accuracy: 7022/8991 (78.1003%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  81, local model 2, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4538/4779 (94.9571%), train_poison_data_count: 4779
Global model norm: 14.535403997149565.
Norm before scaling: 14.106982597558293. Distance: 1.091199462349611
Total norm for 5 adversaries is: 14.106982597558293. distance: 1.091199462349611
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.2647, Accuracy: 8244/8991 (91.6917%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  81, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4891/5123 (95.4714%), train_poison_data_count: 5123
Global model norm: 14.535403997149565.
Norm before scaling: 14.049451954426072. Distance: 1.1244326856487936
Total norm for 5 adversaries is: 14.049451954426072. distance: 1.1244326856487936
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.2190, Accuracy: 8387/8991 (93.2822%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  81, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4234/4462 (94.8902%), train_poison_data_count: 4462
Global model norm: 14.535403997149565.
Norm before scaling: 14.123788427193775. Distance: 0.9873000087306454
Total norm for 5 adversaries is: 14.123788427193775. distance: 0.9873000087306454
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.3848, Accuracy: 7709/8991 (85.7413%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  81, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3710/3841 (96.5894%), train_poison_data_count: 3841
Global model norm: 14.535403997149565.
Norm before scaling: 14.157732012311218. Distance: 0.8902801046640263
Total norm for 5 adversaries is: 14.157732012311218. distance: 0.8902801046640263
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.7337, Accuracy: 7064/8991 (78.5675%)
___Train Local_Simple,  epoch  81, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2816/2945 (95.6197%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.4543, Accuracy: 8394/10000 (83.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2651/2756 (96.1901%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.6112, Accuracy: 7948/10000 (79.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 8, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3212/3437 (93.4536%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.2391, Accuracy: 9287/10000 (92.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 9, internal_epoch   1,  Average loss: 0.0024, Accuracy: 5597/5809 (96.3505%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.8508, Accuracy: 6784/10000 (67.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2501/2592 (96.4892%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.5212, Accuracy: 8283/10000 (82.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0035, Accuracy: 2387/2510 (95.0996%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.2987, Accuracy: 9012/10000 (90.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4260/4373 (97.4160%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 1.2271, Accuracy: 6159/10000 (61.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4171/4339 (96.1281%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.8663, Accuracy: 7368/10000 (73.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 14, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2657/2782 (95.5068%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.9005, Accuracy: 7693/10000 (76.9300%), Attack Success Rate:0/10000(0.000)
time spent on training: 558.0865850448608
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.87546934 1.         0.         0.47371024 0.50546515 0.
 0.93638606 1.         1.         1.         0.87546934 0.93638606
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 81: Average loss: 0.3382, Accuracy: 8676/10000 (86.7600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 81: Average loss: 0.2968, Accuracy: 8032/8991 (89.3338%)
Done in 586.5017042160034 sec.
Server Epoch:82 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  82, local model 0, internal_epoch   1,  Average loss: 0.0048, Accuracy: 2799/3010 (92.9900%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.4189, Accuracy: 8678/10000 (86.7800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5623/5805 (96.8648%), train_poison_data_count: 5805
Global model norm: 14.544099241751146.
Norm before scaling: 13.923660317976399. Distance: 1.1584163681749597
Total norm for 5 adversaries is: 13.923660317976399. distance: 1.1584163681749597
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.6866, Accuracy: 6821/8991 (75.8648%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  82, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4586/4779 (95.9615%), train_poison_data_count: 4779
Global model norm: 14.544099241751146.
Norm before scaling: 14.108367039023776. Distance: 1.0298599932244314
Total norm for 5 adversaries is: 14.108367039023776. distance: 1.0298599932244314
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.2051, Accuracy: 8421/8991 (93.6603%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4895/5123 (95.5495%), train_poison_data_count: 5123
Global model norm: 14.544099241751146.
Norm before scaling: 14.044986924694653. Distance: 1.1070225986527635
Total norm for 5 adversaries is: 14.044986924694653. distance: 1.1070225986527635
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.3585, Accuracy: 7945/8991 (88.3661%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  82, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4240/4462 (95.0247%), train_poison_data_count: 4462
Global model norm: 14.544099241751146.
Norm before scaling: 14.127726873987074. Distance: 0.991698978335766
Total norm for 5 adversaries is: 14.127726873987074. distance: 0.991698978335766
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.4268, Accuracy: 7748/8991 (86.1751%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  82, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3705/3841 (96.4593%), train_poison_data_count: 3841
Global model norm: 14.544099241751146.
Norm before scaling: 14.180762485078267. Distance: 0.9371990992536462
Total norm for 5 adversaries is: 14.180762485078267. distance: 0.9371990992536462
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.9621, Accuracy: 6656/8991 (74.0296%)
___Train Local_Simple,  epoch  82, local model 6, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2807/2945 (95.3141%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.4348, Accuracy: 8431/10000 (84.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2661/2756 (96.5530%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.5955, Accuracy: 8160/10000 (81.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3216/3437 (93.5700%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.2913, Accuracy: 8951/10000 (89.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 9, internal_epoch   1,  Average loss: 0.0023, Accuracy: 5604/5809 (96.4710%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 1.0597, Accuracy: 6335/10000 (63.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 10, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2495/2592 (96.2577%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.4152, Accuracy: 8673/10000 (86.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 11, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2380/2510 (94.8207%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.2667, Accuracy: 9174/10000 (91.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 12, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4280/4373 (97.8733%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.9138, Accuracy: 6887/10000 (68.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4178/4339 (96.2895%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.7018, Accuracy: 7732/10000 (77.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2664/2782 (95.7584%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.7207, Accuracy: 7932/10000 (79.3200%), Attack Success Rate:0/10000(0.000)
time spent on training: 562.7993099689484
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.8151263  0.69582453 0.13944533 0.84380251 0.86836907 0.13944533
 1.         1.         0.8151263  1.         0.98845409 1.
 1.         1.         0.86836907]
___Test Target_Simple poisoned: False, epoch: 82: Average loss: 0.3315, Accuracy: 8703/10000 (87.0300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 82: Average loss: 0.2832, Accuracy: 8086/8991 (89.9344%)
Done in 591.0178849697113 sec.
Server Epoch:83 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  83, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2783/3010 (92.4585%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.3958, Accuracy: 8746/10000 (87.4600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  83, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5626/5805 (96.9165%), train_poison_data_count: 5805
Global model norm: 14.553052989608723.
Norm before scaling: 13.928825381692164. Distance: 1.121621090944128
Total norm for 5 adversaries is: 13.928825381692164. distance: 1.121621090944128
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.6595, Accuracy: 6980/8991 (77.6332%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  83, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4558/4779 (95.3756%), train_poison_data_count: 4779
Global model norm: 14.553052989608723.
Norm before scaling: 14.10700855708564. Distance: 1.057972180078276
Total norm for 5 adversaries is: 14.10700855708564. distance: 1.057972180078276
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.1694, Accuracy: 8525/8991 (94.8170%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  83, local model 3, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4876/5123 (95.1786%), train_poison_data_count: 5123
Global model norm: 14.553052989608723.
Norm before scaling: 14.064249565644324. Distance: 1.1456363277426767
Total norm for 5 adversaries is: 14.064249565644324. distance: 1.1456363277426767
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.4045, Accuracy: 7754/8991 (86.2418%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  83, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4244/4462 (95.1143%), train_poison_data_count: 4462
Global model norm: 14.553052989608723.
Norm before scaling: 14.135843351591804. Distance: 0.9821198380237397
Total norm for 5 adversaries is: 14.135843351591804. distance: 0.9821198380237397
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.4253, Accuracy: 7517/8991 (83.6058%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  83, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3718/3841 (96.7977%), train_poison_data_count: 3841
Global model norm: 14.553052989608723.
Norm before scaling: 14.175521297389185. Distance: 0.9195520909102098
Total norm for 5 adversaries is: 14.175521297389185. distance: 0.9195520909102098
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.6416, Accuracy: 7142/8991 (79.4350%)
___Train Local_Simple,  epoch  83, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 2799/2945 (95.0424%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.5826, Accuracy: 8164/10000 (81.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 7, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2662/2756 (96.5893%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.5104, Accuracy: 8101/10000 (81.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 8, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3193/3437 (92.9008%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.3711, Accuracy: 8590/10000 (85.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 9, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5613/5809 (96.6259%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 1.1865, Accuracy: 6293/10000 (62.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 10, internal_epoch   1,  Average loss: 0.0018, Accuracy: 2514/2592 (96.9907%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.4385, Accuracy: 8588/10000 (85.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 11, internal_epoch   1,  Average loss: 0.0032, Accuracy: 2392/2510 (95.2988%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.2498, Accuracy: 9252/10000 (92.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4267/4373 (97.5760%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 1.0167, Accuracy: 6552/10000 (65.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4181/4339 (96.3586%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.6766, Accuracy: 7647/10000 (76.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2658/2782 (95.5428%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.9190, Accuracy: 7645/10000 (76.4500%), Attack Success Rate:0/10000(0.000)
time spent on training: 567.8359282016754
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.87297292 1.         0.13876977 0.13876977 1.         1.
 1.         1.         0.87297292 1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 83: Average loss: 0.3311, Accuracy: 8691/10000 (86.9100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 83: Average loss: 0.2660, Accuracy: 8172/8991 (90.8909%)
Done in 596.135605096817 sec.
Server Epoch:84 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  84, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2764/3010 (91.8272%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.3390, Accuracy: 8987/10000 (89.8700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  84, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5635/5805 (97.0715%), train_poison_data_count: 5805
Global model norm: 14.562352257498937.
Norm before scaling: 13.93520948807597. Distance: 1.1312402271670567
Total norm for 5 adversaries is: 13.93520948807597. distance: 1.1312402271670567
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.6445, Accuracy: 7172/8991 (79.7687%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4568/4779 (95.5849%), train_poison_data_count: 4779
Global model norm: 14.562352257498937.
Norm before scaling: 14.115398012793346. Distance: 1.0583210836787944
Total norm for 5 adversaries is: 14.115398012793346. distance: 1.0583210836787944
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.2150, Accuracy: 8373/8991 (93.1265%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  84, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4900/5123 (95.6471%), train_poison_data_count: 5123
Global model norm: 14.562352257498937.
Norm before scaling: 14.0596378380702. Distance: 1.0937691823094677
Total norm for 5 adversaries is: 14.0596378380702. distance: 1.0937691823094677
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.3645, Accuracy: 7802/8991 (86.7757%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  84, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4236/4462 (94.9350%), train_poison_data_count: 4462
Global model norm: 14.562352257498937.
Norm before scaling: 14.141938172796653. Distance: 0.9834584404407217
Total norm for 5 adversaries is: 14.141938172796653. distance: 0.9834584404407217
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.4277, Accuracy: 7514/8991 (83.5725%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  84, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3707/3841 (96.5113%), train_poison_data_count: 3841
Global model norm: 14.562352257498937.
Norm before scaling: 14.18487659012066. Distance: 0.8931162941723935
Total norm for 5 adversaries is: 14.18487659012066. distance: 0.8931162941723935
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.8453, Accuracy: 6904/8991 (76.7879%)
___Train Local_Simple,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2800/2945 (95.0764%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.4570, Accuracy: 8420/10000 (84.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2658/2756 (96.4441%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.6421, Accuracy: 8038/10000 (80.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3221/3437 (93.7154%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.2880, Accuracy: 9025/10000 (90.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 9, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5571/5809 (95.9029%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 1.1063, Accuracy: 6550/10000 (65.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2506/2592 (96.6821%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.4790, Accuracy: 8429/10000 (84.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 11, internal_epoch   1,  Average loss: 0.0034, Accuracy: 2379/2510 (94.7809%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.3008, Accuracy: 9122/10000 (91.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4268/4373 (97.5989%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 1.0986, Accuracy: 6057/10000 (60.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4174/4339 (96.1973%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.8400, Accuracy: 7177/10000 (71.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2677/2782 (96.2257%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.7786, Accuracy: 7789/10000 (77.8900%), Attack Success Rate:0/10000(0.000)
time spent on training: 575.8117110729218
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.94324426 0.         0.02839687 0.02839687 0.75847339 0.78338727
 0.90957811 0.         0.94324426 0.94302599 1.         1.
 1.         1.         0.90957811]
___Test Target_Simple poisoned: False, epoch: 84: Average loss: 0.3218, Accuracy: 8721/10000 (87.2100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 84: Average loss: 0.2651, Accuracy: 8155/8991 (90.7018%)
Done in 604.0678699016571 sec.
Server Epoch:85 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  85, local model 0, internal_epoch   1,  Average loss: 0.0046, Accuracy: 2789/3010 (92.6578%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.4873, Accuracy: 8380/10000 (83.8000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  85, local model 1, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5610/5805 (96.6408%), train_poison_data_count: 5805
Global model norm: 14.569503475360946.
Norm before scaling: 13.94455639581883. Distance: 1.118643232397557
Total norm for 5 adversaries is: 13.94455639581883. distance: 1.118643232397557
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.6126, Accuracy: 7167/8991 (79.7130%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4556/4779 (95.3338%), train_poison_data_count: 4779
Global model norm: 14.569503475360946.
Norm before scaling: 14.118051085581117. Distance: 1.0514545198183318
Total norm for 5 adversaries is: 14.118051085581117. distance: 1.0514545198183318
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.2462, Accuracy: 8299/8991 (92.3034%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  85, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4910/5123 (95.8423%), train_poison_data_count: 5123
Global model norm: 14.569503475360946.
Norm before scaling: 14.051090749301892. Distance: 1.085797197897544
Total norm for 5 adversaries is: 14.051090749301892. distance: 1.085797197897544
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.3730, Accuracy: 7797/8991 (86.7201%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  85, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4224/4462 (94.6661%), train_poison_data_count: 4462
Global model norm: 14.569503475360946.
Norm before scaling: 14.14347400943856. Distance: 0.9901148556542506
Total norm for 5 adversaries is: 14.14347400943856. distance: 0.9901148556542506
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.3833, Accuracy: 7769/8991 (86.4086%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  85, local model 5, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3708/3841 (96.5374%), train_poison_data_count: 3841
Global model norm: 14.569503475360946.
Norm before scaling: 14.196139624877723. Distance: 0.8846481278907813
Total norm for 5 adversaries is: 14.196139624877723. distance: 0.8846481278907813
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.7455, Accuracy: 7051/8991 (78.4229%)
___Train Local_Simple,  epoch  85, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2817/2945 (95.6537%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.4144, Accuracy: 8562/10000 (85.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 7, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2675/2756 (97.0610%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.5784, Accuracy: 8059/10000 (80.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 8, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3229/3437 (93.9482%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.2185, Accuracy: 9350/10000 (93.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 9, internal_epoch   1,  Average loss: 0.0025, Accuracy: 5587/5809 (96.1783%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 1.2180, Accuracy: 6330/10000 (63.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2513/2592 (96.9522%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.4855, Accuracy: 8422/10000 (84.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0034, Accuracy: 2370/2510 (94.4223%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.2725, Accuracy: 9193/10000 (91.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4272/4373 (97.6904%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.8119, Accuracy: 7324/10000 (73.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4186/4339 (96.4738%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.6631, Accuracy: 7678/10000 (76.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2687/2782 (96.5852%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.6715, Accuracy: 7987/10000 (79.8700%), Attack Success Rate:0/10000(0.000)
time spent on training: 578.7926361560822
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [1.         0.         0.09959985 0.09959985 0.69469432 1.
 1.         0.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 85: Average loss: 0.3086, Accuracy: 8787/10000 (87.8700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 85: Average loss: 0.2641, Accuracy: 8131/8991 (90.4349%)
Done in 607.1280481815338 sec.
Server Epoch:86 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  86, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2780/3010 (92.3588%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.4263, Accuracy: 8531/10000 (85.3100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5618/5805 (96.7786%), train_poison_data_count: 5805
Global model norm: 14.576962080156761.
Norm before scaling: 13.961070840857355. Distance: 1.165874632421325
Total norm for 5 adversaries is: 13.961070840857355. distance: 1.165874632421325
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.5545, Accuracy: 7292/8991 (81.1033%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  86, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4571/4779 (95.6476%), train_poison_data_count: 4779
Global model norm: 14.576962080156761.
Norm before scaling: 14.131985447746276. Distance: 1.0224638522597542
Total norm for 5 adversaries is: 14.131985447746276. distance: 1.0224638522597542
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.1646, Accuracy: 8515/8991 (94.7058%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  86, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4895/5123 (95.5495%), train_poison_data_count: 5123
Global model norm: 14.576962080156761.
Norm before scaling: 14.067761602469181. Distance: 1.0674801962666036
Total norm for 5 adversaries is: 14.067761602469181. distance: 1.0674801962666036
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.2498, Accuracy: 8285/8991 (92.1477%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  86, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4228/4462 (94.7557%), train_poison_data_count: 4462
Global model norm: 14.576962080156761.
Norm before scaling: 14.162808480063859. Distance: 1.0104570806751747
Total norm for 5 adversaries is: 14.162808480063859. distance: 1.0104570806751747
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.3058, Accuracy: 8147/8991 (90.6128%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  86, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3720/3841 (96.8498%), train_poison_data_count: 3841
Global model norm: 14.576962080156761.
Norm before scaling: 14.1965953560052. Distance: 0.9226790332484538
Total norm for 5 adversaries is: 14.1965953560052. distance: 0.9226790332484538
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.7170, Accuracy: 7114/8991 (79.1236%)
___Train Local_Simple,  epoch  86, local model 6, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2830/2945 (96.0951%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.3937, Accuracy: 8563/10000 (85.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 7, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2670/2756 (96.8795%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.4866, Accuracy: 8390/10000 (83.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3236/3437 (94.1519%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.2527, Accuracy: 9176/10000 (91.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 9, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5611/5809 (96.5915%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 1.2205, Accuracy: 6163/10000 (61.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 10, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2514/2592 (96.9907%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.4444, Accuracy: 8598/10000 (85.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 11, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2394/2510 (95.3785%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.3038, Accuracy: 8972/10000 (89.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 12, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4279/4373 (97.8504%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.9608, Accuracy: 6654/10000 (66.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4186/4339 (96.4738%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.8260, Accuracy: 7335/10000 (73.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 14, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2664/2782 (95.7584%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.7241, Accuracy: 7898/10000 (78.9800%), Attack Success Rate:0/10000(0.000)
time spent on training: 583.4406378269196
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.82082489 0.         0.29682898 0.29494816 0.29494816 0.29682898
 1.         0.         0.82082489 1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 86: Average loss: 0.3034, Accuracy: 8804/10000 (88.0400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 86: Average loss: 0.2602, Accuracy: 8139/8991 (90.5239%)
Done in 611.6198167800903 sec.
Server Epoch:87 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  87, local model 0, internal_epoch   1,  Average loss: 0.0045, Accuracy: 2797/3010 (92.9236%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.3269, Accuracy: 9040/10000 (90.4000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  87, local model 1, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5632/5805 (97.0198%), train_poison_data_count: 5805
Global model norm: 14.583563114354172.
Norm before scaling: 13.950807522060439. Distance: 1.1233885668203514
Total norm for 5 adversaries is: 13.950807522060439. distance: 1.1233885668203514
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.5740, Accuracy: 7296/8991 (81.1478%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  87, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4562/4779 (95.4593%), train_poison_data_count: 4779
Global model norm: 14.583563114354172.
Norm before scaling: 14.133558533031964. Distance: 1.0299701840983218
Total norm for 5 adversaries is: 14.133558533031964. distance: 1.0299701840983218
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.1728, Accuracy: 8494/8991 (94.4723%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  87, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4905/5123 (95.7447%), train_poison_data_count: 5123
Global model norm: 14.583563114354172.
Norm before scaling: 14.068777353267778. Distance: 1.116673384594044
Total norm for 5 adversaries is: 14.068777353267778. distance: 1.116673384594044
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.4811, Accuracy: 7410/8991 (82.4157%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  87, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4231/4462 (94.8229%), train_poison_data_count: 4462
Global model norm: 14.583563114354172.
Norm before scaling: 14.16003232704395. Distance: 1.009003578561537
Total norm for 5 adversaries is: 14.16003232704395. distance: 1.009003578561537
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.4998, Accuracy: 7282/8991 (80.9921%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3721/3841 (96.8758%), train_poison_data_count: 3841
Global model norm: 14.583563114354172.
Norm before scaling: 14.207829232469802. Distance: 0.9361109297463241
Total norm for 5 adversaries is: 14.207829232469802. distance: 0.9361109297463241
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.7845, Accuracy: 6887/8991 (76.5988%)
___Train Local_Simple,  epoch  87, local model 6, internal_epoch   1,  Average loss: 0.0031, Accuracy: 2803/2945 (95.1783%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.4023, Accuracy: 8536/10000 (85.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 7, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2674/2756 (97.0247%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.5576, Accuracy: 8105/10000 (81.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3232/3437 (94.0355%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.2335, Accuracy: 9324/10000 (93.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 9, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5619/5809 (96.7292%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 1.0047, Accuracy: 6414/10000 (64.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2519/2592 (97.1836%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.4803, Accuracy: 8279/10000 (82.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 11, internal_epoch   1,  Average loss: 0.0031, Accuracy: 2391/2510 (95.2590%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.2866, Accuracy: 9079/10000 (90.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4270/4373 (97.6446%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.8657, Accuracy: 7128/10000 (71.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4180/4339 (96.3356%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.6081, Accuracy: 7790/10000 (77.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2676/2782 (96.1898%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.6679, Accuracy: 8008/10000 (80.0800%), Attack Success Rate:0/10000(0.000)
time spent on training: 589.885772228241
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [1.         0.         0.16642612 0.66775325 0.71984649 0.16642612
 1.         0.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 87: Average loss: 0.2978, Accuracy: 8820/10000 (88.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 87: Average loss: 0.2540, Accuracy: 8162/8991 (90.7797%)
Done in 618.1546840667725 sec.
Server Epoch:88 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  88, local model 0, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2807/3010 (93.2558%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.3511, Accuracy: 8918/10000 (89.1800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5624/5805 (96.8820%), train_poison_data_count: 5805
Global model norm: 14.590967995506618.
Norm before scaling: 13.959232920036126. Distance: 1.1284813526794923
Total norm for 5 adversaries is: 13.959232920036126. distance: 1.1284813526794923
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.3930, Accuracy: 7836/8991 (87.1538%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  88, local model 2, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4557/4779 (95.3547%), train_poison_data_count: 4779
Global model norm: 14.590967995506618.
Norm before scaling: 14.137793764389622. Distance: 1.0619720942679738
Total norm for 5 adversaries is: 14.137793764389622. distance: 1.0619720942679738
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.1798, Accuracy: 8477/8991 (94.2832%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  88, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4898/5123 (95.6080%), train_poison_data_count: 5123
Global model norm: 14.590967995506618.
Norm before scaling: 14.076422144863042. Distance: 1.0777808483206759
Total norm for 5 adversaries is: 14.076422144863042. distance: 1.0777808483206759
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.3536, Accuracy: 7848/8991 (87.2873%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  88, local model 4, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4234/4462 (94.8902%), train_poison_data_count: 4462
Global model norm: 14.590967995506618.
Norm before scaling: 14.17120743328484. Distance: 1.0350846175834425
Total norm for 5 adversaries is: 14.17120743328484. distance: 1.0350846175834425
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.3729, Accuracy: 7713/8991 (85.7858%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  88, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3716/3841 (96.7456%), train_poison_data_count: 3841
Global model norm: 14.590967995506618.
Norm before scaling: 14.204505979171. Distance: 0.9086675625419072
Total norm for 5 adversaries is: 14.204505979171. distance: 0.9086675625419072
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.6328, Accuracy: 7202/8991 (80.1023%)
___Train Local_Simple,  epoch  88, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2818/2945 (95.6876%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.3916, Accuracy: 8546/10000 (85.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 7, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2664/2756 (96.6618%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.7469, Accuracy: 7617/10000 (76.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3237/3437 (94.1810%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.2204, Accuracy: 9301/10000 (93.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 9, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5618/5809 (96.7120%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 1.0676, Accuracy: 6442/10000 (64.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 10, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2510/2592 (96.8364%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.5164, Accuracy: 8349/10000 (83.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 11, internal_epoch   1,  Average loss: 0.0030, Accuracy: 2385/2510 (95.0199%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.2809, Accuracy: 9074/10000 (90.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4290/4373 (98.1020%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.8759, Accuracy: 7258/10000 (72.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4175/4339 (96.2203%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.7440, Accuracy: 7468/10000 (74.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2664/2782 (95.7584%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.6656, Accuracy: 8039/10000 (80.3900%), Attack Success Rate:0/10000(0.000)
time spent on training: 593.9677739143372
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [1.         0.38719201 0.51546749 0.72399378 1.         0.51546749
 1.         0.38719201 1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 88: Average loss: 0.2983, Accuracy: 8824/10000 (88.2400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 88: Average loss: 0.2433, Accuracy: 8217/8991 (91.3914%)
Done in 622.1132380962372 sec.
Server Epoch:89 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  89, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 2808/3010 (93.2890%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.3559, Accuracy: 8890/10000 (88.9000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  89, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5634/5805 (97.0543%), train_poison_data_count: 5805
Global model norm: 14.599781693172034.
Norm before scaling: 13.96992422882044. Distance: 1.1053178771893628
Total norm for 5 adversaries is: 13.96992422882044. distance: 1.1053178771893628
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.5660, Accuracy: 7285/8991 (81.0255%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  89, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4562/4779 (95.4593%), train_poison_data_count: 4779
Global model norm: 14.599781693172034.
Norm before scaling: 14.134428675210376. Distance: 1.025401320628742
Total norm for 5 adversaries is: 14.134428675210376. distance: 1.025401320628742
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.1749, Accuracy: 8470/8991 (94.2053%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  89, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4920/5123 (96.0375%), train_poison_data_count: 5123
Global model norm: 14.599781693172034.
Norm before scaling: 14.080002671154809. Distance: 1.1011591504279605
Total norm for 5 adversaries is: 14.080002671154809. distance: 1.1011591504279605
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.4171, Accuracy: 7697/8991 (85.6078%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4193/4462 (93.9713%), train_poison_data_count: 4462
Global model norm: 14.599781693172034.
Norm before scaling: 14.206187036712924. Distance: 1.070744225521402
Total norm for 5 adversaries is: 14.206187036712924. distance: 1.070744225521402
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.4557, Accuracy: 7356/8991 (81.8151%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  89, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3714/3841 (96.6936%), train_poison_data_count: 3841
Global model norm: 14.599781693172034.
Norm before scaling: 14.21488507739939. Distance: 0.8620557414882174
Total norm for 5 adversaries is: 14.21488507739939. distance: 0.8620557414882174
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.7125, Accuracy: 7165/8991 (79.6908%)
___Train Local_Simple,  epoch  89, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2827/2945 (95.9932%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.3601, Accuracy: 8666/10000 (86.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 7, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2669/2756 (96.8433%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.6159, Accuracy: 7987/10000 (79.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3244/3437 (94.3846%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.2441, Accuracy: 9171/10000 (91.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 9, internal_epoch   1,  Average loss: 0.0022, Accuracy: 5615/5809 (96.6604%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 1.0486, Accuracy: 6540/10000 (65.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 2525/2592 (97.4151%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.4744, Accuracy: 8456/10000 (84.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2409/2510 (95.9761%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.2734, Accuracy: 9086/10000 (90.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 12, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4283/4373 (97.9419%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 1.1842, Accuracy: 6206/10000 (62.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4182/4339 (96.3817%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.6137, Accuracy: 7883/10000 (78.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2670/2782 (95.9741%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.5789, Accuracy: 8164/10000 (81.6400%), Attack Success Rate:0/10000(0.000)
time spent on training: 597.4882428646088
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.55705056 0.         0.         0.5414014  0.67875187 0.
 1.         0.         1.         1.         0.55705056 1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 89: Average loss: 0.2898, Accuracy: 8854/10000 (88.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 89: Average loss: 0.2407, Accuracy: 8211/8991 (91.3247%)
Done in 625.7416458129883 sec.
Server Epoch:90 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  90, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2809/3010 (93.3223%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.3713, Accuracy: 8836/10000 (88.3600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  90, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5637/5805 (97.1059%), train_poison_data_count: 5805
Global model norm: 14.606084606065078.
Norm before scaling: 13.966629037980866. Distance: 1.0910932699697096
Total norm for 5 adversaries is: 13.966629037980866. distance: 1.0910932699697096
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.5328, Accuracy: 7391/8991 (82.2044%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4558/4779 (95.3756%), train_poison_data_count: 4779
Global model norm: 14.606084606065078.
Norm before scaling: 14.150712907173617. Distance: 1.012068110058749
Total norm for 5 adversaries is: 14.150712907173617. distance: 1.012068110058749
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.1394, Accuracy: 8616/8991 (95.8292%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4909/5123 (95.8228%), train_poison_data_count: 5123
Global model norm: 14.606084606065078.
Norm before scaling: 14.0832328717563. Distance: 1.0681455073834942
Total norm for 5 adversaries is: 14.0832328717563. distance: 1.0681455073834942
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.2596, Accuracy: 8228/8991 (91.5137%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4241/4462 (95.0471%), train_poison_data_count: 4462
Global model norm: 14.606084606065078.
Norm before scaling: 14.182261302222972. Distance: 0.9700944554165651
Total norm for 5 adversaries is: 14.182261302222972. distance: 0.9700944554165651
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.3054, Accuracy: 8029/8991 (89.3004%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  90, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3724/3841 (96.9539%), train_poison_data_count: 3841
Global model norm: 14.606084606065078.
Norm before scaling: 14.222481374233881. Distance: 0.9252442681774841
Total norm for 5 adversaries is: 14.222481374233881. distance: 0.9252442681774841
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.8090, Accuracy: 6989/8991 (77.7333%)
___Train Local_Simple,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2833/2945 (96.1969%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.4045, Accuracy: 8528/10000 (85.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 7, internal_epoch   1,  Average loss: 0.0022, Accuracy: 2661/2756 (96.5530%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.5470, Accuracy: 8039/10000 (80.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3230/3437 (93.9773%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.3207, Accuracy: 8875/10000 (88.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 9, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5618/5809 (96.7120%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 1.2003, Accuracy: 6377/10000 (63.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 2521/2592 (97.2608%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.4460, Accuracy: 8592/10000 (85.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 11, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2402/2510 (95.6972%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.2482, Accuracy: 9244/10000 (92.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4293/4373 (98.1706%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.8413, Accuracy: 7365/10000 (73.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4187/4339 (96.4969%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.5910, Accuracy: 7992/10000 (79.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2669/2782 (95.9382%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.6730, Accuracy: 8008/10000 (80.0800%), Attack Success Rate:0/10000(0.000)
time spent on training: 604.282567024231
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.80411641 0.32745385 0.01940662 0.01940662 0.70249084 1.
 1.         0.32745385 0.80411641 1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 90: Average loss: 0.2887, Accuracy: 8854/10000 (88.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 90: Average loss: 0.2365, Accuracy: 8223/8991 (91.4581%)
Done in 632.5296499729156 sec.
Server Epoch:91 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  91, local model 0, internal_epoch   1,  Average loss: 0.0049, Accuracy: 2784/3010 (92.4917%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.3303, Accuracy: 8967/10000 (89.6700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  91, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5639/5805 (97.1404%), train_poison_data_count: 5805
Global model norm: 14.612954420296001.
Norm before scaling: 13.977728430966305. Distance: 1.1009265876811758
Total norm for 5 adversaries is: 13.977728430966305. distance: 1.1009265876811758
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.5611, Accuracy: 7313/8991 (81.3369%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  91, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4593/4779 (96.1080%), train_poison_data_count: 4779
Global model norm: 14.612954420296001.
Norm before scaling: 14.137929214721254. Distance: 1.0238393329587607
Total norm for 5 adversaries is: 14.137929214721254. distance: 1.0238393329587607
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.2825, Accuracy: 8095/8991 (90.0345%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  91, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4892/5123 (95.4909%), train_poison_data_count: 5123
Global model norm: 14.612954420296001.
Norm before scaling: 14.094851025798503. Distance: 1.1013930170068162
Total norm for 5 adversaries is: 14.094851025798503. distance: 1.1013930170068162
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.3079, Accuracy: 8091/8991 (89.9900%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  91, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4236/4462 (94.9350%), train_poison_data_count: 4462
Global model norm: 14.612954420296001.
Norm before scaling: 14.191164324940393. Distance: 1.0038236591490048
Total norm for 5 adversaries is: 14.191164324940393. distance: 1.0038236591490048
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.4295, Accuracy: 7635/8991 (84.9183%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  91, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3730/3841 (97.1101%), train_poison_data_count: 3841
Global model norm: 14.612954420296001.
Norm before scaling: 14.21349598155141. Distance: 0.8822624383353876
Total norm for 5 adversaries is: 14.21349598155141. distance: 0.8822624383353876
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.6067, Accuracy: 7287/8991 (81.0477%)
___Train Local_Simple,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2814/2945 (95.5518%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.3578, Accuracy: 8680/10000 (86.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2667/2756 (96.7707%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.7852, Accuracy: 7853/10000 (78.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3234/3437 (94.0937%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.2172, Accuracy: 9353/10000 (93.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5627/5809 (96.8669%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.8824, Accuracy: 6692/10000 (66.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 10, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2511/2592 (96.8750%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.5394, Accuracy: 8303/10000 (83.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2395/2510 (95.4183%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.2410, Accuracy: 9268/10000 (92.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4285/4373 (97.9877%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.9641, Accuracy: 6749/10000 (67.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4183/4339 (96.4047%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.6352, Accuracy: 7798/10000 (77.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2666/2782 (95.8303%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.7463, Accuracy: 7760/10000 (77.6000%), Attack Success Rate:0/10000(0.000)
time spent on training: 602.2521200180054
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.33533624 0.02731606 0.24154848 0.24154848 1.         1.
 1.         0.02731606 1.         1.         0.33533624 1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 91: Average loss: 0.2911, Accuracy: 8847/10000 (88.4700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 91: Average loss: 0.2335, Accuracy: 8238/8991 (91.6250%)
Done in 631.7138760089874 sec.
Server Epoch:92 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  92, local model 0, internal_epoch   1,  Average loss: 0.0044, Accuracy: 2807/3010 (93.2558%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.3215, Accuracy: 9008/10000 (90.0800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  92, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5621/5805 (96.8303%), train_poison_data_count: 5805
Global model norm: 14.619363856219834.
Norm before scaling: 13.98452121082784. Distance: 1.1294224492773197
Total norm for 5 adversaries is: 13.98452121082784. distance: 1.1294224492773197
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.5095, Accuracy: 7472/8991 (83.1053%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  92, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4589/4779 (96.0243%), train_poison_data_count: 4779
Global model norm: 14.619363856219834.
Norm before scaling: 14.1386598686318. Distance: 0.9846907517970563
Total norm for 5 adversaries is: 14.1386598686318. distance: 0.9846907517970563
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.1824, Accuracy: 8476/8991 (94.2720%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  92, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4910/5123 (95.8423%), train_poison_data_count: 5123
Global model norm: 14.619363856219834.
Norm before scaling: 14.105889009074478. Distance: 1.077081866727577
Total norm for 5 adversaries is: 14.105889009074478. distance: 1.077081866727577
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.4444, Accuracy: 7588/8991 (84.3955%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  92, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4226/4462 (94.7109%), train_poison_data_count: 4462
Global model norm: 14.619363856219834.
Norm before scaling: 14.202230595291569. Distance: 1.0343750507089655
Total norm for 5 adversaries is: 14.202230595291569. distance: 1.0343750507089655
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.3758, Accuracy: 7857/8991 (87.3874%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  92, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3720/3841 (96.8498%), train_poison_data_count: 3841
Global model norm: 14.619363856219834.
Norm before scaling: 14.222057586617709. Distance: 0.8514698223113282
Total norm for 5 adversaries is: 14.222057586617709. distance: 0.8514698223113282
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.6481, Accuracy: 7193/8991 (80.0022%)
___Train Local_Simple,  epoch  92, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2821/2945 (95.7895%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.3950, Accuracy: 8648/10000 (86.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 7, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2670/2756 (96.8795%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.5317, Accuracy: 8027/10000 (80.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3233/3437 (94.0646%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.2440, Accuracy: 9058/10000 (90.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 9, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5623/5809 (96.7981%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.8780, Accuracy: 6817/10000 (68.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 2528/2592 (97.5309%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.4492, Accuracy: 8461/10000 (84.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 11, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2403/2510 (95.7371%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.2162, Accuracy: 9352/10000 (93.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4286/4373 (98.0105%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.8237, Accuracy: 7266/10000 (72.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4196/4339 (96.7043%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.7189, Accuracy: 7582/10000 (75.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 14, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2686/2782 (96.5492%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.6376, Accuracy: 8128/10000 (81.2800%), Attack Success Rate:0/10000(0.000)
time spent on training: 605.9383659362793
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [1.00000000e+00 0.00000000e+00 4.78509750e-04 9.20762903e-02
 9.20762903e-02 4.78509750e-04 1.00000000e+00 0.00000000e+00
 1.00000000e+00 1.00000000e+00 1.00000000e+00 1.00000000e+00
 1.00000000e+00 1.00000000e+00 1.00000000e+00]
___Test Target_Simple poisoned: False, epoch: 92: Average loss: 0.2774, Accuracy: 8909/10000 (89.0900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 92: Average loss: 0.2378, Accuracy: 8204/8991 (91.2468%)
Done in 634.3209121227264 sec.
Server Epoch:93 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  93, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 2816/3010 (93.5548%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.4221, Accuracy: 8620/10000 (86.2000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  93, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5627/5805 (96.9337%), train_poison_data_count: 5805
Global model norm: 14.624698472786434.
Norm before scaling: 13.993176568546387. Distance: 1.1041997088880524
Total norm for 5 adversaries is: 13.993176568546387. distance: 1.1041997088880524
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.5150, Accuracy: 7457/8991 (82.9385%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4561/4779 (95.4384%), train_poison_data_count: 4779
Global model norm: 14.624698472786434.
Norm before scaling: 14.169902895619613. Distance: 1.0363540341344615
Total norm for 5 adversaries is: 14.169902895619613. distance: 1.0363540341344615
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.1664, Accuracy: 8522/8991 (94.7837%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  93, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4917/5123 (95.9789%), train_poison_data_count: 5123
Global model norm: 14.624698472786434.
Norm before scaling: 14.086566862326565. Distance: 1.057962884172599
Total norm for 5 adversaries is: 14.086566862326565. distance: 1.057962884172599
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.2678, Accuracy: 8232/8991 (91.5582%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  93, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4255/4462 (95.3608%), train_poison_data_count: 4462
Global model norm: 14.624698472786434.
Norm before scaling: 14.183650767580245. Distance: 0.9867757253741362
Total norm for 5 adversaries is: 14.183650767580245. distance: 0.9867757253741362
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.2815, Accuracy: 8243/8991 (91.6806%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  93, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3729/3841 (97.0841%), train_poison_data_count: 3841
Global model norm: 14.624698472786434.
Norm before scaling: 14.229338541105234. Distance: 0.9018874562884356
Total norm for 5 adversaries is: 14.229338541105234. distance: 0.9018874562884356
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.6690, Accuracy: 7175/8991 (79.8020%)
___Train Local_Simple,  epoch  93, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2823/2945 (95.8574%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.2971, Accuracy: 8906/10000 (89.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2667/2756 (96.7707%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.6175, Accuracy: 8082/10000 (80.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3244/3437 (94.3846%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.3069, Accuracy: 8963/10000 (89.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 9, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5607/5809 (96.5226%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.9453, Accuracy: 6538/10000 (65.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2525/2592 (97.4151%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.5245, Accuracy: 8183/10000 (81.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 11, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2401/2510 (95.6574%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.2545, Accuracy: 9210/10000 (92.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4289/4373 (98.0791%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.7628, Accuracy: 7578/10000 (75.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4197/4339 (96.7274%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.7734, Accuracy: 7461/10000 (74.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 14, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2669/2782 (95.9382%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.7127, Accuracy: 7795/10000 (77.9500%), Attack Success Rate:0/10000(0.000)
time spent on training: 612.0064780712128
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.34507744 0.         0.         0.         0.49132029 0.
 1.         0.         0.91518345 1.         0.34507744 1.
 1.         1.         0.85969446]
___Test Target_Simple poisoned: False, epoch: 93: Average loss: 0.2658, Accuracy: 8957/10000 (89.5700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 93: Average loss: 0.2403, Accuracy: 8182/8991 (91.0021%)
Done in 640.3090460300446 sec.
Server Epoch:94 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  94, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2825/3010 (93.8538%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.2671, Accuracy: 9173/10000 (91.7300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  94, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5634/5805 (97.0543%), train_poison_data_count: 5805
Global model norm: 14.629267664928049.
Norm before scaling: 13.998763438519031. Distance: 1.1161011969819772
Total norm for 5 adversaries is: 13.998763438519031. distance: 1.1161011969819772
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.4948, Accuracy: 7514/8991 (83.5725%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  94, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4570/4779 (95.6267%), train_poison_data_count: 4779
Global model norm: 14.629267664928049.
Norm before scaling: 14.14936064768586. Distance: 0.987480170618224
Total norm for 5 adversaries is: 14.14936064768586. distance: 0.987480170618224
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.1892, Accuracy: 8463/8991 (94.1275%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  94, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4894/5123 (95.5300%), train_poison_data_count: 5123
Global model norm: 14.629267664928049.
Norm before scaling: 14.1167816289539. Distance: 1.0841709285733439
Total norm for 5 adversaries is: 14.1167816289539. distance: 1.0841709285733439
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.1905, Accuracy: 8453/8991 (94.0162%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  94, local model 4, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4256/4462 (95.3832%), train_poison_data_count: 4462
Global model norm: 14.629267664928049.
Norm before scaling: 14.187972678490254. Distance: 0.9597536563709244
Total norm for 5 adversaries is: 14.187972678490254. distance: 0.9597536563709244
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.2783, Accuracy: 8222/8991 (91.4470%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  94, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3717/3841 (96.7717%), train_poison_data_count: 3841
Global model norm: 14.629267664928049.
Norm before scaling: 14.237000006653547. Distance: 0.9728439027476667
Total norm for 5 adversaries is: 14.237000006653547. distance: 0.9728439027476667
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.6441, Accuracy: 7208/8991 (80.1691%)
___Train Local_Simple,  epoch  94, local model 6, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2827/2945 (95.9932%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.3662, Accuracy: 8623/10000 (86.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0018, Accuracy: 2679/2756 (97.2061%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.5560, Accuracy: 8254/10000 (82.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3241/3437 (94.2974%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.3383, Accuracy: 8739/10000 (87.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5639/5809 (97.0735%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 1.1306, Accuracy: 6555/10000 (65.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2534/2592 (97.7623%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.4185, Accuracy: 8668/10000 (86.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 11, internal_epoch   1,  Average loss: 0.0027, Accuracy: 2405/2510 (95.8167%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.2984, Accuracy: 9096/10000 (90.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4280/4373 (97.8733%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.5635, Accuracy: 8229/10000 (82.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4180/4339 (96.3356%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.6721, Accuracy: 7681/10000 (76.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2680/2782 (96.3336%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.5915, Accuracy: 8104/10000 (81.0400%), Attack Success Rate:0/10000(0.000)
time spent on training: 618.8471260070801
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [1.         0.         0.10938141 0.10938141 0.52176186 0.49753466
 1.         0.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 94: Average loss: 0.2595, Accuracy: 8983/10000 (89.8300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 94: Average loss: 0.2407, Accuracy: 8170/8991 (90.8686%)
Done in 647.1779897212982 sec.
Server Epoch:95 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  95, local model 0, internal_epoch   1,  Average loss: 0.0039, Accuracy: 2834/3010 (94.1528%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.3367, Accuracy: 8918/10000 (89.1800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  95, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5633/5805 (97.0370%), train_poison_data_count: 5805
Global model norm: 14.635244579819389.
Norm before scaling: 13.996303615332804. Distance: 1.1047072197045673
Total norm for 5 adversaries is: 13.996303615332804. distance: 1.1047072197045673
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.6110, Accuracy: 7262/8991 (80.7697%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  95, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4576/4779 (95.7522%), train_poison_data_count: 4779
Global model norm: 14.635244579819389.
Norm before scaling: 14.164044724719956. Distance: 1.0270643543297935
Total norm for 5 adversaries is: 14.164044724719956. distance: 1.0270643543297935
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.1335, Accuracy: 8646/8991 (96.1628%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  95, local model 3, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4900/5123 (95.6471%), train_poison_data_count: 5123
Global model norm: 14.635244579819389.
Norm before scaling: 14.1038827947376. Distance: 1.0639297738670082
Total norm for 5 adversaries is: 14.1038827947376. distance: 1.0639297738670082
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.2157, Accuracy: 8379/8991 (93.1932%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  95, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4261/4462 (95.4953%), train_poison_data_count: 4462
Global model norm: 14.635244579819389.
Norm before scaling: 14.188584609732539. Distance: 0.944964794179292
Total norm for 5 adversaries is: 14.188584609732539. distance: 0.944964794179292
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.3765, Accuracy: 7717/8991 (85.8303%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  95, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3730/3841 (97.1101%), train_poison_data_count: 3841
Global model norm: 14.635244579819389.
Norm before scaling: 14.238350372774601. Distance: 0.907021391533267
Total norm for 5 adversaries is: 14.238350372774601. distance: 0.907021391533267
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.6491, Accuracy: 7279/8991 (80.9587%)
___Train Local_Simple,  epoch  95, local model 6, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2839/2945 (96.4007%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.3227, Accuracy: 8845/10000 (88.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2663/2756 (96.6255%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.5785, Accuracy: 8145/10000 (81.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3237/3437 (94.1810%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.2751, Accuracy: 9036/10000 (90.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 9, internal_epoch   1,  Average loss: 0.0021, Accuracy: 5622/5809 (96.7809%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 1.0103, Accuracy: 6885/10000 (68.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2522/2592 (97.2994%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.3940, Accuracy: 8725/10000 (87.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 11, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2400/2510 (95.6175%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.2882, Accuracy: 8971/10000 (89.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4284/4373 (97.9648%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.8929, Accuracy: 6987/10000 (69.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4182/4339 (96.3817%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.5755, Accuracy: 8047/10000 (80.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 2688/2782 (96.6211%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.6602, Accuracy: 8151/10000 (81.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 621.5703761577606
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.51833343 0.         0.         0.05844606 0.85919936 0.
 1.         0.         1.         1.         0.51833343 1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 95: Average loss: 0.2548, Accuracy: 9013/10000 (90.1300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 95: Average loss: 0.2441, Accuracy: 8142/8991 (90.5572%)
Done in 650.0129132270813 sec.
Server Epoch:96 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  96, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 2821/3010 (93.7209%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.3534, Accuracy: 8883/10000 (88.8300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  96, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5656/5805 (97.4332%), train_poison_data_count: 5805
Global model norm: 14.640420201842685.
Norm before scaling: 14.001247350438605. Distance: 1.0918003689568423
Total norm for 5 adversaries is: 14.001247350438605. distance: 1.0918003689568423
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.6115, Accuracy: 7263/8991 (80.7808%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  96, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4569/4779 (95.6058%), train_poison_data_count: 4779
Global model norm: 14.640420201842685.
Norm before scaling: 14.161534954432906. Distance: 1.0320965153562423
Total norm for 5 adversaries is: 14.161534954432906. distance: 1.0320965153562423
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.1855, Accuracy: 8514/8991 (94.6947%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  96, local model 3, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4908/5123 (95.8032%), train_poison_data_count: 5123
Global model norm: 14.640420201842685.
Norm before scaling: 14.116533560877848. Distance: 1.0974392931056858
Total norm for 5 adversaries is: 14.116533560877848. distance: 1.0974392931056858
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.3655, Accuracy: 7884/8991 (87.6877%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  96, local model 4, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4230/4462 (94.8005%), train_poison_data_count: 4462
Global model norm: 14.640420201842685.
Norm before scaling: 14.213586158817929. Distance: 1.0193937362361705
Total norm for 5 adversaries is: 14.213586158817929. distance: 1.0193937362361705
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.3321, Accuracy: 8115/8991 (90.2569%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  96, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3714/3841 (96.6936%), train_poison_data_count: 3841
Global model norm: 14.640420201842685.
Norm before scaling: 14.249605943016459. Distance: 0.9191009357279535
Total norm for 5 adversaries is: 14.249605943016459. distance: 0.9191009357279535
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.6945, Accuracy: 7149/8991 (79.5128%)
___Train Local_Simple,  epoch  96, local model 6, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2826/2945 (95.9593%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.3958, Accuracy: 8607/10000 (86.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 7, internal_epoch   1,  Average loss: 0.0020, Accuracy: 2669/2756 (96.8433%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.5434, Accuracy: 8064/10000 (80.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3259/3437 (94.8211%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.2922, Accuracy: 8900/10000 (89.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5639/5809 (97.0735%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.8273, Accuracy: 6805/10000 (68.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2534/2592 (97.7623%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.3635, Accuracy: 8839/10000 (88.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 11, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2405/2510 (95.8167%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.1977, Accuracy: 9430/10000 (94.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4283/4373 (97.9419%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.8057, Accuracy: 7430/10000 (74.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4196/4339 (96.7043%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.4808, Accuracy: 8271/10000 (82.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 14, internal_epoch   1,  Average loss: 0.0022, Accuracy: 2687/2782 (96.5852%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.5909, Accuracy: 8148/10000 (81.4800%), Attack Success Rate:0/10000(0.000)
time spent on training: 629.1442890167236
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.61500755 0.         0.27713    0.15727725 0.15727725 0.36365987
 0.27713    0.         1.         1.         0.61500755 1.
 1.         1.         0.94645304]
___Test Target_Simple poisoned: False, epoch: 96: Average loss: 0.2500, Accuracy: 9040/10000 (90.4000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 96: Average loss: 0.2459, Accuracy: 8135/8991 (90.4794%)
Done in 657.3375878334045 sec.
Server Epoch:97 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  97, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 2817/3010 (93.5880%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.3364, Accuracy: 8974/10000 (89.7400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  97, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5643/5805 (97.2093%), train_poison_data_count: 5805
Global model norm: 14.64525903016218.
Norm before scaling: 13.993123136640637. Distance: 1.0885215039492497
Total norm for 5 adversaries is: 13.993123136640637. distance: 1.0885215039492497
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.4205, Accuracy: 7750/8991 (86.1973%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  97, local model 2, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4586/4779 (95.9615%), train_poison_data_count: 4779
Global model norm: 14.64525903016218.
Norm before scaling: 14.16708289638233. Distance: 0.9690819448459537
Total norm for 5 adversaries is: 14.16708289638233. distance: 0.9690819448459537
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.1409, Accuracy: 8588/8991 (95.5177%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  97, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4902/5123 (95.6861%), train_poison_data_count: 5123
Global model norm: 14.64525903016218.
Norm before scaling: 14.10739091375704. Distance: 1.0675901890340702
Total norm for 5 adversaries is: 14.10739091375704. distance: 1.0675901890340702
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.2335, Accuracy: 8322/8991 (92.5592%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4263/4462 (95.5401%), train_poison_data_count: 4462
Global model norm: 14.64525903016218.
Norm before scaling: 14.19794042990644. Distance: 0.9612698794269992
Total norm for 5 adversaries is: 14.19794042990644. distance: 0.9612698794269992
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.3436, Accuracy: 7943/8991 (88.3439%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3718/3841 (96.7977%), train_poison_data_count: 3841
Global model norm: 14.64525903016218.
Norm before scaling: 14.239146064271145. Distance: 0.9129941843209026
Total norm for 5 adversaries is: 14.239146064271145. distance: 0.9129941843209026
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.6918, Accuracy: 7143/8991 (79.4461%)
___Train Local_Simple,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2838/2945 (96.3667%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.3785, Accuracy: 8634/10000 (86.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 7, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2675/2756 (97.0610%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.6002, Accuracy: 8161/10000 (81.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3266/3437 (95.0247%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.2196, Accuracy: 9254/10000 (92.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5632/5809 (96.9530%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 1.1451, Accuracy: 6197/10000 (61.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 10, internal_epoch   1,  Average loss: 0.0017, Accuracy: 2526/2592 (97.4537%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.5166, Accuracy: 8339/10000 (83.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 11, internal_epoch   1,  Average loss: 0.0026, Accuracy: 2412/2510 (96.0956%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.2487, Accuracy: 9274/10000 (92.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4284/4373 (97.9648%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.7321, Accuracy: 7599/10000 (75.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4186/4339 (96.4738%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.5188, Accuracy: 8060/10000 (80.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0021, Accuracy: 2695/2782 (96.8728%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.7061, Accuracy: 7824/10000 (78.2400%), Attack Success Rate:0/10000(0.000)
time spent on training: 581.71834897995
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.85042253 0.25684716 0.         0.         0.76648296 0.80962678
 0.72687636 0.25684716 0.85042253 1.         1.         0.72687636
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 97: Average loss: 0.2504, Accuracy: 9028/10000 (90.2800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 97: Average loss: 0.2428, Accuracy: 8145/8991 (90.5906%)
Done in 604.5139210224152 sec.
Server Epoch:98 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  98, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2829/3010 (93.9867%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.3545, Accuracy: 8911/10000 (89.1100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  98, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5637/5805 (97.1059%), train_poison_data_count: 5805
Global model norm: 14.651027895960171.
Norm before scaling: 14.002096291681594. Distance: 1.0931221386025232
Total norm for 5 adversaries is: 14.002096291681594. distance: 1.0931221386025232
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.4885, Accuracy: 7528/8991 (83.7282%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  98, local model 2, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4590/4779 (96.0452%), train_poison_data_count: 4779
Global model norm: 14.651027895960171.
Norm before scaling: 14.162979244463418. Distance: 1.0194622615697417
Total norm for 5 adversaries is: 14.162979244463418. distance: 1.0194622615697417
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.2474, Accuracy: 8291/8991 (92.2144%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  98, local model 3, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4908/5123 (95.8032%), train_poison_data_count: 5123
Global model norm: 14.651027895960171.
Norm before scaling: 14.107116180449884. Distance: 1.0403983914735027
Total norm for 5 adversaries is: 14.107116180449884. distance: 1.0403983914735027
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.2481, Accuracy: 8283/8991 (92.1255%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  98, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4240/4462 (95.0247%), train_poison_data_count: 4462
Global model norm: 14.651027895960171.
Norm before scaling: 14.210475786204785. Distance: 0.9618258518108038
Total norm for 5 adversaries is: 14.210475786204785. distance: 0.9618258518108038
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.3093, Accuracy: 8099/8991 (90.0790%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  98, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3718/3841 (96.7977%), train_poison_data_count: 3841
Global model norm: 14.651027895960171.
Norm before scaling: 14.258575536089129. Distance: 0.891565395260939
Total norm for 5 adversaries is: 14.258575536089129. distance: 0.891565395260939
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.6392, Accuracy: 7235/8991 (80.4694%)
___Train Local_Simple,  epoch  98, local model 6, internal_epoch   1,  Average loss: 0.0024, Accuracy: 2835/2945 (96.2649%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.3387, Accuracy: 8776/10000 (87.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 7, internal_epoch   1,  Average loss: 0.0018, Accuracy: 2677/2756 (97.1335%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.5252, Accuracy: 8173/10000 (81.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 8, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3246/3437 (94.4428%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.2409, Accuracy: 9208/10000 (92.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5622/5809 (96.7809%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.8410, Accuracy: 6965/10000 (69.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2525/2592 (97.4151%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.4274, Accuracy: 8593/10000 (85.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 11, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2403/2510 (95.7371%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.2268, Accuracy: 9287/10000 (92.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4297/4373 (98.2621%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.8800, Accuracy: 7037/10000 (70.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4181/4339 (96.3586%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.6363, Accuracy: 7895/10000 (78.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2675/2782 (96.1538%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.6494, Accuracy: 7863/10000 (78.6300%), Attack Success Rate:0/10000(0.000)
time spent on training: 549.2227766513824
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [1.         1.         0.62631099 0.62631099 0.9219016  0.64163317
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 98: Average loss: 0.2542, Accuracy: 8994/10000 (89.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 98: Average loss: 0.2337, Accuracy: 8188/8991 (91.0688%)
Done in 571.8180980682373 sec.
Server Epoch:99 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  99, local model 0, internal_epoch   1,  Average loss: 0.0038, Accuracy: 2829/3010 (93.9867%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.3354, Accuracy: 8996/10000 (89.9600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 5637/5805 (97.1059%), train_poison_data_count: 5805
Global model norm: 14.659469283464922.
Norm before scaling: 14.011031028390295. Distance: 1.0999042122489788
Total norm for 5 adversaries is: 14.011031028390295. distance: 1.0999042122489788
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.5958, Accuracy: 7203/8991 (80.1134%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4594/4779 (96.1289%), train_poison_data_count: 4779
Global model norm: 14.659469283464922.
Norm before scaling: 14.172611978666867. Distance: 0.9804530655415681
Total norm for 5 adversaries is: 14.172611978666867. distance: 0.9804530655415681
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.1733, Accuracy: 8510/8991 (94.6502%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  99, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4904/5123 (95.7252%), train_poison_data_count: 5123
Global model norm: 14.659469283464922.
Norm before scaling: 14.13366703383245. Distance: 1.0930381638337454
Total norm for 5 adversaries is: 14.13366703383245. distance: 1.0930381638337454
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.2967, Accuracy: 8004/8991 (89.0224%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  99, local model 4, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4258/4462 (95.4281%), train_poison_data_count: 4462
Global model norm: 14.659469283464922.
Norm before scaling: 14.2154142721796. Distance: 0.9832656907130062
Total norm for 5 adversaries is: 14.2154142721796. distance: 0.9832656907130062
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.5351, Accuracy: 7169/8991 (79.7353%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  99, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3729/3841 (97.0841%), train_poison_data_count: 3841
Global model norm: 14.659469283464922.
Norm before scaling: 14.248810300186578. Distance: 0.907365474187949
Total norm for 5 adversaries is: 14.248810300186578. distance: 0.907365474187949
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.6807, Accuracy: 7234/8991 (80.4582%)
___Train Local_Simple,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0022, Accuracy: 2837/2945 (96.3328%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.2927, Accuracy: 8977/10000 (89.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 7, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2673/2756 (96.9884%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.5206, Accuracy: 8168/10000 (81.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 8, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3257/3437 (94.7629%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.2424, Accuracy: 9292/10000 (92.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5635/5809 (97.0046%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 1.2349, Accuracy: 6408/10000 (64.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 2526/2592 (97.4537%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.5056, Accuracy: 8433/10000 (84.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 11, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2394/2510 (95.3785%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.2469, Accuracy: 9197/10000 (91.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4298/4373 (98.2849%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.6598, Accuracy: 7811/10000 (78.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4188/4339 (96.5199%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.6474, Accuracy: 7940/10000 (79.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0019, Accuracy: 2709/2782 (97.3760%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.7301, Accuracy: 7932/10000 (79.3200%), Attack Success Rate:0/10000(0.000)
time spent on training: 553.4619700908661
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [0.81060159 0.         0.         0.18676272 0.18676272 0.
 1.         0.         0.96935167 1.         0.81060159 1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 99: Average loss: 0.2455, Accuracy: 9044/10000 (90.4400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 99: Average loss: 0.2410, Accuracy: 8144/8991 (90.5795%)
Done in 576.0832569599152 sec.
Server Epoch:100 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch 100, local model 0, internal_epoch   1,  Average loss: 0.0040, Accuracy: 2814/3010 (93.4884%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.2824, Accuracy: 9168/10000 (91.6800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch 100, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 5649/5805 (97.3127%), train_poison_data_count: 5805
Global model norm: 14.66414938623034.
Norm before scaling: 14.005422904273154. Distance: 1.0650014042733118
Total norm for 5 adversaries is: 14.005422904273154. distance: 1.0650014042733118
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.4333, Accuracy: 7720/8991 (85.8636%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch 100, local model 2, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4583/4779 (95.8987%), train_poison_data_count: 4779
Global model norm: 14.66414938623034.
Norm before scaling: 14.175275871915929. Distance: 0.9835504075394357
Total norm for 5 adversaries is: 14.175275871915929. distance: 0.9835504075394357
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.1556, Accuracy: 8563/8991 (95.2397%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4920/5123 (96.0375%), train_poison_data_count: 5123
Global model norm: 14.66414938623034.
Norm before scaling: 14.123828940670178. Distance: 1.0742388914127385
Total norm for 5 adversaries is: 14.123828940670178. distance: 1.0742388914127385
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.3875, Accuracy: 7755/8991 (86.2529%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4252/4462 (95.2936%), train_poison_data_count: 4462
Global model norm: 14.66414938623034.
Norm before scaling: 14.21554790953075. Distance: 0.9862334253153711
Total norm for 5 adversaries is: 14.21554790953075. distance: 0.9862334253153711
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.3238, Accuracy: 7868/8991 (87.5097%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch 100, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3730/3841 (97.1101%), train_poison_data_count: 3841
Global model norm: 14.66414938623034.
Norm before scaling: 14.25491783543901. Distance: 0.9205450712935942
Total norm for 5 adversaries is: 14.25491783543901. distance: 0.9205450712935942
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.5866, Accuracy: 7329/8991 (81.5148%)
___Train Local_Simple,  epoch 100, local model 6, internal_epoch   1,  Average loss: 0.0022, Accuracy: 2842/2945 (96.5025%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.2929, Accuracy: 8963/10000 (89.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 7, internal_epoch   1,  Average loss: 0.0018, Accuracy: 2675/2756 (97.0610%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.4406, Accuracy: 8379/10000 (83.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3259/3437 (94.8211%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.2264, Accuracy: 9254/10000 (92.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 5634/5809 (96.9874%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.8097, Accuracy: 6896/10000 (68.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 2523/2592 (97.3380%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.3591, Accuracy: 8768/10000 (87.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 11, internal_epoch   1,  Average loss: 0.0029, Accuracy: 2411/2510 (96.0558%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.2367, Accuracy: 9256/10000 (92.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 4299/4373 (98.3078%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.6530, Accuracy: 7979/10000 (79.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4206/4339 (96.9348%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.7734, Accuracy: 7548/10000 (75.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0023, Accuracy: 2681/2782 (96.3695%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.6833, Accuracy: 7948/10000 (79.4800%), Attack Success Rate:0/10000(0.000)
time spent on training: 558.6171126365662
[foolsgold agg] training data poison_ratio: 0.40998582722879634  data num: [3010, 5805, 4779, 5123, 4462, 3841, 2945, 2756, 3437, 5809, 2592, 2510, 4373, 4339, 2782]
[foolsgold agg] considering poison per batch poison_fraction: 0.40998582722879634
[foolsgold agg] wv: [1.         0.21695384 0.02530589 0.02530589 0.83002331 1.
 1.         0.21695384 1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 100: Average loss: 0.2438, Accuracy: 9048/10000 (90.4800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 100: Average loss: 0.2382, Accuracy: 8151/8991 (90.6573%)
Done in 581.8958358764648 sec.
Saving all the graphs.
This run has a label: Mar.05_20.19.31. Visdom environment: mnist_DBA
