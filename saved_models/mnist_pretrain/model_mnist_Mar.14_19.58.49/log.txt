current path: saved_models/mnist_pretrain/model_mnist_Mar.14_19.58.49
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   1, local model 0, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2743/3973 (69.0410%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6805, Accuracy: 8216/10000 (82.1600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 1, internal_epoch   1,  Average loss: 0.0225, Accuracy: 2583/3656 (70.6510%), train_poison_data_count: 3656
Global model norm: 1.828686293811075.
Norm before scaling: 3.5631594131271944. Distance: 3.0856891773605106
Total norm for 5 adversaries is: 3.5631594131271944. distance: 3.0856891773605106
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5711, Accuracy: 7779/8991 (86.5199%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 2, internal_epoch   1,  Average loss: 0.0212, Accuracy: 2721/3821 (71.2117%), train_poison_data_count: 3821
Global model norm: 1.828686293811075.
Norm before scaling: 3.609791653187057. Distance: 3.1368710681611702
Total norm for 5 adversaries is: 3.609791653187057. distance: 3.1368710681611702
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5813, Accuracy: 7702/8991 (85.6634%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 3, internal_epoch   1,  Average loss: 0.0204, Accuracy: 3097/4319 (71.7064%), train_poison_data_count: 4319
Global model norm: 1.828686293811075.
Norm before scaling: 3.6793834779362102. Distance: 3.2276033288325587
Total norm for 5 adversaries is: 3.6793834779362102. distance: 3.2276033288325587
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5917, Accuracy: 7696/8991 (85.5967%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 4, internal_epoch   1,  Average loss: 0.0193, Accuracy: 3292/4396 (74.8863%), train_poison_data_count: 4396
Global model norm: 1.828686293811075.
Norm before scaling: 3.7258561142614846. Distance: 3.281457222344243
Total norm for 5 adversaries is: 3.7258561142614846. distance: 3.281457222344243
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5574, Accuracy: 7732/8991 (85.9971%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 5, internal_epoch   1,  Average loss: 0.0230, Accuracy: 2403/3341 (71.9246%), train_poison_data_count: 3341
Global model norm: 1.828686293811075.
Norm before scaling: 3.482589058706015. Distance: 2.995864720151388
Total norm for 5 adversaries is: 3.482589058706015. distance: 2.995864720151388
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5950, Accuracy: 7758/8991 (86.2863%)
___Train Local_Simple,  epoch   1, local model 6, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3671/5024 (73.0693%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.5978, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 7, internal_epoch   1,  Average loss: 0.0237, Accuracy: 2486/3641 (68.2779%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.7170, Accuracy: 8089/10000 (80.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 8, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3482/4701 (74.0693%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6344, Accuracy: 8493/10000 (84.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 9, internal_epoch   1,  Average loss: 0.0253, Accuracy: 2245/3315 (67.7225%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6986, Accuracy: 8354/10000 (83.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 10, internal_epoch   1,  Average loss: 0.0243, Accuracy: 2320/3435 (67.5400%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.7155, Accuracy: 8421/10000 (84.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0236, Accuracy: 2655/3917 (67.7815%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6779, Accuracy: 8252/10000 (82.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 12, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2851/4069 (70.0664%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6932, Accuracy: 8175/10000 (81.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 13, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2716/3851 (70.5271%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.7158, Accuracy: 7997/10000 (79.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 14, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2202/3110 (70.8039%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.1507, Accuracy: 7700/10000 (77.0000%), Attack Success Rate:0/10000(0.000)
time spent on training: 44.24748635292053
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2655, Accuracy: 1749/10000 (17.4900%), Attack Success Rate:28/10000(0.280)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2710, Accuracy: 1348/8991 (14.9928%)
Done in 52.542153120040894 sec.
Server Epoch:2 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   2, local model 0, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2787/3973 (70.1485%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6591, Accuracy: 8510/10000 (85.1000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 1, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2600/3656 (71.1160%), train_poison_data_count: 3656
Global model norm: 1.8286515480183272.
Norm before scaling: 3.5729525965597673. Distance: 3.0794126654106626
Total norm for 5 adversaries is: 3.5729525965597673. distance: 3.0794126654106626
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5770, Accuracy: 7773/8991 (86.4531%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 2, internal_epoch   1,  Average loss: 0.0211, Accuracy: 2697/3821 (70.5836%), train_poison_data_count: 3821
Global model norm: 1.8286515480183272.
Norm before scaling: 3.6046066162665. Distance: 3.1142705209543933
Total norm for 5 adversaries is: 3.6046066162665. distance: 3.1142705209543933
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5853, Accuracy: 7661/8991 (85.2074%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 3, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3135/4319 (72.5862%), train_poison_data_count: 4319
Global model norm: 1.8286515480183272.
Norm before scaling: 3.6735669722105797. Distance: 3.20511070667283
Total norm for 5 adversaries is: 3.6735669722105797. distance: 3.20511070667283
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5888, Accuracy: 7716/8991 (85.8192%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 4, internal_epoch   1,  Average loss: 0.0192, Accuracy: 3278/4396 (74.5678%), train_poison_data_count: 4396
Global model norm: 1.8286515480183272.
Norm before scaling: 3.726652964007777. Distance: 3.2650807488403335
Total norm for 5 adversaries is: 3.726652964007777. distance: 3.2650807488403335
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5441, Accuracy: 7824/8991 (87.0204%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 5, internal_epoch   1,  Average loss: 0.0229, Accuracy: 2385/3341 (71.3858%), train_poison_data_count: 3341
Global model norm: 1.8286515480183272.
Norm before scaling: 3.475234834708594. Distance: 2.9672663143351303
Total norm for 5 adversaries is: 3.475234834708594. distance: 2.9672663143351303
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5925, Accuracy: 7776/8991 (86.4865%)
___Train Local_Simple,  epoch   2, local model 6, internal_epoch   1,  Average loss: 0.0204, Accuracy: 3703/5024 (73.7062%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6160, Accuracy: 8435/10000 (84.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 7, internal_epoch   1,  Average loss: 0.0235, Accuracy: 2465/3641 (67.7012%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7073, Accuracy: 8165/10000 (81.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 8, internal_epoch   1,  Average loss: 0.0204, Accuracy: 3491/4701 (74.2608%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6195, Accuracy: 8542/10000 (85.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 9, internal_epoch   1,  Average loss: 0.0251, Accuracy: 2298/3315 (69.3213%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7144, Accuracy: 8210/10000 (82.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 10, internal_epoch   1,  Average loss: 0.0240, Accuracy: 2347/3435 (68.3261%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7141, Accuracy: 8310/10000 (83.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0237, Accuracy: 2636/3917 (67.2964%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6686, Accuracy: 8342/10000 (83.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 12, internal_epoch   1,  Average loss: 0.0221, Accuracy: 2840/4069 (69.7960%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6709, Accuracy: 8367/10000 (83.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 13, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2744/3851 (71.2542%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7371, Accuracy: 7833/10000 (78.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 14, internal_epoch   1,  Average loss: 0.0219, Accuracy: 2219/3110 (71.3505%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.1332, Accuracy: 7715/10000 (77.1500%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.91065454483032
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.56089246 1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2327, Accuracy: 2135/10000 (21.3500%), Attack Success Rate:22/10000(0.220)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2392, Accuracy: 1652/8991 (18.3739%)
Done in 60.307900190353394 sec.
Server Epoch:3 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   3, local model 0, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2787/3973 (70.1485%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6667, Accuracy: 8410/10000 (84.1000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 1, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2591/3656 (70.8698%), train_poison_data_count: 3656
Global model norm: 1.8292029699432.
Norm before scaling: 3.5794925658266976. Distance: 3.0584900742226795
Total norm for 5 adversaries is: 3.5794925658266976. distance: 3.0584900742226795
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5636, Accuracy: 7783/8991 (86.5643%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 2, internal_epoch   1,  Average loss: 0.0208, Accuracy: 2795/3821 (73.1484%), train_poison_data_count: 3821
Global model norm: 1.8292029699432.
Norm before scaling: 3.6141559593693544. Distance: 3.096363081516857
Total norm for 5 adversaries is: 3.6141559593693544. distance: 3.096363081516857
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5824, Accuracy: 7651/8991 (85.0962%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 3, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3109/4319 (71.9843%), train_poison_data_count: 4319
Global model norm: 1.8292029699432.
Norm before scaling: 3.6742815937408144. Distance: 3.177415790777611
Total norm for 5 adversaries is: 3.6742815937408144. distance: 3.177415790777611
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5854, Accuracy: 7679/8991 (85.4076%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 4, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3274/4396 (74.4768%), train_poison_data_count: 4396
Global model norm: 1.8292029699432.
Norm before scaling: 3.7221464146221823. Distance: 3.2332099622281065
Total norm for 5 adversaries is: 3.7221464146221823. distance: 3.2332099622281065
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5511, Accuracy: 7765/8991 (86.3641%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 5, internal_epoch   1,  Average loss: 0.0228, Accuracy: 2413/3341 (72.2239%), train_poison_data_count: 3341
Global model norm: 1.8292029699432.
Norm before scaling: 3.4826742220948046. Distance: 2.948670756984113
Total norm for 5 adversaries is: 3.4826742220948046. distance: 2.948670756984113
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5974, Accuracy: 7760/8991 (86.3085%)
___Train Local_Simple,  epoch   3, local model 6, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3727/5024 (74.1839%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6016, Accuracy: 8556/10000 (85.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 7, internal_epoch   1,  Average loss: 0.0233, Accuracy: 2467/3641 (67.7561%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.7069, Accuracy: 8077/10000 (80.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 8, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3541/4701 (75.3244%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6236, Accuracy: 8498/10000 (84.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 9, internal_epoch   1,  Average loss: 0.0251, Accuracy: 2268/3315 (68.4163%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6989, Accuracy: 8390/10000 (83.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 10, internal_epoch   1,  Average loss: 0.0237, Accuracy: 2391/3435 (69.6070%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.7111, Accuracy: 8400/10000 (84.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 11, internal_epoch   1,  Average loss: 0.0234, Accuracy: 2768/3917 (70.6663%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6849, Accuracy: 8267/10000 (82.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 12, internal_epoch   1,  Average loss: 0.0219, Accuracy: 2902/4069 (71.3197%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6713, Accuracy: 8323/10000 (83.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 13, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2738/3851 (71.0984%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6853, Accuracy: 8248/10000 (82.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 14, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2261/3110 (72.7010%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.1476, Accuracy: 7693/10000 (76.9300%), Attack Success Rate:0/10000(0.000)
time spent on training: 60.920249462127686
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.2125, Accuracy: 2372/10000 (23.7200%), Attack Success Rate:21/10000(0.210)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.2192, Accuracy: 1855/8991 (20.6317%)
Done in 69.23183822631836 sec.
Server Epoch:4 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   4, local model 0, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2790/3973 (70.2240%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6754, Accuracy: 8314/10000 (83.1400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 1, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2645/3656 (72.3468%), train_poison_data_count: 3656
Global model norm: 1.8297292729014385.
Norm before scaling: 3.5765954625655163. Distance: 3.0375192837829075
Total norm for 5 adversaries is: 3.5765954625655163. distance: 3.0375192837829075
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5727, Accuracy: 7809/8991 (86.8535%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 2, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2780/3821 (72.7558%), train_poison_data_count: 3821
Global model norm: 1.8297292729014385.
Norm before scaling: 3.6091415527945023. Distance: 3.074409992711397
Total norm for 5 adversaries is: 3.6091415527945023. distance: 3.074409992711397
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5843, Accuracy: 7648/8991 (85.0628%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 3, internal_epoch   1,  Average loss: 0.0201, Accuracy: 3159/4319 (73.1419%), train_poison_data_count: 4319
Global model norm: 1.8297292729014385.
Norm before scaling: 3.684783710980076. Distance: 3.171118885738564
Total norm for 5 adversaries is: 3.684783710980076. distance: 3.171118885738564
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5804, Accuracy: 7724/8991 (85.9081%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 4, internal_epoch   1,  Average loss: 0.0190, Accuracy: 3284/4396 (74.7043%), train_poison_data_count: 4396
Global model norm: 1.8297292729014385.
Norm before scaling: 3.715975968939169. Distance: 3.208607071597391
Total norm for 5 adversaries is: 3.715975968939169. distance: 3.208607071597391
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5549, Accuracy: 7761/8991 (86.3197%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 5, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2445/3341 (73.1817%), train_poison_data_count: 3341
Global model norm: 1.8297292729014385.
Norm before scaling: 3.4771629243628315. Distance: 2.926205287300064
Total norm for 5 adversaries is: 3.4771629243628315. distance: 2.926205287300064
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5923, Accuracy: 7792/8991 (86.6644%)
___Train Local_Simple,  epoch   4, local model 6, internal_epoch   1,  Average loss: 0.0203, Accuracy: 3721/5024 (74.0645%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6059, Accuracy: 8581/10000 (85.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 7, internal_epoch   1,  Average loss: 0.0232, Accuracy: 2506/3641 (68.8272%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.7050, Accuracy: 8151/10000 (81.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 8, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3547/4701 (75.4520%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6339, Accuracy: 8466/10000 (84.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 9, internal_epoch   1,  Average loss: 0.0246, Accuracy: 2324/3315 (70.1056%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6918, Accuracy: 8384/10000 (83.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 10, internal_epoch   1,  Average loss: 0.0236, Accuracy: 2417/3435 (70.3639%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.7065, Accuracy: 8428/10000 (84.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 11, internal_epoch   1,  Average loss: 0.0234, Accuracy: 2725/3917 (69.5685%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6848, Accuracy: 8205/10000 (82.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 12, internal_epoch   1,  Average loss: 0.0217, Accuracy: 2924/4069 (71.8604%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6661, Accuracy: 8365/10000 (83.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0217, Accuracy: 2778/3851 (72.1371%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.7034, Accuracy: 8110/10000 (81.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 14, internal_epoch   1,  Average loss: 0.0216, Accuracy: 2237/3110 (71.9293%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.1309, Accuracy: 7711/10000 (77.1100%), Attack Success Rate:0/10000(0.000)
time spent on training: 68.07159638404846
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 2.1701, Accuracy: 3046/10000 (30.4600%), Attack Success Rate:4/10000(0.040)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 2.1780, Accuracy: 2424/8991 (26.9603%)
Done in 76.28757858276367 sec.
Server Epoch:5 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   5, local model 0, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2823/3973 (71.0546%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6581, Accuracy: 8463/10000 (84.6300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 1, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2663/3656 (72.8392%), train_poison_data_count: 3656
Global model norm: 1.8318141003328097.
Norm before scaling: 3.574262908496001. Distance: 2.9957767005487543
Total norm for 5 adversaries is: 3.574262908496001. distance: 2.9957767005487543
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5639, Accuracy: 7819/8991 (86.9647%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 2, internal_epoch   1,  Average loss: 0.0205, Accuracy: 2836/3821 (74.2214%), train_poison_data_count: 3821
Global model norm: 1.8318141003328097.
Norm before scaling: 3.6194487850709347. Distance: 3.0473671540118197
Total norm for 5 adversaries is: 3.6194487850709347. distance: 3.0473671540118197
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5881, Accuracy: 7624/8991 (84.7959%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 3, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3177/4319 (73.5587%), train_poison_data_count: 4319
Global model norm: 1.8318141003328097.
Norm before scaling: 3.6777632879821396. Distance: 3.1272126566055256
Total norm for 5 adversaries is: 3.6777632879821396. distance: 3.1272126566055256
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5721, Accuracy: 7737/8991 (86.0527%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3389/4396 (77.0928%), train_poison_data_count: 4396
Global model norm: 1.8318141003328097.
Norm before scaling: 3.735271394156051. Distance: 3.1924519687465787
Total norm for 5 adversaries is: 3.735271394156051. distance: 3.1924519687465787
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5484, Accuracy: 7758/8991 (86.2863%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 5, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2466/3341 (73.8102%), train_poison_data_count: 3341
Global model norm: 1.8318141003328097.
Norm before scaling: 3.492051363004673. Distance: 2.9049499229015
Total norm for 5 adversaries is: 3.492051363004673. distance: 2.9049499229015
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5875, Accuracy: 7796/8991 (86.7089%)
___Train Local_Simple,  epoch   5, local model 6, internal_epoch   1,  Average loss: 0.0200, Accuracy: 3738/5024 (74.4029%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.5993, Accuracy: 8562/10000 (85.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0230, Accuracy: 2554/3641 (70.1456%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6923, Accuracy: 8320/10000 (83.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 8, internal_epoch   1,  Average loss: 0.0203, Accuracy: 3589/4701 (76.3455%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6308, Accuracy: 8423/10000 (84.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 9, internal_epoch   1,  Average loss: 0.0245, Accuracy: 2316/3315 (69.8643%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6980, Accuracy: 8356/10000 (83.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 10, internal_epoch   1,  Average loss: 0.0232, Accuracy: 2484/3435 (72.3144%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.7086, Accuracy: 8403/10000 (84.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 11, internal_epoch   1,  Average loss: 0.0231, Accuracy: 2761/3917 (70.4876%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6608, Accuracy: 8465/10000 (84.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 12, internal_epoch   1,  Average loss: 0.0216, Accuracy: 2984/4069 (73.3350%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6586, Accuracy: 8437/10000 (84.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 13, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2829/3851 (73.4614%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.7026, Accuracy: 8032/10000 (80.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2273/3110 (73.0868%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.1286, Accuracy: 7627/10000 (76.2700%), Attack Success Rate:0/10000(0.000)
time spent on training: 76.31932711601257
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         1.         0.         0.         0.
 0.         0.58094349 1.        ]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.1178, Accuracy: 3882/10000 (38.8200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 2.1270, Accuracy: 3194/8991 (35.5244%)
Done in 84.76318383216858 sec.
Server Epoch:6 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   6, local model 0, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2906/3973 (73.1437%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6542, Accuracy: 8493/10000 (84.9300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 1, internal_epoch   1,  Average loss: 0.0219, Accuracy: 2748/3656 (75.1641%), train_poison_data_count: 3656
Global model norm: 1.8361298156006152.
Norm before scaling: 3.576765976730225. Distance: 2.9525914593257894
Total norm for 5 adversaries is: 3.576765976730225. distance: 2.9525914593257894
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.5779, Accuracy: 7781/8991 (86.5421%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 2, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2899/3821 (75.8702%), train_poison_data_count: 3821
Global model norm: 1.8361298156006152.
Norm before scaling: 3.6203156821509. Distance: 3.001005798852867
Total norm for 5 adversaries is: 3.6203156821509. distance: 3.001005798852867
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.5856, Accuracy: 7706/8991 (85.7079%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 3, internal_epoch   1,  Average loss: 0.0197, Accuracy: 3238/4319 (74.9711%), train_poison_data_count: 4319
Global model norm: 1.8361298156006152.
Norm before scaling: 3.692914317653706. Distance: 3.0984698426159625
Total norm for 5 adversaries is: 3.692914317653706. distance: 3.0984698426159625
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.5622, Accuracy: 7814/8991 (86.9091%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3373/4396 (76.7288%), train_poison_data_count: 4396
Global model norm: 1.8361298156006152.
Norm before scaling: 3.727616710818514. Distance: 3.1371290192756724
Total norm for 5 adversaries is: 3.727616710818514. distance: 3.1371290192756724
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.5529, Accuracy: 7786/8991 (86.5977%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 5, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2490/3341 (74.5286%), train_poison_data_count: 3341
Global model norm: 1.8361298156006152.
Norm before scaling: 3.4943872133415805. Distance: 2.860853469589607
Total norm for 5 adversaries is: 3.4943872133415805. distance: 2.860853469589607
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.5873, Accuracy: 7789/8991 (86.6311%)
___Train Local_Simple,  epoch   6, local model 6, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3823/5024 (76.0947%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6006, Accuracy: 8546/10000 (85.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 7, internal_epoch   1,  Average loss: 0.0227, Accuracy: 2572/3641 (70.6399%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.7044, Accuracy: 8111/10000 (81.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3541/4701 (75.3244%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6286, Accuracy: 8499/10000 (84.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 9, internal_epoch   1,  Average loss: 0.0243, Accuracy: 2393/3315 (72.1870%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6902, Accuracy: 8342/10000 (83.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 10, internal_epoch   1,  Average loss: 0.0231, Accuracy: 2481/3435 (72.2271%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.7099, Accuracy: 8361/10000 (83.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 11, internal_epoch   1,  Average loss: 0.0228, Accuracy: 2798/3917 (71.4322%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6599, Accuracy: 8449/10000 (84.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 12, internal_epoch   1,  Average loss: 0.0213, Accuracy: 2951/4069 (72.5240%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6638, Accuracy: 8393/10000 (83.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 13, internal_epoch   1,  Average loss: 0.0210, Accuracy: 2878/3851 (74.7338%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.7121, Accuracy: 8053/10000 (80.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 14, internal_epoch   1,  Average loss: 0.0211, Accuracy: 2281/3110 (73.3441%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.1243, Accuracy: 7764/10000 (77.6400%), Attack Success Rate:0/10000(0.000)
time spent on training: 83.54761362075806
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 2.0995, Accuracy: 4189/10000 (41.8900%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 2.1090, Accuracy: 3473/8991 (38.6275%)
Done in 91.8874237537384 sec.
Server Epoch:7 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   7, local model 0, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2950/3973 (74.2512%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6611, Accuracy: 8402/10000 (84.0200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 1, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2672/3656 (73.0853%), train_poison_data_count: 3656
Global model norm: 1.8379063864020964.
Norm before scaling: 3.578117936972764. Distance: 2.936617130146077
Total norm for 5 adversaries is: 3.578117936972764. distance: 2.936617130146077
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5673, Accuracy: 7830/8991 (87.0871%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 2, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2857/3821 (74.7710%), train_poison_data_count: 3821
Global model norm: 1.8379063864020964.
Norm before scaling: 3.6273526416926747. Distance: 2.989048518992149
Total norm for 5 adversaries is: 3.6273526416926747. distance: 2.989048518992149
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5831, Accuracy: 7668/8991 (85.2853%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 3, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3312/4319 (76.6844%), train_poison_data_count: 4319
Global model norm: 1.8379063864020964.
Norm before scaling: 3.690121381670582. Distance: 3.0777091892769475
Total norm for 5 adversaries is: 3.690121381670582. distance: 3.0777091892769475
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5673, Accuracy: 7795/8991 (86.6978%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 4, internal_epoch   1,  Average loss: 0.0186, Accuracy: 3400/4396 (77.3430%), train_poison_data_count: 4396
Global model norm: 1.8379063864020964.
Norm before scaling: 3.7317243929429265. Distance: 3.1228778499933365
Total norm for 5 adversaries is: 3.7317243929429265. distance: 3.1228778499933365
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5591, Accuracy: 7659/8991 (85.1852%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 5, internal_epoch   1,  Average loss: 0.0221, Accuracy: 2507/3341 (75.0374%), train_poison_data_count: 3341
Global model norm: 1.8379063864020964.
Norm before scaling: 3.49073710180472. Distance: 2.8382908328225582
Total norm for 5 adversaries is: 3.49073710180472. distance: 2.8382908328225582
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5880, Accuracy: 7802/8991 (86.7757%)
___Train Local_Simple,  epoch   7, local model 6, internal_epoch   1,  Average loss: 0.0196, Accuracy: 3819/5024 (76.0151%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.5971, Accuracy: 8603/10000 (86.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2620/3641 (71.9583%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.7160, Accuracy: 8051/10000 (80.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 8, internal_epoch   1,  Average loss: 0.0197, Accuracy: 3582/4701 (76.1966%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6169, Accuracy: 8565/10000 (85.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 9, internal_epoch   1,  Average loss: 0.0240, Accuracy: 2388/3315 (72.0362%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.7017, Accuracy: 8303/10000 (83.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0231, Accuracy: 2461/3435 (71.6448%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.7105, Accuracy: 8335/10000 (83.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 11, internal_epoch   1,  Average loss: 0.0228, Accuracy: 2871/3917 (73.2959%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6724, Accuracy: 8341/10000 (83.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 12, internal_epoch   1,  Average loss: 0.0212, Accuracy: 3024/4069 (74.3180%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6730, Accuracy: 8325/10000 (83.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 13, internal_epoch   1,  Average loss: 0.0211, Accuracy: 2841/3851 (73.7730%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6919, Accuracy: 8127/10000 (81.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 14, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2347/3110 (75.4662%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.1120, Accuracy: 7861/10000 (78.6100%), Attack Success Rate:0/10000(0.000)
time spent on training: 91.27512550354004
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.16370304 1.        ]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 2.0783, Accuracy: 4486/10000 (44.8600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 2.0885, Accuracy: 3751/8991 (41.7195%)
Done in 99.83292245864868 sec.
Server Epoch:8 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   8, local model 0, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2962/3973 (74.5532%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6582, Accuracy: 8466/10000 (84.6600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 1, internal_epoch   1,  Average loss: 0.0216, Accuracy: 2773/3656 (75.8479%), train_poison_data_count: 3656
Global model norm: 1.8402612297545675.
Norm before scaling: 3.5886192516397926. Distance: 2.9303142233297663
Total norm for 5 adversaries is: 3.5886192516397926. distance: 2.9303142233297663
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.5732, Accuracy: 7741/8991 (86.0972%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 2, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2947/3821 (77.1264%), train_poison_data_count: 3821
Global model norm: 1.8402612297545675.
Norm before scaling: 3.620320687183907. Distance: 2.9641398723922374
Total norm for 5 adversaries is: 3.620320687183907. distance: 2.9641398723922374
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.5857, Accuracy: 7690/8991 (85.5300%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 3, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3232/4319 (74.8321%), train_poison_data_count: 4319
Global model norm: 1.8402612297545675.
Norm before scaling: 3.690869876706214. Distance: 3.058079390069728
Total norm for 5 adversaries is: 3.690869876706214. distance: 3.058079390069728
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.5762, Accuracy: 7698/8991 (85.6190%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 4, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3390/4396 (77.1156%), train_poison_data_count: 4396
Global model norm: 1.8402612297545675.
Norm before scaling: 3.7433351417417113. Distance: 3.118446956122848
Total norm for 5 adversaries is: 3.7433351417417113. distance: 3.118446956122848
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.5427, Accuracy: 7790/8991 (86.6422%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 5, internal_epoch   1,  Average loss: 0.0219, Accuracy: 2556/3341 (76.5040%), train_poison_data_count: 3341
Global model norm: 1.8402612297545675.
Norm before scaling: 3.4948889334607705. Distance: 2.824761598368253
Total norm for 5 adversaries is: 3.4948889334607705. distance: 2.824761598368253
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.5905, Accuracy: 7824/8991 (87.0204%)
___Train Local_Simple,  epoch   8, local model 6, internal_epoch   1,  Average loss: 0.0196, Accuracy: 3856/5024 (76.7516%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6048, Accuracy: 8465/10000 (84.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 7, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2603/3641 (71.4913%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.7007, Accuracy: 8173/10000 (81.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 8, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3696/4701 (78.6216%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6212, Accuracy: 8542/10000 (85.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0241, Accuracy: 2369/3315 (71.4630%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6975, Accuracy: 8340/10000 (83.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 10, internal_epoch   1,  Average loss: 0.0228, Accuracy: 2488/3435 (72.4309%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6946, Accuracy: 8447/10000 (84.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 11, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2833/3917 (72.3258%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6592, Accuracy: 8444/10000 (84.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0212, Accuracy: 3027/4069 (74.3917%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6787, Accuracy: 8260/10000 (82.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 13, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2910/3851 (75.5648%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6874, Accuracy: 8198/10000 (81.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 14, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2382/3110 (76.5916%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.1158, Accuracy: 7729/10000 (77.2900%), Attack Success Rate:0/10000(0.000)
time spent on training: 101.53150367736816
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 2.0605, Accuracy: 4765/10000 (47.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 2.0718, Accuracy: 3988/8991 (44.3555%)
Done in 111.47617316246033 sec.
Server Epoch:9 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   9, local model 0, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2887/3973 (72.6655%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6653, Accuracy: 8340/10000 (83.4000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 1, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2724/3656 (74.5077%), train_poison_data_count: 3656
Global model norm: 1.8424328123805753.
Norm before scaling: 3.5875776275849076. Distance: 2.914116171171292
Total norm for 5 adversaries is: 3.5875776275849076. distance: 2.914116171171292
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.5641, Accuracy: 7793/8991 (86.6756%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 2, internal_epoch   1,  Average loss: 0.0201, Accuracy: 2882/3821 (75.4253%), train_poison_data_count: 3821
Global model norm: 1.8424328123805753.
Norm before scaling: 3.6229733030350078. Distance: 2.949519949178684
Total norm for 5 adversaries is: 3.6229733030350078. distance: 2.949519949178684
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.5850, Accuracy: 7662/8991 (85.2186%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 3, internal_epoch   1,  Average loss: 0.0194, Accuracy: 3220/4319 (74.5543%), train_poison_data_count: 4319
Global model norm: 1.8424328123805753.
Norm before scaling: 3.6957790733462916. Distance: 3.0506571452630227
Total norm for 5 adversaries is: 3.6957790733462916. distance: 3.0506571452630227
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.5710, Accuracy: 7756/8991 (86.2640%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 4, internal_epoch   1,  Average loss: 0.0183, Accuracy: 3413/4396 (77.6388%), train_poison_data_count: 4396
Global model norm: 1.8424328123805753.
Norm before scaling: 3.7479297009351518. Distance: 3.1080222709672807
Total norm for 5 adversaries is: 3.7479297009351518. distance: 3.1080222709672807
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.5626, Accuracy: 7659/8991 (85.1852%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 5, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2536/3341 (75.9054%), train_poison_data_count: 3341
Global model norm: 1.8424328123805753.
Norm before scaling: 3.4956882348182003. Distance: 2.810649856684807
Total norm for 5 adversaries is: 3.4956882348182003. distance: 2.810649856684807
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.5901, Accuracy: 7764/8991 (86.3530%)
___Train Local_Simple,  epoch   9, local model 6, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3869/5024 (77.0104%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6046, Accuracy: 8466/10000 (84.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 7, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2589/3641 (71.1068%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6936, Accuracy: 8219/10000 (82.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 8, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3641/4701 (77.4516%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6231, Accuracy: 8490/10000 (84.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 9, internal_epoch   1,  Average loss: 0.0238, Accuracy: 2405/3315 (72.5490%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6916, Accuracy: 8393/10000 (83.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 10, internal_epoch   1,  Average loss: 0.0227, Accuracy: 2579/3435 (75.0801%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.7059, Accuracy: 8386/10000 (83.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 11, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2820/3917 (71.9939%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6558, Accuracy: 8416/10000 (84.1600%), Attack Success Rate:0/10000(0.000)
