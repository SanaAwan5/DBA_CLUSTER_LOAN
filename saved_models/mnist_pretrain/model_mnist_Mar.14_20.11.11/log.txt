current path: saved_models/mnist_pretrain/model_mnist_Mar.14_20.11.11
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   1, local model 0, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2743/3973 (69.0410%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6805, Accuracy: 8216/10000 (82.1600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 1, internal_epoch   1,  Average loss: 0.0225, Accuracy: 2583/3656 (70.6510%), train_poison_data_count: 3656
Global model norm: 1.828686293811075.
Norm before scaling: 3.5631594131271944. Distance: 3.0856891773605106
Total norm for 5 adversaries is: 3.5631594131271944. distance: 3.0856891773605106
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5711, Accuracy: 7779/8991 (86.5199%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 2, internal_epoch   1,  Average loss: 0.0212, Accuracy: 2721/3821 (71.2117%), train_poison_data_count: 3821
Global model norm: 1.828686293811075.
Norm before scaling: 3.609791653187057. Distance: 3.1368710681611702
Total norm for 5 adversaries is: 3.609791653187057. distance: 3.1368710681611702
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5813, Accuracy: 7702/8991 (85.6634%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 3, internal_epoch   1,  Average loss: 0.0204, Accuracy: 3097/4319 (71.7064%), train_poison_data_count: 4319
Global model norm: 1.828686293811075.
Norm before scaling: 3.6793834779362102. Distance: 3.2276033288325587
Total norm for 5 adversaries is: 3.6793834779362102. distance: 3.2276033288325587
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5917, Accuracy: 7696/8991 (85.5967%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 4, internal_epoch   1,  Average loss: 0.0193, Accuracy: 3292/4396 (74.8863%), train_poison_data_count: 4396
Global model norm: 1.828686293811075.
Norm before scaling: 3.7258561142614846. Distance: 3.281457222344243
Total norm for 5 adversaries is: 3.7258561142614846. distance: 3.281457222344243
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5574, Accuracy: 7732/8991 (85.9971%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 5, internal_epoch   1,  Average loss: 0.0230, Accuracy: 2403/3341 (71.9246%), train_poison_data_count: 3341
Global model norm: 1.828686293811075.
Norm before scaling: 3.482589058706015. Distance: 2.995864720151388
Total norm for 5 adversaries is: 3.482589058706015. distance: 2.995864720151388
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5950, Accuracy: 7758/8991 (86.2863%)
___Train Local_Simple,  epoch   1, local model 6, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3671/5024 (73.0693%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.5978, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 7, internal_epoch   1,  Average loss: 0.0237, Accuracy: 2486/3641 (68.2779%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.7170, Accuracy: 8089/10000 (80.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 8, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3482/4701 (74.0693%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6344, Accuracy: 8493/10000 (84.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 9, internal_epoch   1,  Average loss: 0.0253, Accuracy: 2245/3315 (67.7225%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6986, Accuracy: 8354/10000 (83.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 10, internal_epoch   1,  Average loss: 0.0243, Accuracy: 2320/3435 (67.5400%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.7155, Accuracy: 8421/10000 (84.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0236, Accuracy: 2655/3917 (67.7815%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6779, Accuracy: 8252/10000 (82.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 12, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2851/4069 (70.0664%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6932, Accuracy: 8175/10000 (81.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 13, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2716/3851 (70.5271%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.7158, Accuracy: 7997/10000 (79.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 14, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2202/3110 (70.8039%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.1507, Accuracy: 7700/10000 (77.0000%), Attack Success Rate:0/10000(0.000)
time spent on training: 42.36883997917175
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2655, Accuracy: 1749/10000 (17.4900%), Attack Success Rate:28/10000(0.280)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2710, Accuracy: 1348/8991 (14.9928%)
Done in 50.824960470199585 sec.
Server Epoch:2 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   2, local model 0, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2787/3973 (70.1485%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6591, Accuracy: 8510/10000 (85.1000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 1, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2600/3656 (71.1160%), train_poison_data_count: 3656
Global model norm: 1.8286515480183272.
Norm before scaling: 3.5729525965597673. Distance: 3.0794126654106626
Total norm for 5 adversaries is: 3.5729525965597673. distance: 3.0794126654106626
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5770, Accuracy: 7773/8991 (86.4531%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 2, internal_epoch   1,  Average loss: 0.0211, Accuracy: 2697/3821 (70.5836%), train_poison_data_count: 3821
Global model norm: 1.8286515480183272.
Norm before scaling: 3.6046066162665. Distance: 3.1142705209543933
Total norm for 5 adversaries is: 3.6046066162665. distance: 3.1142705209543933
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5853, Accuracy: 7661/8991 (85.2074%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 3, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3135/4319 (72.5862%), train_poison_data_count: 4319
Global model norm: 1.8286515480183272.
Norm before scaling: 3.6735669722105797. Distance: 3.20511070667283
Total norm for 5 adversaries is: 3.6735669722105797. distance: 3.20511070667283
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5888, Accuracy: 7716/8991 (85.8192%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 4, internal_epoch   1,  Average loss: 0.0192, Accuracy: 3278/4396 (74.5678%), train_poison_data_count: 4396
Global model norm: 1.8286515480183272.
Norm before scaling: 3.726652964007777. Distance: 3.2650807488403335
Total norm for 5 adversaries is: 3.726652964007777. distance: 3.2650807488403335
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5441, Accuracy: 7824/8991 (87.0204%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 5, internal_epoch   1,  Average loss: 0.0229, Accuracy: 2385/3341 (71.3858%), train_poison_data_count: 3341
Global model norm: 1.8286515480183272.
Norm before scaling: 3.475234834708594. Distance: 2.9672663143351303
Total norm for 5 adversaries is: 3.475234834708594. distance: 2.9672663143351303
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5925, Accuracy: 7776/8991 (86.4865%)
___Train Local_Simple,  epoch   2, local model 6, internal_epoch   1,  Average loss: 0.0204, Accuracy: 3703/5024 (73.7062%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6160, Accuracy: 8435/10000 (84.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 7, internal_epoch   1,  Average loss: 0.0235, Accuracy: 2465/3641 (67.7012%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7073, Accuracy: 8165/10000 (81.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 8, internal_epoch   1,  Average loss: 0.0204, Accuracy: 3491/4701 (74.2608%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6195, Accuracy: 8542/10000 (85.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 9, internal_epoch   1,  Average loss: 0.0251, Accuracy: 2298/3315 (69.3213%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7144, Accuracy: 8210/10000 (82.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 10, internal_epoch   1,  Average loss: 0.0240, Accuracy: 2347/3435 (68.3261%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7141, Accuracy: 8310/10000 (83.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0237, Accuracy: 2636/3917 (67.2964%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6686, Accuracy: 8342/10000 (83.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 12, internal_epoch   1,  Average loss: 0.0221, Accuracy: 2840/4069 (69.7960%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6709, Accuracy: 8367/10000 (83.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 13, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2744/3851 (71.2542%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7371, Accuracy: 7833/10000 (78.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 14, internal_epoch   1,  Average loss: 0.0219, Accuracy: 2219/3110 (71.3505%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.1332, Accuracy: 7715/10000 (77.1500%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.959261655807495
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.56089246 1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2327, Accuracy: 2135/10000 (21.3500%), Attack Success Rate:22/10000(0.220)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2392, Accuracy: 1652/8991 (18.3739%)
Done in 60.44202160835266 sec.
Server Epoch:3 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   3, local model 0, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2787/3973 (70.1485%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6667, Accuracy: 8410/10000 (84.1000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 1, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2591/3656 (70.8698%), train_poison_data_count: 3656
Global model norm: 1.8292029699432.
Norm before scaling: 3.5794925658266976. Distance: 3.0584900742226795
Total norm for 5 adversaries is: 3.5794925658266976. distance: 3.0584900742226795
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5636, Accuracy: 7783/8991 (86.5643%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 2, internal_epoch   1,  Average loss: 0.0208, Accuracy: 2795/3821 (73.1484%), train_poison_data_count: 3821
Global model norm: 1.8292029699432.
Norm before scaling: 3.6141559593693544. Distance: 3.096363081516857
Total norm for 5 adversaries is: 3.6141559593693544. distance: 3.096363081516857
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5824, Accuracy: 7651/8991 (85.0962%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 3, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3109/4319 (71.9843%), train_poison_data_count: 4319
Global model norm: 1.8292029699432.
Norm before scaling: 3.6742815937408144. Distance: 3.177415790777611
Total norm for 5 adversaries is: 3.6742815937408144. distance: 3.177415790777611
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5854, Accuracy: 7679/8991 (85.4076%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 4, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3274/4396 (74.4768%), train_poison_data_count: 4396
Global model norm: 1.8292029699432.
Norm before scaling: 3.7221464146221823. Distance: 3.2332099622281065
Total norm for 5 adversaries is: 3.7221464146221823. distance: 3.2332099622281065
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5511, Accuracy: 7765/8991 (86.3641%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 5, internal_epoch   1,  Average loss: 0.0228, Accuracy: 2413/3341 (72.2239%), train_poison_data_count: 3341
Global model norm: 1.8292029699432.
Norm before scaling: 3.4826742220948046. Distance: 2.948670756984113
Total norm for 5 adversaries is: 3.4826742220948046. distance: 2.948670756984113
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5974, Accuracy: 7760/8991 (86.3085%)
___Train Local_Simple,  epoch   3, local model 6, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3727/5024 (74.1839%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6016, Accuracy: 8556/10000 (85.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 7, internal_epoch   1,  Average loss: 0.0233, Accuracy: 2467/3641 (67.7561%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.7069, Accuracy: 8077/10000 (80.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 8, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3541/4701 (75.3244%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6236, Accuracy: 8498/10000 (84.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 9, internal_epoch   1,  Average loss: 0.0251, Accuracy: 2268/3315 (68.4163%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6989, Accuracy: 8390/10000 (83.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 10, internal_epoch   1,  Average loss: 0.0237, Accuracy: 2391/3435 (69.6070%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.7111, Accuracy: 8400/10000 (84.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 11, internal_epoch   1,  Average loss: 0.0234, Accuracy: 2768/3917 (70.6663%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6849, Accuracy: 8267/10000 (82.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 12, internal_epoch   1,  Average loss: 0.0219, Accuracy: 2902/4069 (71.3197%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6713, Accuracy: 8323/10000 (83.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 13, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2738/3851 (71.0984%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6853, Accuracy: 8248/10000 (82.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 14, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2261/3110 (72.7010%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.1476, Accuracy: 7693/10000 (76.9300%), Attack Success Rate:0/10000(0.000)
time spent on training: 59.66676354408264
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.2125, Accuracy: 2372/10000 (23.7200%), Attack Success Rate:21/10000(0.210)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.2192, Accuracy: 1855/8991 (20.6317%)
Done in 67.93365502357483 sec.
Server Epoch:4 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   4, local model 0, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2790/3973 (70.2240%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6754, Accuracy: 8314/10000 (83.1400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 1, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2645/3656 (72.3468%), train_poison_data_count: 3656
Global model norm: 1.8297292729014385.
Norm before scaling: 3.5765954625655163. Distance: 3.0375192837829075
Total norm for 5 adversaries is: 3.5765954625655163. distance: 3.0375192837829075
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5727, Accuracy: 7809/8991 (86.8535%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 2, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2780/3821 (72.7558%), train_poison_data_count: 3821
Global model norm: 1.8297292729014385.
Norm before scaling: 3.6091415527945023. Distance: 3.074409992711397
Total norm for 5 adversaries is: 3.6091415527945023. distance: 3.074409992711397
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5843, Accuracy: 7648/8991 (85.0628%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 3, internal_epoch   1,  Average loss: 0.0201, Accuracy: 3159/4319 (73.1419%), train_poison_data_count: 4319
Global model norm: 1.8297292729014385.
Norm before scaling: 3.684783710980076. Distance: 3.171118885738564
Total norm for 5 adversaries is: 3.684783710980076. distance: 3.171118885738564
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5804, Accuracy: 7724/8991 (85.9081%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 4, internal_epoch   1,  Average loss: 0.0190, Accuracy: 3284/4396 (74.7043%), train_poison_data_count: 4396
Global model norm: 1.8297292729014385.
Norm before scaling: 3.715975968939169. Distance: 3.208607071597391
Total norm for 5 adversaries is: 3.715975968939169. distance: 3.208607071597391
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5549, Accuracy: 7761/8991 (86.3197%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 5, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2445/3341 (73.1817%), train_poison_data_count: 3341
Global model norm: 1.8297292729014385.
Norm before scaling: 3.4771629243628315. Distance: 2.926205287300064
Total norm for 5 adversaries is: 3.4771629243628315. distance: 2.926205287300064
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.5923, Accuracy: 7792/8991 (86.6644%)
___Train Local_Simple,  epoch   4, local model 6, internal_epoch   1,  Average loss: 0.0203, Accuracy: 3721/5024 (74.0645%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6059, Accuracy: 8581/10000 (85.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 7, internal_epoch   1,  Average loss: 0.0232, Accuracy: 2506/3641 (68.8272%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.7050, Accuracy: 8151/10000 (81.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 8, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3547/4701 (75.4520%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6339, Accuracy: 8466/10000 (84.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 9, internal_epoch   1,  Average loss: 0.0246, Accuracy: 2324/3315 (70.1056%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6918, Accuracy: 8384/10000 (83.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 10, internal_epoch   1,  Average loss: 0.0236, Accuracy: 2417/3435 (70.3639%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.7065, Accuracy: 8428/10000 (84.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 11, internal_epoch   1,  Average loss: 0.0234, Accuracy: 2725/3917 (69.5685%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6848, Accuracy: 8205/10000 (82.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 12, internal_epoch   1,  Average loss: 0.0217, Accuracy: 2924/4069 (71.8604%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6661, Accuracy: 8365/10000 (83.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0217, Accuracy: 2778/3851 (72.1371%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.7034, Accuracy: 8110/10000 (81.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 14, internal_epoch   1,  Average loss: 0.0216, Accuracy: 2237/3110 (71.9293%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.1309, Accuracy: 7711/10000 (77.1100%), Attack Success Rate:0/10000(0.000)
time spent on training: 68.7092216014862
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 2.1701, Accuracy: 3046/10000 (30.4600%), Attack Success Rate:4/10000(0.040)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 2.1780, Accuracy: 2424/8991 (26.9603%)
Done in 76.91147494316101 sec.
Server Epoch:5 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   5, local model 0, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2823/3973 (71.0546%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6581, Accuracy: 8463/10000 (84.6300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 1, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2663/3656 (72.8392%), train_poison_data_count: 3656
Global model norm: 1.8318141003328097.
Norm before scaling: 3.574262908496001. Distance: 2.9957767005487543
Total norm for 5 adversaries is: 3.574262908496001. distance: 2.9957767005487543
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5639, Accuracy: 7819/8991 (86.9647%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 2, internal_epoch   1,  Average loss: 0.0205, Accuracy: 2836/3821 (74.2214%), train_poison_data_count: 3821
Global model norm: 1.8318141003328097.
Norm before scaling: 3.6194487850709347. Distance: 3.0473671540118197
Total norm for 5 adversaries is: 3.6194487850709347. distance: 3.0473671540118197
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5881, Accuracy: 7624/8991 (84.7959%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 3, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3177/4319 (73.5587%), train_poison_data_count: 4319
Global model norm: 1.8318141003328097.
Norm before scaling: 3.6777632879821396. Distance: 3.1272126566055256
Total norm for 5 adversaries is: 3.6777632879821396. distance: 3.1272126566055256
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5721, Accuracy: 7737/8991 (86.0527%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3389/4396 (77.0928%), train_poison_data_count: 4396
Global model norm: 1.8318141003328097.
Norm before scaling: 3.735271394156051. Distance: 3.1924519687465787
Total norm for 5 adversaries is: 3.735271394156051. distance: 3.1924519687465787
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5484, Accuracy: 7758/8991 (86.2863%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 5, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2466/3341 (73.8102%), train_poison_data_count: 3341
Global model norm: 1.8318141003328097.
Norm before scaling: 3.492051363004673. Distance: 2.9049499229015
Total norm for 5 adversaries is: 3.492051363004673. distance: 2.9049499229015
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5875, Accuracy: 7796/8991 (86.7089%)
___Train Local_Simple,  epoch   5, local model 6, internal_epoch   1,  Average loss: 0.0200, Accuracy: 3738/5024 (74.4029%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.5993, Accuracy: 8562/10000 (85.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0230, Accuracy: 2554/3641 (70.1456%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6923, Accuracy: 8320/10000 (83.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 8, internal_epoch   1,  Average loss: 0.0203, Accuracy: 3589/4701 (76.3455%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6308, Accuracy: 8423/10000 (84.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 9, internal_epoch   1,  Average loss: 0.0245, Accuracy: 2316/3315 (69.8643%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6980, Accuracy: 8356/10000 (83.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 10, internal_epoch   1,  Average loss: 0.0232, Accuracy: 2484/3435 (72.3144%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.7086, Accuracy: 8403/10000 (84.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 11, internal_epoch   1,  Average loss: 0.0231, Accuracy: 2761/3917 (70.4876%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6608, Accuracy: 8465/10000 (84.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 12, internal_epoch   1,  Average loss: 0.0216, Accuracy: 2984/4069 (73.3350%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6586, Accuracy: 8437/10000 (84.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 13, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2829/3851 (73.4614%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.7026, Accuracy: 8032/10000 (80.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2273/3110 (73.0868%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.1286, Accuracy: 7627/10000 (76.2700%), Attack Success Rate:0/10000(0.000)
time spent on training: 75.96542263031006
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         1.         0.         0.         0.
 0.         0.58094349 1.        ]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.1178, Accuracy: 3882/10000 (38.8200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 2.1270, Accuracy: 3194/8991 (35.5244%)
Done in 84.38960242271423 sec.
Server Epoch:6 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   6, local model 0, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2906/3973 (73.1437%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6542, Accuracy: 8493/10000 (84.9300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 1, internal_epoch   1,  Average loss: 0.0219, Accuracy: 2748/3656 (75.1641%), train_poison_data_count: 3656
Global model norm: 1.8361298156006152.
Norm before scaling: 3.576765976730225. Distance: 2.9525914593257894
Total norm for 5 adversaries is: 3.576765976730225. distance: 2.9525914593257894
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.5779, Accuracy: 7781/8991 (86.5421%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 2, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2899/3821 (75.8702%), train_poison_data_count: 3821
Global model norm: 1.8361298156006152.
Norm before scaling: 3.6203156821509. Distance: 3.001005798852867
Total norm for 5 adversaries is: 3.6203156821509. distance: 3.001005798852867
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.5856, Accuracy: 7706/8991 (85.7079%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 3, internal_epoch   1,  Average loss: 0.0197, Accuracy: 3238/4319 (74.9711%), train_poison_data_count: 4319
Global model norm: 1.8361298156006152.
Norm before scaling: 3.692914317653706. Distance: 3.0984698426159625
Total norm for 5 adversaries is: 3.692914317653706. distance: 3.0984698426159625
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.5622, Accuracy: 7814/8991 (86.9091%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3373/4396 (76.7288%), train_poison_data_count: 4396
Global model norm: 1.8361298156006152.
Norm before scaling: 3.727616710818514. Distance: 3.1371290192756724
Total norm for 5 adversaries is: 3.727616710818514. distance: 3.1371290192756724
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.5529, Accuracy: 7786/8991 (86.5977%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 5, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2490/3341 (74.5286%), train_poison_data_count: 3341
Global model norm: 1.8361298156006152.
Norm before scaling: 3.4943872133415805. Distance: 2.860853469589607
Total norm for 5 adversaries is: 3.4943872133415805. distance: 2.860853469589607
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.5873, Accuracy: 7789/8991 (86.6311%)
___Train Local_Simple,  epoch   6, local model 6, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3823/5024 (76.0947%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6006, Accuracy: 8546/10000 (85.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 7, internal_epoch   1,  Average loss: 0.0227, Accuracy: 2572/3641 (70.6399%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.7044, Accuracy: 8111/10000 (81.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3541/4701 (75.3244%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6286, Accuracy: 8499/10000 (84.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 9, internal_epoch   1,  Average loss: 0.0243, Accuracy: 2393/3315 (72.1870%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6902, Accuracy: 8342/10000 (83.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 10, internal_epoch   1,  Average loss: 0.0231, Accuracy: 2481/3435 (72.2271%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.7099, Accuracy: 8361/10000 (83.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 11, internal_epoch   1,  Average loss: 0.0228, Accuracy: 2798/3917 (71.4322%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6599, Accuracy: 8449/10000 (84.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 12, internal_epoch   1,  Average loss: 0.0213, Accuracy: 2951/4069 (72.5240%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.6638, Accuracy: 8393/10000 (83.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 13, internal_epoch   1,  Average loss: 0.0210, Accuracy: 2878/3851 (74.7338%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.7121, Accuracy: 8053/10000 (80.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 14, internal_epoch   1,  Average loss: 0.0211, Accuracy: 2281/3110 (73.3441%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.1243, Accuracy: 7764/10000 (77.6400%), Attack Success Rate:0/10000(0.000)
time spent on training: 83.03402709960938
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 2.0995, Accuracy: 4189/10000 (41.8900%), Attack Success Rate:1/10000(0.010)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 2.1090, Accuracy: 3473/8991 (38.6275%)
Done in 91.25151634216309 sec.
Server Epoch:7 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   7, local model 0, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2950/3973 (74.2512%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6611, Accuracy: 8402/10000 (84.0200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 1, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2672/3656 (73.0853%), train_poison_data_count: 3656
Global model norm: 1.8379063864020964.
Norm before scaling: 3.578117936972764. Distance: 2.936617130146077
Total norm for 5 adversaries is: 3.578117936972764. distance: 2.936617130146077
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5673, Accuracy: 7830/8991 (87.0871%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 2, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2857/3821 (74.7710%), train_poison_data_count: 3821
Global model norm: 1.8379063864020964.
Norm before scaling: 3.6273526416926747. Distance: 2.989048518992149
Total norm for 5 adversaries is: 3.6273526416926747. distance: 2.989048518992149
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5831, Accuracy: 7668/8991 (85.2853%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 3, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3312/4319 (76.6844%), train_poison_data_count: 4319
Global model norm: 1.8379063864020964.
Norm before scaling: 3.690121381670582. Distance: 3.0777091892769475
Total norm for 5 adversaries is: 3.690121381670582. distance: 3.0777091892769475
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5673, Accuracy: 7795/8991 (86.6978%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 4, internal_epoch   1,  Average loss: 0.0186, Accuracy: 3400/4396 (77.3430%), train_poison_data_count: 4396
Global model norm: 1.8379063864020964.
Norm before scaling: 3.7317243929429265. Distance: 3.1228778499933365
Total norm for 5 adversaries is: 3.7317243929429265. distance: 3.1228778499933365
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5591, Accuracy: 7659/8991 (85.1852%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 5, internal_epoch   1,  Average loss: 0.0221, Accuracy: 2507/3341 (75.0374%), train_poison_data_count: 3341
Global model norm: 1.8379063864020964.
Norm before scaling: 3.49073710180472. Distance: 2.8382908328225582
Total norm for 5 adversaries is: 3.49073710180472. distance: 2.8382908328225582
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.5880, Accuracy: 7802/8991 (86.7757%)
___Train Local_Simple,  epoch   7, local model 6, internal_epoch   1,  Average loss: 0.0196, Accuracy: 3819/5024 (76.0151%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.5971, Accuracy: 8603/10000 (86.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2620/3641 (71.9583%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.7160, Accuracy: 8051/10000 (80.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 8, internal_epoch   1,  Average loss: 0.0197, Accuracy: 3582/4701 (76.1966%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6169, Accuracy: 8565/10000 (85.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 9, internal_epoch   1,  Average loss: 0.0240, Accuracy: 2388/3315 (72.0362%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.7017, Accuracy: 8303/10000 (83.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0231, Accuracy: 2461/3435 (71.6448%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.7105, Accuracy: 8335/10000 (83.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 11, internal_epoch   1,  Average loss: 0.0228, Accuracy: 2871/3917 (73.2959%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6724, Accuracy: 8341/10000 (83.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 12, internal_epoch   1,  Average loss: 0.0212, Accuracy: 3024/4069 (74.3180%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6730, Accuracy: 8325/10000 (83.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 13, internal_epoch   1,  Average loss: 0.0211, Accuracy: 2841/3851 (73.7730%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.6919, Accuracy: 8127/10000 (81.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 14, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2347/3110 (75.4662%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.1120, Accuracy: 7861/10000 (78.6100%), Attack Success Rate:0/10000(0.000)
time spent on training: 93.5890142917633
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.16370304 1.        ]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 2.0783, Accuracy: 4486/10000 (44.8600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 2.0885, Accuracy: 3751/8991 (41.7195%)
Done in 101.87445712089539 sec.
Server Epoch:8 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   8, local model 0, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2962/3973 (74.5532%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6582, Accuracy: 8466/10000 (84.6600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 1, internal_epoch   1,  Average loss: 0.0216, Accuracy: 2773/3656 (75.8479%), train_poison_data_count: 3656
Global model norm: 1.8402612297545675.
Norm before scaling: 3.5886192516397926. Distance: 2.9303142233297663
Total norm for 5 adversaries is: 3.5886192516397926. distance: 2.9303142233297663
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.5732, Accuracy: 7741/8991 (86.0972%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 2, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2947/3821 (77.1264%), train_poison_data_count: 3821
Global model norm: 1.8402612297545675.
Norm before scaling: 3.620320687183907. Distance: 2.9641398723922374
Total norm for 5 adversaries is: 3.620320687183907. distance: 2.9641398723922374
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.5857, Accuracy: 7690/8991 (85.5300%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 3, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3232/4319 (74.8321%), train_poison_data_count: 4319
Global model norm: 1.8402612297545675.
Norm before scaling: 3.690869876706214. Distance: 3.058079390069728
Total norm for 5 adversaries is: 3.690869876706214. distance: 3.058079390069728
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.5762, Accuracy: 7698/8991 (85.6190%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 4, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3390/4396 (77.1156%), train_poison_data_count: 4396
Global model norm: 1.8402612297545675.
Norm before scaling: 3.7433351417417113. Distance: 3.118446956122848
Total norm for 5 adversaries is: 3.7433351417417113. distance: 3.118446956122848
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.5427, Accuracy: 7790/8991 (86.6422%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 5, internal_epoch   1,  Average loss: 0.0219, Accuracy: 2556/3341 (76.5040%), train_poison_data_count: 3341
Global model norm: 1.8402612297545675.
Norm before scaling: 3.4948889334607705. Distance: 2.824761598368253
Total norm for 5 adversaries is: 3.4948889334607705. distance: 2.824761598368253
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.5905, Accuracy: 7824/8991 (87.0204%)
___Train Local_Simple,  epoch   8, local model 6, internal_epoch   1,  Average loss: 0.0196, Accuracy: 3856/5024 (76.7516%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6048, Accuracy: 8465/10000 (84.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 7, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2603/3641 (71.4913%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.7007, Accuracy: 8173/10000 (81.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 8, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3696/4701 (78.6216%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6212, Accuracy: 8542/10000 (85.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0241, Accuracy: 2369/3315 (71.4630%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6975, Accuracy: 8340/10000 (83.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 10, internal_epoch   1,  Average loss: 0.0228, Accuracy: 2488/3435 (72.4309%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6946, Accuracy: 8447/10000 (84.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 11, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2833/3917 (72.3258%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6592, Accuracy: 8444/10000 (84.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0212, Accuracy: 3027/4069 (74.3917%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6787, Accuracy: 8260/10000 (82.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 13, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2910/3851 (75.5648%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.6874, Accuracy: 8198/10000 (81.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 14, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2382/3110 (76.5916%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.1158, Accuracy: 7729/10000 (77.2900%), Attack Success Rate:0/10000(0.000)
time spent on training: 99.07239198684692
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 2.0605, Accuracy: 4765/10000 (47.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 2.0718, Accuracy: 3988/8991 (44.3555%)
Done in 107.53214383125305 sec.
Server Epoch:9 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   9, local model 0, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2887/3973 (72.6655%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6653, Accuracy: 8340/10000 (83.4000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 1, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2724/3656 (74.5077%), train_poison_data_count: 3656
Global model norm: 1.8424328123805753.
Norm before scaling: 3.5875776275849076. Distance: 2.914116171171292
Total norm for 5 adversaries is: 3.5875776275849076. distance: 2.914116171171292
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.5641, Accuracy: 7793/8991 (86.6756%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 2, internal_epoch   1,  Average loss: 0.0201, Accuracy: 2882/3821 (75.4253%), train_poison_data_count: 3821
Global model norm: 1.8424328123805753.
Norm before scaling: 3.6229733030350078. Distance: 2.949519949178684
Total norm for 5 adversaries is: 3.6229733030350078. distance: 2.949519949178684
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.5850, Accuracy: 7662/8991 (85.2186%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 3, internal_epoch   1,  Average loss: 0.0194, Accuracy: 3220/4319 (74.5543%), train_poison_data_count: 4319
Global model norm: 1.8424328123805753.
Norm before scaling: 3.6957790733462916. Distance: 3.0506571452630227
Total norm for 5 adversaries is: 3.6957790733462916. distance: 3.0506571452630227
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.5710, Accuracy: 7756/8991 (86.2640%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 4, internal_epoch   1,  Average loss: 0.0183, Accuracy: 3413/4396 (77.6388%), train_poison_data_count: 4396
Global model norm: 1.8424328123805753.
Norm before scaling: 3.7479297009351518. Distance: 3.1080222709672807
Total norm for 5 adversaries is: 3.7479297009351518. distance: 3.1080222709672807
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.5626, Accuracy: 7659/8991 (85.1852%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 5, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2536/3341 (75.9054%), train_poison_data_count: 3341
Global model norm: 1.8424328123805753.
Norm before scaling: 3.4956882348182003. Distance: 2.810649856684807
Total norm for 5 adversaries is: 3.4956882348182003. distance: 2.810649856684807
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.5901, Accuracy: 7764/8991 (86.3530%)
___Train Local_Simple,  epoch   9, local model 6, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3869/5024 (77.0104%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6046, Accuracy: 8466/10000 (84.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 7, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2589/3641 (71.1068%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6936, Accuracy: 8219/10000 (82.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 8, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3641/4701 (77.4516%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6231, Accuracy: 8490/10000 (84.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 9, internal_epoch   1,  Average loss: 0.0238, Accuracy: 2405/3315 (72.5490%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6916, Accuracy: 8393/10000 (83.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 10, internal_epoch   1,  Average loss: 0.0227, Accuracy: 2579/3435 (75.0801%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.7059, Accuracy: 8386/10000 (83.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 11, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2820/3917 (71.9939%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6558, Accuracy: 8416/10000 (84.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 12, internal_epoch   1,  Average loss: 0.0211, Accuracy: 3006/4069 (73.8756%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.6700, Accuracy: 8322/10000 (83.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0213, Accuracy: 2857/3851 (74.1885%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.7089, Accuracy: 8032/10000 (80.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 14, internal_epoch   1,  Average loss: 0.0205, Accuracy: 2367/3110 (76.1093%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.1161, Accuracy: 7755/10000 (77.5500%), Attack Success Rate:0/10000(0.000)
time spent on training: 105.40783214569092
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 2.0234, Accuracy: 5274/10000 (52.7400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 2.0353, Accuracy: 4439/8991 (49.3716%)
Done in 113.82467913627625 sec.
Server Epoch:10 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  10, local model 0, internal_epoch   1,  Average loss: 0.0210, Accuracy: 3019/3973 (75.9879%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.6593, Accuracy: 8363/10000 (83.6300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 1, internal_epoch   1,  Average loss: 0.0211, Accuracy: 2800/3656 (76.5864%), train_poison_data_count: 3656
Global model norm: 1.8477056065231483.
Norm before scaling: 3.601014863123116. Distance: 2.89608644618844
Total norm for 5 adversaries is: 3.601014863123116. distance: 2.89608644618844
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.5724, Accuracy: 7760/8991 (86.3085%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 2, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2933/3821 (76.7600%), train_poison_data_count: 3821
Global model norm: 1.8477056065231483.
Norm before scaling: 3.623830277710703. Distance: 2.9159039362924895
Total norm for 5 adversaries is: 3.623830277710703. distance: 2.9159039362924895
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.5899, Accuracy: 7647/8991 (85.0517%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 3, internal_epoch   1,  Average loss: 0.0192, Accuracy: 3281/4319 (75.9667%), train_poison_data_count: 4319
Global model norm: 1.8477056065231483.
Norm before scaling: 3.699121040898733. Distance: 3.0190724644892843
Total norm for 5 adversaries is: 3.699121040898733. distance: 3.0190724644892843
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.5838, Accuracy: 7695/8991 (85.5856%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 4, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3493/4396 (79.4586%), train_poison_data_count: 4396
Global model norm: 1.8477056065231483.
Norm before scaling: 3.746882223419786. Distance: 3.0716220693374403
Total norm for 5 adversaries is: 3.746882223419786. distance: 3.0716220693374403
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.5451, Accuracy: 7782/8991 (86.5532%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 5, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2594/3341 (77.6414%), train_poison_data_count: 3341
Global model norm: 1.8477056065231483.
Norm before scaling: 3.509325954131897. Distance: 2.7918354856394623
Total norm for 5 adversaries is: 3.509325954131897. distance: 2.7918354856394623
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.5879, Accuracy: 7760/8991 (86.3085%)
___Train Local_Simple,  epoch  10, local model 6, internal_epoch   1,  Average loss: 0.0193, Accuracy: 3920/5024 (78.0255%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.6045, Accuracy: 8512/10000 (85.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 7, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2596/3641 (71.2991%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.7080, Accuracy: 8166/10000 (81.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 8, internal_epoch   1,  Average loss: 0.0193, Accuracy: 3713/4701 (78.9832%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.6168, Accuracy: 8538/10000 (85.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 9, internal_epoch   1,  Average loss: 0.0236, Accuracy: 2454/3315 (74.0271%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.6900, Accuracy: 8421/10000 (84.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 10, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2499/3435 (72.7511%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.7012, Accuracy: 8426/10000 (84.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0223, Accuracy: 2818/3917 (71.9428%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.6503, Accuracy: 8503/10000 (85.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2989/4069 (73.4579%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.6532, Accuracy: 8407/10000 (84.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0206, Accuracy: 2928/3851 (76.0322%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.6996, Accuracy: 8088/10000 (80.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2394/3110 (76.9775%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.1270, Accuracy: 7555/10000 (75.5500%), Attack Success Rate:0/10000(0.000)
time spent on training: 113.89917421340942
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 2.0062, Accuracy: 5481/10000 (54.8100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 2.0185, Accuracy: 4624/8991 (51.4292%)
Done in 122.28517651557922 sec.
Server Epoch:11 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  11, local model 0, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2990/3973 (75.2580%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.6589, Accuracy: 8417/10000 (84.1700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 1, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2789/3656 (76.2856%), train_poison_data_count: 3656
Global model norm: 1.8504704341222058.
Norm before scaling: 3.5858504008434324. Distance: 2.862175575762126
Total norm for 5 adversaries is: 3.5858504008434324. distance: 2.862175575762126
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.5658, Accuracy: 7859/8991 (87.4096%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 2, internal_epoch   1,  Average loss: 0.0198, Accuracy: 2910/3821 (76.1581%), train_poison_data_count: 3821
Global model norm: 1.8504704341222058.
Norm before scaling: 3.626346995579523. Distance: 2.902314012665203
Total norm for 5 adversaries is: 3.626346995579523. distance: 2.902314012665203
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.5715, Accuracy: 7734/8991 (86.0194%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 3, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3277/4319 (75.8740%), train_poison_data_count: 4319
Global model norm: 1.8504704341222058.
Norm before scaling: 3.6987206386523663. Distance: 3.0046415979109677
Total norm for 5 adversaries is: 3.6987206386523663. distance: 3.0046415979109677
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.6028, Accuracy: 7644/8991 (85.0184%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 4, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3488/4396 (79.3449%), train_poison_data_count: 4396
Global model norm: 1.8504704341222058.
Norm before scaling: 3.7420953727324333. Distance: 3.0519201519321455
Total norm for 5 adversaries is: 3.7420953727324333. distance: 3.0519201519321455
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.5502, Accuracy: 7750/8991 (86.1973%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 5, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2550/3341 (76.3245%), train_poison_data_count: 3341
Global model norm: 1.8504704341222058.
Norm before scaling: 3.508810126615385. Distance: 2.778739910922523
Total norm for 5 adversaries is: 3.508810126615385. distance: 2.778739910922523
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.5935, Accuracy: 7816/8991 (86.9314%)
___Train Local_Simple,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0193, Accuracy: 3892/5024 (77.4682%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.6017, Accuracy: 8514/10000 (85.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 7, internal_epoch   1,  Average loss: 0.0221, Accuracy: 2649/3641 (72.7547%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.7003, Accuracy: 8172/10000 (81.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 8, internal_epoch   1,  Average loss: 0.0193, Accuracy: 3731/4701 (79.3661%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.6236, Accuracy: 8557/10000 (85.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 9, internal_epoch   1,  Average loss: 0.0235, Accuracy: 2451/3315 (73.9367%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.6862, Accuracy: 8436/10000 (84.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 10, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2553/3435 (74.3231%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.6973, Accuracy: 8409/10000 (84.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2882/3917 (73.5767%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.6585, Accuracy: 8440/10000 (84.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 12, internal_epoch   1,  Average loss: 0.0207, Accuracy: 3073/4069 (75.5222%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.6563, Accuracy: 8416/10000 (84.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 13, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2905/3851 (75.4350%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.7000, Accuracy: 8128/10000 (81.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0203, Accuracy: 2401/3110 (77.2026%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.1024, Accuracy: 7863/10000 (78.6300%), Attack Success Rate:0/10000(0.000)
time spent on training: 121.12115836143494
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.16534709 1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 1.9864, Accuracy: 5693/10000 (56.9300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 1.9991, Accuracy: 4815/8991 (53.5536%)
Done in 129.46655225753784 sec.
Server Epoch:12 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  12, local model 0, internal_epoch   1,  Average loss: 0.0208, Accuracy: 3009/3973 (75.7362%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6565, Accuracy: 8416/10000 (84.1600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   1,  Average loss: 0.0211, Accuracy: 2775/3656 (75.9026%), train_poison_data_count: 3656
Global model norm: 1.8539287400197693.
Norm before scaling: 3.6038519808298792. Distance: 2.8641888895986405
Total norm for 5 adversaries is: 3.6038519808298792. distance: 2.8641888895986405
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.5782, Accuracy: 7748/8991 (86.1751%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2923/3821 (76.4983%), train_poison_data_count: 3821
Global model norm: 1.8539287400197693.
Norm before scaling: 3.644598237594449. Distance: 2.9022455006292716
Total norm for 5 adversaries is: 3.644598237594449. distance: 2.9022455006292716
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.5942, Accuracy: 7577/8991 (84.2732%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 3, internal_epoch   1,  Average loss: 0.0190, Accuracy: 3304/4319 (76.4992%), train_poison_data_count: 4319
Global model norm: 1.8539287400197693.
Norm before scaling: 3.693884930671566. Distance: 2.9818807834304506
Total norm for 5 adversaries is: 3.693884930671566. distance: 2.9818807834304506
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.5766, Accuracy: 7750/8991 (86.1973%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3460/4396 (78.7079%), train_poison_data_count: 4396
Global model norm: 1.8539287400197693.
Norm before scaling: 3.7408048428777407. Distance: 3.0308258703764177
Total norm for 5 adversaries is: 3.7408048428777407. distance: 3.0308258703764177
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.5436, Accuracy: 7728/8991 (85.9526%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 5, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2576/3341 (77.1027%), train_poison_data_count: 3341
Global model norm: 1.8539287400197693.
Norm before scaling: 3.4981020822433715. Distance: 2.745789338735294
Total norm for 5 adversaries is: 3.4981020822433715. distance: 2.745789338735294
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.5810, Accuracy: 7813/8991 (86.8980%)
___Train Local_Simple,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0192, Accuracy: 3889/5024 (77.4084%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.5943, Accuracy: 8585/10000 (85.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 7, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2639/3641 (72.4801%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.7043, Accuracy: 8105/10000 (81.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 8, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3790/4701 (80.6211%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6179, Accuracy: 8552/10000 (85.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 9, internal_epoch   1,  Average loss: 0.0235, Accuracy: 2471/3315 (74.5400%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6864, Accuracy: 8348/10000 (83.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 10, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2566/3435 (74.7016%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6932, Accuracy: 8414/10000 (84.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2874/3917 (73.3725%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6576, Accuracy: 8414/10000 (84.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 12, internal_epoch   1,  Average loss: 0.0206, Accuracy: 3084/4069 (75.7926%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6464, Accuracy: 8458/10000 (84.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 13, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2938/3851 (76.2919%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6939, Accuracy: 8153/10000 (81.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 14, internal_epoch   1,  Average loss: 0.0199, Accuracy: 2409/3110 (77.4598%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1086, Accuracy: 7724/10000 (77.2400%), Attack Success Rate:0/10000(0.000)
time spent on training: 132.29829692840576
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.9522, Accuracy: 5886/10000 (58.8600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 1.9633, Accuracy: 5105/8991 (56.7790%)
Done in 140.6921169757843 sec.
Server Epoch:13 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  13, local model 0, internal_epoch   1,  Average loss: 0.0206, Accuracy: 3013/3973 (75.8369%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6639, Accuracy: 8377/10000 (83.7700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 1, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2832/3656 (77.4617%), train_poison_data_count: 3656
Global model norm: 1.860753806374124.
Norm before scaling: 3.598650700642447. Distance: 2.8232128837170407
Total norm for 5 adversaries is: 3.598650700642447. distance: 2.8232128837170407
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.5621, Accuracy: 7844/8991 (87.2428%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 2, internal_epoch   1,  Average loss: 0.0194, Accuracy: 3003/3821 (78.5920%), train_poison_data_count: 3821
Global model norm: 1.860753806374124.
Norm before scaling: 3.6285699826120728. Distance: 2.850950243293258
Total norm for 5 adversaries is: 3.6285699826120728. distance: 2.850950243293258
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.5796, Accuracy: 7740/8991 (86.0861%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 3, internal_epoch   1,  Average loss: 0.0190, Accuracy: 3303/4319 (76.4760%), train_poison_data_count: 4319
Global model norm: 1.860753806374124.
Norm before scaling: 3.6998867893941694. Distance: 2.9531455064495526
Total norm for 5 adversaries is: 3.6998867893941694. distance: 2.9531455064495526
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.5632, Accuracy: 7788/8991 (86.6200%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0179, Accuracy: 3536/4396 (80.4368%), train_poison_data_count: 4396
Global model norm: 1.860753806374124.
Norm before scaling: 3.7465114897589076. Distance: 3.000349501278439
Total norm for 5 adversaries is: 3.7465114897589076. distance: 3.000349501278439
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.5428, Accuracy: 7732/8991 (85.9971%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 5, internal_epoch   1,  Average loss: 0.0212, Accuracy: 2617/3341 (78.3298%), train_poison_data_count: 3341
Global model norm: 1.860753806374124.
Norm before scaling: 3.5162205170535508. Distance: 2.733001887377001
Total norm for 5 adversaries is: 3.5162205170535508. distance: 2.733001887377001
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.5818, Accuracy: 7796/8991 (86.7089%)
___Train Local_Simple,  epoch  13, local model 6, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3940/5024 (78.4236%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6010, Accuracy: 8536/10000 (85.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0217, Accuracy: 2650/3641 (72.7822%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6774, Accuracy: 8315/10000 (83.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 8, internal_epoch   1,  Average loss: 0.0190, Accuracy: 3697/4701 (78.6428%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6178, Accuracy: 8571/10000 (85.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 9, internal_epoch   1,  Average loss: 0.0232, Accuracy: 2446/3315 (73.7858%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6822, Accuracy: 8390/10000 (83.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2603/3435 (75.7787%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6897, Accuracy: 8479/10000 (84.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0219, Accuracy: 2950/3917 (75.3127%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6601, Accuracy: 8428/10000 (84.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 12, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3077/4069 (75.6205%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6625, Accuracy: 8333/10000 (83.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 13, internal_epoch   1,  Average loss: 0.0205, Accuracy: 2986/3851 (77.5383%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7118, Accuracy: 7995/10000 (79.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2445/3110 (78.6174%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1016, Accuracy: 7772/10000 (77.7200%), Attack Success Rate:0/10000(0.000)
time spent on training: 136.88264417648315
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.9361, Accuracy: 6034/10000 (60.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 1.9478, Accuracy: 5205/8991 (57.8912%)
Done in 145.17555451393127 sec.
Server Epoch:14 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  14, local model 0, internal_epoch   1,  Average loss: 0.0206, Accuracy: 3012/3973 (75.8117%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6499, Accuracy: 8479/10000 (84.7900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 1, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2824/3656 (77.2429%), train_poison_data_count: 3656
Global model norm: 1.8642090221033238.
Norm before scaling: 3.5965215196096945. Distance: 2.8046259541253824
Total norm for 5 adversaries is: 3.5965215196096945. distance: 2.8046259541253824
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.5719, Accuracy: 7809/8991 (86.8535%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0194, Accuracy: 2993/3821 (78.3303%), train_poison_data_count: 3821
Global model norm: 1.8642090221033238.
Norm before scaling: 3.6365231175563126. Distance: 2.8412613931168167
Total norm for 5 adversaries is: 3.6365231175563126. distance: 2.8412613931168167
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.5878, Accuracy: 7593/8991 (84.4511%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 3, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3397/4319 (78.6525%), train_poison_data_count: 4319
Global model norm: 1.8642090221033238.
Norm before scaling: 3.7103617974489698. Distance: 2.9474152766533113
Total norm for 5 adversaries is: 3.7103617974489698. distance: 2.9474152766533113
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.5679, Accuracy: 7798/8991 (86.7312%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3510/4396 (79.8453%), train_poison_data_count: 4396
Global model norm: 1.8642090221033238.
Norm before scaling: 3.7594240662630174. Distance: 2.999754259853103
Total norm for 5 adversaries is: 3.7594240662630174. distance: 2.999754259853103
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.5565, Accuracy: 7708/8991 (85.7302%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 5, internal_epoch   1,  Average loss: 0.0212, Accuracy: 2599/3341 (77.7911%), train_poison_data_count: 3341
Global model norm: 1.8642090221033238.
Norm before scaling: 3.4978748409155465. Distance: 2.696833703707305
Total norm for 5 adversaries is: 3.4978748409155465. distance: 2.696833703707305
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.5976, Accuracy: 7769/8991 (86.4086%)
___Train Local_Simple,  epoch  14, local model 6, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3900/5024 (77.6274%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.5970, Accuracy: 8533/10000 (85.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2629/3641 (72.2054%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.7015, Accuracy: 8106/10000 (81.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 8, internal_epoch   1,  Average loss: 0.0189, Accuracy: 3718/4701 (79.0896%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6155, Accuracy: 8549/10000 (85.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 9, internal_epoch   1,  Average loss: 0.0232, Accuracy: 2454/3315 (74.0271%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6773, Accuracy: 8456/10000 (84.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0221, Accuracy: 2572/3435 (74.8763%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6916, Accuracy: 8510/10000 (85.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 11, internal_epoch   1,  Average loss: 0.0219, Accuracy: 2951/3917 (75.3383%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6776, Accuracy: 8285/10000 (82.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0204, Accuracy: 3076/4069 (75.5960%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.6650, Accuracy: 8341/10000 (83.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 13, internal_epoch   1,  Average loss: 0.0203, Accuracy: 2998/3851 (77.8499%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.7172, Accuracy: 7938/10000 (79.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 14, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2446/3110 (78.6495%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0961, Accuracy: 7790/10000 (77.9000%), Attack Success Rate:0/10000(0.000)
time spent on training: 144.02200531959534
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        0.        0.        0.        0.0763657
 1.       ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.9192, Accuracy: 6144/10000 (61.4400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 1.9315, Accuracy: 5300/8991 (58.9478%)
Done in 152.31991124153137 sec.
Server Epoch:15 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3063/3973 (77.0954%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6603, Accuracy: 8451/10000 (84.5100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0206, Accuracy: 2830/3656 (77.4070%), train_poison_data_count: 3656
Global model norm: 1.8681411542350344.
Norm before scaling: 3.5969069173740675. Distance: 2.7894180883267348
Total norm for 5 adversaries is: 3.5969069173740675. distance: 2.7894180883267348
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.5670, Accuracy: 7783/8991 (86.5643%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 2, internal_epoch   1,  Average loss: 0.0193, Accuracy: 3017/3821 (78.9584%), train_poison_data_count: 3821
Global model norm: 1.8681411542350344.
Norm before scaling: 3.6288627564417935. Distance: 2.818136628059903
Total norm for 5 adversaries is: 3.6288627564417935. distance: 2.818136628059903
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.5732, Accuracy: 7711/8991 (85.7635%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 3, internal_epoch   1,  Average loss: 0.0189, Accuracy: 3353/4319 (77.6337%), train_poison_data_count: 4319
Global model norm: 1.8681411542350344.
Norm before scaling: 3.7129455915513105. Distance: 2.934670241902987
Total norm for 5 adversaries is: 3.7129455915513105. distance: 2.934670241902987
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.5770, Accuracy: 7734/8991 (86.0194%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3537/4396 (80.4595%), train_poison_data_count: 4396
Global model norm: 1.8681411542350344.
Norm before scaling: 3.7570486581152767. Distance: 2.9801791589120725
Total norm for 5 adversaries is: 3.7570486581152767. distance: 2.9801791589120725
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.5451, Accuracy: 7753/8991 (86.2307%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 5, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2647/3341 (79.2278%), train_poison_data_count: 3341
Global model norm: 1.8681411542350344.
Norm before scaling: 3.5060703224750265. Distance: 2.6884809078980956
Total norm for 5 adversaries is: 3.5060703224750265. distance: 2.6884809078980956
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.5823, Accuracy: 7784/8991 (86.5755%)
___Train Local_Simple,  epoch  15, local model 6, internal_epoch   1,  Average loss: 0.0189, Accuracy: 3932/5024 (78.2643%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.5971, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 7, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2700/3641 (74.1555%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.7128, Accuracy: 8054/10000 (80.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 8, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3745/4701 (79.6639%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6207, Accuracy: 8460/10000 (84.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 9, internal_epoch   1,  Average loss: 0.0229, Accuracy: 2532/3315 (76.3801%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6774, Accuracy: 8471/10000 (84.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 10, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2592/3435 (75.4585%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6856, Accuracy: 8483/10000 (84.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 11, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2916/3917 (74.4447%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6584, Accuracy: 8398/10000 (83.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0203, Accuracy: 3137/4069 (77.0951%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.6795, Accuracy: 8233/10000 (82.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2996/3851 (77.7980%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.7001, Accuracy: 8090/10000 (80.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2461/3110 (79.1318%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0980, Accuracy: 7782/10000 (77.8200%), Attack Success Rate:0/10000(0.000)
time spent on training: 150.62870454788208
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.17624773 1.        ]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 1.9007, Accuracy: 6253/10000 (62.5300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 1.9137, Accuracy: 5394/8991 (59.9933%)
Done in 159.0503866672516 sec.
Server Epoch:16 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  16, local model 0, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3036/3973 (76.4158%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6527, Accuracy: 8427/10000 (84.2700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 1, internal_epoch   1,  Average loss: 0.0204, Accuracy: 2862/3656 (78.2823%), train_poison_data_count: 3656
Global model norm: 1.8726873758885918.
Norm before scaling: 3.6175339205403128. Distance: 2.795352457442196
Total norm for 5 adversaries is: 3.6175339205403128. distance: 2.795352457442196
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.5595, Accuracy: 7856/8991 (87.3763%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 2, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2929/3821 (76.6553%), train_poison_data_count: 3821
Global model norm: 1.8726873758885918.
Norm before scaling: 3.647162596567137. Distance: 2.8191318735412607
Total norm for 5 adversaries is: 3.647162596567137. distance: 2.8191318735412607
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.5751, Accuracy: 7660/8991 (85.1963%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 3, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3336/4319 (77.2401%), train_poison_data_count: 4319
Global model norm: 1.8726873758885918.
Norm before scaling: 3.7032108860276973. Distance: 2.9055363589013905
Total norm for 5 adversaries is: 3.7032108860276973. distance: 2.9055363589013905
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.5759, Accuracy: 7746/8991 (86.1528%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3514/4396 (79.9363%), train_poison_data_count: 4396
Global model norm: 1.8726873758885918.
Norm before scaling: 3.748124989008176. Distance: 2.9546942199921102
Total norm for 5 adversaries is: 3.748124989008176. distance: 2.9546942199921102
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.5373, Accuracy: 7790/8991 (86.6422%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 5, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2619/3341 (78.3897%), train_poison_data_count: 3341
Global model norm: 1.8726873758885918.
Norm before scaling: 3.5193839767414734. Distance: 2.6857989938473734
Total norm for 5 adversaries is: 3.5193839767414734. distance: 2.6857989938473734
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.5926, Accuracy: 7783/8991 (86.5643%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3964/5024 (78.9013%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5904, Accuracy: 8652/10000 (86.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 7, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2686/3641 (73.7709%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6911, Accuracy: 8213/10000 (82.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3758/4701 (79.9404%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6264, Accuracy: 8424/10000 (84.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 9, internal_epoch   1,  Average loss: 0.0229, Accuracy: 2514/3315 (75.8371%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6849, Accuracy: 8369/10000 (83.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 10, internal_epoch   1,  Average loss: 0.0217, Accuracy: 2611/3435 (76.0116%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.7000, Accuracy: 8387/10000 (83.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0217, Accuracy: 2949/3917 (75.2872%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6589, Accuracy: 8395/10000 (83.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3094/4069 (76.0383%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6751, Accuracy: 8269/10000 (82.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3000/3851 (77.9018%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.6877, Accuracy: 8144/10000 (81.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 14, internal_epoch   1,  Average loss: 0.0194, Accuracy: 2477/3110 (79.6463%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0893, Accuracy: 7883/10000 (78.8300%), Attack Success Rate:0/10000(0.000)
time spent on training: 161.39476370811462
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 1.8854, Accuracy: 6377/10000 (63.7700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 1.8992, Accuracy: 5483/8991 (60.9832%)
Done in 169.95757746696472 sec.
Server Epoch:17 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  17, local model 0, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3053/3973 (76.8437%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6485, Accuracy: 8461/10000 (84.6100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 1, internal_epoch   1,  Average loss: 0.0205, Accuracy: 2848/3656 (77.8993%), train_poison_data_count: 3656
Global model norm: 1.876619021464184.
Norm before scaling: 3.5993003112282413. Distance: 2.761695872512873
Total norm for 5 adversaries is: 3.5993003112282413. distance: 2.761695872512873
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.5645, Accuracy: 7799/8991 (86.7423%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3008/3821 (78.7228%), train_poison_data_count: 3821
Global model norm: 1.876619021464184.
Norm before scaling: 3.653480197943147. Distance: 2.8123624132199314
Total norm for 5 adversaries is: 3.653480197943147. distance: 2.8123624132199314
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.5729, Accuracy: 7732/8991 (85.9971%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 3, internal_epoch   1,  Average loss: 0.0186, Accuracy: 3312/4319 (76.6844%), train_poison_data_count: 4319
Global model norm: 1.876619021464184.
Norm before scaling: 3.7080247872109484. Distance: 2.896193465931109
Total norm for 5 adversaries is: 3.7080247872109484. distance: 2.896193465931109
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.5628, Accuracy: 7780/8991 (86.5310%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3531/4396 (80.3230%), train_poison_data_count: 4396
Global model norm: 1.876619021464184.
Norm before scaling: 3.7520753839561443. Distance: 2.942360772507066
Total norm for 5 adversaries is: 3.7520753839561443. distance: 2.942360772507066
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.5395, Accuracy: 7766/8991 (86.3753%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 5, internal_epoch   1,  Average loss: 0.0208, Accuracy: 2610/3341 (78.1203%), train_poison_data_count: 3341
Global model norm: 1.876619021464184.
Norm before scaling: 3.5167379694455123. Distance: 2.6681044000905803
Total norm for 5 adversaries is: 3.5167379694455123. distance: 2.6681044000905803
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.5904, Accuracy: 7811/8991 (86.8758%)
___Train Local_Simple,  epoch  17, local model 6, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3946/5024 (78.5430%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.5923, Accuracy: 8602/10000 (86.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 7, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2670/3641 (73.3315%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6821, Accuracy: 8306/10000 (83.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 8, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3793/4701 (80.6850%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6188, Accuracy: 8570/10000 (85.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 9, internal_epoch   1,  Average loss: 0.0227, Accuracy: 2514/3315 (75.8371%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6743, Accuracy: 8440/10000 (84.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0217, Accuracy: 2621/3435 (76.3028%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6895, Accuracy: 8518/10000 (85.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 11, internal_epoch   1,  Average loss: 0.0216, Accuracy: 2930/3917 (74.8021%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6483, Accuracy: 8493/10000 (84.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 12, internal_epoch   1,  Average loss: 0.0201, Accuracy: 3129/4069 (76.8985%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6516, Accuracy: 8409/10000 (84.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3001/3851 (77.9278%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.6892, Accuracy: 8213/10000 (82.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 14, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2498/3110 (80.3215%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.1003, Accuracy: 7688/10000 (76.8800%), Attack Success Rate:0/10000(0.000)
time spent on training: 167.15428805351257
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.08711688 0.         0.         0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 1.8690, Accuracy: 6469/10000 (64.6900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 1.8835, Accuracy: 5563/8991 (61.8730%)
Done in 175.56117916107178 sec.
Server Epoch:18 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  18, local model 0, internal_epoch   1,  Average loss: 0.0201, Accuracy: 3078/3973 (77.4729%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6565, Accuracy: 8376/10000 (83.7600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 1, internal_epoch   1,  Average loss: 0.0205, Accuracy: 2867/3656 (78.4190%), train_poison_data_count: 3656
Global model norm: 1.8811187090003316.
Norm before scaling: 3.5985473457032047. Distance: 2.742021952356879
Total norm for 5 adversaries is: 3.5985473457032047. distance: 2.742021952356879
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.5626, Accuracy: 7859/8991 (87.4096%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 2, internal_epoch   1,  Average loss: 0.0190, Accuracy: 3001/3821 (78.5396%), train_poison_data_count: 3821
Global model norm: 1.8811187090003316.
Norm before scaling: 3.642876841387663. Distance: 2.7821858578158327
Total norm for 5 adversaries is: 3.642876841387663. distance: 2.7821858578158327
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.5792, Accuracy: 7621/8991 (84.7625%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 3, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3366/4319 (77.9347%), train_poison_data_count: 4319
Global model norm: 1.8811187090003316.
Norm before scaling: 3.7099573386893576. Distance: 2.882854513053445
Total norm for 5 adversaries is: 3.7099573386893576. distance: 2.882854513053445
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.5597, Accuracy: 7798/8991 (86.7312%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0174, Accuracy: 3579/4396 (81.4149%), train_poison_data_count: 4396
Global model norm: 1.8811187090003316.
Norm before scaling: 3.747149083132496. Distance: 2.9237537565692384
Total norm for 5 adversaries is: 3.747149083132496. distance: 2.9237537565692384
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.5395, Accuracy: 7864/8991 (87.4652%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 5, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2647/3341 (79.2278%), train_poison_data_count: 3341
Global model norm: 1.8811187090003316.
Norm before scaling: 3.510476373151524. Distance: 2.645381007741029
Total norm for 5 adversaries is: 3.510476373151524. distance: 2.645381007741029
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.5771, Accuracy: 7837/8991 (87.1649%)
___Train Local_Simple,  epoch  18, local model 6, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3942/5024 (78.4634%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.5966, Accuracy: 8581/10000 (85.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0212, Accuracy: 2709/3641 (74.4026%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6854, Accuracy: 8283/10000 (82.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 8, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3758/4701 (79.9404%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6173, Accuracy: 8568/10000 (85.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 9, internal_epoch   1,  Average loss: 0.0227, Accuracy: 2519/3315 (75.9879%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6792, Accuracy: 8490/10000 (84.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 10, internal_epoch   1,  Average loss: 0.0216, Accuracy: 2593/3435 (75.4876%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6906, Accuracy: 8477/10000 (84.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 11, internal_epoch   1,  Average loss: 0.0216, Accuracy: 2908/3917 (74.2405%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6705, Accuracy: 8300/10000 (83.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0201, Accuracy: 3101/4069 (76.2104%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6483, Accuracy: 8459/10000 (84.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 13, internal_epoch   1,  Average loss: 0.0200, Accuracy: 3005/3851 (78.0317%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6891, Accuracy: 8173/10000 (81.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2458/3110 (79.0354%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.1092, Accuracy: 7614/10000 (76.1400%), Attack Success Rate:0/10000(0.000)
time spent on training: 174.91209650039673
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 1.8375, Accuracy: 6616/10000 (66.1600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 1.8531, Accuracy: 5661/8991 (62.9630%)
Done in 183.22492623329163 sec.
Server Epoch:19 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  19, local model 0, internal_epoch   1,  Average loss: 0.0201, Accuracy: 3041/3973 (76.5417%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6504, Accuracy: 8435/10000 (84.3500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 1, internal_epoch   1,  Average loss: 0.0205, Accuracy: 2863/3656 (78.3096%), train_poison_data_count: 3656
Global model norm: 1.8902015527097455.
Norm before scaling: 3.6127567714791105. Distance: 2.7272397487264834
Total norm for 5 adversaries is: 3.6127567714791105. distance: 2.7272397487264834
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.5538, Accuracy: 7862/8991 (87.4430%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 2, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3014/3821 (78.8799%), train_poison_data_count: 3821
Global model norm: 1.8902015527097455.
Norm before scaling: 3.6447026415856008. Distance: 2.753479317111709
Total norm for 5 adversaries is: 3.6447026415856008. distance: 2.753479317111709
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.5773, Accuracy: 7716/8991 (85.8192%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3363/4319 (77.8652%), train_poison_data_count: 4319
Global model norm: 1.8902015527097455.
Norm before scaling: 3.710552123287227. Distance: 2.854974080250356
Total norm for 5 adversaries is: 3.710552123287227. distance: 2.854974080250356
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.5605, Accuracy: 7817/8991 (86.9425%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0174, Accuracy: 3551/4396 (80.7780%), train_poison_data_count: 4396
Global model norm: 1.8902015527097455.
Norm before scaling: 3.7563202050070155. Distance: 2.901079726640112
Total norm for 5 adversaries is: 3.7563202050070155. distance: 2.901079726640112
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.5406, Accuracy: 7830/8991 (87.0871%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 5, internal_epoch   1,  Average loss: 0.0206, Accuracy: 2671/3341 (79.9461%), train_poison_data_count: 3341
Global model norm: 1.8902015527097455.
Norm before scaling: 3.516406841231413. Distance: 2.618827010230989
Total norm for 5 adversaries is: 3.516406841231413. distance: 2.618827010230989
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.5850, Accuracy: 7777/8991 (86.4976%)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0186, Accuracy: 3946/5024 (78.5430%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.5981, Accuracy: 8511/10000 (85.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 7, internal_epoch   1,  Average loss: 0.0211, Accuracy: 2731/3641 (75.0069%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6894, Accuracy: 8181/10000 (81.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0184, Accuracy: 3837/4701 (81.6209%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6213, Accuracy: 8507/10000 (85.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 9, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2516/3315 (75.8974%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6701, Accuracy: 8491/10000 (84.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 10, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2639/3435 (76.8268%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6881, Accuracy: 8405/10000 (84.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 11, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2922/3917 (74.5979%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6559, Accuracy: 8360/10000 (83.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 12, internal_epoch   1,  Average loss: 0.0200, Accuracy: 3080/4069 (75.6943%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6501, Accuracy: 8414/10000 (84.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 13, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2993/3851 (77.7201%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6787, Accuracy: 8178/10000 (81.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 14, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2526/3110 (81.2219%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.0954, Accuracy: 7751/10000 (77.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 184.66120314598083
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.69122622 1.        ]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 1.8119, Accuracy: 6760/10000 (67.6000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 1.8289, Accuracy: 5752/8991 (63.9751%)
Done in 192.98441886901855 sec.
Server Epoch:20 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  20, local model 0, internal_epoch   1,  Average loss: 0.0199, Accuracy: 3083/3973 (77.5988%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6633, Accuracy: 8332/10000 (83.3200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 1, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2909/3656 (79.5678%), train_poison_data_count: 3656
Global model norm: 1.8982797564994331.
Norm before scaling: 3.6160864585819765. Distance: 2.707544231388122
Total norm for 5 adversaries is: 3.6160864585819765. distance: 2.707544231388122
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.5588, Accuracy: 7849/8991 (87.2984%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 2, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3021/3821 (79.0631%), train_poison_data_count: 3821
Global model norm: 1.8982797564994331.
Norm before scaling: 3.6509675559423225. Distance: 2.733349417042126
Total norm for 5 adversaries is: 3.6509675559423225. distance: 2.733349417042126
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.5739, Accuracy: 7643/8991 (85.0072%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 3, internal_epoch   1,  Average loss: 0.0183, Accuracy: 3391/4319 (78.5135%), train_poison_data_count: 4319
Global model norm: 1.8982797564994331.
Norm before scaling: 3.7102344368949507. Distance: 2.8252683090131137
Total norm for 5 adversaries is: 3.7102344368949507. distance: 2.8252683090131137
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.5626, Accuracy: 7751/8991 (86.2084%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 4, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3596/4396 (81.8016%), train_poison_data_count: 4396
Global model norm: 1.8982797564994331.
Norm before scaling: 3.7667132186263546. Distance: 2.8838208097008002
Total norm for 5 adversaries is: 3.7667132186263546. distance: 2.8838208097008002
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.5441, Accuracy: 7754/8991 (86.2418%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 5, internal_epoch   1,  Average loss: 0.0205, Accuracy: 2647/3341 (79.2278%), train_poison_data_count: 3341
Global model norm: 1.8982797564994331.
Norm before scaling: 3.5134849986348775. Distance: 2.592135190982067
Total norm for 5 adversaries is: 3.5134849986348775. distance: 2.592135190982067
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.5793, Accuracy: 7842/8991 (87.2206%)
___Train Local_Simple,  epoch  20, local model 6, internal_epoch   1,  Average loss: 0.0184, Accuracy: 4039/5024 (80.3941%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6040, Accuracy: 8465/10000 (84.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 7, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2729/3641 (74.9519%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6958, Accuracy: 8135/10000 (81.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3834/4701 (81.5571%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6222, Accuracy: 8576/10000 (85.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 9, internal_epoch   1,  Average loss: 0.0223, Accuracy: 2556/3315 (77.1041%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6843, Accuracy: 8390/10000 (83.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 10, internal_epoch   1,  Average loss: 0.0213, Accuracy: 2666/3435 (77.6128%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6932, Accuracy: 8437/10000 (84.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2940/3917 (75.0574%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6474, Accuracy: 8487/10000 (84.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0197, Accuracy: 3156/4069 (77.5621%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6462, Accuracy: 8462/10000 (84.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0194, Accuracy: 3002/3851 (77.9538%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.6896, Accuracy: 8107/10000 (81.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 14, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2502/3110 (80.4502%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0901, Accuracy: 7828/10000 (78.2800%), Attack Success Rate:0/10000(0.000)
time spent on training: 189.32795977592468
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.10175397 1.        ]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 1.7966, Accuracy: 6827/10000 (68.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 1.8139, Accuracy: 5800/8991 (64.5090%)
Done in 197.65702724456787 sec.
Server Epoch:21 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  21, local model 0, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3143/3973 (79.1090%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6508, Accuracy: 8449/10000 (84.4900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 1, internal_epoch   1,  Average loss: 0.0200, Accuracy: 2898/3656 (79.2670%), train_poison_data_count: 3656
Global model norm: 1.903545274352893.
Norm before scaling: 3.617782115467646. Distance: 2.688570563422041
Total norm for 5 adversaries is: 3.617782115467646. distance: 2.688570563422041
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.5551, Accuracy: 7861/8991 (87.4319%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 2, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3046/3821 (79.7174%), train_poison_data_count: 3821
Global model norm: 1.903545274352893.
Norm before scaling: 3.654733066021992. Distance: 2.720029683231625
Total norm for 5 adversaries is: 3.654733066021992. distance: 2.720029683231625
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.5952, Accuracy: 7589/8991 (84.4066%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 3, internal_epoch   1,  Average loss: 0.0183, Accuracy: 3360/4319 (77.7958%), train_poison_data_count: 4319
Global model norm: 1.903545274352893.
Norm before scaling: 3.7131745672842347. Distance: 2.8140442741180847
Total norm for 5 adversaries is: 3.7131745672842347. distance: 2.8140442741180847
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.5666, Accuracy: 7770/8991 (86.4198%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 4, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3556/4396 (80.8917%), train_poison_data_count: 4396
Global model norm: 1.903545274352893.
Norm before scaling: 3.773891003132951. Distance: 2.874244092999086
Total norm for 5 adversaries is: 3.773891003132951. distance: 2.874244092999086
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.5460, Accuracy: 7705/8991 (85.6968%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 5, internal_epoch   1,  Average loss: 0.0204, Accuracy: 2636/3341 (78.8985%), train_poison_data_count: 3341
Global model norm: 1.903545274352893.
Norm before scaling: 3.525448514933286. Distance: 2.590389786776601
Total norm for 5 adversaries is: 3.525448514933286. distance: 2.590389786776601
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.5856, Accuracy: 7761/8991 (86.3197%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0184, Accuracy: 4040/5024 (80.4140%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.5966, Accuracy: 8513/10000 (85.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 7, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2732/3641 (75.0343%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6806, Accuracy: 8278/10000 (82.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 8, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3840/4701 (81.6847%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6144, Accuracy: 8554/10000 (85.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 9, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2534/3315 (76.4404%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6753, Accuracy: 8451/10000 (84.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0212, Accuracy: 2634/3435 (76.6812%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6878, Accuracy: 8503/10000 (85.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 11, internal_epoch   1,  Average loss: 0.0211, Accuracy: 3000/3917 (76.5892%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6756, Accuracy: 8273/10000 (82.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0197, Accuracy: 3129/4069 (76.8985%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.6739, Accuracy: 8255/10000 (82.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 13, internal_epoch   1,  Average loss: 0.0196, Accuracy: 3031/3851 (78.7068%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7049, Accuracy: 7985/10000 (79.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2501/3110 (80.4180%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0821, Accuracy: 7771/10000 (77.7100%), Attack Success Rate:0/10000(0.000)
time spent on training: 196.7738447189331
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.83862807 1.        ]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 1.7697, Accuracy: 6940/10000 (69.4000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 1.7882, Accuracy: 5868/8991 (65.2653%)
Done in 205.26667165756226 sec.
Server Epoch:22 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  22, local model 0, internal_epoch   1,  Average loss: 0.0197, Accuracy: 3112/3973 (78.3287%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6561, Accuracy: 8324/10000 (83.2400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 1, internal_epoch   1,  Average loss: 0.0199, Accuracy: 2899/3656 (79.2943%), train_poison_data_count: 3656
Global model norm: 1.9130007543288168.
Norm before scaling: 3.6262566591587615. Distance: 2.6734095399733295
Total norm for 5 adversaries is: 3.6262566591587615. distance: 2.6734095399733295
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.5578, Accuracy: 7837/8991 (87.1649%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 2, internal_epoch   1,  Average loss: 0.0186, Accuracy: 3018/3821 (78.9846%), train_poison_data_count: 3821
Global model norm: 1.9130007543288168.
Norm before scaling: 3.6488474711526124. Distance: 2.684940006004966
Total norm for 5 adversaries is: 3.6488474711526124. distance: 2.684940006004966
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.5720, Accuracy: 7669/8991 (85.2964%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 3, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3410/4319 (78.9535%), train_poison_data_count: 4319
Global model norm: 1.9130007543288168.
Norm before scaling: 3.7273465337445066. Distance: 2.8017489624947363
Total norm for 5 adversaries is: 3.7273465337445066. distance: 2.8017489624947363
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.5644, Accuracy: 7793/8991 (86.6756%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3574/4396 (81.3012%), train_poison_data_count: 4396
Global model norm: 1.9130007543288168.
Norm before scaling: 3.774741758898814. Distance: 2.8527684000371445
Total norm for 5 adversaries is: 3.774741758898814. distance: 2.8527684000371445
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.5317, Accuracy: 7862/8991 (87.4430%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 5, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2632/3341 (78.7788%), train_poison_data_count: 3341
Global model norm: 1.9130007543288168.
Norm before scaling: 3.531118339852334. Distance: 2.5662775805775477
Total norm for 5 adversaries is: 3.531118339852334. distance: 2.5662775805775477
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.5715, Accuracy: 7852/8991 (87.3318%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0183, Accuracy: 4019/5024 (79.9960%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.5944, Accuracy: 8518/10000 (85.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2790/3641 (76.6273%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6713, Accuracy: 8385/10000 (83.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3837/4701 (81.6209%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6117, Accuracy: 8552/10000 (85.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.0221, Accuracy: 2552/3315 (76.9834%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6761, Accuracy: 8446/10000 (84.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 10, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2666/3435 (77.6128%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6814, Accuracy: 8463/10000 (84.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 11, internal_epoch   1,  Average loss: 0.0210, Accuracy: 2975/3917 (75.9510%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6533, Accuracy: 8443/10000 (84.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 12, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3170/4069 (77.9061%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.6554, Accuracy: 8381/10000 (83.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 13, internal_epoch   1,  Average loss: 0.0193, Accuracy: 3016/3851 (78.3173%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7095, Accuracy: 8056/10000 (80.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 14, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2503/3110 (80.4823%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.0883, Accuracy: 7692/10000 (76.9200%), Attack Success Rate:0/10000(0.000)
time spent on training: 205.2105574607849
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.08052002 1.        ]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 1.7553, Accuracy: 6970/10000 (69.7000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 1.7743, Accuracy: 5894/8991 (65.5544%)
Done in 213.6507692337036 sec.
Server Epoch:23 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  23, local model 0, internal_epoch   1,  Average loss: 0.0196, Accuracy: 3125/3973 (78.6559%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.6447, Accuracy: 8495/10000 (84.9500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 1, internal_epoch   1,  Average loss: 0.0198, Accuracy: 2888/3656 (78.9934%), train_poison_data_count: 3656
Global model norm: 1.9185661426642204.
Norm before scaling: 3.6089577702064886. Distance: 2.6390890134808713
Total norm for 5 adversaries is: 3.6089577702064886. distance: 2.6390890134808713
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5574, Accuracy: 7879/8991 (87.6321%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 2, internal_epoch   1,  Average loss: 0.0184, Accuracy: 3066/3821 (80.2408%), train_poison_data_count: 3821
Global model norm: 1.9185661426642204.
Norm before scaling: 3.663469018433681. Distance: 2.6857657048628116
Total norm for 5 adversaries is: 3.663469018433681. distance: 2.6857657048628116
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5755, Accuracy: 7636/8991 (84.9294%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3397/4319 (78.6525%), train_poison_data_count: 4319
Global model norm: 1.9185661426642204.
Norm before scaling: 3.720320041589571. Distance: 2.7764355425985654
Total norm for 5 adversaries is: 3.720320041589571. distance: 2.7764355425985654
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5777, Accuracy: 7725/8991 (85.9193%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 4, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3543/4396 (80.5960%), train_poison_data_count: 4396
Global model norm: 1.9185661426642204.
Norm before scaling: 3.7614110898086697. Distance: 2.820420788828488
Total norm for 5 adversaries is: 3.7614110898086697. distance: 2.820420788828488
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5443, Accuracy: 7782/8991 (86.5532%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 5, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2665/3341 (79.7665%), train_poison_data_count: 3341
Global model norm: 1.9185661426642204.
Norm before scaling: 3.527876331090803. Distance: 2.5471949464129633
Total norm for 5 adversaries is: 3.527876331090803. distance: 2.5471949464129633
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5825, Accuracy: 7775/8991 (86.4754%)
___Train Local_Simple,  epoch  23, local model 6, internal_epoch   1,  Average loss: 0.0182, Accuracy: 4034/5024 (80.2946%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.5948, Accuracy: 8548/10000 (85.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 7, internal_epoch   1,  Average loss: 0.0206, Accuracy: 2753/3641 (75.6111%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.7099, Accuracy: 8088/10000 (80.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 8, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3833/4701 (81.5358%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.5997, Accuracy: 8610/10000 (86.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 9, internal_epoch   1,  Average loss: 0.0221, Accuracy: 2503/3315 (75.5053%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.6753, Accuracy: 8405/10000 (84.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2669/3435 (77.7001%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.6824, Accuracy: 8483/10000 (84.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 11, internal_epoch   1,  Average loss: 0.0209, Accuracy: 3017/3917 (77.0232%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.6467, Accuracy: 8419/10000 (84.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3179/4069 (78.1273%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.6530, Accuracy: 8405/10000 (84.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 13, internal_epoch   1,  Average loss: 0.0192, Accuracy: 3002/3851 (77.9538%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.6642, Accuracy: 8380/10000 (83.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2539/3110 (81.6399%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.0830, Accuracy: 7815/10000 (78.1500%), Attack Success Rate:0/10000(0.000)
time spent on training: 212.197913646698
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.19579927 1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 1.7394, Accuracy: 7017/10000 (70.1700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 1.7592, Accuracy: 5914/8991 (65.7769%)
Done in 220.71340465545654 sec.
Server Epoch:24 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  24, local model 0, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3123/3973 (78.6056%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.6362, Accuracy: 8611/10000 (86.1100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 1, internal_epoch   1,  Average loss: 0.0198, Accuracy: 2909/3656 (79.5678%), train_poison_data_count: 3656
Global model norm: 1.9248611078068814.
Norm before scaling: 3.6248157059749553. Distance: 2.639199769519427
Total norm for 5 adversaries is: 3.6248157059749553. distance: 2.639199769519427
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.5629, Accuracy: 7820/8991 (86.9759%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 2, internal_epoch   1,  Average loss: 0.0184, Accuracy: 3048/3821 (79.7697%), train_poison_data_count: 3821
Global model norm: 1.9248611078068814.
Norm before scaling: 3.655692294370937. Distance: 2.6576868995264107
Total norm for 5 adversaries is: 3.655692294370937. distance: 2.6576868995264107
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.5841, Accuracy: 7606/8991 (84.5957%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   1,  Average loss: 0.0179, Accuracy: 3399/4319 (78.6988%), train_poison_data_count: 4319
Global model norm: 1.9248611078068814.
Norm before scaling: 3.7272124613353603. Distance: 2.767963003076697
Total norm for 5 adversaries is: 3.7272124613353603. distance: 2.767963003076697
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.5616, Accuracy: 7759/8991 (86.2974%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 4, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3539/4396 (80.5050%), train_poison_data_count: 4396
Global model norm: 1.9248611078068814.
Norm before scaling: 3.770374389595777. Distance: 2.8137659402715216
Total norm for 5 adversaries is: 3.770374389595777. distance: 2.8137659402715216
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.5350, Accuracy: 7814/8991 (86.9091%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 5, internal_epoch   1,  Average loss: 0.0201, Accuracy: 2684/3341 (80.3352%), train_poison_data_count: 3341
Global model norm: 1.9248611078068814.
Norm before scaling: 3.53818418538548. Distance: 2.543662168593894
Total norm for 5 adversaries is: 3.53818418538548. distance: 2.543662168593894
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.5717, Accuracy: 7845/8991 (87.2539%)
___Train Local_Simple,  epoch  24, local model 6, internal_epoch   1,  Average loss: 0.0181, Accuracy: 4015/5024 (79.9164%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5934, Accuracy: 8600/10000 (86.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 7, internal_epoch   1,  Average loss: 0.0205, Accuracy: 2759/3641 (75.7759%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.6749, Accuracy: 8224/10000 (82.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3831/4701 (81.4933%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.6117, Accuracy: 8576/10000 (85.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 9, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2561/3315 (77.2549%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.6655, Accuracy: 8529/10000 (85.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 10, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2649/3435 (77.1179%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.6806, Accuracy: 8514/10000 (85.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 11, internal_epoch   1,  Average loss: 0.0208, Accuracy: 3029/3917 (77.3296%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.6465, Accuracy: 8444/10000 (84.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   1,  Average loss: 0.0194, Accuracy: 3175/4069 (78.0290%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.6538, Accuracy: 8375/10000 (83.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0192, Accuracy: 3059/3851 (79.4339%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.6919, Accuracy: 8078/10000 (80.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 14, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2549/3110 (81.9614%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.0915, Accuracy: 7675/10000 (76.7500%), Attack Success Rate:0/10000(0.000)
time spent on training: 218.8188190460205
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.20839278 0.         0.         0.
 0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 1.7085, Accuracy: 7089/10000 (70.8900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 1.7299, Accuracy: 5947/8991 (66.1439%)
Done in 227.29713773727417 sec.
Server Epoch:25 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   1,  Average loss: 0.0194, Accuracy: 3136/3973 (78.9328%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6501, Accuracy: 8446/10000 (84.4600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 1, internal_epoch   1,  Average loss: 0.0195, Accuracy: 2938/3656 (80.3611%), train_poison_data_count: 3656
Global model norm: 1.9376019481786169.
Norm before scaling: 3.621974471720018. Distance: 2.602144743228069
Total norm for 5 adversaries is: 3.621974471720018. distance: 2.602144743228069
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.5608, Accuracy: 7834/8991 (87.1316%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 2, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3072/3821 (80.3978%), train_poison_data_count: 3821
Global model norm: 1.9376019481786169.
Norm before scaling: 3.6644240081023955. Distance: 2.6334949367366605
Total norm for 5 adversaries is: 3.6644240081023955. distance: 2.6334949367366605
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.5844, Accuracy: 7641/8991 (84.9850%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3424/4319 (79.2776%), train_poison_data_count: 4319
Global model norm: 1.9376019481786169.
Norm before scaling: 3.736966179837335. Distance: 2.74878648512541
Total norm for 5 adversaries is: 3.736966179837335. distance: 2.74878648512541
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.5555, Accuracy: 7811/8991 (86.8758%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3577/4396 (81.3694%), train_poison_data_count: 4396
Global model norm: 1.9376019481786169.
Norm before scaling: 3.7634530669481694. Distance: 2.7708193173926428
Total norm for 5 adversaries is: 3.7634530669481694. distance: 2.7708193173926428
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.5396, Accuracy: 7802/8991 (86.7757%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 5, internal_epoch   1,  Average loss: 0.0198, Accuracy: 2662/3341 (79.6767%), train_poison_data_count: 3341
Global model norm: 1.9376019481786169.
Norm before scaling: 3.525534807041221. Distance: 2.4949491978061977
Total norm for 5 adversaries is: 3.525534807041221. distance: 2.4949491978061977
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.5750, Accuracy: 7847/8991 (87.2762%)
___Train Local_Simple,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0180, Accuracy: 4028/5024 (80.1752%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.5906, Accuracy: 8537/10000 (85.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 7, internal_epoch   1,  Average loss: 0.0204, Accuracy: 2746/3641 (75.4188%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6734, Accuracy: 8330/10000 (83.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0179, Accuracy: 3841/4701 (81.7060%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6089, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 9, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2578/3315 (77.7677%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6761, Accuracy: 8417/10000 (84.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 10, internal_epoch   1,  Average loss: 0.0206, Accuracy: 2667/3435 (77.6419%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6854, Accuracy: 8489/10000 (84.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 11, internal_epoch   1,  Average loss: 0.0206, Accuracy: 3045/3917 (77.7381%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6538, Accuracy: 8435/10000 (84.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0192, Accuracy: 3175/4069 (78.0290%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6641, Accuracy: 8315/10000 (83.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 13, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3035/3851 (78.8107%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.6806, Accuracy: 8164/10000 (81.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 14, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2558/3110 (82.2508%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.0703, Accuracy: 7860/10000 (78.6000%), Attack Success Rate:0/10000(0.000)
time spent on training: 229.76453733444214
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 1.6964, Accuracy: 7126/10000 (71.2600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 1.7183, Accuracy: 5979/8991 (66.4998%)
Done in 238.26568365097046 sec.
Server Epoch:26 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  26, local model 0, internal_epoch   1,  Average loss: 0.0193, Accuracy: 3123/3973 (78.6056%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6505, Accuracy: 8501/10000 (85.0100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 1, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2887/3656 (78.9661%), train_poison_data_count: 3656
Global model norm: 1.9431616601096129.
Norm before scaling: 3.624262109831362. Distance: 2.5902925910787493
Total norm for 5 adversaries is: 3.624262109831362. distance: 2.5902925910787493
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.5545, Accuracy: 7900/8991 (87.8656%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 2, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3071/3821 (80.3716%), train_poison_data_count: 3821
Global model norm: 1.9431616601096129.
Norm before scaling: 3.662679122346303. Distance: 2.6172235742616445
Total norm for 5 adversaries is: 3.662679122346303. distance: 2.6172235742616445
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.5714, Accuracy: 7728/8991 (85.9526%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3453/4319 (79.9491%), train_poison_data_count: 4319
Global model norm: 1.9431616601096129.
Norm before scaling: 3.724806397802554. Distance: 2.71972849107876
Total norm for 5 adversaries is: 3.724806397802554. distance: 2.71972849107876
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.5663, Accuracy: 7750/8991 (86.1973%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3603/4396 (81.9609%), train_poison_data_count: 4396
Global model norm: 1.9431616601096129.
Norm before scaling: 3.7620097807331696. Distance: 2.754598933552579
Total norm for 5 adversaries is: 3.7620097807331696. distance: 2.754598933552579
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.5365, Accuracy: 7793/8991 (86.6756%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 5, internal_epoch   1,  Average loss: 0.0198, Accuracy: 2672/3341 (79.9761%), train_poison_data_count: 3341
Global model norm: 1.9431616601096129.
Norm before scaling: 3.529555732932262. Distance: 2.485682017722943
Total norm for 5 adversaries is: 3.529555732932262. distance: 2.485682017722943
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.5816, Accuracy: 7787/8991 (86.6088%)
___Train Local_Simple,  epoch  26, local model 6, internal_epoch   1,  Average loss: 0.0179, Accuracy: 4026/5024 (80.1354%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.5866, Accuracy: 8551/10000 (85.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 7, internal_epoch   1,  Average loss: 0.0204, Accuracy: 2746/3641 (75.4188%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6811, Accuracy: 8245/10000 (82.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3857/4701 (82.0464%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6091, Accuracy: 8544/10000 (85.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 9, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2601/3315 (78.4615%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6799, Accuracy: 8308/10000 (83.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 10, internal_epoch   1,  Average loss: 0.0206, Accuracy: 2687/3435 (78.2242%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6781, Accuracy: 8522/10000 (85.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3008/3917 (76.7935%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6463, Accuracy: 8471/10000 (84.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3191/4069 (78.4222%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6487, Accuracy: 8447/10000 (84.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3103/3851 (80.5765%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6704, Accuracy: 8247/10000 (82.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2531/3110 (81.3826%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.0645, Accuracy: 7800/10000 (78.0000%), Attack Success Rate:0/10000(0.000)
time spent on training: 234.22575402259827
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.25982199 1.        ]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 1.6808, Accuracy: 7150/10000 (71.5000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 1.7034, Accuracy: 5994/8991 (66.6667%)
Done in 242.52469754219055 sec.
Server Epoch:27 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0192, Accuracy: 3141/3973 (79.0586%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.6509, Accuracy: 8411/10000 (84.1100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 1, internal_epoch   1,  Average loss: 0.0198, Accuracy: 2897/3656 (79.2396%), train_poison_data_count: 3656
Global model norm: 1.9504422493261735.
Norm before scaling: 3.6306978367272884. Distance: 2.5816481128548827
Total norm for 5 adversaries is: 3.6306978367272884. distance: 2.5816481128548827
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.5613, Accuracy: 7812/8991 (86.8869%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3040/3821 (79.5603%), train_poison_data_count: 3821
Global model norm: 1.9504422493261735.
Norm before scaling: 3.658264648441541. Distance: 2.595027471113973
Total norm for 5 adversaries is: 3.658264648441541. distance: 2.595027471113973
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.5706, Accuracy: 7719/8991 (85.8525%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3409/4319 (78.9303%), train_poison_data_count: 4319
Global model norm: 1.9504422493261735.
Norm before scaling: 3.725708293780424. Distance: 2.704211859969528
Total norm for 5 adversaries is: 3.725708293780424. distance: 2.704211859969528
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.5674, Accuracy: 7760/8991 (86.3085%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 4, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3602/4396 (81.9381%), train_poison_data_count: 4396
Global model norm: 1.9504422493261735.
Norm before scaling: 3.7753541237161383. Distance: 2.751041128574267
Total norm for 5 adversaries is: 3.7753541237161383. distance: 2.751041128574267
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.5355, Accuracy: 7779/8991 (86.5199%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 5, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2713/3341 (81.2032%), train_poison_data_count: 3341
Global model norm: 1.9504422493261735.
Norm before scaling: 3.540902103849443. Distance: 2.4817878159498683
Total norm for 5 adversaries is: 3.540902103849443. distance: 2.4817878159498683
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.5762, Accuracy: 7831/8991 (87.0982%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.0179, Accuracy: 4030/5024 (80.2150%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.5934, Accuracy: 8518/10000 (85.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 7, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2779/3641 (76.3252%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.6805, Accuracy: 8205/10000 (82.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 8, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3881/4701 (82.5569%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.6141, Accuracy: 8549/10000 (85.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 9, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2568/3315 (77.4661%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.6690, Accuracy: 8466/10000 (84.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   1,  Average loss: 0.0204, Accuracy: 2720/3435 (79.1849%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.6763, Accuracy: 8472/10000 (84.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 11, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3011/3917 (76.8701%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.6591, Accuracy: 8388/10000 (83.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 12, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3199/4069 (78.6188%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.6537, Accuracy: 8372/10000 (83.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 13, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3084/3851 (80.0831%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.6626, Accuracy: 8304/10000 (83.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2551/3110 (82.0257%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.0716, Accuracy: 7755/10000 (77.5500%), Attack Success Rate:0/10000(0.000)
time spent on training: 242.42285346984863
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 1.6691, Accuracy: 7172/10000 (71.7200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 1.6924, Accuracy: 6002/8991 (66.7556%)
Done in 251.85862803459167 sec.
Server Epoch:28 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  28, local model 0, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3166/3973 (79.6879%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6498, Accuracy: 8361/10000 (83.6100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 1, internal_epoch   1,  Average loss: 0.0194, Accuracy: 2913/3656 (79.6772%), train_poison_data_count: 3656
Global model norm: 1.9562174614585932.
Norm before scaling: 3.6271766178785887. Distance: 2.5648590951925874
Total norm for 5 adversaries is: 3.6271766178785887. distance: 2.5648590951925874
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.5510, Accuracy: 7914/8991 (88.0214%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3084/3821 (80.7119%), train_poison_data_count: 3821
Global model norm: 1.9562174614585932.
Norm before scaling: 3.655780990384709. Distance: 2.579566876036428
Total norm for 5 adversaries is: 3.655780990384709. distance: 2.579566876036428
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.5793, Accuracy: 7691/8991 (85.5411%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3425/4319 (79.3008%), train_poison_data_count: 4319
Global model norm: 1.9562174614585932.
Norm before scaling: 3.7223834070888127. Distance: 2.6860652908717935
Total norm for 5 adversaries is: 3.7223834070888127. distance: 2.6860652908717935
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.5533, Accuracy: 7842/8991 (87.2206%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 4, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3633/4396 (82.6433%), train_poison_data_count: 4396
Global model norm: 1.9562174614585932.
Norm before scaling: 3.780260823651779. Distance: 2.7457964588365567
Total norm for 5 adversaries is: 3.780260823651779. distance: 2.7457964588365567
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.5425, Accuracy: 7787/8991 (86.6088%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 5, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2686/3341 (80.3951%), train_poison_data_count: 3341
Global model norm: 1.9562174614585932.
Norm before scaling: 3.5452921692360677. Distance: 2.4729868590996475
Total norm for 5 adversaries is: 3.5452921692360677. distance: 2.4729868590996475
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.5746, Accuracy: 7789/8991 (86.6311%)
___Train Local_Simple,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0178, Accuracy: 4029/5024 (80.1951%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.5827, Accuracy: 8642/10000 (86.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 7, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2762/3641 (75.8583%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6640, Accuracy: 8384/10000 (83.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 8, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3857/4701 (82.0464%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6072, Accuracy: 8582/10000 (85.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 9, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2595/3315 (78.2805%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6702, Accuracy: 8454/10000 (84.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 10, internal_epoch   1,  Average loss: 0.0204, Accuracy: 2685/3435 (78.1659%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6868, Accuracy: 8385/10000 (83.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 11, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3008/3917 (76.7935%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6559, Accuracy: 8316/10000 (83.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 12, internal_epoch   1,  Average loss: 0.0190, Accuracy: 3186/4069 (78.2993%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6423, Accuracy: 8455/10000 (84.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 13, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3079/3851 (79.9533%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6847, Accuracy: 8141/10000 (81.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 14, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2549/3110 (81.9614%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.0709, Accuracy: 7773/10000 (77.7300%), Attack Success Rate:0/10000(0.000)
time spent on training: 248.24380254745483
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 1.6577, Accuracy: 7185/10000 (71.8500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 1.6813, Accuracy: 6021/8991 (66.9670%)
Done in 256.5964686870575 sec.
Server Epoch:29 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  29, local model 0, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3165/3973 (79.6627%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.6357, Accuracy: 8539/10000 (85.3900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 1, internal_epoch   1,  Average loss: 0.0192, Accuracy: 2925/3656 (80.0055%), train_poison_data_count: 3656
Global model norm: 1.9621219781178079.
Norm before scaling: 3.628484695307675. Distance: 2.5530178201653406
Total norm for 5 adversaries is: 3.628484695307675. distance: 2.5530178201653406
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.5544, Accuracy: 7868/8991 (87.5097%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 2, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3048/3821 (79.7697%), train_poison_data_count: 3821
Global model norm: 1.9621219781178079.
Norm before scaling: 3.66451457473994. Distance: 2.573754136988616
Total norm for 5 adversaries is: 3.66451457473994. distance: 2.573754136988616
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.5753, Accuracy: 7630/8991 (84.8626%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3437/4319 (79.5786%), train_poison_data_count: 4319
Global model norm: 1.9621219781178079.
Norm before scaling: 3.7331620165709087. Distance: 2.685506391740322
Total norm for 5 adversaries is: 3.7331620165709087. distance: 2.685506391740322
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.5570, Accuracy: 7804/8991 (86.7979%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 4, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3645/4396 (82.9163%), train_poison_data_count: 4396
Global model norm: 1.9621219781178079.
Norm before scaling: 3.774454868189836. Distance: 2.725662826279108
Total norm for 5 adversaries is: 3.774454868189836. distance: 2.725662826279108
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.5307, Accuracy: 7861/8991 (87.4319%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 5, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2708/3341 (81.0536%), train_poison_data_count: 3341
Global model norm: 1.9621219781178079.
Norm before scaling: 3.5505528140473217. Distance: 2.464378542760885
Total norm for 5 adversaries is: 3.5505528140473217. distance: 2.464378542760885
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.5782, Accuracy: 7816/8991 (86.9314%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0178, Accuracy: 4036/5024 (80.3344%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.5862, Accuracy: 8576/10000 (85.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 7, internal_epoch   1,  Average loss: 0.0201, Accuracy: 2777/3641 (76.2703%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.6636, Accuracy: 8333/10000 (83.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3867/4701 (82.2591%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.6076, Accuracy: 8574/10000 (85.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 9, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2575/3315 (77.6772%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.6702, Accuracy: 8441/10000 (84.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 10, internal_epoch   1,  Average loss: 0.0204, Accuracy: 2712/3435 (78.9520%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.6816, Accuracy: 8440/10000 (84.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 11, internal_epoch   1,  Average loss: 0.0204, Accuracy: 3018/3917 (77.0488%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.6551, Accuracy: 8383/10000 (83.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 12, internal_epoch   1,  Average loss: 0.0189, Accuracy: 3201/4069 (78.6680%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.6534, Accuracy: 8362/10000 (83.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 13, internal_epoch   1,  Average loss: 0.0184, Accuracy: 3071/3851 (79.7455%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.6806, Accuracy: 8181/10000 (81.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 14, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2560/3110 (82.3151%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.0897, Accuracy: 7609/10000 (76.0900%), Attack Success Rate:0/10000(0.000)
time spent on training: 256.29135298728943
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 1.6464, Accuracy: 7197/10000 (71.9700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 1.6704, Accuracy: 6033/8991 (67.1004%)
Done in 264.7641341686249 sec.
Server Epoch:30 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  30, local model 0, internal_epoch   1,  Average loss: 0.0190, Accuracy: 3169/3973 (79.7634%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6492, Accuracy: 8410/10000 (84.1000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 1, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2936/3656 (80.3063%), train_poison_data_count: 3656
Global model norm: 1.9681536058786184.
Norm before scaling: 3.635152477440351. Distance: 2.5478344379754625
Total norm for 5 adversaries is: 3.635152477440351. distance: 2.5478344379754625
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.5536, Accuracy: 7837/8991 (87.1649%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 2, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3082/3821 (80.6595%), train_poison_data_count: 3821
Global model norm: 1.9681536058786184.
Norm before scaling: 3.6581127931569437. Distance: 2.5507010524696585
Total norm for 5 adversaries is: 3.6581127931569437. distance: 2.5507010524696585
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.5784, Accuracy: 7626/8991 (84.8182%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3449/4319 (79.8564%), train_poison_data_count: 4319
Global model norm: 1.9681536058786184.
Norm before scaling: 3.744938804625601. Distance: 2.6845166702989185
Total norm for 5 adversaries is: 3.744938804625601. distance: 2.6845166702989185
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.5652, Accuracy: 7762/8991 (86.3308%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3661/4396 (83.2803%), train_poison_data_count: 4396
Global model norm: 1.9681536058786184.
Norm before scaling: 3.772780841058516. Distance: 2.709128444061322
Total norm for 5 adversaries is: 3.772780841058516. distance: 2.709128444061322
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.5359, Accuracy: 7824/8991 (87.0204%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 5, internal_epoch   1,  Average loss: 0.0195, Accuracy: 2707/3341 (81.0236%), train_poison_data_count: 3341
Global model norm: 1.9681536058786184.
Norm before scaling: 3.5467177032680235. Distance: 2.4490814900608138
Total norm for 5 adversaries is: 3.5467177032680235. distance: 2.4490814900608138
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.5664, Accuracy: 7871/8991 (87.5431%)
___Train Local_Simple,  epoch  30, local model 6, internal_epoch   1,  Average loss: 0.0177, Accuracy: 4062/5024 (80.8519%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5861, Accuracy: 8580/10000 (85.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 7, internal_epoch   1,  Average loss: 0.0200, Accuracy: 2772/3641 (76.1329%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6662, Accuracy: 8328/10000 (83.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3890/4701 (82.7484%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6015, Accuracy: 8609/10000 (86.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 9, internal_epoch   1,  Average loss: 0.0212, Accuracy: 2602/3315 (78.4917%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6674, Accuracy: 8459/10000 (84.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0202, Accuracy: 2722/3435 (79.2431%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6717, Accuracy: 8566/10000 (85.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0203, Accuracy: 3047/3917 (77.7891%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6443, Accuracy: 8393/10000 (83.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 12, internal_epoch   1,  Average loss: 0.0189, Accuracy: 3235/4069 (79.5036%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6559, Accuracy: 8324/10000 (83.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 13, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3070/3851 (79.7196%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.6962, Accuracy: 8040/10000 (80.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 14, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2558/3110 (82.2508%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.0641, Accuracy: 7703/10000 (77.0300%), Attack Success Rate:0/10000(0.000)
time spent on training: 266.1608018875122
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.19766283 1.        ]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 1.6326, Accuracy: 7228/10000 (72.2800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 1.6576, Accuracy: 6050/8991 (67.2895%)
Done in 274.6327590942383 sec.
Server Epoch:31 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  31, local model 0, internal_epoch   1,  Average loss: 0.0190, Accuracy: 3132/3973 (78.8321%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6405, Accuracy: 8513/10000 (85.1300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 1, internal_epoch   1,  Average loss: 0.0192, Accuracy: 2934/3656 (80.2516%), train_poison_data_count: 3656
Global model norm: 1.9755121991382618.
Norm before scaling: 3.635139228851457. Distance: 2.5323855831588467
Total norm for 5 adversaries is: 3.635139228851457. distance: 2.5323855831588467
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.5621, Accuracy: 7833/8991 (87.1205%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 2, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3093/3821 (80.9474%), train_poison_data_count: 3821
Global model norm: 1.9755121991382618.
Norm before scaling: 3.676366647934004. Distance: 2.556033931638287
Total norm for 5 adversaries is: 3.676366647934004. distance: 2.556033931638287
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.5703, Accuracy: 7715/8991 (85.8080%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3424/4319 (79.2776%), train_poison_data_count: 4319
Global model norm: 1.9755121991382618.
Norm before scaling: 3.7294301769278477. Distance: 2.6502235714152698
Total norm for 5 adversaries is: 3.7294301769278477. distance: 2.6502235714152698
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.5771, Accuracy: 7682/8991 (85.4410%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3633/4396 (82.6433%), train_poison_data_count: 4396
Global model norm: 1.9755121991382618.
Norm before scaling: 3.7872695298781363. Distance: 2.7077867298693943
Total norm for 5 adversaries is: 3.7872695298781363. distance: 2.7077867298693943
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.5323, Accuracy: 7810/8991 (86.8646%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 5, internal_epoch   1,  Average loss: 0.0195, Accuracy: 2688/3341 (80.4550%), train_poison_data_count: 3341
Global model norm: 1.9755121991382618.
Norm before scaling: 3.539146304454092. Distance: 2.4259332925567643
Total norm for 5 adversaries is: 3.539146304454092. distance: 2.4259332925567643
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.5767, Accuracy: 7773/8991 (86.4531%)
___Train Local_Simple,  epoch  31, local model 6, internal_epoch   1,  Average loss: 0.0176, Accuracy: 4053/5024 (80.6728%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.5953, Accuracy: 8573/10000 (85.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0199, Accuracy: 2766/3641 (75.9681%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6629, Accuracy: 8445/10000 (84.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 8, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3920/4701 (83.3865%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6148, Accuracy: 8556/10000 (85.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0211, Accuracy: 2600/3315 (78.4314%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6740, Accuracy: 8440/10000 (84.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 10, internal_epoch   1,  Average loss: 0.0201, Accuracy: 2687/3435 (78.2242%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6688, Accuracy: 8518/10000 (85.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3043/3917 (77.6870%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6468, Accuracy: 8416/10000 (84.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3185/4069 (78.2748%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6358, Accuracy: 8481/10000 (84.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 13, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3087/3851 (80.1610%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.6620, Accuracy: 8278/10000 (82.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2576/3110 (82.8296%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.0674, Accuracy: 7717/10000 (77.1700%), Attack Success Rate:0/10000(0.000)
time spent on training: 271.9368643760681
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         1.         0.         0.         0.
 0.         0.48506172 1.        ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 1.5999, Accuracy: 7310/10000 (73.1000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 1.6267, Accuracy: 6093/8991 (67.7678%)
Done in 280.37240862846375 sec.
Server Epoch:32 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  32, local model 0, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3157/3973 (79.4614%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6355, Accuracy: 8504/10000 (85.0400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 1, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2941/3656 (80.4431%), train_poison_data_count: 3656
Global model norm: 1.9921569821881278.
Norm before scaling: 3.6346812702211166. Distance: 2.4949324746636137
Total norm for 5 adversaries is: 3.6346812702211166. distance: 2.4949324746636137
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.5494, Accuracy: 7878/8991 (87.6210%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 2, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3099/3821 (81.1044%), train_poison_data_count: 3821
Global model norm: 1.9921569821881278.
Norm before scaling: 3.679063100138377. Distance: 2.5201034014544357
Total norm for 5 adversaries is: 3.679063100138377. distance: 2.5201034014544357
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.5716, Accuracy: 7696/8991 (85.5967%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3487/4319 (80.7363%), train_poison_data_count: 4319
Global model norm: 1.9921569821881278.
Norm before scaling: 3.743968691034721. Distance: 2.6304577901151336
Total norm for 5 adversaries is: 3.743968691034721. distance: 2.6304577901151336
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.5637, Accuracy: 7753/8991 (86.2307%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 4, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3619/4396 (82.3248%), train_poison_data_count: 4396
Global model norm: 1.9921569821881278.
Norm before scaling: 3.7855675378412057. Distance: 2.670557065135844
Total norm for 5 adversaries is: 3.7855675378412057. distance: 2.670557065135844
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.5358, Accuracy: 7816/8991 (86.9314%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 5, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2701/3341 (80.8441%), train_poison_data_count: 3341
Global model norm: 1.9921569821881278.
Norm before scaling: 3.5478326118145818. Distance: 2.398281427828659
Total norm for 5 adversaries is: 3.5478326118145818. distance: 2.398281427828659
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.5695, Accuracy: 7874/8991 (87.5765%)
___Train Local_Simple,  epoch  32, local model 6, internal_epoch   1,  Average loss: 0.0175, Accuracy: 4034/5024 (80.2946%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.5938, Accuracy: 8539/10000 (85.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 7, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2813/3641 (77.2590%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6659, Accuracy: 8308/10000 (83.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3887/4701 (82.6845%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6082, Accuracy: 8598/10000 (85.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 9, internal_epoch   1,  Average loss: 0.0210, Accuracy: 2624/3315 (79.1554%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6676, Accuracy: 8435/10000 (84.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 10, internal_epoch   1,  Average loss: 0.0200, Accuracy: 2735/3435 (79.6215%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6705, Accuracy: 8562/10000 (85.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 11, internal_epoch   1,  Average loss: 0.0200, Accuracy: 3023/3917 (77.1764%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6422, Accuracy: 8418/10000 (84.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 12, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3220/4069 (79.1349%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6397, Accuracy: 8459/10000 (84.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 13, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3099/3851 (80.4726%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.6691, Accuracy: 8237/10000 (82.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 14, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2550/3110 (81.9936%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.0586, Accuracy: 7851/10000 (78.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 266.1843373775482
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.00405119 0.         0.         0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 1.5895, Accuracy: 7326/10000 (73.2600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 1.6168, Accuracy: 6109/8991 (67.9457%)
Done in 273.9955973625183 sec.
Server Epoch:33 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  33, local model 0, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3140/3973 (79.0335%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6279, Accuracy: 8559/10000 (85.5900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2923/3656 (79.9508%), train_poison_data_count: 3656
Global model norm: 1.9985105213368388.
Norm before scaling: 3.6430733106358812. Distance: 2.490819764987835
Total norm for 5 adversaries is: 3.6430733106358812. distance: 2.490819764987835
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.5593, Accuracy: 7832/8991 (87.1093%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3068/3821 (80.2931%), train_poison_data_count: 3821
Global model norm: 1.9985105213368388.
Norm before scaling: 3.6785314084229195. Distance: 2.5083188885582306
Total norm for 5 adversaries is: 3.6785314084229195. distance: 2.5083188885582306
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.5792, Accuracy: 7666/8991 (85.2630%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3493/4319 (80.8752%), train_poison_data_count: 4319
Global model norm: 1.9985105213368388.
Norm before scaling: 3.7601848893667023. Distance: 2.634744450375903
Total norm for 5 adversaries is: 3.7601848893667023. distance: 2.634744450375903
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.5457, Accuracy: 7830/8991 (87.0871%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3628/4396 (82.5296%), train_poison_data_count: 4396
Global model norm: 1.9985105213368388.
Norm before scaling: 3.775247396484512. Distance: 2.644942506623213
Total norm for 5 adversaries is: 3.775247396484512. distance: 2.644942506623213
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.5379, Accuracy: 7827/8991 (87.0537%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 5, internal_epoch   1,  Average loss: 0.0192, Accuracy: 2714/3341 (81.2332%), train_poison_data_count: 3341
Global model norm: 1.9985105213368388.
Norm before scaling: 3.55563160861322. Distance: 2.391617413145463
Total norm for 5 adversaries is: 3.55563160861322. distance: 2.391617413145463
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.5767, Accuracy: 7731/8991 (85.9860%)
___Train Local_Simple,  epoch  33, local model 6, internal_epoch   1,  Average loss: 0.0175, Accuracy: 4076/5024 (81.1306%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5859, Accuracy: 8591/10000 (85.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 7, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2830/3641 (77.7259%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6798, Accuracy: 8223/10000 (82.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 8, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3879/4701 (82.5144%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6051, Accuracy: 8564/10000 (85.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 9, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2624/3315 (79.1554%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6668, Accuracy: 8498/10000 (84.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 10, internal_epoch   1,  Average loss: 0.0198, Accuracy: 2746/3435 (79.9418%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6730, Accuracy: 8508/10000 (85.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 11, internal_epoch   1,  Average loss: 0.0200, Accuracy: 3070/3917 (78.3763%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6385, Accuracy: 8448/10000 (84.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 12, internal_epoch   1,  Average loss: 0.0186, Accuracy: 3224/4069 (79.2332%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6755, Accuracy: 8188/10000 (81.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 13, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3083/3851 (80.0571%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.6901, Accuracy: 8095/10000 (80.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2585/3110 (83.1190%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.0482, Accuracy: 7880/10000 (78.8000%), Attack Success Rate:0/10000(0.000)
time spent on training: 289.45141887664795
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        0.        0.        0.        0.1400705
 1.       ]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 1.5773, Accuracy: 7365/10000 (73.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 1.6052, Accuracy: 6127/8991 (68.1459%)
Done in 297.8958168029785 sec.
Server Epoch:34 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3142/3973 (79.0838%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6478, Accuracy: 8428/10000 (84.2800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 1, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2942/3656 (80.4705%), train_poison_data_count: 3656
Global model norm: 2.0059091771674704.
Norm before scaling: 3.639392431297006. Distance: 2.4723988861607302
Total norm for 5 adversaries is: 3.639392431297006. distance: 2.4723988861607302
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.5512, Accuracy: 7896/8991 (87.8212%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 2, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3104/3821 (81.2353%), train_poison_data_count: 3821
Global model norm: 2.0059091771674704.
Norm before scaling: 3.6803721704121366. Distance: 2.491172272828139
Total norm for 5 adversaries is: 3.6803721704121366. distance: 2.491172272828139
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.5679, Accuracy: 7678/8991 (85.3965%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3480/4319 (80.5742%), train_poison_data_count: 4319
Global model norm: 2.0059091771674704.
Norm before scaling: 3.738451022096812. Distance: 2.597017091979083
Total norm for 5 adversaries is: 3.738451022096812. distance: 2.597017091979083
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.5507, Accuracy: 7848/8991 (87.2873%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 4, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3619/4396 (82.3248%), train_poison_data_count: 4396
Global model norm: 2.0059091771674704.
Norm before scaling: 3.78224017837402. Distance: 2.6374940085682006
Total norm for 5 adversaries is: 3.78224017837402. distance: 2.6374940085682006
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.5399, Accuracy: 7820/8991 (86.9759%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 5, internal_epoch   1,  Average loss: 0.0192, Accuracy: 2707/3341 (81.0236%), train_poison_data_count: 3341
Global model norm: 2.0059091771674704.
Norm before scaling: 3.5606066039113875. Distance: 2.381748950178424
Total norm for 5 adversaries is: 3.5606066039113875. distance: 2.381748950178424
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.5661, Accuracy: 7826/8991 (87.0426%)
___Train Local_Simple,  epoch  34, local model 6, internal_epoch   1,  Average loss: 0.0174, Accuracy: 4052/5024 (80.6529%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.5906, Accuracy: 8552/10000 (85.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 7, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2824/3641 (77.5611%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6695, Accuracy: 8332/10000 (83.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 8, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3922/4701 (83.4291%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6049, Accuracy: 8604/10000 (86.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 9, internal_epoch   1,  Average loss: 0.0208, Accuracy: 2615/3315 (78.8839%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6678, Accuracy: 8434/10000 (84.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 10, internal_epoch   1,  Average loss: 0.0198, Accuracy: 2734/3435 (79.5924%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6686, Accuracy: 8546/10000 (85.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 11, internal_epoch   1,  Average loss: 0.0199, Accuracy: 3050/3917 (77.8657%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6402, Accuracy: 8467/10000 (84.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 12, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3238/4069 (79.5773%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6712, Accuracy: 8232/10000 (82.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 13, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3119/3851 (80.9920%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.6863, Accuracy: 8106/10000 (81.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 14, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2579/3110 (82.9260%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.0481, Accuracy: 7875/10000 (78.7500%), Attack Success Rate:0/10000(0.000)
time spent on training: 300.2525188922882
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.30148238 1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 1.5636, Accuracy: 7396/10000 (73.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 1.5926, Accuracy: 6137/8991 (68.2571%)
Done in 308.9531075954437 sec.
Server Epoch:35 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  35, local model 0, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3191/3973 (80.3171%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6416, Accuracy: 8454/10000 (84.5400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2948/3656 (80.6346%), train_poison_data_count: 3656
Global model norm: 2.0145343520775922.
Norm before scaling: 3.640082060968337. Distance: 2.4571249842389755
Total norm for 5 adversaries is: 3.640082060968337. distance: 2.4571249842389755
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.5537, Accuracy: 7877/8991 (87.6098%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 2, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3111/3821 (81.4185%), train_poison_data_count: 3821
Global model norm: 2.0145343520775922.
Norm before scaling: 3.6875067242059982. Distance: 2.4835616405771743
Total norm for 5 adversaries is: 3.6875067242059982. distance: 2.4835616405771743
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.5785, Accuracy: 7587/8991 (84.3844%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3494/4319 (80.8984%), train_poison_data_count: 4319
Global model norm: 2.0145343520775922.
Norm before scaling: 3.748262384290787. Distance: 2.592843506291908
Total norm for 5 adversaries is: 3.748262384290787. distance: 2.592843506291908
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.5529, Accuracy: 7831/8991 (87.0982%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 4, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3664/4396 (83.3485%), train_poison_data_count: 4396
Global model norm: 2.0145343520775922.
Norm before scaling: 3.7825596330559694. Distance: 2.6214786707395845
Total norm for 5 adversaries is: 3.7825596330559694. distance: 2.6214786707395845
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.5386, Accuracy: 7765/8991 (86.3641%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 5, internal_epoch   1,  Average loss: 0.0191, Accuracy: 2709/3341 (81.0835%), train_poison_data_count: 3341
Global model norm: 2.0145343520775922.
Norm before scaling: 3.558945338010309. Distance: 2.3649080588472224
Total norm for 5 adversaries is: 3.558945338010309. distance: 2.3649080588472224
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.5753, Accuracy: 7756/8991 (86.2640%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   1,  Average loss: 0.0173, Accuracy: 4059/5024 (80.7922%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.5850, Accuracy: 8605/10000 (86.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 7, internal_epoch   1,  Average loss: 0.0195, Accuracy: 2809/3641 (77.1491%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6794, Accuracy: 8310/10000 (83.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3917/4701 (83.3227%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6088, Accuracy: 8572/10000 (85.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 9, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2611/3315 (78.7632%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6587, Accuracy: 8495/10000 (84.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 10, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2710/3435 (78.8937%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6679, Accuracy: 8497/10000 (84.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 11, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3082/3917 (78.6827%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6384, Accuracy: 8476/10000 (84.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0186, Accuracy: 3199/4069 (78.6188%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6665, Accuracy: 8265/10000 (82.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 13, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3095/3851 (80.3687%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.6623, Accuracy: 8231/10000 (82.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 14, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2578/3110 (82.8939%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.0689, Accuracy: 7613/10000 (76.1300%), Attack Success Rate:0/10000(0.000)
time spent on training: 305.26207065582275
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 1.5407, Accuracy: 7429/10000 (74.2900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 1.5707, Accuracy: 6152/8991 (68.4240%)
Done in 313.7420971393585 sec.
Server Epoch:36 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  36, local model 0, internal_epoch   1,  Average loss: 0.0184, Accuracy: 3185/3973 (80.1661%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6432, Accuracy: 8414/10000 (84.1400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 1, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2955/3656 (80.8260%), train_poison_data_count: 3656
Global model norm: 2.0281520988640644.
Norm before scaling: 3.6462904434655106. Distance: 2.436353854162332
Total norm for 5 adversaries is: 3.6462904434655106. distance: 2.436353854162332
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.5478, Accuracy: 7896/8991 (87.8212%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 2, internal_epoch   1,  Average loss: 0.0174, Accuracy: 3099/3821 (81.1044%), train_poison_data_count: 3821
Global model norm: 2.0281520988640644.
Norm before scaling: 3.684106720272226. Distance: 2.4513640674154513
Total norm for 5 adversaries is: 3.684106720272226. distance: 2.4513640674154513
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.5610, Accuracy: 7724/8991 (85.9081%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3463/4319 (80.1806%), train_poison_data_count: 4319
Global model norm: 2.0281520988640644.
Norm before scaling: 3.7546885109025765. Distance: 2.5718660152829944
Total norm for 5 adversaries is: 3.7546885109025765. distance: 2.5718660152829944
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.5478, Accuracy: 7819/8991 (86.9647%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3664/4396 (83.3485%), train_poison_data_count: 4396
Global model norm: 2.0281520988640644.
Norm before scaling: 3.7933372059306762. Distance: 2.6043193518065038
Total norm for 5 adversaries is: 3.7933372059306762. distance: 2.6043193518065038
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.5308, Accuracy: 7816/8991 (86.9314%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 5, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2707/3341 (81.0236%), train_poison_data_count: 3341
Global model norm: 2.0281520988640644.
Norm before scaling: 3.5527546417010587. Distance: 2.331303826495617
Total norm for 5 adversaries is: 3.5527546417010587. distance: 2.331303826495617
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.5681, Accuracy: 7870/8991 (87.5320%)
___Train Local_Simple,  epoch  36, local model 6, internal_epoch   1,  Average loss: 0.0172, Accuracy: 4091/5024 (81.4291%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.5918, Accuracy: 8524/10000 (85.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 7, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2829/3641 (77.6984%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6667, Accuracy: 8331/10000 (83.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 8, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3903/4701 (83.0249%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6115, Accuracy: 8528/10000 (85.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 9, internal_epoch   1,  Average loss: 0.0206, Accuracy: 2633/3315 (79.4268%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6610, Accuracy: 8502/10000 (85.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2755/3435 (80.2038%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6663, Accuracy: 8553/10000 (85.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 11, internal_epoch   1,  Average loss: 0.0197, Accuracy: 3065/3917 (78.2487%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6403, Accuracy: 8495/10000 (84.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 12, internal_epoch   1,  Average loss: 0.0184, Accuracy: 3252/4069 (79.9214%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.6603, Accuracy: 8295/10000 (82.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 13, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3103/3851 (80.5765%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.7195, Accuracy: 7859/10000 (78.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   1,  Average loss: 0.0170, Accuracy: 2574/3110 (82.7653%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.0477, Accuracy: 7856/10000 (78.5600%), Attack Success Rate:0/10000(0.000)
time spent on training: 314.9531764984131
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 1.5195, Accuracy: 7493/10000 (74.9300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 1.5510, Accuracy: 6189/8991 (68.8355%)
Done in 323.4983685016632 sec.
Server Epoch:37 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.0183, Accuracy: 3147/3973 (79.2097%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6386, Accuracy: 8504/10000 (85.0400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 1, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2944/3656 (80.5252%), train_poison_data_count: 3656
Global model norm: 2.042282193359187.
Norm before scaling: 3.653912440945819. Distance: 2.4163596078766165
Total norm for 5 adversaries is: 3.653912440945819. distance: 2.4163596078766165
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.5488, Accuracy: 7873/8991 (87.5653%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 2, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3119/3821 (81.6278%), train_poison_data_count: 3821
Global model norm: 2.042282193359187.
Norm before scaling: 3.692944402999788. Distance: 2.4340909936676773
Total norm for 5 adversaries is: 3.692944402999788. distance: 2.4340909936676773
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.5615, Accuracy: 7790/8991 (86.6422%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3503/4319 (81.1067%), train_poison_data_count: 4319
Global model norm: 2.042282193359187.
Norm before scaling: 3.756305352690184. Distance: 2.5470097043976203
Total norm for 5 adversaries is: 3.756305352690184. distance: 2.5470097043976203
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.5568, Accuracy: 7804/8991 (86.7979%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 4, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3627/4396 (82.5068%), train_poison_data_count: 4396
Global model norm: 2.042282193359187.
Norm before scaling: 3.7931707703586226. Distance: 2.5799569759182246
Total norm for 5 adversaries is: 3.7931707703586226. distance: 2.5799569759182246
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.5308, Accuracy: 7826/8991 (87.0426%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2674/3341 (80.0359%), train_poison_data_count: 3341
Global model norm: 2.042282193359187.
Norm before scaling: 3.563151785136426. Distance: 2.3144643533812546
Total norm for 5 adversaries is: 3.563151785136426. distance: 2.3144643533812546
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.5621, Accuracy: 7822/8991 (86.9981%)
___Train Local_Simple,  epoch  37, local model 6, internal_epoch   1,  Average loss: 0.0171, Accuracy: 4100/5024 (81.6083%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5840, Accuracy: 8601/10000 (86.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 7, internal_epoch   1,  Average loss: 0.0191, Accuracy: 2832/3641 (77.7808%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6740, Accuracy: 8268/10000 (82.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 8, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3910/4701 (83.1738%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5986, Accuracy: 8617/10000 (86.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 9, internal_epoch   1,  Average loss: 0.0205, Accuracy: 2605/3315 (78.5822%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6703, Accuracy: 8358/10000 (83.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 10, internal_epoch   1,  Average loss: 0.0194, Accuracy: 2748/3435 (80.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6693, Accuracy: 8522/10000 (85.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 11, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3107/3917 (79.3209%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6511, Accuracy: 8377/10000 (83.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 12, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3258/4069 (80.0688%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6602, Accuracy: 8299/10000 (82.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3101/3851 (80.5245%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6575, Accuracy: 8247/10000 (82.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 14, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2600/3110 (83.6013%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.0551, Accuracy: 7793/10000 (77.9300%), Attack Success Rate:0/10000(0.000)
time spent on training: 321.4880721569061
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 1.5104, Accuracy: 7502/10000 (75.0200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 1.5424, Accuracy: 6196/8991 (68.9134%)
Done in 329.96888542175293 sec.
Server Epoch:38 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  38, local model 0, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3178/3973 (79.9899%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6358, Accuracy: 8521/10000 (85.2100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 1, internal_epoch   1,  Average loss: 0.0186, Accuracy: 2949/3656 (80.6619%), train_poison_data_count: 3656
Global model norm: 2.0490963363006323.
Norm before scaling: 3.641027862132102. Distance: 2.390629687335836
Total norm for 5 adversaries is: 3.641027862132102. distance: 2.390629687335836
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.5511, Accuracy: 7892/8991 (87.7767%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 2, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3132/3821 (81.9681%), train_poison_data_count: 3821
Global model norm: 2.0490963363006323.
Norm before scaling: 3.696591952170546. Distance: 2.422698539258999
Total norm for 5 adversaries is: 3.696591952170546. distance: 2.422698539258999
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.5637, Accuracy: 7687/8991 (85.4966%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3515/4319 (81.3846%), train_poison_data_count: 4319
Global model norm: 2.0490963363006323.
Norm before scaling: 3.7624139668206436. Distance: 2.5428064531842987
Total norm for 5 adversaries is: 3.7624139668206436. distance: 2.5428064531842987
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.5595, Accuracy: 7805/8991 (86.8090%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 4, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3662/4396 (83.3030%), train_poison_data_count: 4396
Global model norm: 2.0490963363006323.
Norm before scaling: 3.788464182383945. Distance: 2.55953240102718
Total norm for 5 adversaries is: 3.788464182383945. distance: 2.55953240102718
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.5323, Accuracy: 7785/8991 (86.5866%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 5, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2717/3341 (81.3230%), train_poison_data_count: 3341
Global model norm: 2.0490963363006323.
Norm before scaling: 3.560073695545136. Distance: 2.2952896148184774
Total norm for 5 adversaries is: 3.560073695545136. distance: 2.2952896148184774
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.5759, Accuracy: 7735/8991 (86.0305%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   1,  Average loss: 0.0171, Accuracy: 4080/5024 (81.2102%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.5830, Accuracy: 8551/10000 (85.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 7, internal_epoch   1,  Average loss: 0.0192, Accuracy: 2841/3641 (78.0280%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6640, Accuracy: 8268/10000 (82.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 8, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3931/4701 (83.6205%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6061, Accuracy: 8583/10000 (85.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 9, internal_epoch   1,  Average loss: 0.0203, Accuracy: 2640/3315 (79.6380%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6712, Accuracy: 8383/10000 (83.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 10, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2732/3435 (79.5342%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6803, Accuracy: 8426/10000 (84.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 11, internal_epoch   1,  Average loss: 0.0196, Accuracy: 3061/3917 (78.1465%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6410, Accuracy: 8431/10000 (84.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 12, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3208/4069 (78.8400%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6416, Accuracy: 8407/10000 (84.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 13, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3093/3851 (80.3168%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6598, Accuracy: 8247/10000 (82.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 14, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2590/3110 (83.2797%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0488, Accuracy: 7839/10000 (78.3900%), Attack Success Rate:0/10000(0.000)
time spent on training: 329.72406482696533
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 1.5013, Accuracy: 7509/10000 (75.0900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 1.5336, Accuracy: 6207/8991 (69.0357%)
Done in 338.2236750125885 sec.
Server Epoch:39 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  39, local model 0, internal_epoch   1,  Average loss: 0.0183, Accuracy: 3175/3973 (79.9144%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6357, Accuracy: 8438/10000 (84.3800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 1, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2966/3656 (81.1269%), train_poison_data_count: 3656
Global model norm: 2.0559149147343616.
Norm before scaling: 3.664930553949283. Distance: 2.408251536827108
Total norm for 5 adversaries is: 3.664930553949283. distance: 2.408251536827108
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.5451, Accuracy: 7921/8991 (88.0992%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 2, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3089/3821 (80.8427%), train_poison_data_count: 3821
Global model norm: 2.0559149147343616.
Norm before scaling: 3.701255873881906. Distance: 2.417279812431601
Total norm for 5 adversaries is: 3.701255873881906. distance: 2.417279812431601
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.5617, Accuracy: 7655/8991 (85.1407%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3506/4319 (81.1762%), train_poison_data_count: 4319
Global model norm: 2.0559149147343616.
Norm before scaling: 3.7563624766642674. Distance: 2.5209929255469876
Total norm for 5 adversaries is: 3.7563624766642674. distance: 2.5209929255469876
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.5492, Accuracy: 7794/8991 (86.6867%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 4, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3646/4396 (82.9390%), train_poison_data_count: 4396
Global model norm: 2.0559149147343616.
Norm before scaling: 3.804303222299998. Distance: 2.5647481965024173
Total norm for 5 adversaries is: 3.804303222299998. distance: 2.5647481965024173
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.5351, Accuracy: 7760/8991 (86.3085%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2712/3341 (81.1733%), train_poison_data_count: 3341
Global model norm: 2.0559149147343616.
Norm before scaling: 3.56611022054879. Distance: 2.290677383052878
Total norm for 5 adversaries is: 3.56611022054879. distance: 2.290677383052878
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.5655, Accuracy: 7799/8991 (86.7423%)
___Train Local_Simple,  epoch  39, local model 6, internal_epoch   1,  Average loss: 0.0170, Accuracy: 4070/5024 (81.0111%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5848, Accuracy: 8614/10000 (86.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 7, internal_epoch   1,  Average loss: 0.0192, Accuracy: 2839/3641 (77.9731%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6803, Accuracy: 8214/10000 (82.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 8, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3940/4701 (83.8120%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6092, Accuracy: 8588/10000 (85.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 9, internal_epoch   1,  Average loss: 0.0203, Accuracy: 2608/3315 (78.6727%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6608, Accuracy: 8500/10000 (85.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 10, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2747/3435 (79.9709%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6643, Accuracy: 8548/10000 (85.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 11, internal_epoch   1,  Average loss: 0.0195, Accuracy: 3069/3917 (78.3508%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6404, Accuracy: 8420/10000 (84.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 12, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3238/4069 (79.5773%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6393, Accuracy: 8422/10000 (84.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0179, Accuracy: 3111/3851 (80.7842%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6676, Accuracy: 8283/10000 (82.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2611/3110 (83.9550%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.0568, Accuracy: 7763/10000 (77.6300%), Attack Success Rate:0/10000(0.000)
time spent on training: 334.60725498199463
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 1.4797, Accuracy: 7539/10000 (75.3900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 1.5131, Accuracy: 6231/8991 (69.3026%)
Done in 343.2121651172638 sec.
Server Epoch:40 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  40, local model 0, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3205/3973 (80.6695%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6362, Accuracy: 8513/10000 (85.1300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 1, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2962/3656 (81.0175%), train_poison_data_count: 3656
Global model norm: 2.0699442985890886.
Norm before scaling: 3.661151306968491. Distance: 2.374239046763821
Total norm for 5 adversaries is: 3.661151306968491. distance: 2.374239046763821
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.5561, Accuracy: 7855/8991 (87.3651%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 2, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3104/3821 (81.2353%), train_poison_data_count: 3821
Global model norm: 2.0699442985890886.
Norm before scaling: 3.693958122986762. Distance: 2.3820173093613675
Total norm for 5 adversaries is: 3.693958122986762. distance: 2.3820173093613675
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.5714, Accuracy: 7626/8991 (84.8182%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3508/4319 (81.2225%), train_poison_data_count: 4319
Global model norm: 2.0699442985890886.
Norm before scaling: 3.7613322375337757. Distance: 2.4997891337157245
Total norm for 5 adversaries is: 3.7613322375337757. distance: 2.4997891337157245
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.5461, Accuracy: 7797/8991 (86.7201%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 4, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3664/4396 (83.3485%), train_poison_data_count: 4396
Global model norm: 2.0699442985890886.
Norm before scaling: 3.808604016412445. Distance: 2.5431769735519647
Total norm for 5 adversaries is: 3.808604016412445. distance: 2.5431769735519647
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.5383, Accuracy: 7703/8991 (85.6746%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 5, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2704/3341 (80.9339%), train_poison_data_count: 3341
Global model norm: 2.0699442985890886.
Norm before scaling: 3.5692706100810403. Distance: 2.2689631632558864
Total norm for 5 adversaries is: 3.5692706100810403. distance: 2.2689631632558864
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.5631, Accuracy: 7836/8991 (87.1538%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0169, Accuracy: 4094/5024 (81.4889%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.5833, Accuracy: 8597/10000 (85.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 7, internal_epoch   1,  Average loss: 0.0191, Accuracy: 2815/3641 (77.3139%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6532, Accuracy: 8434/10000 (84.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3901/4701 (82.9823%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6015, Accuracy: 8537/10000 (85.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 9, internal_epoch   1,  Average loss: 0.0201, Accuracy: 2645/3315 (79.7888%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6588, Accuracy: 8431/10000 (84.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 10, internal_epoch   1,  Average loss: 0.0192, Accuracy: 2769/3435 (80.6114%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6612, Accuracy: 8563/10000 (85.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0194, Accuracy: 3104/3917 (79.2443%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6353, Accuracy: 8429/10000 (84.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0179, Accuracy: 3264/4069 (80.2163%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6704, Accuracy: 8249/10000 (82.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 13, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3125/3851 (81.1478%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.6651, Accuracy: 8212/10000 (82.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 14, internal_epoch   1,  Average loss: 0.0164, Accuracy: 2592/3110 (83.3441%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 1.0444, Accuracy: 7810/10000 (78.1000%), Attack Success Rate:0/10000(0.000)
time spent on training: 345.76615595817566
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.02722689 1.        ]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 1.4707, Accuracy: 7547/10000 (75.4700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 1.5046, Accuracy: 6240/8991 (69.4027%)
Done in 354.2369749546051 sec.
Server Epoch:41 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  41, local model 0, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3198/3973 (80.4933%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6276, Accuracy: 8544/10000 (85.4400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 1, internal_epoch   1,  Average loss: 0.0185, Accuracy: 2936/3656 (80.3063%), train_poison_data_count: 3656
Global model norm: 2.0771495853164437.
Norm before scaling: 3.6728510431899393. Distance: 2.3745665907672575
Total norm for 5 adversaries is: 3.6728510431899393. distance: 2.3745665907672575
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.5463, Accuracy: 7879/8991 (87.6321%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 2, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3142/3821 (82.2298%), train_poison_data_count: 3821
Global model norm: 2.0771495853164437.
Norm before scaling: 3.7049915100494597. Distance: 2.379113299500028
Total norm for 5 adversaries is: 3.7049915100494597. distance: 2.379113299500028
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.5771, Accuracy: 7585/8991 (84.3621%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3512/4319 (81.3151%), train_poison_data_count: 4319
Global model norm: 2.0771495853164437.
Norm before scaling: 3.7666963818033476. Distance: 2.4899012683153225
Total norm for 5 adversaries is: 3.7666963818033476. distance: 2.4899012683153225
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.5439, Accuracy: 7810/8991 (86.8646%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 4, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3668/4396 (83.4395%), train_poison_data_count: 4396
Global model norm: 2.0771495853164437.
Norm before scaling: 3.8009620302025517. Distance: 2.526510629021206
Total norm for 5 adversaries is: 3.8009620302025517. distance: 2.526510629021206
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.5279, Accuracy: 7875/8991 (87.5876%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 5, internal_epoch   1,  Average loss: 0.0186, Accuracy: 2688/3341 (80.4550%), train_poison_data_count: 3341
Global model norm: 2.0771495853164437.
Norm before scaling: 3.573344005834479. Distance: 2.2630151910276206
Total norm for 5 adversaries is: 3.573344005834479. distance: 2.2630151910276206
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.5625, Accuracy: 7835/8991 (87.1427%)
___Train Local_Simple,  epoch  41, local model 6, internal_epoch   1,  Average loss: 0.0168, Accuracy: 4088/5024 (81.3694%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.5787, Accuracy: 8572/10000 (85.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 7, internal_epoch   1,  Average loss: 0.0189, Accuracy: 2860/3641 (78.5498%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6549, Accuracy: 8333/10000 (83.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 8, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3933/4701 (83.6631%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6027, Accuracy: 8574/10000 (85.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 9, internal_epoch   1,  Average loss: 0.0200, Accuracy: 2638/3315 (79.5777%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6637, Accuracy: 8411/10000 (84.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 10, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2763/3435 (80.4367%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6615, Accuracy: 8568/10000 (85.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 11, internal_epoch   1,  Average loss: 0.0192, Accuracy: 3087/3917 (78.8103%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6484, Accuracy: 8339/10000 (83.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 12, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3270/4069 (80.3637%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6334, Accuracy: 8473/10000 (84.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 13, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3127/3851 (81.1997%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.6692, Accuracy: 8219/10000 (82.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 14, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2599/3110 (83.5691%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 1.0479, Accuracy: 7796/10000 (77.9600%), Attack Success Rate:0/10000(0.000)
time spent on training: 350.19562220573425
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.14992193 1.        ]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 1.4608, Accuracy: 7556/10000 (75.5600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 1.4955, Accuracy: 6253/8991 (69.5473%)
Done in 358.77869868278503 sec.
Server Epoch:42 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  42, local model 0, internal_epoch   1,  Average loss: 0.0179, Accuracy: 3182/3973 (80.0906%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6391, Accuracy: 8424/10000 (84.2400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 1, internal_epoch   1,  Average loss: 0.0183, Accuracy: 2970/3656 (81.2363%), train_poison_data_count: 3656
Global model norm: 2.085326030132224.
Norm before scaling: 3.665518335219798. Distance: 2.354379076082019
Total norm for 5 adversaries is: 3.665518335219798. distance: 2.354379076082019
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.5472, Accuracy: 7906/8991 (87.9324%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 2, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3119/3821 (81.6278%), train_poison_data_count: 3821
Global model norm: 2.085326030132224.
Norm before scaling: 3.699396372864034. Distance: 2.360391056991415
Total norm for 5 adversaries is: 3.699396372864034. distance: 2.360391056991415
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.5640, Accuracy: 7707/8991 (85.7191%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3501/4319 (81.0604%), train_poison_data_count: 4319
Global model norm: 2.085326030132224.
Norm before scaling: 3.7754177797054354. Distance: 2.4893695840625814
Total norm for 5 adversaries is: 3.7754177797054354. distance: 2.4893695840625814
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.5651, Accuracy: 7747/8991 (86.1639%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 4, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3678/4396 (83.6670%), train_poison_data_count: 4396
Global model norm: 2.085326030132224.
Norm before scaling: 3.8103111112034087. Distance: 2.521276913122405
Total norm for 5 adversaries is: 3.8103111112034087. distance: 2.521276913122405
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.5273, Accuracy: 7793/8991 (86.6756%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 5, internal_epoch   1,  Average loss: 0.0185, Accuracy: 2729/3341 (81.6821%), train_poison_data_count: 3341
Global model norm: 2.085326030132224.
Norm before scaling: 3.5856202095296297. Distance: 2.2639171608977815
Total norm for 5 adversaries is: 3.5856202095296297. distance: 2.2639171608977815
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.5612, Accuracy: 7880/8991 (87.6432%)
___Train Local_Simple,  epoch  42, local model 6, internal_epoch   1,  Average loss: 0.0169, Accuracy: 4107/5024 (81.7476%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.5862, Accuracy: 8537/10000 (85.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 7, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2878/3641 (79.0442%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6636, Accuracy: 8253/10000 (82.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 8, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3943/4701 (83.8758%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6005, Accuracy: 8574/10000 (85.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 9, internal_epoch   1,  Average loss: 0.0200, Accuracy: 2655/3315 (80.0905%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6598, Accuracy: 8471/10000 (84.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0191, Accuracy: 2742/3435 (79.8253%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6616, Accuracy: 8513/10000 (85.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 11, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3077/3917 (78.5550%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6343, Accuracy: 8500/10000 (85.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 12, internal_epoch   1,  Average loss: 0.0179, Accuracy: 3256/4069 (80.0197%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6513, Accuracy: 8354/10000 (83.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 13, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3155/3851 (81.9268%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6456, Accuracy: 8359/10000 (83.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 14, internal_epoch   1,  Average loss: 0.0164, Accuracy: 2599/3110 (83.5691%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 1.0385, Accuracy: 7805/10000 (78.0500%), Attack Success Rate:0/10000(0.000)
time spent on training: 359.64191031455994
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 1.4415, Accuracy: 7584/10000 (75.8400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 1.4763, Accuracy: 6284/8991 (69.8921%)
Done in 368.3180754184723 sec.
Server Epoch:43 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  43, local model 0, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3197/3973 (80.4682%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6222, Accuracy: 8581/10000 (85.8100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 1, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2952/3656 (80.7440%), train_poison_data_count: 3656
Global model norm: 2.1002842302070093.
Norm before scaling: 3.6703620553274443. Distance: 2.333489605802212
Total norm for 5 adversaries is: 3.6703620553274443. distance: 2.333489605802212
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.5472, Accuracy: 7886/8991 (87.7099%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 2, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3130/3821 (81.9157%), train_poison_data_count: 3821
Global model norm: 2.1002842302070093.
Norm before scaling: 3.7059496958942297. Distance: 2.341661158201135
Total norm for 5 adversaries is: 3.7059496958942297. distance: 2.341661158201135
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.5751, Accuracy: 7641/8991 (84.9850%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3539/4319 (81.9403%), train_poison_data_count: 4319
Global model norm: 2.1002842302070093.
Norm before scaling: 3.774131947938389. Distance: 2.4594980056422693
Total norm for 5 adversaries is: 3.774131947938389. distance: 2.4594980056422693
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.5462, Accuracy: 7834/8991 (87.1316%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 4, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3667/4396 (83.4167%), train_poison_data_count: 4396
Global model norm: 2.1002842302070093.
Norm before scaling: 3.8071812284484174. Distance: 2.491807771172436
Total norm for 5 adversaries is: 3.8071812284484174. distance: 2.491807771172436
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.5239, Accuracy: 7888/8991 (87.7322%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 5, internal_epoch   1,  Average loss: 0.0183, Accuracy: 2719/3341 (81.3828%), train_poison_data_count: 3341
Global model norm: 2.1002842302070093.
Norm before scaling: 3.5838598411606424. Distance: 2.2398734562756384
Total norm for 5 adversaries is: 3.5838598411606424. distance: 2.2398734562756384
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.5642, Accuracy: 7842/8991 (87.2206%)
___Train Local_Simple,  epoch  43, local model 6, internal_epoch   1,  Average loss: 0.0167, Accuracy: 4096/5024 (81.5287%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.5770, Accuracy: 8601/10000 (86.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 7, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2847/3641 (78.1928%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6664, Accuracy: 8267/10000 (82.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 8, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3941/4701 (83.8332%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6049, Accuracy: 8563/10000 (85.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 9, internal_epoch   1,  Average loss: 0.0198, Accuracy: 2664/3315 (80.3620%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6607, Accuracy: 8473/10000 (84.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 10, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2761/3435 (80.3785%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6645, Accuracy: 8532/10000 (85.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 11, internal_epoch   1,  Average loss: 0.0192, Accuracy: 3099/3917 (79.1167%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6390, Accuracy: 8470/10000 (84.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 12, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3278/4069 (80.5603%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6568, Accuracy: 8301/10000 (83.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 13, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3165/3851 (82.1864%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.6622, Accuracy: 8295/10000 (82.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 14, internal_epoch   1,  Average loss: 0.0162, Accuracy: 2616/3110 (84.1158%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 1.0239, Accuracy: 7983/10000 (79.8300%), Attack Success Rate:0/10000(0.000)
time spent on training: 365.1018075942993
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        0.        0.        0.        0.1107377
 1.       ]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 1.4324, Accuracy: 7591/10000 (75.9100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 1.4677, Accuracy: 6291/8991 (69.9700%)
Done in 373.9823544025421 sec.
Server Epoch:44 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  44, local model 0, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3207/3973 (80.7199%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6384, Accuracy: 8500/10000 (85.0000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0183, Accuracy: 2959/3656 (80.9354%), train_poison_data_count: 3656
Global model norm: 2.1083155479233837.
Norm before scaling: 3.6776092556634272. Distance: 2.328766497616526
Total norm for 5 adversaries is: 3.6776092556634272. distance: 2.328766497616526
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.5504, Accuracy: 7861/8991 (87.4319%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 2, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3147/3821 (82.3606%), train_poison_data_count: 3821
Global model norm: 2.1083155479233837.
Norm before scaling: 3.7111692978592403. Distance: 2.3315665390660696
Total norm for 5 adversaries is: 3.7111692978592403. distance: 2.3315665390660696
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.5771, Accuracy: 7595/8991 (84.4734%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3516/4319 (81.4077%), train_poison_data_count: 4319
Global model norm: 2.1083155479233837.
Norm before scaling: 3.760984988956776. Distance: 2.4357326653901357
Total norm for 5 adversaries is: 3.760984988956776. distance: 2.4357326653901357
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.5458, Accuracy: 7863/8991 (87.4541%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 4, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3650/4396 (83.0300%), train_poison_data_count: 4396
Global model norm: 2.1083155479233837.
Norm before scaling: 3.813104925473263. Distance: 2.484026806500896
Total norm for 5 adversaries is: 3.813104925473263. distance: 2.484026806500896
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.5338, Accuracy: 7757/8991 (86.2752%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 5, internal_epoch   1,  Average loss: 0.0183, Accuracy: 2730/3341 (81.7121%), train_poison_data_count: 3341
Global model norm: 2.1083155479233837.
Norm before scaling: 3.585913963489956. Distance: 2.2282007447966956
Total norm for 5 adversaries is: 3.585913963489956. distance: 2.2282007447966956
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.5687, Accuracy: 7844/8991 (87.2428%)
___Train Local_Simple,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0167, Accuracy: 4120/5024 (82.0064%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.5858, Accuracy: 8570/10000 (85.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 7, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2876/3641 (78.9893%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6591, Accuracy: 8332/10000 (83.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 8, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3946/4701 (83.9396%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.5971, Accuracy: 8591/10000 (85.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0199, Accuracy: 2646/3315 (79.8190%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6684, Accuracy: 8386/10000 (83.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 10, internal_epoch   1,  Average loss: 0.0189, Accuracy: 2738/3435 (79.7089%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6670, Accuracy: 8494/10000 (84.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 11, internal_epoch   1,  Average loss: 0.0189, Accuracy: 3082/3917 (78.6827%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6333, Accuracy: 8519/10000 (85.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 12, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3242/4069 (79.6756%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6595, Accuracy: 8301/10000 (83.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 13, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3142/3851 (81.5892%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.6591, Accuracy: 8299/10000 (82.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 14, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2592/3110 (83.3441%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 1.0342, Accuracy: 7910/10000 (79.1000%), Attack Success Rate:0/10000(0.000)
time spent on training: 372.7561242580414
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.30015605 0.         0.         0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 1.4207, Accuracy: 7627/10000 (76.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 1.4568, Accuracy: 6296/8991 (70.0256%)
Done in 381.30900979042053 sec.
Server Epoch:45 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  45, local model 0, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3231/3973 (81.3239%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.6251, Accuracy: 8528/10000 (85.2800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2949/3656 (80.6619%), train_poison_data_count: 3656
Global model norm: 2.1180907852772775.
Norm before scaling: 3.672825726735442. Distance: 2.304889631297642
Total norm for 5 adversaries is: 3.672825726735442. distance: 2.304889631297642
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.5450, Accuracy: 7881/8991 (87.6543%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 2, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3150/3821 (82.4392%), train_poison_data_count: 3821
Global model norm: 2.1180907852772775.
Norm before scaling: 3.709057269351815. Distance: 2.3178224914096788
Total norm for 5 adversaries is: 3.709057269351815. distance: 2.3178224914096788
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.5625, Accuracy: 7789/8991 (86.6311%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3514/4319 (81.3614%), train_poison_data_count: 4319
Global model norm: 2.1180907852772775.
Norm before scaling: 3.7775111353651383. Distance: 2.4353451129027297
Total norm for 5 adversaries is: 3.7775111353651383. distance: 2.4353451129027297
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.5553, Accuracy: 7743/8991 (86.1195%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 4, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3666/4396 (83.3940%), train_poison_data_count: 4396
Global model norm: 2.1180907852772775.
Norm before scaling: 3.813665993414496. Distance: 2.4699823707847197
Total norm for 5 adversaries is: 3.813665993414496. distance: 2.4699823707847197
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.5201, Accuracy: 7893/8991 (87.7878%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2734/3341 (81.8318%), train_poison_data_count: 3341
Global model norm: 2.1180907852772775.
Norm before scaling: 3.5919937486403004. Distance: 2.2184485647116636
Total norm for 5 adversaries is: 3.5919937486403004. distance: 2.2184485647116636
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.5651, Accuracy: 7829/8991 (87.0760%)
___Train Local_Simple,  epoch  45, local model 6, internal_epoch   1,  Average loss: 0.0166, Accuracy: 4091/5024 (81.4291%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5795, Accuracy: 8636/10000 (86.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 7, internal_epoch   1,  Average loss: 0.0186, Accuracy: 2884/3641 (79.2090%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.6600, Accuracy: 8399/10000 (83.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 8, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3924/4701 (83.4716%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5905, Accuracy: 8642/10000 (86.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 9, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2655/3315 (80.0905%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.6567, Accuracy: 8519/10000 (85.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 10, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2760/3435 (80.3493%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.6662, Accuracy: 8534/10000 (85.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 11, internal_epoch   1,  Average loss: 0.0190, Accuracy: 3110/3917 (79.3975%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.6254, Accuracy: 8566/10000 (85.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 12, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3244/4069 (79.7247%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.6263, Accuracy: 8485/10000 (84.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 13, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3159/3851 (82.0306%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.6547, Accuracy: 8264/10000 (82.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 14, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2607/3110 (83.8264%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 1.0558, Accuracy: 7714/10000 (77.1400%), Attack Success Rate:0/10000(0.000)
time spent on training: 382.1381001472473
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 1.4131, Accuracy: 7636/10000 (76.3600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 1.4495, Accuracy: 6305/8991 (70.1257%)
Done in 390.64458322525024 sec.
Server Epoch:46 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  46, local model 0, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3228/3973 (81.2484%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6234, Accuracy: 8612/10000 (86.1200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 1, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2966/3656 (81.1269%), train_poison_data_count: 3656
Global model norm: 2.12532949698009.
Norm before scaling: 3.676180129750787. Distance: 2.3001489466661424
Total norm for 5 adversaries is: 3.676180129750787. distance: 2.3001489466661424
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.5433, Accuracy: 7873/8991 (87.5653%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3122/3821 (81.7064%), train_poison_data_count: 3821
Global model norm: 2.12532949698009.
Norm before scaling: 3.7076965956932524. Distance: 2.303318147052584
Total norm for 5 adversaries is: 3.7076965956932524. distance: 2.303318147052584
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.5528, Accuracy: 7826/8991 (87.0426%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3519/4319 (81.4772%), train_poison_data_count: 4319
Global model norm: 2.12532949698009.
Norm before scaling: 3.778288130476475. Distance: 2.4309068177730624
Total norm for 5 adversaries is: 3.778288130476475. distance: 2.4309068177730624
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.5682, Accuracy: 7786/8991 (86.5977%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 4, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3651/4396 (83.0528%), train_poison_data_count: 4396
Global model norm: 2.12532949698009.
Norm before scaling: 3.8009583921014354. Distance: 2.442235894190468
Total norm for 5 adversaries is: 3.8009583921014354. distance: 2.442235894190468
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.5307, Accuracy: 7809/8991 (86.8535%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 5, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2694/3341 (80.6345%), train_poison_data_count: 3341
Global model norm: 2.12532949698009.
Norm before scaling: 3.5845729251083625. Distance: 2.1964389721029374
Total norm for 5 adversaries is: 3.5845729251083625. distance: 2.1964389721029374
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.5600, Accuracy: 7914/8991 (88.0214%)
___Train Local_Simple,  epoch  46, local model 6, internal_epoch   1,  Average loss: 0.0166, Accuracy: 4108/5024 (81.7675%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.5834, Accuracy: 8566/10000 (85.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0185, Accuracy: 2888/3641 (79.3189%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6532, Accuracy: 8409/10000 (84.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 8, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3955/4701 (84.1310%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.5938, Accuracy: 8600/10000 (86.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 9, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2655/3315 (80.0905%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6625, Accuracy: 8445/10000 (84.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2806/3435 (81.6885%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6563, Accuracy: 8566/10000 (85.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 11, internal_epoch   1,  Average loss: 0.0189, Accuracy: 3122/3917 (79.7039%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6208, Accuracy: 8581/10000 (85.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 12, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3265/4069 (80.2408%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6465, Accuracy: 8366/10000 (83.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 13, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3170/3851 (82.3163%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.6429, Accuracy: 8400/10000 (84.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2618/3110 (84.1801%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 1.0253, Accuracy: 7882/10000 (78.8200%), Attack Success Rate:0/10000(0.000)
time spent on training: 385.9415855407715
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 1.3953, Accuracy: 7665/10000 (76.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 1.4330, Accuracy: 6322/8991 (70.3148%)
Done in 394.42461609840393 sec.
Server Epoch:47 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  47, local model 0, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3237/3973 (81.4750%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6363, Accuracy: 8460/10000 (84.6000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 1, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2952/3656 (80.7440%), train_poison_data_count: 3656
Global model norm: 2.140527319245717.
Norm before scaling: 3.6772356875288454. Distance: 2.273061085374843
Total norm for 5 adversaries is: 3.6772356875288454. distance: 2.273061085374843
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.5512, Accuracy: 7849/8991 (87.2984%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 2, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3138/3821 (82.1251%), train_poison_data_count: 3821
Global model norm: 2.140527319245717.
Norm before scaling: 3.7150469382441096. Distance: 2.283056928328394
Total norm for 5 adversaries is: 3.7150469382441096. distance: 2.283056928328394
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.5575, Accuracy: 7760/8991 (86.3085%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3510/4319 (81.2688%), train_poison_data_count: 4319
Global model norm: 2.140527319245717.
Norm before scaling: 3.784699309082355. Distance: 2.411485005856698
Total norm for 5 adversaries is: 3.784699309082355. distance: 2.411485005856698
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.5509, Accuracy: 7825/8991 (87.0315%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 4, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3684/4396 (83.8035%), train_poison_data_count: 4396
Global model norm: 2.140527319245717.
Norm before scaling: 3.811964403896913. Distance: 2.4301872107520808
Total norm for 5 adversaries is: 3.811964403896913. distance: 2.4301872107520808
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.5246, Accuracy: 7846/8991 (87.2650%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 5, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2722/3341 (81.4726%), train_poison_data_count: 3341
Global model norm: 2.140527319245717.
Norm before scaling: 3.5937178900569573. Distance: 2.1845187989847275
Total norm for 5 adversaries is: 3.5937178900569573. distance: 2.1845187989847275
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.5617, Accuracy: 7820/8991 (86.9759%)
___Train Local_Simple,  epoch  47, local model 6, internal_epoch   1,  Average loss: 0.0165, Accuracy: 4114/5024 (81.8869%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5909, Accuracy: 8536/10000 (85.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0185, Accuracy: 2876/3641 (78.9893%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6739, Accuracy: 8191/10000 (81.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 8, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3937/4701 (83.7481%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.5957, Accuracy: 8596/10000 (85.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 9, internal_epoch   1,  Average loss: 0.0195, Accuracy: 2660/3315 (80.2413%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6658, Accuracy: 8386/10000 (83.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 10, internal_epoch   1,  Average loss: 0.0186, Accuracy: 2775/3435 (80.7860%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6499, Accuracy: 8566/10000 (85.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 11, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3120/3917 (79.6528%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6264, Accuracy: 8562/10000 (85.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 12, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3276/4069 (80.5112%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6373, Accuracy: 8434/10000 (84.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 13, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3134/3851 (81.3815%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6467, Accuracy: 8352/10000 (83.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 14, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2599/3110 (83.5691%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 1.0376, Accuracy: 7836/10000 (78.3600%), Attack Success Rate:0/10000(0.000)
time spent on training: 395.30191254615784
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 1.3880, Accuracy: 7675/10000 (76.7500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 1.4263, Accuracy: 6326/8991 (70.3592%)
Done in 404.03700613975525 sec.
Server Epoch:48 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  48, local model 0, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3244/3973 (81.6511%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6219, Accuracy: 8547/10000 (85.4700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 1, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2977/3656 (81.4278%), train_poison_data_count: 3656
Global model norm: 2.1478407152316.
Norm before scaling: 3.6839678383250685. Distance: 2.2731052431176746
Total norm for 5 adversaries is: 3.6839678383250685. distance: 2.2731052431176746
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.5454, Accuracy: 7851/8991 (87.3207%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 2, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3156/3821 (82.5962%), train_poison_data_count: 3821
Global model norm: 2.1478407152316.
Norm before scaling: 3.7219967813370287. Distance: 2.2791178942755637
Total norm for 5 adversaries is: 3.7219967813370287. distance: 2.2791178942755637
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.5808, Accuracy: 7582/8991 (84.3288%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3520/4319 (81.5003%), train_poison_data_count: 4319
Global model norm: 2.1478407152316.
Norm before scaling: 3.7904052871969953. Distance: 2.40848417722681
Total norm for 5 adversaries is: 3.7904052871969953. distance: 2.40848417722681
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.5646, Accuracy: 7767/8991 (86.3864%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 4, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3675/4396 (83.5987%), train_poison_data_count: 4396
Global model norm: 2.1478407152316.
Norm before scaling: 3.8187835691883905. Distance: 2.4290122906251037
Total norm for 5 adversaries is: 3.8187835691883905. distance: 2.4290122906251037
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.5367, Accuracy: 7802/8991 (86.7757%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 5, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2715/3341 (81.2631%), train_poison_data_count: 3341
Global model norm: 2.1478407152316.
Norm before scaling: 3.6018997001429867. Distance: 2.1811832231940786
Total norm for 5 adversaries is: 3.6018997001429867. distance: 2.1811832231940786
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.5579, Accuracy: 7858/8991 (87.3985%)
___Train Local_Simple,  epoch  48, local model 6, internal_epoch   1,  Average loss: 0.0165, Accuracy: 4133/5024 (82.2651%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.5796, Accuracy: 8617/10000 (86.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 7, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2879/3641 (79.0717%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6472, Accuracy: 8445/10000 (84.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 8, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3951/4701 (84.0459%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6062, Accuracy: 8565/10000 (85.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 9, internal_epoch   1,  Average loss: 0.0195, Accuracy: 2673/3315 (80.6335%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6556, Accuracy: 8476/10000 (84.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 10, internal_epoch   1,  Average loss: 0.0186, Accuracy: 2793/3435 (81.3100%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6553, Accuracy: 8549/10000 (85.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 11, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3102/3917 (79.1933%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6320, Accuracy: 8475/10000 (84.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 12, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3276/4069 (80.5112%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6316, Accuracy: 8418/10000 (84.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 13, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3155/3851 (81.9268%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.6806, Accuracy: 8093/10000 (80.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 14, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2646/3110 (85.0804%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 1.0276, Accuracy: 7835/10000 (78.3500%), Attack Success Rate:0/10000(0.000)
time spent on training: 399.7249732017517
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.34098774 1.        ]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 1.3777, Accuracy: 7684/10000 (76.8400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 1.4169, Accuracy: 6322/8991 (70.3148%)
Done in 408.277747631073 sec.
Server Epoch:49 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  49, local model 0, internal_epoch   1,  Average loss: 0.0174, Accuracy: 3231/3973 (81.3239%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6300, Accuracy: 8484/10000 (84.8400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 1, internal_epoch   1,  Average loss: 0.0179, Accuracy: 2962/3656 (81.0175%), train_poison_data_count: 3656
Global model norm: 2.15795145768235.
Norm before scaling: 3.6891483566717915. Distance: 2.262259990122474
Total norm for 5 adversaries is: 3.6891483566717915. distance: 2.262259990122474
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.5427, Accuracy: 7901/8991 (87.8768%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 2, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3135/3821 (82.0466%), train_poison_data_count: 3821
Global model norm: 2.15795145768235.
Norm before scaling: 3.7211002648533014. Distance: 2.260262925036689
Total norm for 5 adversaries is: 3.7211002648533014. distance: 2.260262925036689
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.5674, Accuracy: 7631/8991 (84.8738%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3541/4319 (81.9866%), train_poison_data_count: 4319
Global model norm: 2.15795145768235.
Norm before scaling: 3.7729251742815597. Distance: 2.36898805735562
Total norm for 5 adversaries is: 3.7729251742815597. distance: 2.36898805735562
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.5462, Accuracy: 7839/8991 (87.1872%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 4, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3649/4396 (83.0073%), train_poison_data_count: 4396
Global model norm: 2.15795145768235.
Norm before scaling: 3.8173132358474557. Distance: 2.40837469054442
Total norm for 5 adversaries is: 3.8173132358474557. distance: 2.40837469054442
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.5278, Accuracy: 7842/8991 (87.2206%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 5, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2724/3341 (81.5325%), train_poison_data_count: 3341
Global model norm: 2.15795145768235.
Norm before scaling: 3.592736142652652. Distance: 2.1513678524312407
Total norm for 5 adversaries is: 3.592736142652652. distance: 2.1513678524312407
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.5594, Accuracy: 7818/8991 (86.9536%)
___Train Local_Simple,  epoch  49, local model 6, internal_epoch   1,  Average loss: 0.0164, Accuracy: 4137/5024 (82.3447%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5946, Accuracy: 8509/10000 (85.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 7, internal_epoch   1,  Average loss: 0.0183, Accuracy: 2892/3641 (79.4287%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6651, Accuracy: 8347/10000 (83.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 8, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3936/4701 (83.7269%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.5998, Accuracy: 8556/10000 (85.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 9, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2670/3315 (80.5430%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6500, Accuracy: 8571/10000 (85.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0185, Accuracy: 2757/3435 (80.2620%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6716, Accuracy: 8464/10000 (84.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 11, internal_epoch   1,  Average loss: 0.0187, Accuracy: 3106/3917 (79.2954%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6299, Accuracy: 8461/10000 (84.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 12, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3284/4069 (80.7078%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6281, Accuracy: 8503/10000 (85.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3186/3851 (82.7318%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.6892, Accuracy: 8062/10000 (80.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 14, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2629/3110 (84.5338%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 1.0244, Accuracy: 7866/10000 (78.6600%), Attack Success Rate:0/10000(0.000)
time spent on training: 409.28940653800964
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.97405378 1.        ]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 1.3618, Accuracy: 7653/10000 (76.5300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 1.4008, Accuracy: 6356/8991 (70.6929%)
Done in 417.26756596565247 sec.
Server Epoch:50 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3216/3973 (80.9464%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6306, Accuracy: 8461/10000 (84.6100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 1, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2963/3656 (81.0449%), train_poison_data_count: 3656
Global model norm: 2.1734322652746876.
Norm before scaling: 3.693504100689355. Distance: 2.2414529374725984
Total norm for 5 adversaries is: 3.693504100689355. distance: 2.2414529374725984
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.5449, Accuracy: 7853/8991 (87.3429%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 2, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3149/3821 (82.4130%), train_poison_data_count: 3821
Global model norm: 2.1734322652746876.
Norm before scaling: 3.7247311232641738. Distance: 2.2408947557472327
Total norm for 5 adversaries is: 3.7247311232641738. distance: 2.2408947557472327
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.5633, Accuracy: 7705/8991 (85.6968%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3560/4319 (82.4265%), train_poison_data_count: 4319
Global model norm: 2.1734322652746876.
Norm before scaling: 3.7925036977147664. Distance: 2.3661768804941774
Total norm for 5 adversaries is: 3.7925036977147664. distance: 2.3661768804941774
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.5458, Accuracy: 7849/8991 (87.2984%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 4, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3695/4396 (84.0537%), train_poison_data_count: 4396
Global model norm: 2.1734322652746876.
Norm before scaling: 3.8187755777404586. Distance: 2.3819711669470807
Total norm for 5 adversaries is: 3.8187755777404586. distance: 2.3819711669470807
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.5215, Accuracy: 7839/8991 (87.1872%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 5, internal_epoch   1,  Average loss: 0.0179, Accuracy: 2728/3341 (81.6522%), train_poison_data_count: 3341
Global model norm: 2.1734322652746876.
Norm before scaling: 3.606708020192364. Distance: 2.146714174779554
Total norm for 5 adversaries is: 3.606708020192364. distance: 2.146714174779554
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.5592, Accuracy: 7884/8991 (87.6877%)
___Train Local_Simple,  epoch  50, local model 6, internal_epoch   1,  Average loss: 0.0163, Accuracy: 4149/5024 (82.5836%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.5908, Accuracy: 8515/10000 (85.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2912/3641 (79.9780%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6551, Accuracy: 8348/10000 (83.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 8, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3972/4701 (84.4927%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6018, Accuracy: 8590/10000 (85.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 9, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2647/3315 (79.8492%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6498, Accuracy: 8570/10000 (85.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 10, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2786/3435 (81.1063%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6529, Accuracy: 8550/10000 (85.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 11, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3122/3917 (79.7039%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6333, Accuracy: 8439/10000 (84.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 12, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3296/4069 (81.0027%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6319, Accuracy: 8446/10000 (84.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 13, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3172/3851 (82.3682%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6598, Accuracy: 8255/10000 (82.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 14, internal_epoch   1,  Average loss: 0.0155, Accuracy: 2637/3110 (84.7910%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 1.0189, Accuracy: 7957/10000 (79.5700%), Attack Success Rate:0/10000(0.000)
time spent on training: 375.83731389045715
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.17002863 1.        ]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 1.3534, Accuracy: 7663/10000 (76.6300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 1.3933, Accuracy: 6354/8991 (70.6707%)
Done in 383.6150302886963 sec.
Server Epoch:51 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  51, local model 0, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3222/3973 (81.0974%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.6208, Accuracy: 8587/10000 (85.8700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 1, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2968/3656 (81.1816%), train_poison_data_count: 3656
Global model norm: 2.1822765656330394.
Norm before scaling: 3.6909193575639834. Distance: 2.2240818057897993
Total norm for 5 adversaries is: 3.6909193575639834. distance: 2.2240818057897993
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.5424, Accuracy: 7910/8991 (87.9769%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 2, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3133/3821 (81.9942%), train_poison_data_count: 3821
Global model norm: 2.1822765656330394.
Norm before scaling: 3.7300498527488477. Distance: 2.232934554162985
Total norm for 5 adversaries is: 3.7300498527488477. distance: 2.232934554162985
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.5542, Accuracy: 7706/8991 (85.7079%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3519/4319 (81.4772%), train_poison_data_count: 4319
Global model norm: 2.1822765656330394.
Norm before scaling: 3.789957283000722. Distance: 2.3526757732239254
Total norm for 5 adversaries is: 3.789957283000722. distance: 2.3526757732239254
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.5362, Accuracy: 7877/8991 (87.6098%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3647/4396 (82.9618%), train_poison_data_count: 4396
Global model norm: 2.1822765656330394.
Norm before scaling: 3.8235877727352547. Distance: 2.3804013920347398
Total norm for 5 adversaries is: 3.8235877727352547. distance: 2.3804013920347398
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.5295, Accuracy: 7762/8991 (86.3308%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2708/3341 (81.0536%), train_poison_data_count: 3341
Global model norm: 2.1822765656330394.
Norm before scaling: 3.614931395791192. Distance: 2.1467270579442124
Total norm for 5 adversaries is: 3.614931395791192. distance: 2.1467270579442124
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.5609, Accuracy: 7860/8991 (87.4208%)
___Train Local_Simple,  epoch  51, local model 6, internal_epoch   1,  Average loss: 0.0162, Accuracy: 4136/5024 (82.3248%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.5697, Accuracy: 8665/10000 (86.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 7, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2906/3641 (79.8132%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.6439, Accuracy: 8489/10000 (84.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 8, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3966/4701 (84.3650%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.5926, Accuracy: 8598/10000 (85.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 9, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2645/3315 (79.7888%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.6535, Accuracy: 8461/10000 (84.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 10, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2797/3435 (81.4265%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.6662, Accuracy: 8466/10000 (84.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 11, internal_epoch   1,  Average loss: 0.0185, Accuracy: 3099/3917 (79.1167%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.6222, Accuracy: 8585/10000 (85.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 12, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3265/4069 (80.2408%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.6379, Accuracy: 8391/10000 (83.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 13, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3186/3851 (82.7318%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.6540, Accuracy: 8288/10000 (82.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 14, internal_epoch   1,  Average loss: 0.0155, Accuracy: 2625/3110 (84.4051%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.0443, Accuracy: 7738/10000 (77.3800%), Attack Success Rate:0/10000(0.000)
time spent on training: 426.97256422042847
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.43594088 1.        ]
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 1.3430, Accuracy: 7664/10000 (76.6400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 1.3833, Accuracy: 6364/8991 (70.7819%)
Done in 435.7179594039917 sec.
Server Epoch:52 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  52, local model 0, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3238/3973 (81.5001%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6468, Accuracy: 8343/10000 (83.4300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 1, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2939/3656 (80.3884%), train_poison_data_count: 3656
Global model norm: 2.1934147026984925.
Norm before scaling: 3.6872590842994115. Distance: 2.209108384595223
Total norm for 5 adversaries is: 3.6872590842994115. distance: 2.209108384595223
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.5423, Accuracy: 7896/8991 (87.8212%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 2, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3146/3821 (82.3345%), train_poison_data_count: 3821
Global model norm: 2.1934147026984925.
Norm before scaling: 3.7194404281684426. Distance: 2.205245384177746
Total norm for 5 adversaries is: 3.7194404281684426. distance: 2.205245384177746
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.5571, Accuracy: 7704/8991 (85.6857%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3526/4319 (81.6393%), train_poison_data_count: 4319
Global model norm: 2.1934147026984925.
Norm before scaling: 3.8090280451504523. Distance: 2.3634705018489974
Total norm for 5 adversaries is: 3.8090280451504523. distance: 2.3634705018489974
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.5540, Accuracy: 7806/8991 (86.8202%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 4, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3677/4396 (83.6442%), train_poison_data_count: 4396
Global model norm: 2.1934147026984925.
Norm before scaling: 3.8325996249613534. Distance: 2.375358052619291
Total norm for 5 adversaries is: 3.8325996249613534. distance: 2.375358052619291
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.5228, Accuracy: 7814/8991 (86.9091%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 5, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2707/3341 (81.0236%), train_poison_data_count: 3341
Global model norm: 2.1934147026984925.
Norm before scaling: 3.6012829984499017. Distance: 2.1170864855327336
Total norm for 5 adversaries is: 3.6012829984499017. distance: 2.1170864855327336
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.5614, Accuracy: 7898/8991 (87.8434%)
___Train Local_Simple,  epoch  52, local model 6, internal_epoch   1,  Average loss: 0.0162, Accuracy: 4131/5024 (82.2253%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.5773, Accuracy: 8568/10000 (85.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 7, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2922/3641 (80.2527%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6528, Accuracy: 8362/10000 (83.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 8, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3956/4701 (84.1523%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.5904, Accuracy: 8637/10000 (86.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 9, internal_epoch   1,  Average loss: 0.0192, Accuracy: 2666/3315 (80.4223%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6545, Accuracy: 8462/10000 (84.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 10, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2770/3435 (80.6405%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6659, Accuracy: 8543/10000 (85.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 11, internal_epoch   1,  Average loss: 0.0186, Accuracy: 3120/3917 (79.6528%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6221, Accuracy: 8493/10000 (84.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 12, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3285/4069 (80.7324%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6138, Accuracy: 8548/10000 (85.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 13, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3159/3851 (82.0306%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.6467, Accuracy: 8326/10000 (83.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 14, internal_epoch   1,  Average loss: 0.0154, Accuracy: 2653/3110 (85.3055%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 1.0197, Accuracy: 7821/10000 (78.2100%), Attack Success Rate:0/10000(0.000)
time spent on training: 439.88416624069214
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.        0.        0.        0.        0.        0.        0.
 0.        0.6081779 0.        0.        0.        0.        1.
 1.       ]
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 1.3216, Accuracy: 7690/10000 (76.9000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 1.3636, Accuracy: 6368/8991 (70.8264%)
Done in 448.6983952522278 sec.
Server Epoch:53 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  53, local model 0, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3252/3973 (81.8525%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6266, Accuracy: 8475/10000 (84.7500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 1, internal_epoch   1,  Average loss: 0.0174, Accuracy: 2977/3656 (81.4278%), train_poison_data_count: 3656
Global model norm: 2.2149182396259097.
Norm before scaling: 3.7043384221824454. Distance: 2.191996177106155
Total norm for 5 adversaries is: 3.7043384221824454. distance: 2.191996177106155
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.5398, Accuracy: 7899/8991 (87.8545%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 2, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3135/3821 (82.0466%), train_poison_data_count: 3821
Global model norm: 2.2149182396259097.
Norm before scaling: 3.732255917008037. Distance: 2.185548511330654
Total norm for 5 adversaries is: 3.732255917008037. distance: 2.185548511330654
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.5601, Accuracy: 7717/8991 (85.8303%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3567/4319 (82.5886%), train_poison_data_count: 4319
Global model norm: 2.2149182396259097.
Norm before scaling: 3.8000057170222594. Distance: 2.3172931999437654
Total norm for 5 adversaries is: 3.8000057170222594. distance: 2.3172931999437654
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.5475, Accuracy: 7823/8991 (87.0092%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 4, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3676/4396 (83.6215%), train_poison_data_count: 4396
Global model norm: 2.2149182396259097.
Norm before scaling: 3.837353229511773. Distance: 2.3450366748146148
Total norm for 5 adversaries is: 3.837353229511773. distance: 2.3450366748146148
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.5254, Accuracy: 7844/8991 (87.2428%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 5, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2723/3341 (81.5025%), train_poison_data_count: 3341
Global model norm: 2.2149182396259097.
Norm before scaling: 3.607660588254381. Distance: 2.0773848742961882
Total norm for 5 adversaries is: 3.607660588254381. distance: 2.0773848742961882
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.5653, Accuracy: 7775/8991 (86.4754%)
___Train Local_Simple,  epoch  53, local model 6, internal_epoch   1,  Average loss: 0.0161, Accuracy: 4130/5024 (82.2054%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.5786, Accuracy: 8572/10000 (85.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 7, internal_epoch   1,  Average loss: 0.0179, Accuracy: 2888/3641 (79.3189%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6585, Accuracy: 8247/10000 (82.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 8, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3989/4701 (84.8543%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.5975, Accuracy: 8569/10000 (85.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 9, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2670/3315 (80.5430%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6431, Accuracy: 8511/10000 (85.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 10, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2771/3435 (80.6696%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6576, Accuracy: 8479/10000 (84.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 11, internal_epoch   1,  Average loss: 0.0184, Accuracy: 3143/3917 (80.2400%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6272, Accuracy: 8536/10000 (85.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 12, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3295/4069 (80.9781%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6257, Accuracy: 8461/10000 (84.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 13, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3165/3851 (82.1864%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6371, Accuracy: 8369/10000 (83.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 14, internal_epoch   1,  Average loss: 0.0154, Accuracy: 2632/3110 (84.6302%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 1.0099, Accuracy: 7926/10000 (79.2600%), Attack Success Rate:0/10000(0.000)
time spent on training: 442.1952655315399
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 1.3155, Accuracy: 7704/10000 (77.0400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 1.3584, Accuracy: 6364/8991 (70.7819%)
Done in 450.87173891067505 sec.
Server Epoch:54 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  54, local model 0, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3227/3973 (81.2233%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6331, Accuracy: 8398/10000 (83.9800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 1, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3015/3656 (82.4672%), train_poison_data_count: 3656
Global model norm: 2.2224174599183435.
Norm before scaling: 3.6984406149318843. Distance: 2.172107052927512
Total norm for 5 adversaries is: 3.6984406149318843. distance: 2.172107052927512
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.5380, Accuracy: 7856/8991 (87.3763%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 2, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3151/3821 (82.4653%), train_poison_data_count: 3821
Global model norm: 2.2224174599183435.
Norm before scaling: 3.7413525376573586. Distance: 2.1829892108142106
Total norm for 5 adversaries is: 3.7413525376573586. distance: 2.1829892108142106
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.5617, Accuracy: 7660/8991 (85.1963%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3570/4319 (82.6580%), train_poison_data_count: 4319
Global model norm: 2.2224174599183435.
Norm before scaling: 3.80693185395878. Distance: 2.3076946747596536
Total norm for 5 adversaries is: 3.80693185395878. distance: 2.3076946747596536
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.5440, Accuracy: 7803/8991 (86.7868%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 4, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3692/4396 (83.9854%), train_poison_data_count: 4396
Global model norm: 2.2224174599183435.
Norm before scaling: 3.8417883108302484. Distance: 2.3358478847907342
Total norm for 5 adversaries is: 3.8417883108302484. distance: 2.3358478847907342
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.5171, Accuracy: 7806/8991 (86.8202%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 5, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2736/3341 (81.8916%), train_poison_data_count: 3341
Global model norm: 2.2224174599183435.
Norm before scaling: 3.6229872541843053. Distance: 2.1012165678270502
Total norm for 5 adversaries is: 3.6229872541843053. distance: 2.1012165678270502
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.5652, Accuracy: 7856/8991 (87.3763%)
___Train Local_Simple,  epoch  54, local model 6, internal_epoch   1,  Average loss: 0.0160, Accuracy: 4127/5024 (82.1457%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.5741, Accuracy: 8650/10000 (86.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 7, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2921/3641 (80.2252%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6586, Accuracy: 8326/10000 (83.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 8, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3952/4701 (84.0672%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.5937, Accuracy: 8609/10000 (86.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 9, internal_epoch   1,  Average loss: 0.0189, Accuracy: 2684/3315 (80.9653%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6447, Accuracy: 8540/10000 (85.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 10, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2802/3435 (81.5721%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6505, Accuracy: 8564/10000 (85.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 11, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3138/3917 (80.1123%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6312, Accuracy: 8440/10000 (84.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 12, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3305/4069 (81.2239%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6167, Accuracy: 8542/10000 (85.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 13, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3164/3851 (82.1605%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.6581, Accuracy: 8184/10000 (81.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 14, internal_epoch   1,  Average loss: 0.0152, Accuracy: 2635/3110 (84.7267%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 1.0038, Accuracy: 7992/10000 (79.9200%), Attack Success Rate:0/10000(0.000)
time spent on training: 452.7662172317505
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.86343055 0.         0.         0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 54: Average loss: 1.3012, Accuracy: 7732/10000 (77.3200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 54: Average loss: 1.3456, Accuracy: 6368/8991 (70.8264%)
Done in 461.33381271362305 sec.
Server Epoch:55 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  55, local model 0, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3249/3973 (81.7770%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6137, Accuracy: 8637/10000 (86.3700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  55, local model 1, internal_epoch   1,  Average loss: 0.0174, Accuracy: 2967/3656 (81.1543%), train_poison_data_count: 3656
Global model norm: 2.237997359934759.
Norm before scaling: 3.710513956092791. Distance: 2.164791493936365
Total norm for 5 adversaries is: 3.710513956092791. distance: 2.164791493936365
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.5393, Accuracy: 7887/8991 (87.7211%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  55, local model 2, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3161/3821 (82.7270%), train_poison_data_count: 3821
Global model norm: 2.237997359934759.
Norm before scaling: 3.7456312799043046. Distance: 2.1665874857983844
Total norm for 5 adversaries is: 3.7456312799043046. distance: 2.1665874857983844
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.5620, Accuracy: 7735/8991 (86.0305%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  55, local model 3, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3564/4319 (82.5191%), train_poison_data_count: 4319
Global model norm: 2.237997359934759.
Norm before scaling: 3.8123989404510574. Distance: 2.2975122514964674
Total norm for 5 adversaries is: 3.8123989404510574. distance: 2.2975122514964674
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.5520, Accuracy: 7818/8991 (86.9536%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  55, local model 4, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3701/4396 (84.1902%), train_poison_data_count: 4396
Global model norm: 2.237997359934759.
Norm before scaling: 3.8439264024403395. Distance: 2.3148038574241983
Total norm for 5 adversaries is: 3.8439264024403395. distance: 2.3148038574241983
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.5359, Accuracy: 7755/8991 (86.2529%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  55, local model 5, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2729/3341 (81.6821%), train_poison_data_count: 3341
Global model norm: 2.237997359934759.
Norm before scaling: 3.6258954224778868. Distance: 2.0752795249457208
Total norm for 5 adversaries is: 3.6258954224778868. distance: 2.0752795249457208
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.5577, Accuracy: 7871/8991 (87.5431%)
___Train Local_Simple,  epoch  55, local model 6, internal_epoch   1,  Average loss: 0.0160, Accuracy: 4137/5024 (82.3447%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.5777, Accuracy: 8600/10000 (86.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 7, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2902/3641 (79.7034%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6466, Accuracy: 8417/10000 (84.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 8, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3989/4701 (84.8543%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.5881, Accuracy: 8621/10000 (86.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 9, internal_epoch   1,  Average loss: 0.0189, Accuracy: 2649/3315 (79.9095%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6435, Accuracy: 8503/10000 (85.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 10, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2792/3435 (81.2809%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6525, Accuracy: 8583/10000 (85.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 11, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3102/3917 (79.1933%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6239, Accuracy: 8473/10000 (84.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 12, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3285/4069 (80.7324%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6188, Accuracy: 8541/10000 (85.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 13, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3188/3851 (82.7837%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.6706, Accuracy: 8146/10000 (81.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  55, local model 14, internal_epoch   1,  Average loss: 0.0152, Accuracy: 2630/3110 (84.5659%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 1.0094, Accuracy: 7851/10000 (78.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 460.654545545578
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.64214205 1.        ]
___Test Target_Simple poisoned: False, epoch: 55: Average loss: 1.2903, Accuracy: 7729/10000 (77.2900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 55: Average loss: 1.3351, Accuracy: 6374/8991 (70.8931%)
Done in 469.3198313713074 sec.
Server Epoch:56 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  56, local model 0, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3235/3973 (81.4246%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6296, Accuracy: 8454/10000 (84.5400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  56, local model 1, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2973/3656 (81.3184%), train_poison_data_count: 3656
Global model norm: 2.251014163019744.
Norm before scaling: 3.7146644268216265. Distance: 2.155758677358415
Total norm for 5 adversaries is: 3.7146644268216265. distance: 2.155758677358415
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.5518, Accuracy: 7831/8991 (87.0982%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  56, local model 2, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3156/3821 (82.5962%), train_poison_data_count: 3821
Global model norm: 2.251014163019744.
Norm before scaling: 3.742188519376166. Distance: 2.139972782318439
Total norm for 5 adversaries is: 3.742188519376166. distance: 2.139972782318439
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.5562, Accuracy: 7712/8991 (85.7747%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  56, local model 3, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3542/4319 (82.0097%), train_poison_data_count: 4319
Global model norm: 2.251014163019744.
Norm before scaling: 3.817074267237787. Distance: 2.282661314963963
Total norm for 5 adversaries is: 3.817074267237787. distance: 2.282661314963963
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.5543, Accuracy: 7795/8991 (86.6978%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  56, local model 4, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3708/4396 (84.3494%), train_poison_data_count: 4396
Global model norm: 2.251014163019744.
Norm before scaling: 3.84491829833694. Distance: 2.3021941582656087
Total norm for 5 adversaries is: 3.84491829833694. distance: 2.3021941582656087
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.5264, Accuracy: 7773/8991 (86.4531%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  56, local model 5, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2727/3341 (81.6223%), train_poison_data_count: 3341
Global model norm: 2.251014163019744.
Norm before scaling: 3.6273133361448413. Distance: 2.0566214970843046
Total norm for 5 adversaries is: 3.6273133361448413. distance: 2.0566214970843046
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.5530, Accuracy: 7848/8991 (87.2873%)
___Train Local_Simple,  epoch  56, local model 6, internal_epoch   1,  Average loss: 0.0159, Accuracy: 4153/5024 (82.6632%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.5743, Accuracy: 8606/10000 (86.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 7, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2910/3641 (79.9231%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6572, Accuracy: 8340/10000 (83.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 8, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3985/4701 (84.7692%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.5952, Accuracy: 8590/10000 (85.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 9, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2670/3315 (80.5430%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6369, Accuracy: 8548/10000 (85.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 10, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2812/3435 (81.8632%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6539, Accuracy: 8527/10000 (85.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 11, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3139/3917 (80.1379%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6400, Accuracy: 8395/10000 (83.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 12, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3292/4069 (80.9044%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6191, Accuracy: 8509/10000 (85.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 13, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3189/3851 (82.8097%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.6732, Accuracy: 8101/10000 (81.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  56, local model 14, internal_epoch   1,  Average loss: 0.0150, Accuracy: 2649/3110 (85.1768%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 1.0158, Accuracy: 7822/10000 (78.2200%), Attack Success Rate:0/10000(0.000)
time spent on training: 465.58853101730347
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 56: Average loss: 1.2846, Accuracy: 7745/10000 (77.4500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 56: Average loss: 1.3302, Accuracy: 6380/8991 (70.9598%)
Done in 474.1868426799774 sec.
Server Epoch:57 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  57, local model 0, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3241/3973 (81.5756%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6202, Accuracy: 8560/10000 (85.6000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  57, local model 1, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2977/3656 (81.4278%), train_poison_data_count: 3656
Global model norm: 2.258539841654141.
Norm before scaling: 3.7118437935255546. Distance: 2.141006324384561
Total norm for 5 adversaries is: 3.7118437935255546. distance: 2.141006324384561
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.5396, Accuracy: 7891/8991 (87.7655%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  57, local model 2, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3166/3821 (82.8579%), train_poison_data_count: 3821
Global model norm: 2.258539841654141.
Norm before scaling: 3.74406395616273. Distance: 2.138615131060867
Total norm for 5 adversaries is: 3.74406395616273. distance: 2.138615131060867
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.5459, Accuracy: 7803/8991 (86.7868%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  57, local model 3, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3552/4319 (82.2413%), train_poison_data_count: 4319
Global model norm: 2.258539841654141.
Norm before scaling: 3.815147606230225. Distance: 2.2756480582980303
Total norm for 5 adversaries is: 3.815147606230225. distance: 2.2756480582980303
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.5472, Accuracy: 7819/8991 (86.9647%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  57, local model 4, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3689/4396 (83.9172%), train_poison_data_count: 4396
Global model norm: 2.258539841654141.
Norm before scaling: 3.851201595706712. Distance: 2.2983794183608217
Total norm for 5 adversaries is: 3.851201595706712. distance: 2.2983794183608217
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.5229, Accuracy: 7831/8991 (87.0982%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  57, local model 5, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2726/3341 (81.5923%), train_poison_data_count: 3341
Global model norm: 2.258539841654141.
Norm before scaling: 3.6184683523782666. Distance: 2.0415468245645623
Total norm for 5 adversaries is: 3.6184683523782666. distance: 2.0415468245645623
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.5577, Accuracy: 7927/8991 (88.1659%)
___Train Local_Simple,  epoch  57, local model 6, internal_epoch   1,  Average loss: 0.0160, Accuracy: 4133/5024 (82.2651%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.5839, Accuracy: 8558/10000 (85.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 7, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2929/3641 (80.4449%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6570, Accuracy: 8281/10000 (82.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 8, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3987/4701 (84.8117%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.5937, Accuracy: 8556/10000 (85.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 9, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2663/3315 (80.3318%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6368, Accuracy: 8580/10000 (85.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 10, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2796/3435 (81.3974%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6543, Accuracy: 8574/10000 (85.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 11, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3132/3917 (79.9592%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6218, Accuracy: 8477/10000 (84.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 12, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3298/4069 (81.0519%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6220, Accuracy: 8471/10000 (84.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 13, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3168/3851 (82.2643%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.6601, Accuracy: 8181/10000 (81.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  57, local model 14, internal_epoch   1,  Average loss: 0.0149, Accuracy: 2660/3110 (85.5305%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 1.0212, Accuracy: 7860/10000 (78.6000%), Attack Success Rate:0/10000(0.000)
time spent on training: 475.23942399024963
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.07622157 1.        ]
___Test Target_Simple poisoned: False, epoch: 57: Average loss: 1.2784, Accuracy: 7754/10000 (77.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 57: Average loss: 1.3244, Accuracy: 6386/8991 (71.0266%)
Done in 484.02406764030457 sec.
Server Epoch:58 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  58, local model 0, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3227/3973 (81.2233%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6181, Accuracy: 8531/10000 (85.3100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  58, local model 1, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2972/3656 (81.2910%), train_poison_data_count: 3656
Global model norm: 2.2667683840349353.
Norm before scaling: 3.7203586208620085. Distance: 2.134678621604526
Total norm for 5 adversaries is: 3.7203586208620085. distance: 2.134678621604526
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.5354, Accuracy: 7905/8991 (87.9213%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  58, local model 2, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3169/3821 (82.9364%), train_poison_data_count: 3821
Global model norm: 2.2667683840349353.
Norm before scaling: 3.7478415317153666. Distance: 2.123770189643976
Total norm for 5 adversaries is: 3.7478415317153666. distance: 2.123770189643976
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.5482, Accuracy: 7793/8991 (86.6756%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  58, local model 3, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3555/4319 (82.3107%), train_poison_data_count: 4319
Global model norm: 2.2667683840349353.
Norm before scaling: 3.8198008438442574. Distance: 2.267750341691883
Total norm for 5 adversaries is: 3.8198008438442574. distance: 2.267750341691883
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.5701, Accuracy: 7706/8991 (85.7079%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  58, local model 4, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3702/4396 (84.2129%), train_poison_data_count: 4396
Global model norm: 2.2667683840349353.
Norm before scaling: 3.8429608038819936. Distance: 2.2753771081613006
Total norm for 5 adversaries is: 3.8429608038819936. distance: 2.2753771081613006
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.5204, Accuracy: 7823/8991 (87.0092%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  58, local model 5, internal_epoch   1,  Average loss: 0.0174, Accuracy: 2723/3341 (81.5025%), train_poison_data_count: 3341
Global model norm: 2.2667683840349353.
Norm before scaling: 3.63728565751244. Distance: 2.0474959734643043
Total norm for 5 adversaries is: 3.63728565751244. distance: 2.0474959734643043
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.5523, Accuracy: 7873/8991 (87.5653%)
___Train Local_Simple,  epoch  58, local model 6, internal_epoch   1,  Average loss: 0.0159, Accuracy: 4156/5024 (82.7229%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5714, Accuracy: 8617/10000 (86.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 7, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2903/3641 (79.7308%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6366, Accuracy: 8443/10000 (84.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 8, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3994/4701 (84.9606%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.5880, Accuracy: 8597/10000 (85.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 9, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2663/3315 (80.3318%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6549, Accuracy: 8351/10000 (83.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 10, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2813/3435 (81.8923%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6524, Accuracy: 8475/10000 (84.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 11, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3136/3917 (80.0613%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6187, Accuracy: 8541/10000 (85.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 12, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3303/4069 (81.1747%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6235, Accuracy: 8502/10000 (85.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 13, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3176/3851 (82.4721%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.6645, Accuracy: 8162/10000 (81.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  58, local model 14, internal_epoch   1,  Average loss: 0.0149, Accuracy: 2654/3110 (85.3376%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 1.0023, Accuracy: 7851/10000 (78.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 482.02711844444275
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 58: Average loss: 1.2654, Accuracy: 7769/10000 (77.6900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 58: Average loss: 1.3127, Accuracy: 6395/8991 (71.1267%)
Done in 490.66514778137207 sec.
Server Epoch:59 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  59, local model 0, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3264/3973 (82.1545%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6240, Accuracy: 8561/10000 (85.6100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  59, local model 1, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3005/3656 (82.1937%), train_poison_data_count: 3656
Global model norm: 2.2828767802687864.
Norm before scaling: 3.7146161608369543. Distance: 2.1090011830586586
Total norm for 5 adversaries is: 3.7146161608369543. distance: 2.1090011830586586
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.5399, Accuracy: 7892/8991 (87.7767%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  59, local model 2, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3170/3821 (82.9626%), train_poison_data_count: 3821
Global model norm: 2.2828767802687864.
Norm before scaling: 3.7518678463841124. Distance: 2.11032772447926
Total norm for 5 adversaries is: 3.7518678463841124. distance: 2.11032772447926
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.5574, Accuracy: 7727/8991 (85.9415%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  59, local model 3, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3572/4319 (82.7043%), train_poison_data_count: 4319
Global model norm: 2.2828767802687864.
Norm before scaling: 3.820385891262072. Distance: 2.2445001139939267
Total norm for 5 adversaries is: 3.820385891262072. distance: 2.2445001139939267
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.5446, Accuracy: 7834/8991 (87.1316%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  59, local model 4, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3695/4396 (84.0537%), train_poison_data_count: 4396
Global model norm: 2.2828767802687864.
Norm before scaling: 3.854721414318658. Distance: 2.2652935969568753
Total norm for 5 adversaries is: 3.854721414318658. distance: 2.2652935969568753
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.5285, Accuracy: 7775/8991 (86.4754%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  59, local model 5, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2729/3341 (81.6821%), train_poison_data_count: 3341
Global model norm: 2.2828767802687864.
Norm before scaling: 3.638757578751152. Distance: 2.0309639362493512
Total norm for 5 adversaries is: 3.638757578751152. distance: 2.0309639362493512
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.5493, Accuracy: 7915/8991 (88.0325%)
___Train Local_Simple,  epoch  59, local model 6, internal_epoch   1,  Average loss: 0.0158, Accuracy: 4144/5024 (82.4841%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.5688, Accuracy: 8667/10000 (86.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 7, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2919/3641 (80.1703%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6476, Accuracy: 8376/10000 (83.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 8, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3979/4701 (84.6416%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.5920, Accuracy: 8615/10000 (86.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 9, internal_epoch   1,  Average loss: 0.0186, Accuracy: 2663/3315 (80.3318%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6569, Accuracy: 8343/10000 (83.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 10, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2787/3435 (81.1354%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6451, Accuracy: 8598/10000 (85.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 11, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3137/3917 (80.0868%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6313, Accuracy: 8455/10000 (84.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 12, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3333/4069 (81.9120%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6185, Accuracy: 8490/10000 (84.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 13, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3206/3851 (83.2511%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.6536, Accuracy: 8264/10000 (82.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  59, local model 14, internal_epoch   1,  Average loss: 0.0149, Accuracy: 2643/3110 (84.9839%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 1.0060, Accuracy: 7844/10000 (78.4400%), Attack Success Rate:0/10000(0.000)
time spent on training: 486.2868597507477
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 59: Average loss: 1.2601, Accuracy: 7775/10000 (77.7500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 59: Average loss: 1.3076, Accuracy: 6394/8991 (71.1156%)
Done in 494.7873821258545 sec.
Server Epoch:60 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  60, local model 0, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3249/3973 (81.7770%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6217, Accuracy: 8545/10000 (85.4500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  60, local model 1, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2967/3656 (81.1543%), train_poison_data_count: 3656
Global model norm: 2.290473268903775.
Norm before scaling: 3.7322911789077806. Distance: 2.119497580283679
Total norm for 5 adversaries is: 3.7322911789077806. distance: 2.119497580283679
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.5463, Accuracy: 7871/8991 (87.5431%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  60, local model 2, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3159/3821 (82.6747%), train_poison_data_count: 3821
Global model norm: 2.290473268903775.
Norm before scaling: 3.759871903936195. Distance: 2.1048424520000775
Total norm for 5 adversaries is: 3.759871903936195. distance: 2.1048424520000775
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.5512, Accuracy: 7745/8991 (86.1417%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  60, local model 3, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3559/4319 (82.4033%), train_poison_data_count: 4319
Global model norm: 2.290473268903775.
Norm before scaling: 3.8225572851964427. Distance: 2.231052622893917
Total norm for 5 adversaries is: 3.8225572851964427. distance: 2.231052622893917
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.5501, Accuracy: 7761/8991 (86.3197%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  60, local model 4, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3700/4396 (84.1674%), train_poison_data_count: 4396
Global model norm: 2.290473268903775.
Norm before scaling: 3.857272915438736. Distance: 2.261994709052552
Total norm for 5 adversaries is: 3.857272915438736. distance: 2.261994709052552
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.5252, Accuracy: 7808/8991 (86.8424%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  60, local model 5, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2709/3341 (81.0835%), train_poison_data_count: 3341
Global model norm: 2.290473268903775.
Norm before scaling: 3.633076582303332. Distance: 2.0055161937515384
Total norm for 5 adversaries is: 3.633076582303332. distance: 2.0055161937515384
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.5513, Accuracy: 7846/8991 (87.2650%)
___Train Local_Simple,  epoch  60, local model 6, internal_epoch   1,  Average loss: 0.0158, Accuracy: 4150/5024 (82.6035%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.5695, Accuracy: 8697/10000 (86.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 7, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2916/3641 (80.0879%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6299, Accuracy: 8533/10000 (85.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 8, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3988/4701 (84.8330%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.5856, Accuracy: 8640/10000 (86.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 9, internal_epoch   1,  Average loss: 0.0185, Accuracy: 2675/3315 (80.6938%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6426, Accuracy: 8552/10000 (85.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 10, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2801/3435 (81.5429%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6523, Accuracy: 8524/10000 (85.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 11, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3145/3917 (80.2910%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6391, Accuracy: 8416/10000 (84.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 12, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3280/4069 (80.6095%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6106, Accuracy: 8551/10000 (85.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 13, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3187/3851 (82.7577%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.6497, Accuracy: 8275/10000 (82.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  60, local model 14, internal_epoch   1,  Average loss: 0.0147, Accuracy: 2660/3110 (85.5305%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 1.0069, Accuracy: 7913/10000 (79.1300%), Attack Success Rate:0/10000(0.000)
time spent on training: 495.9531526565552
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 60: Average loss: 1.2549, Accuracy: 7776/10000 (77.7600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 60: Average loss: 1.3029, Accuracy: 6393/8991 (71.1044%)
Done in 504.5333571434021 sec.
Server Epoch:61 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  61, local model 0, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3229/3973 (81.2736%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6229, Accuracy: 8457/10000 (84.5700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  61, local model 1, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2983/3656 (81.5919%), train_poison_data_count: 3656
Global model norm: 2.29805678502134.
Norm before scaling: 3.7324885627382276. Distance: 2.112839516888871
Total norm for 5 adversaries is: 3.7324885627382276. distance: 2.112839516888871
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.5362, Accuracy: 7916/8991 (88.0436%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  61, local model 2, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3189/3821 (83.4598%), train_poison_data_count: 3821
Global model norm: 2.29805678502134.
Norm before scaling: 3.7472006203723396. Distance: 2.08573438248405
Total norm for 5 adversaries is: 3.7472006203723396. distance: 2.08573438248405
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.5488, Accuracy: 7841/8991 (87.2094%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  61, local model 3, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3553/4319 (82.2644%), train_poison_data_count: 4319
Global model norm: 2.29805678502134.
Norm before scaling: 3.8218475565389003. Distance: 2.2233274281131195
Total norm for 5 adversaries is: 3.8218475565389003. distance: 2.2233274281131195
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.5358, Accuracy: 7864/8991 (87.4652%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  61, local model 4, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3685/4396 (83.8262%), train_poison_data_count: 4396
Global model norm: 2.29805678502134.
Norm before scaling: 3.857135447237678. Distance: 2.2518285103137985
Total norm for 5 adversaries is: 3.857135447237678. distance: 2.2518285103137985
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.5136, Accuracy: 7877/8991 (87.6098%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  61, local model 5, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2749/3341 (82.2808%), train_poison_data_count: 3341
Global model norm: 2.29805678502134.
Norm before scaling: 3.6370019525874606. Distance: 2.001792104804936
Total norm for 5 adversaries is: 3.6370019525874606. distance: 2.001792104804936
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.5513, Accuracy: 7858/8991 (87.3985%)
___Train Local_Simple,  epoch  61, local model 6, internal_epoch   1,  Average loss: 0.0157, Accuracy: 4156/5024 (82.7229%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.5785, Accuracy: 8507/10000 (85.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 7, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2915/3641 (80.0604%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6630, Accuracy: 8194/10000 (81.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 8, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3987/4701 (84.8117%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.5880, Accuracy: 8614/10000 (86.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 9, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2679/3315 (80.8145%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6335, Accuracy: 8587/10000 (85.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 10, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2799/3435 (81.4847%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6439, Accuracy: 8601/10000 (86.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 11, internal_epoch   1,  Average loss: 0.0179, Accuracy: 3158/3917 (80.6229%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6206, Accuracy: 8450/10000 (84.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 12, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3282/4069 (80.6586%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6295, Accuracy: 8430/10000 (84.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 13, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3198/3851 (83.0434%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.6446, Accuracy: 8315/10000 (83.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  61, local model 14, internal_epoch   1,  Average loss: 0.0147, Accuracy: 2656/3110 (85.4019%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 1.0097, Accuracy: 7875/10000 (78.7500%), Attack Success Rate:0/10000(0.000)
time spent on training: 504.06368494033813
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 61: Average loss: 1.2499, Accuracy: 7780/10000 (77.8000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 61: Average loss: 1.2985, Accuracy: 6394/8991 (71.1156%)
Done in 512.6221754550934 sec.
Server Epoch:62 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  62, local model 0, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3265/3973 (82.1797%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.6231, Accuracy: 8548/10000 (85.4800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  62, local model 1, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2972/3656 (81.2910%), train_poison_data_count: 3656
Global model norm: 2.305648965232762.
Norm before scaling: 3.7271065304871027. Distance: 2.097326156814109
Total norm for 5 adversaries is: 3.7271065304871027. distance: 2.097326156814109
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.5495, Accuracy: 7844/8991 (87.2428%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  62, local model 2, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3164/3821 (82.8055%), train_poison_data_count: 3821
Global model norm: 2.305648965232762.
Norm before scaling: 3.7612228304337116. Distance: 2.0910143844569458
Total norm for 5 adversaries is: 3.7612228304337116. distance: 2.0910143844569458
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.5588, Accuracy: 7676/8991 (85.3743%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  62, local model 3, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3552/4319 (82.2413%), train_poison_data_count: 4319
Global model norm: 2.305648965232762.
Norm before scaling: 3.820837690766213. Distance: 2.2128880392195835
Total norm for 5 adversaries is: 3.820837690766213. distance: 2.2128880392195835
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.5396, Accuracy: 7838/8991 (87.1761%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  62, local model 4, internal_epoch   1,  Average loss: 0.0145, Accuracy: 3714/4396 (84.4859%), train_poison_data_count: 4396
Global model norm: 2.305648965232762.
Norm before scaling: 3.8741478752150393. Distance: 2.2598518216666093
Total norm for 5 adversaries is: 3.8741478752150393. distance: 2.2598518216666093
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.5173, Accuracy: 7799/8991 (86.7423%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  62, local model 5, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2736/3341 (81.8916%), train_poison_data_count: 3341
Global model norm: 2.305648965232762.
Norm before scaling: 3.6421123298864275. Distance: 2.006507657342326
Total norm for 5 adversaries is: 3.6421123298864275. distance: 2.006507657342326
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.5514, Accuracy: 7896/8991 (87.8212%)
___Train Local_Simple,  epoch  62, local model 6, internal_epoch   1,  Average loss: 0.0157, Accuracy: 4161/5024 (82.8225%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.5710, Accuracy: 8632/10000 (86.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 7, internal_epoch   1,  Average loss: 0.0174, Accuracy: 2922/3641 (80.2527%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.6743, Accuracy: 8143/10000 (81.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 8, internal_epoch   1,  Average loss: 0.0153, Accuracy: 4007/4701 (85.2372%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.5839, Accuracy: 8646/10000 (86.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 9, internal_epoch   1,  Average loss: 0.0185, Accuracy: 2688/3315 (81.0860%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.6344, Accuracy: 8585/10000 (85.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 10, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2776/3435 (80.8151%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.6387, Accuracy: 8612/10000 (86.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 11, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3160/3917 (80.6740%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.6225, Accuracy: 8439/10000 (84.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 12, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3317/4069 (81.5188%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.6159, Accuracy: 8520/10000 (85.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 13, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3187/3851 (82.7577%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.6474, Accuracy: 8264/10000 (82.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  62, local model 14, internal_epoch   1,  Average loss: 0.0147, Accuracy: 2649/3110 (85.1768%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.9908, Accuracy: 7933/10000 (79.3300%), Attack Success Rate:0/10000(0.000)
time spent on training: 509.5604636669159
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        0.        0.        0.        0.1957731
 1.       ]
___Test Target_Simple poisoned: False, epoch: 62: Average loss: 1.2434, Accuracy: 7781/10000 (77.8100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 62: Average loss: 1.2927, Accuracy: 6395/8991 (71.1267%)
Done in 518.3473806381226 sec.
Server Epoch:63 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  63, local model 0, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3252/3973 (81.8525%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.6184, Accuracy: 8567/10000 (85.6700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  63, local model 1, internal_epoch   1,  Average loss: 0.0170, Accuracy: 2992/3656 (81.8381%), train_poison_data_count: 3656
Global model norm: 2.3148827520220396.
Norm before scaling: 3.7305629538580036. Distance: 2.0869870634971233
Total norm for 5 adversaries is: 3.7305629538580036. distance: 2.0869870634971233
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.5432, Accuracy: 7855/8991 (87.3651%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  63, local model 2, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3157/3821 (82.6224%), train_poison_data_count: 3821
Global model norm: 2.3148827520220396.
Norm before scaling: 3.7508957111014274. Distance: 2.0678305665855974
Total norm for 5 adversaries is: 3.7508957111014274. distance: 2.0678305665855974
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.5517, Accuracy: 7809/8991 (86.8535%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  63, local model 3, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3582/4319 (82.9359%), train_poison_data_count: 4319
Global model norm: 2.3148827520220396.
Norm before scaling: 3.8221872796326894. Distance: 2.2046492694267905
Total norm for 5 adversaries is: 3.8221872796326894. distance: 2.2046492694267905
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.5338, Accuracy: 7886/8991 (87.7099%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  63, local model 4, internal_epoch   1,  Average loss: 0.0145, Accuracy: 3710/4396 (84.3949%), train_poison_data_count: 4396
Global model norm: 2.3148827520220396.
Norm before scaling: 3.857736463635608. Distance: 2.2273079678254684
Total norm for 5 adversaries is: 3.857736463635608. distance: 2.2273079678254684
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.5217, Accuracy: 7795/8991 (86.6978%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  63, local model 5, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2731/3341 (81.7420%), train_poison_data_count: 3341
Global model norm: 2.3148827520220396.
Norm before scaling: 3.646549626784617. Distance: 1.9930872063628722
Total norm for 5 adversaries is: 3.646549626784617. distance: 1.9930872063628722
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.5514, Accuracy: 7867/8991 (87.4986%)
___Train Local_Simple,  epoch  63, local model 6, internal_epoch   1,  Average loss: 0.0157, Accuracy: 4156/5024 (82.7229%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.5794, Accuracy: 8514/10000 (85.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 7, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2931/3641 (80.4999%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.6502, Accuracy: 8349/10000 (83.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 8, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3996/4701 (85.0032%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.5849, Accuracy: 8625/10000 (86.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 9, internal_epoch   1,  Average loss: 0.0183, Accuracy: 2685/3315 (80.9955%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.6437, Accuracy: 8506/10000 (85.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 10, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2800/3435 (81.5138%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.6426, Accuracy: 8613/10000 (86.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 11, internal_epoch   1,  Average loss: 0.0179, Accuracy: 3127/3917 (79.8315%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.6243, Accuracy: 8493/10000 (84.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 12, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3306/4069 (81.2485%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.6221, Accuracy: 8481/10000 (84.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 13, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3185/3851 (82.7058%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.6321, Accuracy: 8444/10000 (84.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  63, local model 14, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2647/3110 (85.1125%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.9932, Accuracy: 7965/10000 (79.6500%), Attack Success Rate:0/10000(0.000)
time spent on training: 508.44499135017395
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.35957993 0.         0.         0.
 0.         0.23704545 1.        ]
___Test Target_Simple poisoned: False, epoch: 63: Average loss: 1.2332, Accuracy: 7801/10000 (78.0100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 63: Average loss: 1.2834, Accuracy: 6395/8991 (71.1267%)
Done in 517.0496816635132 sec.
Server Epoch:64 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  64, local model 0, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3281/3973 (82.5824%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.6130, Accuracy: 8564/10000 (85.6400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  64, local model 1, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2992/3656 (81.8381%), train_poison_data_count: 3656
Global model norm: 2.3279161807632645.
Norm before scaling: 3.7321043892557784. Distance: 2.072990901774321
Total norm for 5 adversaries is: 3.7321043892557784. distance: 2.072990901774321
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.5346, Accuracy: 7918/8991 (88.0658%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  64, local model 2, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3164/3821 (82.8055%), train_poison_data_count: 3821
Global model norm: 2.3279161807632645.
Norm before scaling: 3.7572606052221342. Distance: 2.0539420628608567
Total norm for 5 adversaries is: 3.7572606052221342. distance: 2.0539420628608567
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.5564, Accuracy: 7714/8991 (85.7969%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  64, local model 3, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3548/4319 (82.1486%), train_poison_data_count: 4319
Global model norm: 2.3279161807632645.
Norm before scaling: 3.839613759166419. Distance: 2.2084052476029803
Total norm for 5 adversaries is: 3.839613759166419. distance: 2.2084052476029803
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.5404, Accuracy: 7831/8991 (87.0982%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  64, local model 4, internal_epoch   1,  Average loss: 0.0145, Accuracy: 3701/4396 (84.1902%), train_poison_data_count: 4396
Global model norm: 2.3279161807632645.
Norm before scaling: 3.8662208042466926. Distance: 2.2213059867711236
Total norm for 5 adversaries is: 3.8662208042466926. distance: 2.2213059867711236
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.5183, Accuracy: 7847/8991 (87.2762%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  64, local model 5, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2722/3341 (81.4726%), train_poison_data_count: 3341
Global model norm: 2.3279161807632645.
Norm before scaling: 3.649728289380418. Distance: 1.9814830342138485
Total norm for 5 adversaries is: 3.649728289380418. distance: 1.9814830342138485
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.5535, Accuracy: 7895/8991 (87.8100%)
___Train Local_Simple,  epoch  64, local model 6, internal_epoch   1,  Average loss: 0.0156, Accuracy: 4139/5024 (82.3846%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.5715, Accuracy: 8583/10000 (85.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 7, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2923/3641 (80.2801%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.6251, Accuracy: 8476/10000 (84.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 8, internal_epoch   1,  Average loss: 0.0152, Accuracy: 4000/4701 (85.0883%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.5952, Accuracy: 8607/10000 (86.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 9, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2678/3315 (80.7843%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.6333, Accuracy: 8587/10000 (85.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 10, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2819/3435 (82.0670%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.6404, Accuracy: 8619/10000 (86.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 11, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3157/3917 (80.5974%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.6242, Accuracy: 8478/10000 (84.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 12, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3314/4069 (81.4451%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.6173, Accuracy: 8494/10000 (84.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 13, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3206/3851 (83.2511%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.6897, Accuracy: 8014/10000 (80.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  64, local model 14, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2656/3110 (85.4019%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.9884, Accuracy: 8017/10000 (80.1700%), Attack Success Rate:0/10000(0.000)
time spent on training: 530.6756916046143
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 64: Average loss: 1.2211, Accuracy: 7819/10000 (78.1900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 64: Average loss: 1.2727, Accuracy: 6396/8991 (71.1378%)
Done in 539.5639848709106 sec.
Server Epoch:65 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  65, local model 0, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3276/3973 (82.4566%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.6166, Accuracy: 8505/10000 (85.0500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  65, local model 1, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2992/3656 (81.8381%), train_poison_data_count: 3656
Global model norm: 2.3439689025378416.
Norm before scaling: 3.7284519355973424. Distance: 2.0497597902568745
Total norm for 5 adversaries is: 3.7284519355973424. distance: 2.0497597902568745
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.5440, Accuracy: 7897/8991 (87.8323%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  65, local model 2, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3184/3821 (83.3290%), train_poison_data_count: 3821
Global model norm: 2.3439689025378416.
Norm before scaling: 3.7690368644387187. Distance: 2.0438916545154613
Total norm for 5 adversaries is: 3.7690368644387187. distance: 2.0438916545154613
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.5540, Accuracy: 7726/8991 (85.9304%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  65, local model 3, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3567/4319 (82.5886%), train_poison_data_count: 4319
Global model norm: 2.3439689025378416.
Norm before scaling: 3.834290688978269. Distance: 2.1822190982039174
Total norm for 5 adversaries is: 3.834290688978269. distance: 2.1822190982039174
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.5455, Accuracy: 7828/8991 (87.0648%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  65, local model 4, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3697/4396 (84.0992%), train_poison_data_count: 4396
Global model norm: 2.3439689025378416.
Norm before scaling: 3.874594021111138. Distance: 2.204806071985352
Total norm for 5 adversaries is: 3.874594021111138. distance: 2.204806071985352
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.5316, Accuracy: 7686/8991 (85.4855%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  65, local model 5, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2732/3341 (81.7719%), train_poison_data_count: 3341
Global model norm: 2.3439689025378416.
Norm before scaling: 3.65473136989689. Distance: 1.963870647471001
Total norm for 5 adversaries is: 3.65473136989689. distance: 1.963870647471001
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.5448, Accuracy: 7887/8991 (87.7211%)
___Train Local_Simple,  epoch  65, local model 6, internal_epoch   1,  Average loss: 0.0155, Accuracy: 4179/5024 (83.1807%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.5665, Accuracy: 8656/10000 (86.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 7, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2930/3641 (80.4724%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.6452, Accuracy: 8454/10000 (84.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 8, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3994/4701 (84.9606%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.5869, Accuracy: 8581/10000 (85.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 9, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2678/3315 (80.7843%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.6413, Accuracy: 8501/10000 (85.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 10, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2802/3435 (81.5721%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.6373, Accuracy: 8603/10000 (86.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 11, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3120/3917 (79.6528%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.6118, Accuracy: 8558/10000 (85.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 12, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3298/4069 (81.0519%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.6109, Accuracy: 8532/10000 (85.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 13, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3216/3851 (83.5108%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.6541, Accuracy: 8240/10000 (82.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  65, local model 14, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2670/3110 (85.8521%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 1.0041, Accuracy: 7841/10000 (78.4100%), Attack Success Rate:0/10000(0.000)
time spent on training: 537.1363546848297
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.25014503 1.        ]
___Test Target_Simple poisoned: False, epoch: 65: Average loss: 1.2147, Accuracy: 7818/10000 (78.1800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 65: Average loss: 1.2666, Accuracy: 6398/8991 (71.1600%)
Done in 546.7134213447571 sec.
Server Epoch:66 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  66, local model 0, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3300/3973 (83.0607%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.6128, Accuracy: 8568/10000 (85.6800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  66, local model 1, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3005/3656 (82.1937%), train_poison_data_count: 3656
Global model norm: 2.3536517725143127.
Norm before scaling: 3.738196935071562. Distance: 2.0496611524453865
Total norm for 5 adversaries is: 3.738196935071562. distance: 2.0496611524453865
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.5333, Accuracy: 7932/8991 (88.2216%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  66, local model 2, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3184/3821 (83.3290%), train_poison_data_count: 3821
Global model norm: 2.3536517725143127.
Norm before scaling: 3.7811291888144845. Distance: 2.042926970249775
Total norm for 5 adversaries is: 3.7811291888144845. distance: 2.042926970249775
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.5520, Accuracy: 7723/8991 (85.8970%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  66, local model 3, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3551/4319 (82.2181%), train_poison_data_count: 4319
Global model norm: 2.3536517725143127.
Norm before scaling: 3.8320135802504187. Distance: 2.159905472559071
Total norm for 5 adversaries is: 3.8320135802504187. distance: 2.159905472559071
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.5405, Accuracy: 7834/8991 (87.1316%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  66, local model 4, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3682/4396 (83.7580%), train_poison_data_count: 4396
Global model norm: 2.3536517725143127.
Norm before scaling: 3.868718377940863. Distance: 2.1941285113841884
Total norm for 5 adversaries is: 3.868718377940863. distance: 2.1941285113841884
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.5100, Accuracy: 7917/8991 (88.0547%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  66, local model 5, internal_epoch   1,  Average loss: 0.0170, Accuracy: 2722/3341 (81.4726%), train_poison_data_count: 3341
Global model norm: 2.3536517725143127.
Norm before scaling: 3.6584035937630497. Distance: 1.9560385982863018
Total norm for 5 adversaries is: 3.6584035937630497. distance: 1.9560385982863018
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.5509, Accuracy: 7861/8991 (87.4319%)
___Train Local_Simple,  epoch  66, local model 6, internal_epoch   1,  Average loss: 0.0154, Accuracy: 4170/5024 (83.0016%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.5694, Accuracy: 8594/10000 (85.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 7, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2925/3641 (80.3351%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.6434, Accuracy: 8333/10000 (83.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 8, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3970/4701 (84.4501%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.5890, Accuracy: 8607/10000 (86.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 9, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2682/3315 (80.9050%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.6334, Accuracy: 8573/10000 (85.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 10, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2791/3435 (81.2518%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.6390, Accuracy: 8590/10000 (85.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 11, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3138/3917 (80.1123%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.6218, Accuracy: 8521/10000 (85.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 12, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3324/4069 (81.6908%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.6172, Accuracy: 8516/10000 (85.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 13, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3230/3851 (83.8743%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.6584, Accuracy: 8174/10000 (81.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  66, local model 14, internal_epoch   1,  Average loss: 0.0143, Accuracy: 2666/3110 (85.7235%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 1.0003, Accuracy: 7847/10000 (78.4700%), Attack Success Rate:0/10000(0.000)
time spent on training: 543.1213705539703
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.08648239 1.        ]
___Test Target_Simple poisoned: False, epoch: 66: Average loss: 1.2094, Accuracy: 7833/10000 (78.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 66: Average loss: 1.2625, Accuracy: 6405/8991 (71.2379%)
Done in 551.98499584198 sec.
Server Epoch:67 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  67, local model 0, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3272/3973 (82.3559%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.6159, Accuracy: 8534/10000 (85.3400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  67, local model 1, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3003/3656 (82.1389%), train_poison_data_count: 3656
Global model norm: 2.361970093249495.
Norm before scaling: 3.743785158734179. Distance: 2.0383700660313204
Total norm for 5 adversaries is: 3.743785158734179. distance: 2.0383700660313204
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.5379, Accuracy: 7881/8991 (87.6543%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  67, local model 2, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3179/3821 (83.1981%), train_poison_data_count: 3821
Global model norm: 2.361970093249495.
Norm before scaling: 3.772245673017936. Distance: 2.024058125290789
Total norm for 5 adversaries is: 3.772245673017936. distance: 2.024058125290789
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.5650, Accuracy: 7679/8991 (85.4076%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  67, local model 3, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3564/4319 (82.5191%), train_poison_data_count: 4319
Global model norm: 2.361970093249495.
Norm before scaling: 3.842708663685344. Distance: 2.1718226364739217
Total norm for 5 adversaries is: 3.842708663685344. distance: 2.1718226364739217
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.5538, Accuracy: 7791/8991 (86.6533%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  67, local model 4, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3703/4396 (84.2357%), train_poison_data_count: 4396
Global model norm: 2.361970093249495.
Norm before scaling: 3.8663314334200267. Distance: 2.175547506765392
Total norm for 5 adversaries is: 3.8663314334200267. distance: 2.175547506765392
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.5247, Accuracy: 7780/8991 (86.5310%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  67, local model 5, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2727/3341 (81.6223%), train_poison_data_count: 3341
Global model norm: 2.361970093249495.
Norm before scaling: 3.664398633427527. Distance: 1.9547948794064274
Total norm for 5 adversaries is: 3.664398633427527. distance: 1.9547948794064274
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.5451, Accuracy: 7898/8991 (87.8434%)
___Train Local_Simple,  epoch  67, local model 6, internal_epoch   1,  Average loss: 0.0155, Accuracy: 4152/5024 (82.6433%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.5798, Accuracy: 8546/10000 (85.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 7, internal_epoch   1,  Average loss: 0.0170, Accuracy: 2948/3641 (80.9668%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.6375, Accuracy: 8473/10000 (84.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 8, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3997/4701 (85.0245%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.5788, Accuracy: 8636/10000 (86.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 9, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2705/3315 (81.5988%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.6345, Accuracy: 8529/10000 (85.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 10, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2809/3435 (81.7758%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.6419, Accuracy: 8604/10000 (86.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 11, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3170/3917 (80.9293%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.6182, Accuracy: 8526/10000 (85.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 12, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3311/4069 (81.3713%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.6095, Accuracy: 8549/10000 (85.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 13, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3171/3851 (82.3422%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.6381, Accuracy: 8310/10000 (83.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  67, local model 14, internal_epoch   1,  Average loss: 0.0143, Accuracy: 2666/3110 (85.7235%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.9894, Accuracy: 7950/10000 (79.5000%), Attack Success Rate:0/10000(0.000)
time spent on training: 550.2548506259918
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 67: Average loss: 1.2049, Accuracy: 7839/10000 (78.3900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 67: Average loss: 1.2588, Accuracy: 6402/8991 (71.2045%)
Done in 559.021143913269 sec.
Server Epoch:68 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  68, local model 0, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3258/3973 (82.0035%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.6185, Accuracy: 8511/10000 (85.1100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  68, local model 1, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2971/3656 (81.2637%), train_poison_data_count: 3656
Global model norm: 2.3695313586679316.
Norm before scaling: 3.7498934412757454. Distance: 2.041120988234367
Total norm for 5 adversaries is: 3.7498934412757454. distance: 2.041120988234367
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.5346, Accuracy: 7908/8991 (87.9546%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  68, local model 2, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3178/3821 (83.1719%), train_poison_data_count: 3821
Global model norm: 2.3695313586679316.
Norm before scaling: 3.771945192304952. Distance: 2.014711276399722
Total norm for 5 adversaries is: 3.771945192304952. distance: 2.014711276399722
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.5654, Accuracy: 7645/8991 (85.0295%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  68, local model 3, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3578/4319 (82.8433%), train_poison_data_count: 4319
Global model norm: 2.3695313586679316.
Norm before scaling: 3.8414603756498633. Distance: 2.15057399983064
Total norm for 5 adversaries is: 3.8414603756498633. distance: 2.15057399983064
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.5381, Accuracy: 7790/8991 (86.6422%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  68, local model 4, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3720/4396 (84.6224%), train_poison_data_count: 4396
Global model norm: 2.3695313586679316.
Norm before scaling: 3.875098688653201. Distance: 2.1815205184947324
Total norm for 5 adversaries is: 3.875098688653201. distance: 2.1815205184947324
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.5218, Accuracy: 7816/8991 (86.9314%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  68, local model 5, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2736/3341 (81.8916%), train_poison_data_count: 3341
Global model norm: 2.3695313586679316.
Norm before scaling: 3.655773686088416. Distance: 1.9324922140539533
Total norm for 5 adversaries is: 3.655773686088416. distance: 1.9324922140539533
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.5443, Accuracy: 7946/8991 (88.3773%)
___Train Local_Simple,  epoch  68, local model 6, internal_epoch   1,  Average loss: 0.0154, Accuracy: 4163/5024 (82.8623%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.5846, Accuracy: 8503/10000 (85.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 7, internal_epoch   1,  Average loss: 0.0170, Accuracy: 2949/3641 (80.9942%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.6539, Accuracy: 8269/10000 (82.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 8, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3987/4701 (84.8117%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.5829, Accuracy: 8638/10000 (86.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 9, internal_epoch   1,  Average loss: 0.0179, Accuracy: 2699/3315 (81.4178%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.6356, Accuracy: 8540/10000 (85.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 10, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2825/3435 (82.2416%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.6287, Accuracy: 8630/10000 (86.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 11, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3167/3917 (80.8527%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.6359, Accuracy: 8362/10000 (83.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 12, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3337/4069 (82.0103%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.6314, Accuracy: 8400/10000 (84.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 13, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3219/3851 (83.5887%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.6506, Accuracy: 8263/10000 (82.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  68, local model 14, internal_epoch   1,  Average loss: 0.0142, Accuracy: 2668/3110 (85.7878%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.9902, Accuracy: 7869/10000 (78.6900%), Attack Success Rate:0/10000(0.000)
time spent on training: 560.3583986759186
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 68: Average loss: 1.2006, Accuracy: 7843/10000 (78.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 68: Average loss: 1.2548, Accuracy: 6408/8991 (71.2713%)
Done in 569.0443801879883 sec.
Server Epoch:69 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  69, local model 0, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3300/3973 (83.0607%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6162, Accuracy: 8543/10000 (85.4300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  69, local model 1, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2992/3656 (81.8381%), train_poison_data_count: 3656
Global model norm: 2.3771417898690532.
Norm before scaling: 3.747775626095389. Distance: 2.024508984222413
Total norm for 5 adversaries is: 3.747775626095389. distance: 2.024508984222413
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.5331, Accuracy: 7899/8991 (87.8545%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  69, local model 2, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3159/3821 (82.6747%), train_poison_data_count: 3821
Global model norm: 2.3771417898690532.
Norm before scaling: 3.778851844154624. Distance: 2.013692002884977
Total norm for 5 adversaries is: 3.778851844154624. distance: 2.013692002884977
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.5470, Accuracy: 7819/8991 (86.9647%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  69, local model 3, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3600/4319 (83.3526%), train_poison_data_count: 4319
Global model norm: 2.3771417898690532.
Norm before scaling: 3.847254946156745. Distance: 2.151643891966255
Total norm for 5 adversaries is: 3.847254946156745. distance: 2.151643891966255
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.5446, Accuracy: 7800/8991 (86.7534%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  69, local model 4, internal_epoch   1,  Average loss: 0.0143, Accuracy: 3713/4396 (84.4631%), train_poison_data_count: 4396
Global model norm: 2.3771417898690532.
Norm before scaling: 3.8768312372606197. Distance: 2.1714589111460088
Total norm for 5 adversaries is: 3.8768312372606197. distance: 2.1714589111460088
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.5205, Accuracy: 7822/8991 (86.9981%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  69, local model 5, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2727/3341 (81.6223%), train_poison_data_count: 3341
Global model norm: 2.3771417898690532.
Norm before scaling: 3.67294412834531. Distance: 1.9459343341478796
Total norm for 5 adversaries is: 3.67294412834531. distance: 1.9459343341478796
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.5425, Accuracy: 7860/8991 (87.4208%)
___Train Local_Simple,  epoch  69, local model 6, internal_epoch   1,  Average loss: 0.0154, Accuracy: 4166/5024 (82.9220%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.5674, Accuracy: 8641/10000 (86.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 7, internal_epoch   1,  Average loss: 0.0170, Accuracy: 2955/3641 (81.1590%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6364, Accuracy: 8421/10000 (84.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 8, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3987/4701 (84.8117%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.5855, Accuracy: 8645/10000 (86.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 9, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2688/3315 (81.0860%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6299, Accuracy: 8550/10000 (85.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 10, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2796/3435 (81.3974%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6387, Accuracy: 8568/10000 (85.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 11, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3112/3917 (79.4486%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6124, Accuracy: 8567/10000 (85.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 12, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3316/4069 (81.4942%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6248, Accuracy: 8450/10000 (84.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 13, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3217/3851 (83.5367%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.6432, Accuracy: 8281/10000 (82.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  69, local model 14, internal_epoch   1,  Average loss: 0.0142, Accuracy: 2675/3110 (86.0129%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.9902, Accuracy: 7912/10000 (79.1200%), Attack Success Rate:0/10000(0.000)
time spent on training: 564.3308501243591
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 69: Average loss: 1.1963, Accuracy: 7846/10000 (78.4600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 69: Average loss: 1.2509, Accuracy: 6411/8991 (71.3046%)
Done in 573.0597784519196 sec.
Server Epoch:70 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  70, local model 0, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3256/3973 (81.9532%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.6093, Accuracy: 8602/10000 (86.0200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  70, local model 1, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2990/3656 (81.7834%), train_poison_data_count: 3656
Global model norm: 2.3846859430471246.
Norm before scaling: 3.745540510421688. Distance: 2.010831826255962
Total norm for 5 adversaries is: 3.745540510421688. distance: 2.010831826255962
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.5292, Accuracy: 7939/8991 (88.2994%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  70, local model 2, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3162/3821 (82.7532%), train_poison_data_count: 3821
Global model norm: 2.3846859430471246.
Norm before scaling: 3.7709472526638512. Distance: 1.9972416214346398
Total norm for 5 adversaries is: 3.7709472526638512. distance: 1.9972416214346398
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.5556, Accuracy: 7736/8991 (86.0416%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  70, local model 3, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3586/4319 (83.0285%), train_poison_data_count: 4319
Global model norm: 2.3846859430471246.
Norm before scaling: 3.8465179153673765. Distance: 2.147696849429537
Total norm for 5 adversaries is: 3.8465179153673765. distance: 2.147696849429537
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.5396, Accuracy: 7849/8991 (87.2984%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  70, local model 4, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3704/4396 (84.2584%), train_poison_data_count: 4396
Global model norm: 2.3846859430471246.
Norm before scaling: 3.879338819465051. Distance: 2.1713912754512847
Total norm for 5 adversaries is: 3.879338819465051. distance: 2.1713912754512847
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.5184, Accuracy: 7842/8991 (87.2206%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  70, local model 5, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2728/3341 (81.6522%), train_poison_data_count: 3341
Global model norm: 2.3846859430471246.
Norm before scaling: 3.661126951557392. Distance: 1.9267764972722379
Total norm for 5 adversaries is: 3.661126951557392. distance: 1.9267764972722379
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.5589, Accuracy: 7882/8991 (87.6654%)
___Train Local_Simple,  epoch  70, local model 6, internal_epoch   1,  Average loss: 0.0154, Accuracy: 4180/5024 (83.2006%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.5760, Accuracy: 8572/10000 (85.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 7, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2958/3641 (81.2414%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.6454, Accuracy: 8311/10000 (83.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 8, internal_epoch   1,  Average loss: 0.0150, Accuracy: 4003/4701 (85.1521%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.5850, Accuracy: 8633/10000 (86.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 9, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2703/3315 (81.5385%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.6429, Accuracy: 8464/10000 (84.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 10, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2818/3435 (82.0378%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.6432, Accuracy: 8524/10000 (85.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 11, internal_epoch   1,  Average loss: 0.0174, Accuracy: 3166/3917 (80.8272%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.6134, Accuracy: 8546/10000 (85.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 12, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3298/4069 (81.0519%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.6118, Accuracy: 8550/10000 (85.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 13, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3219/3851 (83.5887%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.6423, Accuracy: 8320/10000 (83.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  70, local model 14, internal_epoch   1,  Average loss: 0.0141, Accuracy: 2661/3110 (85.5627%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.9809, Accuracy: 7976/10000 (79.7600%), Attack Success Rate:0/10000(0.000)
time spent on training: 573.2773270606995
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.77426565 1.        ]
___Test Target_Simple poisoned: False, epoch: 70: Average loss: 1.1862, Accuracy: 7865/10000 (78.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 70: Average loss: 1.2438, Accuracy: 6407/8991 (71.2601%)
Done in 582.095219373703 sec.
Server Epoch:71 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  71, local model 0, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3274/3973 (82.4062%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.6182, Accuracy: 8501/10000 (85.0100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  71, local model 1, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2985/3656 (81.6466%), train_poison_data_count: 3656
Global model norm: 2.398682522761447.
Norm before scaling: 3.752768575370142. Distance: 2.008005689536921
Total norm for 5 adversaries is: 3.752768575370142. distance: 2.008005689536921
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.5249, Accuracy: 7942/8991 (88.3328%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  71, local model 2, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3184/3821 (83.3290%), train_poison_data_count: 3821
Global model norm: 2.398682522761447.
Norm before scaling: 3.7912420237652555. Distance: 2.00349799862622
Total norm for 5 adversaries is: 3.7912420237652555. distance: 2.00349799862622
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.5409, Accuracy: 7820/8991 (86.9759%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  71, local model 3, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3578/4319 (82.8433%), train_poison_data_count: 4319
Global model norm: 2.398682522761447.
Norm before scaling: 3.8513228088449933. Distance: 2.136772196936384
Total norm for 5 adversaries is: 3.8513228088449933. distance: 2.136772196936384
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.5389, Accuracy: 7837/8991 (87.1649%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  71, local model 4, internal_epoch   1,  Average loss: 0.0143, Accuracy: 3684/4396 (83.8035%), train_poison_data_count: 4396
Global model norm: 2.398682522761447.
Norm before scaling: 3.8780043245855085. Distance: 2.1518673793669976
Total norm for 5 adversaries is: 3.8780043245855085. distance: 2.1518673793669976
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.5177, Accuracy: 7842/8991 (87.2206%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  71, local model 5, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2744/3341 (82.1311%), train_poison_data_count: 3341
Global model norm: 2.398682522761447.
Norm before scaling: 3.677887235231075. Distance: 1.9152922747405066
Total norm for 5 adversaries is: 3.677887235231075. distance: 1.9152922747405066
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 0.5441, Accuracy: 7829/8991 (87.0760%)
___Train Local_Simple,  epoch  71, local model 6, internal_epoch   1,  Average loss: 0.0153, Accuracy: 4155/5024 (82.7030%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.5707, Accuracy: 8642/10000 (86.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 7, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2934/3641 (80.5823%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.6333, Accuracy: 8440/10000 (84.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 8, internal_epoch   1,  Average loss: 0.0149, Accuracy: 4001/4701 (85.1096%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.5843, Accuracy: 8640/10000 (86.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 9, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2703/3315 (81.5385%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.6301, Accuracy: 8577/10000 (85.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 10, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2823/3435 (82.1834%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.6405, Accuracy: 8581/10000 (85.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 11, internal_epoch   1,  Average loss: 0.0174, Accuracy: 3158/3917 (80.6229%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.6275, Accuracy: 8440/10000 (84.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3332/4069 (81.8874%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.6166, Accuracy: 8496/10000 (84.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 13, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3188/3851 (82.7837%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.6472, Accuracy: 8266/10000 (82.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  71, local model 14, internal_epoch   1,  Average loss: 0.0141, Accuracy: 2678/3110 (86.1093%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.9961, Accuracy: 7901/10000 (79.0100%), Attack Success Rate:0/10000(0.000)
time spent on training: 567.505450963974
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 71: Average loss: 1.1820, Accuracy: 7871/10000 (78.7100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 71: Average loss: 1.2402, Accuracy: 6405/8991 (71.2379%)
Done in 575.7938232421875 sec.
Server Epoch:72 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  72, local model 0, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3235/3973 (81.4246%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.6122, Accuracy: 8532/10000 (85.3200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  72, local model 1, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2954/3656 (80.7987%), train_poison_data_count: 3656
Global model norm: 2.4062341466604384.
Norm before scaling: 3.7609941174786465. Distance: 2.0078911079426045
Total norm for 5 adversaries is: 3.7609941174786465. distance: 2.0078911079426045
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.5343, Accuracy: 7927/8991 (88.1659%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  72, local model 2, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3189/3821 (83.4598%), train_poison_data_count: 3821
Global model norm: 2.4062341466604384.
Norm before scaling: 3.791166810564059. Distance: 1.988061859077989
Total norm for 5 adversaries is: 3.791166810564059. distance: 1.988061859077989
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.5452, Accuracy: 7787/8991 (86.6088%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  72, local model 3, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3553/4319 (82.2644%), train_poison_data_count: 4319
Global model norm: 2.4062341466604384.
Norm before scaling: 3.8601745518565322. Distance: 2.1354553839422312
Total norm for 5 adversaries is: 3.8601745518565322. distance: 2.1354553839422312
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.5338, Accuracy: 7878/8991 (87.6210%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  72, local model 4, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3687/4396 (83.8717%), train_poison_data_count: 4396
Global model norm: 2.4062341466604384.
Norm before scaling: 3.878102690873081. Distance: 2.1451011692544175
Total norm for 5 adversaries is: 3.878102690873081. distance: 2.1451011692544175
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.5089, Accuracy: 7913/8991 (88.0102%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  72, local model 5, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2743/3341 (82.1012%), train_poison_data_count: 3341
Global model norm: 2.4062341466604384.
Norm before scaling: 3.6721812019102607. Distance: 1.9099888016337512
Total norm for 5 adversaries is: 3.6721812019102607. distance: 1.9099888016337512
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 0.5490, Accuracy: 7865/8991 (87.4764%)
___Train Local_Simple,  epoch  72, local model 6, internal_epoch   1,  Average loss: 0.0153, Accuracy: 4173/5024 (83.0613%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.5679, Accuracy: 8666/10000 (86.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 7, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2919/3641 (80.1703%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.6394, Accuracy: 8387/10000 (83.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 8, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3989/4701 (84.8543%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.5915, Accuracy: 8587/10000 (85.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 9, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2693/3315 (81.2368%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.6297, Accuracy: 8617/10000 (86.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 10, internal_epoch   1,  Average loss: 0.0170, Accuracy: 2825/3435 (82.2416%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.6346, Accuracy: 8601/10000 (86.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 11, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3139/3917 (80.1379%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.6092, Accuracy: 8552/10000 (85.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 12, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3341/4069 (82.1086%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.6010, Accuracy: 8565/10000 (85.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 13, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3216/3851 (83.5108%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.6305, Accuracy: 8360/10000 (83.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  72, local model 14, internal_epoch   1,  Average loss: 0.0141, Accuracy: 2670/3110 (85.8521%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.9960, Accuracy: 7869/10000 (78.6900%), Attack Success Rate:0/10000(0.000)
time spent on training: 563.8898103237152
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 72: Average loss: 1.1781, Accuracy: 7873/10000 (78.7300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 72: Average loss: 1.2369, Accuracy: 6404/8991 (71.2268%)
Done in 572.2070209980011 sec.
Server Epoch:73 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  73, local model 0, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3287/3973 (82.7335%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.6099, Accuracy: 8551/10000 (85.5100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  73, local model 1, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2996/3656 (81.9475%), train_poison_data_count: 3656
Global model norm: 2.413754934328588.
Norm before scaling: 3.761252115844253. Distance: 1.9999957680657436
Total norm for 5 adversaries is: 3.761252115844253. distance: 1.9999957680657436
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.5284, Accuracy: 7912/8991 (87.9991%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  73, local model 2, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3169/3821 (82.9364%), train_poison_data_count: 3821
Global model norm: 2.413754934328588.
Norm before scaling: 3.7847485711505557. Distance: 1.9741655977352797
Total norm for 5 adversaries is: 3.7847485711505557. distance: 1.9741655977352797
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.5474, Accuracy: 7731/8991 (85.9860%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  73, local model 3, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3566/4319 (82.5654%), train_poison_data_count: 4319
Global model norm: 2.413754934328588.
Norm before scaling: 3.8584484887841364. Distance: 2.119972564951599
Total norm for 5 adversaries is: 3.8584484887841364. distance: 2.119972564951599
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.5335, Accuracy: 7870/8991 (87.5320%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  73, local model 4, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3719/4396 (84.5996%), train_poison_data_count: 4396
Global model norm: 2.413754934328588.
Norm before scaling: 3.887952384508028. Distance: 2.1484459339323094
Total norm for 5 adversaries is: 3.887952384508028. distance: 2.1484459339323094
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.5135, Accuracy: 7924/8991 (88.1326%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  73, local model 5, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2748/3341 (82.2508%), train_poison_data_count: 3341
Global model norm: 2.413754934328588.
Norm before scaling: 3.6791496774721146. Distance: 1.9015553307378525
Total norm for 5 adversaries is: 3.6791496774721146. distance: 1.9015553307378525
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 0.5559, Accuracy: 7787/8991 (86.6088%)
___Train Local_Simple,  epoch  73, local model 6, internal_epoch   1,  Average loss: 0.0153, Accuracy: 4172/5024 (83.0414%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.5763, Accuracy: 8557/10000 (85.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 7, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2951/3641 (81.0492%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.6254, Accuracy: 8465/10000 (84.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 8, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3988/4701 (84.8330%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.5896, Accuracy: 8617/10000 (86.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 9, internal_epoch   1,  Average loss: 0.0179, Accuracy: 2691/3315 (81.1765%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.6390, Accuracy: 8467/10000 (84.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 10, internal_epoch   1,  Average loss: 0.0170, Accuracy: 2808/3435 (81.7467%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.6318, Accuracy: 8554/10000 (85.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 11, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3172/3917 (80.9803%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.6158, Accuracy: 8452/10000 (84.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 12, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3294/4069 (80.9536%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.6090, Accuracy: 8551/10000 (85.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 13, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3208/3851 (83.3030%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.6427, Accuracy: 8315/10000 (83.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  73, local model 14, internal_epoch   1,  Average loss: 0.0139, Accuracy: 2680/3110 (86.1736%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.9948, Accuracy: 7838/10000 (78.3800%), Attack Success Rate:0/10000(0.000)
time spent on training: 574.4665946960449
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 73: Average loss: 1.1661, Accuracy: 7894/10000 (78.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 73: Average loss: 1.2261, Accuracy: 6417/8991 (71.3714%)
Done in 582.681289434433 sec.
Server Epoch:74 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  74, local model 0, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3267/3973 (82.2301%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.6111, Accuracy: 8579/10000 (85.7900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  74, local model 1, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3008/3656 (82.2757%), train_poison_data_count: 3656
Global model norm: 2.430273151037464.
Norm before scaling: 3.767907681445823. Distance: 1.9835049982337298
Total norm for 5 adversaries is: 3.767907681445823. distance: 1.9835049982337298
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.5256, Accuracy: 7933/8991 (88.2327%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  74, local model 2, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3187/3821 (83.4075%), train_poison_data_count: 3821
Global model norm: 2.430273151037464.
Norm before scaling: 3.7983581409143596. Distance: 1.9628265522230788
Total norm for 5 adversaries is: 3.7983581409143596. distance: 1.9628265522230788
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.5643, Accuracy: 7630/8991 (84.8626%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  74, local model 3, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3564/4319 (82.5191%), train_poison_data_count: 4319
Global model norm: 2.430273151037464.
Norm before scaling: 3.870667897040154. Distance: 2.112113700623807
Total norm for 5 adversaries is: 3.870667897040154. distance: 2.112113700623807
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.5351, Accuracy: 7862/8991 (87.4430%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  74, local model 4, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3716/4396 (84.5314%), train_poison_data_count: 4396
Global model norm: 2.430273151037464.
Norm before scaling: 3.8930325699822217. Distance: 2.120650046571955
Total norm for 5 adversaries is: 3.8930325699822217. distance: 2.120650046571955
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.5208, Accuracy: 7784/8991 (86.5755%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  74, local model 5, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2728/3341 (81.6522%), train_poison_data_count: 3341
Global model norm: 2.430273151037464.
Norm before scaling: 3.680560160380108. Distance: 1.8886488367705214
Total norm for 5 adversaries is: 3.680560160380108. distance: 1.8886488367705214
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 0.5478, Accuracy: 7865/8991 (87.4764%)
___Train Local_Simple,  epoch  74, local model 6, internal_epoch   1,  Average loss: 0.0152, Accuracy: 4166/5024 (82.9220%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.5717, Accuracy: 8663/10000 (86.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 7, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2934/3641 (80.5823%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.6398, Accuracy: 8362/10000 (83.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 8, internal_epoch   1,  Average loss: 0.0148, Accuracy: 4010/4701 (85.3010%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.5834, Accuracy: 8624/10000 (86.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 9, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2718/3315 (81.9910%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.6390, Accuracy: 8523/10000 (85.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 10, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2822/3435 (82.1543%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.6383, Accuracy: 8574/10000 (85.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 11, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3180/3917 (81.1846%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.6053, Accuracy: 8589/10000 (85.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 12, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3338/4069 (82.0349%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.6090, Accuracy: 8517/10000 (85.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3240/3851 (84.1340%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.6574, Accuracy: 8160/10000 (81.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  74, local model 14, internal_epoch   1,  Average loss: 0.0139, Accuracy: 2677/3110 (86.0772%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.9928, Accuracy: 7867/10000 (78.6700%), Attack Success Rate:0/10000(0.000)
time spent on training: 545.9697353839874
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 74: Average loss: 1.1623, Accuracy: 7894/10000 (78.9400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 74: Average loss: 1.2230, Accuracy: 6415/8991 (71.3491%)
Done in 553.874844789505 sec.
Server Epoch:75 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  75, local model 0, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3254/3973 (81.9028%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.6025, Accuracy: 8648/10000 (86.4800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  75, local model 1, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2999/3656 (82.0295%), train_poison_data_count: 3656
Global model norm: 2.437819044311956.
Norm before scaling: 3.7757630694863487. Distance: 1.9866434782816957
Total norm for 5 adversaries is: 3.7757630694863487. distance: 1.9866434782816957
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.5254, Accuracy: 7929/8991 (88.1882%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  75, local model 2, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3166/3821 (82.8579%), train_poison_data_count: 3821
Global model norm: 2.437819044311956.
Norm before scaling: 3.801754927713714. Distance: 1.9632761714215365
Total norm for 5 adversaries is: 3.801754927713714. distance: 1.9632761714215365
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.5586, Accuracy: 7669/8991 (85.2964%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  75, local model 3, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3564/4319 (82.5191%), train_poison_data_count: 4319
Global model norm: 2.437819044311956.
Norm before scaling: 3.8672362045149544. Distance: 2.104942808121842
Total norm for 5 adversaries is: 3.8672362045149544. distance: 2.104942808121842
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.5456, Accuracy: 7816/8991 (86.9314%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  75, local model 4, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3729/4396 (84.8271%), train_poison_data_count: 4396
Global model norm: 2.437819044311956.
Norm before scaling: 3.896117963270083. Distance: 2.114847389108143
Total norm for 5 adversaries is: 3.896117963270083. distance: 2.114847389108143
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.5203, Accuracy: 7838/8991 (87.1761%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  75, local model 5, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2732/3341 (81.7719%), train_poison_data_count: 3341
Global model norm: 2.437819044311956.
Norm before scaling: 3.6826846476435176. Distance: 1.8895482551770353
Total norm for 5 adversaries is: 3.6826846476435176. distance: 1.8895482551770353
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 0.5516, Accuracy: 7892/8991 (87.7767%)
___Train Local_Simple,  epoch  75, local model 6, internal_epoch   1,  Average loss: 0.0151, Accuracy: 4173/5024 (83.0613%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.5699, Accuracy: 8577/10000 (85.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 7, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2968/3641 (81.5161%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.6236, Accuracy: 8529/10000 (85.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 8, internal_epoch   1,  Average loss: 0.0148, Accuracy: 4014/4701 (85.3861%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.5922, Accuracy: 8568/10000 (85.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 9, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2729/3315 (82.3228%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.6287, Accuracy: 8587/10000 (85.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 10, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2809/3435 (81.7758%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.6354, Accuracy: 8578/10000 (85.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 11, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3168/3917 (80.8782%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.6039, Accuracy: 8559/10000 (85.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 12, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3327/4069 (81.7646%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.6115, Accuracy: 8529/10000 (85.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 13, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3200/3851 (83.0953%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.6472, Accuracy: 8222/10000 (82.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  75, local model 14, internal_epoch   1,  Average loss: 0.0140, Accuracy: 2675/3110 (86.0129%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.9928, Accuracy: 7881/10000 (78.8100%), Attack Success Rate:0/10000(0.000)
time spent on training: 536.8855068683624
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 75: Average loss: 1.1586, Accuracy: 7896/10000 (78.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 75: Average loss: 1.2199, Accuracy: 6416/8991 (71.3602%)
Done in 544.8233926296234 sec.
Server Epoch:76 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  76, local model 0, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3280/3973 (82.5573%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.6206, Accuracy: 8486/10000 (84.8600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  76, local model 1, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2990/3656 (81.7834%), train_poison_data_count: 3656
Global model norm: 2.4452914398553967.
Norm before scaling: 3.7670960145060444. Distance: 1.9657627633582926
Total norm for 5 adversaries is: 3.7670960145060444. distance: 1.9657627633582926
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.5279, Accuracy: 7917/8991 (88.0547%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  76, local model 2, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3176/3821 (83.1196%), train_poison_data_count: 3821
Global model norm: 2.4452914398553967.
Norm before scaling: 3.801313655060628. Distance: 1.9495205999060405
Total norm for 5 adversaries is: 3.801313655060628. distance: 1.9495205999060405
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.5451, Accuracy: 7777/8991 (86.4976%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  76, local model 3, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3566/4319 (82.5654%), train_poison_data_count: 4319
Global model norm: 2.4452914398553967.
Norm before scaling: 3.8605667312915823. Distance: 2.0877640973998
Total norm for 5 adversaries is: 3.8605667312915823. distance: 2.0877640973998
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.5350, Accuracy: 7856/8991 (87.3763%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  76, local model 4, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3700/4396 (84.1674%), train_poison_data_count: 4396
Global model norm: 2.4452914398553967.
Norm before scaling: 3.9006383031182126. Distance: 2.1117711903577066
Total norm for 5 adversaries is: 3.9006383031182126. distance: 2.1117711903577066
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.5165, Accuracy: 7821/8991 (86.9870%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  76, local model 5, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2721/3341 (81.4427%), train_poison_data_count: 3341
Global model norm: 2.4452914398553967.
Norm before scaling: 3.6930509263965607. Distance: 1.8935448664488737
Total norm for 5 adversaries is: 3.6930509263965607. distance: 1.8935448664488737
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 0.5458, Accuracy: 7898/8991 (87.8434%)
___Train Local_Simple,  epoch  76, local model 6, internal_epoch   1,  Average loss: 0.0152, Accuracy: 4155/5024 (82.7030%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.5660, Accuracy: 8641/10000 (86.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 7, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2969/3641 (81.5435%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.6243, Accuracy: 8515/10000 (85.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 8, internal_epoch   1,  Average loss: 0.0147, Accuracy: 4000/4701 (85.0883%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.5813, Accuracy: 8659/10000 (86.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 9, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2688/3315 (81.0860%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.6334, Accuracy: 8450/10000 (84.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 10, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2797/3435 (81.4265%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.6308, Accuracy: 8630/10000 (86.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 11, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3172/3917 (80.9803%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.6065, Accuracy: 8541/10000 (85.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 12, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3331/4069 (81.8629%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.6381, Accuracy: 8342/10000 (83.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 13, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3232/3851 (83.9263%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.6515, Accuracy: 8181/10000 (81.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  76, local model 14, internal_epoch   1,  Average loss: 0.0138, Accuracy: 2694/3110 (86.6238%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.9923, Accuracy: 7843/10000 (78.4300%), Attack Success Rate:0/10000(0.000)
time spent on training: 543.6560916900635
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.24124978 1.        ]
___Test Target_Simple poisoned: False, epoch: 76: Average loss: 1.1533, Accuracy: 7904/10000 (79.0400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 76: Average loss: 1.2154, Accuracy: 6424/8991 (71.4492%)
Done in 551.6132776737213 sec.
Server Epoch:77 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  77, local model 0, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3283/3973 (82.6328%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.6157, Accuracy: 8551/10000 (85.5100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  77, local model 1, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2997/3656 (81.9748%), train_poison_data_count: 3656
Global model norm: 2.454900499957414.
Norm before scaling: 3.77345455947716. Distance: 1.9674081013604128
Total norm for 5 adversaries is: 3.77345455947716. distance: 1.9674081013604128
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.5381, Accuracy: 7878/8991 (87.6210%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  77, local model 2, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3179/3821 (83.1981%), train_poison_data_count: 3821
Global model norm: 2.454900499957414.
Norm before scaling: 3.806387331635158. Distance: 1.942813969280687
Total norm for 5 adversaries is: 3.806387331635158. distance: 1.942813969280687
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.5468, Accuracy: 7709/8991 (85.7413%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  77, local model 3, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3583/4319 (82.9590%), train_poison_data_count: 4319
Global model norm: 2.454900499957414.
Norm before scaling: 3.8739145050619403. Distance: 2.0866271746902956
Total norm for 5 adversaries is: 3.8739145050619403. distance: 2.0866271746902956
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.5258, Accuracy: 7886/8991 (87.7099%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  77, local model 4, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3700/4396 (84.1674%), train_poison_data_count: 4396
Global model norm: 2.454900499957414.
Norm before scaling: 3.8954087840336555. Distance: 2.101848823867586
Total norm for 5 adversaries is: 3.8954087840336555. distance: 2.101848823867586
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.5071, Accuracy: 7891/8991 (87.7655%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  77, local model 5, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2739/3341 (81.9814%), train_poison_data_count: 3341
Global model norm: 2.454900499957414.
Norm before scaling: 3.692139244975014. Distance: 1.8744458969257312
Total norm for 5 adversaries is: 3.692139244975014. distance: 1.8744458969257312
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 0.5406, Accuracy: 7928/8991 (88.1771%)
___Train Local_Simple,  epoch  77, local model 6, internal_epoch   1,  Average loss: 0.0151, Accuracy: 4179/5024 (83.1807%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.5633, Accuracy: 8674/10000 (86.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 7, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2956/3641 (81.1865%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.6381, Accuracy: 8360/10000 (83.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0147, Accuracy: 4007/4701 (85.2372%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.5784, Accuracy: 8655/10000 (86.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 9, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2700/3315 (81.4480%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.6235, Accuracy: 8647/10000 (86.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 10, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2847/3435 (82.8821%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.6364, Accuracy: 8599/10000 (85.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 11, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3174/3917 (81.0314%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.6120, Accuracy: 8513/10000 (85.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 12, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3333/4069 (81.9120%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.6116, Accuracy: 8534/10000 (85.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 13, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3225/3851 (83.7445%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.6568, Accuracy: 8207/10000 (82.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  77, local model 14, internal_epoch   1,  Average loss: 0.0137, Accuracy: 2670/3110 (85.8521%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.9955, Accuracy: 7773/10000 (77.7300%), Attack Success Rate:0/10000(0.000)
time spent on training: 550.9957633018494
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.85912054 1.        ]
___Test Target_Simple poisoned: False, epoch: 77: Average loss: 1.1442, Accuracy: 7905/10000 (79.0500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 77: Average loss: 1.2072, Accuracy: 6423/8991 (71.4381%)
Done in 558.9555644989014 sec.
Server Epoch:78 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  78, local model 0, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3304/3973 (83.1613%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.6083, Accuracy: 8550/10000 (85.5000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  78, local model 1, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3007/3656 (82.2484%), train_poison_data_count: 3656
Global model norm: 2.4697019455883185.
Norm before scaling: 3.7775421879430353. Distance: 1.9460630998682502
Total norm for 5 adversaries is: 3.7775421879430353. distance: 1.9460630998682502
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.5556, Accuracy: 7771/8991 (86.4309%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  78, local model 2, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3184/3821 (83.3290%), train_poison_data_count: 3821
Global model norm: 2.4697019455883185.
Norm before scaling: 3.813045275107487. Distance: 1.9336808002027517
Total norm for 5 adversaries is: 3.813045275107487. distance: 1.9336808002027517
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.5460, Accuracy: 7724/8991 (85.9081%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  78, local model 3, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3576/4319 (82.7969%), train_poison_data_count: 4319
Global model norm: 2.4697019455883185.
Norm before scaling: 3.8743739699146804. Distance: 2.070970999160542
Total norm for 5 adversaries is: 3.8743739699146804. distance: 2.070970999160542
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.5312, Accuracy: 7870/8991 (87.5320%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  78, local model 4, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3695/4396 (84.0537%), train_poison_data_count: 4396
Global model norm: 2.4697019455883185.
Norm before scaling: 3.9017706250649997. Distance: 2.087088849357474
Total norm for 5 adversaries is: 3.9017706250649997. distance: 2.087088849357474
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.5182, Accuracy: 7797/8991 (86.7201%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  78, local model 5, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2722/3341 (81.4726%), train_poison_data_count: 3341
Global model norm: 2.4697019455883185.
Norm before scaling: 3.695636888262657. Distance: 1.8600304994851273
Total norm for 5 adversaries is: 3.695636888262657. distance: 1.8600304994851273
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 0.5467, Accuracy: 7858/8991 (87.3985%)
___Train Local_Simple,  epoch  78, local model 6, internal_epoch   1,  Average loss: 0.0151, Accuracy: 4172/5024 (83.0414%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.5783, Accuracy: 8614/10000 (86.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 7, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2960/3641 (81.2963%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.6362, Accuracy: 8433/10000 (84.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 8, internal_epoch   1,  Average loss: 0.0148, Accuracy: 4020/4701 (85.5137%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.5807, Accuracy: 8647/10000 (86.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 9, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2691/3315 (81.1765%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.6276, Accuracy: 8586/10000 (85.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 10, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2811/3435 (81.8341%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.6309, Accuracy: 8589/10000 (85.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 11, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3180/3917 (81.1846%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.6144, Accuracy: 8506/10000 (85.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 12, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3320/4069 (81.5925%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.6259, Accuracy: 8405/10000 (84.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 13, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3219/3851 (83.5887%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.6528, Accuracy: 8196/10000 (81.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  78, local model 14, internal_epoch   1,  Average loss: 0.0136, Accuracy: 2686/3110 (86.3666%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.9717, Accuracy: 7978/10000 (79.7800%), Attack Success Rate:0/10000(0.000)
time spent on training: 556.9654026031494
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.73937964 1.        ]
___Test Target_Simple poisoned: False, epoch: 78: Average loss: 1.1358, Accuracy: 7914/10000 (79.1400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 78: Average loss: 1.2011, Accuracy: 6422/8991 (71.4270%)
Done in 564.913969039917 sec.
Server Epoch:79 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  79, local model 0, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3298/3973 (83.0103%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.6088, Accuracy: 8588/10000 (85.8800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  79, local model 1, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2979/3656 (81.4825%), train_poison_data_count: 3656
Global model norm: 2.483445959502794.
Norm before scaling: 3.775913476631557. Distance: 1.9361917939866382
Total norm for 5 adversaries is: 3.775913476631557. distance: 1.9361917939866382
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.5283, Accuracy: 7924/8991 (88.1326%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  79, local model 2, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3172/3821 (83.0149%), train_poison_data_count: 3821
Global model norm: 2.483445959502794.
Norm before scaling: 3.8160690111761713. Distance: 1.9165062077016437
Total norm for 5 adversaries is: 3.8160690111761713. distance: 1.9165062077016437
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.5501, Accuracy: 7710/8991 (85.7524%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  79, local model 3, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3576/4319 (82.7969%), train_poison_data_count: 4319
Global model norm: 2.483445959502794.
Norm before scaling: 3.883233582903198. Distance: 2.0621056613213034
Total norm for 5 adversaries is: 3.883233582903198. distance: 2.0621056613213034
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.5380, Accuracy: 7827/8991 (87.0537%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  79, local model 4, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3716/4396 (84.5314%), train_poison_data_count: 4396
Global model norm: 2.483445959502794.
Norm before scaling: 3.9014465094799142. Distance: 2.0632711182778505
Total norm for 5 adversaries is: 3.9014465094799142. distance: 2.0632711182778505
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.5170, Accuracy: 7782/8991 (86.5532%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  79, local model 5, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2742/3341 (82.0712%), train_poison_data_count: 3341
Global model norm: 2.483445959502794.
Norm before scaling: 3.700316575399828. Distance: 1.846287742750672
Total norm for 5 adversaries is: 3.700316575399828. distance: 1.846287742750672
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 0.5407, Accuracy: 7861/8991 (87.4319%)
___Train Local_Simple,  epoch  79, local model 6, internal_epoch   1,  Average loss: 0.0150, Accuracy: 4181/5024 (83.2205%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.5634, Accuracy: 8654/10000 (86.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 7, internal_epoch   1,  Average loss: 0.0164, Accuracy: 2974/3641 (81.6809%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.6329, Accuracy: 8382/10000 (83.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 8, internal_epoch   1,  Average loss: 0.0146, Accuracy: 4008/4701 (85.2585%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.5848, Accuracy: 8612/10000 (86.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 9, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2683/3315 (80.9351%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.6312, Accuracy: 8510/10000 (85.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 10, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2835/3435 (82.5328%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.6271, Accuracy: 8597/10000 (85.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 11, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3179/3917 (81.1591%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.6102, Accuracy: 8509/10000 (85.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 12, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3353/4069 (82.4035%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.6047, Accuracy: 8572/10000 (85.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 13, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3229/3851 (83.8484%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.6370, Accuracy: 8290/10000 (82.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  79, local model 14, internal_epoch   1,  Average loss: 0.0137, Accuracy: 2683/3110 (86.2701%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.9746, Accuracy: 7979/10000 (79.7900%), Attack Success Rate:0/10000(0.000)
time spent on training: 563.5535094738007
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 79: Average loss: 1.1325, Accuracy: 7913/10000 (79.1300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 79: Average loss: 1.1981, Accuracy: 6423/8991 (71.4381%)
Done in 571.4948139190674 sec.
Server Epoch:80 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  80, local model 0, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3280/3973 (82.5573%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.6065, Accuracy: 8572/10000 (85.7200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  80, local model 1, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3002/3656 (82.1116%), train_poison_data_count: 3656
Global model norm: 2.4908245509292626.
Norm before scaling: 3.782214711606789. Distance: 1.9309189299718243
Total norm for 5 adversaries is: 3.782214711606789. distance: 1.9309189299718243
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.5286, Accuracy: 7912/8991 (87.9991%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  80, local model 2, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3160/3821 (82.7009%), train_poison_data_count: 3821
Global model norm: 2.4908245509292626.
Norm before scaling: 3.820648615430413. Distance: 1.9179659530712485
Total norm for 5 adversaries is: 3.820648615430413. distance: 1.9179659530712485
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.5540, Accuracy: 7708/8991 (85.7302%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  80, local model 3, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3546/4319 (82.1023%), train_poison_data_count: 4319
Global model norm: 2.4908245509292626.
Norm before scaling: 3.876080147110445. Distance: 2.0573748865478083
Total norm for 5 adversaries is: 3.876080147110445. distance: 2.0573748865478083
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.5367, Accuracy: 7856/8991 (87.3763%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  80, local model 4, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3722/4396 (84.6679%), train_poison_data_count: 4396
Global model norm: 2.4908245509292626.
Norm before scaling: 3.9074884511395007. Distance: 2.0708502305055907
Total norm for 5 adversaries is: 3.9074884511395007. distance: 2.0708502305055907
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.5096, Accuracy: 7863/8991 (87.4541%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  80, local model 5, internal_epoch   1,  Average loss: 0.0164, Accuracy: 2750/3341 (82.3107%), train_poison_data_count: 3341
Global model norm: 2.4908245509292626.
Norm before scaling: 3.701719765887025. Distance: 1.8454083242577362
Total norm for 5 adversaries is: 3.701719765887025. distance: 1.8454083242577362
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 0.5391, Accuracy: 7892/8991 (87.7767%)
___Train Local_Simple,  epoch  80, local model 6, internal_epoch   1,  Average loss: 0.0150, Accuracy: 4199/5024 (83.5788%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.5712, Accuracy: 8561/10000 (85.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 7, internal_epoch   1,  Average loss: 0.0164, Accuracy: 2971/3641 (81.5985%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.6346, Accuracy: 8385/10000 (83.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 8, internal_epoch   1,  Average loss: 0.0147, Accuracy: 4009/4701 (85.2797%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.5783, Accuracy: 8645/10000 (86.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 9, internal_epoch   1,  Average loss: 0.0174, Accuracy: 2717/3315 (81.9608%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.6391, Accuracy: 8482/10000 (84.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 10, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2827/3435 (82.2999%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.6250, Accuracy: 8657/10000 (86.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 11, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3197/3917 (81.6186%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.6201, Accuracy: 8454/10000 (84.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 12, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3322/4069 (81.6417%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.6249, Accuracy: 8402/10000 (84.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 13, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3253/3851 (84.4716%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.6243, Accuracy: 8408/10000 (84.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  80, local model 14, internal_epoch   1,  Average loss: 0.0137, Accuracy: 2674/3110 (85.9807%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.9821, Accuracy: 7866/10000 (78.6600%), Attack Success Rate:0/10000(0.000)
time spent on training: 570.3405182361603
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.65232631 1.        ]
___Test Target_Simple poisoned: False, epoch: 80: Average loss: 1.1247, Accuracy: 7914/10000 (79.1400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 80: Average loss: 1.1907, Accuracy: 6423/8991 (71.4381%)
Done in 578.2696838378906 sec.
Server Epoch:81 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  81, local model 0, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3265/3973 (82.1797%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.6121, Accuracy: 8512/10000 (85.1200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  81, local model 1, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3007/3656 (82.2484%), train_poison_data_count: 3656
Global model norm: 2.5035742957730585.
Norm before scaling: 3.799645939444453. Distance: 1.9393137164303416
Total norm for 5 adversaries is: 3.799645939444453. distance: 1.9393137164303416
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.5262, Accuracy: 7925/8991 (88.1437%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  81, local model 2, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3196/3821 (83.6430%), train_poison_data_count: 3821
Global model norm: 2.5035742957730585.
Norm before scaling: 3.8199180602228116. Distance: 1.8991008588574323
Total norm for 5 adversaries is: 3.8199180602228116. distance: 1.8991008588574323
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.5368, Accuracy: 7772/8991 (86.4420%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  81, local model 3, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3594/4319 (83.2137%), train_poison_data_count: 4319
Global model norm: 2.5035742957730585.
Norm before scaling: 3.8871895816422346. Distance: 2.043787017393701
Total norm for 5 adversaries is: 3.8871895816422346. distance: 2.043787017393701
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.5325, Accuracy: 7865/8991 (87.4764%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  81, local model 4, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3710/4396 (84.3949%), train_poison_data_count: 4396
Global model norm: 2.5035742957730585.
Norm before scaling: 3.919130497275549. Distance: 2.069477877535276
Total norm for 5 adversaries is: 3.919130497275549. distance: 2.069477877535276
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.5039, Accuracy: 7928/8991 (88.1771%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  81, local model 5, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2744/3341 (82.1311%), train_poison_data_count: 3341
Global model norm: 2.5035742957730585.
Norm before scaling: 3.69941544941338. Distance: 1.823779753768458
Total norm for 5 adversaries is: 3.69941544941338. distance: 1.823779753768458
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 0.5414, Accuracy: 7862/8991 (87.4430%)
___Train Local_Simple,  epoch  81, local model 6, internal_epoch   1,  Average loss: 0.0149, Accuracy: 4172/5024 (83.0414%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.5609, Accuracy: 8671/10000 (86.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 7, internal_epoch   1,  Average loss: 0.0164, Accuracy: 2975/3641 (81.7083%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.6333, Accuracy: 8449/10000 (84.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 8, internal_epoch   1,  Average loss: 0.0145, Accuracy: 4012/4701 (85.3435%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.5825, Accuracy: 8646/10000 (86.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 9, internal_epoch   1,  Average loss: 0.0174, Accuracy: 2697/3315 (81.3575%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.6210, Accuracy: 8591/10000 (85.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 10, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2836/3435 (82.5619%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.6189, Accuracy: 8643/10000 (86.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 11, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3156/3917 (80.5719%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.6042, Accuracy: 8600/10000 (86.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 12, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3316/4069 (81.4942%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.6212, Accuracy: 8406/10000 (84.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 13, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3230/3851 (83.8743%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.6471, Accuracy: 8167/10000 (81.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  81, local model 14, internal_epoch   1,  Average loss: 0.0135, Accuracy: 2676/3110 (86.0450%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.9730, Accuracy: 7963/10000 (79.6300%), Attack Success Rate:0/10000(0.000)
time spent on training: 577.2251913547516
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 81: Average loss: 1.1158, Accuracy: 7922/10000 (79.2200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 81: Average loss: 1.1828, Accuracy: 6426/8991 (71.4715%)
Done in 585.173237323761 sec.
Server Epoch:82 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  82, local model 0, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3282/3973 (82.6076%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.6097, Accuracy: 8564/10000 (85.6400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  82, local model 1, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2993/3656 (81.8654%), train_poison_data_count: 3656
Global model norm: 2.519581213167397.
Norm before scaling: 3.795739902947466. Distance: 1.917292458195806
Total norm for 5 adversaries is: 3.795739902947466. distance: 1.917292458195806
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.5295, Accuracy: 7919/8991 (88.0770%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  82, local model 2, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3179/3821 (83.1981%), train_poison_data_count: 3821
Global model norm: 2.519581213167397.
Norm before scaling: 3.821491207836897. Distance: 1.882625396422508
Total norm for 5 adversaries is: 3.821491207836897. distance: 1.882625396422508
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.5504, Accuracy: 7717/8991 (85.8303%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  82, local model 3, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3590/4319 (83.1211%), train_poison_data_count: 4319
Global model norm: 2.519581213167397.
Norm before scaling: 3.8867154375378474. Distance: 2.030648597305434
Total norm for 5 adversaries is: 3.8867154375378474. distance: 2.030648597305434
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.5270, Accuracy: 7893/8991 (87.7878%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  82, local model 4, internal_epoch   1,  Average loss: 0.0138, Accuracy: 3702/4396 (84.2129%), train_poison_data_count: 4396
Global model norm: 2.519581213167397.
Norm before scaling: 3.9187099862375363. Distance: 2.051989971173562
Total norm for 5 adversaries is: 3.9187099862375363. distance: 2.051989971173562
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.5096, Accuracy: 7872/8991 (87.5542%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  82, local model 5, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2735/3341 (81.8617%), train_poison_data_count: 3341
Global model norm: 2.519581213167397.
Norm before scaling: 3.7186338262283014. Distance: 1.825525963123495
Total norm for 5 adversaries is: 3.7186338262283014. distance: 1.825525963123495
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 0.5381, Accuracy: 7882/8991 (87.6654%)
___Train Local_Simple,  epoch  82, local model 6, internal_epoch   1,  Average loss: 0.0149, Accuracy: 4186/5024 (83.3201%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.5617, Accuracy: 8664/10000 (86.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 7, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2966/3641 (81.4611%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.6227, Accuracy: 8508/10000 (85.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 8, internal_epoch   1,  Average loss: 0.0145, Accuracy: 4028/4701 (85.6839%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.5742, Accuracy: 8649/10000 (86.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 9, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2697/3315 (81.3575%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.6154, Accuracy: 8615/10000 (86.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 10, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2822/3435 (82.1543%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.6212, Accuracy: 8655/10000 (86.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 11, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3174/3917 (81.0314%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.6076, Accuracy: 8545/10000 (85.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 12, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3358/4069 (82.5264%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.6193, Accuracy: 8427/10000 (84.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 13, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3238/3851 (84.0821%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.6398, Accuracy: 8328/10000 (83.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  82, local model 14, internal_epoch   1,  Average loss: 0.0134, Accuracy: 2702/3110 (86.8810%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.9655, Accuracy: 7982/10000 (79.8200%), Attack Success Rate:0/10000(0.000)
time spent on training: 584.1750130653381
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 82: Average loss: 1.1128, Accuracy: 7923/10000 (79.2300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 82: Average loss: 1.1804, Accuracy: 6423/8991 (71.4381%)
Done in 592.1893398761749 sec.
Server Epoch:83 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  83, local model 0, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3298/3973 (83.0103%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.6063, Accuracy: 8574/10000 (85.7400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  83, local model 1, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3005/3656 (82.1937%), train_poison_data_count: 3656
Global model norm: 2.526954019439912.
Norm before scaling: 3.793541092124766. Distance: 1.9045125203420876
Total norm for 5 adversaries is: 3.793541092124766. distance: 1.9045125203420876
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.5202, Accuracy: 7931/8991 (88.2104%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  83, local model 2, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3195/3821 (83.6169%), train_poison_data_count: 3821
Global model norm: 2.526954019439912.
Norm before scaling: 3.817926141303257. Distance: 1.8759592145825617
Total norm for 5 adversaries is: 3.817926141303257. distance: 1.8759592145825617
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.5440, Accuracy: 7835/8991 (87.1427%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  83, local model 3, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3604/4319 (83.4452%), train_poison_data_count: 4319
Global model norm: 2.526954019439912.
Norm before scaling: 3.888836798243349. Distance: 2.022771070160094
Total norm for 5 adversaries is: 3.888836798243349. distance: 2.022771070160094
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.5293, Accuracy: 7866/8991 (87.4875%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  83, local model 4, internal_epoch   1,  Average loss: 0.0138, Accuracy: 3722/4396 (84.6679%), train_poison_data_count: 4396
Global model norm: 2.526954019439912.
Norm before scaling: 3.9153837307748405. Distance: 2.0456608090295334
Total norm for 5 adversaries is: 3.9153837307748405. distance: 2.0456608090295334
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.5142, Accuracy: 7887/8991 (87.7211%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  83, local model 5, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2738/3341 (81.9515%), train_poison_data_count: 3341
Global model norm: 2.526954019439912.
Norm before scaling: 3.719159272055711. Distance: 1.8202106627436692
Total norm for 5 adversaries is: 3.719159272055711. distance: 1.8202106627436692
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 0.5437, Accuracy: 7884/8991 (87.6877%)
___Train Local_Simple,  epoch  83, local model 6, internal_epoch   1,  Average loss: 0.0148, Accuracy: 4190/5024 (83.3997%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.5602, Accuracy: 8633/10000 (86.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 7, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2973/3641 (81.6534%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.6139, Accuracy: 8530/10000 (85.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 8, internal_epoch   1,  Average loss: 0.0144, Accuracy: 4011/4701 (85.3223%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.5771, Accuracy: 8635/10000 (86.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 9, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2708/3315 (81.6893%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.6205, Accuracy: 8536/10000 (85.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 10, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2849/3435 (82.9403%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.6319, Accuracy: 8620/10000 (86.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 11, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3173/3917 (81.0059%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.6024, Accuracy: 8556/10000 (85.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 12, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3354/4069 (82.4281%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.6151, Accuracy: 8478/10000 (84.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 13, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3235/3851 (84.0042%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.6355, Accuracy: 8275/10000 (82.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  83, local model 14, internal_epoch   1,  Average loss: 0.0134, Accuracy: 2691/3110 (86.5273%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.9707, Accuracy: 7966/10000 (79.6600%), Attack Success Rate:0/10000(0.000)
time spent on training: 590.4290118217468
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.85911824 1.        ]
___Test Target_Simple poisoned: False, epoch: 83: Average loss: 1.1051, Accuracy: 7920/10000 (79.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 83: Average loss: 1.1733, Accuracy: 6428/8991 (71.4937%)
Done in 598.4890177249908 sec.
Server Epoch:84 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  84, local model 0, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3316/3973 (83.4634%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.6035, Accuracy: 8561/10000 (85.6100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  84, local model 1, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2996/3656 (81.9475%), train_poison_data_count: 3656
Global model norm: 2.5416605172838542.
Norm before scaling: 3.797120011826899. Distance: 1.8853156833757752
Total norm for 5 adversaries is: 3.797120011826899. distance: 1.8853156833757752
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.5309, Accuracy: 7859/8991 (87.4096%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  84, local model 2, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3179/3821 (83.1981%), train_poison_data_count: 3821
Global model norm: 2.5416605172838542.
Norm before scaling: 3.8313436873215143. Distance: 1.8638844663236211
Total norm for 5 adversaries is: 3.8313436873215143. distance: 1.8638844663236211
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.5372, Accuracy: 7773/8991 (86.4531%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  84, local model 3, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3603/4319 (83.4221%), train_poison_data_count: 4319
Global model norm: 2.5416605172838542.
Norm before scaling: 3.896741356657328. Distance: 2.013380116472844
Total norm for 5 adversaries is: 3.896741356657328. distance: 2.013380116472844
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.5291, Accuracy: 7863/8991 (87.4541%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  84, local model 4, internal_epoch   1,  Average loss: 0.0138, Accuracy: 3695/4396 (84.0537%), train_poison_data_count: 4396
Global model norm: 2.5416605172838542.
Norm before scaling: 3.9287272013707604. Distance: 2.0326521508956046
Total norm for 5 adversaries is: 3.9287272013707604. distance: 2.0326521508956046
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.5152, Accuracy: 7798/8991 (86.7312%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  84, local model 5, internal_epoch   1,  Average loss: 0.0162, Accuracy: 2745/3341 (82.1610%), train_poison_data_count: 3341
Global model norm: 2.5416605172838542.
Norm before scaling: 3.716703476887472. Distance: 1.795478543537105
Total norm for 5 adversaries is: 3.716703476887472. distance: 1.795478543537105
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 0.5338, Accuracy: 7890/8991 (87.7544%)
___Train Local_Simple,  epoch  84, local model 6, internal_epoch   1,  Average loss: 0.0148, Accuracy: 4175/5024 (83.1011%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.5670, Accuracy: 8583/10000 (85.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 7, internal_epoch   1,  Average loss: 0.0162, Accuracy: 2994/3641 (82.2302%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.6166, Accuracy: 8540/10000 (85.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 8, internal_epoch   1,  Average loss: 0.0144, Accuracy: 4010/4701 (85.3010%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.5803, Accuracy: 8641/10000 (86.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 9, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2704/3315 (81.5686%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.6184, Accuracy: 8618/10000 (86.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 10, internal_epoch   1,  Average loss: 0.0164, Accuracy: 2822/3435 (82.1543%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.6195, Accuracy: 8656/10000 (86.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 11, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3181/3917 (81.2101%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.6084, Accuracy: 8523/10000 (85.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 12, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3345/4069 (82.2069%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.5995, Accuracy: 8513/10000 (85.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 13, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3248/3851 (84.3417%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.6196, Accuracy: 8431/10000 (84.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  84, local model 14, internal_epoch   1,  Average loss: 0.0133, Accuracy: 2702/3110 (86.8810%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.9556, Accuracy: 8028/10000 (80.2800%), Attack Success Rate:0/10000(0.000)
time spent on training: 597.5966591835022
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 84: Average loss: 1.0961, Accuracy: 7931/10000 (79.3100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 84: Average loss: 1.1653, Accuracy: 6433/8991 (71.5493%)
Done in 605.5932364463806 sec.
Server Epoch:85 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  85, local model 0, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3318/3973 (83.5137%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.6114, Accuracy: 8531/10000 (85.3100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  85, local model 1, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3004/3656 (82.1663%), train_poison_data_count: 3656
Global model norm: 2.557408368360641.
Norm before scaling: 3.807752937035752. Distance: 1.881039683096275
Total norm for 5 adversaries is: 3.807752937035752. distance: 1.881039683096275
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.5274, Accuracy: 7905/8991 (87.9213%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  85, local model 2, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3186/3821 (83.3813%), train_poison_data_count: 3821
Global model norm: 2.557408368360641.
Norm before scaling: 3.8382541474624494. Distance: 1.8594774490470176
Total norm for 5 adversaries is: 3.8382541474624494. distance: 1.8594774490470176
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.5358, Accuracy: 7812/8991 (86.8869%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  85, local model 3, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3582/4319 (82.9359%), train_poison_data_count: 4319
Global model norm: 2.557408368360641.
Norm before scaling: 3.8997054551233417. Distance: 2.0016572761580065
Total norm for 5 adversaries is: 3.8997054551233417. distance: 2.0016572761580065
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.5212, Accuracy: 7919/8991 (88.0770%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  85, local model 4, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3706/4396 (84.3039%), train_poison_data_count: 4396
Global model norm: 2.557408368360641.
Norm before scaling: 3.924644556169762. Distance: 2.002811482334459
Total norm for 5 adversaries is: 3.924644556169762. distance: 2.002811482334459
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.5152, Accuracy: 7795/8991 (86.6978%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  85, local model 5, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2756/3341 (82.4903%), train_poison_data_count: 3341
Global model norm: 2.557408368360641.
Norm before scaling: 3.7305620591242734. Distance: 1.799379013814951
Total norm for 5 adversaries is: 3.7305620591242734. distance: 1.799379013814951
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 0.5345, Accuracy: 7896/8991 (87.8212%)
___Train Local_Simple,  epoch  85, local model 6, internal_epoch   1,  Average loss: 0.0147, Accuracy: 4196/5024 (83.5191%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.5576, Accuracy: 8625/10000 (86.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 7, internal_epoch   1,  Average loss: 0.0162, Accuracy: 2960/3641 (81.2963%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.6391, Accuracy: 8330/10000 (83.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 8, internal_epoch   1,  Average loss: 0.0144, Accuracy: 4029/4701 (85.7052%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.5784, Accuracy: 8646/10000 (86.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 9, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2701/3315 (81.4781%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.6258, Accuracy: 8536/10000 (85.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 10, internal_epoch   1,  Average loss: 0.0162, Accuracy: 2848/3435 (82.9112%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.6206, Accuracy: 8659/10000 (86.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 11, internal_epoch   1,  Average loss: 0.0166, Accuracy: 3172/3917 (80.9803%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.6024, Accuracy: 8618/10000 (86.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 12, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3344/4069 (82.1824%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.5927, Accuracy: 8617/10000 (86.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3246/3851 (84.2898%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.6281, Accuracy: 8371/10000 (83.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  85, local model 14, internal_epoch   1,  Average loss: 0.0133, Accuracy: 2687/3110 (86.3987%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.9608, Accuracy: 7972/10000 (79.7200%), Attack Success Rate:0/10000(0.000)
time spent on training: 603.770899772644
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
 0.00000000e+00 6.08008508e-04 1.00000000e+00]
___Test Target_Simple poisoned: False, epoch: 85: Average loss: 1.0930, Accuracy: 7936/10000 (79.3600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 85: Average loss: 1.1630, Accuracy: 6435/8991 (71.5716%)
Done in 611.769365310669 sec.
Server Epoch:86 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  86, local model 0, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3304/3973 (83.1613%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.5995, Accuracy: 8596/10000 (85.9600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  86, local model 1, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3001/3656 (82.0842%), train_poison_data_count: 3656
Global model norm: 2.564746895064343.
Norm before scaling: 3.8081443795393946. Distance: 1.878757589887058
Total norm for 5 adversaries is: 3.8081443795393946. distance: 1.878757589887058
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.5268, Accuracy: 7909/8991 (87.9657%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  86, local model 2, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3205/3821 (83.8786%), train_poison_data_count: 3821
Global model norm: 2.564746895064343.
Norm before scaling: 3.8357942946792325. Distance: 1.8387373332942962
Total norm for 5 adversaries is: 3.8357942946792325. distance: 1.8387373332942962
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.5476, Accuracy: 7711/8991 (85.7635%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  86, local model 3, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3584/4319 (82.9822%), train_poison_data_count: 4319
Global model norm: 2.564746895064343.
Norm before scaling: 3.8988828232703128. Distance: 1.9902015511124227
Total norm for 5 adversaries is: 3.8988828232703128. distance: 1.9902015511124227
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.5280, Accuracy: 7870/8991 (87.5320%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  86, local model 4, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3712/4396 (84.4404%), train_poison_data_count: 4396
Global model norm: 2.564746895064343.
Norm before scaling: 3.9240800350399234. Distance: 2.0014168965537977
Total norm for 5 adversaries is: 3.9240800350399234. distance: 2.0014168965537977
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.5199, Accuracy: 7781/8991 (86.5421%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  86, local model 5, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2735/3341 (81.8617%), train_poison_data_count: 3341
Global model norm: 2.564746895064343.
Norm before scaling: 3.7210240183144543. Distance: 1.7795241846133076
Total norm for 5 adversaries is: 3.7210240183144543. distance: 1.7795241846133076
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 0.5387, Accuracy: 7889/8991 (87.7433%)
___Train Local_Simple,  epoch  86, local model 6, internal_epoch   1,  Average loss: 0.0147, Accuracy: 4179/5024 (83.1807%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.5641, Accuracy: 8632/10000 (86.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 7, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2972/3641 (81.6259%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.6293, Accuracy: 8456/10000 (84.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 8, internal_epoch   1,  Average loss: 0.0143, Accuracy: 4015/4701 (85.4074%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.5722, Accuracy: 8665/10000 (86.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 9, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2709/3315 (81.7195%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.6229, Accuracy: 8496/10000 (84.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 10, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2836/3435 (82.5619%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.6230, Accuracy: 8652/10000 (86.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 11, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3172/3917 (80.9803%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.6048, Accuracy: 8598/10000 (85.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 12, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3358/4069 (82.5264%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.5961, Accuracy: 8586/10000 (85.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 13, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3255/3851 (84.5235%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.6311, Accuracy: 8263/10000 (82.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  86, local model 14, internal_epoch   1,  Average loss: 0.0131, Accuracy: 2707/3110 (87.0418%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.9590, Accuracy: 7996/10000 (79.9600%), Attack Success Rate:0/10000(0.000)
time spent on training: 611.259334564209
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.54180621 1.        ]
___Test Target_Simple poisoned: False, epoch: 86: Average loss: 1.0870, Accuracy: 7945/10000 (79.4500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 86: Average loss: 1.1588, Accuracy: 6433/8991 (71.5493%)
Done in 619.2202384471893 sec.
Server Epoch:87 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  87, local model 0, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3319/3973 (83.5389%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.6016, Accuracy: 8555/10000 (85.5500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  87, local model 1, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2977/3656 (81.4278%), train_poison_data_count: 3656
Global model norm: 2.576603110822123.
Norm before scaling: 3.8157948499112067. Distance: 1.8778742694265482
Total norm for 5 adversaries is: 3.8157948499112067. distance: 1.8778742694265482
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.5189, Accuracy: 7947/8991 (88.3884%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  87, local model 2, internal_epoch   1,  Average loss: 0.0145, Accuracy: 3190/3821 (83.4860%), train_poison_data_count: 3821
Global model norm: 2.576603110822123.
Norm before scaling: 3.841280508320567. Distance: 1.836313022599299
Total norm for 5 adversaries is: 3.841280508320567. distance: 1.836313022599299
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.5487, Accuracy: 7712/8991 (85.7747%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  87, local model 3, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3588/4319 (83.0748%), train_poison_data_count: 4319
Global model norm: 2.576603110822123.
Norm before scaling: 3.905857157980794. Distance: 1.9872016898793023
Total norm for 5 adversaries is: 3.905857157980794. distance: 1.9872016898793023
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.5232, Accuracy: 7878/8991 (87.6210%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  87, local model 4, internal_epoch   1,  Average loss: 0.0136, Accuracy: 3738/4396 (85.0318%), train_poison_data_count: 4396
Global model norm: 2.576603110822123.
Norm before scaling: 3.9392035296023784. Distance: 1.9996373920747044
Total norm for 5 adversaries is: 3.9392035296023784. distance: 1.9996373920747044
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.5086, Accuracy: 7871/8991 (87.5431%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  87, local model 5, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2760/3341 (82.6100%), train_poison_data_count: 3341
Global model norm: 2.576603110822123.
Norm before scaling: 3.7251347459833477. Distance: 1.7805407266434092
Total norm for 5 adversaries is: 3.7251347459833477. distance: 1.7805407266434092
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 0.5435, Accuracy: 7926/8991 (88.1548%)
___Train Local_Simple,  epoch  87, local model 6, internal_epoch   1,  Average loss: 0.0147, Accuracy: 4181/5024 (83.2205%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.5585, Accuracy: 8672/10000 (86.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 7, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2973/3641 (81.6534%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.6283, Accuracy: 8431/10000 (84.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 8, internal_epoch   1,  Average loss: 0.0144, Accuracy: 4038/4701 (85.8966%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.5756, Accuracy: 8636/10000 (86.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 9, internal_epoch   1,  Average loss: 0.0170, Accuracy: 2705/3315 (81.5988%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.6248, Accuracy: 8478/10000 (84.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 10, internal_epoch   1,  Average loss: 0.0162, Accuracy: 2815/3435 (81.9505%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.6178, Accuracy: 8638/10000 (86.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 11, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3212/3917 (82.0015%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.6044, Accuracy: 8489/10000 (84.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 12, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3334/4069 (81.9366%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.6099, Accuracy: 8491/10000 (84.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 13, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3205/3851 (83.2251%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.6289, Accuracy: 8333/10000 (83.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  87, local model 14, internal_epoch   1,  Average loss: 0.0131, Accuracy: 2693/3110 (86.5916%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.9603, Accuracy: 8010/10000 (80.1000%), Attack Success Rate:0/10000(0.000)
time spent on training: 618.0556933879852
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.27338755 0.         0.         0.
 0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 87: Average loss: 1.0773, Accuracy: 7947/10000 (79.4700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 87: Average loss: 1.1504, Accuracy: 6428/8991 (71.4937%)
Done in 626.0158536434174 sec.
Server Epoch:88 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  88, local model 0, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3302/3973 (83.1110%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.6097, Accuracy: 8582/10000 (85.8200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  88, local model 1, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3027/3656 (82.7954%), train_poison_data_count: 3656
Global model norm: 2.5944396791089894.
Norm before scaling: 3.827392258874951. Distance: 1.8630676147059029
Total norm for 5 adversaries is: 3.827392258874951. distance: 1.8630676147059029
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.5150, Accuracy: 7931/8991 (88.2104%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  88, local model 2, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3214/3821 (84.1141%), train_poison_data_count: 3821
Global model norm: 2.5944396791089894.
Norm before scaling: 3.848967693697741. Distance: 1.8145112027337256
Total norm for 5 adversaries is: 3.848967693697741. distance: 1.8145112027337256
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.5307, Accuracy: 7793/8991 (86.6756%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  88, local model 3, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3600/4319 (83.3526%), train_poison_data_count: 4319
Global model norm: 2.5944396791089894.
Norm before scaling: 3.9186554722435147. Distance: 1.9776494953733064
Total norm for 5 adversaries is: 3.9186554722435147. distance: 1.9776494953733064
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.5343, Accuracy: 7870/8991 (87.5320%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  88, local model 4, internal_epoch   1,  Average loss: 0.0136, Accuracy: 3723/4396 (84.6906%), train_poison_data_count: 4396
Global model norm: 2.5944396791089894.
Norm before scaling: 3.936634392429737. Distance: 1.9876156275481272
Total norm for 5 adversaries is: 3.936634392429737. distance: 1.9876156275481272
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.5046, Accuracy: 7880/8991 (87.6432%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  88, local model 5, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2743/3341 (82.1012%), train_poison_data_count: 3341
Global model norm: 2.5944396791089894.
Norm before scaling: 3.736240192501281. Distance: 1.7633796525843661
Total norm for 5 adversaries is: 3.736240192501281. distance: 1.7633796525843661
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 0.5381, Accuracy: 7899/8991 (87.8545%)
___Train Local_Simple,  epoch  88, local model 6, internal_epoch   1,  Average loss: 0.0146, Accuracy: 4202/5024 (83.6385%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.5624, Accuracy: 8611/10000 (86.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 7, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2969/3641 (81.5435%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.6078, Accuracy: 8547/10000 (85.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 8, internal_epoch   1,  Average loss: 0.0142, Accuracy: 4020/4701 (85.5137%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.5716, Accuracy: 8640/10000 (86.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 9, internal_epoch   1,  Average loss: 0.0170, Accuracy: 2705/3315 (81.5988%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.6173, Accuracy: 8604/10000 (86.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 10, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2808/3435 (81.7467%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.6154, Accuracy: 8647/10000 (86.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 11, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3172/3917 (80.9803%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.6048, Accuracy: 8586/10000 (85.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 12, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3351/4069 (82.3544%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.5863, Accuracy: 8644/10000 (86.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 13, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3249/3851 (84.3677%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.6487, Accuracy: 8204/10000 (82.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  88, local model 14, internal_epoch   1,  Average loss: 0.0130, Accuracy: 2706/3110 (87.0096%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.9744, Accuracy: 7909/10000 (79.0900%), Attack Success Rate:0/10000(0.000)
time spent on training: 625.806572675705
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.21000576 1.        ]
___Test Target_Simple poisoned: False, epoch: 88: Average loss: 1.0735, Accuracy: 7949/10000 (79.4900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 88: Average loss: 1.1475, Accuracy: 6427/8991 (71.4826%)
Done in 633.8959395885468 sec.
Server Epoch:89 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  89, local model 0, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3325/3973 (83.6899%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.6119, Accuracy: 8524/10000 (85.2400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  89, local model 1, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3004/3656 (82.1663%), train_poison_data_count: 3656
Global model norm: 2.6034478581531206.
Norm before scaling: 3.816640762729832. Distance: 1.8416971319219049
Total norm for 5 adversaries is: 3.816640762729832. distance: 1.8416971319219049
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.5237, Accuracy: 7926/8991 (88.1548%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  89, local model 2, internal_epoch   1,  Average loss: 0.0145, Accuracy: 3174/3821 (83.0673%), train_poison_data_count: 3821
Global model norm: 2.6034478581531206.
Norm before scaling: 3.8504949177281347. Distance: 1.8143458996842834
Total norm for 5 adversaries is: 3.8504949177281347. distance: 1.8143458996842834
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.5441, Accuracy: 7732/8991 (85.9971%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  89, local model 3, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3579/4319 (82.8664%), train_poison_data_count: 4319
Global model norm: 2.6034478581531206.
Norm before scaling: 3.915984087505488. Distance: 1.9657274083082867
Total norm for 5 adversaries is: 3.915984087505488. distance: 1.9657274083082867
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.5210, Accuracy: 7881/8991 (87.6543%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0136, Accuracy: 3709/4396 (84.3722%), train_poison_data_count: 4396
Global model norm: 2.6034478581531206.
Norm before scaling: 3.9424007132829915. Distance: 1.9733958453617066
Total norm for 5 adversaries is: 3.9424007132829915. distance: 1.9733958453617066
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.5190, Accuracy: 7837/8991 (87.1649%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  89, local model 5, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2775/3341 (83.0590%), train_poison_data_count: 3341
Global model norm: 2.6034478581531206.
Norm before scaling: 3.748423181262382. Distance: 1.7641932666246587
Total norm for 5 adversaries is: 3.748423181262382. distance: 1.7641932666246587
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 0.5411, Accuracy: 7851/8991 (87.3207%)
___Train Local_Simple,  epoch  89, local model 6, internal_epoch   1,  Average loss: 0.0146, Accuracy: 4197/5024 (83.5390%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.5637, Accuracy: 8623/10000 (86.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 7, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2970/3641 (81.5710%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.6110, Accuracy: 8601/10000 (86.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 8, internal_epoch   1,  Average loss: 0.0141, Accuracy: 4034/4701 (85.8115%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.5695, Accuracy: 8674/10000 (86.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 9, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2732/3315 (82.4133%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.6138, Accuracy: 8622/10000 (86.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 10, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2808/3435 (81.7467%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.6173, Accuracy: 8605/10000 (86.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 11, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3167/3917 (80.8527%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.6046, Accuracy: 8548/10000 (85.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 12, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3333/4069 (81.9120%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.6064, Accuracy: 8499/10000 (84.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 13, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3239/3851 (84.1080%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.6252, Accuracy: 8422/10000 (84.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  89, local model 14, internal_epoch   1,  Average loss: 0.0130, Accuracy: 2678/3110 (86.1093%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.9660, Accuracy: 7991/10000 (79.9100%), Attack Success Rate:0/10000(0.000)
time spent on training: 631.3709592819214
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 89: Average loss: 1.0634, Accuracy: 7956/10000 (79.5600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 89: Average loss: 1.1379, Accuracy: 6428/8991 (71.4937%)
Done in 639.3797533512115 sec.
Server Epoch:90 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  90, local model 0, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3318/3973 (83.5137%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.5981, Accuracy: 8578/10000 (85.7800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  90, local model 1, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3017/3656 (82.5219%), train_poison_data_count: 3656
Global model norm: 2.6183955350982893.
Norm before scaling: 3.8255387269656116. Distance: 1.8326072194164653
Total norm for 5 adversaries is: 3.8255387269656116. distance: 1.8326072194164653
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.5267, Accuracy: 7898/8991 (87.8434%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  90, local model 2, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3199/3821 (83.7215%), train_poison_data_count: 3821
Global model norm: 2.6183955350982893.
Norm before scaling: 3.84953418737616. Distance: 1.8007996531309507
Total norm for 5 adversaries is: 3.84953418737616. distance: 1.8007996531309507
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.5424, Accuracy: 7784/8991 (86.5755%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  90, local model 3, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3577/4319 (82.8201%), train_poison_data_count: 4319
Global model norm: 2.6183955350982893.
Norm before scaling: 3.9271029093260355. Distance: 1.9613893147982406
Total norm for 5 adversaries is: 3.9271029093260355. distance: 1.9613893147982406
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.5331, Accuracy: 7865/8991 (87.4764%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  90, local model 4, internal_epoch   1,  Average loss: 0.0135, Accuracy: 3732/4396 (84.8954%), train_poison_data_count: 4396
Global model norm: 2.6183955350982893.
Norm before scaling: 3.9423220943738952. Distance: 1.9605835979007118
Total norm for 5 adversaries is: 3.9423220943738952. distance: 1.9605835979007118
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.5078, Accuracy: 7842/8991 (87.2206%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  90, local model 5, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2722/3341 (81.4726%), train_poison_data_count: 3341
Global model norm: 2.6183955350982893.
Norm before scaling: 3.747495450659008. Distance: 1.7516109681038032
Total norm for 5 adversaries is: 3.747495450659008. distance: 1.7516109681038032
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 0.5349, Accuracy: 7935/8991 (88.2549%)
___Train Local_Simple,  epoch  90, local model 6, internal_epoch   1,  Average loss: 0.0145, Accuracy: 4223/5024 (84.0565%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.5583, Accuracy: 8644/10000 (86.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 7, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2974/3641 (81.6809%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.6291, Accuracy: 8411/10000 (84.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 8, internal_epoch   1,  Average loss: 0.0141, Accuracy: 4006/4701 (85.2159%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.5768, Accuracy: 8658/10000 (86.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 9, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2724/3315 (82.1719%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.6167, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 10, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2843/3435 (82.7656%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.6208, Accuracy: 8618/10000 (86.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 11, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3176/3917 (81.0825%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.5973, Accuracy: 8591/10000 (85.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 12, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3362/4069 (82.6247%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.5912, Accuracy: 8571/10000 (85.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 13, internal_epoch   1,  Average loss: 0.0143, Accuracy: 3240/3851 (84.1340%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.6297, Accuracy: 8316/10000 (83.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  90, local model 14, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2713/3110 (87.2347%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.9831, Accuracy: 7859/10000 (78.5900%), Attack Success Rate:0/10000(0.000)
time spent on training: 638.5858354568481
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 90: Average loss: 1.0611, Accuracy: 7954/10000 (79.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 90: Average loss: 1.1362, Accuracy: 6426/8991 (71.4715%)
Done in 646.6293301582336 sec.
Server Epoch:91 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  91, local model 0, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3299/3973 (83.0355%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.5902, Accuracy: 8649/10000 (86.4900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  91, local model 1, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3013/3656 (82.4125%), train_poison_data_count: 3656
Global model norm: 2.6255832205873766.
Norm before scaling: 3.8325148966500358. Distance: 1.8364472675765442
Total norm for 5 adversaries is: 3.8325148966500358. distance: 1.8364472675765442
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.5276, Accuracy: 7910/8991 (87.9769%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  91, local model 2, internal_epoch   1,  Average loss: 0.0143, Accuracy: 3185/3821 (83.3551%), train_poison_data_count: 3821
Global model norm: 2.6255832205873766.
Norm before scaling: 3.856242279094466. Distance: 1.7928531916992212
Total norm for 5 adversaries is: 3.856242279094466. distance: 1.7928531916992212
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.5300, Accuracy: 7801/8991 (86.7645%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  91, local model 3, internal_epoch   1,  Average loss: 0.0145, Accuracy: 3620/4319 (83.8157%), train_poison_data_count: 4319
Global model norm: 2.6255832205873766.
Norm before scaling: 3.9053830825130587. Distance: 1.9285771808841234
Total norm for 5 adversaries is: 3.9053830825130587. distance: 1.9285771808841234
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.5258, Accuracy: 7877/8991 (87.6098%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  91, local model 4, internal_epoch   1,  Average loss: 0.0134, Accuracy: 3730/4396 (84.8499%), train_poison_data_count: 4396
Global model norm: 2.6255832205873766.
Norm before scaling: 3.9464843218366448. Distance: 1.962078355334757
Total norm for 5 adversaries is: 3.9464843218366448. distance: 1.962078355334757
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.5056, Accuracy: 7869/8991 (87.5209%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  91, local model 5, internal_epoch   1,  Average loss: 0.0158, Accuracy: 2750/3341 (82.3107%), train_poison_data_count: 3341
Global model norm: 2.6255832205873766.
Norm before scaling: 3.7454031426032843. Distance: 1.7381642505832455
Total norm for 5 adversaries is: 3.7454031426032843. distance: 1.7381642505832455
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 0.5339, Accuracy: 7924/8991 (88.1326%)
___Train Local_Simple,  epoch  91, local model 6, internal_epoch   1,  Average loss: 0.0145, Accuracy: 4220/5024 (83.9968%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.5546, Accuracy: 8666/10000 (86.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 7, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2963/3641 (81.3787%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.6197, Accuracy: 8443/10000 (84.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 8, internal_epoch   1,  Average loss: 0.0141, Accuracy: 4021/4701 (85.5350%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.5849, Accuracy: 8618/10000 (86.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 9, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2720/3315 (82.0513%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.6240, Accuracy: 8508/10000 (85.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 10, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2837/3435 (82.5910%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.6112, Accuracy: 8654/10000 (86.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 11, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3187/3917 (81.3633%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.5995, Accuracy: 8573/10000 (85.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 12, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3344/4069 (82.1824%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.6294, Accuracy: 8349/10000 (83.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 13, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3260/3851 (84.6533%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.6322, Accuracy: 8313/10000 (83.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  91, local model 14, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2691/3110 (86.5273%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.9602, Accuracy: 7942/10000 (79.4200%), Attack Success Rate:0/10000(0.000)
time spent on training: 645.4350876808167
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.40164307 0.         0.         0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 91: Average loss: 1.0563, Accuracy: 7964/10000 (79.6400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 91: Average loss: 1.1322, Accuracy: 6428/8991 (71.4937%)
Done in 653.4678575992584 sec.
Server Epoch:92 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  92, local model 0, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3320/3973 (83.5641%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.5984, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  92, local model 1, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2992/3656 (81.8381%), train_poison_data_count: 3656
Global model norm: 2.636512488315521.
Norm before scaling: 3.8232824720498986. Distance: 1.8129867031790197
Total norm for 5 adversaries is: 3.8232824720498986. distance: 1.8129867031790197
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.5202, Accuracy: 7970/8991 (88.6442%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  92, local model 2, internal_epoch   1,  Average loss: 0.0143, Accuracy: 3205/3821 (83.8786%), train_poison_data_count: 3821
Global model norm: 2.636512488315521.
Norm before scaling: 3.861124483873611. Distance: 1.7886945187796746
Total norm for 5 adversaries is: 3.861124483873611. distance: 1.7886945187796746
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.5314, Accuracy: 7872/8991 (87.5542%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  92, local model 3, internal_epoch   1,  Average loss: 0.0145, Accuracy: 3596/4319 (83.2600%), train_poison_data_count: 4319
Global model norm: 2.636512488315521.
Norm before scaling: 3.9255763365752787. Distance: 1.934759601573629
Total norm for 5 adversaries is: 3.9255763365752787. distance: 1.934759601573629
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.5254, Accuracy: 7825/8991 (87.0315%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  92, local model 4, internal_epoch   1,  Average loss: 0.0135, Accuracy: 3724/4396 (84.7134%), train_poison_data_count: 4396
Global model norm: 2.636512488315521.
Norm before scaling: 3.948795888355779. Distance: 1.950186449087113
Total norm for 5 adversaries is: 3.948795888355779. distance: 1.950186449087113
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.5095, Accuracy: 7820/8991 (86.9759%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  92, local model 5, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2756/3341 (82.4903%), train_poison_data_count: 3341
Global model norm: 2.636512488315521.
Norm before scaling: 3.755067326212627. Distance: 1.7417792966767947
Total norm for 5 adversaries is: 3.755067326212627. distance: 1.7417792966767947
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 0.5315, Accuracy: 7929/8991 (88.1882%)
___Train Local_Simple,  epoch  92, local model 6, internal_epoch   1,  Average loss: 0.0145, Accuracy: 4209/5024 (83.7779%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.5654, Accuracy: 8557/10000 (85.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 7, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3004/3641 (82.5048%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.6186, Accuracy: 8479/10000 (84.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 8, internal_epoch   1,  Average loss: 0.0142, Accuracy: 4040/4701 (85.9392%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.5726, Accuracy: 8640/10000 (86.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 9, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2699/3315 (81.4178%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.6237, Accuracy: 8553/10000 (85.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2828/3435 (82.3290%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.6209, Accuracy: 8620/10000 (86.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 11, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3204/3917 (81.7973%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.6155, Accuracy: 8481/10000 (84.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 12, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3382/4069 (83.1162%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.6049, Accuracy: 8506/10000 (85.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 13, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3251/3851 (84.4196%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.6209, Accuracy: 8429/10000 (84.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  92, local model 14, internal_epoch   1,  Average loss: 0.0130, Accuracy: 2690/3110 (86.4952%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.9523, Accuracy: 8056/10000 (80.5600%), Attack Success Rate:0/10000(0.000)
time spent on training: 651.536021232605
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.20820281 1.        ]
___Test Target_Simple poisoned: False, epoch: 92: Average loss: 1.0525, Accuracy: 7966/10000 (79.6600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 92: Average loss: 1.1290, Accuracy: 6428/8991 (71.4937%)
Done in 659.5610489845276 sec.
Server Epoch:93 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  93, local model 0, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3289/3973 (82.7838%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.6046, Accuracy: 8517/10000 (85.1700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  93, local model 1, internal_epoch   1,  Average loss: 0.0158, Accuracy: 2986/3656 (81.6740%), train_poison_data_count: 3656
Global model norm: 2.6452091311758794.
Norm before scaling: 3.83536949536216. Distance: 1.8124706002843582
Total norm for 5 adversaries is: 3.83536949536216. distance: 1.8124706002843582
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.5237, Accuracy: 7920/8991 (88.0881%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  93, local model 2, internal_epoch   1,  Average loss: 0.0143, Accuracy: 3198/3821 (83.6954%), train_poison_data_count: 3821
Global model norm: 2.6452091311758794.
Norm before scaling: 3.8543140417567052. Distance: 1.775043583724381
Total norm for 5 adversaries is: 3.8543140417567052. distance: 1.775043583724381
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.5337, Accuracy: 7868/8991 (87.5097%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  93, local model 3, internal_epoch   1,  Average loss: 0.0145, Accuracy: 3587/4319 (83.0516%), train_poison_data_count: 4319
Global model norm: 2.6452091311758794.
Norm before scaling: 3.9278317386770016. Distance: 1.9305536588786052
Total norm for 5 adversaries is: 3.9278317386770016. distance: 1.9305536588786052
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.5286, Accuracy: 7843/8991 (87.2317%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  93, local model 4, internal_epoch   1,  Average loss: 0.0134, Accuracy: 3724/4396 (84.7134%), train_poison_data_count: 4396
Global model norm: 2.6452091311758794.
Norm before scaling: 3.963344828078592. Distance: 1.947238627316451
Total norm for 5 adversaries is: 3.963344828078592. distance: 1.947238627316451
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.5083, Accuracy: 7837/8991 (87.1649%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  93, local model 5, internal_epoch   1,  Average loss: 0.0158, Accuracy: 2733/3341 (81.8019%), train_poison_data_count: 3341
Global model norm: 2.6452091311758794.
Norm before scaling: 3.7637648677373905. Distance: 1.7343484000150857
Total norm for 5 adversaries is: 3.7637648677373905. distance: 1.7343484000150857
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 0.5266, Accuracy: 7910/8991 (87.9769%)
___Train Local_Simple,  epoch  93, local model 6, internal_epoch   1,  Average loss: 0.0144, Accuracy: 4182/5024 (83.2404%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.5636, Accuracy: 8614/10000 (86.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 7, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2984/3641 (81.9555%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.6100, Accuracy: 8515/10000 (85.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 8, internal_epoch   1,  Average loss: 0.0140, Accuracy: 4044/4701 (86.0243%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.5726, Accuracy: 8644/10000 (86.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 9, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2701/3315 (81.4781%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.6111, Accuracy: 8624/10000 (86.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 10, internal_epoch   1,  Average loss: 0.0158, Accuracy: 2855/3435 (83.1150%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.6193, Accuracy: 8628/10000 (86.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 11, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3199/3917 (81.6696%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.5999, Accuracy: 8582/10000 (85.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 12, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3369/4069 (82.7968%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.5929, Accuracy: 8597/10000 (85.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 13, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3265/3851 (84.7832%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.6421, Accuracy: 8243/10000 (82.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  93, local model 14, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2701/3110 (86.8489%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.9563, Accuracy: 7906/10000 (79.0600%), Attack Success Rate:0/10000(0.000)
time spent on training: 658.6144688129425
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 93: Average loss: 1.0453, Accuracy: 7961/10000 (79.6100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 93: Average loss: 1.1211, Accuracy: 6437/8991 (71.5938%)
Done in 666.639398097992 sec.
Server Epoch:94 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  94, local model 0, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3327/3973 (83.7402%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.5900, Accuracy: 8637/10000 (86.3700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  94, local model 1, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2995/3656 (81.9201%), train_poison_data_count: 3656
Global model norm: 2.660618678832123.
Norm before scaling: 3.8379772225042483. Distance: 1.8020526096907554
Total norm for 5 adversaries is: 3.8379772225042483. distance: 1.8020526096907554
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.5149, Accuracy: 7957/8991 (88.4996%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  94, local model 2, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3193/3821 (83.5645%), train_poison_data_count: 3821
Global model norm: 2.660618678832123.
Norm before scaling: 3.872168583242256. Distance: 1.7624049573663227
Total norm for 5 adversaries is: 3.872168583242256. distance: 1.7624049573663227
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.5371, Accuracy: 7748/8991 (86.1751%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  94, local model 3, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3611/4319 (83.6073%), train_poison_data_count: 4319
Global model norm: 2.660618678832123.
Norm before scaling: 3.9287654333391036. Distance: 1.9155224895585958
Total norm for 5 adversaries is: 3.9287654333391036. distance: 1.9155224895585958
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.5243, Accuracy: 7888/8991 (87.7322%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  94, local model 4, internal_epoch   1,  Average loss: 0.0134, Accuracy: 3731/4396 (84.8726%), train_poison_data_count: 4396
Global model norm: 2.660618678832123.
Norm before scaling: 3.9573625009812234. Distance: 1.9278006034999726
Total norm for 5 adversaries is: 3.9573625009812234. distance: 1.9278006034999726
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.5025, Accuracy: 7861/8991 (87.4319%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  94, local model 5, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2713/3341 (81.2032%), train_poison_data_count: 3341
Global model norm: 2.660618678832123.
Norm before scaling: 3.7745489848944436. Distance: 1.7248013865806795
Total norm for 5 adversaries is: 3.7745489848944436. distance: 1.7248013865806795
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 0.5299, Accuracy: 7873/8991 (87.5653%)
___Train Local_Simple,  epoch  94, local model 6, internal_epoch   1,  Average loss: 0.0144, Accuracy: 4204/5024 (83.6783%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.5769, Accuracy: 8522/10000 (85.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 7, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2993/3641 (82.2027%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.6333, Accuracy: 8348/10000 (83.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 8, internal_epoch   1,  Average loss: 0.0141, Accuracy: 4023/4701 (85.5775%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.5734, Accuracy: 8658/10000 (86.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 9, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2704/3315 (81.5686%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.6095, Accuracy: 8627/10000 (86.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 10, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2861/3435 (83.2897%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.6124, Accuracy: 8698/10000 (86.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 11, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3181/3917 (81.2101%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.5889, Accuracy: 8621/10000 (86.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 12, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3381/4069 (83.0917%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.5853, Accuracy: 8638/10000 (86.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3257/3851 (84.5754%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.6170, Accuracy: 8389/10000 (83.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  94, local model 14, internal_epoch   1,  Average loss: 0.0127, Accuracy: 2705/3110 (86.9775%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.9601, Accuracy: 7902/10000 (79.0200%), Attack Success Rate:0/10000(0.000)
time spent on training: 666.3675155639648
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 94: Average loss: 1.0370, Accuracy: 7972/10000 (79.7200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 94: Average loss: 1.1138, Accuracy: 6439/8991 (71.6161%)
Done in 674.3839869499207 sec.
Server Epoch:95 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  95, local model 0, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3281/3973 (82.5824%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.6010, Accuracy: 8585/10000 (85.8500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  95, local model 1, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3008/3656 (82.2757%), train_poison_data_count: 3656
Global model norm: 2.67697762801377.
Norm before scaling: 3.8497536766222464. Distance: 1.7958589417769915
Total norm for 5 adversaries is: 3.8497536766222464. distance: 1.7958589417769915
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.5245, Accuracy: 7917/8991 (88.0547%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  95, local model 2, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3206/3821 (83.9047%), train_poison_data_count: 3821
Global model norm: 2.67697762801377.
Norm before scaling: 3.8719080002235104. Distance: 1.7604802212350303
Total norm for 5 adversaries is: 3.8719080002235104. distance: 1.7604802212350303
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.5407, Accuracy: 7784/8991 (86.5755%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  95, local model 3, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3604/4319 (83.4452%), train_poison_data_count: 4319
Global model norm: 2.67697762801377.
Norm before scaling: 3.933945156186385. Distance: 1.908722071914856
Total norm for 5 adversaries is: 3.933945156186385. distance: 1.908722071914856
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.5345, Accuracy: 7852/8991 (87.3318%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  95, local model 4, internal_epoch   1,  Average loss: 0.0133, Accuracy: 3721/4396 (84.6451%), train_poison_data_count: 4396
Global model norm: 2.67697762801377.
Norm before scaling: 3.963644633749828. Distance: 1.922503112869818
Total norm for 5 adversaries is: 3.963644633749828. distance: 1.922503112869818
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.5002, Accuracy: 7910/8991 (87.9769%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  95, local model 5, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2754/3341 (82.4304%), train_poison_data_count: 3341
Global model norm: 2.67697762801377.
Norm before scaling: 3.778155992000613. Distance: 1.704103031540377
Total norm for 5 adversaries is: 3.778155992000613. distance: 1.704103031540377
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 0.5247, Accuracy: 7928/8991 (88.1771%)
___Train Local_Simple,  epoch  95, local model 6, internal_epoch   1,  Average loss: 0.0144, Accuracy: 4182/5024 (83.2404%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.5604, Accuracy: 8611/10000 (86.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 7, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2993/3641 (82.2027%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.6188, Accuracy: 8524/10000 (85.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 8, internal_epoch   1,  Average loss: 0.0138, Accuracy: 4027/4701 (85.6626%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.5707, Accuracy: 8650/10000 (86.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 9, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2729/3315 (82.3228%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.6118, Accuracy: 8553/10000 (85.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 10, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2847/3435 (82.8821%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.6218, Accuracy: 8592/10000 (85.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 11, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3179/3917 (81.1591%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.6018, Accuracy: 8545/10000 (85.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 12, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3362/4069 (82.6247%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.6183, Accuracy: 8406/10000 (84.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 13, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3242/3851 (84.1859%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.6210, Accuracy: 8352/10000 (83.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  95, local model 14, internal_epoch   1,  Average loss: 0.0127, Accuracy: 2713/3110 (87.2347%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.9509, Accuracy: 7931/10000 (79.3100%), Attack Success Rate:0/10000(0.000)
time spent on training: 673.2796709537506
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 95: Average loss: 1.0348, Accuracy: 7976/10000 (79.7600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 95: Average loss: 1.1123, Accuracy: 6438/8991 (71.6049%)
Done in 681.3272731304169 sec.
Server Epoch:96 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  96, local model 0, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3331/3973 (83.8409%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.6035, Accuracy: 8528/10000 (85.2800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  96, local model 1, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3000/3656 (82.0569%), train_poison_data_count: 3656
Global model norm: 2.684099752150092.
Norm before scaling: 3.847478903154283. Distance: 1.7886931858596848
Total norm for 5 adversaries is: 3.847478903154283. distance: 1.7886931858596848
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.5167, Accuracy: 7928/8991 (88.1771%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  96, local model 2, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3186/3821 (83.3813%), train_poison_data_count: 3821
Global model norm: 2.684099752150092.
Norm before scaling: 3.8708787968117697. Distance: 1.7422676239063786
Total norm for 5 adversaries is: 3.8708787968117697. distance: 1.7422676239063786
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.5280, Accuracy: 7824/8991 (87.0204%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  96, local model 3, internal_epoch   1,  Average loss: 0.0143, Accuracy: 3601/4319 (83.3758%), train_poison_data_count: 4319
Global model norm: 2.684099752150092.
Norm before scaling: 3.9401500200863078. Distance: 1.9022867871789624
Total norm for 5 adversaries is: 3.9401500200863078. distance: 1.9022867871789624
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.5179, Accuracy: 7910/8991 (87.9769%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  96, local model 4, internal_epoch   1,  Average loss: 0.0133, Accuracy: 3721/4396 (84.6451%), train_poison_data_count: 4396
Global model norm: 2.684099752150092.
Norm before scaling: 3.9588859707722874. Distance: 1.9108204067284869
Total norm for 5 adversaries is: 3.9588859707722874. distance: 1.9108204067284869
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.5055, Accuracy: 7860/8991 (87.4208%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  96, local model 5, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2765/3341 (82.7597%), train_poison_data_count: 3341
Global model norm: 2.684099752150092.
Norm before scaling: 3.767480669990874. Distance: 1.7017632035916845
Total norm for 5 adversaries is: 3.767480669990874. distance: 1.7017632035916845
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 0.5324, Accuracy: 7951/8991 (88.4329%)
___Train Local_Simple,  epoch  96, local model 6, internal_epoch   1,  Average loss: 0.0144, Accuracy: 4175/5024 (83.1011%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.5514, Accuracy: 8696/10000 (86.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 7, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2989/3641 (82.0928%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.6104, Accuracy: 8489/10000 (84.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 8, internal_epoch   1,  Average loss: 0.0140, Accuracy: 4045/4701 (86.0455%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.5736, Accuracy: 8659/10000 (86.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2716/3315 (81.9306%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.6063, Accuracy: 8566/10000 (85.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 10, internal_epoch   1,  Average loss: 0.0158, Accuracy: 2829/3435 (82.3581%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.6092, Accuracy: 8655/10000 (86.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 11, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3200/3917 (81.6952%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.5915, Accuracy: 8618/10000 (86.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 12, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3366/4069 (82.7230%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.5952, Accuracy: 8560/10000 (85.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3255/3851 (84.5235%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.6372, Accuracy: 8204/10000 (82.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  96, local model 14, internal_epoch   1,  Average loss: 0.0126, Accuracy: 2704/3110 (86.9453%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.9508, Accuracy: 7973/10000 (79.7300%), Attack Success Rate:0/10000(0.000)
time spent on training: 678.675701379776
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.48357451 0.         0.         0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 96: Average loss: 1.0301, Accuracy: 7975/10000 (79.7500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 96: Average loss: 1.1082, Accuracy: 6436/8991 (71.5827%)
Done in 686.7380616664886 sec.
Server Epoch:97 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  97, local model 0, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3318/3973 (83.5137%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.6020, Accuracy: 8559/10000 (85.5900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  97, local model 1, internal_epoch   1,  Average loss: 0.0155, Accuracy: 2999/3656 (82.0295%), train_poison_data_count: 3656
Global model norm: 2.6955300948172383.
Norm before scaling: 3.867244835630837. Distance: 1.800148412096211
Total norm for 5 adversaries is: 3.867244835630837. distance: 1.800148412096211
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.5135, Accuracy: 7944/8991 (88.3550%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  97, local model 2, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3222/3821 (84.3235%), train_poison_data_count: 3821
Global model norm: 2.6955300948172383.
Norm before scaling: 3.889712674824194. Distance: 1.7525831639777683
Total norm for 5 adversaries is: 3.889712674824194. distance: 1.7525831639777683
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.5630, Accuracy: 7616/8991 (84.7069%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  97, local model 3, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3607/4319 (83.5147%), train_poison_data_count: 4319
Global model norm: 2.6955300948172383.
Norm before scaling: 3.9503637025682026. Distance: 1.8958994535995783
Total norm for 5 adversaries is: 3.9503637025682026. distance: 1.8958994535995783
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.5258, Accuracy: 7846/8991 (87.2650%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  97, local model 4, internal_epoch   1,  Average loss: 0.0133, Accuracy: 3742/4396 (85.1228%), train_poison_data_count: 4396
Global model norm: 2.6955300948172383.
Norm before scaling: 3.9722685348075437. Distance: 1.9042094831709928
Total norm for 5 adversaries is: 3.9722685348075437. distance: 1.9042094831709928
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.5104, Accuracy: 7835/8991 (87.1427%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  97, local model 5, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2743/3341 (82.1012%), train_poison_data_count: 3341
Global model norm: 2.6955300948172383.
Norm before scaling: 3.782615099943917. Distance: 1.6996803095294275
Total norm for 5 adversaries is: 3.782615099943917. distance: 1.6996803095294275
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 0.5289, Accuracy: 7913/8991 (88.0102%)
___Train Local_Simple,  epoch  97, local model 6, internal_epoch   1,  Average loss: 0.0143, Accuracy: 4203/5024 (83.6584%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.5604, Accuracy: 8580/10000 (85.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 7, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2965/3641 (81.4337%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.6066, Accuracy: 8494/10000 (84.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 8, internal_epoch   1,  Average loss: 0.0139, Accuracy: 4038/4701 (85.8966%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.5689, Accuracy: 8658/10000 (86.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 9, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2711/3315 (81.7798%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.6188, Accuracy: 8530/10000 (85.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 10, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2837/3435 (82.5910%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.6165, Accuracy: 8609/10000 (86.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 11, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3197/3917 (81.6186%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.5963, Accuracy: 8592/10000 (85.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 12, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3367/4069 (82.7476%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.5923, Accuracy: 8601/10000 (86.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 13, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3247/3851 (84.3158%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.6362, Accuracy: 8230/10000 (82.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  97, local model 14, internal_epoch   1,  Average loss: 0.0126, Accuracy: 2713/3110 (87.2347%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.9367, Accuracy: 7995/10000 (79.9500%), Attack Success Rate:0/10000(0.000)
time spent on training: 685.2239427566528
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.08706843 1.        ]
___Test Target_Simple poisoned: False, epoch: 97: Average loss: 1.0275, Accuracy: 7976/10000 (79.7600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 97: Average loss: 1.1063, Accuracy: 6436/8991 (71.5827%)
Done in 693.3391091823578 sec.
Server Epoch:98 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  98, local model 0, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3311/3973 (83.3375%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.6006, Accuracy: 8593/10000 (85.9300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  98, local model 1, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3009/3656 (82.3031%), train_poison_data_count: 3656
Global model norm: 2.7033134791644273.
Norm before scaling: 3.860990240338135. Distance: 1.7790225641407487
Total norm for 5 adversaries is: 3.860990240338135. distance: 1.7790225641407487
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.5171, Accuracy: 7929/8991 (88.1882%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  98, local model 2, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3209/3821 (83.9833%), train_poison_data_count: 3821
Global model norm: 2.7033134791644273.
Norm before scaling: 3.8831509417703898. Distance: 1.7359769828694418
Total norm for 5 adversaries is: 3.8831509417703898. distance: 1.7359769828694418
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.5438, Accuracy: 7730/8991 (85.9749%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  98, local model 3, internal_epoch   1,  Average loss: 0.0143, Accuracy: 3601/4319 (83.3758%), train_poison_data_count: 4319
Global model norm: 2.7033134791644273.
Norm before scaling: 3.944398075302826. Distance: 1.878561325294723
Total norm for 5 adversaries is: 3.944398075302826. distance: 1.878561325294723
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.5218, Accuracy: 7837/8991 (87.1649%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  98, local model 4, internal_epoch   1,  Average loss: 0.0132, Accuracy: 3721/4396 (84.6451%), train_poison_data_count: 4396
Global model norm: 2.7033134791644273.
Norm before scaling: 3.964546199964792. Distance: 1.9011752634702122
Total norm for 5 adversaries is: 3.964546199964792. distance: 1.9011752634702122
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.4999, Accuracy: 7926/8991 (88.1548%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  98, local model 5, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2759/3341 (82.5801%), train_poison_data_count: 3341
Global model norm: 2.7033134791644273.
Norm before scaling: 3.7759128452119004. Distance: 1.6914703145569732
Total norm for 5 adversaries is: 3.7759128452119004. distance: 1.6914703145569732
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 0.5304, Accuracy: 7941/8991 (88.3217%)
___Train Local_Simple,  epoch  98, local model 6, internal_epoch   1,  Average loss: 0.0143, Accuracy: 4168/5024 (82.9618%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.5517, Accuracy: 8658/10000 (86.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 7, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3002/3641 (82.4499%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.6077, Accuracy: 8504/10000 (85.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 8, internal_epoch   1,  Average loss: 0.0138, Accuracy: 4053/4701 (86.2157%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.5734, Accuracy: 8591/10000 (85.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 9, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2726/3315 (82.2323%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.6059, Accuracy: 8657/10000 (86.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 10, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2842/3435 (82.7365%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.6185, Accuracy: 8612/10000 (86.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 11, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3173/3917 (81.0059%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.6060, Accuracy: 8498/10000 (84.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 12, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3361/4069 (82.6001%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.6032, Accuracy: 8460/10000 (84.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 13, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3266/3851 (84.8091%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.6149, Accuracy: 8371/10000 (83.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  98, local model 14, internal_epoch   1,  Average loss: 0.0125, Accuracy: 2710/3110 (87.1383%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.9444, Accuracy: 7938/10000 (79.3800%), Attack Success Rate:0/10000(0.000)
time spent on training: 693.0453464984894
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 98: Average loss: 1.0253, Accuracy: 7977/10000 (79.7700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 98: Average loss: 1.1050, Accuracy: 6436/8991 (71.5827%)
Done in 701.050920009613 sec.
Server Epoch:99 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  99, local model 0, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3322/3973 (83.6144%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.5964, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  99, local model 1, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3008/3656 (82.2757%), train_poison_data_count: 3656
Global model norm: 2.7103267278466054.
Norm before scaling: 3.8579912060073287. Distance: 1.7702687055216069
Total norm for 5 adversaries is: 3.8579912060073287. distance: 1.7702687055216069
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.5211, Accuracy: 7929/8991 (88.1882%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  99, local model 2, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3216/3821 (84.1664%), train_poison_data_count: 3821
Global model norm: 2.7103267278466054.
Norm before scaling: 3.8894860006017447. Distance: 1.7333762239993924
Total norm for 5 adversaries is: 3.8894860006017447. distance: 1.7333762239993924
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.5262, Accuracy: 7834/8991 (87.1316%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  99, local model 3, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3614/4319 (83.6768%), train_poison_data_count: 4319
Global model norm: 2.7103267278466054.
Norm before scaling: 3.9555431102052085. Distance: 1.8853740441438078
Total norm for 5 adversaries is: 3.9555431102052085. distance: 1.8853740441438078
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.5196, Accuracy: 7873/8991 (87.5653%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  99, local model 4, internal_epoch   1,  Average loss: 0.0132, Accuracy: 3739/4396 (85.0546%), train_poison_data_count: 4396
Global model norm: 2.7103267278466054.
Norm before scaling: 3.9692414948108685. Distance: 1.89051143841132
Total norm for 5 adversaries is: 3.9692414948108685. distance: 1.89051143841132
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.5051, Accuracy: 7859/8991 (87.4096%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  99, local model 5, internal_epoch   1,  Average loss: 0.0155, Accuracy: 2753/3341 (82.4005%), train_poison_data_count: 3341
Global model norm: 2.7103267278466054.
Norm before scaling: 3.7809579279308574. Distance: 1.6792648848339202
Total norm for 5 adversaries is: 3.7809579279308574. distance: 1.6792648848339202
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 0.5351, Accuracy: 7871/8991 (87.5431%)
___Train Local_Simple,  epoch  99, local model 6, internal_epoch   1,  Average loss: 0.0142, Accuracy: 4205/5024 (83.6982%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.5513, Accuracy: 8672/10000 (86.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 7, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3004/3641 (82.5048%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.6161, Accuracy: 8410/10000 (84.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 8, internal_epoch   1,  Average loss: 0.0141, Accuracy: 4041/4701 (85.9604%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.5700, Accuracy: 8651/10000 (86.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 9, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2714/3315 (81.8703%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.6093, Accuracy: 8607/10000 (86.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 10, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2845/3435 (82.8239%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.6058, Accuracy: 8698/10000 (86.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 11, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3207/3917 (81.8739%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.5909, Accuracy: 8584/10000 (85.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 12, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3358/4069 (82.5264%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.6000, Accuracy: 8492/10000 (84.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 13, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3264/3851 (84.7572%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.6234, Accuracy: 8314/10000 (83.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  99, local model 14, internal_epoch   1,  Average loss: 0.0125, Accuracy: 2708/3110 (87.0740%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.9549, Accuracy: 7927/10000 (79.2700%), Attack Success Rate:0/10000(0.000)
time spent on training: 700.0423257350922
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         1.         0.         0.         0.
 0.         0.06940522 1.        ]
___Test Target_Simple poisoned: False, epoch: 99: Average loss: 1.0180, Accuracy: 7985/10000 (79.8500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 99: Average loss: 1.0990, Accuracy: 6446/8991 (71.6939%)
Done in 708.1028988361359 sec.
Server Epoch:100 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch 100, local model 0, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3323/3973 (83.6396%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.6135, Accuracy: 8379/10000 (83.7900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch 100, local model 1, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3018/3656 (82.5492%), train_poison_data_count: 3656
Global model norm: 2.7269473965547375.
Norm before scaling: 3.8646077500606206. Distance: 1.76492748154746
Total norm for 5 adversaries is: 3.8646077500606206. distance: 1.76492748154746
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.5206, Accuracy: 7937/8991 (88.2772%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch 100, local model 2, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3215/3821 (84.1403%), train_poison_data_count: 3821
Global model norm: 2.7269473965547375.
Norm before scaling: 3.8839658563136537. Distance: 1.7202209420573853
Total norm for 5 adversaries is: 3.8839658563136537. distance: 1.7202209420573853
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.5339, Accuracy: 7857/8991 (87.3874%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch 100, local model 3, internal_epoch   1,  Average loss: 0.0143, Accuracy: 3600/4319 (83.3526%), train_poison_data_count: 4319
Global model norm: 2.7269473965547375.
Norm before scaling: 3.9574801010624396. Distance: 1.865936626433483
Total norm for 5 adversaries is: 3.9574801010624396. distance: 1.865936626433483
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.5136, Accuracy: 7889/8991 (87.7433%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0132, Accuracy: 3731/4396 (84.8726%), train_poison_data_count: 4396
Global model norm: 2.7269473965547375.
Norm before scaling: 3.9794256848354297. Distance: 1.8833056551944645
Total norm for 5 adversaries is: 3.9794256848354297. distance: 1.8833056551944645
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.4980, Accuracy: 7928/8991 (88.1771%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch 100, local model 5, internal_epoch   1,  Average loss: 0.0154, Accuracy: 2760/3341 (82.6100%), train_poison_data_count: 3341
Global model norm: 2.7269473965547375.
Norm before scaling: 3.7897647796751337. Distance: 1.674274612043073
Total norm for 5 adversaries is: 3.7897647796751337. distance: 1.674274612043073
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 0.5223, Accuracy: 7890/8991 (87.7544%)
___Train Local_Simple,  epoch 100, local model 6, internal_epoch   1,  Average loss: 0.0142, Accuracy: 4225/5024 (84.0963%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.5767, Accuracy: 8429/10000 (84.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 7, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3014/3641 (82.7795%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.6089, Accuracy: 8493/10000 (84.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 8, internal_epoch   1,  Average loss: 0.0137, Accuracy: 4053/4701 (86.2157%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.5666, Accuracy: 8660/10000 (86.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 9, internal_epoch   1,  Average loss: 0.0162, Accuracy: 2722/3315 (82.1116%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.6147, Accuracy: 8606/10000 (86.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 10, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2838/3435 (82.6201%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.6132, Accuracy: 8567/10000 (85.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 11, internal_epoch   1,  Average loss: 0.0159, Accuracy: 3212/3917 (82.0015%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.5916, Accuracy: 8638/10000 (86.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 12, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3388/4069 (83.2637%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.5893, Accuracy: 8594/10000 (85.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 13, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3260/3851 (84.6533%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.6145, Accuracy: 8395/10000 (83.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch 100, local model 14, internal_epoch   1,  Average loss: 0.0123, Accuracy: 2702/3110 (86.8810%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.9424, Accuracy: 8041/10000 (80.4100%), Attack Success Rate:0/10000(0.000)
time spent on training: 706.920511007309
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 100: Average loss: 1.0161, Accuracy: 7989/10000 (79.8900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 100: Average loss: 1.0979, Accuracy: 6445/8991 (71.6828%)
Done in 715.0379090309143 sec.
Saving all the graphs.
This run has a label: Mar.14_20.11.11. Visdom environment: mnist_DBA
