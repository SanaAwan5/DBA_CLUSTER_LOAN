current path: saved_models/mnist_pretrain/model_mnist_Mar.15_08.31.28
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   1, local model 0, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2743/3973 (69.0410%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6805, Accuracy: 8216/10000 (82.1600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 1, internal_epoch   1,  Average loss: 0.0225, Accuracy: 2583/3656 (70.6510%), train_poison_data_count: 3656
Global model norm: 1.828686293811075.
Norm before scaling: 3.5631594131271944. Distance: 3.0856891773605106
Total norm for 5 adversaries is: 3.5631594131271944. distance: 3.0856891773605106
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5711, Accuracy: 7779/8991 (86.5199%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 2, internal_epoch   1,  Average loss: 0.0212, Accuracy: 2721/3821 (71.2117%), train_poison_data_count: 3821
Global model norm: 1.828686293811075.
Norm before scaling: 3.609791653187057. Distance: 3.1368710681611702
Total norm for 5 adversaries is: 3.609791653187057. distance: 3.1368710681611702
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5813, Accuracy: 7702/8991 (85.6634%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 3, internal_epoch   1,  Average loss: 0.0204, Accuracy: 3097/4319 (71.7064%), train_poison_data_count: 4319
Global model norm: 1.828686293811075.
Norm before scaling: 3.6793834779362102. Distance: 3.2276033288325587
Total norm for 5 adversaries is: 3.6793834779362102. distance: 3.2276033288325587
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5917, Accuracy: 7696/8991 (85.5967%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 4, internal_epoch   1,  Average loss: 0.0193, Accuracy: 3292/4396 (74.8863%), train_poison_data_count: 4396
Global model norm: 1.828686293811075.
Norm before scaling: 3.7258561142614846. Distance: 3.281457222344243
Total norm for 5 adversaries is: 3.7258561142614846. distance: 3.281457222344243
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5574, Accuracy: 7732/8991 (85.9971%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 5, internal_epoch   1,  Average loss: 0.0230, Accuracy: 2403/3341 (71.9246%), train_poison_data_count: 3341
Global model norm: 1.828686293811075.
Norm before scaling: 3.482589058706015. Distance: 2.995864720151388
Total norm for 5 adversaries is: 3.482589058706015. distance: 2.995864720151388
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5950, Accuracy: 7758/8991 (86.2863%)
___Train Local_Simple,  epoch   1, local model 6, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3671/5024 (73.0693%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.5978, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 7, internal_epoch   1,  Average loss: 0.0237, Accuracy: 2486/3641 (68.2779%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.7170, Accuracy: 8089/10000 (80.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 8, internal_epoch   1,  Average loss: 0.0205, Accuracy: 3482/4701 (74.0693%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6344, Accuracy: 8493/10000 (84.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 9, internal_epoch   1,  Average loss: 0.0253, Accuracy: 2245/3315 (67.7225%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6986, Accuracy: 8354/10000 (83.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 10, internal_epoch   1,  Average loss: 0.0243, Accuracy: 2320/3435 (67.5400%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.7155, Accuracy: 8421/10000 (84.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0236, Accuracy: 2655/3917 (67.7815%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6779, Accuracy: 8252/10000 (82.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 12, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2851/4069 (70.0664%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6932, Accuracy: 8175/10000 (81.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 13, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2716/3851 (70.5271%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.7158, Accuracy: 7997/10000 (79.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 14, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2202/3110 (70.8039%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.1507, Accuracy: 7700/10000 (77.0000%), Attack Success Rate:0/10000(0.000)
time spent on training: 40.101465940475464
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2655, Accuracy: 1749/10000 (17.4900%), Attack Success Rate:28/10000(0.280)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2710, Accuracy: 1348/8991 (14.9928%)
Done in 48.037113904953 sec.
Server Epoch:2 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   2, local model 0, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2787/3973 (70.1485%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6591, Accuracy: 8510/10000 (85.1000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 1, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2600/3656 (71.1160%), train_poison_data_count: 3656
Global model norm: 1.8286515480183272.
Norm before scaling: 3.5729525965597673. Distance: 3.0794126654106626
Total norm for 5 adversaries is: 3.5729525965597673. distance: 3.0794126654106626
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5770, Accuracy: 7773/8991 (86.4531%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 2, internal_epoch   1,  Average loss: 0.0211, Accuracy: 2697/3821 (70.5836%), train_poison_data_count: 3821
Global model norm: 1.8286515480183272.
Norm before scaling: 3.6046066162665. Distance: 3.1142705209543933
Total norm for 5 adversaries is: 3.6046066162665. distance: 3.1142705209543933
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5853, Accuracy: 7661/8991 (85.2074%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 3, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3135/4319 (72.5862%), train_poison_data_count: 4319
Global model norm: 1.8286515480183272.
Norm before scaling: 3.6735669722105797. Distance: 3.20511070667283
Total norm for 5 adversaries is: 3.6735669722105797. distance: 3.20511070667283
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5888, Accuracy: 7716/8991 (85.8192%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 4, internal_epoch   1,  Average loss: 0.0192, Accuracy: 3278/4396 (74.5678%), train_poison_data_count: 4396
Global model norm: 1.8286515480183272.
Norm before scaling: 3.726652964007777. Distance: 3.2650807488403335
Total norm for 5 adversaries is: 3.726652964007777. distance: 3.2650807488403335
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5441, Accuracy: 7824/8991 (87.0204%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 5, internal_epoch   1,  Average loss: 0.0229, Accuracy: 2385/3341 (71.3858%), train_poison_data_count: 3341
Global model norm: 1.8286515480183272.
Norm before scaling: 3.475234834708594. Distance: 2.9672663143351303
Total norm for 5 adversaries is: 3.475234834708594. distance: 2.9672663143351303
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5925, Accuracy: 7776/8991 (86.4865%)
___Train Local_Simple,  epoch   2, local model 6, internal_epoch   1,  Average loss: 0.0204, Accuracy: 3703/5024 (73.7062%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6160, Accuracy: 8435/10000 (84.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 7, internal_epoch   1,  Average loss: 0.0235, Accuracy: 2465/3641 (67.7012%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7073, Accuracy: 8165/10000 (81.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 8, internal_epoch   1,  Average loss: 0.0204, Accuracy: 3491/4701 (74.2608%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6195, Accuracy: 8542/10000 (85.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 9, internal_epoch   1,  Average loss: 0.0251, Accuracy: 2298/3315 (69.3213%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7144, Accuracy: 8210/10000 (82.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 10, internal_epoch   1,  Average loss: 0.0240, Accuracy: 2347/3435 (68.3261%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7141, Accuracy: 8310/10000 (83.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0237, Accuracy: 2636/3917 (67.2964%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6686, Accuracy: 8342/10000 (83.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 12, internal_epoch   1,  Average loss: 0.0221, Accuracy: 2840/4069 (69.7960%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6709, Accuracy: 8367/10000 (83.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 13, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2744/3851 (71.2542%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.7371, Accuracy: 7833/10000 (78.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 14, internal_epoch   1,  Average loss: 0.0219, Accuracy: 2219/3110 (71.3505%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.1332, Accuracy: 7715/10000 (77.1500%), Attack Success Rate:0/10000(0.000)
time spent on training: 48.237988233566284
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.56089246 1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2327, Accuracy: 2135/10000 (21.3500%), Attack Success Rate:22/10000(0.220)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2392, Accuracy: 1652/8991 (18.3739%)
Done in 56.11115264892578 sec.
Server Epoch:3 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   3, local model 0, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2787/3973 (70.1485%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6667, Accuracy: 8410/10000 (84.1000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 1, internal_epoch   1,  Average loss: 0.0222, Accuracy: 2591/3656 (70.8698%), train_poison_data_count: 3656
Global model norm: 1.8292029699432.
Norm before scaling: 3.5794925658266976. Distance: 3.0584900742226795
Total norm for 5 adversaries is: 3.5794925658266976. distance: 3.0584900742226795
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5636, Accuracy: 7783/8991 (86.5643%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 2, internal_epoch   1,  Average loss: 0.0208, Accuracy: 2795/3821 (73.1484%), train_poison_data_count: 3821
Global model norm: 1.8292029699432.
Norm before scaling: 3.6141559593693544. Distance: 3.096363081516857
Total norm for 5 adversaries is: 3.6141559593693544. distance: 3.096363081516857
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5824, Accuracy: 7651/8991 (85.0962%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 3, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3109/4319 (71.9843%), train_poison_data_count: 4319
Global model norm: 1.8292029699432.
Norm before scaling: 3.6742815937408144. Distance: 3.177415790777611
Total norm for 5 adversaries is: 3.6742815937408144. distance: 3.177415790777611
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5854, Accuracy: 7679/8991 (85.4076%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 4, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3274/4396 (74.4768%), train_poison_data_count: 4396
Global model norm: 1.8292029699432.
Norm before scaling: 3.7221464146221823. Distance: 3.2332099622281065
Total norm for 5 adversaries is: 3.7221464146221823. distance: 3.2332099622281065
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5511, Accuracy: 7765/8991 (86.3641%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 5, internal_epoch   1,  Average loss: 0.0228, Accuracy: 2413/3341 (72.2239%), train_poison_data_count: 3341
Global model norm: 1.8292029699432.
Norm before scaling: 3.4826742220948046. Distance: 2.948670756984113
Total norm for 5 adversaries is: 3.4826742220948046. distance: 2.948670756984113
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.5974, Accuracy: 7760/8991 (86.3085%)
___Train Local_Simple,  epoch   3, local model 6, internal_epoch   1,  Average loss: 0.0202, Accuracy: 3727/5024 (74.1839%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.6016, Accuracy: 8556/10000 (85.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 7, internal_epoch   1,  Average loss: 0.0233, Accuracy: 2467/3641 (67.7561%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.7069, Accuracy: 8077/10000 (80.7700%), Attack Success Rate:0/10000(0.000)
