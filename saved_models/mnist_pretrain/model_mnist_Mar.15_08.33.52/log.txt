current path: saved_models/mnist_pretrain/model_mnist_Mar.15_08.33.52
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   1, local model 0, internal_epoch   1,  Average loss: 0.0337, Accuracy: 1812/3973 (45.6079%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.5891, Accuracy: 8011/10000 (80.1100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 1, internal_epoch   1,  Average loss: 0.0353, Accuracy: 1466/3656 (40.0985%), train_poison_data_count: 3656
Global model norm: 13.898006576196178.
Norm before scaling: 13.868287808460035. Distance: 2.664144744051013
Total norm for 5 adversaries is: 13.868287808460035. distance: 2.664144744051013
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.9405, Accuracy: 5994/8991 (66.6667%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 2, internal_epoch   1,  Average loss: 0.0328, Accuracy: 1676/3821 (43.8629%), train_poison_data_count: 3821
Global model norm: 13.898006576196178.
Norm before scaling: 13.883815405002881. Distance: 2.7807089461492693
Total norm for 5 adversaries is: 13.883815405002881. distance: 2.7807089461492693
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.6170, Accuracy: 7142/8991 (79.4350%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 3, internal_epoch   1,  Average loss: 0.0309, Accuracy: 2091/4319 (48.4140%), train_poison_data_count: 4319
Global model norm: 13.898006576196178.
Norm before scaling: 13.854663688903358. Distance: 2.942330143125101
Total norm for 5 adversaries is: 13.854663688903358. distance: 2.942330143125101
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4987, Accuracy: 7651/8991 (85.0962%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 4, internal_epoch   1,  Average loss: 0.0293, Accuracy: 2346/4396 (53.3667%), train_poison_data_count: 4396
Global model norm: 13.898006576196178.
Norm before scaling: 13.901379501717852. Distance: 3.1199012359245972
Total norm for 5 adversaries is: 13.901379501717852. distance: 3.1199012359245972
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.4750, Accuracy: 7782/8991 (86.5532%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 5, internal_epoch   1,  Average loss: 0.0369, Accuracy: 1252/3341 (37.4738%), train_poison_data_count: 3341
Global model norm: 13.898006576196178.
Norm before scaling: 13.866944870236548. Distance: 2.462635145012836
Total norm for 5 adversaries is: 13.866944870236548. distance: 2.462635145012836
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5909, Accuracy: 7469/8991 (83.0720%)
___Train Local_Simple,  epoch   1, local model 6, internal_epoch   1,  Average loss: 0.0294, Accuracy: 2612/5024 (51.9904%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.6293, Accuracy: 7854/10000 (78.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 7, internal_epoch   1,  Average loss: 0.0365, Accuracy: 1364/3641 (37.4622%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.8064, Accuracy: 7220/10000 (72.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 8, internal_epoch   1,  Average loss: 0.0306, Accuracy: 2215/4701 (47.1176%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.7968, Accuracy: 7268/10000 (72.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 9, internal_epoch   1,  Average loss: 0.0405, Accuracy: 1043/3315 (31.4630%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.9088, Accuracy: 7201/10000 (72.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 10, internal_epoch   1,  Average loss: 0.0386, Accuracy: 1158/3435 (33.7118%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.8582, Accuracy: 7040/10000 (70.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0357, Accuracy: 1542/3917 (39.3669%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.7487, Accuracy: 7256/10000 (72.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 12, internal_epoch   1,  Average loss: 0.0338, Accuracy: 1803/4069 (44.3106%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.8527, Accuracy: 6902/10000 (69.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 13, internal_epoch   1,  Average loss: 0.0337, Accuracy: 1713/3851 (44.4820%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.8925, Accuracy: 6933/10000 (69.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 14, internal_epoch   1,  Average loss: 0.0354, Accuracy: 1242/3110 (39.9357%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.6945, Accuracy: 6835/10000 (68.3500%), Attack Success Rate:0/10000(0.000)
time spent on training: 137.563903093338
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.43316945 0.46827385 0.48424282 0.11503672 0.09832731 0.09832731
 0.43316945 1.         1.         0.53761218 1.         1.
 1.         0.53761218 1.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2779, Accuracy: 1732/10000 (17.3200%), Attack Success Rate:30/10000(0.300)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2742, Accuracy: 1703/8991 (18.9412%)
Done in 163.7188286781311 sec.
Server Epoch:2 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   2, local model 0, internal_epoch   1,  Average loss: 0.0274, Accuracy: 2304/3973 (57.9914%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.4678, Accuracy: 8575/10000 (85.7500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 1, internal_epoch   1,  Average loss: 0.0285, Accuracy: 1881/3656 (51.4497%), train_poison_data_count: 3656
Global model norm: 13.910166122574424.
Norm before scaling: 13.970313067959388. Distance: 2.8618531874795763
Total norm for 5 adversaries is: 13.970313067959388. distance: 2.8618531874795763
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.4566, Accuracy: 7779/8991 (86.5199%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 2, internal_epoch   1,  Average loss: 0.0270, Accuracy: 2053/3821 (53.7294%), train_poison_data_count: 3821
Global model norm: 13.910166122574424.
Norm before scaling: 13.974322613453678. Distance: 2.9497486977301546
Total norm for 5 adversaries is: 13.974322613453678. distance: 2.9497486977301546
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.4720, Accuracy: 7668/8991 (85.2853%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 3, internal_epoch   1,  Average loss: 0.0252, Accuracy: 2584/4319 (59.8287%), train_poison_data_count: 4319
Global model norm: 13.910166122574424.
Norm before scaling: 13.934348258937954. Distance: 3.037634192748139
Total norm for 5 adversaries is: 13.934348258937954. distance: 3.037634192748139
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.4791, Accuracy: 7651/8991 (85.0962%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 4, internal_epoch   1,  Average loss: 0.0236, Accuracy: 2737/4396 (62.2611%), train_poison_data_count: 4396
Global model norm: 13.910166122574424.
Norm before scaling: 13.943072517929266. Distance: 3.096539559467498
Total norm for 5 adversaries is: 13.943072517929266. distance: 3.096539559467498
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.3896, Accuracy: 7937/8991 (88.2772%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 5, internal_epoch   1,  Average loss: 0.0296, Accuracy: 1751/3341 (52.4095%), train_poison_data_count: 3341
Global model norm: 13.910166122574424.
Norm before scaling: 13.986836921036295. Distance: 2.759408548395251
Total norm for 5 adversaries is: 13.986836921036295. distance: 2.759408548395251
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.5132, Accuracy: 7515/8991 (83.5836%)
___Train Local_Simple,  epoch   2, local model 6, internal_epoch   1,  Average loss: 0.0238, Accuracy: 3155/5024 (62.7986%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.4189, Accuracy: 8708/10000 (87.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 7, internal_epoch   1,  Average loss: 0.0298, Accuracy: 1863/3641 (51.1673%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.5137, Accuracy: 8428/10000 (84.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 8, internal_epoch   1,  Average loss: 0.0242, Accuracy: 2886/4701 (61.3912%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.4440, Accuracy: 8654/10000 (86.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 9, internal_epoch   1,  Average loss: 0.0326, Accuracy: 1541/3315 (46.4857%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.6205, Accuracy: 7952/10000 (79.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 10, internal_epoch   1,  Average loss: 0.0312, Accuracy: 1667/3435 (48.5298%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.5698, Accuracy: 8335/10000 (83.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0292, Accuracy: 2032/3917 (51.8764%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.5508, Accuracy: 8210/10000 (82.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 12, internal_epoch   1,  Average loss: 0.0274, Accuracy: 2335/4069 (57.3851%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.5006, Accuracy: 8520/10000 (85.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 13, internal_epoch   1,  Average loss: 0.0272, Accuracy: 2224/3851 (57.7512%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.5959, Accuracy: 8059/10000 (80.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 14, internal_epoch   1,  Average loss: 0.0288, Accuracy: 1695/3110 (54.5016%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.2056, Accuracy: 7780/10000 (77.8000%), Attack Success Rate:0/10000(0.000)
time spent on training: 151.14548802375793
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.55957808 0.32310047 0.09100376 0.         0.         0.
 0.         0.75252435 0.         0.         0.         0.67145987
 0.6507053  0.64508929 1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2595, Accuracy: 2281/10000 (22.8100%), Attack Success Rate:27/10000(0.270)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2554, Accuracy: 2251/8991 (25.0361%)
Done in 177.02888011932373 sec.
Server Epoch:3 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   3, local model 0, internal_epoch   1,  Average loss: 0.0252, Accuracy: 2411/3973 (60.6846%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.5102, Accuracy: 8505/10000 (85.0500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 1, internal_epoch   1,  Average loss: 0.0251, Accuracy: 2161/3656 (59.1083%), train_poison_data_count: 3656
Global model norm: 13.916933769053676.
Norm before scaling: 13.989955568604335. Distance: 2.838443710083485
Total norm for 5 adversaries is: 13.989955568604335. distance: 2.838443710083485
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.3858, Accuracy: 7940/8991 (88.3105%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 2, internal_epoch   1,  Average loss: 0.0245, Accuracy: 2258/3821 (59.0945%), train_poison_data_count: 3821
Global model norm: 13.916933769053676.
Norm before scaling: 13.990897898241679. Distance: 2.91492635486677
Total norm for 5 adversaries is: 13.990897898241679. distance: 2.91492635486677
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.4259, Accuracy: 7815/8991 (86.9203%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 3, internal_epoch   1,  Average loss: 0.0227, Accuracy: 2776/4319 (64.2741%), train_poison_data_count: 4319
Global model norm: 13.916933769053676.
Norm before scaling: 13.949830763142344. Distance: 2.9933109415430317
Total norm for 5 adversaries is: 13.949830763142344. distance: 2.9933109415430317
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.3897, Accuracy: 7910/8991 (87.9769%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 4, internal_epoch   1,  Average loss: 0.0212, Accuracy: 2908/4396 (66.1510%), train_poison_data_count: 4396
Global model norm: 13.916933769053676.
Norm before scaling: 13.958385744518363. Distance: 3.0486212005873097
Total norm for 5 adversaries is: 13.958385744518363. distance: 3.0486212005873097
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.3440, Accuracy: 8066/8991 (89.7119%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 5, internal_epoch   1,  Average loss: 0.0271, Accuracy: 1973/3341 (59.0542%), train_poison_data_count: 3341
Global model norm: 13.916933769053676.
Norm before scaling: 14.019365268765291. Distance: 2.7935984081812166
Total norm for 5 adversaries is: 14.019365268765291. distance: 2.7935984081812166
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.4028, Accuracy: 7888/8991 (87.7322%)
___Train Local_Simple,  epoch   3, local model 6, internal_epoch   1,  Average loss: 0.0213, Accuracy: 3393/5024 (67.5358%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.3888, Accuracy: 8809/10000 (88.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 7, internal_epoch   1,  Average loss: 0.0269, Accuracy: 2045/3641 (56.1659%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.4915, Accuracy: 8570/10000 (85.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 8, internal_epoch   1,  Average loss: 0.0223, Accuracy: 3067/4701 (65.2414%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.4783, Accuracy: 8402/10000 (84.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 9, internal_epoch   1,  Average loss: 0.0291, Accuracy: 1829/3315 (55.1735%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.5773, Accuracy: 8025/10000 (80.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 10, internal_epoch   1,  Average loss: 0.0276, Accuracy: 1973/3435 (57.4381%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.5023, Accuracy: 8524/10000 (85.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 11, internal_epoch   1,  Average loss: 0.0262, Accuracy: 2261/3917 (57.7227%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.5633, Accuracy: 8161/10000 (81.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 12, internal_epoch   1,  Average loss: 0.0242, Accuracy: 2595/4069 (63.7749%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.5363, Accuracy: 8265/10000 (82.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 13, internal_epoch   1,  Average loss: 0.0247, Accuracy: 2356/3851 (61.1789%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.5003, Accuracy: 8491/10000 (84.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 14, internal_epoch   1,  Average loss: 0.0261, Accuracy: 1895/3110 (60.9325%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.1076, Accuracy: 7426/10000 (74.2600%), Attack Success Rate:0/10000(0.000)
time spent on training: 159.10980987548828
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.00842895 0.         0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.2558, Accuracy: 2336/10000 (23.3600%), Attack Success Rate:16/10000(0.160)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.2511, Accuracy: 2306/8991 (25.6479%)
Done in 185.17459797859192 sec.
Server Epoch:4 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   4, local model 0, internal_epoch   1,  Average loss: 0.0241, Accuracy: 2457/3973 (61.8424%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.4723, Accuracy: 8562/10000 (85.6200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 1, internal_epoch   1,  Average loss: 0.0253, Accuracy: 2133/3656 (58.3425%), train_poison_data_count: 3656
Global model norm: 13.917698500217941.
Norm before scaling: 13.995573706498188. Distance: 2.850074191549909
Total norm for 5 adversaries is: 13.995573706498188. distance: 2.850074191549909
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.4239, Accuracy: 7813/8991 (86.8980%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 2, internal_epoch   1,  Average loss: 0.0239, Accuracy: 2355/3821 (61.6331%), train_poison_data_count: 3821
Global model norm: 13.917698500217941.
Norm before scaling: 13.976572871537515. Distance: 2.8566516351768025
Total norm for 5 adversaries is: 13.976572871537515. distance: 2.8566516351768025
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.4414, Accuracy: 7797/8991 (86.7201%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 3, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2773/4319 (64.2047%), train_poison_data_count: 4319
Global model norm: 13.917698500217941.
Norm before scaling: 13.983138693605573. Distance: 3.097175474246483
Total norm for 5 adversaries is: 13.983138693605573. distance: 3.097175474246483
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.3018, Accuracy: 8197/8991 (91.1689%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 4, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2929/4396 (66.6288%), train_poison_data_count: 4396
Global model norm: 13.917698500217941.
Norm before scaling: 13.98044146406949. Distance: 3.1122207271189946
Total norm for 5 adversaries is: 13.98044146406949. distance: 3.1122207271189946
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.3433, Accuracy: 8075/8991 (89.8120%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 5, internal_epoch   1,  Average loss: 0.0272, Accuracy: 1988/3341 (59.5031%), train_poison_data_count: 3341
Global model norm: 13.917698500217941.
Norm before scaling: 14.031903563912957. Distance: 2.841407230052931
Total norm for 5 adversaries is: 14.031903563912957. distance: 2.841407230052931
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.3924, Accuracy: 7926/8991 (88.1548%)
___Train Local_Simple,  epoch   4, local model 6, internal_epoch   1,  Average loss: 0.0211, Accuracy: 3419/5024 (68.0533%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.3664, Accuracy: 8881/10000 (88.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 7, internal_epoch   1,  Average loss: 0.0261, Accuracy: 2160/3641 (59.3244%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.5570, Accuracy: 8111/10000 (81.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 8, internal_epoch   1,  Average loss: 0.0216, Accuracy: 3115/4701 (66.2625%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.4119, Accuracy: 8810/10000 (88.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 9, internal_epoch   1,  Average loss: 0.0289, Accuracy: 1945/3315 (58.6727%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.6111, Accuracy: 7824/10000 (78.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 10, internal_epoch   1,  Average loss: 0.0277, Accuracy: 1986/3435 (57.8166%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.5666, Accuracy: 8100/10000 (81.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 11, internal_epoch   1,  Average loss: 0.0253, Accuracy: 2327/3917 (59.4077%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.5391, Accuracy: 8234/10000 (82.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 12, internal_epoch   1,  Average loss: 0.0237, Accuracy: 2628/4069 (64.5859%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.4595, Accuracy: 8476/10000 (84.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0241, Accuracy: 2397/3851 (62.2436%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.4225, Accuracy: 8727/10000 (87.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 14, internal_epoch   1,  Average loss: 0.0255, Accuracy: 1948/3110 (62.6367%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.1886, Accuracy: 7374/10000 (73.7400%), Attack Success Rate:0/10000(0.000)
time spent on training: 166.49836897850037
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.376195
 0.         0.25898776 0.         0.99808024 0.47724055 0.
 0.08040289 0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 2.2407, Accuracy: 2959/10000 (29.5900%), Attack Success Rate:7/10000(0.070)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 2.2360, Accuracy: 2930/8991 (32.5881%)
Done in 192.2007555961609 sec.
Server Epoch:5 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   5, local model 0, internal_epoch   1,  Average loss: 0.0235, Accuracy: 2618/3973 (65.8948%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.4747, Accuracy: 8532/10000 (85.3200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 1, internal_epoch   1,  Average loss: 0.0246, Accuracy: 2171/3656 (59.3818%), train_poison_data_count: 3656
Global model norm: 13.922289841076623.
Norm before scaling: 14.013453967164688. Distance: 2.863236118601087
Total norm for 5 adversaries is: 14.013453967164688. distance: 2.863236118601087
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.4589, Accuracy: 7667/8991 (85.2742%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 2, internal_epoch   1,  Average loss: 0.0233, Accuracy: 2359/3821 (61.7378%), train_poison_data_count: 3821
Global model norm: 13.922289841076623.
Norm before scaling: 14.003546674253913. Distance: 2.8831512334867644
Total norm for 5 adversaries is: 14.003546674253913. distance: 2.8831512334867644
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.4407, Accuracy: 7800/8991 (86.7534%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 3, internal_epoch   1,  Average loss: 0.0212, Accuracy: 2848/4319 (65.9412%), train_poison_data_count: 4319
Global model norm: 13.922289841076623.
Norm before scaling: 13.973133466130806. Distance: 3.012800564156194
Total norm for 5 adversaries is: 13.973133466130806. distance: 3.012800564156194
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.4238, Accuracy: 7825/8991 (87.0315%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0196, Accuracy: 3057/4396 (69.5405%), train_poison_data_count: 4396
Global model norm: 13.922289841076623.
Norm before scaling: 13.962899777282285. Distance: 2.9976092985332214
Total norm for 5 adversaries is: 13.962899777282285. distance: 2.9976092985332214
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.3456, Accuracy: 8077/8991 (89.8343%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 5, internal_epoch   1,  Average loss: 0.0258, Accuracy: 2062/3341 (61.7180%), train_poison_data_count: 3341
Global model norm: 13.922289841076623.
Norm before scaling: 14.051299793218641. Distance: 2.8496863477009953
Total norm for 5 adversaries is: 14.051299793218641. distance: 2.8496863477009953
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.5017, Accuracy: 7572/8991 (84.2176%)
___Train Local_Simple,  epoch   5, local model 6, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3522/5024 (70.1035%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.3436, Accuracy: 8964/10000 (89.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0247, Accuracy: 2220/3641 (60.9723%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.4793, Accuracy: 8535/10000 (85.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 8, internal_epoch   1,  Average loss: 0.0207, Accuracy: 3232/4701 (68.7513%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.7059, Accuracy: 7820/10000 (78.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 9, internal_epoch   1,  Average loss: 0.0271, Accuracy: 1938/3315 (58.4615%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.5808, Accuracy: 7956/10000 (79.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 10, internal_epoch   1,  Average loss: 0.0252, Accuracy: 2114/3435 (61.5429%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6895, Accuracy: 8075/10000 (80.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 11, internal_epoch   1,  Average loss: 0.0243, Accuracy: 2407/3917 (61.4501%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.5355, Accuracy: 8239/10000 (82.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 12, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2793/4069 (68.6409%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.4960, Accuracy: 8598/10000 (85.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 13, internal_epoch   1,  Average loss: 0.0236, Accuracy: 2425/3851 (62.9707%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.6042, Accuracy: 7875/10000 (78.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0242, Accuracy: 2032/3110 (65.3376%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.1894, Accuracy: 7883/10000 (78.8300%), Attack Success Rate:0/10000(0.000)
time spent on training: 177.34956169128418
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         1.         0.17167002 0.17167002 0.11874115 0.11874115
 0.19729377 0.28165248 0.19729377 0.50409825 1.         0.28165248
 0.52541571 0.44589251 1.        ]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.1993, Accuracy: 4131/10000 (41.3100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 2.1934, Accuracy: 4098/8991 (45.5789%)
Done in 203.20207834243774 sec.
Server Epoch:6 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   6, local model 0, internal_epoch   1,  Average loss: 0.0201, Accuracy: 2814/3973 (70.8281%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.4784, Accuracy: 8451/10000 (84.5100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 1, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2490/3656 (68.1072%), train_poison_data_count: 3656
Global model norm: 13.934840474606602.
Norm before scaling: 14.019452885334061. Distance: 2.75145890811527
Total norm for 5 adversaries is: 14.019452885334061. distance: 2.75145890811527
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.3810, Accuracy: 7974/8991 (88.6887%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 2, internal_epoch   1,  Average loss: 0.0204, Accuracy: 2673/3821 (69.9555%), train_poison_data_count: 3821
Global model norm: 13.934840474606602.
Norm before scaling: 14.04555511214146. Distance: 2.8965489077436914
Total norm for 5 adversaries is: 14.04555511214146. distance: 2.8965489077436914
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.3332, Accuracy: 8090/8991 (89.9789%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 3, internal_epoch   1,  Average loss: 0.0188, Accuracy: 3087/4319 (71.4749%), train_poison_data_count: 4319
Global model norm: 13.934840474606602.
Norm before scaling: 13.954405517599428. Distance: 2.8308227486160327
Total norm for 5 adversaries is: 13.954405517599428. distance: 2.8308227486160327
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.4118, Accuracy: 7928/8991 (88.1771%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3232/4396 (73.5214%), train_poison_data_count: 4396
Global model norm: 13.934840474606602.
Norm before scaling: 13.98678073755325. Distance: 2.946362052926257
Total norm for 5 adversaries is: 13.98678073755325. distance: 2.946362052926257
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.3188, Accuracy: 8142/8991 (90.5572%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 5, internal_epoch   1,  Average loss: 0.0226, Accuracy: 2366/3341 (70.8171%), train_poison_data_count: 3341
Global model norm: 13.934840474606602.
Norm before scaling: 14.091917472846747. Distance: 2.847078659862909
Total norm for 5 adversaries is: 14.091917472846747. distance: 2.847078659862909
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.3794, Accuracy: 7890/8991 (87.7544%)
___Train Local_Simple,  epoch   6, local model 6, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3749/5024 (74.6218%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.3670, Accuracy: 8831/10000 (88.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 7, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2417/3641 (66.3829%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.4471, Accuracy: 8692/10000 (86.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0181, Accuracy: 3413/4701 (72.6016%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.3649, Accuracy: 8939/10000 (89.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 9, internal_epoch   1,  Average loss: 0.0243, Accuracy: 2259/3315 (68.1448%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.4428, Accuracy: 8715/10000 (87.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 10, internal_epoch   1,  Average loss: 0.0227, Accuracy: 2294/3435 (66.7831%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.4694, Accuracy: 8656/10000 (86.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 11, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2668/3917 (68.1134%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.4551, Accuracy: 8555/10000 (85.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 12, internal_epoch   1,  Average loss: 0.0198, Accuracy: 3007/4069 (73.9002%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.3775, Accuracy: 8831/10000 (88.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 13, internal_epoch   1,  Average loss: 0.0210, Accuracy: 2687/3851 (69.7741%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.3817, Accuracy: 8895/10000 (88.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 14, internal_epoch   1,  Average loss: 0.0215, Accuracy: 2205/3110 (70.9003%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.0745, Accuracy: 7820/10000 (78.2000%), Attack Success Rate:0/10000(0.000)
time spent on training: 187.483966588974
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.22433208 0.         0.         0.         0.65656187
 0.11525756 0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 2.1858, Accuracy: 4375/10000 (43.7500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 2.1804, Accuracy: 4342/8991 (48.2927%)
Done in 213.77579832077026 sec.
Server Epoch:7 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   7, local model 0, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2871/3973 (72.2628%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.4008, Accuracy: 8783/10000 (87.8300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 1, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2567/3656 (70.2133%), train_poison_data_count: 3656
Global model norm: 13.937895764945733.
Norm before scaling: 14.036799975066934. Distance: 2.7699289399545
Total norm for 5 adversaries is: 14.036799975066934. distance: 2.7699289399545
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.3163, Accuracy: 8146/8991 (90.6017%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 2, internal_epoch   1,  Average loss: 0.0195, Accuracy: 2740/3821 (71.7090%), train_poison_data_count: 3821
Global model norm: 13.937895764945733.
Norm before scaling: 14.038815232414835. Distance: 2.846246315371977
Total norm for 5 adversaries is: 14.038815232414835. distance: 2.846246315371977
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.3842, Accuracy: 7916/8991 (88.0436%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 3, internal_epoch   1,  Average loss: 0.0183, Accuracy: 3097/4319 (71.7064%), train_poison_data_count: 4319
Global model norm: 13.937895764945733.
Norm before scaling: 13.97806847584564. Distance: 2.861619079170472
Total norm for 5 adversaries is: 13.97806847584564. distance: 2.861619079170472
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.3683, Accuracy: 7934/8991 (88.2438%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 4, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3301/4396 (75.0910%), train_poison_data_count: 4396
Global model norm: 13.937895764945733.
Norm before scaling: 13.990638872982847. Distance: 2.9180909811664946
Total norm for 5 adversaries is: 13.990638872982847. distance: 2.9180909811664946
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.2976, Accuracy: 8162/8991 (90.7797%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 5, internal_epoch   1,  Average loss: 0.0218, Accuracy: 2317/3341 (69.3505%), train_poison_data_count: 3341
Global model norm: 13.937895764945733.
Norm before scaling: 14.080378717184276. Distance: 2.7740684114036305
Total norm for 5 adversaries is: 14.080378717184276. distance: 2.7740684114036305
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.3898, Accuracy: 8021/8991 (89.2114%)
___Train Local_Simple,  epoch   7, local model 6, internal_epoch   1,  Average loss: 0.0178, Accuracy: 3688/5024 (73.4076%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.3159, Accuracy: 8997/10000 (89.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0214, Accuracy: 2448/3641 (67.2343%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.4515, Accuracy: 8608/10000 (86.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 8, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3542/4701 (75.3457%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.4201, Accuracy: 8770/10000 (87.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 9, internal_epoch   1,  Average loss: 0.0229, Accuracy: 2389/3315 (72.0664%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.4393, Accuracy: 8667/10000 (86.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0217, Accuracy: 2329/3435 (67.8020%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.4451, Accuracy: 8487/10000 (84.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 11, internal_epoch   1,  Average loss: 0.0204, Accuracy: 2793/3917 (71.3046%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.4294, Accuracy: 8570/10000 (85.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 12, internal_epoch   1,  Average loss: 0.0191, Accuracy: 2990/4069 (73.4824%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.3783, Accuracy: 8890/10000 (88.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 13, internal_epoch   1,  Average loss: 0.0199, Accuracy: 2729/3851 (70.8647%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.8749, Accuracy: 7051/10000 (70.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 14, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2238/3110 (71.9614%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.2494, Accuracy: 7308/10000 (73.0800%), Attack Success Rate:0/10000(0.000)
time spent on training: 197.7699568271637
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 2.1627, Accuracy: 4806/10000 (48.0600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 2.1565, Accuracy: 4771/8991 (53.0642%)
Done in 224.16346549987793 sec.
Server Epoch:8 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   8, local model 0, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2879/3973 (72.4641%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.3928, Accuracy: 8787/10000 (87.8700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 1, internal_epoch   1,  Average loss: 0.0198, Accuracy: 2613/3656 (71.4716%), train_poison_data_count: 3656
Global model norm: 13.943384955196104.
Norm before scaling: 14.055688997287772. Distance: 2.7933906716658092
Total norm for 5 adversaries is: 14.055688997287772. distance: 2.7933906716658092
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.3369, Accuracy: 8117/8991 (90.2792%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 2, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2769/3821 (72.4679%), train_poison_data_count: 3821
Global model norm: 13.943384955196104.
Norm before scaling: 14.047000464365993. Distance: 2.811380629839617
Total norm for 5 adversaries is: 14.047000464365993. distance: 2.811380629839617
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.3102, Accuracy: 8170/8991 (90.8686%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 3, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3189/4319 (73.8365%), train_poison_data_count: 4319
Global model norm: 13.943384955196104.
Norm before scaling: 13.988978816207869. Distance: 2.831901431561242
Total norm for 5 adversaries is: 13.988978816207869. distance: 2.831901431561242
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.3321, Accuracy: 8101/8991 (90.1012%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 4, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3316/4396 (75.4322%), train_poison_data_count: 4396
Global model norm: 13.943384955196104.
Norm before scaling: 13.961819493334424. Distance: 2.7811641036924595
Total norm for 5 adversaries is: 13.961819493334424. distance: 2.7811641036924595
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.3830, Accuracy: 7989/8991 (88.8555%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 5, internal_epoch   1,  Average loss: 0.0208, Accuracy: 2357/3341 (70.5477%), train_poison_data_count: 3341
Global model norm: 13.943384955196104.
Norm before scaling: 14.08463752320791. Distance: 2.7269479211381373
Total norm for 5 adversaries is: 14.08463752320791. distance: 2.7269479211381373
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.3416, Accuracy: 8122/8991 (90.3348%)
___Train Local_Simple,  epoch   8, local model 6, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3884/5024 (77.3089%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.4037, Accuracy: 8715/10000 (87.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 7, internal_epoch   1,  Average loss: 0.0203, Accuracy: 2511/3641 (68.9646%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.3881, Accuracy: 8922/10000 (89.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 8, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3546/4701 (75.4308%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.0713, Accuracy: 6664/10000 (66.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0224, Accuracy: 2382/3315 (71.8552%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.4121, Accuracy: 8750/10000 (87.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 10, internal_epoch   1,  Average loss: 0.0208, Accuracy: 2410/3435 (70.1601%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.4516, Accuracy: 8651/10000 (86.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 11, internal_epoch   1,  Average loss: 0.0203, Accuracy: 2758/3917 (70.4110%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.3601, Accuracy: 9025/10000 (90.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0186, Accuracy: 3073/4069 (75.5222%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.4509, Accuracy: 8436/10000 (84.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 13, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2822/3851 (73.2797%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.4471, Accuracy: 8595/10000 (85.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 14, internal_epoch   1,  Average loss: 0.0200, Accuracy: 2272/3110 (73.0547%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.9760, Accuracy: 7847/10000 (78.4700%), Attack Success Rate:0/10000(0.000)
time spent on training: 206.6151533126831
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 2.1569, Accuracy: 4897/10000 (48.9700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 2.1516, Accuracy: 4865/8991 (54.1097%)
Done in 232.83858156204224 sec.
Server Epoch:9 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   9, local model 0, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2928/3973 (73.6975%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.3663, Accuracy: 8994/10000 (89.9400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 1, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2644/3656 (72.3195%), train_poison_data_count: 3656
Global model norm: 13.944773055042546.
Norm before scaling: 14.029969426704316. Distance: 2.6792974160318015
Total norm for 5 adversaries is: 14.029969426704316. distance: 2.6792974160318015
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.3119, Accuracy: 8183/8991 (91.0132%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 2, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2788/3821 (72.9652%), train_poison_data_count: 3821
Global model norm: 13.944773055042546.
Norm before scaling: 14.076487184488824. Distance: 2.8864967353732296
Total norm for 5 adversaries is: 14.076487184488824. distance: 2.8864967353732296
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.4082, Accuracy: 7814/8991 (86.9091%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 3, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3228/4319 (74.7395%), train_poison_data_count: 4319
Global model norm: 13.944773055042546.
Norm before scaling: 13.985041665324397. Distance: 2.811243666747318
Total norm for 5 adversaries is: 13.985041665324397. distance: 2.811243666747318
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.3177, Accuracy: 8107/8991 (90.1679%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 4, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3332/4396 (75.7962%), train_poison_data_count: 4396
Global model norm: 13.944773055042546.
Norm before scaling: 14.030046101261236. Distance: 2.990085750102955
Total norm for 5 adversaries is: 14.030046101261236. distance: 2.990085750102955
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.2884, Accuracy: 8225/8991 (91.4804%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 5, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2444/3341 (73.1518%), train_poison_data_count: 3341
Global model norm: 13.944773055042546.
Norm before scaling: 14.101591715689956. Distance: 2.7607711180556573
Total norm for 5 adversaries is: 14.101591715689956. distance: 2.7607711180556573
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.3618, Accuracy: 7978/8991 (88.7332%)
___Train Local_Simple,  epoch   9, local model 6, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3889/5024 (77.4084%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.3862, Accuracy: 8923/10000 (89.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 7, internal_epoch   1,  Average loss: 0.0199, Accuracy: 2605/3641 (71.5463%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.4462, Accuracy: 8613/10000 (86.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 8, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3647/4701 (77.5792%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.3531, Accuracy: 8894/10000 (88.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 9, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2343/3315 (70.6787%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.4378, Accuracy: 8614/10000 (86.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 10, internal_epoch   1,  Average loss: 0.0210, Accuracy: 2415/3435 (70.3057%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.4493, Accuracy: 8604/10000 (86.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 11, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2770/3917 (70.7174%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.3985, Accuracy: 8744/10000 (87.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 12, internal_epoch   1,  Average loss: 0.0180, Accuracy: 3093/4069 (76.0138%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.4501, Accuracy: 8520/10000 (85.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0189, Accuracy: 2820/3851 (73.2277%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.4356, Accuracy: 8631/10000 (86.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 14, internal_epoch   1,  Average loss: 0.0194, Accuracy: 2330/3110 (74.9196%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.0349, Accuracy: 7848/10000 (78.4800%), Attack Success Rate:0/10000(0.000)
time spent on training: 217.62159395217896
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.06118813 0.0478397
 0.         0.         0.         0.20647563 0.         0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 2.1464, Accuracy: 5016/10000 (50.1600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 2.1407, Accuracy: 4985/8991 (55.4443%)
Done in 244.1337149143219 sec.
Server Epoch:10 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  10, local model 0, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2980/3973 (75.0063%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.3995, Accuracy: 8700/10000 (87.0000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 1, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2634/3656 (72.0460%), train_poison_data_count: 3656
Global model norm: 13.946676338245936.
Norm before scaling: 14.074158578659885. Distance: 2.789517747498811
Total norm for 5 adversaries is: 14.074158578659885. distance: 2.789517747498811
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.3252, Accuracy: 8045/8991 (89.4784%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 2, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2810/3821 (73.5410%), train_poison_data_count: 3821
Global model norm: 13.946676338245936.
Norm before scaling: 14.02956103246541. Distance: 2.7029332440226983
Total norm for 5 adversaries is: 14.02956103246541. distance: 2.7029332440226983
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.2779, Accuracy: 8291/8991 (92.2144%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 3, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3222/4319 (74.6006%), train_poison_data_count: 4319
Global model norm: 13.946676338245936.
Norm before scaling: 13.97570818640413. Distance: 2.753515164357273
Total norm for 5 adversaries is: 13.97570818640413. distance: 2.753515164357273
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.2813, Accuracy: 8267/8991 (91.9475%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 4, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3438/4396 (78.2075%), train_poison_data_count: 4396
Global model norm: 13.946676338245936.
Norm before scaling: 13.974596681729036. Distance: 2.7761717307210283
Total norm for 5 adversaries is: 13.974596681729036. distance: 2.7761717307210283
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.2791, Accuracy: 8259/8991 (91.8585%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 5, internal_epoch   1,  Average loss: 0.0198, Accuracy: 2492/3341 (74.5884%), train_poison_data_count: 3341
Global model norm: 13.946676338245936.
Norm before scaling: 14.058898193251245. Distance: 2.596020910875363
Total norm for 5 adversaries is: 14.058898193251245. distance: 2.596020910875363
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.3320, Accuracy: 8090/8991 (89.9789%)
___Train Local_Simple,  epoch  10, local model 6, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3898/5024 (77.5876%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.3496, Accuracy: 8911/10000 (89.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 7, internal_epoch   1,  Average loss: 0.0201, Accuracy: 2518/3641 (69.1568%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.4348, Accuracy: 8607/10000 (86.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 8, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3585/4701 (76.2604%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.3347, Accuracy: 9061/10000 (90.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 9, internal_epoch   1,  Average loss: 0.0220, Accuracy: 2395/3315 (72.2474%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.4037, Accuracy: 8786/10000 (87.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 10, internal_epoch   1,  Average loss: 0.0203, Accuracy: 2490/3435 (72.4891%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.3780, Accuracy: 8854/10000 (88.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0194, Accuracy: 2807/3917 (71.6620%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.3979, Accuracy: 8782/10000 (87.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3046/4069 (74.8587%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.4208, Accuracy: 8710/10000 (87.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2850/3851 (74.0068%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.3687, Accuracy: 8898/10000 (88.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2355/3110 (75.7235%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.0039, Accuracy: 8201/10000 (82.0100%), Attack Success Rate:0/10000(0.000)
time spent on training: 226.0730803012848
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.44639739 0.02786857 0.         0.         0.11148415 0.07298928
 0.         0.25598619 0.03320235 1.         0.         0.14435109
 0.25598619 0.03320235 1.        ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 2.1175, Accuracy: 5415/10000 (54.1500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 2.1114, Accuracy: 5384/8991 (59.8821%)
Done in 251.79176425933838 sec.
Server Epoch:11 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  11, local model 0, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3025/3973 (76.1389%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3692, Accuracy: 8882/10000 (88.8200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 1, internal_epoch   1,  Average loss: 0.0184, Accuracy: 2739/3656 (74.9179%), train_poison_data_count: 3656
Global model norm: 13.953230529591133.
Norm before scaling: 14.065442400503263. Distance: 2.717202985126052
Total norm for 5 adversaries is: 14.065442400503263. distance: 2.717202985126052
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.3098, Accuracy: 8139/8991 (90.5239%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 2, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2855/3821 (74.7187%), train_poison_data_count: 3821
Global model norm: 13.953230529591133.
Norm before scaling: 14.027691838134457. Distance: 2.657820831770175
Total norm for 5 adversaries is: 14.027691838134457. distance: 2.657820831770175
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.3716, Accuracy: 7932/8991 (88.2216%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 3, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3298/4319 (76.3603%), train_poison_data_count: 4319
Global model norm: 13.953230529591133.
Norm before scaling: 13.995991269161513. Distance: 2.7700615766546153
Total norm for 5 adversaries is: 13.995991269161513. distance: 2.7700615766546153
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.3039, Accuracy: 8229/8991 (91.5249%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 4, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3451/4396 (78.5032%), train_poison_data_count: 4396
Global model norm: 13.953230529591133.
Norm before scaling: 14.00459704537479. Distance: 2.8283623864459977
Total norm for 5 adversaries is: 14.00459704537479. distance: 2.8283623864459977
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.3742, Accuracy: 7930/8991 (88.1993%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 5, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2559/3341 (76.5938%), train_poison_data_count: 3341
Global model norm: 13.953230529591133.
Norm before scaling: 14.107942527470065. Distance: 2.6959398507050163
Total norm for 5 adversaries is: 14.107942527470065. distance: 2.6959398507050163
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.4048, Accuracy: 7868/8991 (87.5097%)
___Train Local_Simple,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3973/5024 (79.0804%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3261, Accuracy: 9012/10000 (90.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 7, internal_epoch   1,  Average loss: 0.0191, Accuracy: 2657/3641 (72.9745%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3985, Accuracy: 8788/10000 (87.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 8, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3619/4701 (76.9836%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3380, Accuracy: 8979/10000 (89.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 9, internal_epoch   1,  Average loss: 0.0204, Accuracy: 2411/3315 (72.7300%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3865, Accuracy: 8834/10000 (88.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 10, internal_epoch   1,  Average loss: 0.0189, Accuracy: 2507/3435 (72.9840%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3702, Accuracy: 8925/10000 (89.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0183, Accuracy: 2916/3917 (74.4447%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3786, Accuracy: 8911/10000 (89.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 12, internal_epoch   1,  Average loss: 0.0174, Accuracy: 3111/4069 (76.4561%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3481, Accuracy: 8949/10000 (89.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 13, internal_epoch   1,  Average loss: 0.0179, Accuracy: 2904/3851 (75.4090%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.4401, Accuracy: 8683/10000 (86.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0183, Accuracy: 2399/3110 (77.1383%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0281, Accuracy: 7719/10000 (77.1900%), Attack Success Rate:0/10000(0.000)
time spent on training: 236.29815340042114
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.11156409 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 2.1084, Accuracy: 5528/10000 (55.2800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 2.1033, Accuracy: 5493/8991 (61.0944%)
Done in 263.188040971756 sec.
Server Epoch:12 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  12, local model 0, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2979/3973 (74.9811%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4764, Accuracy: 8314/10000 (83.1400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   1,  Average loss: 0.0186, Accuracy: 2745/3656 (75.0821%), train_poison_data_count: 3656
Global model norm: 13.954665215418608.
Norm before scaling: 14.073723277429055. Distance: 2.7315670745954446
Total norm for 5 adversaries is: 14.073723277429055. distance: 2.7315670745954446
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.3003, Accuracy: 8206/8991 (91.2690%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2964/3821 (77.5713%), train_poison_data_count: 3821
Global model norm: 13.954665215418608.
Norm before scaling: 14.068077778357983. Distance: 2.7579828917516997
Total norm for 5 adversaries is: 14.068077778357983. distance: 2.7579828917516997
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.3002, Accuracy: 8197/8991 (91.1689%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 3, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3340/4319 (77.3327%), train_poison_data_count: 4319
Global model norm: 13.954665215418608.
Norm before scaling: 14.00943873891088. Distance: 2.802673721986354
Total norm for 5 adversaries is: 14.00943873891088. distance: 2.802673721986354
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.3601, Accuracy: 7995/8991 (88.9223%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3462/4396 (78.7534%), train_poison_data_count: 4396
Global model norm: 13.954665215418608.
Norm before scaling: 13.995061820910037. Distance: 2.769396607821121
Total norm for 5 adversaries is: 13.995061820910037. distance: 2.769396607821121
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.2553, Accuracy: 8343/8991 (92.7928%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 5, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2547/3341 (76.2347%), train_poison_data_count: 3341
Global model norm: 13.954665215418608.
Norm before scaling: 14.075255174508882. Distance: 2.596199809045199
Total norm for 5 adversaries is: 14.075255174508882. distance: 2.596199809045199
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.3708, Accuracy: 8028/8991 (89.2893%)
___Train Local_Simple,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3929/5024 (78.2046%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3563, Accuracy: 8876/10000 (88.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 7, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2696/3641 (74.0456%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3901, Accuracy: 8807/10000 (88.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 8, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3720/4701 (79.1321%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3473, Accuracy: 8995/10000 (89.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 9, internal_epoch   1,  Average loss: 0.0203, Accuracy: 2442/3315 (73.6652%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3410, Accuracy: 8978/10000 (89.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 10, internal_epoch   1,  Average loss: 0.0194, Accuracy: 2508/3435 (73.0131%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3731, Accuracy: 8922/10000 (89.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2860/3917 (73.0151%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.5013, Accuracy: 8332/10000 (83.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 12, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3116/4069 (76.5790%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3833, Accuracy: 8768/10000 (87.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 13, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2926/3851 (75.9803%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.3965, Accuracy: 8819/10000 (88.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 14, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2395/3110 (77.0096%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0683, Accuracy: 7521/10000 (75.2100%), Attack Success Rate:0/10000(0.000)
time spent on training: 246.11775875091553
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.14256186 0.11684807 1.        ]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 2.0979, Accuracy: 5609/10000 (56.0900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 2.0923, Accuracy: 5574/8991 (61.9953%)
Done in 272.3346903324127 sec.
Server Epoch:13 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  13, local model 0, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3047/3973 (76.6927%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4619, Accuracy: 8491/10000 (84.9100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 1, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2796/3656 (76.4770%), train_poison_data_count: 3656
Global model norm: 13.956463285218094.
Norm before scaling: 14.059613419016452. Distance: 2.6606210983064953
Total norm for 5 adversaries is: 14.059613419016452. distance: 2.6606210983064953
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.3128, Accuracy: 8106/8991 (90.1568%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 2, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2939/3821 (76.9170%), train_poison_data_count: 3821
Global model norm: 13.956463285218094.
Norm before scaling: 14.073879944055495. Distance: 2.7707182972674254
Total norm for 5 adversaries is: 14.073879944055495. distance: 2.7707182972674254
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.3246, Accuracy: 8139/8991 (90.5239%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 3, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3301/4319 (76.4297%), train_poison_data_count: 4319
Global model norm: 13.956463285218094.
Norm before scaling: 14.00286182036216. Distance: 2.7598154720872055
Total norm for 5 adversaries is: 14.00286182036216. distance: 2.7598154720872055
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.3002, Accuracy: 8180/8991 (90.9799%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3525/4396 (80.1865%), train_poison_data_count: 4396
Global model norm: 13.956463285218094.
Norm before scaling: 13.988467234696298. Distance: 2.752089400264301
Total norm for 5 adversaries is: 13.988467234696298. distance: 2.752089400264301
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.2865, Accuracy: 8237/8991 (91.6138%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 5, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2602/3341 (77.8809%), train_poison_data_count: 3341
Global model norm: 13.956463285218094.
Norm before scaling: 14.064469263157315. Distance: 2.5264074840657065
Total norm for 5 adversaries is: 14.064469263157315. distance: 2.5264074840657065
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.3225, Accuracy: 8147/8991 (90.6128%)
___Train Local_Simple,  epoch  13, local model 6, internal_epoch   1,  Average loss: 0.0149, Accuracy: 4050/5024 (80.6131%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3699, Accuracy: 8741/10000 (87.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2648/3641 (72.7273%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3602, Accuracy: 8915/10000 (89.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 8, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3754/4701 (79.8553%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 2.4156, Accuracy: 4306/10000 (43.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 9, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2441/3315 (73.6350%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4336, Accuracy: 8579/10000 (85.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2599/3435 (75.6623%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4010, Accuracy: 8802/10000 (88.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2949/3917 (75.2872%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3789, Accuracy: 8871/10000 (88.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 12, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3188/4069 (78.3485%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4766, Accuracy: 8266/10000 (82.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 13, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2917/3851 (75.7466%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3450, Accuracy: 8894/10000 (88.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0179, Accuracy: 2400/3110 (77.1704%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.9826, Accuracy: 8157/10000 (81.5700%), Attack Success Rate:0/10000(0.000)
time spent on training: 256.3465075492859
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         1.         0.         0.         0.
 0.         0.         0.10108102]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 2.0877, Accuracy: 5855/10000 (58.5500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 2.0813, Accuracy: 5810/8991 (64.6202%)
Done in 281.9695086479187 sec.
Server Epoch:14 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  14, local model 0, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3048/3973 (76.7178%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3911, Accuracy: 8831/10000 (88.3100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 1, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2816/3656 (77.0241%), train_poison_data_count: 3656
Global model norm: 13.958176402258372.
Norm before scaling: 14.06598915047392. Distance: 2.678940026489459
Total norm for 5 adversaries is: 14.06598915047392. distance: 2.678940026489459
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.3191, Accuracy: 8111/8991 (90.2124%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2955/3821 (77.3358%), train_poison_data_count: 3821
Global model norm: 13.958176402258372.
Norm before scaling: 14.067661813063276. Distance: 2.739007306671703
Total norm for 5 adversaries is: 14.067661813063276. distance: 2.739007306671703
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.3494, Accuracy: 8055/8991 (89.5896%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 3, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3353/4319 (77.6337%), train_poison_data_count: 4319
Global model norm: 13.958176402258372.
Norm before scaling: 14.004722343724087. Distance: 2.752397705727347
Total norm for 5 adversaries is: 14.004722343724087. distance: 2.752397705727347
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.2880, Accuracy: 8261/8991 (91.8808%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3542/4396 (80.5732%), train_poison_data_count: 4396
Global model norm: 13.958176402258372.
Norm before scaling: 14.019396288358463. Distance: 2.8239270662448015
Total norm for 5 adversaries is: 14.019396288358463. distance: 2.8239270662448015
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.2923, Accuracy: 8221/8991 (91.4359%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 5, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2608/3341 (78.0605%), train_poison_data_count: 3341
Global model norm: 13.958176402258372.
Norm before scaling: 14.09898803542463. Distance: 2.6267857608163516
Total norm for 5 adversaries is: 14.09898803542463. distance: 2.6267857608163516
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.3794, Accuracy: 7893/8991 (87.7878%)
___Train Local_Simple,  epoch  14, local model 6, internal_epoch   1,  Average loss: 0.0148, Accuracy: 4033/5024 (80.2747%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3168, Accuracy: 9022/10000 (90.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2701/3641 (74.1829%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4066, Accuracy: 8719/10000 (87.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 8, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3676/4701 (78.1961%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3968, Accuracy: 8766/10000 (87.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 9, internal_epoch   1,  Average loss: 0.0195, Accuracy: 2495/3315 (75.2640%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4667, Accuracy: 8510/10000 (85.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0187, Accuracy: 2584/3435 (75.2256%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3907, Accuracy: 8858/10000 (88.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 11, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2944/3917 (75.1596%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3370, Accuracy: 9052/10000 (90.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3183/4069 (78.2256%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3356, Accuracy: 9024/10000 (90.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 13, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3026/3851 (78.5770%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3565, Accuracy: 8944/10000 (89.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 14, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2457/3110 (79.0032%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0441, Accuracy: 8171/10000 (81.7100%), Attack Success Rate:0/10000(0.000)
time spent on training: 266.28874135017395
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.03052335 0.         0.         0.16273404 0.         0.
 0.         0.12699295 1.        ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 2.0750, Accuracy: 5989/10000 (59.8900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 2.0692, Accuracy: 5925/8991 (65.8992%)
Done in 291.96380376815796 sec.
Server Epoch:15 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3067/3973 (77.1961%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4026, Accuracy: 8707/10000 (87.0700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2848/3656 (77.8993%), train_poison_data_count: 3656
Global model norm: 13.960259846452313.
Norm before scaling: 14.05721797502143. Distance: 2.6156638193838933
Total norm for 5 adversaries is: 14.05721797502143. distance: 2.6156638193838933
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.3458, Accuracy: 8029/8991 (89.3004%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 2, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3033/3821 (79.3771%), train_poison_data_count: 3821
Global model norm: 13.960259846452313.
Norm before scaling: 14.041243700548863. Distance: 2.6195071744054212
Total norm for 5 adversaries is: 14.041243700548863. distance: 2.6195071744054212
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.3238, Accuracy: 8082/8991 (89.8899%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 3, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3378/4319 (78.2125%), train_poison_data_count: 4319
Global model norm: 13.960259846452313.
Norm before scaling: 13.98846014441597. Distance: 2.6878301728165104
Total norm for 5 adversaries is: 13.98846014441597. distance: 2.6878301728165104
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.3522, Accuracy: 8027/8991 (89.2782%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3574/4396 (81.3012%), train_poison_data_count: 4396
Global model norm: 13.960259846452313.
Norm before scaling: 13.993476437701247. Distance: 2.71180662794712
Total norm for 5 adversaries is: 13.993476437701247. distance: 2.71180662794712
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.3028, Accuracy: 8110/8991 (90.2013%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 5, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2603/3341 (77.9108%), train_poison_data_count: 3341
Global model norm: 13.960259846452313.
Norm before scaling: 14.115819057222645. Distance: 2.6763144748409906
Total norm for 5 adversaries is: 14.115819057222645. distance: 2.6763144748409906
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.3970, Accuracy: 7838/8991 (87.1761%)
___Train Local_Simple,  epoch  15, local model 6, internal_epoch   1,  Average loss: 0.0147, Accuracy: 4014/5024 (79.8965%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3082, Accuracy: 9000/10000 (90.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 7, internal_epoch   1,  Average loss: 0.0183, Accuracy: 2625/3641 (72.0956%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3628, Accuracy: 8990/10000 (89.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 8, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3782/4701 (80.4510%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3456, Accuracy: 8944/10000 (89.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 9, internal_epoch   1,  Average loss: 0.0195, Accuracy: 2459/3315 (74.1780%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4161, Accuracy: 8700/10000 (87.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 10, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2571/3435 (74.8472%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4054, Accuracy: 8690/10000 (86.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 11, internal_epoch   1,  Average loss: 0.0174, Accuracy: 2966/3917 (75.7212%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3365, Accuracy: 9034/10000 (90.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3149/4069 (77.3900%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3876, Accuracy: 8844/10000 (88.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3081/3851 (80.0052%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4337, Accuracy: 8625/10000 (86.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2457/3110 (79.0032%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1261, Accuracy: 8093/10000 (80.9300%), Attack Success Rate:0/10000(0.000)
time spent on training: 273.1040213108063
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.26359767 1.         0.         0.         0.         0.
 0.16267171 0.11724771 0.16267171 0.85057697 0.00355772 0.11724771
 0.00355772 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 2.0278, Accuracy: 6447/10000 (64.4700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 2.0207, Accuracy: 6386/8991 (71.0266%)
Done in 299.7669539451599 sec.
Server Epoch:16 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  16, local model 0, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3107/3973 (78.2029%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3166, Accuracy: 9049/10000 (90.4900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 1, internal_epoch   1,  Average loss: 0.0164, Accuracy: 2917/3656 (79.7867%), train_poison_data_count: 3656
Global model norm: 13.96999904842824.
Norm before scaling: 14.122587014752567. Distance: 2.7500069358044636
Total norm for 5 adversaries is: 14.122587014752567. distance: 2.7500069358044636
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.2885, Accuracy: 8205/8991 (91.2579%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 2, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3043/3821 (79.6388%), train_poison_data_count: 3821
Global model norm: 13.96999904842824.
Norm before scaling: 14.049052815395266. Distance: 2.5715871508459034
Total norm for 5 adversaries is: 14.049052815395266. distance: 2.5715871508459034
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.3148, Accuracy: 8132/8991 (90.4460%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 3, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3399/4319 (78.6988%), train_poison_data_count: 4319
Global model norm: 13.96999904842824.
Norm before scaling: 13.997627057198727. Distance: 2.6627138365360934
Total norm for 5 adversaries is: 13.997627057198727. distance: 2.6627138365360934
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.3576, Accuracy: 7984/8991 (88.7999%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0134, Accuracy: 3638/4396 (82.7571%), train_poison_data_count: 4396
Global model norm: 13.96999904842824.
Norm before scaling: 14.003951468720578. Distance: 2.663362830678647
Total norm for 5 adversaries is: 14.003951468720578. distance: 2.663362830678647
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.2271, Accuracy: 8380/8991 (93.2043%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 5, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2595/3341 (77.6714%), train_poison_data_count: 3341
Global model norm: 13.96999904842824.
Norm before scaling: 14.154525820255833. Distance: 2.7286296539399766
Total norm for 5 adversaries is: 14.154525820255833. distance: 2.7286296539399766
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.3173, Accuracy: 8100/8991 (90.0901%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0140, Accuracy: 4098/5024 (81.5685%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3456, Accuracy: 8978/10000 (89.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 7, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2801/3641 (76.9294%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4263, Accuracy: 8720/10000 (87.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3763/4701 (80.0468%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3565, Accuracy: 8885/10000 (88.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 9, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2615/3315 (78.8839%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4132, Accuracy: 8729/10000 (87.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 10, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2612/3435 (76.0408%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3573, Accuracy: 8919/10000 (89.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3080/3917 (78.6316%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3788, Accuracy: 8825/10000 (88.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3275/4069 (80.4866%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.4407, Accuracy: 8706/10000 (87.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3104/3851 (80.6024%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3504, Accuracy: 8912/10000 (89.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 14, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2453/3110 (78.8746%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.0256, Accuracy: 7908/10000 (79.0800%), Attack Success Rate:0/10000(0.000)
time spent on training: 284.2643954753876
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.11466135 0.         0.45440485 0.         0.71672471
 0.         0.24786085 0.55653167 0.         0.57842328 0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 1.9901, Accuracy: 6792/10000 (67.9200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 1.9804, Accuracy: 6748/8991 (75.0528%)
Done in 309.6467773914337 sec.
Server Epoch:17 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  17, local model 0, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3190/3973 (80.2920%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3611, Accuracy: 8887/10000 (88.8700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 1, internal_epoch   1,  Average loss: 0.0157, Accuracy: 2922/3656 (79.9234%), train_poison_data_count: 3656
Global model norm: 13.977685856546385.
Norm before scaling: 14.068618460624519. Distance: 2.5202653628610343
Total norm for 5 adversaries is: 14.068618460624519. distance: 2.5202653628610343
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.2608, Accuracy: 8316/8991 (92.4925%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3097/3821 (81.0521%), train_poison_data_count: 3821
Global model norm: 13.977685856546385.
Norm before scaling: 14.07028647276882. Distance: 2.576294497679882
Total norm for 5 adversaries is: 14.07028647276882. distance: 2.576294497679882
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.3090, Accuracy: 8174/8991 (90.9131%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 3, internal_epoch   1,  Average loss: 0.0136, Accuracy: 3483/4319 (80.6437%), train_poison_data_count: 4319
Global model norm: 13.977685856546385.
Norm before scaling: 14.01066673462162. Distance: 2.610132804064248
Total norm for 5 adversaries is: 14.01066673462162. distance: 2.610132804064248
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.3021, Accuracy: 8174/8991 (90.9131%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0132, Accuracy: 3627/4396 (82.5068%), train_poison_data_count: 4396
Global model norm: 13.977685856546385.
Norm before scaling: 14.022789526290152. Distance: 2.6737069436164873
Total norm for 5 adversaries is: 14.022789526290152. distance: 2.6737069436164873
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.2549, Accuracy: 8301/8991 (92.3257%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 5, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2688/3341 (80.4550%), train_poison_data_count: 3341
Global model norm: 13.977685856546385.
Norm before scaling: 14.101497034993471. Distance: 2.4744262145798865
Total norm for 5 adversaries is: 14.101497034993471. distance: 2.4744262145798865
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.3563, Accuracy: 8019/8991 (89.1892%)
___Train Local_Simple,  epoch  17, local model 6, internal_epoch   1,  Average loss: 0.0134, Accuracy: 4115/5024 (81.9068%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2811, Accuracy: 9181/10000 (91.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 7, internal_epoch   1,  Average loss: 0.0162, Accuracy: 2806/3641 (77.0667%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3649, Accuracy: 8909/10000 (89.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 8, internal_epoch   1,  Average loss: 0.0129, Accuracy: 3924/4701 (83.4716%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3677, Accuracy: 8855/10000 (88.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 9, internal_epoch   1,  Average loss: 0.0177, Accuracy: 2598/3315 (78.3710%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3926, Accuracy: 8753/10000 (87.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2718/3435 (79.1266%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4560, Accuracy: 8513/10000 (85.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 11, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3076/3917 (78.5295%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3673, Accuracy: 8852/10000 (88.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 12, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3300/4069 (81.1010%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3303, Accuracy: 9055/10000 (90.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3100/3851 (80.4986%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.0760, Accuracy: 7100/10000 (71.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 14, internal_epoch   1,  Average loss: 0.0153, Accuracy: 2527/3110 (81.2540%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.0214, Accuracy: 8284/10000 (82.8400%), Attack Success Rate:0/10000(0.000)
time spent on training: 293.5824627876282
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 1.9667, Accuracy: 6926/10000 (69.2600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 1.9630, Accuracy: 6718/8991 (74.7192%)
Done in 320.00852823257446 sec.
Server Epoch:18 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  18, local model 0, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3227/3973 (81.2233%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3078, Accuracy: 9081/10000 (90.8100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 1, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2950/3656 (80.6893%), train_poison_data_count: 3656
Global model norm: 13.981545410309508.
Norm before scaling: 14.117670098454244. Distance: 2.672063898915764
Total norm for 5 adversaries is: 14.117670098454244. distance: 2.672063898915764
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.3990, Accuracy: 7841/8991 (87.2094%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 2, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3109/3821 (81.3661%), train_poison_data_count: 3821
Global model norm: 13.981545410309508.
Norm before scaling: 14.12071392556262. Distance: 2.734860883867343
Total norm for 5 adversaries is: 14.12071392556262. distance: 2.734860883867343
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.2632, Accuracy: 8290/8991 (92.2033%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 3, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3488/4319 (80.7594%), train_poison_data_count: 4319
Global model norm: 13.981545410309508.
Norm before scaling: 14.00903737063178. Distance: 2.5854101651765986
Total norm for 5 adversaries is: 14.00903737063178. distance: 2.5854101651765986
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.2852, Accuracy: 8218/8991 (91.4025%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0128, Accuracy: 3702/4396 (84.2129%), train_poison_data_count: 4396
Global model norm: 13.981545410309508.
Norm before scaling: 13.993473711646965. Distance: 2.5481228258181203
Total norm for 5 adversaries is: 13.993473711646965. distance: 2.5481228258181203
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.2630, Accuracy: 8341/8991 (92.7705%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 5, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2687/3341 (80.4250%), train_poison_data_count: 3341
Global model norm: 13.981545410309508.
Norm before scaling: 14.106986383325673. Distance: 2.47200261496742
Total norm for 5 adversaries is: 14.106986383325673. distance: 2.47200261496742
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.3090, Accuracy: 8224/8991 (91.4692%)
___Train Local_Simple,  epoch  18, local model 6, internal_epoch   1,  Average loss: 0.0130, Accuracy: 4129/5024 (82.1855%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4336, Accuracy: 8491/10000 (84.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0152, Accuracy: 2897/3641 (79.5661%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3723, Accuracy: 8902/10000 (89.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 8, internal_epoch   1,  Average loss: 0.0132, Accuracy: 3928/4701 (83.5567%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4284, Accuracy: 8572/10000 (85.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 9, internal_epoch   1,  Average loss: 0.0165, Accuracy: 2633/3315 (79.4268%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3784, Accuracy: 8794/10000 (87.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 10, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2687/3435 (78.2242%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3420, Accuracy: 9005/10000 (90.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 11, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3101/3917 (79.1677%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4138, Accuracy: 8740/10000 (87.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3340/4069 (82.0841%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3638, Accuracy: 8838/10000 (88.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 13, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3122/3851 (81.0699%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4349, Accuracy: 8592/10000 (85.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0150, Accuracy: 2558/3110 (82.2508%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.1405, Accuracy: 8282/10000 (82.8200%), Attack Success Rate:0/10000(0.000)
time spent on training: 304.2684528827667
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.1288238  0.06972142 0.29254889 0.17217223 0.         0.
 0.         0.10674569 0.48721597 0.         0.2527671  0.09838842
 0.34577235 0.33885445 1.        ]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 1.9271, Accuracy: 7146/10000 (71.4600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 1.9235, Accuracy: 6893/8991 (76.6656%)
Done in 330.98089385032654 sec.
Server Epoch:19 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  19, local model 0, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3239/3973 (81.5253%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3231, Accuracy: 9076/10000 (90.7600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 1, internal_epoch   1,  Average loss: 0.0149, Accuracy: 2973/3656 (81.3184%), train_poison_data_count: 3656
Global model norm: 13.988721936998536.
Norm before scaling: 14.063503110924268. Distance: 2.421629271808161
Total norm for 5 adversaries is: 14.063503110924268. distance: 2.421629271808161
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.3111, Accuracy: 8141/8991 (90.5461%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 2, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3167/3821 (82.8841%), train_poison_data_count: 3821
Global model norm: 13.988721936998536.
Norm before scaling: 14.05514347509369. Distance: 2.4462067062921005
Total norm for 5 adversaries is: 14.05514347509369. distance: 2.4462067062921005
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.3086, Accuracy: 8188/8991 (91.0688%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0131, Accuracy: 3518/4319 (81.4540%), train_poison_data_count: 4319
Global model norm: 13.988721936998536.
Norm before scaling: 14.025379609599142. Distance: 2.590423288993926
Total norm for 5 adversaries is: 14.025379609599142. distance: 2.590423288993926
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.2660, Accuracy: 8296/8991 (92.2700%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3737/4396 (85.0091%), train_poison_data_count: 4396
Global model norm: 13.988721936998536.
Norm before scaling: 14.055915884861601. Distance: 2.7077080126995514
Total norm for 5 adversaries is: 14.055915884861601. distance: 2.7077080126995514
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.2973, Accuracy: 8147/8991 (90.6128%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 5, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2710/3341 (81.1134%), train_poison_data_count: 3341
Global model norm: 13.988721936998536.
Norm before scaling: 14.139084537120908. Distance: 2.515917458919353
Total norm for 5 adversaries is: 14.139084537120908. distance: 2.515917458919353
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.2860, Accuracy: 8254/8991 (91.8029%)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0125, Accuracy: 4200/5024 (83.5987%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2909, Accuracy: 9106/10000 (91.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 7, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2878/3641 (79.0442%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4050, Accuracy: 8769/10000 (87.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0130, Accuracy: 3887/4701 (82.6845%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8420, Accuracy: 7679/10000 (76.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 9, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2640/3315 (79.6380%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3332, Accuracy: 8986/10000 (89.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 10, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2748/3435 (80.0000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3975, Accuracy: 8902/10000 (89.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 11, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3123/3917 (79.7294%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3009, Accuracy: 9112/10000 (91.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 12, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3301/4069 (81.1256%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3845, Accuracy: 8801/10000 (88.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 13, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3130/3851 (81.2776%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.3128, Accuracy: 9057/10000 (90.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 14, internal_epoch   1,  Average loss: 0.0141, Accuracy: 2592/3110 (83.3441%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.0472, Accuracy: 8187/10000 (81.8700%), Attack Success Rate:0/10000(0.000)
time spent on training: 312.21557784080505
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 1.9161, Accuracy: 7042/10000 (70.4200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 1.9129, Accuracy: 6729/8991 (74.8415%)
Done in 338.6632788181305 sec.
Server Epoch:20 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  20, local model 0, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3286/3973 (82.7083%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.4412, Accuracy: 8644/10000 (86.4400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 1, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2997/3656 (81.9748%), train_poison_data_count: 3656
Global model norm: 13.990674318827804.
Norm before scaling: 14.085490104861124. Distance: 2.469213997418038
Total norm for 5 adversaries is: 14.085490104861124. distance: 2.469213997418038
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.3174, Accuracy: 8125/8991 (90.3681%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 2, internal_epoch   1,  Average loss: 0.0136, Accuracy: 3183/3821 (83.3028%), train_poison_data_count: 3821
Global model norm: 13.990674318827804.
Norm before scaling: 14.098006390255591. Distance: 2.5709960399643186
Total norm for 5 adversaries is: 14.098006390255591. distance: 2.5709960399643186
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.2523, Accuracy: 8347/8991 (92.8373%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 3, internal_epoch   1,  Average loss: 0.0130, Accuracy: 3525/4319 (81.6161%), train_poison_data_count: 4319
Global model norm: 13.990674318827804.
Norm before scaling: 14.024842700314135. Distance: 2.556355902756186
Total norm for 5 adversaries is: 14.024842700314135. distance: 2.556355902756186
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.2580, Accuracy: 8287/8991 (92.1699%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 4, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3721/4396 (84.6451%), train_poison_data_count: 4396
Global model norm: 13.990674318827804.
Norm before scaling: 14.019088810411994. Distance: 2.570906179211118
Total norm for 5 adversaries is: 14.019088810411994. distance: 2.570906179211118
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.2290, Accuracy: 8408/8991 (93.5157%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 5, internal_epoch   1,  Average loss: 0.0155, Accuracy: 2705/3341 (80.9638%), train_poison_data_count: 3341
Global model norm: 13.990674318827804.
Norm before scaling: 14.141114351857306. Distance: 2.5160101364732093
Total norm for 5 adversaries is: 14.141114351857306. distance: 2.5160101364732093
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.2717, Accuracy: 8247/8991 (91.7251%)
___Train Local_Simple,  epoch  20, local model 6, internal_epoch   1,  Average loss: 0.0131, Accuracy: 4163/5024 (82.8623%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2923, Accuracy: 9091/10000 (90.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 7, internal_epoch   1,  Average loss: 0.0152, Accuracy: 2896/3641 (79.5386%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3469, Accuracy: 8943/10000 (89.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0129, Accuracy: 3938/4701 (83.7694%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3954, Accuracy: 8738/10000 (87.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 9, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2687/3315 (81.0558%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3522, Accuracy: 8923/10000 (89.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 10, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2781/3435 (80.9607%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3496, Accuracy: 8961/10000 (89.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3132/3917 (79.9592%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3637, Accuracy: 8855/10000 (88.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0131, Accuracy: 3388/4069 (83.2637%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3467, Accuracy: 8941/10000 (89.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3115/3851 (80.8881%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3856, Accuracy: 8799/10000 (87.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 14, internal_epoch   1,  Average loss: 0.0138, Accuracy: 2587/3110 (83.1833%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0467, Accuracy: 7983/10000 (79.8300%), Attack Success Rate:0/10000(0.000)
time spent on training: 324.17582058906555
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.05125382 0.         0.79819793
 0.         0.13708602 0.         0.52646284 0.4642051  0.65518482
 0.12228548 0.44557332 1.        ]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 1.8661, Accuracy: 7178/10000 (71.7800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 1.8610, Accuracy: 6933/8991 (77.1104%)
Done in 349.18303179740906 sec.
Server Epoch:21 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  21, local model 0, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3248/3973 (81.7518%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3347, Accuracy: 9025/10000 (90.2500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 1, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3035/3656 (83.0142%), train_poison_data_count: 3656
Global model norm: 13.999887193497813.
Norm before scaling: 14.0807926813152. Distance: 2.4029857739024667
Total norm for 5 adversaries is: 14.0807926813152. distance: 2.4029857739024667
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.2263, Accuracy: 8416/8991 (93.6047%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 2, internal_epoch   1,  Average loss: 0.0133, Accuracy: 3203/3821 (83.8262%), train_poison_data_count: 3821
Global model norm: 13.999887193497813.
Norm before scaling: 14.101439685233883. Distance: 2.518292262888818
Total norm for 5 adversaries is: 14.101439685233883. distance: 2.518292262888818
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.2822, Accuracy: 8222/8991 (91.4470%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 3, internal_epoch   1,  Average loss: 0.0123, Accuracy: 3623/4319 (83.8852%), train_poison_data_count: 4319
Global model norm: 13.999887193497813.
Norm before scaling: 14.014941825079102. Distance: 2.4665870365830003
Total norm for 5 adversaries is: 14.014941825079102. distance: 2.4665870365830003
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.2886, Accuracy: 8159/8991 (90.7463%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 4, internal_epoch   1,  Average loss: 0.0122, Accuracy: 3662/4396 (83.3030%), train_poison_data_count: 4396
Global model norm: 13.999887193497813.
Norm before scaling: 14.04678592505128. Distance: 2.5991415954274317
Total norm for 5 adversaries is: 14.04678592505128. distance: 2.5991415954274317
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.2254, Accuracy: 8387/8991 (93.2822%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 5, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2749/3341 (82.2808%), train_poison_data_count: 3341
Global model norm: 13.999887193497813.
Norm before scaling: 14.141018317216464. Distance: 2.4433200506740076
Total norm for 5 adversaries is: 14.141018317216464. distance: 2.4433200506740076
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.2748, Accuracy: 8239/8991 (91.6361%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0125, Accuracy: 4177/5024 (83.1409%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2776, Accuracy: 9138/10000 (91.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 7, internal_epoch   1,  Average loss: 0.0142, Accuracy: 2923/3641 (80.2801%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3306, Accuracy: 9022/10000 (90.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 8, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3951/4701 (84.0459%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3672, Accuracy: 8874/10000 (88.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 9, internal_epoch   1,  Average loss: 0.0158, Accuracy: 2679/3315 (80.8145%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3839, Accuracy: 8840/10000 (88.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0148, Accuracy: 2792/3435 (81.2809%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4489, Accuracy: 8551/10000 (85.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 11, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3143/3917 (80.2400%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3439, Accuracy: 8914/10000 (89.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0128, Accuracy: 3399/4069 (83.5340%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3796, Accuracy: 8752/10000 (87.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 13, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3134/3851 (81.3815%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3334, Accuracy: 8944/10000 (89.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   1,  Average loss: 0.0134, Accuracy: 2605/3110 (83.7621%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.9509, Accuracy: 8215/10000 (82.1500%), Attack Success Rate:0/10000(0.000)
time spent on training: 333.81586170196533
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.38140217 0.17670926 0.         0.         0.         0.
 0.26919124 0.23092657 0.3293394  0.72338797 0.32397652 0.03743465
 0.03743465 0.23092657 1.        ]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 1.8182, Accuracy: 7431/10000 (74.3100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 1.8135, Accuracy: 7084/8991 (78.7899%)
Done in 359.7981004714966 sec.
Server Epoch:22 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  22, local model 0, internal_epoch   1,  Average loss: 0.0129, Accuracy: 3275/3973 (82.4314%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3702, Accuracy: 8868/10000 (88.6800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 1, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3031/3656 (82.9048%), train_poison_data_count: 3656
Global model norm: 14.008368579488087.
Norm before scaling: 14.130021814544103. Distance: 2.5113955181488
Total norm for 5 adversaries is: 14.130021814544103. distance: 2.5113955181488
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2519, Accuracy: 8284/8991 (92.1366%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 2, internal_epoch   1,  Average loss: 0.0127, Accuracy: 3195/3821 (83.6169%), train_poison_data_count: 3821
Global model norm: 14.008368579488087.
Norm before scaling: 14.059748537248597. Distance: 2.32668756747035
Total norm for 5 adversaries is: 14.059748537248597. distance: 2.32668756747035
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2814, Accuracy: 8255/8991 (91.8140%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 3, internal_epoch   1,  Average loss: 0.0118, Accuracy: 3642/4319 (84.3251%), train_poison_data_count: 4319
Global model norm: 14.008368579488087.
Norm before scaling: 14.003531964140445. Distance: 2.37666563553897
Total norm for 5 adversaries is: 14.003531964140445. distance: 2.37666563553897
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2366, Accuracy: 8314/8991 (92.4702%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0112, Accuracy: 3805/4396 (86.5560%), train_poison_data_count: 4396
Global model norm: 14.008368579488087.
Norm before scaling: 14.027415543884779. Distance: 2.4825419255122902
Total norm for 5 adversaries is: 14.027415543884779. distance: 2.4825419255122902
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2851, Accuracy: 8188/8991 (91.0688%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 5, internal_epoch   1,  Average loss: 0.0142, Accuracy: 2766/3341 (82.7896%), train_poison_data_count: 3341
Global model norm: 14.008368579488087.
Norm before scaling: 14.149683088116872. Distance: 2.4238868478797566
Total norm for 5 adversaries is: 14.149683088116872. distance: 2.4238868478797566
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.2403, Accuracy: 8358/8991 (92.9596%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0116, Accuracy: 4263/5024 (84.8527%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2863, Accuracy: 9170/10000 (91.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0139, Accuracy: 2963/3641 (81.3787%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3126, Accuracy: 9130/10000 (91.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0118, Accuracy: 3981/4701 (84.6841%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.4628, Accuracy: 8422/10000 (84.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2696/3315 (81.3273%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3610, Accuracy: 8887/10000 (88.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 10, internal_epoch   1,  Average loss: 0.0146, Accuracy: 2791/3435 (81.2518%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3507, Accuracy: 8975/10000 (89.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 11, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3170/3917 (80.9293%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3208, Accuracy: 9098/10000 (90.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 12, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3372/4069 (82.8705%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3006, Accuracy: 9152/10000 (91.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 13, internal_epoch   1,  Average loss: 0.0129, Accuracy: 3185/3851 (82.7058%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.9007, Accuracy: 7384/10000 (73.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 14, internal_epoch   1,  Average loss: 0.0133, Accuracy: 2614/3110 (84.0514%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.0107, Accuracy: 7587/10000 (75.8700%), Attack Success Rate:0/10000(0.000)
time spent on training: 341.3289330005646
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         1.         0.75609082]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 1.7959, Accuracy: 7533/10000 (75.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 1.7856, Accuracy: 7261/8991 (80.7585%)
Done in 367.229731798172 sec.
Server Epoch:23 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  23, local model 0, internal_epoch   1,  Average loss: 0.0128, Accuracy: 3277/3973 (82.4818%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4661, Accuracy: 8487/10000 (84.8700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 1, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3073/3656 (84.0536%), train_poison_data_count: 3656
Global model norm: 14.01193600420504.
Norm before scaling: 14.141865341838031. Distance: 2.527650510870231
Total norm for 5 adversaries is: 14.141865341838031. distance: 2.527650510870231
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.2607, Accuracy: 8243/8991 (91.6806%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 2, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3272/3821 (85.6320%), train_poison_data_count: 3821
Global model norm: 14.01193600420504.
Norm before scaling: 14.05703181445561. Distance: 2.2901524367258093
Total norm for 5 adversaries is: 14.05703181445561. distance: 2.2901524367258093
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.3407, Accuracy: 8026/8991 (89.2670%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3634/4319 (84.1398%), train_poison_data_count: 4319
Global model norm: 14.01193600420504.
Norm before scaling: 14.018722549119078. Distance: 2.420856187704894
Total norm for 5 adversaries is: 14.018722549119078. distance: 2.420856187704894
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.2920, Accuracy: 8233/8991 (91.5693%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 4, internal_epoch   1,  Average loss: 0.0114, Accuracy: 3745/4396 (85.1911%), train_poison_data_count: 4396
Global model norm: 14.01193600420504.
Norm before scaling: 14.021130011236334. Distance: 2.43643487987236
Total norm for 5 adversaries is: 14.021130011236334. distance: 2.43643487987236
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.2545, Accuracy: 8293/8991 (92.2367%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 5, internal_epoch   1,  Average loss: 0.0135, Accuracy: 2793/3341 (83.5977%), train_poison_data_count: 3341
Global model norm: 14.01193600420504.
Norm before scaling: 14.111939460157432. Distance: 2.2650605649619076
Total norm for 5 adversaries is: 14.111939460157432. distance: 2.2650605649619076
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.2773, Accuracy: 8254/8991 (91.8029%)
___Train Local_Simple,  epoch  23, local model 6, internal_epoch   1,  Average loss: 0.0115, Accuracy: 4230/5024 (84.1959%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2740, Accuracy: 9115/10000 (91.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 7, internal_epoch   1,  Average loss: 0.0136, Accuracy: 2989/3641 (82.0928%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3501, Accuracy: 8988/10000 (89.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 8, internal_epoch   1,  Average loss: 0.0114, Accuracy: 3989/4701 (84.8543%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.4287, Accuracy: 8571/10000 (85.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 9, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2733/3315 (82.4434%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3665, Accuracy: 8828/10000 (88.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   1,  Average loss: 0.0144, Accuracy: 2824/3435 (82.2125%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3468, Accuracy: 8925/10000 (89.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 11, internal_epoch   1,  Average loss: 0.0136, Accuracy: 3214/3917 (82.0526%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2933, Accuracy: 9151/10000 (91.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0122, Accuracy: 3430/4069 (84.2959%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3446, Accuracy: 8947/10000 (89.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 13, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3228/3851 (83.8224%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3812, Accuracy: 8796/10000 (87.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   1,  Average loss: 0.0125, Accuracy: 2612/3110 (83.9871%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.8516, Accuracy: 8405/10000 (84.0500%), Attack Success Rate:0/10000(0.000)
time spent on training: 351.8221085071564
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.4994278  0.         0.         0.         0.         0.
 0.         0.         0.42638361 0.         0.23885795 0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 1.7684, Accuracy: 7628/10000 (76.2800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 1.7602, Accuracy: 7253/8991 (80.6696%)
Done in 378.0725190639496 sec.
Server Epoch:24 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  24, local model 0, internal_epoch   1,  Average loss: 0.0130, Accuracy: 3298/3973 (83.0103%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3637, Accuracy: 8873/10000 (88.7300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 1, internal_epoch   1,  Average loss: 0.0136, Accuracy: 3054/3656 (83.5339%), train_poison_data_count: 3656
Global model norm: 14.016457829562027.
Norm before scaling: 14.138538994963708. Distance: 2.469961424460709
Total norm for 5 adversaries is: 14.138538994963708. distance: 2.469961424460709
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.2626, Accuracy: 8259/8991 (91.8585%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 2, internal_epoch   1,  Average loss: 0.0117, Accuracy: 3293/3821 (86.1816%), train_poison_data_count: 3821
Global model norm: 14.016457829562027.
Norm before scaling: 14.05004874115767. Distance: 2.230017514523549
Total norm for 5 adversaries is: 14.05004874115767. distance: 2.230017514523549
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.2920, Accuracy: 8195/8991 (91.1467%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3591/4319 (83.1442%), train_poison_data_count: 4319
Global model norm: 14.016457829562027.
Norm before scaling: 14.047761373591701. Distance: 2.4851317782547766
Total norm for 5 adversaries is: 14.047761373591701. distance: 2.4851317782547766
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.2332, Accuracy: 8378/8991 (93.1821%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 4, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3763/4396 (85.6005%), train_poison_data_count: 4396
Global model norm: 14.016457829562027.
Norm before scaling: 14.045004850653587. Distance: 2.4779695671374133
Total norm for 5 adversaries is: 14.045004850653587. distance: 2.4779695671374133
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.2565, Accuracy: 8265/8991 (91.9253%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 5, internal_epoch   1,  Average loss: 0.0134, Accuracy: 2794/3341 (83.6277%), train_poison_data_count: 3341
Global model norm: 14.016457829562027.
Norm before scaling: 14.130513153369169. Distance: 2.298780831342317
Total norm for 5 adversaries is: 14.130513153369169. distance: 2.298780831342317
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.2817, Accuracy: 8235/8991 (91.5916%)
___Train Local_Simple,  epoch  24, local model 6, internal_epoch   1,  Average loss: 0.0113, Accuracy: 4269/5024 (84.9721%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2416, Accuracy: 9309/10000 (93.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 7, internal_epoch   1,  Average loss: 0.0137, Accuracy: 2954/3641 (81.1316%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3043, Accuracy: 9100/10000 (91.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0112, Accuracy: 4016/4701 (85.4286%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3343, Accuracy: 8944/10000 (89.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 9, internal_epoch   1,  Average loss: 0.0147, Accuracy: 2681/3315 (80.8748%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2988, Accuracy: 9120/10000 (91.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 10, internal_epoch   1,  Average loss: 0.0136, Accuracy: 2832/3435 (82.4454%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2979, Accuracy: 9176/10000 (91.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 11, internal_epoch   1,  Average loss: 0.0135, Accuracy: 3172/3917 (80.9803%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3588, Accuracy: 8865/10000 (88.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3462/4069 (85.0823%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.4168, Accuracy: 8628/10000 (86.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0124, Accuracy: 3245/3851 (84.2638%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3302, Accuracy: 8988/10000 (89.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 14, internal_epoch   1,  Average loss: 0.0127, Accuracy: 2652/3110 (85.2733%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.8950, Accuracy: 8258/10000 (82.5800%), Attack Success Rate:0/10000(0.000)
time spent on training: 360.93011569976807
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.46939052 0.         0.         0.         0.         0.
 0.         0.10753893 0.         0.         0.         0.14077832
 0.40652539 0.16224277 1.        ]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 1.7378, Accuracy: 7683/10000 (76.8300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 1.7305, Accuracy: 7242/8991 (80.5472%)
Done in 387.2312595844269 sec.
Server Epoch:25 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   1,  Average loss: 0.0125, Accuracy: 3314/3973 (83.4130%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3119, Accuracy: 9048/10000 (90.4800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 1, internal_epoch   1,  Average loss: 0.0129, Accuracy: 3081/3656 (84.2724%), train_poison_data_count: 3656
Global model norm: 14.021363443420901.
Norm before scaling: 14.086308513035418. Distance: 2.2709244409419007
Total norm for 5 adversaries is: 14.086308513035418. distance: 2.2709244409419007
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.2879, Accuracy: 8207/8991 (91.2802%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 2, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3224/3821 (84.3758%), train_poison_data_count: 3821
Global model norm: 14.021363443420901.
Norm before scaling: 14.10148675533674. Distance: 2.3661375833398735
Total norm for 5 adversaries is: 14.10148675533674. distance: 2.3661375833398735
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.3062, Accuracy: 8155/8991 (90.7018%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0113, Accuracy: 3671/4319 (84.9965%), train_poison_data_count: 4319
Global model norm: 14.021363443420901.
Norm before scaling: 14.030526259348143. Distance: 2.389856052772303
Total norm for 5 adversaries is: 14.030526259348143. distance: 2.389856052772303
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.2547, Accuracy: 8312/8991 (92.4480%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3816/4396 (86.8062%), train_poison_data_count: 4396
Global model norm: 14.021363443420901.
Norm before scaling: 14.04542311653376. Distance: 2.452748360846861
Total norm for 5 adversaries is: 14.04542311653376. distance: 2.452748360846861
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.2173, Accuracy: 8415/8991 (93.5936%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 5, internal_epoch   1,  Average loss: 0.0135, Accuracy: 2795/3341 (83.6576%), train_poison_data_count: 3341
Global model norm: 14.021363443420901.
Norm before scaling: 14.135849288508345. Distance: 2.2839743663398266
Total norm for 5 adversaries is: 14.135849288508345. distance: 2.2839743663398266
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.2479, Accuracy: 8352/8991 (92.8929%)
___Train Local_Simple,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0111, Accuracy: 4284/5024 (85.2707%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3287, Accuracy: 9015/10000 (90.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 7, internal_epoch   1,  Average loss: 0.0132, Accuracy: 2972/3641 (81.6259%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4170, Accuracy: 8636/10000 (86.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0112, Accuracy: 4017/4701 (85.4499%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4059, Accuracy: 8746/10000 (87.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 9, internal_epoch   1,  Average loss: 0.0146, Accuracy: 2709/3315 (81.7195%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3056, Accuracy: 9061/10000 (90.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 10, internal_epoch   1,  Average loss: 0.0130, Accuracy: 2893/3435 (84.2213%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3349, Accuracy: 8912/10000 (89.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 11, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3208/3917 (81.8994%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3229, Accuracy: 9016/10000 (90.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0119, Accuracy: 3434/4069 (84.3942%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2828, Accuracy: 9164/10000 (91.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 13, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3221/3851 (83.6406%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.7204, Accuracy: 7668/10000 (76.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 14, internal_epoch   1,  Average loss: 0.0121, Accuracy: 2646/3110 (85.0804%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.9289, Accuracy: 8076/10000 (80.7600%), Attack Success Rate:0/10000(0.000)
time spent on training: 331.9677221775055
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        0.        0.        0.        1.
 0.7004632]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 1.7228, Accuracy: 7752/10000 (77.5200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 1.7114, Accuracy: 7367/8991 (81.9375%)
Done in 350.31514596939087 sec.
Server Epoch:26 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  26, local model 0, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3341/3973 (84.0926%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3601, Accuracy: 8975/10000 (89.7500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 1, internal_epoch   1,  Average loss: 0.0131, Accuracy: 3091/3656 (84.5460%), train_poison_data_count: 3656
Global model norm: 14.02448583738205.
Norm before scaling: 14.119421473422367. Distance: 2.363048195184794
Total norm for 5 adversaries is: 14.119421473422367. distance: 2.363048195184794
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2604, Accuracy: 8324/8991 (92.5815%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 2, internal_epoch   1,  Average loss: 0.0128, Accuracy: 3215/3821 (84.1403%), train_poison_data_count: 3821
Global model norm: 14.02448583738205.
Norm before scaling: 14.15903336065029. Distance: 2.5644166802912998
Total norm for 5 adversaries is: 14.15903336065029. distance: 2.5644166802912998
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2759, Accuracy: 8218/8991 (91.4025%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0113, Accuracy: 3711/4319 (85.9227%), train_poison_data_count: 4319
Global model norm: 14.02448583738205.
Norm before scaling: 14.028175339977064. Distance: 2.3572513547095024
Total norm for 5 adversaries is: 14.028175339977064. distance: 2.3572513547095024
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2390, Accuracy: 8371/8991 (93.1042%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0111, Accuracy: 3729/4396 (84.8271%), train_poison_data_count: 4396
Global model norm: 14.02448583738205.
Norm before scaling: 14.078409511726912. Distance: 2.5398305816919184
Total norm for 5 adversaries is: 14.078409511726912. distance: 2.5398305816919184
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2379, Accuracy: 8369/8991 (93.0820%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 5, internal_epoch   1,  Average loss: 0.0144, Accuracy: 2788/3341 (83.4481%), train_poison_data_count: 3341
Global model norm: 14.02448583738205.
Norm before scaling: 14.23725562149658. Distance: 2.6371109734316924
Total norm for 5 adversaries is: 14.23725562149658. distance: 2.6371109734316924
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.2640, Accuracy: 8311/8991 (92.4369%)
___Train Local_Simple,  epoch  26, local model 6, internal_epoch   1,  Average loss: 0.0110, Accuracy: 4284/5024 (85.2707%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2602, Accuracy: 9255/10000 (92.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 7, internal_epoch   1,  Average loss: 0.0124, Accuracy: 3030/3641 (83.2189%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3233, Accuracy: 9079/10000 (90.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   1,  Average loss: 0.0111, Accuracy: 4057/4701 (86.3008%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6499, Accuracy: 7655/10000 (76.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 9, internal_epoch   1,  Average loss: 0.0139, Accuracy: 2715/3315 (81.9005%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3052, Accuracy: 9173/10000 (91.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 10, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2866/3435 (83.4352%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3069, Accuracy: 9114/10000 (91.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0129, Accuracy: 3250/3917 (82.9717%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3702, Accuracy: 8777/10000 (87.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   1,  Average loss: 0.0118, Accuracy: 3437/4069 (84.4679%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3099, Accuracy: 9107/10000 (91.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3232/3851 (83.9263%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3582, Accuracy: 8836/10000 (88.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0124, Accuracy: 2634/3110 (84.6945%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.8285, Accuracy: 8241/10000 (82.4100%), Attack Success Rate:0/10000(0.000)
time spent on training: 307.2254707813263
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.32900784 0.         0.         0.         0.         0.2883834
 0.         0.         1.         0.         0.         0.
 0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 1.6718, Accuracy: 7843/10000 (78.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 1.6614, Accuracy: 7333/8991 (81.5593%)
Done in 325.5592703819275 sec.
Server Epoch:27 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3357/3973 (84.4953%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2919, Accuracy: 9183/10000 (91.8300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 1, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3070/3656 (83.9716%), train_poison_data_count: 3656
Global model norm: 14.033124700763814.
Norm before scaling: 14.128155651198503. Distance: 2.3486504758301496
Total norm for 5 adversaries is: 14.128155651198503. distance: 2.3486504758301496
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2758, Accuracy: 8238/8991 (91.6250%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0125, Accuracy: 3223/3821 (84.3496%), train_poison_data_count: 3821
Global model norm: 14.033124700763814.
Norm before scaling: 14.12989114793667. Distance: 2.4153949307217237
Total norm for 5 adversaries is: 14.12989114793667. distance: 2.4153949307217237
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2542, Accuracy: 8325/8991 (92.5926%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   1,  Average loss: 0.0111, Accuracy: 3684/4319 (85.2975%), train_poison_data_count: 4319
Global model norm: 14.033124700763814.
Norm before scaling: 14.04719924976845. Distance: 2.375271129190162
Total norm for 5 adversaries is: 14.04719924976845. distance: 2.375271129190162
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2205, Accuracy: 8431/8991 (93.7715%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 4, internal_epoch   1,  Average loss: 0.0106, Accuracy: 3811/4396 (86.6924%), train_poison_data_count: 4396
Global model norm: 14.033124700763814.
Norm before scaling: 14.05142738992505. Distance: 2.4108097420821726
Total norm for 5 adversaries is: 14.05142738992505. distance: 2.4108097420821726
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2862, Accuracy: 8182/8991 (91.0021%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 5, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2832/3341 (84.7650%), train_poison_data_count: 3341
Global model norm: 14.033124700763814.
Norm before scaling: 14.109022978893517. Distance: 2.1278355697118507
Total norm for 5 adversaries is: 14.109022978893517. distance: 2.1278355697118507
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.2823, Accuracy: 8251/8991 (91.7695%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.0105, Accuracy: 4309/5024 (85.7683%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2792, Accuracy: 9172/10000 (91.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 7, internal_epoch   1,  Average loss: 0.0124, Accuracy: 3035/3641 (83.3562%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3550, Accuracy: 8906/10000 (89.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 8, internal_epoch   1,  Average loss: 0.0108, Accuracy: 4035/4701 (85.8328%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4212, Accuracy: 8705/10000 (87.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 9, internal_epoch   1,  Average loss: 0.0139, Accuracy: 2717/3315 (81.9608%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3216, Accuracy: 9032/10000 (90.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   1,  Average loss: 0.0130, Accuracy: 2850/3435 (82.9694%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3421, Accuracy: 9035/10000 (90.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 11, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3270/3917 (83.4823%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2927, Accuracy: 9133/10000 (91.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 12, internal_epoch   1,  Average loss: 0.0114, Accuracy: 3471/4069 (85.3035%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3130, Accuracy: 9070/10000 (90.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 13, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3222/3851 (83.6666%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.3415, Accuracy: 8949/10000 (89.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.0118, Accuracy: 2670/3110 (85.8521%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.8263, Accuracy: 8228/10000 (82.2800%), Attack Success Rate:0/10000(0.000)
time spent on training: 315.71434783935547
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 1.6311, Accuracy: 7772/10000 (77.7200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 1.6210, Accuracy: 7276/8991 (80.9254%)
Done in 333.95388007164 sec.
Server Epoch:28 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  28, local model 0, internal_epoch   1,  Average loss: 0.0117, Accuracy: 3369/3973 (84.7974%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3124, Accuracy: 9078/10000 (90.7800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 1, internal_epoch   1,  Average loss: 0.0118, Accuracy: 3107/3656 (84.9836%), train_poison_data_count: 3656
Global model norm: 14.04030094617561.
Norm before scaling: 14.087142579656469. Distance: 2.170441957461763
Total norm for 5 adversaries is: 14.087142579656469. distance: 2.170441957461763
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.2498, Accuracy: 8348/8991 (92.8484%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3258/3821 (85.2656%), train_poison_data_count: 3821
Global model norm: 14.04030094617561.
Norm before scaling: 14.116985376596764. Distance: 2.3198048456917073
Total norm for 5 adversaries is: 14.116985376596764. distance: 2.3198048456917073
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.2419, Accuracy: 8330/8991 (92.6482%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   1,  Average loss: 0.0108, Accuracy: 3704/4319 (85.7606%), train_poison_data_count: 4319
Global model norm: 14.04030094617561.
Norm before scaling: 14.03558133227694. Distance: 2.2884382106181365
Total norm for 5 adversaries is: 14.03558133227694. distance: 2.2884382106181365
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.2269, Accuracy: 8385/8991 (93.2599%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 4, internal_epoch   1,  Average loss: 0.0100, Accuracy: 3832/4396 (87.1702%), train_poison_data_count: 4396
Global model norm: 14.04030094617561.
Norm before scaling: 14.051823746772216. Distance: 2.3572118076131656
Total norm for 5 adversaries is: 14.051823746772216. distance: 2.3572118076131656
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.2258, Accuracy: 8444/8991 (93.9161%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 5, internal_epoch   1,  Average loss: 0.0123, Accuracy: 2831/3341 (84.7351%), train_poison_data_count: 3341
Global model norm: 14.04030094617561.
Norm before scaling: 14.134432453626598. Distance: 2.1588941201507508
Total norm for 5 adversaries is: 14.134432453626598. distance: 2.1588941201507508
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.2341, Accuracy: 8379/8991 (93.1932%)
___Train Local_Simple,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0109, Accuracy: 4282/5024 (85.2309%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2759, Accuracy: 9159/10000 (91.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 7, internal_epoch   1,  Average loss: 0.0125, Accuracy: 3003/3641 (82.4773%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3530, Accuracy: 8971/10000 (89.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 8, internal_epoch   1,  Average loss: 0.0104, Accuracy: 4050/4701 (86.1519%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3266, Accuracy: 9026/10000 (90.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 9, internal_epoch   1,  Average loss: 0.0134, Accuracy: 2726/3315 (82.2323%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3515, Accuracy: 8897/10000 (88.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 10, internal_epoch   1,  Average loss: 0.0126, Accuracy: 2882/3435 (83.9010%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2995, Accuracy: 9158/10000 (91.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 11, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3225/3917 (82.3334%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3151, Accuracy: 9084/10000 (90.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 12, internal_epoch   1,  Average loss: 0.0108, Accuracy: 3500/4069 (86.0162%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2834, Accuracy: 9169/10000 (91.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 13, internal_epoch   1,  Average loss: 0.0116, Accuracy: 3288/3851 (85.3804%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2833, Accuracy: 9146/10000 (91.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 14, internal_epoch   1,  Average loss: 0.0119, Accuracy: 2665/3110 (85.6913%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.9534, Accuracy: 8261/10000 (82.6100%), Attack Success Rate:0/10000(0.000)
time spent on training: 325.38856053352356
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.18626241 0.19335827 0.         0.         0.         0.
 0.53242755 0.         0.39683313 0.         0.         0.16859439
 0.04834985 0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 1.5968, Accuracy: 7847/10000 (78.4700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 1.5881, Accuracy: 7233/8991 (80.4471%)
Done in 343.58517622947693 sec.
Server Epoch:29 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  29, local model 0, internal_epoch   1,  Average loss: 0.0114, Accuracy: 3404/3973 (85.6783%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3214, Accuracy: 9030/10000 (90.3000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 1, internal_epoch   1,  Average loss: 0.0125, Accuracy: 3079/3656 (84.2177%), train_poison_data_count: 3656
Global model norm: 14.046055923700388.
Norm before scaling: 14.157397899444767. Distance: 2.3702361867208643
Total norm for 5 adversaries is: 14.157397899444767. distance: 2.3702361867208643
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.2233, Accuracy: 8394/8991 (93.3600%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 2, internal_epoch   1,  Average loss: 0.0107, Accuracy: 3320/3821 (86.8882%), train_poison_data_count: 3821
Global model norm: 14.046055923700388.
Norm before scaling: 14.09406342760551. Distance: 2.1940974338077486
Total norm for 5 adversaries is: 14.09406342760551. distance: 2.1940974338077486
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.2607, Accuracy: 8257/8991 (91.8363%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   1,  Average loss: 0.0108, Accuracy: 3700/4319 (85.6680%), train_poison_data_count: 4319
Global model norm: 14.046055923700388.
Norm before scaling: 14.051711899259987. Distance: 2.304087001350001
Total norm for 5 adversaries is: 14.051711899259987. distance: 2.304087001350001
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.2472, Accuracy: 8322/8991 (92.5592%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 4, internal_epoch   1,  Average loss: 0.0098, Accuracy: 3835/4396 (87.2384%), train_poison_data_count: 4396
Global model norm: 14.046055923700388.
Norm before scaling: 14.048563515207535. Distance: 2.314677579273189
Total norm for 5 adversaries is: 14.048563515207535. distance: 2.314677579273189
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.2417, Accuracy: 8393/8991 (93.3489%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 5, internal_epoch   1,  Average loss: 0.0118, Accuracy: 2857/3341 (85.5133%), train_poison_data_count: 3341
Global model norm: 14.046055923700388.
Norm before scaling: 14.11392506921356. Distance: 2.0662342136931575
Total norm for 5 adversaries is: 14.11392506921356. distance: 2.0662342136931575
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.2262, Accuracy: 8404/8991 (93.4712%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0105, Accuracy: 4294/5024 (85.4697%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2775, Accuracy: 9181/10000 (91.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 7, internal_epoch   1,  Average loss: 0.0123, Accuracy: 3028/3641 (83.1640%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3042, Accuracy: 9088/10000 (90.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   1,  Average loss: 0.0103, Accuracy: 4090/4701 (87.0028%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3451, Accuracy: 8884/10000 (88.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 9, internal_epoch   1,  Average loss: 0.0132, Accuracy: 2728/3315 (82.2926%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2960, Accuracy: 9113/10000 (91.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 10, internal_epoch   1,  Average loss: 0.0117, Accuracy: 2902/3435 (84.4833%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3573, Accuracy: 8904/10000 (89.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 11, internal_epoch   1,  Average loss: 0.0119, Accuracy: 3297/3917 (84.1716%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3015, Accuracy: 9132/10000 (91.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 12, internal_epoch   1,  Average loss: 0.0109, Accuracy: 3475/4069 (85.4018%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3028, Accuracy: 9041/10000 (90.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 13, internal_epoch   1,  Average loss: 0.0112, Accuracy: 3283/3851 (85.2506%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.3001, Accuracy: 9020/10000 (90.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 14, internal_epoch   1,  Average loss: 0.0110, Accuracy: 2683/3110 (86.2701%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.9966, Accuracy: 8268/10000 (82.6800%), Attack Success Rate:0/10000(0.000)
time spent on training: 330.6190688610077
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.10056616 0.00130292 0.         0.         0.         0.
 0.         0.16897612 1.         0.04725155 0.07146752 1.
 0.07146752 0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 1.5470, Accuracy: 8065/10000 (80.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 1.5415, Accuracy: 7192/8991 (79.9911%)
Done in 348.7986145019531 sec.
Server Epoch:30 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  30, local model 0, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3392/3973 (85.3763%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2925, Accuracy: 9126/10000 (91.2600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 1, internal_epoch   1,  Average loss: 0.0118, Accuracy: 3102/3656 (84.8468%), train_poison_data_count: 3656
Global model norm: 14.054336280526833.
Norm before scaling: 14.109025682622121. Distance: 2.1704356961201206
Total norm for 5 adversaries is: 14.109025682622121. distance: 2.1704356961201206
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2510, Accuracy: 8359/8991 (92.9707%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 2, internal_epoch   1,  Average loss: 0.0108, Accuracy: 3273/3821 (85.6582%), train_poison_data_count: 3821
Global model norm: 14.054336280526833.
Norm before scaling: 14.106049645335851. Distance: 2.1960226519029575
Total norm for 5 adversaries is: 14.106049645335851. distance: 2.1960226519029575
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2514, Accuracy: 8289/8991 (92.1922%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   1,  Average loss: 0.0101, Accuracy: 3770/4319 (87.2887%), train_poison_data_count: 4319
Global model norm: 14.054336280526833.
Norm before scaling: 14.037410343797614. Distance: 2.216455051770957
Total norm for 5 adversaries is: 14.037410343797614. distance: 2.216455051770957
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2148, Accuracy: 8392/8991 (93.3378%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.0101, Accuracy: 3829/4396 (87.1019%), train_poison_data_count: 4396
Global model norm: 14.054336280526833.
Norm before scaling: 14.068729631433778. Distance: 2.362442750590349
Total norm for 5 adversaries is: 14.068729631433778. distance: 2.362442750590349
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2595, Accuracy: 8287/8991 (92.1699%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 5, internal_epoch   1,  Average loss: 0.0121, Accuracy: 2838/3341 (84.9446%), train_poison_data_count: 3341
Global model norm: 14.054336280526833.
Norm before scaling: 14.175079420832677. Distance: 2.2234980324971727
Total norm for 5 adversaries is: 14.175079420832677. distance: 2.2234980324971727
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.2167, Accuracy: 8410/8991 (93.5380%)
___Train Local_Simple,  epoch  30, local model 6, internal_epoch   1,  Average loss: 0.0099, Accuracy: 4346/5024 (86.5048%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2859, Accuracy: 9074/10000 (90.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 7, internal_epoch   1,  Average loss: 0.0114, Accuracy: 3083/3641 (84.6745%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3093, Accuracy: 9023/10000 (90.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0101, Accuracy: 4073/4701 (86.6411%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2801, Accuracy: 9179/10000 (91.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 9, internal_epoch   1,  Average loss: 0.0137, Accuracy: 2721/3315 (82.0814%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3146, Accuracy: 9056/10000 (90.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0123, Accuracy: 2896/3435 (84.3086%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2994, Accuracy: 9080/10000 (90.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0111, Accuracy: 3325/3917 (84.8864%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3567, Accuracy: 8838/10000 (88.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 12, internal_epoch   1,  Average loss: 0.0106, Accuracy: 3517/4069 (86.4340%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3124, Accuracy: 9050/10000 (90.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 13, internal_epoch   1,  Average loss: 0.0106, Accuracy: 3316/3851 (86.1075%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3257, Accuracy: 8977/10000 (89.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 14, internal_epoch   1,  Average loss: 0.0110, Accuracy: 2706/3110 (87.0096%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.7978, Accuracy: 8348/10000 (83.4800%), Attack Success Rate:0/10000(0.000)
time spent on training: 340.4630501270294
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.2285674 0.        0.        0.        0.
 1.       ]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 1.5300, Accuracy: 8142/10000 (81.4200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 1.5271, Accuracy: 7101/8991 (78.9790%)
Done in 358.7908959388733 sec.
Server Epoch:31 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  31, local model 0, internal_epoch   1,  Average loss: 0.0111, Accuracy: 3354/3973 (84.4198%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3623, Accuracy: 8813/10000 (88.1300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 1, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3117/3656 (85.2571%), train_poison_data_count: 3656
Global model norm: 14.056643745874672.
Norm before scaling: 14.145844060175579. Distance: 2.2758234357345097
Total norm for 5 adversaries is: 14.145844060175579. distance: 2.2758234357345097
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.3104, Accuracy: 8089/8991 (89.9677%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 2, internal_epoch   1,  Average loss: 0.0104, Accuracy: 3309/3821 (86.6004%), train_poison_data_count: 3821
Global model norm: 14.056643745874672.
Norm before scaling: 14.097036583257047. Distance: 2.14655423940129
Total norm for 5 adversaries is: 14.097036583257047. distance: 2.14655423940129
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.2714, Accuracy: 8227/8991 (91.5026%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   1,  Average loss: 0.0103, Accuracy: 3735/4319 (86.4784%), train_poison_data_count: 4319
Global model norm: 14.056643745874672.
Norm before scaling: 14.047688597475409. Distance: 2.2389678700822166
Total norm for 5 adversaries is: 14.047688597475409. distance: 2.2389678700822166
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.2477, Accuracy: 8286/8991 (92.1588%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0099, Accuracy: 3841/4396 (87.3749%), train_poison_data_count: 4396
Global model norm: 14.056643745874672.
Norm before scaling: 14.076376616946186. Distance: 2.346141358158314
Total norm for 5 adversaries is: 14.076376616946186. distance: 2.346141358158314
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.2000, Accuracy: 8443/8991 (93.9050%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 5, internal_epoch   1,  Average loss: 0.0119, Accuracy: 2838/3341 (84.9446%), train_poison_data_count: 3341
Global model norm: 14.056643745874672.
Norm before scaling: 14.17021733087046. Distance: 2.1929704112341186
Total norm for 5 adversaries is: 14.17021733087046. distance: 2.1929704112341186
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.2374, Accuracy: 8339/8991 (92.7483%)
___Train Local_Simple,  epoch  31, local model 6, internal_epoch   1,  Average loss: 0.0097, Accuracy: 4357/5024 (86.7237%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2685, Accuracy: 9152/10000 (91.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0117, Accuracy: 3075/3641 (84.4548%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3251, Accuracy: 8984/10000 (89.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 8, internal_epoch   1,  Average loss: 0.0100, Accuracy: 4098/4701 (87.1729%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2460, Accuracy: 9298/10000 (92.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0126, Accuracy: 2780/3315 (83.8612%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2906, Accuracy: 9133/10000 (91.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 10, internal_epoch   1,  Average loss: 0.0115, Accuracy: 2923/3435 (85.0946%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3287, Accuracy: 9002/10000 (90.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0112, Accuracy: 3353/3917 (85.6012%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2662, Accuracy: 9205/10000 (92.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0108, Accuracy: 3475/4069 (85.4018%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2801, Accuracy: 9199/10000 (91.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 13, internal_epoch   1,  Average loss: 0.0112, Accuracy: 3285/3851 (85.3025%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2831, Accuracy: 9170/10000 (91.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0108, Accuracy: 2692/3110 (86.5595%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.9518, Accuracy: 8114/10000 (81.1400%), Attack Success Rate:0/10000(0.000)
time spent on training: 348.77556109428406
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [5.27803527e-01 8.00888860e-01 2.58200339e-04 2.58200339e-04
 0.00000000e+00 0.00000000e+00 0.00000000e+00 5.87322055e-01
 4.01805439e-01 1.00000000e+00 3.56569589e-01 0.00000000e+00
 1.00000000e+00 5.54670107e-01 1.00000000e+00]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 1.4437, Accuracy: 8266/10000 (82.6600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 1.4411, Accuracy: 7216/8991 (80.2580%)
Done in 367.3017055988312 sec.
Server Epoch:32 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  32, local model 0, internal_epoch   1,  Average loss: 0.0105, Accuracy: 3417/3973 (86.0055%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2664, Accuracy: 9229/10000 (92.2900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 1, internal_epoch   1,  Average loss: 0.0112, Accuracy: 3144/3656 (85.9956%), train_poison_data_count: 3656
Global model norm: 14.07203127515656.
Norm before scaling: 14.128730753852016. Distance: 2.132084984414979
Total norm for 5 adversaries is: 14.128730753852016. distance: 2.132084984414979
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.3431, Accuracy: 7964/8991 (88.5775%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 2, internal_epoch   1,  Average loss: 0.0100, Accuracy: 3333/3821 (87.2285%), train_poison_data_count: 3821
Global model norm: 14.07203127515656.
Norm before scaling: 14.107852756511674. Distance: 2.102481343371411
Total norm for 5 adversaries is: 14.107852756511674. distance: 2.102481343371411
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.2245, Accuracy: 8387/8991 (93.2822%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   1,  Average loss: 0.0101, Accuracy: 3794/4319 (87.8444%), train_poison_data_count: 4319
Global model norm: 14.07203127515656.
Norm before scaling: 14.066291264109307. Distance: 2.218352806107108
Total norm for 5 adversaries is: 14.066291264109307. distance: 2.218352806107108
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.3584, Accuracy: 7984/8991 (88.7999%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 4, internal_epoch   1,  Average loss: 0.0095, Accuracy: 3849/4396 (87.5569%), train_poison_data_count: 4396
Global model norm: 14.07203127515656.
Norm before scaling: 14.088095196637878. Distance: 2.3016616872429303
Total norm for 5 adversaries is: 14.088095196637878. distance: 2.3016616872429303
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.2136, Accuracy: 8407/8991 (93.5046%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 5, internal_epoch   1,  Average loss: 0.0108, Accuracy: 2875/3341 (86.0521%), train_poison_data_count: 3341
Global model norm: 14.07203127515656.
Norm before scaling: 14.13344301385127. Distance: 1.9873887252847124
Total norm for 5 adversaries is: 14.13344301385127. distance: 1.9873887252847124
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.2399, Accuracy: 8356/8991 (92.9374%)
___Train Local_Simple,  epoch  32, local model 6, internal_epoch   1,  Average loss: 0.0095, Accuracy: 4395/5024 (87.4801%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3093, Accuracy: 9030/10000 (90.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 7, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3085/3641 (84.7295%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2988, Accuracy: 9082/10000 (90.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   1,  Average loss: 0.0094, Accuracy: 4118/4701 (87.5984%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3153, Accuracy: 9006/10000 (90.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 9, internal_epoch   1,  Average loss: 0.0119, Accuracy: 2850/3315 (85.9729%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3194, Accuracy: 9004/10000 (90.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 10, internal_epoch   1,  Average loss: 0.0111, Accuracy: 2957/3435 (86.0844%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3469, Accuracy: 8978/10000 (89.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 11, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3296/3917 (84.1460%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3242, Accuracy: 9049/10000 (90.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 12, internal_epoch   1,  Average loss: 0.0102, Accuracy: 3524/4069 (86.6060%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3455, Accuracy: 8855/10000 (88.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 13, internal_epoch   1,  Average loss: 0.0104, Accuracy: 3323/3851 (86.2893%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.3045, Accuracy: 9061/10000 (90.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 14, internal_epoch   1,  Average loss: 0.0102, Accuracy: 2688/3110 (86.4309%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.8360, Accuracy: 8280/10000 (82.8000%), Attack Success Rate:0/10000(0.000)
time spent on training: 358.4505236148834
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.05388937 0.03467806 0.03467806 0.50392617 0.         0.
 0.03221265 0.1515631  0.64657622 0.39242202 0.1515631  0.03221265
 0.44453579 0.66809238 1.        ]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 1.3850, Accuracy: 8392/10000 (83.9200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 1.3851, Accuracy: 7256/8991 (80.7029%)
Done in 377.0483546257019 sec.
Server Epoch:33 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  33, local model 0, internal_epoch   1,  Average loss: 0.0104, Accuracy: 3443/3973 (86.6600%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3437, Accuracy: 8995/10000 (89.9500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0111, Accuracy: 3142/3656 (85.9409%), train_poison_data_count: 3656
Global model norm: 14.081965694195537.
Norm before scaling: 14.174595009267737. Distance: 2.234897685770657
Total norm for 5 adversaries is: 14.174595009267737. distance: 2.234897685770657
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.2446, Accuracy: 8299/8991 (92.3034%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0096, Accuracy: 3341/3821 (87.4378%), train_poison_data_count: 3821
Global model norm: 14.081965694195537.
Norm before scaling: 14.083209035351228. Distance: 1.973625564373133
Total norm for 5 adversaries is: 14.083209035351228. distance: 1.973625564373133
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.2562, Accuracy: 8299/8991 (92.3034%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   1,  Average loss: 0.0101, Accuracy: 3749/4319 (86.8025%), train_poison_data_count: 4319
Global model norm: 14.081965694195537.
Norm before scaling: 14.075410740010396. Distance: 2.217696571109865
Total norm for 5 adversaries is: 14.075410740010396. distance: 2.217696571109865
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.2247, Accuracy: 8411/8991 (93.5491%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0092, Accuracy: 3861/4396 (87.8298%), train_poison_data_count: 4396
Global model norm: 14.081965694195537.
Norm before scaling: 14.084639689935717. Distance: 2.25087583237878
Total norm for 5 adversaries is: 14.084639689935717. distance: 2.25087583237878
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.2122, Accuracy: 8427/8991 (93.7271%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 5, internal_epoch   1,  Average loss: 0.0110, Accuracy: 2889/3341 (86.4711%), train_poison_data_count: 3341
Global model norm: 14.081965694195537.
Norm before scaling: 14.17483022006183. Distance: 2.1000125657568502
Total norm for 5 adversaries is: 14.17483022006183. distance: 2.1000125657568502
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.2197, Accuracy: 8415/8991 (93.5936%)
___Train Local_Simple,  epoch  33, local model 6, internal_epoch   1,  Average loss: 0.0090, Accuracy: 4382/5024 (87.2213%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2587, Accuracy: 9195/10000 (91.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 7, internal_epoch   1,  Average loss: 0.0107, Accuracy: 3144/3641 (86.3499%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2534, Accuracy: 9278/10000 (92.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 8, internal_epoch   1,  Average loss: 0.0090, Accuracy: 4141/4701 (88.0876%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3298, Accuracy: 8945/10000 (89.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 9, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2775/3315 (83.7104%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3291, Accuracy: 8985/10000 (89.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 10, internal_epoch   1,  Average loss: 0.0110, Accuracy: 2956/3435 (86.0553%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2943, Accuracy: 9184/10000 (91.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 11, internal_epoch   1,  Average loss: 0.0109, Accuracy: 3362/3917 (85.8310%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3120, Accuracy: 9046/10000 (90.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 12, internal_epoch   1,  Average loss: 0.0097, Accuracy: 3530/4069 (86.7535%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2555, Accuracy: 9297/10000 (92.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 13, internal_epoch   1,  Average loss: 0.0097, Accuracy: 3345/3851 (86.8606%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3422, Accuracy: 8930/10000 (89.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0095, Accuracy: 2732/3110 (87.8457%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.9529, Accuracy: 8135/10000 (81.3500%), Attack Success Rate:0/10000(0.000)
time spent on training: 366.86684823036194
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.33294024 0.01731109 0.         0.         0.         0.
 0.         0.         0.19263344 1.         0.         0.35204039
 0.05557854 0.44293901 1.        ]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 1.3377, Accuracy: 8401/10000 (84.0100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 1.3402, Accuracy: 7246/8991 (80.5917%)
Done in 385.5410056114197 sec.
Server Epoch:34 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0104, Accuracy: 3378/3973 (85.0239%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2743, Accuracy: 9205/10000 (92.0500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 1, internal_epoch   1,  Average loss: 0.0109, Accuracy: 3155/3656 (86.2965%), train_poison_data_count: 3656
Global model norm: 14.089910893588284.
Norm before scaling: 14.148370634160052. Distance: 2.1148090586584267
Total norm for 5 adversaries is: 14.148370634160052. distance: 2.1148090586584267
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2195, Accuracy: 8400/8991 (93.4268%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 2, internal_epoch   1,  Average loss: 0.0092, Accuracy: 3364/3821 (88.0398%), train_poison_data_count: 3821
Global model norm: 14.089910893588284.
Norm before scaling: 14.114903985729665. Distance: 2.025159655270047
Total norm for 5 adversaries is: 14.114903985729665. distance: 2.025159655270047
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2330, Accuracy: 8347/8991 (92.8373%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   1,  Average loss: 0.0095, Accuracy: 3751/4319 (86.8488%), train_poison_data_count: 4319
Global model norm: 14.089910893588284.
Norm before scaling: 14.07446376937707. Distance: 2.1651564494422852
Total norm for 5 adversaries is: 14.07446376937707. distance: 2.1651564494422852
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.3317, Accuracy: 8053/8991 (89.5673%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 4, internal_epoch   1,  Average loss: 0.0084, Accuracy: 3918/4396 (89.1265%), train_poison_data_count: 4396
Global model norm: 14.089910893588284.
Norm before scaling: 14.064874474012434. Distance: 2.1407136550699466
Total norm for 5 adversaries is: 14.064874474012434. distance: 2.1407136550699466
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2167, Accuracy: 8423/8991 (93.6826%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 5, internal_epoch   1,  Average loss: 0.0109, Accuracy: 2867/3341 (85.8126%), train_poison_data_count: 3341
Global model norm: 14.089910893588284.
Norm before scaling: 14.165044953516958. Distance: 2.0140027755748484
Total norm for 5 adversaries is: 14.165044953516958. distance: 2.0140027755748484
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.2125, Accuracy: 8441/8991 (93.8828%)
___Train Local_Simple,  epoch  34, local model 6, internal_epoch   1,  Average loss: 0.0089, Accuracy: 4401/5024 (87.5995%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2273, Accuracy: 9302/10000 (93.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 7, internal_epoch   1,  Average loss: 0.0107, Accuracy: 3094/3641 (84.9767%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.4224, Accuracy: 8673/10000 (86.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 8, internal_epoch   1,  Average loss: 0.0091, Accuracy: 4121/4701 (87.6622%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2845, Accuracy: 9134/10000 (91.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 9, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2810/3315 (84.7662%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2801, Accuracy: 9204/10000 (92.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 10, internal_epoch   1,  Average loss: 0.0110, Accuracy: 2902/3435 (84.4833%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3117, Accuracy: 9049/10000 (90.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 11, internal_epoch   1,  Average loss: 0.0106, Accuracy: 3305/3917 (84.3758%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3003, Accuracy: 9004/10000 (90.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 12, internal_epoch   1,  Average loss: 0.0096, Accuracy: 3541/4069 (87.0238%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2689, Accuracy: 9222/10000 (92.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 13, internal_epoch   1,  Average loss: 0.0101, Accuracy: 3306/3851 (85.8478%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2591, Accuracy: 9252/10000 (92.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 14, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2728/3110 (87.7170%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.7425, Accuracy: 8356/10000 (83.5600%), Attack Success Rate:0/10000(0.000)
time spent on training: 379.63817977905273
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 1.3254, Accuracy: 8447/10000 (84.4700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 1.3303, Accuracy: 7199/8991 (80.0690%)
Done in 398.6983449459076 sec.
Server Epoch:35 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  35, local model 0, internal_epoch   1,  Average loss: 0.0098, Accuracy: 3490/3973 (87.8429%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2729, Accuracy: 9207/10000 (92.0700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0102, Accuracy: 3209/3656 (87.7735%), train_poison_data_count: 3656
Global model norm: 14.091458897757446.
Norm before scaling: 14.098499385981595. Distance: 1.9257786501234353
Total norm for 5 adversaries is: 14.098499385981595. distance: 1.9257786501234353
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.2262, Accuracy: 8371/8991 (93.1042%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 2, internal_epoch   1,  Average loss: 0.0096, Accuracy: 3351/3821 (87.6996%), train_poison_data_count: 3821
Global model norm: 14.091458897757446.
Norm before scaling: 14.144260474486362. Distance: 2.121770873625905
Total norm for 5 adversaries is: 14.144260474486362. distance: 2.121770873625905
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.2695, Accuracy: 8251/8991 (91.7695%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   1,  Average loss: 0.0088, Accuracy: 3818/4319 (88.4001%), train_poison_data_count: 4319
Global model norm: 14.091458897757446.
Norm before scaling: 14.028083426961398. Distance: 1.9996390613066999
Total norm for 5 adversaries is: 14.028083426961398. distance: 1.9996390613066999
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1946, Accuracy: 8481/8991 (94.3277%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 4, internal_epoch   1,  Average loss: 0.0087, Accuracy: 3871/4396 (88.0573%), train_poison_data_count: 4396
Global model norm: 14.091458897757446.
Norm before scaling: 14.077751061557093. Distance: 2.176178435365549
Total norm for 5 adversaries is: 14.077751061557093. distance: 2.176178435365549
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1970, Accuracy: 8486/8991 (94.3833%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 5, internal_epoch   1,  Average loss: 0.0115, Accuracy: 2853/3341 (85.3936%), train_poison_data_count: 3341
Global model norm: 14.091458897757446.
Norm before scaling: 14.227314342091127. Distance: 2.2309207491680656
Total norm for 5 adversaries is: 14.227314342091127. distance: 2.2309207491680656
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.2533, Accuracy: 8295/8991 (92.2589%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   1,  Average loss: 0.0088, Accuracy: 4419/5024 (87.9578%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2356, Accuracy: 9260/10000 (92.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 7, internal_epoch   1,  Average loss: 0.0105, Accuracy: 3154/3641 (86.6246%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2852, Accuracy: 9155/10000 (91.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0092, Accuracy: 4129/4701 (87.8324%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3285, Accuracy: 8971/10000 (89.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 9, internal_epoch   1,  Average loss: 0.0118, Accuracy: 2818/3315 (85.0075%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3229, Accuracy: 8980/10000 (89.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 10, internal_epoch   1,  Average loss: 0.0108, Accuracy: 2968/3435 (86.4047%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3070, Accuracy: 9075/10000 (90.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 11, internal_epoch   1,  Average loss: 0.0100, Accuracy: 3395/3917 (86.6735%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2832, Accuracy: 9150/10000 (91.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0094, Accuracy: 3561/4069 (87.5154%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2738, Accuracy: 9163/10000 (91.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 13, internal_epoch   1,  Average loss: 0.0096, Accuracy: 3390/3851 (88.0291%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2898, Accuracy: 9112/10000 (91.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 14, internal_epoch   1,  Average loss: 0.0096, Accuracy: 2727/3110 (87.6849%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8068, Accuracy: 8333/10000 (83.3300%), Attack Success Rate:0/10000(0.000)
time spent on training: 540.8356649875641
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.31364738 0.11756335 0.14689096 0.         0.         0.28404177
 0.23092397 0.10493492 0.17588694 0.31469588 0.38787483 0.15923225
 0.10493492 0.90208295 1.        ]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 1.2671, Accuracy: 8502/10000 (85.0200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 1.2733, Accuracy: 7231/8991 (80.4249%)
Done in 571.3591389656067 sec.
Server Epoch:36 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  36, local model 0, internal_epoch   1,  Average loss: 0.0095, Accuracy: 3474/3973 (87.4402%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2487, Accuracy: 9229/10000 (92.2900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 1, internal_epoch   1,  Average loss: 0.0104, Accuracy: 3160/3656 (86.4333%), train_poison_data_count: 3656
Global model norm: 14.101575484758564.
Norm before scaling: 14.138607526143455. Distance: 2.0172073895148293
Total norm for 5 adversaries is: 14.138607526143455. distance: 2.0172073895148293
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.2126, Accuracy: 8434/8991 (93.8049%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 2, internal_epoch   1,  Average loss: 0.0093, Accuracy: 3349/3821 (87.6472%), train_poison_data_count: 3821
Global model norm: 14.101575484758564.
Norm before scaling: 14.119880761353608. Distance: 1.9832555061051358
Total norm for 5 adversaries is: 14.119880761353608. distance: 1.9832555061051358
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.2345, Accuracy: 8342/8991 (92.7817%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.0089, Accuracy: 3813/4319 (88.2843%), train_poison_data_count: 4319
Global model norm: 14.101575484758564.
Norm before scaling: 14.054430736085674. Distance: 2.032690974949191
Total norm for 5 adversaries is: 14.054430736085674. distance: 2.032690974949191
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.2188, Accuracy: 8413/8991 (93.5713%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0084, Accuracy: 3905/4396 (88.8308%), train_poison_data_count: 4396
Global model norm: 14.101575484758564.
Norm before scaling: 14.072585359179962. Distance: 2.1096647840589826
Total norm for 5 adversaries is: 14.072585359179962. distance: 2.1096647840589826
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.2168, Accuracy: 8405/8991 (93.4824%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 5, internal_epoch   1,  Average loss: 0.0098, Accuracy: 2925/3341 (87.5486%), train_poison_data_count: 3341
Global model norm: 14.101575484758564.
Norm before scaling: 14.13101419338998. Distance: 1.8245566339042745
Total norm for 5 adversaries is: 14.13101419338998. distance: 1.8245566339042745
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.2207, Accuracy: 8423/8991 (93.6826%)
___Train Local_Simple,  epoch  36, local model 6, internal_epoch   1,  Average loss: 0.0088, Accuracy: 4389/5024 (87.3607%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2869, Accuracy: 9097/10000 (90.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 7, internal_epoch   1,  Average loss: 0.0102, Accuracy: 3101/3641 (85.1689%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2910, Accuracy: 9158/10000 (91.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 8, internal_epoch   1,  Average loss: 0.0088, Accuracy: 4159/4701 (88.4705%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2581, Accuracy: 9253/10000 (92.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 9, internal_epoch   1,  Average loss: 0.0107, Accuracy: 2871/3315 (86.6063%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2656, Accuracy: 9217/10000 (92.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0101, Accuracy: 2994/3435 (87.1616%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2841, Accuracy: 9129/10000 (91.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 11, internal_epoch   1,  Average loss: 0.0104, Accuracy: 3358/3917 (85.7289%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2769, Accuracy: 9179/10000 (91.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 12, internal_epoch   1,  Average loss: 0.0097, Accuracy: 3513/4069 (86.3357%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2592, Accuracy: 9278/10000 (92.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 13, internal_epoch   1,  Average loss: 0.0098, Accuracy: 3333/3851 (86.5489%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.2988, Accuracy: 9102/10000 (91.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   1,  Average loss: 0.0091, Accuracy: 2765/3110 (88.9068%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.7445, Accuracy: 8411/10000 (84.1100%), Attack Success Rate:0/10000(0.000)
time spent on training: 562.3307518959045
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.03370221 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.18541928 0.
 0.         0.         1.        ]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 1.2518, Accuracy: 8515/10000 (85.1500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 1.2592, Accuracy: 7195/8991 (80.0245%)
Done in 595.2344093322754 sec.
Server Epoch:37 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.0096, Accuracy: 3448/3973 (86.7858%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.2900, Accuracy: 9113/10000 (91.1300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 1, internal_epoch   1,  Average loss: 0.0101, Accuracy: 3169/3656 (86.6794%), train_poison_data_count: 3656
Global model norm: 14.103700495819572.
Norm before scaling: 14.132750958613936. Distance: 1.9812089187743256
Total norm for 5 adversaries is: 14.132750958613936. distance: 1.9812089187743256
