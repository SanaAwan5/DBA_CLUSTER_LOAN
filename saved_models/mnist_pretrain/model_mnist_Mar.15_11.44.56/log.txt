current path: saved_models/mnist_pretrain/model_mnist_Mar.15_11.44.56
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   1, local model 0, internal_epoch   1,  Average loss: 0.0140, Accuracy: 2767/3973 (69.6451%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.3177, Accuracy: 9038/10000 (90.3800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 1, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2413/3656 (66.0011%), train_poison_data_count: 3656
Global model norm: 13.898006576196178.
Norm before scaling: 17.91542103303787. Distance: 11.166772490801813
Total norm for 5 adversaries is: 17.91542103303787. distance: 11.166772490801813
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.1977, Accuracy: 8413/8991 (93.5713%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 2, internal_epoch   1,  Average loss: 0.0154, Accuracy: 2556/3821 (66.8935%), train_poison_data_count: 3821
Global model norm: 13.898006576196178.
Norm before scaling: 18.01689457121383. Distance: 11.290590429688633
Total norm for 5 adversaries is: 18.01689457121383. distance: 11.290590429688633
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.2893, Accuracy: 8149/8991 (90.6351%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 3, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3065/4319 (70.9655%), train_poison_data_count: 4319
Global model norm: 13.898006576196178.
Norm before scaling: 17.5277463842488. Distance: 10.616470323919899
Total norm for 5 adversaries is: 17.5277463842488. distance: 10.616470323919899
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.2832, Accuracy: 8226/8991 (91.4915%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 4, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2920/4396 (66.4240%), train_poison_data_count: 4396
Global model norm: 13.898006576196178.
Norm before scaling: 21.40187925839728. Distance: 16.24518783916294
Total norm for 5 adversaries is: 21.40187925839728. distance: 16.24518783916294
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.2079, Accuracy: 8412/8991 (93.5602%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 5, internal_epoch   1,  Average loss: 0.0164, Accuracy: 2139/3341 (64.0227%), train_poison_data_count: 3341
Global model norm: 13.898006576196178.
Norm before scaling: 17.868042345367872. Distance: 11.083611812295848
Total norm for 5 adversaries is: 17.868042345367872. distance: 11.083611812295848
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.5273, Accuracy: 7615/8991 (84.6958%)
___Train Local_Simple,  epoch   1, local model 6, internal_epoch   1,  Average loss: 0.0125, Accuracy: 3703/5024 (73.7062%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.2836, Accuracy: 9172/10000 (91.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 7, internal_epoch   1,  Average loss: 0.0155, Accuracy: 2459/3641 (67.5364%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.2650, Accuracy: 9145/10000 (91.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 8, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3207/4701 (68.2195%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.2784, Accuracy: 9159/10000 (91.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 9, internal_epoch   1,  Average loss: 0.0188, Accuracy: 1974/3315 (59.5475%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.2820, Accuracy: 9192/10000 (91.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 10, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2291/3435 (66.6958%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.2539, Accuracy: 9222/10000 (92.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2472/3917 (63.1095%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.4245, Accuracy: 8801/10000 (88.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 12, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2623/4069 (64.4630%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.2690, Accuracy: 9227/10000 (92.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 13, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2466/3851 (64.0353%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 0.2851, Accuracy: 9117/10000 (91.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 14, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2011/3110 (64.6624%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.3328, Accuracy: 8199/10000 (81.9900%), Attack Success Rate:0/10000(0.000)
time spent on training: 142.1046588420868
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.52280572 0.49613632 0.49613632 0.6136843  1.         0.70337721
 0.31847082 0.92820698 1.         1.         0.31847082 1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.2790, Accuracy: 2363/10000 (23.6300%), Attack Success Rate:2/10000(0.020)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.2794, Accuracy: 2326/8991 (25.8703%)
Done in 169.7838795185089 sec.
Server Epoch:2 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   2, local model 0, internal_epoch   1,  Average loss: 0.0134, Accuracy: 2988/3973 (75.2077%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.3130, Accuracy: 9092/10000 (90.9200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 1, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2457/3656 (67.2046%), train_poison_data_count: 3656
Global model norm: 13.954302183859879.
Norm before scaling: 23.955246206223414. Distance: 19.203050307523576
Total norm for 5 adversaries is: 23.955246206223414. distance: 19.203050307523576
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.3584, Accuracy: 7983/8991 (88.7888%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 2, internal_epoch   1,  Average loss: 0.0150, Accuracy: 2754/3821 (72.0754%), train_poison_data_count: 3821
Global model norm: 13.954302183859879.
Norm before scaling: 20.816070891814498. Distance: 15.080415952900637
Total norm for 5 adversaries is: 20.816070891814498. distance: 15.080415952900637
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.2665, Accuracy: 8268/8991 (91.9586%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 3, internal_epoch   1,  Average loss: 0.0108, Accuracy: 3385/4319 (78.3746%), train_poison_data_count: 4319
Global model norm: 13.954302183859879.
Norm before scaling: 17.763694101312375. Distance: 10.436457964567836
Total norm for 5 adversaries is: 17.763694101312375. distance: 10.436457964567836
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.1866, Accuracy: 8477/8991 (94.2832%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 4, internal_epoch   1,  Average loss: 0.0123, Accuracy: 3360/4396 (76.4331%), train_poison_data_count: 4396
Global model norm: 13.954302183859879.
Norm before scaling: 19.382735351015345. Distance: 13.124952334362852
Total norm for 5 adversaries is: 19.382735351015345. distance: 13.124952334362852
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.1928, Accuracy: 8464/8991 (94.1386%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 5, internal_epoch   1,  Average loss: 0.0146, Accuracy: 2412/3341 (72.1940%), train_poison_data_count: 3341
Global model norm: 13.954302183859879.
Norm before scaling: 18.16493781493106. Distance: 11.02790103035269
Total norm for 5 adversaries is: 18.16493781493106. distance: 11.02790103035269
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.1813, Accuracy: 8539/8991 (94.9728%)
___Train Local_Simple,  epoch   2, local model 6, internal_epoch   1,  Average loss: 0.0109, Accuracy: 4003/5024 (79.6775%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.1636, Accuracy: 9485/10000 (94.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 7, internal_epoch   1,  Average loss: 0.0130, Accuracy: 2652/3641 (72.8371%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.2153, Accuracy: 9298/10000 (92.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 8, internal_epoch   1,  Average loss: 0.0108, Accuracy: 3712/4701 (78.9619%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.1929, Accuracy: 9379/10000 (93.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 9, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2259/3315 (68.1448%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.3021, Accuracy: 9023/10000 (90.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 10, internal_epoch   1,  Average loss: 0.0138, Accuracy: 2488/3435 (72.4309%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.2662, Accuracy: 9231/10000 (92.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0130, Accuracy: 2893/3917 (73.8575%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.3274, Accuracy: 9050/10000 (90.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 12, internal_epoch   1,  Average loss: 0.0130, Accuracy: 3100/4069 (76.1858%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.2079, Accuracy: 9346/10000 (93.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 13, internal_epoch   1,  Average loss: 0.0135, Accuracy: 2841/3851 (73.7730%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 0.2574, Accuracy: 9246/10000 (92.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 14, internal_epoch   1,  Average loss: 0.0127, Accuracy: 2388/3110 (76.7846%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.0527, Accuracy: 8472/10000 (84.7200%), Attack Success Rate:0/10000(0.000)
time spent on training: 150.4048912525177
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         1.         1.         1.         1.         1.
 1.         0.86923723 0.86923723 1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.2506, Accuracy: 4071/10000 (40.7100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.2474, Accuracy: 4046/8991 (45.0006%)
Done in 177.63841438293457 sec.
Server Epoch:3 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   3, local model 0, internal_epoch   1,  Average loss: 0.0103, Accuracy: 3238/3973 (81.5001%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.1838, Accuracy: 9461/10000 (94.6100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 1, internal_epoch   1,  Average loss: 0.0113, Accuracy: 2970/3656 (81.2363%), train_poison_data_count: 3656
Global model norm: 14.066973029924005.
Norm before scaling: 18.13859353531726. Distance: 10.422770631844633
Total norm for 5 adversaries is: 18.13859353531726. distance: 10.422770631844633
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2319, Accuracy: 8340/8991 (92.7594%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 2, internal_epoch   1,  Average loss: 0.0109, Accuracy: 3125/3821 (81.7849%), train_poison_data_count: 3821
Global model norm: 14.066973029924005.
Norm before scaling: 18.135430222239094. Distance: 10.432123866884607
Total norm for 5 adversaries is: 18.135430222239094. distance: 10.432123866884607
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.2500, Accuracy: 8266/8991 (91.9364%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 3, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3499/4319 (81.0141%), train_poison_data_count: 4319
Global model norm: 14.066973029924005.
Norm before scaling: 20.73748548988906. Distance: 14.37799200350085
Total norm for 5 adversaries is: 20.73748548988906. distance: 14.37799200350085
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.1747, Accuracy: 8506/8991 (94.6057%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 4, internal_epoch   1,  Average loss: 0.0090, Accuracy: 3732/4396 (84.8954%), train_poison_data_count: 4396
Global model norm: 14.066973029924005.
Norm before scaling: 18.081208041182304. Distance: 10.377276067520945
Total norm for 5 adversaries is: 18.081208041182304. distance: 10.377276067520945
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.1460, Accuracy: 8580/8991 (95.4288%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 5, internal_epoch   1,  Average loss: 0.0143, Accuracy: 2618/3341 (78.3598%), train_poison_data_count: 3341
Global model norm: 14.066973029924005.
Norm before scaling: 22.86070596988217. Distance: 17.27731239752412
Total norm for 5 adversaries is: 22.86070596988217. distance: 17.27731239752412
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.3305, Accuracy: 8079/8991 (89.8565%)
___Train Local_Simple,  epoch   3, local model 6, internal_epoch   1,  Average loss: 0.0130, Accuracy: 3921/5024 (78.0454%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.4568, Accuracy: 8563/10000 (85.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 7, internal_epoch   1,  Average loss: 0.0152, Accuracy: 2668/3641 (73.2766%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.2710, Accuracy: 9138/10000 (91.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 8, internal_epoch   1,  Average loss: 0.0111, Accuracy: 3809/4701 (81.0253%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.1814, Accuracy: 9427/10000 (94.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 9, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2453/3315 (73.9970%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.2743, Accuracy: 9125/10000 (91.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 10, internal_epoch   1,  Average loss: 0.0155, Accuracy: 2597/3435 (75.6041%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.3110, Accuracy: 9090/10000 (90.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 11, internal_epoch   1,  Average loss: 0.0118, Accuracy: 3116/3917 (79.5507%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.2185, Accuracy: 9337/10000 (93.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 12, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3288/4069 (80.8061%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.2319, Accuracy: 9273/10000 (92.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 13, internal_epoch   1,  Average loss: 0.0113, Accuracy: 3076/3851 (79.8754%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.2518, Accuracy: 9239/10000 (92.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 14, internal_epoch   1,  Average loss: 0.0113, Accuracy: 2511/3110 (80.7395%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.9476, Accuracy: 8405/10000 (84.0500%), Attack Success Rate:0/10000(0.000)
time spent on training: 157.6900191307068
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.50914825 0.55210788 0.04884417 1.         0.04884417 1.
 1.         1.         1.         1.         1.         1.
 0.53481633 0.65256421 0.50958105]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 2.2395, Accuracy: 3527/10000 (35.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 2.2341, Accuracy: 3714/8991 (41.3080%)
Done in 184.9036192893982 sec.
Server Epoch:4 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   4, local model 0, internal_epoch   1,  Average loss: 0.0097, Accuracy: 3290/3973 (82.8090%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.1695, Accuracy: 9491/10000 (94.9100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 1, internal_epoch   1,  Average loss: 0.0104, Accuracy: 3089/3656 (84.4912%), train_poison_data_count: 3656
Global model norm: 14.18606519796033.
Norm before scaling: 17.54743066656902. Distance: 9.002832179023018
Total norm for 5 adversaries is: 17.54743066656902. distance: 9.002832179023018
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.1855, Accuracy: 8462/8991 (94.1163%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 2, internal_epoch   1,  Average loss: 0.0158, Accuracy: 2811/3821 (73.5671%), train_poison_data_count: 3821
Global model norm: 14.18606519796033.
Norm before scaling: 27.110421899814423. Distance: 22.330951316922214
Total norm for 5 adversaries is: 27.110421899814423. distance: 22.330951316922214
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2959, Accuracy: 8125/8991 (90.3681%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 3, internal_epoch   1,  Average loss: 0.0101, Accuracy: 3583/4319 (82.9590%), train_poison_data_count: 4319
Global model norm: 14.18606519796033.
Norm before scaling: 18.717268794432773. Distance: 11.04325408081148
Total norm for 5 adversaries is: 18.717268794432773. distance: 11.04325408081148
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.1585, Accuracy: 8531/8991 (94.8838%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 4, internal_epoch   1,  Average loss: 0.0089, Accuracy: 3739/4396 (85.0546%), train_poison_data_count: 4396
Global model norm: 14.18606519796033.
Norm before scaling: 18.157231578457935. Distance: 10.062691064762136
Total norm for 5 adversaries is: 18.157231578457935. distance: 10.062691064762136
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.1945, Accuracy: 8453/8991 (94.0162%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 5, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2709/3341 (81.0835%), train_poison_data_count: 3341
Global model norm: 14.18606519796033.
Norm before scaling: 19.006763258391654. Distance: 11.274852851533383
Total norm for 5 adversaries is: 19.006763258391654. distance: 11.274852851533383
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.2811, Accuracy: 8301/8991 (92.3257%)
___Train Local_Simple,  epoch   4, local model 6, internal_epoch   1,  Average loss: 0.0088, Accuracy: 4271/5024 (85.0119%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.1917, Accuracy: 9365/10000 (93.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 7, internal_epoch   1,  Average loss: 0.0124, Accuracy: 2878/3641 (79.0442%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.2167, Accuracy: 9315/10000 (93.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 8, internal_epoch   1,  Average loss: 0.0094, Accuracy: 3948/4701 (83.9821%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.2209, Accuracy: 9310/10000 (93.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 9, internal_epoch   1,  Average loss: 0.0123, Accuracy: 2606/3315 (78.6124%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.2239, Accuracy: 9317/10000 (93.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 10, internal_epoch   1,  Average loss: 0.0171, Accuracy: 2436/3435 (70.9170%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.4021, Accuracy: 8964/10000 (89.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 11, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3196/3917 (81.5931%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.2392, Accuracy: 9222/10000 (92.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 12, internal_epoch   1,  Average loss: 0.0094, Accuracy: 3405/4069 (83.6815%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.1928, Accuracy: 9423/10000 (94.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0093, Accuracy: 3198/3851 (83.0434%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.2108, Accuracy: 9342/10000 (93.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 14, internal_epoch   1,  Average loss: 0.0106, Accuracy: 2588/3110 (83.2154%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.9478, Accuracy: 8456/10000 (84.5600%), Attack Success Rate:0/10000(0.000)
time spent on training: 163.1534504890442
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.11881701 0.26644915 1.         0.73824723 0.26644915 0.50334608
 0.45184044 0.45184044 0.39047984 0.61472505 1.         0.46534939
 0.11881701 0.16510013 0.41265481]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 2.2330, Accuracy: 2869/10000 (28.6900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 2.2254, Accuracy: 3056/8991 (33.9895%)
Done in 190.63098073005676 sec.
Server Epoch:5 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   5, local model 0, internal_epoch   1,  Average loss: 0.0096, Accuracy: 3307/3973 (83.2368%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.3662, Accuracy: 8876/10000 (88.7600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 1, internal_epoch   1,  Average loss: 0.0105, Accuracy: 3056/3656 (83.5886%), train_poison_data_count: 3656
Global model norm: 14.264990166768705.
Norm before scaling: 17.87829559463487. Distance: 9.275666377968275
Total norm for 5 adversaries is: 17.87829559463487. distance: 9.275666377968275
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.1977, Accuracy: 8435/8991 (93.8160%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 2, internal_epoch   1,  Average loss: 0.0093, Accuracy: 3206/3821 (83.9047%), train_poison_data_count: 3821
Global model norm: 14.264990166768705.
Norm before scaling: 18.06064730847629. Distance: 9.612909426855419
Total norm for 5 adversaries is: 18.06064730847629. distance: 9.612909426855419
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2009, Accuracy: 8411/8991 (93.5491%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 3, internal_epoch   1,  Average loss: 0.0089, Accuracy: 3695/4319 (85.5522%), train_poison_data_count: 4319
Global model norm: 14.264990166768705.
Norm before scaling: 17.792434902117634. Distance: 9.272368731851321
Total norm for 5 adversaries is: 17.792434902117634. distance: 9.272368731851321
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.1631, Accuracy: 8554/8991 (95.1396%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3808/4396 (86.6242%), train_poison_data_count: 4396
Global model norm: 14.264990166768705.
Norm before scaling: 17.523453173755808. Distance: 8.899775778699865
Total norm for 5 adversaries is: 17.523453173755808. distance: 8.899775778699865
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.1318, Accuracy: 8648/8991 (96.1851%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 5, internal_epoch   1,  Average loss: 0.0128, Accuracy: 2673/3341 (80.0060%), train_poison_data_count: 3341
Global model norm: 14.264990166768705.
Norm before scaling: 20.281570502571572. Distance: 13.20316024865857
Total norm for 5 adversaries is: 20.281570502571572. distance: 13.20316024865857
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.2536, Accuracy: 8270/8991 (91.9809%)
___Train Local_Simple,  epoch   5, local model 6, internal_epoch   1,  Average loss: 0.0082, Accuracy: 4284/5024 (85.2707%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.1305, Accuracy: 9596/10000 (95.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0092, Accuracy: 3044/3641 (83.6034%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.3451, Accuracy: 8999/10000 (89.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 8, internal_epoch   1,  Average loss: 0.0092, Accuracy: 3965/4701 (84.3438%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.3028, Accuracy: 9080/10000 (90.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 9, internal_epoch   1,  Average loss: 0.0133, Accuracy: 2520/3315 (76.0181%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.2897, Accuracy: 9139/10000 (91.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 10, internal_epoch   1,  Average loss: 0.0103, Accuracy: 2812/3435 (81.8632%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.3111, Accuracy: 9059/10000 (90.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 11, internal_epoch   1,  Average loss: 0.0100, Accuracy: 3206/3917 (81.8484%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.2081, Accuracy: 9370/10000 (93.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 12, internal_epoch   1,  Average loss: 0.0095, Accuracy: 3401/4069 (83.5832%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.2109, Accuracy: 9398/10000 (93.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 13, internal_epoch   1,  Average loss: 0.0091, Accuracy: 3228/3851 (83.8224%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.1792, Accuracy: 9477/10000 (94.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0103, Accuracy: 2562/3110 (82.3794%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.8939, Accuracy: 8261/10000 (82.6100%), Attack Success Rate:0/10000(0.000)
time spent on training: 171.09665274620056
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 2.1313, Accuracy: 5565/10000 (55.6500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 2.1200, Accuracy: 5562/8991 (61.8619%)
Done in 198.23897695541382 sec.
Server Epoch:6 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   6, local model 0, internal_epoch   1,  Average loss: 0.0078, Accuracy: 3420/3973 (86.0810%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.2755, Accuracy: 9097/10000 (90.9700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 1, internal_epoch   1,  Average loss: 0.0088, Accuracy: 3175/3656 (86.8435%), train_poison_data_count: 3656
Global model norm: 14.429769452765381.
Norm before scaling: 17.61317599145195. Distance: 8.440530868395188
Total norm for 5 adversaries is: 17.61317599145195. distance: 8.440530868395188
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.2106, Accuracy: 8394/8991 (93.3600%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 2, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3343/3821 (87.4902%), train_poison_data_count: 3821
Global model norm: 14.429769452765381.
Norm before scaling: 17.412980317709025. Distance: 8.145052066681055
Total norm for 5 adversaries is: 17.412980317709025. distance: 8.145052066681055
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1802, Accuracy: 8496/8991 (94.4945%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 3, internal_epoch   1,  Average loss: 0.0085, Accuracy: 3770/4319 (87.2887%), train_poison_data_count: 4319
Global model norm: 14.429769452765381.
Norm before scaling: 18.477171964049653. Distance: 10.038557866694237
Total norm for 5 adversaries is: 18.477171964049653. distance: 10.038557866694237
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1620, Accuracy: 8544/8991 (95.0284%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0069, Accuracy: 3916/4396 (89.0810%), train_poison_data_count: 4396
Global model norm: 14.429769452765381.
Norm before scaling: 17.87814794177867. Distance: 9.037888776296976
Total norm for 5 adversaries is: 17.87814794177867. distance: 9.037888776296976
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.1094, Accuracy: 8705/8991 (96.8190%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 5, internal_epoch   1,  Average loss: 0.0091, Accuracy: 2886/3341 (86.3813%), train_poison_data_count: 3341
Global model norm: 14.429769452765381.
Norm before scaling: 17.842202141162222. Distance: 8.851612922545044
Total norm for 5 adversaries is: 17.842202141162222. distance: 8.851612922545044
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.2520, Accuracy: 8301/8991 (92.3257%)
___Train Local_Simple,  epoch   6, local model 6, internal_epoch   1,  Average loss: 0.0086, Accuracy: 4320/5024 (85.9873%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.2767, Accuracy: 9137/10000 (91.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 7, internal_epoch   1,  Average loss: 0.0087, Accuracy: 3145/3641 (86.3774%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.1858, Accuracy: 9425/10000 (94.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0073, Accuracy: 4116/4701 (87.5558%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.1942, Accuracy: 9381/10000 (93.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 9, internal_epoch   1,  Average loss: 0.0093, Accuracy: 2796/3315 (84.3439%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.2281, Accuracy: 9283/10000 (92.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 10, internal_epoch   1,  Average loss: 0.0085, Accuracy: 2972/3435 (86.5211%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.2621, Accuracy: 9251/10000 (92.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 11, internal_epoch   1,  Average loss: 0.0085, Accuracy: 3334/3917 (85.1162%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.3259, Accuracy: 9012/10000 (90.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 12, internal_epoch   1,  Average loss: 0.0077, Accuracy: 3548/4069 (87.1959%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.1692, Accuracy: 9493/10000 (94.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 13, internal_epoch   1,  Average loss: 0.0081, Accuracy: 3291/3851 (85.4583%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.3133, Accuracy: 9114/10000 (91.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 14, internal_epoch   1,  Average loss: 0.0085, Accuracy: 2670/3110 (85.8521%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.9248, Accuracy: 8490/10000 (84.9000%), Attack Success Rate:0/10000(0.000)
time spent on training: 178.97011852264404
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 1.9619, Accuracy: 7441/10000 (74.4100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 1.9455, Accuracy: 7422/8991 (82.5492%)
Done in 206.287841796875 sec.
Server Epoch:7 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   7, local model 0, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3529/3973 (88.8246%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.2316, Accuracy: 9259/10000 (92.5900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 1, internal_epoch   1,  Average loss: 0.0073, Accuracy: 3244/3656 (88.7309%), train_poison_data_count: 3656
Global model norm: 14.603930302265809.
Norm before scaling: 17.621204156853185. Distance: 7.995166510493548
Total norm for 5 adversaries is: 17.621204156853185. distance: 7.995166510493548
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1644, Accuracy: 8522/8991 (94.7837%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3404/3821 (89.0866%), train_poison_data_count: 3821
Global model norm: 14.603930302265809.
Norm before scaling: 17.586918807305775. Distance: 7.910514797043746
Total norm for 5 adversaries is: 17.586918807305775. distance: 7.910514797043746
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.2252, Accuracy: 8351/8991 (92.8818%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 3, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3925/4319 (90.8775%), train_poison_data_count: 4319
Global model norm: 14.603930302265809.
Norm before scaling: 17.529590983779222. Distance: 7.891898054405103
Total norm for 5 adversaries is: 17.529590983779222. distance: 7.891898054405103
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1405, Accuracy: 8598/8991 (95.6290%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 4, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4041/4396 (91.9245%), train_poison_data_count: 4396
Global model norm: 14.603930302265809.
Norm before scaling: 17.153921389669733. Distance: 7.2751638492341275
Total norm for 5 adversaries is: 17.153921389669733. distance: 7.2751638492341275
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.1868, Accuracy: 8476/8991 (94.2720%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 5, internal_epoch   1,  Average loss: 0.0084, Accuracy: 2927/3341 (87.6085%), train_poison_data_count: 3341
Global model norm: 14.603930302265809.
Norm before scaling: 18.85023743659521. Distance: 10.027015053533582
Total norm for 5 adversaries is: 18.85023743659521. distance: 10.027015053533582
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.2230, Accuracy: 8419/8991 (93.6381%)
___Train Local_Simple,  epoch   7, local model 6, internal_epoch   1,  Average loss: 0.0065, Accuracy: 4481/5024 (89.1919%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.1861, Accuracy: 9388/10000 (93.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0076, Accuracy: 3232/3641 (88.7668%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.2146, Accuracy: 9317/10000 (93.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 8, internal_epoch   1,  Average loss: 0.0072, Accuracy: 4152/4701 (88.3216%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.2459, Accuracy: 9286/10000 (92.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 9, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2824/3315 (85.1885%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.2123, Accuracy: 9336/10000 (93.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3077/3435 (89.5779%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.1604, Accuracy: 9505/10000 (95.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 11, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3468/3917 (88.5371%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.1969, Accuracy: 9446/10000 (94.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 12, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3656/4069 (89.8501%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.2548, Accuracy: 9296/10000 (92.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 13, internal_epoch   1,  Average loss: 0.0074, Accuracy: 3378/3851 (87.7175%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.2434, Accuracy: 9274/10000 (92.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 14, internal_epoch   1,  Average loss: 0.0072, Accuracy: 2773/3110 (89.1640%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.9349, Accuracy: 8099/10000 (80.9900%), Attack Success Rate:0/10000(0.000)
time spent on training: 184.20025396347046
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [0.96138748 1.         0.69533874 0.89815193 0.69533874 1.
 0.94477005 1.         1.         1.         0.94477005 0.9052777
 0.9052777  1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 1.7876, Accuracy: 8158/10000 (81.5800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 1.7680, Accuracy: 8073/8991 (89.7898%)
Done in 211.78585124015808 sec.
Server Epoch:8 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   8, local model 0, internal_epoch   1,  Average loss: 0.0064, Accuracy: 3555/3973 (89.4790%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.1854, Accuracy: 9464/10000 (94.6400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 1, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3305/3656 (90.3993%), train_poison_data_count: 3656
Global model norm: 14.772978389713082.
Norm before scaling: 17.639502220137018. Distance: 7.68592036695717
Total norm for 5 adversaries is: 17.639502220137018. distance: 7.68592036695717
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1313, Accuracy: 8633/8991 (96.0182%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 2, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3453/3821 (90.3690%), train_poison_data_count: 3821
Global model norm: 14.772978389713082.
Norm before scaling: 17.604561717399235. Distance: 7.5157691481758455
Total norm for 5 adversaries is: 17.604561717399235. distance: 7.5157691481758455
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1347, Accuracy: 8619/8991 (95.8625%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 3, internal_epoch   1,  Average loss: 0.0055, Accuracy: 3965/4319 (91.8037%), train_poison_data_count: 4319
Global model norm: 14.772978389713082.
Norm before scaling: 17.207679027960072. Distance: 7.001844435610397
Total norm for 5 adversaries is: 17.207679027960072. distance: 7.001844435610397
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1328, Accuracy: 8610/8991 (95.7624%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 4, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4023/4396 (91.5150%), train_poison_data_count: 4396
Global model norm: 14.772978389713082.
Norm before scaling: 17.844557227800582. Distance: 8.136314612803245
Total norm for 5 adversaries is: 17.844557227800582. distance: 8.136314612803245
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.2334, Accuracy: 8356/8991 (92.9374%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 5, internal_epoch   1,  Average loss: 0.0075, Accuracy: 2958/3341 (88.5364%), train_poison_data_count: 3341
Global model norm: 14.772978389713082.
Norm before scaling: 18.00230732010917. Distance: 8.323596403002618
Total norm for 5 adversaries is: 18.00230732010917. distance: 8.323596403002618
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.1597, Accuracy: 8550/8991 (95.0951%)
___Train Local_Simple,  epoch   8, local model 6, internal_epoch   1,  Average loss: 0.0057, Accuracy: 4511/5024 (89.7890%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.1220, Accuracy: 9604/10000 (96.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 7, internal_epoch   1,  Average loss: 0.0088, Accuracy: 3109/3641 (85.3886%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.2812, Accuracy: 9189/10000 (91.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 8, internal_epoch   1,  Average loss: 0.0054, Accuracy: 4302/4701 (91.5124%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.2213, Accuracy: 9337/10000 (93.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0071, Accuracy: 2919/3315 (88.0543%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.2186, Accuracy: 9343/10000 (93.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 10, internal_epoch   1,  Average loss: 0.0067, Accuracy: 3088/3435 (89.8981%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.1914, Accuracy: 9487/10000 (94.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3488/3917 (89.0477%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.2116, Accuracy: 9278/10000 (92.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0059, Accuracy: 3685/4069 (90.5628%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.1740, Accuracy: 9473/10000 (94.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 13, internal_epoch   1,  Average loss: 0.0068, Accuracy: 3404/3851 (88.3926%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.3100, Accuracy: 9103/10000 (91.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 14, internal_epoch   1,  Average loss: 0.0066, Accuracy: 2802/3110 (90.0965%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.8402, Accuracy: 8619/10000 (86.1900%), Attack Success Rate:0/10000(0.000)
time spent on training: 194.07391953468323
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 1.5744, Accuracy: 8566/10000 (85.6600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 1.5546, Accuracy: 8219/8991 (91.4136%)
Done in 222.48753666877747 sec.
Server Epoch:9 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   9, local model 0, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3616/3973 (91.0143%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.3416, Accuracy: 9010/10000 (90.1000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 1, internal_epoch   1,  Average loss: 0.0060, Accuracy: 3335/3656 (91.2199%), train_poison_data_count: 3656
Global model norm: 14.956736416524777.
Norm before scaling: 17.95627369173733. Distance: 7.804194315467434
Total norm for 5 adversaries is: 17.95627369173733. distance: 7.804194315467434
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1695, Accuracy: 8500/8991 (94.5390%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 2, internal_epoch   1,  Average loss: 0.0065, Accuracy: 3456/3821 (90.4475%), train_poison_data_count: 3821
Global model norm: 14.956736416524777.
Norm before scaling: 19.97343511646313. Distance: 11.070174319334326
Total norm for 5 adversaries is: 19.97343511646313. distance: 11.070174319334326
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1461, Accuracy: 8549/8991 (95.0840%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 3, internal_epoch   1,  Average loss: 0.0049, Accuracy: 3992/4319 (92.4288%), train_poison_data_count: 4319
Global model norm: 14.956736416524777.
Norm before scaling: 17.48374751024371. Distance: 7.06453304229748
Total norm for 5 adversaries is: 17.48374751024371. distance: 7.06453304229748
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1980, Accuracy: 8441/8991 (93.8828%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 4, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4062/4396 (92.4022%), train_poison_data_count: 4396
Global model norm: 14.956736416524777.
Norm before scaling: 18.168704883898663. Distance: 8.286772185943013
Total norm for 5 adversaries is: 18.168704883898663. distance: 8.286772185943013
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1054, Accuracy: 8682/8991 (96.5632%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 5, internal_epoch   1,  Average loss: 0.0063, Accuracy: 3032/3341 (90.7513%), train_poison_data_count: 3341
Global model norm: 14.956736416524777.
Norm before scaling: 17.927886619798322. Distance: 7.69970429087976
Total norm for 5 adversaries is: 17.927886619798322. distance: 7.69970429087976
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.1211, Accuracy: 8647/8991 (96.1740%)
___Train Local_Simple,  epoch   9, local model 6, internal_epoch   1,  Average loss: 0.0048, Accuracy: 4627/5024 (92.0979%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.1083, Accuracy: 9650/10000 (96.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 7, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3288/3641 (90.3049%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.1721, Accuracy: 9430/10000 (94.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 8, internal_epoch   1,  Average loss: 0.0052, Accuracy: 4303/4701 (91.5337%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.1567, Accuracy: 9524/10000 (95.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 9, internal_epoch   1,  Average loss: 0.0060, Accuracy: 2976/3315 (89.7738%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.2343, Accuracy: 9270/10000 (92.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 10, internal_epoch   1,  Average loss: 0.0061, Accuracy: 3122/3435 (90.8879%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.2852, Accuracy: 9043/10000 (90.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 11, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3566/3917 (91.0391%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.1629, Accuracy: 9518/10000 (95.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 12, internal_epoch   1,  Average loss: 0.0056, Accuracy: 3724/4069 (91.5213%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.1373, Accuracy: 9602/10000 (96.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3509/3851 (91.1192%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.1937, Accuracy: 9439/10000 (94.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 14, internal_epoch   1,  Average loss: 0.0052, Accuracy: 2874/3110 (92.4116%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.5536, Accuracy: 8585/10000 (85.8500%), Attack Success Rate:0/10000(0.000)
time spent on training: 201.12912344932556
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 1.3407, Accuracy: 8754/10000 (87.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 1.3180, Accuracy: 8380/8991 (93.2043%)
Done in 229.20863914489746 sec.
Server Epoch:10 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  10, local model 0, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3698/3973 (93.0783%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.2013, Accuracy: 9355/10000 (93.5500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 1, internal_epoch   1,  Average loss: 0.0051, Accuracy: 3378/3656 (92.3961%), train_poison_data_count: 3656
Global model norm: 15.135774668139305.
Norm before scaling: 17.39578606452535. Distance: 6.480182073413512
Total norm for 5 adversaries is: 17.39578606452535. distance: 6.480182073413512
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1576, Accuracy: 8549/8991 (95.0840%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 2, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3535/3821 (92.5150%), train_poison_data_count: 3821
Global model norm: 15.135774668139305.
Norm before scaling: 17.25247307340132. Distance: 6.181873576278145
Total norm for 5 adversaries is: 17.25247307340132. distance: 6.181873576278145
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1528, Accuracy: 8564/8991 (95.2508%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 3, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4030/4319 (93.3086%), train_poison_data_count: 4319
Global model norm: 15.135774668139305.
Norm before scaling: 17.263653203300514. Distance: 6.290028979988232
Total norm for 5 adversaries is: 17.263653203300514. distance: 6.290028979988232
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.0997, Accuracy: 8724/8991 (97.0304%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 4, internal_epoch   1,  Average loss: 0.0044, Accuracy: 4061/4396 (92.3794%), train_poison_data_count: 4396
Global model norm: 15.135774668139305.
Norm before scaling: 17.50891147962008. Distance: 6.745669353236442
Total norm for 5 adversaries is: 17.50891147962008. distance: 6.745669353236442
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1000, Accuracy: 8717/8991 (96.9525%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 5, internal_epoch   1,  Average loss: 0.0062, Accuracy: 3048/3341 (91.2302%), train_poison_data_count: 3341
Global model norm: 15.135774668139305.
Norm before scaling: 18.008846228464186. Distance: 7.6850899741093635
Total norm for 5 adversaries is: 18.008846228464186. distance: 7.6850899741093635
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.1325, Accuracy: 8627/8991 (95.9515%)
___Train Local_Simple,  epoch  10, local model 6, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4667/5024 (92.8941%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.1200, Accuracy: 9617/10000 (96.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 7, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3307/3641 (90.8267%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.1750, Accuracy: 9460/10000 (94.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 8, internal_epoch   1,  Average loss: 0.0045, Accuracy: 4363/4701 (92.8100%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.1255, Accuracy: 9636/10000 (96.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 9, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3018/3315 (91.0407%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.1982, Accuracy: 9366/10000 (93.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 10, internal_epoch   1,  Average loss: 0.0057, Accuracy: 3103/3435 (90.3348%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.2083, Accuracy: 9352/10000 (93.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0053, Accuracy: 3589/3917 (91.6262%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.1637, Accuracy: 9467/10000 (94.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3798/4069 (93.3399%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.1543, Accuracy: 9524/10000 (95.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3573/3851 (92.7811%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.2399, Accuracy: 9276/10000 (92.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0051, Accuracy: 2859/3110 (91.9293%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.6224, Accuracy: 8533/10000 (85.3300%), Attack Success Rate:0/10000(0.000)
time spent on training: 210.07953643798828
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 1.0982, Accuracy: 8912/10000 (89.1200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 1.0764, Accuracy: 8364/8991 (93.0264%)
Done in 237.8697431087494 sec.
Server Epoch:11 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  11, local model 0, internal_epoch   1,  Average loss: 0.0041, Accuracy: 3699/3973 (93.1034%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2105, Accuracy: 9355/10000 (93.5500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 1, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3382/3656 (92.5055%), train_poison_data_count: 3656
Global model norm: 15.302814518974882.
Norm before scaling: 17.153049636038666. Distance: 5.719263606120028
Total norm for 5 adversaries is: 17.153049636038666. distance: 5.719263606120028
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1498, Accuracy: 8560/8991 (95.2063%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 2, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3576/3821 (93.5881%), train_poison_data_count: 3821
Global model norm: 15.302814518974882.
Norm before scaling: 17.012741699295653. Distance: 5.514146125658731
Total norm for 5 adversaries is: 17.012741699295653. distance: 5.514146125658731
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1243, Accuracy: 8641/8991 (96.1072%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 3, internal_epoch   1,  Average loss: 0.0036, Accuracy: 4074/4319 (94.3274%), train_poison_data_count: 4319
Global model norm: 15.302814518974882.
Norm before scaling: 16.920250924777147. Distance: 5.460531980986913
Total norm for 5 adversaries is: 16.920250924777147. distance: 5.460531980986913
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1148, Accuracy: 8681/8991 (96.5521%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 4, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4137/4396 (94.1083%), train_poison_data_count: 4396
Global model norm: 15.302814518974882.
Norm before scaling: 17.238883596857878. Distance: 5.964554675379038
Total norm for 5 adversaries is: 17.238883596857878. distance: 5.964554675379038
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1504, Accuracy: 8559/8991 (95.1952%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 5, internal_epoch   1,  Average loss: 0.0047, Accuracy: 3067/3341 (91.7989%), train_poison_data_count: 3341
Global model norm: 15.302814518974882.
Norm before scaling: 17.273014361902337. Distance: 5.908400048371115
Total norm for 5 adversaries is: 17.273014361902337. distance: 5.908400048371115
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.1275, Accuracy: 8655/8991 (96.2629%)
___Train Local_Simple,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0038, Accuracy: 4702/5024 (93.5908%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1112, Accuracy: 9660/10000 (96.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 7, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3355/3641 (92.1450%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1740, Accuracy: 9432/10000 (94.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 8, internal_epoch   1,  Average loss: 0.0041, Accuracy: 4403/4701 (93.6609%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1961, Accuracy: 9405/10000 (94.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 9, internal_epoch   1,  Average loss: 0.0054, Accuracy: 3018/3315 (91.0407%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1432, Accuracy: 9558/10000 (95.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 10, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3214/3435 (93.5662%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1502, Accuracy: 9531/10000 (95.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3662/3917 (93.4899%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2236, Accuracy: 9326/10000 (93.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 12, internal_epoch   1,  Average loss: 0.0043, Accuracy: 3815/4069 (93.7577%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1420, Accuracy: 9562/10000 (95.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 13, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3594/3851 (93.3264%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2975, Accuracy: 9168/10000 (91.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0043, Accuracy: 2899/3110 (93.2154%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.6269, Accuracy: 8587/10000 (85.8700%), Attack Success Rate:0/10000(0.000)
time spent on training: 215.64129447937012
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 0.8988, Accuracy: 8882/10000 (88.8200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 0.8675, Accuracy: 8490/8991 (94.4278%)
Done in 243.6111855506897 sec.
Server Epoch:12 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  12, local model 0, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3688/3973 (92.8266%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1952, Accuracy: 9387/10000 (93.8700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   1,  Average loss: 0.0046, Accuracy: 3380/3656 (92.4508%), train_poison_data_count: 3656
Global model norm: 15.449067635164862.
Norm before scaling: 17.4070345635011. Distance: 5.996687610555012
Total norm for 5 adversaries is: 17.4070345635011. distance: 5.996687610555012
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1224, Accuracy: 8665/8991 (96.3742%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3593/3821 (94.0330%), train_poison_data_count: 3821
Global model norm: 15.449067635164862.
Norm before scaling: 16.85569461392703. Distance: 4.898424845166568
Total norm for 5 adversaries is: 16.85569461392703. distance: 4.898424845166568
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.0922, Accuracy: 8744/8991 (97.2528%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 3, internal_epoch   1,  Average loss: 0.0042, Accuracy: 4053/4319 (93.8412%), train_poison_data_count: 4319
Global model norm: 15.449067635164862.
Norm before scaling: 17.631722973926763. Distance: 6.5228421790484425
Total norm for 5 adversaries is: 17.631722973926763. distance: 6.5228421790484425
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1098, Accuracy: 8684/8991 (96.5855%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0030, Accuracy: 4187/4396 (95.2457%), train_poison_data_count: 4396
Global model norm: 15.449067635164862.
Norm before scaling: 16.8149829718543. Distance: 4.967137680931847
Total norm for 5 adversaries is: 16.8149829718543. distance: 4.967137680931847
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1346, Accuracy: 8616/8991 (95.8292%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 5, internal_epoch   1,  Average loss: 0.0048, Accuracy: 3099/3341 (92.7567%), train_poison_data_count: 3341
Global model norm: 15.449067635164862.
Norm before scaling: 17.35796767332071. Distance: 5.880207107944772
Total norm for 5 adversaries is: 17.35796767332071. distance: 5.880207107944772
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.1273, Accuracy: 8626/8991 (95.9404%)
___Train Local_Simple,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4688/5024 (93.3121%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0936, Accuracy: 9715/10000 (97.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 7, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3396/3641 (93.2711%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1610, Accuracy: 9515/10000 (95.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 8, internal_epoch   1,  Average loss: 0.0033, Accuracy: 4433/4701 (94.2991%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1011, Accuracy: 9696/10000 (96.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 3096/3315 (93.3937%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1213, Accuracy: 9602/10000 (96.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 10, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3223/3435 (93.8282%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1385, Accuracy: 9623/10000 (96.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0042, Accuracy: 3643/3917 (93.0049%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1835, Accuracy: 9403/10000 (94.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 12, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3837/4069 (94.2984%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1583, Accuracy: 9550/10000 (95.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 13, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3611/3851 (93.7679%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1984, Accuracy: 9348/10000 (93.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 14, internal_epoch   1,  Average loss: 0.0036, Accuracy: 2931/3110 (94.2444%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.4189, Accuracy: 8841/10000 (88.4100%), Attack Success Rate:0/10000(0.000)
time spent on training: 220.79845929145813
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 0.7146, Accuracy: 9041/10000 (90.4100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 0.6918, Accuracy: 8410/8991 (93.5380%)
Done in 248.17058658599854 sec.
Server Epoch:13 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  13, local model 0, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3742/3973 (94.1858%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1167, Accuracy: 9621/10000 (96.2100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3443/3656 (94.1740%), train_poison_data_count: 3656
Global model norm: 15.587133314871787.
Norm before scaling: 16.88649420464288. Distance: 4.811372699238396
Total norm for 5 adversaries is: 16.88649420464288. distance: 4.811372699238396
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1173, Accuracy: 8656/8991 (96.2741%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 2, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3627/3821 (94.9228%), train_poison_data_count: 3821
Global model norm: 15.587133314871787.
Norm before scaling: 16.637843627591042. Distance: 4.327602533969196
Total norm for 5 adversaries is: 16.637843627591042. distance: 4.327602533969196
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1091, Accuracy: 8687/8991 (96.6188%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 3, internal_epoch   1,  Average loss: 0.0031, Accuracy: 4096/4319 (94.8368%), train_poison_data_count: 4319
Global model norm: 15.587133314871787.
Norm before scaling: 16.976291954528545. Distance: 5.0074904601624715
Total norm for 5 adversaries is: 16.976291954528545. distance: 5.0074904601624715
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1023, Accuracy: 8700/8991 (96.7634%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0034, Accuracy: 4148/4396 (94.3585%), train_poison_data_count: 4396
Global model norm: 15.587133314871787.
Norm before scaling: 17.353914708586377. Distance: 5.7786374349190694
Total norm for 5 adversaries is: 17.353914708586377. distance: 5.7786374349190694
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1397, Accuracy: 8593/8991 (95.5734%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 5, internal_epoch   1,  Average loss: 0.0039, Accuracy: 3127/3341 (93.5947%), train_poison_data_count: 3341
Global model norm: 15.587133314871787.
Norm before scaling: 17.016753076127838. Distance: 4.890058295715711
Total norm for 5 adversaries is: 17.016753076127838. distance: 4.890058295715711
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.1104, Accuracy: 8676/8991 (96.4965%)
___Train Local_Simple,  epoch  13, local model 6, internal_epoch   1,  Average loss: 0.0037, Accuracy: 4711/5024 (93.7699%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1104, Accuracy: 9641/10000 (96.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3401/3641 (93.4084%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1272, Accuracy: 9604/10000 (96.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 8, internal_epoch   1,  Average loss: 0.0035, Accuracy: 4422/4701 (94.0651%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1720, Accuracy: 9480/10000 (94.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 9, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3101/3315 (93.5445%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1550, Accuracy: 9511/10000 (95.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3219/3435 (93.7118%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1124, Accuracy: 9660/10000 (96.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0037, Accuracy: 3661/3917 (93.4644%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1314, Accuracy: 9569/10000 (95.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 12, internal_epoch   1,  Average loss: 0.0035, Accuracy: 3875/4069 (95.2322%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1689, Accuracy: 9470/10000 (94.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 13, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3605/3851 (93.6120%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1587, Accuracy: 9504/10000 (95.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2928/3110 (94.1479%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.4255, Accuracy: 8803/10000 (88.0300%), Attack Success Rate:0/10000(0.000)
time spent on training: 226.53598809242249
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 0.5584, Accuracy: 9131/10000 (91.3100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 0.5398, Accuracy: 8382/8991 (93.2266%)
Done in 254.22896766662598 sec.
Server Epoch:14 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  14, local model 0, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3751/3973 (94.4123%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1246, Accuracy: 9629/10000 (96.2900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 1, internal_epoch   1,  Average loss: 0.0038, Accuracy: 3436/3656 (93.9825%), train_poison_data_count: 3656
Global model norm: 15.715683139246703.
Norm before scaling: 17.1934151753113. Distance: 5.0674683480386955
Total norm for 5 adversaries is: 17.1934151753113. distance: 5.0674683480386955
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1291, Accuracy: 8641/8991 (96.1072%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3645/3821 (95.3939%), train_poison_data_count: 3821
Global model norm: 15.715683139246703.
Norm before scaling: 16.7115045266703. Distance: 4.034295402941306
Total norm for 5 adversaries is: 16.7115045266703. distance: 4.034295402941306
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0837, Accuracy: 8753/8991 (97.3529%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 3, internal_epoch   1,  Average loss: 0.0032, Accuracy: 4091/4319 (94.7210%), train_poison_data_count: 4319
Global model norm: 15.715683139246703.
Norm before scaling: 17.26186946570886. Distance: 5.4762262303703535
Total norm for 5 adversaries is: 17.26186946570886. distance: 5.4762262303703535
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.0807, Accuracy: 8779/8991 (97.6421%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4204/4396 (95.6324%), train_poison_data_count: 4396
Global model norm: 15.715683139246703.
Norm before scaling: 16.71712901020238. Distance: 4.361847863190119
Total norm for 5 adversaries is: 16.71712901020238. distance: 4.361847863190119
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1200, Accuracy: 8635/8991 (96.0405%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3173/3341 (94.9716%), train_poison_data_count: 3341
Global model norm: 15.715683139246703.
Norm before scaling: 16.605979191901785. Distance: 3.9840378562553447
Total norm for 5 adversaries is: 16.605979191901785. distance: 3.9840378562553447
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.1137, Accuracy: 8658/8991 (96.2963%)
___Train Local_Simple,  epoch  14, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4758/5024 (94.7054%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.0926, Accuracy: 9701/10000 (97.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0036, Accuracy: 3400/3641 (93.3809%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1921, Accuracy: 9401/10000 (94.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 8, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4430/4701 (94.2353%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1002, Accuracy: 9701/10000 (97.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 9, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3133/3315 (94.5098%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1326, Accuracy: 9562/10000 (95.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0034, Accuracy: 3230/3435 (94.0320%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1732, Accuracy: 9475/10000 (94.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 11, internal_epoch   1,  Average loss: 0.0032, Accuracy: 3694/3917 (94.3069%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1471, Accuracy: 9540/10000 (95.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3887/4069 (95.5272%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1194, Accuracy: 9638/10000 (96.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 13, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3621/3851 (94.0275%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1399, Accuracy: 9565/10000 (95.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 14, internal_epoch   1,  Average loss: 0.0033, Accuracy: 2950/3110 (94.8553%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3284, Accuracy: 8847/10000 (88.4700%), Attack Success Rate:0/10000(0.000)
time spent on training: 231.86795926094055
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         1.         1.         1.         0.97608194 0.97608194
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 0.4353, Accuracy: 9214/10000 (92.1400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 0.4263, Accuracy: 8332/8991 (92.6704%)
Done in 259.57830452919006 sec.
Server Epoch:15 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3796/3973 (95.5449%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1653, Accuracy: 9505/10000 (95.0500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3481/3656 (95.2133%), train_poison_data_count: 3656
Global model norm: 15.83281479371221.
Norm before scaling: 16.755733590454845. Distance: 4.0567252563993295
Total norm for 5 adversaries is: 16.755733590454845. distance: 4.0567252563993295
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0993, Accuracy: 8729/8991 (97.0860%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 2, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3643/3821 (95.3415%), train_poison_data_count: 3821
Global model norm: 15.83281479371221.
Norm before scaling: 16.91749387826382. Distance: 4.308916897729982
Total norm for 5 adversaries is: 16.91749387826382. distance: 4.308916897729982
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1199, Accuracy: 8632/8991 (96.0071%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 3, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4125/4319 (95.5082%), train_poison_data_count: 4319
Global model norm: 15.83281479371221.
Norm before scaling: 16.80576345492029. Distance: 4.291654765782321
Total norm for 5 adversaries is: 16.80576345492029. distance: 4.291654765782321
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.0852, Accuracy: 8745/8991 (97.2639%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4198/4396 (95.4959%), train_poison_data_count: 4396
Global model norm: 15.83281479371221.
Norm before scaling: 17.06365716943744. Distance: 4.834910738258135
Total norm for 5 adversaries is: 17.06365716943744. distance: 4.834910738258135
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1233, Accuracy: 8652/8991 (96.2296%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 5, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3174/3341 (95.0015%), train_poison_data_count: 3341
Global model norm: 15.83281479371221.
Norm before scaling: 16.702074408611082. Distance: 3.92833345113524
Total norm for 5 adversaries is: 16.702074408611082. distance: 3.92833345113524
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1078, Accuracy: 8699/8991 (96.7523%)
___Train Local_Simple,  epoch  15, local model 6, internal_epoch   1,  Average loss: 0.0029, Accuracy: 4764/5024 (94.8248%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1051, Accuracy: 9691/10000 (96.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 7, internal_epoch   1,  Average loss: 0.0033, Accuracy: 3431/3641 (94.2324%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1268, Accuracy: 9585/10000 (95.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 8, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4508/4701 (95.8945%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1186, Accuracy: 9633/10000 (96.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 9, internal_epoch   1,  Average loss: 0.0030, Accuracy: 3129/3315 (94.3891%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1705, Accuracy: 9473/10000 (94.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3279/3435 (95.4585%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1413, Accuracy: 9562/10000 (95.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 11, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3716/3917 (94.8685%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1350, Accuracy: 9595/10000 (95.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3900/4069 (95.8466%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1848, Accuracy: 9438/10000 (94.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3660/3851 (95.0402%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1221, Accuracy: 9653/10000 (96.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0028, Accuracy: 2955/3110 (95.0161%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3048, Accuracy: 8844/10000 (88.4400%), Attack Success Rate:0/10000(0.000)
time spent on training: 242.24701714515686
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 0.3488, Accuracy: 9242/10000 (92.4200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 0.3440, Accuracy: 8312/8991 (92.4480%)
Done in 269.5066730976105 sec.
Server Epoch:16 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  16, local model 0, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3781/3973 (95.1674%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1411, Accuracy: 9577/10000 (95.7700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3495/3656 (95.5963%), train_poison_data_count: 3656
Global model norm: 15.935634847969267.
Norm before scaling: 16.625349686465714. Distance: 3.6353674651189407
Total norm for 5 adversaries is: 16.625349686465714. distance: 3.6353674651189407
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0773, Accuracy: 8791/8991 (97.7756%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 2, internal_epoch   1,  Average loss: 0.0027, Accuracy: 3651/3821 (95.5509%), train_poison_data_count: 3821
Global model norm: 15.935634847969267.
Norm before scaling: 17.096076095733014. Distance: 4.644305583839106
Total norm for 5 adversaries is: 17.096076095733014. distance: 4.644305583839106
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1255, Accuracy: 8664/8991 (96.3630%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 3, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4139/4319 (95.8324%), train_poison_data_count: 4319
Global model norm: 15.935634847969267.
Norm before scaling: 16.779614132615002. Distance: 4.04846372312462
Total norm for 5 adversaries is: 16.779614132615002. distance: 4.04846372312462
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0689, Accuracy: 8808/8991 (97.9646%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4216/4396 (95.9054%), train_poison_data_count: 4396
Global model norm: 15.935634847969267.
Norm before scaling: 16.85948360715713. Distance: 4.190849672534581
Total norm for 5 adversaries is: 16.85948360715713. distance: 4.190849672534581
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.0766, Accuracy: 8766/8991 (97.4975%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 5, internal_epoch   1,  Average loss: 0.0029, Accuracy: 3172/3341 (94.9416%), train_poison_data_count: 3341
Global model norm: 15.935634847969267.
Norm before scaling: 16.73013174932013. Distance: 3.8140764572969608
Total norm for 5 adversaries is: 16.73013174932013. distance: 3.8140764572969608
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.1604, Accuracy: 8524/8991 (94.8059%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0028, Accuracy: 4758/5024 (94.7054%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1319, Accuracy: 9578/10000 (95.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 7, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3475/3641 (95.4408%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1696, Accuracy: 9485/10000 (94.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0027, Accuracy: 4491/4701 (95.5329%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1294, Accuracy: 9618/10000 (96.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 9, internal_epoch   1,  Average loss: 0.0031, Accuracy: 3125/3315 (94.2685%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1270, Accuracy: 9586/10000 (95.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 10, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3274/3435 (95.3130%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1370, Accuracy: 9573/10000 (95.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3752/3917 (95.7876%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1972, Accuracy: 9419/10000 (94.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3903/4069 (95.9204%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1135, Accuracy: 9643/10000 (96.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3653/3851 (94.8585%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1414, Accuracy: 9590/10000 (95.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2970/3110 (95.4984%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3201, Accuracy: 8906/10000 (89.0600%), Attack Success Rate:0/10000(0.000)
time spent on training: 248.82267498970032
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 0.2912, Accuracy: 9300/10000 (93.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 0.2916, Accuracy: 8286/8991 (92.1588%)
Done in 275.5840516090393 sec.
Server Epoch:17 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  17, local model 0, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3790/3973 (95.3939%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1168, Accuracy: 9636/10000 (96.3600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3510/3656 (96.0066%), train_poison_data_count: 3656
Global model norm: 16.032279831079272.
Norm before scaling: 16.65097059565429. Distance: 3.6366078229759506
Total norm for 5 adversaries is: 16.65097059565429. distance: 3.6366078229759506
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1001, Accuracy: 8692/8991 (96.6745%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3676/3821 (96.2052%), train_poison_data_count: 3821
Global model norm: 16.032279831079272.
Norm before scaling: 16.602614856351977. Distance: 3.3135322545883366
Total norm for 5 adversaries is: 16.602614856351977. distance: 3.3135322545883366
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1001, Accuracy: 8717/8991 (96.9525%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 3, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4161/4319 (96.3417%), train_poison_data_count: 4319
Global model norm: 16.032279831079272.
Norm before scaling: 16.62164135040943. Distance: 3.585828326522685
Total norm for 5 adversaries is: 16.62164135040943. distance: 3.585828326522685
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.1175, Accuracy: 8671/8991 (96.4409%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4226/4396 (96.1328%), train_poison_data_count: 4396
Global model norm: 16.032279831079272.
Norm before scaling: 16.86365087836159. Distance: 4.052288896826672
Total norm for 5 adversaries is: 16.86365087836159. distance: 4.052288896826672
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0835, Accuracy: 8753/8991 (97.3529%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3197/3341 (95.6899%), train_poison_data_count: 3341
Global model norm: 16.032279831079272.
Norm before scaling: 16.657246686877755. Distance: 3.449743073336577
Total norm for 5 adversaries is: 16.657246686877755. distance: 3.449743073336577
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.0946, Accuracy: 8742/8991 (97.2306%)
___Train Local_Simple,  epoch  17, local model 6, internal_epoch   1,  Average loss: 0.0025, Accuracy: 4786/5024 (95.2627%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1462, Accuracy: 9568/10000 (95.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 7, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3481/3641 (95.6056%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1300, Accuracy: 9612/10000 (96.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 8, internal_epoch   1,  Average loss: 0.0026, Accuracy: 4478/4701 (95.2563%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1338, Accuracy: 9588/10000 (95.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 9, internal_epoch   1,  Average loss: 0.0026, Accuracy: 3160/3315 (95.3243%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1416, Accuracy: 9559/10000 (95.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3293/3435 (95.8661%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1279, Accuracy: 9596/10000 (95.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 11, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3763/3917 (96.0684%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1582, Accuracy: 9492/10000 (94.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 12, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3907/4069 (96.0187%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1181, Accuracy: 9661/10000 (96.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3694/3851 (95.9231%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1758, Accuracy: 9450/10000 (94.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 14, internal_epoch   1,  Average loss: 0.0025, Accuracy: 2970/3110 (95.4984%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2518, Accuracy: 9214/10000 (92.1400%), Attack Success Rate:0/10000(0.000)
time spent on training: 256.803822517395
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         1.         1.         1.         0.68416995 0.68416995
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 0.2478, Accuracy: 9339/10000 (93.3900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 0.2586, Accuracy: 8248/8991 (91.7362%)
Done in 284.87491941452026 sec.
Server Epoch:18 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  18, local model 0, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3834/3973 (96.5014%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0874, Accuracy: 9721/10000 (97.2100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 1, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3498/3656 (95.6783%), train_poison_data_count: 3656
Global model norm: 16.115719985903905.
Norm before scaling: 16.62672449790688. Distance: 3.352101671648017
Total norm for 5 adversaries is: 16.62672449790688. distance: 3.352101671648017
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0854, Accuracy: 8759/8991 (97.4196%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 2, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3659/3821 (95.7603%), train_poison_data_count: 3821
Global model norm: 16.115719985903905.
Norm before scaling: 16.886466192738954. Distance: 3.8881953362739456
Total norm for 5 adversaries is: 16.886466192738954. distance: 3.8881953362739456
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1161, Accuracy: 8660/8991 (96.3185%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 3, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4141/4319 (95.8787%), train_poison_data_count: 4319
Global model norm: 16.115719985903905.
Norm before scaling: 16.759347613253773. Distance: 3.796619547974939
Total norm for 5 adversaries is: 16.759347613253773. distance: 3.796619547974939
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1108, Accuracy: 8700/8991 (96.7634%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0024, Accuracy: 4201/4396 (95.5641%), train_poison_data_count: 4396
Global model norm: 16.115719985903905.
Norm before scaling: 16.925092030307397. Distance: 4.099352780872354
Total norm for 5 adversaries is: 16.925092030307397. distance: 4.099352780872354
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1020, Accuracy: 8725/8991 (97.0415%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3203/3341 (95.8695%), train_poison_data_count: 3341
Global model norm: 16.115719985903905.
Norm before scaling: 16.579604964571683. Distance: 3.250271712462511
Total norm for 5 adversaries is: 16.579604964571683. distance: 3.250271712462511
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1377, Accuracy: 8607/8991 (95.7291%)
___Train Local_Simple,  epoch  18, local model 6, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4791/5024 (95.3623%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1005, Accuracy: 9664/10000 (96.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3494/3641 (95.9626%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0986, Accuracy: 9684/10000 (96.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 8, internal_epoch   1,  Average loss: 0.0023, Accuracy: 4497/4701 (95.6605%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1017, Accuracy: 9700/10000 (97.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 9, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3166/3315 (95.5053%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1858, Accuracy: 9400/10000 (94.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 10, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3313/3435 (96.4483%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0887, Accuracy: 9729/10000 (97.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 11, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3763/3917 (96.0684%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1277, Accuracy: 9600/10000 (96.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3918/4069 (96.2890%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1162, Accuracy: 9638/10000 (96.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 13, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3693/3851 (95.8972%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0925, Accuracy: 9707/10000 (97.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3010/3110 (96.7846%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2274, Accuracy: 9217/10000 (92.1700%), Attack Success Rate:0/10000(0.000)
time spent on training: 264.00377655029297
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         0.55665701 1.         0.55665701 1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 0.2143, Accuracy: 9381/10000 (93.8100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 0.2387, Accuracy: 8221/8991 (91.4359%)
Done in 291.2878940105438 sec.
Server Epoch:19 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  19, local model 0, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3807/3973 (95.8218%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1163, Accuracy: 9635/10000 (96.3500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3492/3656 (95.5142%), train_poison_data_count: 3656
Global model norm: 16.189924257418177.
Norm before scaling: 16.737172239369244. Distance: 3.490642846043934
Total norm for 5 adversaries is: 16.737172239369244. distance: 3.490642846043934
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0995, Accuracy: 8705/8991 (96.8190%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3689/3821 (96.5454%), train_poison_data_count: 3821
Global model norm: 16.189924257418177.
Norm before scaling: 16.558750865467157. Distance: 3.215768266309396
Total norm for 5 adversaries is: 16.558750865467157. distance: 3.215768266309396
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0765, Accuracy: 8775/8991 (97.5976%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4174/4319 (96.6427%), train_poison_data_count: 4319
Global model norm: 16.189924257418177.
Norm before scaling: 16.68592627030477. Distance: 3.3722614904718804
Total norm for 5 adversaries is: 16.68592627030477. distance: 3.3722614904718804
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0731, Accuracy: 8796/8991 (97.8312%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4233/4396 (96.2921%), train_poison_data_count: 4396
Global model norm: 16.189924257418177.
Norm before scaling: 16.66873542661999. Distance: 3.4458897251987013
Total norm for 5 adversaries is: 16.66873542661999. distance: 3.4458897251987013
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0923, Accuracy: 8740/8991 (97.2083%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3198/3341 (95.7198%), train_poison_data_count: 3341
Global model norm: 16.189924257418177.
Norm before scaling: 16.596102962591004. Distance: 3.0348772193168085
Total norm for 5 adversaries is: 16.596102962591004. distance: 3.0348772193168085
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0836, Accuracy: 8759/8991 (97.4196%)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4843/5024 (96.3973%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1100, Accuracy: 9664/10000 (96.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 7, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3489/3641 (95.8253%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1649, Accuracy: 9455/10000 (94.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4544/4701 (96.6603%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1459, Accuracy: 9552/10000 (95.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 9, internal_epoch   1,  Average loss: 0.0028, Accuracy: 3140/3315 (94.7210%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1105, Accuracy: 9649/10000 (96.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 10, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3293/3435 (95.8661%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1347, Accuracy: 9587/10000 (95.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 11, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3729/3917 (95.2004%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1170, Accuracy: 9634/10000 (96.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 12, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3935/4069 (96.7068%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1284, Accuracy: 9623/10000 (96.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 13, internal_epoch   1,  Average loss: 0.0025, Accuracy: 3646/3851 (94.6767%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1147, Accuracy: 9662/10000 (96.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 14, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3014/3110 (96.9132%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1546, Accuracy: 9486/10000 (94.8600%), Attack Success Rate:0/10000(0.000)
time spent on training: 268.5098478794098
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         0.         0.4888772  0.11214288 0.11214288 0.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 0.1876, Accuracy: 9481/10000 (94.8100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 0.2435, Accuracy: 8131/8991 (90.4349%)
Done in 296.6943802833557 sec.
Server Epoch:20 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  20, local model 0, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3840/3973 (96.6524%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1422, Accuracy: 9531/10000 (95.3100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 1, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3516/3656 (96.1707%), train_poison_data_count: 3656
Global model norm: 16.244700345240002.
Norm before scaling: 16.701354486963588. Distance: 3.34117911786304
Total norm for 5 adversaries is: 16.701354486963588. distance: 3.34117911786304
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0938, Accuracy: 8724/8991 (97.0304%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3689/3821 (96.5454%), train_poison_data_count: 3821
Global model norm: 16.244700345240002.
Norm before scaling: 16.592397286259697. Distance: 3.0020890909351956
Total norm for 5 adversaries is: 16.592397286259697. distance: 3.0020890909351956
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1012, Accuracy: 8695/8991 (96.7078%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 3, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4139/4319 (95.8324%), train_poison_data_count: 4319
Global model norm: 16.244700345240002.
Norm before scaling: 16.811367294556977. Distance: 3.647361711125211
Total norm for 5 adversaries is: 16.811367294556977. distance: 3.647361711125211
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0844, Accuracy: 8762/8991 (97.4530%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 4, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4243/4396 (96.5196%), train_poison_data_count: 4396
Global model norm: 16.244700345240002.
Norm before scaling: 16.797410056884978. Distance: 3.6030250608243377
Total norm for 5 adversaries is: 16.797410056884978. distance: 3.6030250608243377
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.0785, Accuracy: 8757/8991 (97.3974%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 5, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3199/3341 (95.7498%), train_poison_data_count: 3341
Global model norm: 16.244700345240002.
Norm before scaling: 16.6664458196631. Distance: 3.239097943183359
Total norm for 5 adversaries is: 16.6664458196631. distance: 3.239097943183359
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.1011, Accuracy: 8703/8991 (96.7968%)
___Train Local_Simple,  epoch  20, local model 6, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4823/5024 (95.9992%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1083, Accuracy: 9677/10000 (96.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 7, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3493/3641 (95.9352%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1259, Accuracy: 9610/10000 (96.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4541/4701 (96.5965%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1046, Accuracy: 9679/10000 (96.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3190/3315 (96.2293%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1238, Accuracy: 9619/10000 (96.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 10, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3308/3435 (96.3028%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1179, Accuracy: 9627/10000 (96.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3752/3917 (95.7876%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1945, Accuracy: 9394/10000 (93.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3935/4069 (96.7068%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1260, Accuracy: 9603/10000 (96.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3690/3851 (95.8193%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.0898, Accuracy: 9717/10000 (97.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 14, internal_epoch   1,  Average loss: 0.0018, Accuracy: 2997/3110 (96.3666%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1496, Accuracy: 9473/10000 (94.7300%), Attack Success Rate:0/10000(0.000)
time spent on training: 276.2624053955078
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         0.6620432  0.53673574 0.53673574 0.78709695 0.78709695
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 0.1728, Accuracy: 9486/10000 (94.8600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 0.2304, Accuracy: 8148/8991 (90.6240%)
Done in 304.5918140411377 sec.
Server Epoch:21 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  21, local model 0, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3836/3973 (96.5517%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1759, Accuracy: 9450/10000 (94.5000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3514/3656 (96.1160%), train_poison_data_count: 3656
Global model norm: 16.308269551418345.
Norm before scaling: 16.654283017358196. Distance: 3.124520684676638
Total norm for 5 adversaries is: 16.654283017358196. distance: 3.124520684676638
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0856, Accuracy: 8724/8991 (97.0304%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3695/3821 (96.7024%), train_poison_data_count: 3821
Global model norm: 16.308269551418345.
Norm before scaling: 16.732880455261675. Distance: 3.1288733319897624
Total norm for 5 adversaries is: 16.732880455261675. distance: 3.1288733319897624
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0805, Accuracy: 8767/8991 (97.5086%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4172/4319 (96.5964%), train_poison_data_count: 4319
Global model norm: 16.308269551418345.
Norm before scaling: 16.66635334991956. Distance: 3.388912911321272
Total norm for 5 adversaries is: 16.66635334991956. distance: 3.388912911321272
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1400, Accuracy: 8611/8991 (95.7736%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4246/4396 (96.5878%), train_poison_data_count: 4396
Global model norm: 16.308269551418345.
Norm before scaling: 16.791618908734556. Distance: 3.5765249347838832
Total norm for 5 adversaries is: 16.791618908734556. distance: 3.5765249347838832
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0834, Accuracy: 8759/8991 (97.4196%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3197/3341 (95.6899%), train_poison_data_count: 3341
Global model norm: 16.308269551418345.
Norm before scaling: 16.729223318546406. Distance: 3.2055764842401557
Total norm for 5 adversaries is: 16.729223318546406. distance: 3.2055764842401557
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.1061, Accuracy: 8706/8991 (96.8302%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4815/5024 (95.8400%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1026, Accuracy: 9659/10000 (96.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 7, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3521/3641 (96.7042%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1187, Accuracy: 9616/10000 (96.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4544/4701 (96.6603%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1165, Accuracy: 9648/10000 (96.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 9, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3199/3315 (96.5008%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1171, Accuracy: 9633/10000 (96.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3322/3435 (96.7103%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0942, Accuracy: 9694/10000 (96.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 11, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3770/3917 (96.2471%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0991, Accuracy: 9666/10000 (96.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3953/4069 (97.1492%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1204, Accuracy: 9612/10000 (96.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 13, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3699/3851 (96.0530%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0780, Accuracy: 9774/10000 (97.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3020/3110 (97.1061%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1096, Accuracy: 9676/10000 (96.7600%), Attack Success Rate:0/10000(0.000)
time spent on training: 282.69183468818665
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         1.         0.20797685 0.         0.         0.
 1.         1.         1.         1.         0.9949206  0.96736604
 0.75954564 0.75954564 1.        ]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 0.1551, Accuracy: 9556/10000 (95.5600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 0.2431, Accuracy: 8095/8991 (90.0345%)
Done in 310.62668895721436 sec.
Server Epoch:22 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  22, local model 0, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3865/3973 (97.2817%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0901, Accuracy: 9732/10000 (97.3200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 1, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3506/3656 (95.8972%), train_poison_data_count: 3656
Global model norm: 16.354866521483654.
Norm before scaling: 16.70177474956348. Distance: 3.2260416640389558
Total norm for 5 adversaries is: 16.70177474956348. distance: 3.2260416640389558
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0800, Accuracy: 8767/8991 (97.5086%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3714/3821 (97.1997%), train_poison_data_count: 3821
Global model norm: 16.354866521483654.
Norm before scaling: 16.616842233131457. Distance: 2.9429570905931937
Total norm for 5 adversaries is: 16.616842233131457. distance: 2.9429570905931937
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0681, Accuracy: 8779/8991 (97.6421%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4154/4319 (96.1797%), train_poison_data_count: 4319
Global model norm: 16.354866521483654.
Norm before scaling: 16.76732775457368. Distance: 3.4513789807251403
Total norm for 5 adversaries is: 16.76732775457368. distance: 3.4513789807251403
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0927, Accuracy: 8743/8991 (97.2417%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4264/4396 (96.9973%), train_poison_data_count: 4396
Global model norm: 16.354866521483654.
Norm before scaling: 16.713020155693265. Distance: 3.3315781422759425
Total norm for 5 adversaries is: 16.713020155693265. distance: 3.3315781422759425
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.1130, Accuracy: 8672/8991 (96.4520%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3189/3341 (95.4505%), train_poison_data_count: 3341
Global model norm: 16.354866521483654.
Norm before scaling: 16.832777763238084. Distance: 3.4315300165370157
Total norm for 5 adversaries is: 16.832777763238084. distance: 3.4315300165370157
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.0956, Accuracy: 8719/8991 (96.9748%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4842/5024 (96.3774%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1613, Accuracy: 9477/10000 (94.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3535/3641 (97.0887%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0844, Accuracy: 9742/10000 (97.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4535/4701 (96.4688%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1684, Accuracy: 9480/10000 (94.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3194/3315 (96.3499%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0925, Accuracy: 9734/10000 (97.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 10, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3349/3435 (97.4964%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0750, Accuracy: 9767/10000 (97.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3780/3917 (96.5024%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0784, Accuracy: 9764/10000 (97.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3964/4069 (97.4195%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0956, Accuracy: 9712/10000 (97.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3730/3851 (96.8580%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0777, Accuracy: 9750/10000 (97.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 14, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3016/3110 (96.9775%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1561, Accuracy: 9507/10000 (95.0700%), Attack Success Rate:0/10000(0.000)
time spent on training: 289.55629086494446
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         0.04249549 0.0213815  0.0213815  0.         0.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 0.1352, Accuracy: 9620/10000 (96.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 0.2711, Accuracy: 8042/8991 (89.4450%)
Done in 316.0978124141693 sec.
Server Epoch:23 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  23, local model 0, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3873/3973 (97.4830%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1314, Accuracy: 9585/10000 (95.8500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3529/3656 (96.5263%), train_poison_data_count: 3656
Global model norm: 16.396428421770224.
Norm before scaling: 16.739103046483145. Distance: 3.2317935390530352
Total norm for 5 adversaries is: 16.739103046483145. distance: 3.2317935390530352
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0962, Accuracy: 8721/8991 (96.9970%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3690/3821 (96.5716%), train_poison_data_count: 3821
Global model norm: 16.396428421770224.
Norm before scaling: 16.759344881860407. Distance: 3.3074551439307185
Total norm for 5 adversaries is: 16.759344881860407. distance: 3.3074551439307185
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1223, Accuracy: 8641/8991 (96.1072%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4145/4319 (95.9713%), train_poison_data_count: 4319
Global model norm: 16.396428421770224.
Norm before scaling: 16.894618406567094. Distance: 3.7428306711772934
Total norm for 5 adversaries is: 16.894618406567094. distance: 3.7428306711772934
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0858, Accuracy: 8779/8991 (97.6421%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 4, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4236/4396 (96.3603%), train_poison_data_count: 4396
Global model norm: 16.396428421770224.
Norm before scaling: 16.933124723175727. Distance: 3.960789303386732
Total norm for 5 adversaries is: 16.933124723175727. distance: 3.960789303386732
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0799, Accuracy: 8779/8991 (97.6421%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3210/3341 (96.0790%), train_poison_data_count: 3341
Global model norm: 16.396428421770224.
Norm before scaling: 16.7941113278723. Distance: 3.263506188287562
Total norm for 5 adversaries is: 16.7941113278723. distance: 3.263506188287562
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.1227, Accuracy: 8680/8991 (96.5410%)
___Train Local_Simple,  epoch  23, local model 6, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4825/5024 (96.0390%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2036, Accuracy: 9302/10000 (93.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 7, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3501/3641 (96.1549%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0998, Accuracy: 9700/10000 (97.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4548/4701 (96.7454%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1655, Accuracy: 9481/10000 (94.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 9, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3203/3315 (96.6214%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1224, Accuracy: 9606/10000 (96.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3337/3435 (97.1470%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0912, Accuracy: 9689/10000 (96.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 11, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3790/3917 (96.7577%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1224, Accuracy: 9604/10000 (96.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3964/4069 (97.4195%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1202, Accuracy: 9656/10000 (96.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 13, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3713/3851 (96.4165%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1117, Accuracy: 9630/10000 (96.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3016/3110 (96.9775%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1927, Accuracy: 9346/10000 (93.4600%), Attack Success Rate:0/10000(0.000)
time spent on training: 296.3969757556915
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         0.         0.54634429 0.         0.         0.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 0.1235, Accuracy: 9653/10000 (96.5300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 0.2931, Accuracy: 8012/8991 (89.1113%)
Done in 323.85565853118896 sec.
Server Epoch:24 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  24, local model 0, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3841/3973 (96.6776%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2197, Accuracy: 9301/10000 (93.0100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3537/3656 (96.7451%), train_poison_data_count: 3656
Global model norm: 16.437054414112644.
Norm before scaling: 16.774882950353092. Distance: 3.215590917408512
Total norm for 5 adversaries is: 16.774882950353092. distance: 3.215590917408512
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0774, Accuracy: 8778/8991 (97.6310%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 2, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3708/3821 (97.0427%), train_poison_data_count: 3821
Global model norm: 16.437054414112644.
Norm before scaling: 16.701851492026826. Distance: 3.0763217659414273
Total norm for 5 adversaries is: 16.701851492026826. distance: 3.0763217659414273
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0805, Accuracy: 8763/8991 (97.4641%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4181/4319 (96.8048%), train_poison_data_count: 4319
Global model norm: 16.437054414112644.
Norm before scaling: 16.778918454184925. Distance: 3.4464239632937828
Total norm for 5 adversaries is: 16.778918454184925. distance: 3.4464239632937828
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.0788, Accuracy: 8786/8991 (97.7199%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4262/4396 (96.9518%), train_poison_data_count: 4396
Global model norm: 16.437054414112644.
Norm before scaling: 16.845358805357932. Distance: 3.5251487754646833
Total norm for 5 adversaries is: 16.845358805357932. distance: 3.5251487754646833
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1201, Accuracy: 8649/8991 (96.1962%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 5, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3211/3341 (96.1089%), train_poison_data_count: 3341
Global model norm: 16.437054414112644.
Norm before scaling: 16.704722685808516. Distance: 3.09229329040508
Total norm for 5 adversaries is: 16.704722685808516. distance: 3.09229329040508
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.1295, Accuracy: 8655/8991 (96.2629%)
___Train Local_Simple,  epoch  24, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4868/5024 (96.8949%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0822, Accuracy: 9730/10000 (97.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 7, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3501/3641 (96.1549%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1515, Accuracy: 9517/10000 (95.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4547/4701 (96.7241%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1325, Accuracy: 9592/10000 (95.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 9, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3193/3315 (96.3198%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1172, Accuracy: 9625/10000 (96.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3324/3435 (96.7686%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1092, Accuracy: 9650/10000 (96.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 11, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3785/3917 (96.6301%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1017, Accuracy: 9663/10000 (96.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3978/4069 (97.7636%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0877, Accuracy: 9731/10000 (97.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3734/3851 (96.9618%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1182, Accuracy: 9635/10000 (96.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3033/3110 (97.5241%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1400, Accuracy: 9525/10000 (95.2500%), Attack Success Rate:0/10000(0.000)
time spent on training: 306.1703870296478
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         0.         0.         0.         0.0784352  0.12562114
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 0.1141, Accuracy: 9674/10000 (96.7400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.3108, Accuracy: 8012/8991 (89.1113%)
Done in 333.64231181144714 sec.
Server Epoch:25 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3864/3973 (97.2565%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0911, Accuracy: 9708/10000 (97.0800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3508/3656 (95.9519%), train_poison_data_count: 3656
Global model norm: 16.476974605147387.
Norm before scaling: 16.817237838759095. Distance: 3.4065260469064307
Total norm for 5 adversaries is: 16.817237838759095. distance: 3.4065260469064307
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0779, Accuracy: 8765/8991 (97.4864%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3704/3821 (96.9380%), train_poison_data_count: 3821
Global model norm: 16.476974605147387.
Norm before scaling: 16.791361740536786. Distance: 3.1359447317605484
Total norm for 5 adversaries is: 16.791361740536786. distance: 3.1359447317605484
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0953, Accuracy: 8715/8991 (96.9303%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4171/4319 (96.5733%), train_poison_data_count: 4319
Global model norm: 16.476974605147387.
Norm before scaling: 16.951761357887435. Distance: 3.6639164812155913
Total norm for 5 adversaries is: 16.951761357887435. distance: 3.6639164812155913
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1006, Accuracy: 8732/8991 (97.1193%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4252/4396 (96.7243%), train_poison_data_count: 4396
Global model norm: 16.476974605147387.
Norm before scaling: 16.90472732427835. Distance: 3.7156231982047907
Total norm for 5 adversaries is: 16.90472732427835. distance: 3.7156231982047907
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.0812, Accuracy: 8771/8991 (97.5531%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3207/3341 (95.9892%), train_poison_data_count: 3341
Global model norm: 16.476974605147387.
Norm before scaling: 16.81619437656888. Distance: 3.2262070577809
Total norm for 5 adversaries is: 16.81619437656888. distance: 3.2262070577809
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.1053, Accuracy: 8704/8991 (96.8079%)
___Train Local_Simple,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4836/5024 (96.2580%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0702, Accuracy: 9786/10000 (97.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 7, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3536/3641 (97.1162%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1026, Accuracy: 9670/10000 (96.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4555/4701 (96.8943%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0763, Accuracy: 9761/10000 (97.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 9, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3203/3315 (96.6214%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0961, Accuracy: 9700/10000 (97.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3330/3435 (96.9432%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0985, Accuracy: 9701/10000 (97.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 11, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3797/3917 (96.9364%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1121, Accuracy: 9647/10000 (96.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3969/4069 (97.5424%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0926, Accuracy: 9696/10000 (96.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3728/3851 (96.8060%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1454, Accuracy: 9571/10000 (95.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 14, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3033/3110 (97.5241%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1664, Accuracy: 9464/10000 (94.6400%), Attack Success Rate:0/10000(0.000)
time spent on training: 309.08864426612854
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         0.         0.13265344 0.         0.         0.86611218
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 0.1031, Accuracy: 9713/10000 (97.1300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.3345, Accuracy: 7978/8991 (88.7332%)
Done in 337.281240940094 sec.
Server Epoch:26 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  26, local model 0, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3861/3973 (97.1810%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1054, Accuracy: 9679/10000 (96.7900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3519/3656 (96.2527%), train_poison_data_count: 3656
Global model norm: 16.517076383423895.
Norm before scaling: 16.835585843195172. Distance: 3.2986107184872755
Total norm for 5 adversaries is: 16.835585843195172. distance: 3.2986107184872755
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1392, Accuracy: 8589/8991 (95.5289%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3704/3821 (96.9380%), train_poison_data_count: 3821
Global model norm: 16.517076383423895.
Norm before scaling: 16.75275637593427. Distance: 3.0334736641362654
Total norm for 5 adversaries is: 16.75275637593427. distance: 3.0334736641362654
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.0671, Accuracy: 8802/8991 (97.8979%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4167/4319 (96.4807%), train_poison_data_count: 4319
Global model norm: 16.517076383423895.
Norm before scaling: 17.02103334618304. Distance: 3.7334909070911797
Total norm for 5 adversaries is: 17.02103334618304. distance: 3.7334909070911797
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1173, Accuracy: 8674/8991 (96.4743%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4265/4396 (97.0200%), train_poison_data_count: 4396
Global model norm: 16.517076383423895.
Norm before scaling: 16.84736235035213. Distance: 3.519689219800449
Total norm for 5 adversaries is: 16.84736235035213. distance: 3.519689219800449
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1105, Accuracy: 8682/8991 (96.5632%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3209/3341 (96.0491%), train_poison_data_count: 3341
Global model norm: 16.517076383423895.
Norm before scaling: 16.844297156001716. Distance: 3.338230033212012
Total norm for 5 adversaries is: 16.844297156001716. distance: 3.338230033212012
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.1352, Accuracy: 8676/8991 (96.4965%)
___Train Local_Simple,  epoch  26, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4864/5024 (96.8153%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.0776, Accuracy: 9737/10000 (97.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 7, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3514/3641 (96.5119%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1802, Accuracy: 9405/10000 (94.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4549/4701 (96.7666%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.0867, Accuracy: 9706/10000 (97.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 9, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3209/3315 (96.8024%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1435, Accuracy: 9537/10000 (95.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 10, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3322/3435 (96.7103%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1153, Accuracy: 9623/10000 (96.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3810/3917 (97.2683%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1402, Accuracy: 9562/10000 (95.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3959/4069 (97.2966%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1133, Accuracy: 9630/10000 (96.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3737/3851 (97.0397%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1115, Accuracy: 9670/10000 (96.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3035/3110 (97.5884%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1173, Accuracy: 9642/10000 (96.4200%), Attack Success Rate:0/10000(0.000)
time spent on training: 317.5869221687317
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         0.         0.         0.09234284 0.         0.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 0.0937, Accuracy: 9745/10000 (97.4500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.3714, Accuracy: 7954/8991 (88.4662%)
Done in 345.6762557029724 sec.
Server Epoch:27 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3857/3973 (97.0803%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.0659, Accuracy: 9775/10000 (97.7500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3513/3656 (96.0886%), train_poison_data_count: 3656
Global model norm: 16.555434076487924.
Norm before scaling: 16.8994858161309. Distance: 3.4856380345985074
Total norm for 5 adversaries is: 16.8994858161309. distance: 3.4856380345985074
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0569, Accuracy: 8836/8991 (98.2761%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3692/3821 (96.6239%), train_poison_data_count: 3821
Global model norm: 16.555434076487924.
Norm before scaling: 17.01060424377339. Distance: 3.7187116604920303
Total norm for 5 adversaries is: 17.01060424377339. distance: 3.7187116604920303
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0864, Accuracy: 8744/8991 (97.2528%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4174/4319 (96.6427%), train_poison_data_count: 4319
Global model norm: 16.555434076487924.
Norm before scaling: 16.94772559466406. Distance: 3.9052866243682085
Total norm for 5 adversaries is: 16.94772559466406. distance: 3.9052866243682085
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.1082, Accuracy: 8711/8991 (96.8858%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4266/4396 (97.0428%), train_poison_data_count: 4396
Global model norm: 16.555434076487924.
Norm before scaling: 16.90463976851104. Distance: 3.5523849911096397
Total norm for 5 adversaries is: 16.90463976851104. distance: 3.5523849911096397
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0780, Accuracy: 8775/8991 (97.5976%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3204/3341 (95.8994%), train_poison_data_count: 3341
Global model norm: 16.555434076487924.
Norm before scaling: 17.06426344481538. Distance: 3.9579801033757436
Total norm for 5 adversaries is: 17.06426344481538. distance: 3.9579801033757436
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0786, Accuracy: 8767/8991 (97.5086%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4874/5024 (97.0143%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.0827, Accuracy: 9767/10000 (97.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 7, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3539/3641 (97.1986%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1149, Accuracy: 9618/10000 (96.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4550/4701 (96.7879%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1191, Accuracy: 9627/10000 (96.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 9, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3219/3315 (97.1041%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1161, Accuracy: 9636/10000 (96.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3359/3435 (97.7875%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.0934, Accuracy: 9702/10000 (97.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 11, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3802/3917 (97.0641%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.0983, Accuracy: 9711/10000 (97.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3968/4069 (97.5178%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.0888, Accuracy: 9731/10000 (97.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3738/3851 (97.0657%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.0928, Accuracy: 9730/10000 (97.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3031/3110 (97.4598%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1141, Accuracy: 9639/10000 (96.3900%), Attack Success Rate:0/10000(0.000)
time spent on training: 322.7539529800415
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 0.0863, Accuracy: 9754/10000 (97.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.4018, Accuracy: 7943/8991 (88.3439%)
Done in 350.90212225914 sec.
Server Epoch:28 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  28, local model 0, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3865/3973 (97.2817%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1548, Accuracy: 9484/10000 (94.8400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 1, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3498/3656 (95.6783%), train_poison_data_count: 3656
Global model norm: 16.591768250600676.
Norm before scaling: 17.09428469084907. Distance: 4.235952386158023
Total norm for 5 adversaries is: 17.09428469084907. distance: 4.235952386158023
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.2122, Accuracy: 8355/8991 (92.9263%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3694/3821 (96.6763%), train_poison_data_count: 3821
Global model norm: 16.591768250600676.
Norm before scaling: 16.84106831620993. Distance: 3.2852270819504197
Total norm for 5 adversaries is: 16.84106831620993. distance: 3.2852270819504197
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0969, Accuracy: 8711/8991 (96.8858%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4171/4319 (96.5733%), train_poison_data_count: 4319
Global model norm: 16.591768250600676.
Norm before scaling: 16.9515444251678. Distance: 3.5313507335777397
Total norm for 5 adversaries is: 16.9515444251678. distance: 3.5313507335777397
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0992, Accuracy: 8719/8991 (96.9748%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4242/4396 (96.4968%), train_poison_data_count: 4396
Global model norm: 16.591768250600676.
Norm before scaling: 16.97782708560869. Distance: 3.730574968833021
Total norm for 5 adversaries is: 16.97782708560869. distance: 3.730574968833021
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0731, Accuracy: 8796/8991 (97.8312%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 5, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3226/3341 (96.5579%), train_poison_data_count: 3341
Global model norm: 16.591768250600676.
Norm before scaling: 16.831229402605295. Distance: 3.1529771813638567
Total norm for 5 adversaries is: 16.831229402605295. distance: 3.1529771813638567
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.0791, Accuracy: 8764/8991 (97.4753%)
___Train Local_Simple,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4841/5024 (96.3575%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1272, Accuracy: 9573/10000 (95.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 7, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3536/3641 (97.1162%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.0929, Accuracy: 9704/10000 (97.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4573/4701 (97.2772%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1037, Accuracy: 9676/10000 (96.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 9, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3223/3315 (97.2247%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.0873, Accuracy: 9715/10000 (97.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 10, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3349/3435 (97.4964%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.0925, Accuracy: 9709/10000 (97.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3808/3917 (97.2173%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.0824, Accuracy: 9745/10000 (97.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3990/4069 (98.0585%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.0705, Accuracy: 9783/10000 (97.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 13, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3732/3851 (96.9099%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1071, Accuracy: 9645/10000 (96.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3036/3110 (97.6206%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1049, Accuracy: 9668/10000 (96.6800%), Attack Success Rate:0/10000(0.000)
time spent on training: 329.8930609226227
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         0.46893108 0.         0.         0.         0.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 0.0812, Accuracy: 9769/10000 (97.6900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.4244, Accuracy: 7938/8991 (88.2883%)
Done in 357.7888329029083 sec.
Server Epoch:29 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  29, local model 0, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3879/3973 (97.6340%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0892, Accuracy: 9731/10000 (97.3100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3527/3656 (96.4716%), train_poison_data_count: 3656
Global model norm: 16.627044781441544.
Norm before scaling: 16.854123914339834. Distance: 3.412189310204209
Total norm for 5 adversaries is: 16.854123914339834. distance: 3.412189310204209
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0739, Accuracy: 8782/8991 (97.6755%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 2, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3699/3821 (96.8071%), train_poison_data_count: 3821
Global model norm: 16.627044781441544.
Norm before scaling: 16.854186382997327. Distance: 3.1731745120249295
Total norm for 5 adversaries is: 16.854186382997327. distance: 3.1731745120249295
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0950, Accuracy: 8757/8991 (97.3974%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4161/4319 (96.3417%), train_poison_data_count: 4319
Global model norm: 16.627044781441544.
Norm before scaling: 16.993063016237777. Distance: 3.9059191754441795
Total norm for 5 adversaries is: 16.993063016237777. distance: 3.9059191754441795
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0831, Accuracy: 8790/8991 (97.7644%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4241/4396 (96.4741%), train_poison_data_count: 4396
Global model norm: 16.627044781441544.
Norm before scaling: 17.110539700653987. Distance: 4.259545321847973
Total norm for 5 adversaries is: 17.110539700653987. distance: 4.259545321847973
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0658, Accuracy: 8809/8991 (97.9758%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3220/3341 (96.3783%), train_poison_data_count: 3341
Global model norm: 16.627044781441544.
Norm before scaling: 16.900895206735722. Distance: 3.384904527317959
Total norm for 5 adversaries is: 16.900895206735722. distance: 3.384904527317959
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0696, Accuracy: 8790/8991 (97.7644%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4845/5024 (96.4371%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1021, Accuracy: 9693/10000 (96.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 7, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3507/3641 (96.3197%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0992, Accuracy: 9691/10000 (96.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4560/4701 (97.0006%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1018, Accuracy: 9703/10000 (97.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 9, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3228/3315 (97.3756%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0824, Accuracy: 9744/10000 (97.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 10, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3352/3435 (97.5837%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0933, Accuracy: 9690/10000 (96.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3809/3917 (97.2428%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0950, Accuracy: 9673/10000 (96.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3983/4069 (97.8865%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0747, Accuracy: 9773/10000 (97.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3743/3851 (97.1955%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1841, Accuracy: 9359/10000 (93.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 14, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3030/3110 (97.4277%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1565, Accuracy: 9475/10000 (94.7500%), Attack Success Rate:0/10000(0.000)
time spent on training: 334.9033741950989
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.0768, Accuracy: 9775/10000 (97.7500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.4673, Accuracy: 7931/8991 (88.2104%)
Done in 362.215815782547 sec.
Server Epoch:30 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  30, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3875/3973 (97.5334%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0847, Accuracy: 9734/10000 (97.3400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3504/3656 (95.8425%), train_poison_data_count: 3656
Global model norm: 16.661242912245754.
Norm before scaling: 17.18636981369384. Distance: 4.125815339860465
Total norm for 5 adversaries is: 17.18636981369384. distance: 4.125815339860465
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0898, Accuracy: 8764/8991 (97.4753%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3711/3821 (97.1212%), train_poison_data_count: 3821
Global model norm: 16.661242912245754.
Norm before scaling: 16.81215148337654. Distance: 3.0363752943738183
Total norm for 5 adversaries is: 16.81215148337654. distance: 3.0363752943738183
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0606, Accuracy: 8825/8991 (98.1537%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4195/4319 (97.1290%), train_poison_data_count: 4319
Global model norm: 16.661242912245754.
Norm before scaling: 16.987008909154298. Distance: 3.523688668985599
Total norm for 5 adversaries is: 16.987008909154298. distance: 3.523688668985599
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0936, Accuracy: 8740/8991 (97.2083%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4249/4396 (96.6561%), train_poison_data_count: 4396
Global model norm: 16.661242912245754.
Norm before scaling: 17.23134057177185. Distance: 4.2132437482396
Total norm for 5 adversaries is: 17.23134057177185. distance: 4.2132437482396
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.1032, Accuracy: 8711/8991 (96.8858%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3197/3341 (95.6899%), train_poison_data_count: 3341
Global model norm: 16.661242912245754.
Norm before scaling: 17.06592299112657. Distance: 3.771032732052446
Total norm for 5 adversaries is: 17.06592299112657. distance: 3.771032732052446
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.0578, Accuracy: 8831/8991 (98.2204%)
___Train Local_Simple,  epoch  30, local model 6, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4875/5024 (97.0342%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0812, Accuracy: 9753/10000 (97.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 7, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3530/3641 (96.9514%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1183, Accuracy: 9642/10000 (96.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4541/4701 (96.5965%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0800, Accuracy: 9727/10000 (97.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 9, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3204/3315 (96.6516%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1145, Accuracy: 9658/10000 (96.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3367/3435 (98.0204%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1039, Accuracy: 9668/10000 (96.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3812/3917 (97.3194%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0910, Accuracy: 9736/10000 (97.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3985/4069 (97.9356%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0830, Accuracy: 9751/10000 (97.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3752/3851 (97.4292%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0658, Accuracy: 9796/10000 (97.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3053/3110 (98.1672%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1442, Accuracy: 9553/10000 (95.5300%), Attack Success Rate:0/10000(0.000)
time spent on training: 345.43671774864197
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.0722, Accuracy: 9787/10000 (97.8700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.5060, Accuracy: 7926/8991 (88.1548%)
Done in 373.2937650680542 sec.
Server Epoch:31 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  31, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3874/3973 (97.5082%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1065, Accuracy: 9641/10000 (96.4100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3513/3656 (96.0886%), train_poison_data_count: 3656
Global model norm: 16.69441222859323.
Norm before scaling: 17.07923376003965. Distance: 3.899100268334588
Total norm for 5 adversaries is: 17.07923376003965. distance: 3.899100268334588
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.1017, Accuracy: 8692/8991 (96.6745%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3693/3821 (96.6501%), train_poison_data_count: 3821
Global model norm: 16.69441222859323.
Norm before scaling: 16.966280537966146. Distance: 3.398649362559195
Total norm for 5 adversaries is: 16.966280537966146. distance: 3.398649362559195
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0968, Accuracy: 8710/8991 (96.8747%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4170/4319 (96.5501%), train_poison_data_count: 4319
Global model norm: 16.69441222859323.
Norm before scaling: 17.072224399511203. Distance: 4.097620175678314
Total norm for 5 adversaries is: 17.072224399511203. distance: 4.097620175678314
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0742, Accuracy: 8781/8991 (97.6643%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4268/4396 (97.0883%), train_poison_data_count: 4396
Global model norm: 16.69441222859323.
Norm before scaling: 17.040205142796662. Distance: 3.877395504712329
Total norm for 5 adversaries is: 17.040205142796662. distance: 3.877395504712329
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0600, Accuracy: 8825/8991 (98.1537%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3203/3341 (95.8695%), train_poison_data_count: 3341
Global model norm: 16.69441222859323.
Norm before scaling: 17.11999705947423. Distance: 3.6524609878409646
Total norm for 5 adversaries is: 17.11999705947423. distance: 3.6524609878409646
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.0842, Accuracy: 8742/8991 (97.2306%)
___Train Local_Simple,  epoch  31, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4869/5024 (96.9148%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0873, Accuracy: 9723/10000 (97.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3526/3641 (96.8415%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0782, Accuracy: 9747/10000 (97.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4558/4701 (96.9581%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0954, Accuracy: 9687/10000 (96.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3234/3315 (97.5566%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0868, Accuracy: 9732/10000 (97.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3365/3435 (97.9622%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1354, Accuracy: 9555/10000 (95.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3800/3917 (97.0130%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1212, Accuracy: 9620/10000 (96.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3969/4069 (97.5424%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0794, Accuracy: 9753/10000 (97.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 13, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3729/3851 (96.8320%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0887, Accuracy: 9737/10000 (97.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3049/3110 (98.0386%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1411, Accuracy: 9553/10000 (95.5300%), Attack Success Rate:0/10000(0.000)
time spent on training: 352.52875304222107
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.0680, Accuracy: 9796/10000 (97.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.5472, Accuracy: 7914/8991 (88.0214%)
Done in 380.46154713630676 sec.
Server Epoch:32 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  32, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3873/3973 (97.4830%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.0916, Accuracy: 9711/10000 (97.1100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3526/3656 (96.4442%), train_poison_data_count: 3656
Global model norm: 16.725956755729438.
Norm before scaling: 17.150144953434886. Distance: 4.116030333189413
Total norm for 5 adversaries is: 17.150144953434886. distance: 4.116030333189413
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.2005, Accuracy: 8484/8991 (94.3610%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3699/3821 (96.8071%), train_poison_data_count: 3821
Global model norm: 16.725956755729438.
Norm before scaling: 17.043766007452604. Distance: 3.651123495812932
Total norm for 5 adversaries is: 17.043766007452604. distance: 3.651123495812932
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0764, Accuracy: 8777/8991 (97.6198%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4168/4319 (96.5038%), train_poison_data_count: 4319
Global model norm: 16.725956755729438.
Norm before scaling: 17.13446896917056. Distance: 4.140668991143082
Total norm for 5 adversaries is: 17.13446896917056. distance: 4.140668991143082
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.1157, Accuracy: 8675/8991 (96.4854%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4246/4396 (96.5878%), train_poison_data_count: 4396
Global model norm: 16.725956755729438.
Norm before scaling: 17.10404008577679. Distance: 4.179406158390447
Total norm for 5 adversaries is: 17.10404008577679. distance: 4.179406158390447
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0858, Accuracy: 8770/8991 (97.5420%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 5, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3229/3341 (96.6477%), train_poison_data_count: 3341
Global model norm: 16.725956755729438.
Norm before scaling: 17.02032691578844. Distance: 3.5562079562901476
Total norm for 5 adversaries is: 17.02032691578844. distance: 3.5562079562901476
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.0730, Accuracy: 8783/8991 (97.6866%)
___Train Local_Simple,  epoch  32, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4873/5024 (96.9944%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.0837, Accuracy: 9717/10000 (97.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 7, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3547/3641 (97.4183%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1009, Accuracy: 9677/10000 (96.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4564/4701 (97.0857%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.0693, Accuracy: 9773/10000 (97.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 9, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3223/3315 (97.2247%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1090, Accuracy: 9655/10000 (96.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3350/3435 (97.5255%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1114, Accuracy: 9652/10000 (96.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 11, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3823/3917 (97.6002%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.0675, Accuracy: 9809/10000 (98.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3989/4069 (98.0339%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.0810, Accuracy: 9745/10000 (97.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3744/3851 (97.2215%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1911, Accuracy: 9387/10000 (93.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3041/3110 (97.7814%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1000, Accuracy: 9702/10000 (97.0200%), Attack Success Rate:0/10000(0.000)
time spent on training: 359.2191627025604
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.0647, Accuracy: 9810/10000 (98.1000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.5877, Accuracy: 7918/8991 (88.0658%)
Done in 387.8921456336975 sec.
Server Epoch:33 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  33, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3878/3973 (97.6089%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0844, Accuracy: 9735/10000 (97.3500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3521/3656 (96.3074%), train_poison_data_count: 3656
Global model norm: 16.756621461170766.
Norm before scaling: 17.11136368294017. Distance: 3.9565406487655945
Total norm for 5 adversaries is: 17.11136368294017. distance: 3.9565406487655945
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0763, Accuracy: 8767/8991 (97.5086%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3690/3821 (96.5716%), train_poison_data_count: 3821
Global model norm: 16.756621461170766.
Norm before scaling: 17.00678162786512. Distance: 3.35338153693235
Total norm for 5 adversaries is: 17.00678162786512. distance: 3.35338153693235
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0780, Accuracy: 8780/8991 (97.6532%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4169/4319 (96.5270%), train_poison_data_count: 4319
Global model norm: 16.756621461170766.
Norm before scaling: 17.195618643628656. Distance: 4.394165132318426
Total norm for 5 adversaries is: 17.195618643628656. distance: 4.394165132318426
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0894, Accuracy: 8755/8991 (97.3752%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4247/4396 (96.6106%), train_poison_data_count: 4396
Global model norm: 16.756621461170766.
Norm before scaling: 17.138243517616985. Distance: 4.147124864054797
Total norm for 5 adversaries is: 17.138243517616985. distance: 4.147124864054797
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0689, Accuracy: 8819/8991 (98.0870%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3224/3341 (96.4981%), train_poison_data_count: 3341
Global model norm: 16.756621461170766.
Norm before scaling: 17.073138710550193. Distance: 3.8667218785345163
Total norm for 5 adversaries is: 17.073138710550193. distance: 3.8667218785345163
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.0851, Accuracy: 8763/8991 (97.4641%)
___Train Local_Simple,  epoch  33, local model 6, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4866/5024 (96.8551%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1188, Accuracy: 9620/10000 (96.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3546/3641 (97.3908%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0782, Accuracy: 9760/10000 (97.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4545/4701 (96.6816%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1119, Accuracy: 9673/10000 (96.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3233/3315 (97.5264%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1145, Accuracy: 9642/10000 (96.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 10, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3367/3435 (98.0204%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0680, Accuracy: 9784/10000 (97.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3831/3917 (97.8044%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0969, Accuracy: 9693/10000 (96.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3966/4069 (97.4687%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1037, Accuracy: 9698/10000 (96.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3748/3851 (97.3254%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0902, Accuracy: 9744/10000 (97.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3040/3110 (97.7492%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1162, Accuracy: 9648/10000 (96.4800%), Attack Success Rate:0/10000(0.000)
time spent on training: 362.80994272232056
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.0620, Accuracy: 9812/10000 (98.1200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.6229, Accuracy: 7916/8991 (88.0436%)
Done in 390.7135922908783 sec.
Server Epoch:34 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3885/3973 (97.7850%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2282, Accuracy: 9341/10000 (93.4100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3519/3656 (96.2527%), train_poison_data_count: 3656
Global model norm: 16.788024557841446.
Norm before scaling: 17.060110295108. Distance: 3.642396814983273
Total norm for 5 adversaries is: 17.060110295108. distance: 3.642396814983273
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0859, Accuracy: 8752/8991 (97.3418%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3690/3821 (96.5716%), train_poison_data_count: 3821
Global model norm: 16.788024557841446.
Norm before scaling: 17.155612287498933. Distance: 3.6193706606096363
Total norm for 5 adversaries is: 17.155612287498933. distance: 3.6193706606096363
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0995, Accuracy: 8728/8991 (97.0749%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4164/4319 (96.4112%), train_poison_data_count: 4319
Global model norm: 16.788024557841446.
Norm before scaling: 17.34518663109677. Distance: 4.566102578252809
Total norm for 5 adversaries is: 17.34518663109677. distance: 4.566102578252809
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0631, Accuracy: 8818/8991 (98.0759%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4268/4396 (97.0883%), train_poison_data_count: 4396
Global model norm: 16.788024557841446.
Norm before scaling: 16.957203570450154. Distance: 3.7789037061315605
Total norm for 5 adversaries is: 16.957203570450154. distance: 3.7789037061315605
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0768, Accuracy: 8782/8991 (97.6755%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 5, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3213/3341 (96.1688%), train_poison_data_count: 3341
Global model norm: 16.788024557841446.
Norm before scaling: 17.020740199057975. Distance: 3.4432859797020483
Total norm for 5 adversaries is: 17.020740199057975. distance: 3.4432859797020483
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.0852, Accuracy: 8740/8991 (97.2083%)
___Train Local_Simple,  epoch  34, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4897/5024 (97.4721%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.0749, Accuracy: 9766/10000 (97.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 7, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3536/3641 (97.1162%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1006, Accuracy: 9685/10000 (96.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 8, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4586/4701 (97.5537%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1149, Accuracy: 9627/10000 (96.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 9, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3232/3315 (97.4962%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.0762, Accuracy: 9768/10000 (97.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 10, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3366/3435 (97.9913%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.0752, Accuracy: 9758/10000 (97.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3819/3917 (97.4981%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.0868, Accuracy: 9721/10000 (97.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3971/4069 (97.5915%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.0779, Accuracy: 9748/10000 (97.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3755/3851 (97.5071%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.0938, Accuracy: 9700/10000 (97.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3037/3110 (97.6527%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1900, Accuracy: 9348/10000 (93.4800%), Attack Success Rate:0/10000(0.000)
time spent on training: 370.08588767051697
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.0591, Accuracy: 9820/10000 (98.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.6510, Accuracy: 7916/8991 (88.0436%)
Done in 397.99241518974304 sec.
Server Epoch:35 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  35, local model 0, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3884/3973 (97.7599%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.0884, Accuracy: 9735/10000 (97.3500%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3519/3656 (96.2527%), train_poison_data_count: 3656
Global model norm: 16.818975286488175.
Norm before scaling: 17.146276914004357. Distance: 3.7792387097833475
Total norm for 5 adversaries is: 17.146276914004357. distance: 3.7792387097833475
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0850, Accuracy: 8732/8991 (97.1193%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3679/3821 (96.2837%), train_poison_data_count: 3821
Global model norm: 16.818975286488175.
Norm before scaling: 17.237369059396617. Distance: 4.222506736628035
Total norm for 5 adversaries is: 17.237369059396617. distance: 4.222506736628035
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0599, Accuracy: 8830/8991 (98.2093%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4174/4319 (96.6427%), train_poison_data_count: 4319
Global model norm: 16.818975286488175.
Norm before scaling: 17.179061316180174. Distance: 4.407822781415251
Total norm for 5 adversaries is: 17.179061316180174. distance: 4.407822781415251
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0749, Accuracy: 8782/8991 (97.6755%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4247/4396 (96.6106%), train_poison_data_count: 4396
Global model norm: 16.818975286488175.
Norm before scaling: 17.3843038334985. Distance: 5.070168609223184
Total norm for 5 adversaries is: 17.3843038334985. distance: 5.070168609223184
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0817, Accuracy: 8770/8991 (97.5420%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3215/3341 (96.2287%), train_poison_data_count: 3341
Global model norm: 16.818975286488175.
Norm before scaling: 17.237994010324982. Distance: 3.9768578320387014
Total norm for 5 adversaries is: 17.237994010324982. distance: 3.9768578320387014
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0706, Accuracy: 8785/8991 (97.7088%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4864/5024 (96.8153%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1003, Accuracy: 9687/10000 (96.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3556/3641 (97.6655%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1024, Accuracy: 9676/10000 (96.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4561/4701 (97.0219%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1275, Accuracy: 9589/10000 (95.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3232/3315 (97.4962%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1082, Accuracy: 9656/10000 (96.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3359/3435 (97.7875%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1122, Accuracy: 9656/10000 (96.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3824/3917 (97.6257%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1047, Accuracy: 9687/10000 (96.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3981/4069 (97.8373%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1057, Accuracy: 9666/10000 (96.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3767/3851 (97.8187%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.0889, Accuracy: 9727/10000 (97.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3047/3110 (97.9743%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1179, Accuracy: 9612/10000 (96.1200%), Attack Success Rate:0/10000(0.000)
time spent on training: 378.40778636932373
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.0568, Accuracy: 9826/10000 (98.2600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.6725, Accuracy: 7918/8991 (88.0658%)
Done in 406.10183095932007 sec.
Server Epoch:36 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  36, local model 0, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3884/3973 (97.7599%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0978, Accuracy: 9710/10000 (97.1000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 1, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3519/3656 (96.2527%), train_poison_data_count: 3656
Global model norm: 16.847462883628335.
Norm before scaling: 17.042453489661213. Distance: 3.479161077864188
Total norm for 5 adversaries is: 17.042453489661213. distance: 3.479161077864188
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0952, Accuracy: 8738/8991 (97.1861%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3699/3821 (96.8071%), train_poison_data_count: 3821
Global model norm: 16.847462883628335.
Norm before scaling: 17.159579594937632. Distance: 3.750365811625354
Total norm for 5 adversaries is: 17.159579594937632. distance: 3.750365811625354
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0811, Accuracy: 8763/8991 (97.4641%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4170/4319 (96.5501%), train_poison_data_count: 4319
Global model norm: 16.847462883628335.
Norm before scaling: 17.321714076974402. Distance: 4.52939099291766
Total norm for 5 adversaries is: 17.321714076974402. distance: 4.52939099291766
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1035, Accuracy: 8705/8991 (96.8190%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4266/4396 (97.0428%), train_poison_data_count: 4396
Global model norm: 16.847462883628335.
Norm before scaling: 17.260392306611255. Distance: 4.501667137743857
Total norm for 5 adversaries is: 17.260392306611255. distance: 4.501667137743857
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1076, Accuracy: 8681/8991 (96.5521%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3196/3341 (95.6600%), train_poison_data_count: 3341
Global model norm: 16.847462883628335.
Norm before scaling: 17.361161903137507. Distance: 4.406220780945341
Total norm for 5 adversaries is: 17.361161903137507. distance: 4.406220780945341
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0760, Accuracy: 8774/8991 (97.5865%)
___Train Local_Simple,  epoch  36, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4875/5024 (97.0342%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0725, Accuracy: 9768/10000 (97.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3542/3641 (97.2810%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0825, Accuracy: 9747/10000 (97.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4588/4701 (97.5963%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0608, Accuracy: 9813/10000 (98.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 9, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3228/3315 (97.3756%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0780, Accuracy: 9773/10000 (97.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3369/3435 (98.0786%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1122, Accuracy: 9618/10000 (96.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3823/3917 (97.6002%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1143, Accuracy: 9648/10000 (96.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3967/4069 (97.4932%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1184, Accuracy: 9626/10000 (96.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3754/3851 (97.4812%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1189, Accuracy: 9603/10000 (96.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3056/3110 (98.2637%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1081, Accuracy: 9658/10000 (96.5800%), Attack Success Rate:0/10000(0.000)
time spent on training: 386.2917788028717
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.0551, Accuracy: 9831/10000 (98.3100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.6954, Accuracy: 7917/8991 (88.0547%)
Done in 414.11541771888733 sec.
Server Epoch:37 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3876/3973 (97.5585%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1056, Accuracy: 9683/10000 (96.8300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3515/3656 (96.1433%), train_poison_data_count: 3656
Global model norm: 16.876144709438417.
Norm before scaling: 17.082193376917562. Distance: 3.516626512078253
Total norm for 5 adversaries is: 17.082193376917562. distance: 3.516626512078253
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0649, Accuracy: 8814/8991 (98.0314%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 2, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3713/3821 (97.1735%), train_poison_data_count: 3821
Global model norm: 16.876144709438417.
Norm before scaling: 17.066961913733905. Distance: 3.6645307099404527
Total norm for 5 adversaries is: 17.066961913733905. distance: 3.6645307099404527
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0898, Accuracy: 8742/8991 (97.2306%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4137/4319 (95.7861%), train_poison_data_count: 4319
Global model norm: 16.876144709438417.
Norm before scaling: 17.57849652385159. Distance: 5.359328022297753
Total norm for 5 adversaries is: 17.57849652385159. distance: 5.359328022297753
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0557, Accuracy: 8842/8991 (98.3428%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 4, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4276/4396 (97.2702%), train_poison_data_count: 4396
Global model norm: 16.876144709438417.
Norm before scaling: 17.14807445515476. Distance: 3.9764262777502632
Total norm for 5 adversaries is: 17.14807445515476. distance: 3.9764262777502632
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0806, Accuracy: 8772/8991 (97.5642%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3220/3341 (96.3783%), train_poison_data_count: 3341
Global model norm: 16.876144709438417.
Norm before scaling: 17.121346411123383. Distance: 3.600442774352443
Total norm for 5 adversaries is: 17.121346411123383. distance: 3.600442774352443
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.0852, Accuracy: 8770/8991 (97.5420%)
___Train Local_Simple,  epoch  37, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4880/5024 (97.1338%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.0722, Accuracy: 9764/10000 (97.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3553/3641 (97.5831%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.0590, Accuracy: 9808/10000 (98.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4576/4701 (97.3410%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.0768, Accuracy: 9755/10000 (97.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 9, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3231/3315 (97.4661%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1837, Accuracy: 9366/10000 (93.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3362/3435 (97.8748%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1200, Accuracy: 9621/10000 (96.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3825/3917 (97.6513%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1231, Accuracy: 9624/10000 (96.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3988/4069 (98.0093%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.0704, Accuracy: 9790/10000 (97.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3755/3851 (97.5071%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.0981, Accuracy: 9699/10000 (96.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3040/3110 (97.7492%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1046, Accuracy: 9664/10000 (96.6400%), Attack Success Rate:0/10000(0.000)
time spent on training: 391.2482452392578
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.0538, Accuracy: 9833/10000 (98.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.7127, Accuracy: 7918/8991 (88.0658%)
Done in 418.60794591903687 sec.
Server Epoch:38 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  38, local model 0, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3884/3973 (97.7599%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0940, Accuracy: 9699/10000 (96.9900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3502/3656 (95.7877%), train_poison_data_count: 3656
Global model norm: 16.90537991638128.
Norm before scaling: 17.426440160009463. Distance: 4.355080735238926
Total norm for 5 adversaries is: 17.426440160009463. distance: 4.355080735238926
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0919, Accuracy: 8737/8991 (97.1750%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3703/3821 (96.9118%), train_poison_data_count: 3821
Global model norm: 16.90537991638128.
Norm before scaling: 17.241445880629836. Distance: 4.123649144785127
Total norm for 5 adversaries is: 17.241445880629836. distance: 4.123649144785127
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0983, Accuracy: 8738/8991 (97.1861%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4166/4319 (96.4575%), train_poison_data_count: 4319
Global model norm: 16.90537991638128.
Norm before scaling: 17.40801543728761. Distance: 4.595898599354307
Total norm for 5 adversaries is: 17.40801543728761. distance: 4.595898599354307
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.1435, Accuracy: 8575/8991 (95.3732%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4258/4396 (96.8608%), train_poison_data_count: 4396
Global model norm: 16.90537991638128.
Norm before scaling: 17.409178564510608. Distance: 4.732340863550314
Total norm for 5 adversaries is: 17.409178564510608. distance: 4.732340863550314
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0697, Accuracy: 8794/8991 (97.8089%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3215/3341 (96.2287%), train_poison_data_count: 3341
Global model norm: 16.90537991638128.
Norm before scaling: 17.136363025570525. Distance: 3.8004969522880274
Total norm for 5 adversaries is: 17.136363025570525. distance: 3.8004969522880274
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0765, Accuracy: 8757/8991 (97.3974%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4877/5024 (97.0740%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1341, Accuracy: 9564/10000 (95.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 7, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3549/3641 (97.4732%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0866, Accuracy: 9729/10000 (97.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 8, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4574/4701 (97.2984%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0953, Accuracy: 9705/10000 (97.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 9, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3223/3315 (97.2247%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0976, Accuracy: 9693/10000 (96.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3351/3435 (97.5546%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1121, Accuracy: 9643/10000 (96.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3828/3917 (97.7279%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0912, Accuracy: 9724/10000 (97.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3997/4069 (98.2305%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0849, Accuracy: 9727/10000 (97.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3764/3851 (97.7408%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1277, Accuracy: 9616/10000 (96.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3046/3110 (97.9421%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1064, Accuracy: 9651/10000 (96.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 397.3018424510956
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.0531, Accuracy: 9833/10000 (98.3300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.7188, Accuracy: 7924/8991 (88.1326%)
Done in 425.7782700061798 sec.
Server Epoch:39 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  39, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3875/3973 (97.5334%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.0754, Accuracy: 9760/10000 (97.6000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3511/3656 (96.0339%), train_poison_data_count: 3656
Global model norm: 16.93140800123536.
Norm before scaling: 17.351130714179607. Distance: 4.318746714169788
Total norm for 5 adversaries is: 17.351130714179607. distance: 4.318746714169788
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0622, Accuracy: 8811/8991 (97.9980%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 2, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3702/3821 (96.8856%), train_poison_data_count: 3821
Global model norm: 16.93140800123536.
Norm before scaling: 17.154286979282414. Distance: 3.5799075021994913
Total norm for 5 adversaries is: 17.154286979282414. distance: 3.5799075021994913
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0693, Accuracy: 8783/8991 (97.6866%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4159/4319 (96.2954%), train_poison_data_count: 4319
Global model norm: 16.93140800123536.
Norm before scaling: 17.536938728600926. Distance: 5.26510373034186
Total norm for 5 adversaries is: 17.536938728600926. distance: 5.26510373034186
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.1081, Accuracy: 8698/8991 (96.7412%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4249/4396 (96.6561%), train_poison_data_count: 4396
Global model norm: 16.93140800123536.
Norm before scaling: 17.472330944462232. Distance: 4.743454086864796
Total norm for 5 adversaries is: 17.472330944462232. distance: 4.743454086864796
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0994, Accuracy: 8716/8991 (96.9414%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3198/3341 (95.7198%), train_poison_data_count: 3341
Global model norm: 16.93140800123536.
Norm before scaling: 17.385959160418338. Distance: 4.1756238916649995
Total norm for 5 adversaries is: 17.385959160418338. distance: 4.1756238916649995
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.0870, Accuracy: 8752/8991 (97.3418%)
___Train Local_Simple,  epoch  39, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4883/5024 (97.1935%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1200, Accuracy: 9652/10000 (96.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 7, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3538/3641 (97.1711%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.0648, Accuracy: 9788/10000 (97.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 8, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4579/4701 (97.4048%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.0612, Accuracy: 9816/10000 (98.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3236/3315 (97.6169%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1202, Accuracy: 9651/10000 (96.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3362/3435 (97.8748%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1048, Accuracy: 9677/10000 (96.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3824/3917 (97.6257%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1458, Accuracy: 9545/10000 (95.4500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3998/4069 (98.2551%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.0694, Accuracy: 9801/10000 (98.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3776/3851 (98.0525%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1298, Accuracy: 9605/10000 (96.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3057/3110 (98.2958%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1141, Accuracy: 9620/10000 (96.2000%), Attack Success Rate:0/10000(0.000)
time spent on training: 405.6934697628021
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 39: Average loss: 0.0518, Accuracy: 9837/10000 (98.3700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 39: Average loss: 0.7392, Accuracy: 7922/8991 (88.1103%)
Done in 433.3878564834595 sec.
Server Epoch:40 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  40, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3895/3973 (98.0367%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0828, Accuracy: 9746/10000 (97.4600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3506/3656 (95.8972%), train_poison_data_count: 3656
Global model norm: 16.95967795300168.
Norm before scaling: 17.502583340295352. Distance: 4.811623827949805
Total norm for 5 adversaries is: 17.502583340295352. distance: 4.811623827949805
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0759, Accuracy: 8779/8991 (97.6421%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 2, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3686/3821 (96.4669%), train_poison_data_count: 3821
Global model norm: 16.95967795300168.
Norm before scaling: 17.347666365258252. Distance: 4.263787736773233
Total norm for 5 adversaries is: 17.347666365258252. distance: 4.263787736773233
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.1084, Accuracy: 8676/8991 (96.4965%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 3, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4176/4319 (96.6890%), train_poison_data_count: 4319
Global model norm: 16.95967795300168.
Norm before scaling: 17.276398293286746. Distance: 4.268366453217797
Total norm for 5 adversaries is: 17.276398293286746. distance: 4.268366453217797
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0991, Accuracy: 8722/8991 (97.0081%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4263/4396 (96.9745%), train_poison_data_count: 4396
Global model norm: 16.95967795300168.
Norm before scaling: 17.392265687992428. Distance: 4.757423623013678
Total norm for 5 adversaries is: 17.392265687992428. distance: 4.757423623013678
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0818, Accuracy: 8754/8991 (97.3640%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  40, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3211/3341 (96.1089%), train_poison_data_count: 3341
Global model norm: 16.95967795300168.
Norm before scaling: 17.231540699341046. Distance: 4.065633181799031
Total norm for 5 adversaries is: 17.231540699341046. distance: 4.065633181799031
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.0981, Accuracy: 8715/8991 (96.9303%)
___Train Local_Simple,  epoch  40, local model 6, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4852/5024 (96.5764%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1123, Accuracy: 9615/10000 (96.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3558/3641 (97.7204%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0878, Accuracy: 9720/10000 (97.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4590/4701 (97.6388%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1118, Accuracy: 9660/10000 (96.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3230/3315 (97.4359%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0651, Accuracy: 9791/10000 (97.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3372/3435 (98.1659%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0943, Accuracy: 9700/10000 (97.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3837/3917 (97.9576%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0807, Accuracy: 9766/10000 (97.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3997/4069 (98.2305%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0705, Accuracy: 9770/10000 (97.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3770/3851 (97.8967%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1120, Accuracy: 9642/10000 (96.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  40, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3053/3110 (98.1672%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1316, Accuracy: 9570/10000 (95.7000%), Attack Success Rate:0/10000(0.000)
time spent on training: 413.48164677619934
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 40: Average loss: 0.0504, Accuracy: 9834/10000 (98.3400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 40: Average loss: 0.7666, Accuracy: 7918/8991 (88.0658%)
Done in 440.993004322052 sec.
Server Epoch:41 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  41, local model 0, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3884/3973 (97.7599%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0859, Accuracy: 9731/10000 (97.3100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3508/3656 (95.9519%), train_poison_data_count: 3656
Global model norm: 16.985218578119163.
Norm before scaling: 17.42676238201292. Distance: 4.437120233323165
Total norm for 5 adversaries is: 17.42676238201292. distance: 4.437120233323165
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1103, Accuracy: 8686/8991 (96.6077%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 2, internal_epoch   1,  Average loss: 0.0016, Accuracy: 3707/3821 (97.0165%), train_poison_data_count: 3821
Global model norm: 16.985218578119163.
Norm before scaling: 17.164128285604473. Distance: 3.8241534125227985
Total norm for 5 adversaries is: 17.164128285604473. distance: 3.8241534125227985
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0638, Accuracy: 8809/8991 (97.9758%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 3, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4152/4319 (96.1334%), train_poison_data_count: 4319
Global model norm: 16.985218578119163.
Norm before scaling: 17.670450249264128. Distance: 5.010794431703618
Total norm for 5 adversaries is: 17.670450249264128. distance: 5.010794431703618
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.0985, Accuracy: 8713/8991 (96.9080%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4242/4396 (96.4968%), train_poison_data_count: 4396
Global model norm: 16.985218578119163.
Norm before scaling: 17.43280206652462. Distance: 4.925351032585338
Total norm for 5 adversaries is: 17.43280206652462. distance: 4.925351032585338
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1194, Accuracy: 8655/8991 (96.2629%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  41, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3225/3341 (96.5280%), train_poison_data_count: 3341
Global model norm: 16.985218578119163.
Norm before scaling: 17.124492999737157. Distance: 3.5114255789141313
Total norm for 5 adversaries is: 17.124492999737157. distance: 3.5114255789141313
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.1019, Accuracy: 8715/8991 (96.9303%)
___Train Local_Simple,  epoch  41, local model 6, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4864/5024 (96.8153%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0800, Accuracy: 9751/10000 (97.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3554/3641 (97.6105%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1327, Accuracy: 9562/10000 (95.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4587/4701 (97.5750%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1262, Accuracy: 9590/10000 (95.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 9, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3245/3315 (97.8884%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0968, Accuracy: 9690/10000 (96.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 3385/3435 (98.5444%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0569, Accuracy: 9824/10000 (98.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3835/3917 (97.9066%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0951, Accuracy: 9706/10000 (97.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3995/4069 (98.1814%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0756, Accuracy: 9771/10000 (97.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3757/3851 (97.5591%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0968, Accuracy: 9699/10000 (96.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  41, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3061/3110 (98.4244%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1302, Accuracy: 9590/10000 (95.9000%), Attack Success Rate:0/10000(0.000)
time spent on training: 415.1034061908722
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 41: Average loss: 0.0495, Accuracy: 9840/10000 (98.4000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 41: Average loss: 0.7665, Accuracy: 7924/8991 (88.1326%)
Done in 442.8060746192932 sec.
Server Epoch:42 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  42, local model 0, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3890/3973 (97.9109%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0904, Accuracy: 9716/10000 (97.1600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3516/3656 (96.1707%), train_poison_data_count: 3656
Global model norm: 17.00960314413872.
Norm before scaling: 17.51210693092514. Distance: 4.473986352100795
Total norm for 5 adversaries is: 17.51210693092514. distance: 4.473986352100795
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0927, Accuracy: 8759/8991 (97.4196%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 2, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3693/3821 (96.6501%), train_poison_data_count: 3821
Global model norm: 17.00960314413872.
Norm before scaling: 17.407770881435304. Distance: 4.183945698898126
Total norm for 5 adversaries is: 17.407770881435304. distance: 4.183945698898126
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0731, Accuracy: 8784/8991 (97.6977%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 3, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4128/4319 (95.5777%), train_poison_data_count: 4319
Global model norm: 17.00960314413872.
Norm before scaling: 17.89784839847857. Distance: 6.002505732878744
Total norm for 5 adversaries is: 17.89784839847857. distance: 6.002505732878744
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0794, Accuracy: 8781/8991 (97.6643%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 4, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4231/4396 (96.2466%), train_poison_data_count: 4396
Global model norm: 17.00960314413872.
Norm before scaling: 17.589983847015926. Distance: 4.8285068002988485
Total norm for 5 adversaries is: 17.589983847015926. distance: 4.8285068002988485
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0859, Accuracy: 8755/8991 (97.3752%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  42, local model 5, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3219/3341 (96.3484%), train_poison_data_count: 3341
Global model norm: 17.00960314413872.
Norm before scaling: 17.373192562802576. Distance: 4.237325956208146
Total norm for 5 adversaries is: 17.373192562802576. distance: 4.237325956208146
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.0925, Accuracy: 8714/8991 (96.9191%)
___Train Local_Simple,  epoch  42, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4888/5024 (97.2930%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0743, Accuracy: 9774/10000 (97.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3565/3641 (97.9127%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0851, Accuracy: 9738/10000 (97.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4582/4701 (97.4686%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1517, Accuracy: 9546/10000 (95.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 9, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3234/3315 (97.5566%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1113, Accuracy: 9671/10000 (96.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3367/3435 (98.0204%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0831, Accuracy: 9740/10000 (97.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3828/3917 (97.7279%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1051, Accuracy: 9675/10000 (96.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3992/4069 (98.1076%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1251, Accuracy: 9601/10000 (96.0100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3766/3851 (97.7928%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0931, Accuracy: 9693/10000 (96.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  42, local model 14, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3044/3110 (97.8778%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1057, Accuracy: 9689/10000 (96.8900%), Attack Success Rate:0/10000(0.000)
time spent on training: 424.51796531677246
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 42: Average loss: 0.0490, Accuracy: 9840/10000 (98.4000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 42: Average loss: 0.7782, Accuracy: 7925/8991 (88.1437%)
Done in 452.0107629299164 sec.
Server Epoch:43 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  43, local model 0, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3903/3973 (98.2381%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0577, Accuracy: 9813/10000 (98.1300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3511/3656 (96.0339%), train_poison_data_count: 3656
Global model norm: 17.035009798585108.
Norm before scaling: 17.393302663354724. Distance: 4.451908628076194
Total norm for 5 adversaries is: 17.393302663354724. distance: 4.451908628076194
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1008, Accuracy: 8709/8991 (96.8635%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3696/3821 (96.7286%), train_poison_data_count: 3821
Global model norm: 17.035009798585108.
Norm before scaling: 17.360539628180934. Distance: 4.278681966389514
Total norm for 5 adversaries is: 17.360539628180934. distance: 4.278681966389514
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1503, Accuracy: 8567/8991 (95.2842%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 3, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4189/4319 (96.9900%), train_poison_data_count: 4319
Global model norm: 17.035009798585108.
Norm before scaling: 17.37712424486527. Distance: 4.322117350879704
Total norm for 5 adversaries is: 17.37712424486527. distance: 4.322117350879704
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1311, Accuracy: 8630/8991 (95.9849%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4253/4396 (96.7470%), train_poison_data_count: 4396
Global model norm: 17.035009798585108.
Norm before scaling: 17.45332608154084. Distance: 4.682454967373886
Total norm for 5 adversaries is: 17.45332608154084. distance: 4.682454967373886
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.1681, Accuracy: 8529/8991 (94.8615%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  43, local model 5, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3224/3341 (96.4981%), train_poison_data_count: 3341
Global model norm: 17.035009798585108.
Norm before scaling: 17.27795886523718. Distance: 3.9164927964813283
Total norm for 5 adversaries is: 17.27795886523718. distance: 3.9164927964813283
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.0995, Accuracy: 8737/8991 (97.1750%)
___Train Local_Simple,  epoch  43, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4886/5024 (97.2532%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0851, Accuracy: 9739/10000 (97.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3541/3641 (97.2535%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0841, Accuracy: 9735/10000 (97.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 8, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4587/4701 (97.5750%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1027, Accuracy: 9686/10000 (96.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3232/3315 (97.4962%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0829, Accuracy: 9738/10000 (97.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 10, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3363/3435 (97.9039%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1189, Accuracy: 9652/10000 (96.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3829/3917 (97.7534%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0779, Accuracy: 9751/10000 (97.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 4000/4069 (98.3043%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0763, Accuracy: 9764/10000 (97.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3777/3851 (98.0784%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0783, Accuracy: 9757/10000 (97.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  43, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3059/3110 (98.3601%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0844, Accuracy: 9729/10000 (97.2900%), Attack Success Rate:0/10000(0.000)
time spent on training: 429.04864716529846
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 43: Average loss: 0.0475, Accuracy: 9846/10000 (98.4600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 43: Average loss: 0.8119, Accuracy: 7926/8991 (88.1548%)
Done in 456.4106922149658 sec.
Server Epoch:44 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  44, local model 0, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3890/3973 (97.9109%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0858, Accuracy: 9731/10000 (97.3100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 1, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3504/3656 (95.8425%), train_poison_data_count: 3656
Global model norm: 17.06163072991742.
Norm before scaling: 17.522044221249022. Distance: 4.510878236101868
Total norm for 5 adversaries is: 17.522044221249022. distance: 4.510878236101868
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0557, Accuracy: 8845/8991 (98.3762%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3697/3821 (96.7548%), train_poison_data_count: 3821
Global model norm: 17.06163072991742.
Norm before scaling: 17.391613818193292. Distance: 4.317953890393058
Total norm for 5 adversaries is: 17.391613818193292. distance: 4.317953890393058
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0579, Accuracy: 8831/8991 (98.2204%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4179/4319 (96.7585%), train_poison_data_count: 4319
Global model norm: 17.06163072991742.
Norm before scaling: 17.410675527229067. Distance: 4.676994860972741
Total norm for 5 adversaries is: 17.410675527229067. distance: 4.676994860972741
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0869, Accuracy: 8738/8991 (97.1861%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4260/4396 (96.9063%), train_poison_data_count: 4396
Global model norm: 17.06163072991742.
Norm before scaling: 17.540791952594923. Distance: 4.9505920672588495
Total norm for 5 adversaries is: 17.540791952594923. distance: 4.9505920672588495
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0889, Accuracy: 8746/8991 (97.2751%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  44, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3218/3341 (96.3185%), train_poison_data_count: 3341
Global model norm: 17.06163072991742.
Norm before scaling: 17.43620224365503. Distance: 4.421750339867147
Total norm for 5 adversaries is: 17.43620224365503. distance: 4.421750339867147
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.0804, Accuracy: 8768/8991 (97.5197%)
___Train Local_Simple,  epoch  44, local model 6, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4881/5024 (97.1537%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1100, Accuracy: 9651/10000 (96.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3560/3641 (97.7753%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0710, Accuracy: 9771/10000 (97.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4591/4701 (97.6601%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0995, Accuracy: 9707/10000 (97.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3242/3315 (97.7979%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0792, Accuracy: 9752/10000 (97.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3365/3435 (97.9622%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0902, Accuracy: 9722/10000 (97.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3834/3917 (97.8810%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0766, Accuracy: 9767/10000 (97.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 4001/4069 (98.3288%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0947, Accuracy: 9685/10000 (96.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3766/3851 (97.7928%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0672, Accuracy: 9790/10000 (97.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  44, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3057/3110 (98.2958%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1133, Accuracy: 9618/10000 (96.1800%), Attack Success Rate:0/10000(0.000)
time spent on training: 436.6293430328369
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 44: Average loss: 0.0460, Accuracy: 9849/10000 (98.4900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 44: Average loss: 0.8632, Accuracy: 7923/8991 (88.1215%)
Done in 464.54492926597595 sec.
Server Epoch:45 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  45, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3897/3973 (98.0871%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0829, Accuracy: 9743/10000 (97.4300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3513/3656 (96.0886%), train_poison_data_count: 3656
Global model norm: 17.08525161517694.
Norm before scaling: 17.666707356723975. Distance: 5.217588558130899
Total norm for 5 adversaries is: 17.666707356723975. distance: 5.217588558130899
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1030, Accuracy: 8698/8991 (96.7412%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 2, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3722/3821 (97.4091%), train_poison_data_count: 3821
Global model norm: 17.08525161517694.
Norm before scaling: 17.123566282080287. Distance: 3.3586919045685706
Total norm for 5 adversaries is: 17.123566282080287. distance: 3.3586919045685706
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0704, Accuracy: 8796/8991 (97.8312%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4175/4319 (96.6659%), train_poison_data_count: 4319
Global model norm: 17.08525161517694.
Norm before scaling: 17.450702222450552. Distance: 4.585973892197489
Total norm for 5 adversaries is: 17.450702222450552. distance: 4.585973892197489
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0646, Accuracy: 8803/8991 (97.9090%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4265/4396 (97.0200%), train_poison_data_count: 4396
Global model norm: 17.08525161517694.
Norm before scaling: 17.51990096808885. Distance: 4.838927988234314
Total norm for 5 adversaries is: 17.51990096808885. distance: 4.838927988234314
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0945, Accuracy: 8716/8991 (96.9414%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  45, local model 5, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3229/3341 (96.6477%), train_poison_data_count: 3341
Global model norm: 17.08525161517694.
Norm before scaling: 17.291865311672748. Distance: 3.838762101875093
Total norm for 5 adversaries is: 17.291865311672748. distance: 3.838762101875093
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1168, Accuracy: 8659/8991 (96.3074%)
___Train Local_Simple,  epoch  45, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4886/5024 (97.2532%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0885, Accuracy: 9705/10000 (97.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3563/3641 (97.8577%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1039, Accuracy: 9681/10000 (96.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 8, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4572/4701 (97.2559%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0791, Accuracy: 9761/10000 (97.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 9, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3226/3315 (97.3152%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0880, Accuracy: 9724/10000 (97.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3369/3435 (98.0786%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1296, Accuracy: 9602/10000 (96.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3830/3917 (97.7789%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1732, Accuracy: 9455/10000 (94.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3987/4069 (97.9848%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0731, Accuracy: 9778/10000 (97.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3757/3851 (97.5591%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1047, Accuracy: 9658/10000 (96.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  45, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3053/3110 (98.1672%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0856, Accuracy: 9706/10000 (97.0600%), Attack Success Rate:0/10000(0.000)
time spent on training: 445.009667634964
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 45: Average loss: 0.0458, Accuracy: 9853/10000 (98.5300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 45: Average loss: 0.8836, Accuracy: 7926/8991 (88.1548%)
Done in 472.583416223526 sec.
Server Epoch:46 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  46, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3895/3973 (98.0367%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0846, Accuracy: 9724/10000 (97.2400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3525/3656 (96.4168%), train_poison_data_count: 3656
Global model norm: 17.113784570177724.
Norm before scaling: 17.440030478354604. Distance: 4.323357224899627
Total norm for 5 adversaries is: 17.440030478354604. distance: 4.323357224899627
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.1309, Accuracy: 8631/8991 (95.9960%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3695/3821 (96.7024%), train_poison_data_count: 3821
Global model norm: 17.113784570177724.
Norm before scaling: 17.470560652192965. Distance: 4.491712780623143
Total norm for 5 adversaries is: 17.470560652192965. distance: 4.491712780623143
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0738, Accuracy: 8781/8991 (97.6643%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 3, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4175/4319 (96.6659%), train_poison_data_count: 4319
Global model norm: 17.113784570177724.
Norm before scaling: 17.647382659932713. Distance: 5.122994751688711
Total norm for 5 adversaries is: 17.647382659932713. distance: 5.122994751688711
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0934, Accuracy: 8750/8991 (97.3195%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 4, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4246/4396 (96.5878%), train_poison_data_count: 4396
Global model norm: 17.113784570177724.
Norm before scaling: 17.774509754743853. Distance: 5.504266991039096
Total norm for 5 adversaries is: 17.774509754743853. distance: 5.504266991039096
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0844, Accuracy: 8772/8991 (97.5642%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  46, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3231/3341 (96.7076%), train_poison_data_count: 3341
Global model norm: 17.113784570177724.
Norm before scaling: 17.43069073479842. Distance: 4.3409564139588666
Total norm for 5 adversaries is: 17.43069073479842. distance: 4.3409564139588666
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0722, Accuracy: 8773/8991 (97.5754%)
___Train Local_Simple,  epoch  46, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4893/5024 (97.3925%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0688, Accuracy: 9784/10000 (97.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3551/3641 (97.5282%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1492, Accuracy: 9553/10000 (95.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4581/4701 (97.4474%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0732, Accuracy: 9763/10000 (97.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3240/3315 (97.7376%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0597, Accuracy: 9820/10000 (98.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 3373/3435 (98.1951%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0805, Accuracy: 9761/10000 (97.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3850/3917 (98.2895%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0734, Accuracy: 9763/10000 (97.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3998/4069 (98.2551%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0633, Accuracy: 9798/10000 (97.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3776/3851 (98.0525%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0869, Accuracy: 9734/10000 (97.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  46, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3054/3110 (98.1994%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1477, Accuracy: 9524/10000 (95.2400%), Attack Success Rate:0/10000(0.000)
time spent on training: 450.06603503227234
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 46: Average loss: 0.0451, Accuracy: 9855/10000 (98.5500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 46: Average loss: 0.8906, Accuracy: 7928/8991 (88.1771%)
Done in 477.36800479888916 sec.
Server Epoch:47 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  47, local model 0, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3877/3973 (97.5837%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1095, Accuracy: 9693/10000 (96.9300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 1, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3538/3656 (96.7724%), train_poison_data_count: 3656
Global model norm: 17.137743141681007.
Norm before scaling: 17.424595149193028. Distance: 4.230632183549564
Total norm for 5 adversaries is: 17.424595149193028. distance: 4.230632183549564
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.1148, Accuracy: 8671/8991 (96.4409%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 2, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3678/3821 (96.2575%), train_poison_data_count: 3821
Global model norm: 17.137743141681007.
Norm before scaling: 17.65577726828433. Distance: 4.959952381274615
Total norm for 5 adversaries is: 17.65577726828433. distance: 4.959952381274615
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0809, Accuracy: 8766/8991 (97.4975%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 3, internal_epoch   1,  Average loss: 0.0022, Accuracy: 4164/4319 (96.4112%), train_poison_data_count: 4319
Global model norm: 17.137743141681007.
Norm before scaling: 17.828337257719802. Distance: 5.653459904051567
Total norm for 5 adversaries is: 17.828337257719802. distance: 5.653459904051567
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0673, Accuracy: 8809/8991 (97.9758%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4270/4396 (97.1338%), train_poison_data_count: 4396
Global model norm: 17.137743141681007.
Norm before scaling: 17.499819509392893. Distance: 4.561643546206933
Total norm for 5 adversaries is: 17.499819509392893. distance: 4.561643546206933
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0802, Accuracy: 8775/8991 (97.5976%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  47, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3224/3341 (96.4981%), train_poison_data_count: 3341
Global model norm: 17.137743141681007.
Norm before scaling: 17.432590244617085. Distance: 4.3799549926117605
Total norm for 5 adversaries is: 17.432590244617085. distance: 4.3799549926117605
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.0609, Accuracy: 8836/8991 (98.2761%)
___Train Local_Simple,  epoch  47, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4900/5024 (97.5318%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0858, Accuracy: 9715/10000 (97.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 7, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3571/3641 (98.0775%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0840, Accuracy: 9735/10000 (97.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4594/4701 (97.7239%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1318, Accuracy: 9599/10000 (95.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 9, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3224/3315 (97.2549%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0879, Accuracy: 9734/10000 (97.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 3384/3435 (98.5153%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0771, Accuracy: 9752/10000 (97.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3840/3917 (98.0342%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0944, Accuracy: 9678/10000 (96.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3991/4069 (98.0831%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0950, Accuracy: 9709/10000 (97.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 13, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3763/3851 (97.7149%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1441, Accuracy: 9540/10000 (95.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  47, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3051/3110 (98.1029%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1103, Accuracy: 9651/10000 (96.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 453.68680214881897
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1.         0.06339576 0.         0.         0.         0.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 47: Average loss: 0.0444, Accuracy: 9858/10000 (98.5800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 47: Average loss: 0.9060, Accuracy: 7927/8991 (88.1659%)
Done in 481.23187017440796 sec.
Server Epoch:48 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  48, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3902/3973 (98.2129%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1151, Accuracy: 9619/10000 (96.1900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 1, internal_epoch   1,  Average loss: 0.0020, Accuracy: 3529/3656 (96.5263%), train_poison_data_count: 3656
Global model norm: 17.161530451606183.
Norm before scaling: 17.59671759774657. Distance: 4.829350485716645
Total norm for 5 adversaries is: 17.59671759774657. distance: 4.829350485716645
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0767, Accuracy: 8791/8991 (97.7756%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 2, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3710/3821 (97.0950%), train_poison_data_count: 3821
Global model norm: 17.161530451606183.
Norm before scaling: 17.403399852213234. Distance: 3.7876409321867825
Total norm for 5 adversaries is: 17.403399852213234. distance: 3.7876409321867825
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0861, Accuracy: 8724/8991 (97.0304%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 3, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4158/4319 (96.2723%), train_poison_data_count: 4319
Global model norm: 17.161530451606183.
Norm before scaling: 17.750552746400164. Distance: 5.1294302051725325
Total norm for 5 adversaries is: 17.750552746400164. distance: 5.1294302051725325
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0748, Accuracy: 8787/8991 (97.7311%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4256/4396 (96.8153%), train_poison_data_count: 4396
Global model norm: 17.161530451606183.
Norm before scaling: 17.52407227589693. Distance: 4.627953694513329
Total norm for 5 adversaries is: 17.52407227589693. distance: 4.627953694513329
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0538, Accuracy: 8834/8991 (98.2538%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  48, local model 5, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3226/3341 (96.5579%), train_poison_data_count: 3341
Global model norm: 17.161530451606183.
Norm before scaling: 17.569182621240966. Distance: 4.630880174787219
Total norm for 5 adversaries is: 17.569182621240966. distance: 4.630880174787219
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.0816, Accuracy: 8768/8991 (97.5197%)
___Train Local_Simple,  epoch  48, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4895/5024 (97.4323%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0977, Accuracy: 9690/10000 (96.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 7, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3560/3641 (97.7753%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0650, Accuracy: 9802/10000 (98.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 8, internal_epoch   1,  Average loss: 0.0011, Accuracy: 4602/4701 (97.8941%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0719, Accuracy: 9769/10000 (97.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3249/3315 (98.0090%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0635, Accuracy: 9800/10000 (98.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 10, internal_epoch   1,  Average loss: 0.0007, Accuracy: 3388/3435 (98.6317%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1352, Accuracy: 9608/10000 (96.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3833/3917 (97.8555%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0831, Accuracy: 9747/10000 (97.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3989/4069 (98.0339%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0731, Accuracy: 9756/10000 (97.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3759/3851 (97.6110%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0765, Accuracy: 9777/10000 (97.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  48, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3063/3110 (98.4887%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1011, Accuracy: 9694/10000 (96.9400%), Attack Success Rate:0/10000(0.000)
time spent on training: 459.70160961151123
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 48: Average loss: 0.0435, Accuracy: 9862/10000 (98.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 48: Average loss: 0.9428, Accuracy: 7930/8991 (88.1993%)
Done in 486.66810965538025 sec.
Server Epoch:49 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  49, local model 0, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3887/3973 (97.8354%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1041, Accuracy: 9662/10000 (96.6200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3495/3656 (95.5963%), train_poison_data_count: 3656
Global model norm: 17.185325679229123.
Norm before scaling: 17.58892203128595. Distance: 4.601584261209687
Total norm for 5 adversaries is: 17.58892203128595. distance: 4.601584261209687
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0646, Accuracy: 8817/8991 (98.0647%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 2, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3697/3821 (96.7548%), train_poison_data_count: 3821
Global model norm: 17.185325679229123.
Norm before scaling: 17.6290650786386. Distance: 4.957489305139376
Total norm for 5 adversaries is: 17.6290650786386. distance: 4.957489305139376
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0664, Accuracy: 8820/8991 (98.0981%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4178/4319 (96.7354%), train_poison_data_count: 4319
Global model norm: 17.185325679229123.
Norm before scaling: 17.60368280893234. Distance: 4.829059991763691
Total norm for 5 adversaries is: 17.60368280893234. distance: 4.829059991763691
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0549, Accuracy: 8836/8991 (98.2761%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4263/4396 (96.9745%), train_poison_data_count: 4396
Global model norm: 17.185325679229123.
Norm before scaling: 17.674438398576577. Distance: 5.028488064514603
Total norm for 5 adversaries is: 17.674438398576577. distance: 5.028488064514603
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.1721, Accuracy: 8575/8991 (95.3732%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  49, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3219/3341 (96.3484%), train_poison_data_count: 3341
Global model norm: 17.185325679229123.
Norm before scaling: 17.71525848811643. Distance: 5.035397165008437
Total norm for 5 adversaries is: 17.71525848811643. distance: 5.035397165008437
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.0563, Accuracy: 8836/8991 (98.2761%)
___Train Local_Simple,  epoch  49, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4904/5024 (97.6115%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0756, Accuracy: 9761/10000 (97.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 7, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3564/3641 (97.8852%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0571, Accuracy: 9813/10000 (98.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 8, internal_epoch   1,  Average loss: 0.0011, Accuracy: 4603/4701 (97.9153%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0875, Accuracy: 9720/10000 (97.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 9, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3238/3315 (97.6772%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0789, Accuracy: 9773/10000 (97.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 10, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3374/3435 (98.2242%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0821, Accuracy: 9725/10000 (97.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3839/3917 (98.0087%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0752, Accuracy: 9759/10000 (97.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 4006/4069 (98.4517%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0713, Accuracy: 9780/10000 (97.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3753/3851 (97.4552%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0769, Accuracy: 9751/10000 (97.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  49, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3052/3110 (98.1350%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0852, Accuracy: 9734/10000 (97.3400%), Attack Success Rate:0/10000(0.000)
time spent on training: 463.2748808860779
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 49: Average loss: 0.0429, Accuracy: 9863/10000 (98.6300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 49: Average loss: 0.9638, Accuracy: 7924/8991 (88.1326%)
Done in 491.587361574173 sec.
Server Epoch:50 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  50, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3890/3973 (97.9109%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0721, Accuracy: 9787/10000 (97.8700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 1, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3525/3656 (96.4168%), train_poison_data_count: 3656
Global model norm: 17.207116823708894.
Norm before scaling: 17.55567837657431. Distance: 4.559548455351607
Total norm for 5 adversaries is: 17.55567837657431. distance: 4.559548455351607
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0582, Accuracy: 8831/8991 (98.2204%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 2, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3690/3821 (96.5716%), train_poison_data_count: 3821
Global model norm: 17.207116823708894.
Norm before scaling: 17.619461812731753. Distance: 4.636907970549313
Total norm for 5 adversaries is: 17.619461812731753. distance: 4.636907970549313
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.1035, Accuracy: 8684/8991 (96.5855%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 3, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4204/4319 (97.3373%), train_poison_data_count: 4319
Global model norm: 17.207116823708894.
Norm before scaling: 17.477460896946585. Distance: 4.3827968331939235
Total norm for 5 adversaries is: 17.477460896946585. distance: 4.3827968331939235
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0729, Accuracy: 8804/8991 (97.9201%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 4265/4396 (97.0200%), train_poison_data_count: 4396
Global model norm: 17.207116823708894.
Norm before scaling: 17.54707935516576. Distance: 4.7196567497875765
Total norm for 5 adversaries is: 17.54707935516576. distance: 4.7196567497875765
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0764, Accuracy: 8775/8991 (97.5976%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  50, local model 5, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3205/3341 (95.9294%), train_poison_data_count: 3341
Global model norm: 17.207116823708894.
Norm before scaling: 17.729487211898572. Distance: 5.035738630921978
Total norm for 5 adversaries is: 17.729487211898572. distance: 5.035738630921978
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0656, Accuracy: 8803/8991 (97.9090%)
___Train Local_Simple,  epoch  50, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4906/5024 (97.6513%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0922, Accuracy: 9695/10000 (96.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 7, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3565/3641 (97.9127%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0712, Accuracy: 9763/10000 (97.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4590/4701 (97.6388%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0692, Accuracy: 9790/10000 (97.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3251/3315 (98.0694%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1058, Accuracy: 9652/10000 (96.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 10, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3361/3435 (97.8457%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0806, Accuracy: 9740/10000 (97.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 11, internal_epoch   1,  Average loss: 0.0014, Accuracy: 3810/3917 (97.2683%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1267, Accuracy: 9626/10000 (96.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3997/4069 (98.2305%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0964, Accuracy: 9725/10000 (97.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3776/3851 (98.0525%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1578, Accuracy: 9543/10000 (95.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  50, local model 14, internal_epoch   1,  Average loss: 0.0008, Accuracy: 3063/3110 (98.4887%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1470, Accuracy: 9482/10000 (94.8200%), Attack Success Rate:0/10000(0.000)
time spent on training: 473.3866357803345
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 50: Average loss: 0.0416, Accuracy: 9868/10000 (98.6800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 50: Average loss: 1.0380, Accuracy: 7922/8991 (88.1103%)
Done in 500.8489799499512 sec.
Server Epoch:51 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  51, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 3880/3973 (97.6592%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1197, Accuracy: 9614/10000 (96.1400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 1, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3526/3656 (96.4442%), train_poison_data_count: 3656
Global model norm: 17.232435046358166.
Norm before scaling: 17.604685662498795. Distance: 4.71200969381582
Total norm for 5 adversaries is: 17.604685662498795. distance: 4.71200969381582
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0887, Accuracy: 8742/8991 (97.2306%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 2, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3710/3821 (97.0950%), train_poison_data_count: 3821
Global model norm: 17.232435046358166.
Norm before scaling: 17.649524265178066. Distance: 5.08380973126129
Total norm for 5 adversaries is: 17.649524265178066. distance: 5.08380973126129
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0728, Accuracy: 8783/8991 (97.6866%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 3, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4171/4319 (96.5733%), train_poison_data_count: 4319
Global model norm: 17.232435046358166.
Norm before scaling: 17.78075913755688. Distance: 5.239136673663625
Total norm for 5 adversaries is: 17.78075913755688. distance: 5.239136673663625
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0663, Accuracy: 8800/8991 (97.8757%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 4, internal_epoch   1,  Average loss: 0.0020, Accuracy: 4258/4396 (96.8608%), train_poison_data_count: 4396
Global model norm: 17.232435046358166.
Norm before scaling: 18.008779292106304. Distance: 6.3621873939926745
Total norm for 5 adversaries is: 18.008779292106304. distance: 6.3621873939926745
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.0771, Accuracy: 8769/8991 (97.5309%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  51, local model 5, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3222/3341 (96.4382%), train_poison_data_count: 3341
Global model norm: 17.232435046358166.
Norm before scaling: 17.66485116135243. Distance: 4.670786855275256
Total norm for 5 adversaries is: 17.66485116135243. distance: 4.670786855275256
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.1114, Accuracy: 8663/8991 (96.3519%)
___Train Local_Simple,  epoch  51, local model 6, internal_epoch   1,  Average loss: 0.0015, Accuracy: 4869/5024 (96.9148%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0757, Accuracy: 9746/10000 (97.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 7, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3566/3641 (97.9401%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0647, Accuracy: 9799/10000 (97.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 8, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4579/4701 (97.4048%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1047, Accuracy: 9652/10000 (96.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 9, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3240/3315 (97.7376%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1237, Accuracy: 9588/10000 (95.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 3382/3435 (98.4571%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0728, Accuracy: 9766/10000 (97.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 11, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3850/3917 (98.2895%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0883, Accuracy: 9714/10000 (97.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 4013/4069 (98.6237%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0795, Accuracy: 9757/10000 (97.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3761/3851 (97.6629%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1808, Accuracy: 9467/10000 (94.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  51, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3052/3110 (98.1350%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0820, Accuracy: 9752/10000 (97.5200%), Attack Success Rate:0/10000(0.000)
time spent on training: 482.6459593772888
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 51: Average loss: 0.0410, Accuracy: 9867/10000 (98.6700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 51: Average loss: 1.0761, Accuracy: 7921/8991 (88.0992%)
Done in 510.77127838134766 sec.
Server Epoch:52 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  52, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3901/3973 (98.1878%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1033, Accuracy: 9653/10000 (96.5300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3495/3656 (95.5963%), train_poison_data_count: 3656
Global model norm: 17.257578194142802.
Norm before scaling: 17.860146493342988. Distance: 5.403250860157067
Total norm for 5 adversaries is: 17.860146493342988. distance: 5.403250860157067
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.1127, Accuracy: 8652/8991 (96.2296%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 2, internal_epoch   1,  Average loss: 0.0018, Accuracy: 3692/3821 (96.6239%), train_poison_data_count: 3821
Global model norm: 17.257578194142802.
Norm before scaling: 17.533105544627926. Distance: 4.0683490608366615
Total norm for 5 adversaries is: 17.533105544627926. distance: 4.0683490608366615
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0822, Accuracy: 8777/8991 (97.6198%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 3, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4148/4319 (96.0408%), train_poison_data_count: 4319
Global model norm: 17.257578194142802.
Norm before scaling: 17.905482197489388. Distance: 5.478217425875057
Total norm for 5 adversaries is: 17.905482197489388. distance: 5.478217425875057
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0902, Accuracy: 8731/8991 (97.1082%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4250/4396 (96.6788%), train_poison_data_count: 4396
Global model norm: 17.257578194142802.
Norm before scaling: 17.877192009390765. Distance: 5.680989657942738
Total norm for 5 adversaries is: 17.877192009390765. distance: 5.680989657942738
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.0917, Accuracy: 8738/8991 (97.1861%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  52, local model 5, internal_epoch   1,  Average loss: 0.0017, Accuracy: 3226/3341 (96.5579%), train_poison_data_count: 3341
Global model norm: 17.257578194142802.
Norm before scaling: 17.34965851637333. Distance: 3.5880054503264436
Total norm for 5 adversaries is: 17.34965851637333. distance: 3.5880054503264436
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.1282, Accuracy: 8658/8991 (96.2963%)
___Train Local_Simple,  epoch  52, local model 6, internal_epoch   1,  Average loss: 0.0014, Accuracy: 4874/5024 (97.0143%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1076, Accuracy: 9660/10000 (96.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 7, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3576/3641 (98.2148%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0736, Accuracy: 9780/10000 (97.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 8, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4596/4701 (97.7664%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0820, Accuracy: 9767/10000 (97.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3255/3315 (98.1900%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0636, Accuracy: 9792/10000 (97.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 10, internal_epoch   1,  Average loss: 0.0007, Accuracy: 3383/3435 (98.4862%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0721, Accuracy: 9782/10000 (97.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3842/3917 (98.0853%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0698, Accuracy: 9792/10000 (97.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 4008/4069 (98.5009%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1146, Accuracy: 9597/10000 (95.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 13, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3779/3851 (98.1304%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0685, Accuracy: 9759/10000 (97.5900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  52, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3057/3110 (98.2958%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0780, Accuracy: 9744/10000 (97.4400%), Attack Success Rate:0/10000(0.000)
time spent on training: 417.55469703674316
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 52: Average loss: 0.0406, Accuracy: 9874/10000 (98.7400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 52: Average loss: 1.0952, Accuracy: 7922/8991 (88.1103%)
Done in 435.6110405921936 sec.
Server Epoch:53 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  53, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3893/3973 (97.9864%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0734, Accuracy: 9758/10000 (97.5800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 1, internal_epoch   1,  Average loss: 0.0024, Accuracy: 3506/3656 (95.8972%), train_poison_data_count: 3656
Global model norm: 17.28041910722898.
Norm before scaling: 17.918494600006685. Distance: 5.402744281123429
Total norm for 5 adversaries is: 17.918494600006685. distance: 5.402744281123429
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0562, Accuracy: 8839/8991 (98.3094%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 2, internal_epoch   1,  Average loss: 0.0019, Accuracy: 3686/3821 (96.4669%), train_poison_data_count: 3821
Global model norm: 17.28041910722898.
Norm before scaling: 17.80652569081724. Distance: 4.919335476107444
Total norm for 5 adversaries is: 17.80652569081724. distance: 4.919335476107444
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0831, Accuracy: 8767/8991 (97.5086%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 3, internal_epoch   1,  Average loss: 0.0019, Accuracy: 4182/4319 (96.8280%), train_poison_data_count: 4319
Global model norm: 17.28041910722898.
Norm before scaling: 17.688392859255455. Distance: 4.811578439437252
Total norm for 5 adversaries is: 17.688392859255455. distance: 4.811578439437252
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0655, Accuracy: 8817/8991 (98.0647%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 4, internal_epoch   1,  Average loss: 0.0016, Accuracy: 4293/4396 (97.6570%), train_poison_data_count: 4396
Global model norm: 17.28041910722898.
Norm before scaling: 17.61138433384204. Distance: 4.681181451068953
Total norm for 5 adversaries is: 17.61138433384204. distance: 4.681181451068953
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0779, Accuracy: 8784/8991 (97.6977%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  53, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 3216/3341 (96.2586%), train_poison_data_count: 3341
Global model norm: 17.28041910722898.
Norm before scaling: 17.62241036078289. Distance: 4.419790686574961
Total norm for 5 adversaries is: 17.62241036078289. distance: 4.419790686574961
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.0720, Accuracy: 8792/8991 (97.7867%)
___Train Local_Simple,  epoch  53, local model 6, internal_epoch   1,  Average loss: 0.0013, Accuracy: 4888/5024 (97.2930%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0886, Accuracy: 9715/10000 (97.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 7, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3558/3641 (97.7204%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0686, Accuracy: 9790/10000 (97.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 8, internal_epoch   1,  Average loss: 0.0010, Accuracy: 4614/4701 (98.1493%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0588, Accuracy: 9828/10000 (98.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3245/3315 (97.8884%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0673, Accuracy: 9790/10000 (97.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 10, internal_epoch   1,  Average loss: 0.0007, Accuracy: 3390/3435 (98.6900%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0691, Accuracy: 9785/10000 (97.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 11, internal_epoch   1,  Average loss: 0.0011, Accuracy: 3840/3917 (98.0342%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0743, Accuracy: 9771/10000 (97.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 4007/4069 (98.4763%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0824, Accuracy: 9753/10000 (97.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 13, internal_epoch   1,  Average loss: 0.0012, Accuracy: 3771/3851 (97.9226%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1340, Accuracy: 9564/10000 (95.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  53, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3059/3110 (98.3601%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0828, Accuracy: 9745/10000 (97.4500%), Attack Success Rate:0/10000(0.000)
time spent on training: 354.3203947544098
[foolsgold agg] training data poison_ratio: 0.3335040721200635  data num: [3973, 3656, 3821, 4319, 4396, 3341, 5024, 3641, 4701, 3315, 3435, 3917, 4069, 3851, 3110]
[foolsgold agg] considering poison per batch poison_fraction: 0.3335040721200635
[foolsgold agg] wv: [1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 53: Average loss: 0.0401, Accuracy: 9874/10000 (98.7400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 53: Average loss: 1.1133, Accuracy: 7921/8991 (88.0992%)
Done in 372.19600224494934 sec.
Server Epoch:54 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  54, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 3903/3973 (98.2381%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0780, Accuracy: 9734/10000 (97.3400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 1, internal_epoch   1,  Average loss: 0.0023, Accuracy: 3518/3656 (96.2254%), train_poison_data_count: 3656
Global model norm: 17.30253584252988.
Norm before scaling: 17.68723860368905. Distance: 5.133825565039289
Total norm for 5 adversaries is: 17.68723860368905. distance: 5.133825565039289
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.1077, Accuracy: 8694/8991 (96.6967%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 3723/3821 (97.4352%), train_poison_data_count: 3821
Global model norm: 17.30253584252988.
Norm before scaling: 17.35893198129568. Distance: 3.6029348013868407
Total norm for 5 adversaries is: 17.35893198129568. distance: 3.6029348013868407
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.1001, Accuracy: 8719/8991 (96.9748%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 3, internal_epoch   1,  Average loss: 0.0021, Accuracy: 4171/4319 (96.5733%), train_poison_data_count: 4319
Global model norm: 17.30253584252988.
Norm before scaling: 17.743852437292368. Distance: 5.277637939385221
Total norm for 5 adversaries is: 17.743852437292368. distance: 5.277637939385221
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0889, Accuracy: 8739/8991 (97.1972%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 4, internal_epoch   1,  Average loss: 0.0018, Accuracy: 4248/4396 (96.6333%), train_poison_data_count: 4396
Global model norm: 17.30253584252988.
Norm before scaling: 18.0951110644172. Distance: 6.2701463629326595
Total norm for 5 adversaries is: 18.0951110644172. distance: 6.2701463629326595
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0896, Accuracy: 8738/8991 (97.1861%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  54, local model 5, internal_epoch   1,  Average loss: 0.0021, Accuracy: 3216/3341 (96.2586%), train_poison_data_count: 3341
Global model norm: 17.30253584252988.
Norm before scaling: 17.579676146838835. Distance: 4.4922675349527905
Total norm for 5 adversaries is: 17.579676146838835. distance: 4.4922675349527905
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.0976, Accuracy: 8720/8991 (96.9859%)
___Train Local_Simple,  epoch  54, local model 6, internal_epoch   1,  Average loss: 0.0012, Accuracy: 4898/5024 (97.4920%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0712, Accuracy: 9783/10000 (97.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 7, internal_epoch   1,  Average loss: 0.0008, Accuracy: 3579/3641 (98.2972%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1084, Accuracy: 9666/10000 (96.6600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 8, internal_epoch   1,  Average loss: 0.0011, Accuracy: 4598/4701 (97.8090%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0784, Accuracy: 9765/10000 (97.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 9, internal_epoch   1,  Average loss: 0.0010, Accuracy: 3246/3315 (97.9186%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0642, Accuracy: 9808/10000 (98.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 3378/3435 (98.3406%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0904, Accuracy: 9723/10000 (97.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  54, local model 11, internal_epoch   1,  Average loss: 0.0008, Accuracy: 3854/3917 (98.3916%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0555, Accuracy: 9839/10000 (98.3900%), Attack Success Rate:0/10000(0.000)
