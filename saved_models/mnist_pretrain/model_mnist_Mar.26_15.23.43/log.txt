current path: saved_models/mnist_pretrain/model_mnist_Mar.26_15.23.43
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
create model done
Poisoned following participants: [1, 2, 3, 4, 5]
We use following environment for graphs:  mnist_DBA
Server Epoch:1 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   1, local model 0, internal_epoch   1,  Average loss: 0.0238, Accuracy: 1214/1784 (68.0493%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.9611, Accuracy: 4712/10000 (47.1200%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 1, internal_epoch   1,  Average loss: 0.0132, Accuracy: 4900/6000 (81.6667%), train_poison_data_count: 6000
Global model norm: 1.828686293811075.
Norm before scaling: 3.6336843449369867. Distance: 3.1913322897737304
Total norm for 5 adversaries is: 3.6336843449369867. distance: 3.1913322897737304
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 1.8660, Accuracy: 6017/8991 (66.9225%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 2, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2627/3457 (75.9907%), train_poison_data_count: 3457
Global model norm: 1.828686293811075.
Norm before scaling: 3.2435554284337083. Distance: 2.717877215022548
Total norm for 5 adversaries is: 3.2435554284337083. distance: 2.717877215022548
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 1.9054, Accuracy: 5805/8991 (64.5646%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 3, internal_epoch   1,  Average loss: 0.0200, Accuracy: 2456/3455 (71.0854%), train_poison_data_count: 3455
Global model norm: 1.828686293811075.
Norm before scaling: 3.244605649429912. Distance: 2.715568434781328
Total norm for 5 adversaries is: 3.244605649429912. distance: 2.715568434781328
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.9489, Accuracy: 6257/8991 (69.5918%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 4, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3462/4644 (74.5478%), train_poison_data_count: 4644
Global model norm: 1.828686293811075.
Norm before scaling: 3.4352844033922345. Distance: 2.946915167719849
Total norm for 5 adversaries is: 3.4352844033922345. distance: 2.946915167719849
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 0.9406, Accuracy: 6003/8991 (66.7668%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   1, local model 5, internal_epoch   1,  Average loss: 0.0210, Accuracy: 2009/2798 (71.8013%), train_poison_data_count: 2798
Global model norm: 1.828686293811075.
Norm before scaling: 2.973467802533782. Distance: 2.3680875470886353
Total norm for 5 adversaries is: 2.973467802533782. distance: 2.3680875470886353
___Test Local_Simple poisoned: True, epoch: 1: Average loss: 1.6310, Accuracy: 5035/8991 (56.0004%)
___Train Local_Simple,  epoch   1, local model 6, internal_epoch   1,  Average loss: 0.0182, Accuracy: 3491/4654 (75.0107%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.0007, Accuracy: 6788/10000 (67.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 7, internal_epoch   1,  Average loss: 0.0209, Accuracy: 2754/3839 (71.7374%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.0355, Accuracy: 7376/10000 (73.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 8, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2149/2848 (75.4565%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.0560, Accuracy: 5184/10000 (51.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 9, internal_epoch   1,  Average loss: 0.0190, Accuracy: 2483/3226 (76.9684%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.4039, Accuracy: 6395/10000 (63.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 10, internal_epoch   1,  Average loss: 0.0170, Accuracy: 4189/5406 (77.4880%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.2402, Accuracy: 6719/10000 (67.1900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 11, internal_epoch   1,  Average loss: 0.0179, Accuracy: 3301/4481 (73.6666%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.2367, Accuracy: 5907/10000 (59.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 12, internal_epoch   1,  Average loss: 0.0196, Accuracy: 3072/4148 (74.0598%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.4387, Accuracy: 5533/10000 (55.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 13, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3321/4495 (73.8821%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 1.3287, Accuracy: 6309/10000 (63.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   1, local model 14, internal_epoch   1,  Average loss: 0.0152, Accuracy: 2744/3330 (82.4024%)
___Test Local_Simple poisoned: False, epoch: 1: Average loss: 2.5433, Accuracy: 4599/10000 (45.9900%), Attack Success Rate:0/10000(0.000)
time spent on training: 37.20371723175049
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1. 1. 1. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 1: Average loss: 2.1844, Accuracy: 2817/10000 (28.1700%), Attack Success Rate:6/10000(0.060)
___Test Target_Simple poisoned: True, epoch: 1: Average loss: 2.1825, Accuracy: 2454/8991 (27.2940%)
Done in 44.51649022102356 sec.
Server Epoch:2 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   2, local model 0, internal_epoch   1,  Average loss: 0.0225, Accuracy: 1259/1784 (70.5717%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.9711, Accuracy: 4786/10000 (47.8600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 1, internal_epoch   1,  Average loss: 0.0129, Accuracy: 5028/6000 (83.8000%), train_poison_data_count: 6000
Global model norm: 1.831752991844786.
Norm before scaling: 3.6477727182258777. Distance: 3.1146422585789497
Total norm for 5 adversaries is: 3.6477727182258777. distance: 3.1146422585789497
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 1.8976, Accuracy: 5896/8991 (65.5767%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 2, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2669/3457 (77.2057%), train_poison_data_count: 3457
Global model norm: 1.831752991844786.
Norm before scaling: 3.260720544533594. Distance: 2.6532592092476603
Total norm for 5 adversaries is: 3.260720544533594. distance: 2.6532592092476603
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 1.8571, Accuracy: 5734/8991 (63.7749%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 3, internal_epoch   1,  Average loss: 0.0196, Accuracy: 2481/3455 (71.8090%), train_poison_data_count: 3455
Global model norm: 1.831752991844786.
Norm before scaling: 3.2621475029298694. Distance: 2.6442790735274273
Total norm for 5 adversaries is: 3.2621475029298694. distance: 2.6442790735274273
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.9272, Accuracy: 6370/8991 (70.8486%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 4, internal_epoch   1,  Average loss: 0.0174, Accuracy: 3485/4644 (75.0431%), train_poison_data_count: 4644
Global model norm: 1.831752991844786.
Norm before scaling: 3.460214509212986. Distance: 2.894710643321216
Total norm for 5 adversaries is: 3.460214509212986. distance: 2.894710643321216
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 0.9810, Accuracy: 6027/8991 (67.0337%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   2, local model 5, internal_epoch   1,  Average loss: 0.0207, Accuracy: 2053/2798 (73.3738%), train_poison_data_count: 2798
Global model norm: 1.831752991844786.
Norm before scaling: 2.953061219187645. Distance: 2.2602317019492895
Total norm for 5 adversaries is: 2.953061219187645. distance: 2.2602317019492895
___Test Local_Simple poisoned: True, epoch: 2: Average loss: 1.5445, Accuracy: 5153/8991 (57.3129%)
___Train Local_Simple,  epoch   2, local model 6, internal_epoch   1,  Average loss: 0.0176, Accuracy: 3590/4654 (77.1379%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.0073, Accuracy: 6718/10000 (67.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 7, internal_epoch   1,  Average loss: 0.0203, Accuracy: 2753/3839 (71.7114%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.0546, Accuracy: 7254/10000 (72.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 8, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2187/2848 (76.7907%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.0119, Accuracy: 5252/10000 (52.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 9, internal_epoch   1,  Average loss: 0.0186, Accuracy: 2529/3226 (78.3943%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.4029, Accuracy: 6353/10000 (63.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 10, internal_epoch   1,  Average loss: 0.0167, Accuracy: 4258/5406 (78.7643%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.1621, Accuracy: 6790/10000 (67.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 11, internal_epoch   1,  Average loss: 0.0175, Accuracy: 3340/4481 (74.5369%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.2140, Accuracy: 6156/10000 (61.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 12, internal_epoch   1,  Average loss: 0.0191, Accuracy: 3148/4148 (75.8920%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.3837, Accuracy: 5511/10000 (55.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 13, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3411/4495 (75.8843%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 1.3290, Accuracy: 6333/10000 (63.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   2, local model 14, internal_epoch   1,  Average loss: 0.0147, Accuracy: 2741/3330 (82.3123%)
___Test Local_Simple poisoned: False, epoch: 2: Average loss: 2.4232, Accuracy: 4612/10000 (46.1200%), Attack Success Rate:0/10000(0.000)
time spent on training: 45.214869260787964
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.13553809
 0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 2: Average loss: 2.0873, Accuracy: 4074/10000 (40.7400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 2: Average loss: 2.0795, Accuracy: 3844/8991 (42.7539%)
Done in 52.67258381843567 sec.
Server Epoch:3 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   3, local model 0, internal_epoch   1,  Average loss: 0.0217, Accuracy: 1331/1784 (74.6076%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.8516, Accuracy: 4770/10000 (47.7000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 1, internal_epoch   1,  Average loss: 0.0125, Accuracy: 5068/6000 (84.4667%), train_poison_data_count: 6000
Global model norm: 1.840886430033602.
Norm before scaling: 3.651339763202709. Distance: 3.030897454279332
Total norm for 5 adversaries is: 3.651339763202709. distance: 3.030897454279332
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 1.8228, Accuracy: 6085/8991 (67.6788%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 2, internal_epoch   1,  Average loss: 0.0162, Accuracy: 2714/3457 (78.5074%), train_poison_data_count: 3457
Global model norm: 1.840886430033602.
Norm before scaling: 3.2603388442886785. Distance: 2.5690440842590565
Total norm for 5 adversaries is: 3.2603388442886785. distance: 2.5690440842590565
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 1.8226, Accuracy: 5812/8991 (64.6424%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 3, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2524/3455 (73.0535%), train_poison_data_count: 3455
Global model norm: 1.840886430033602.
Norm before scaling: 3.275029853510016. Distance: 2.5674902544143086
Total norm for 5 adversaries is: 3.275029853510016. distance: 2.5674902544143086
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.9614, Accuracy: 6083/8991 (67.6565%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 4, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3524/4644 (75.8829%), train_poison_data_count: 4644
Global model norm: 1.840886430033602.
Norm before scaling: 3.4675884879660965. Distance: 2.8162064607101702
Total norm for 5 adversaries is: 3.4675884879660965. distance: 2.8162064607101702
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 0.9221, Accuracy: 6221/8991 (69.1914%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   3, local model 5, internal_epoch   1,  Average loss: 0.0201, Accuracy: 2062/2798 (73.6955%), train_poison_data_count: 2798
Global model norm: 1.840886430033602.
Norm before scaling: 2.9907666211691954. Distance: 2.225198856854184
Total norm for 5 adversaries is: 2.9907666211691954. distance: 2.225198856854184
___Test Local_Simple poisoned: True, epoch: 3: Average loss: 1.5251, Accuracy: 5326/8991 (59.2370%)
___Train Local_Simple,  epoch   3, local model 6, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3627/4654 (77.9330%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 0.9962, Accuracy: 6768/10000 (67.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 7, internal_epoch   1,  Average loss: 0.0197, Accuracy: 2804/3839 (73.0399%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.0114, Accuracy: 7533/10000 (75.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 8, internal_epoch   1,  Average loss: 0.0164, Accuracy: 2216/2848 (77.8090%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.8984, Accuracy: 5364/10000 (53.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 9, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2619/3226 (81.1841%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.3832, Accuracy: 6351/10000 (63.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 10, internal_epoch   1,  Average loss: 0.0166, Accuracy: 4294/5406 (79.4303%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.1603, Accuracy: 6828/10000 (68.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 11, internal_epoch   1,  Average loss: 0.0171, Accuracy: 3372/4481 (75.2511%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.1818, Accuracy: 6076/10000 (60.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 12, internal_epoch   1,  Average loss: 0.0186, Accuracy: 3192/4148 (76.9527%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.4045, Accuracy: 5469/10000 (54.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 13, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3432/4495 (76.3515%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 1.3195, Accuracy: 6283/10000 (62.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   3, local model 14, internal_epoch   1,  Average loss: 0.0141, Accuracy: 2827/3330 (84.8949%)
___Test Local_Simple poisoned: False, epoch: 3: Average loss: 2.4263, Accuracy: 4526/10000 (45.2600%), Attack Success Rate:0/10000(0.000)
time spent on training: 51.31787705421448
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.20296084
 0.01564247 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 3: Average loss: 1.9960, Accuracy: 4700/10000 (47.0000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 3: Average loss: 1.9820, Accuracy: 4580/8991 (50.9398%)
Done in 58.76547980308533 sec.
Server Epoch:4 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   4, local model 0, internal_epoch   1,  Average loss: 0.0208, Accuracy: 1376/1784 (77.1300%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.7866, Accuracy: 4764/10000 (47.6400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 1, internal_epoch   1,  Average loss: 0.0122, Accuracy: 5107/6000 (85.1167%), train_poison_data_count: 6000
Global model norm: 1.8555705795453965.
Norm before scaling: 3.659572558848446. Distance: 2.950957779657611
Total norm for 5 adversaries is: 3.659572558848446. distance: 2.950957779657611
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 1.8347, Accuracy: 5998/8991 (66.7112%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 2, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2726/3457 (78.8545%), train_poison_data_count: 3457
Global model norm: 1.8555705795453965.
Norm before scaling: 3.2892516890455736. Distance: 2.5156924789571637
Total norm for 5 adversaries is: 3.2892516890455736. distance: 2.5156924789571637
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 1.7822, Accuracy: 5747/8991 (63.9195%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 3, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2559/3455 (74.0666%), train_poison_data_count: 3455
Global model norm: 1.8555705795453965.
Norm before scaling: 3.2880506975298247. Distance: 2.4946741595431816
Total norm for 5 adversaries is: 3.2880506975298247. distance: 2.4946741595431816
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.9002, Accuracy: 6612/8991 (73.5402%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 4, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3547/4644 (76.3781%), train_poison_data_count: 4644
Global model norm: 1.8555705795453965.
Norm before scaling: 3.4855329702019384. Distance: 2.7541795527339006
Total norm for 5 adversaries is: 3.4855329702019384. distance: 2.7541795527339006
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 0.8909, Accuracy: 6293/8991 (69.9922%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   4, local model 5, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2137/2798 (76.3760%), train_poison_data_count: 2798
Global model norm: 1.8555705795453965.
Norm before scaling: 3.0054208734326786. Distance: 2.1600369356670837
Total norm for 5 adversaries is: 3.0054208734326786. distance: 2.1600369356670837
___Test Local_Simple poisoned: True, epoch: 4: Average loss: 1.4955, Accuracy: 5234/8991 (58.2138%)
___Train Local_Simple,  epoch   4, local model 6, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3648/4654 (78.3842%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 0.9799, Accuracy: 6760/10000 (67.6000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 7, internal_epoch   1,  Average loss: 0.0193, Accuracy: 2887/3839 (75.2019%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.0060, Accuracy: 7386/10000 (73.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 8, internal_epoch   1,  Average loss: 0.0160, Accuracy: 2264/2848 (79.4944%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.8642, Accuracy: 5383/10000 (53.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 9, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2630/3226 (81.5251%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.3621, Accuracy: 6465/10000 (64.6500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 10, internal_epoch   1,  Average loss: 0.0160, Accuracy: 4317/5406 (79.8557%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.1428, Accuracy: 6697/10000 (66.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 11, internal_epoch   1,  Average loss: 0.0168, Accuracy: 3400/4481 (75.8759%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.1900, Accuracy: 5823/10000 (58.2300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 12, internal_epoch   1,  Average loss: 0.0183, Accuracy: 3226/4148 (77.7724%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.3579, Accuracy: 5603/10000 (56.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 13, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3479/4495 (77.3971%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 1.2762, Accuracy: 6634/10000 (66.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   4, local model 14, internal_epoch   1,  Average loss: 0.0136, Accuracy: 2862/3330 (85.9459%)
___Test Local_Simple poisoned: False, epoch: 4: Average loss: 2.3267, Accuracy: 4593/10000 (45.9300%), Attack Success Rate:0/10000(0.000)
time spent on training: 58.673542499542236
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1. 1. 1. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 4: Average loss: 1.9144, Accuracy: 5213/10000 (52.1300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 4: Average loss: 1.8946, Accuracy: 5146/8991 (57.2350%)
Done in 66.63271927833557 sec.
Server Epoch:5 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   5, local model 0, internal_epoch   1,  Average loss: 0.0201, Accuracy: 1377/1784 (77.1861%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.7493, Accuracy: 4838/10000 (48.3800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 1, internal_epoch   1,  Average loss: 0.0121, Accuracy: 5121/6000 (85.3500%), train_poison_data_count: 6000
Global model norm: 1.8743054693083123.
Norm before scaling: 3.6622032540050284. Distance: 2.8722373293838643
Total norm for 5 adversaries is: 3.6622032540050284. distance: 2.8722373293838643
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 1.8057, Accuracy: 6035/8991 (67.1227%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 2, internal_epoch   1,  Average loss: 0.0154, Accuracy: 2773/3457 (80.2141%), train_poison_data_count: 3457
Global model norm: 1.8743054693083123.
Norm before scaling: 3.2815481867858143. Distance: 2.428771211116285
Total norm for 5 adversaries is: 3.2815481867858143. distance: 2.428771211116285
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 1.7458, Accuracy: 5861/8991 (65.1874%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 3, internal_epoch   1,  Average loss: 0.0181, Accuracy: 2593/3455 (75.0507%), train_poison_data_count: 3455
Global model norm: 1.8743054693083123.
Norm before scaling: 3.292863475343084. Distance: 2.4133208780687374
Total norm for 5 adversaries is: 3.292863475343084. distance: 2.4133208780687374
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.8822, Accuracy: 6670/8991 (74.1853%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 4, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3593/4644 (77.3686%), train_poison_data_count: 4644
Global model norm: 1.8743054693083123.
Norm before scaling: 3.498212494116345. Distance: 2.6877713620892205
Total norm for 5 adversaries is: 3.498212494116345. distance: 2.6877713620892205
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 0.8470, Accuracy: 6528/8991 (72.6059%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   5, local model 5, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2147/2798 (76.7334%), train_poison_data_count: 2798
Global model norm: 1.8743054693083123.
Norm before scaling: 3.0345521224997074. Distance: 2.1175307104772894
Total norm for 5 adversaries is: 3.0345521224997074. distance: 2.1175307104772894
___Test Local_Simple poisoned: True, epoch: 5: Average loss: 1.5654, Accuracy: 4976/8991 (55.3442%)
___Train Local_Simple,  epoch   5, local model 6, internal_epoch   1,  Average loss: 0.0163, Accuracy: 3692/4654 (79.3296%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 0.9517, Accuracy: 6813/10000 (68.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 7, internal_epoch   1,  Average loss: 0.0188, Accuracy: 2929/3839 (76.2959%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.0296, Accuracy: 7252/10000 (72.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 8, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2305/2848 (80.9340%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.9032, Accuracy: 5190/10000 (51.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 9, internal_epoch   1,  Average loss: 0.0169, Accuracy: 2629/3226 (81.4941%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.3291, Accuracy: 6442/10000 (64.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 10, internal_epoch   1,  Average loss: 0.0158, Accuracy: 4370/5406 (80.8361%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.1192, Accuracy: 6810/10000 (68.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 11, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3431/4481 (76.5677%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.1496, Accuracy: 6029/10000 (60.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 12, internal_epoch   1,  Average loss: 0.0179, Accuracy: 3221/4148 (77.6519%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.3253, Accuracy: 5694/10000 (56.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 13, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3553/4495 (79.0434%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 1.2684, Accuracy: 6708/10000 (67.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   5, local model 14, internal_epoch   1,  Average loss: 0.0136, Accuracy: 2847/3330 (85.4955%)
___Test Local_Simple poisoned: False, epoch: 5: Average loss: 2.3185, Accuracy: 4588/10000 (45.8800%), Attack Success Rate:0/10000(0.000)
time spent on training: 66.35411190986633
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1. 1. 1. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 1. 1.]
___Test Target_Simple poisoned: False, epoch: 5: Average loss: 1.8386, Accuracy: 5499/10000 (54.9900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 5: Average loss: 1.8138, Accuracy: 5462/8991 (60.7496%)
Done in 74.04716658592224 sec.
Server Epoch:6 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   6, local model 0, internal_epoch   1,  Average loss: 0.0196, Accuracy: 1398/1784 (78.3632%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.6365, Accuracy: 5163/10000 (51.6300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 1, internal_epoch   1,  Average loss: 0.0119, Accuracy: 5113/6000 (85.2167%), train_poison_data_count: 6000
Global model norm: 1.8971386143420275.
Norm before scaling: 3.6812348240796986. Distance: 2.8122608506994347
Total norm for 5 adversaries is: 3.6812348240796986. distance: 2.8122608506994347
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 1.7924, Accuracy: 6015/8991 (66.9002%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 2, internal_epoch   1,  Average loss: 0.0155, Accuracy: 2822/3457 (81.6315%), train_poison_data_count: 3457
Global model norm: 1.8971386143420275.
Norm before scaling: 3.2933284250858605. Distance: 2.364970765044029
Total norm for 5 adversaries is: 3.2933284250858605. distance: 2.364970765044029
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 1.7422, Accuracy: 5753/8991 (63.9862%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 3, internal_epoch   1,  Average loss: 0.0178, Accuracy: 2634/3455 (76.2373%), train_poison_data_count: 3455
Global model norm: 1.8971386143420275.
Norm before scaling: 3.3221449160078107. Distance: 2.367028964433946
Total norm for 5 adversaries is: 3.3221449160078107. distance: 2.367028964433946
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.9409, Accuracy: 6404/8991 (71.2268%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 4, internal_epoch   1,  Average loss: 0.0160, Accuracy: 3567/4644 (76.8088%), train_poison_data_count: 4644
Global model norm: 1.8971386143420275.
Norm before scaling: 3.513302184032584. Distance: 2.630538365774397
Total norm for 5 adversaries is: 3.513302184032584. distance: 2.630538365774397
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 0.8552, Accuracy: 6491/8991 (72.1944%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   6, local model 5, internal_epoch   1,  Average loss: 0.0183, Accuracy: 2143/2798 (76.5904%), train_poison_data_count: 2798
Global model norm: 1.8971386143420275.
Norm before scaling: 3.0637268411670773. Distance: 2.075733845563932
Total norm for 5 adversaries is: 3.0637268411670773. distance: 2.075733845563932
___Test Local_Simple poisoned: True, epoch: 6: Average loss: 1.5089, Accuracy: 5168/8991 (57.4797%)
___Train Local_Simple,  epoch   6, local model 6, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3675/4654 (78.9643%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.9095, Accuracy: 6913/10000 (69.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 7, internal_epoch   1,  Average loss: 0.0186, Accuracy: 2939/3839 (76.5564%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 0.9864, Accuracy: 7486/10000 (74.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 8, internal_epoch   1,  Average loss: 0.0153, Accuracy: 2298/2848 (80.6882%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.7878, Accuracy: 5415/10000 (54.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 9, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2641/3226 (81.8661%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.3121, Accuracy: 6305/10000 (63.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 10, internal_epoch   1,  Average loss: 0.0154, Accuracy: 4424/5406 (81.8350%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.1167, Accuracy: 6984/10000 (69.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 11, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3462/4481 (77.2595%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.1645, Accuracy: 5925/10000 (59.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 12, internal_epoch   1,  Average loss: 0.0177, Accuracy: 3243/4148 (78.1823%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.3099, Accuracy: 5714/10000 (57.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 13, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3560/4495 (79.1991%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 1.2699, Accuracy: 6749/10000 (67.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   6, local model 14, internal_epoch   1,  Average loss: 0.0131, Accuracy: 2872/3330 (86.2462%)
___Test Local_Simple poisoned: False, epoch: 6: Average loss: 2.2565, Accuracy: 4594/10000 (45.9400%), Attack Success Rate:0/10000(0.000)
time spent on training: 73.41965460777283
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.13416017
 0.06762171 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 6: Average loss: 1.7656, Accuracy: 5779/10000 (57.7900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 6: Average loss: 1.7353, Accuracy: 5753/8991 (63.9862%)
Done in 81.10092759132385 sec.
Server Epoch:7 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   7, local model 0, internal_epoch   1,  Average loss: 0.0185, Accuracy: 1445/1784 (80.9978%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.7162, Accuracy: 5000/10000 (50.0000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 1, internal_epoch   1,  Average loss: 0.0115, Accuracy: 5192/6000 (86.5333%), train_poison_data_count: 6000
Global model norm: 1.9243455839619015.
Norm before scaling: 3.688635828984698. Distance: 2.7415427294915857
Total norm for 5 adversaries is: 3.688635828984698. distance: 2.7415427294915857
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 1.8070, Accuracy: 5996/8991 (66.6889%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 2, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2859/3457 (82.7018%), train_poison_data_count: 3457
Global model norm: 1.9243455839619015.
Norm before scaling: 3.310350836516824. Distance: 2.305540489494806
Total norm for 5 adversaries is: 3.310350836516824. distance: 2.305540489494806
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 1.7027, Accuracy: 5836/8991 (64.9094%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 3, internal_epoch   1,  Average loss: 0.0173, Accuracy: 2653/3455 (76.7873%), train_poison_data_count: 3455
Global model norm: 1.9243455839619015.
Norm before scaling: 3.312862016581095. Distance: 2.2706756070390908
Total norm for 5 adversaries is: 3.312862016581095. distance: 2.2706756070390908
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.8380, Accuracy: 6877/8991 (76.4876%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 4, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3603/4644 (77.5840%), train_poison_data_count: 4644
Global model norm: 1.9243455839619015.
Norm before scaling: 3.5276679041081525. Distance: 2.568498429279913
Total norm for 5 adversaries is: 3.5276679041081525. distance: 2.568498429279913
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 0.8649, Accuracy: 6441/8991 (71.6383%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   7, local model 5, internal_epoch   1,  Average loss: 0.0180, Accuracy: 2170/2798 (77.5554%), train_poison_data_count: 2798
Global model norm: 1.9243455839619015.
Norm before scaling: 3.0652114387005067. Distance: 2.003281761855484
Total norm for 5 adversaries is: 3.0652114387005067. distance: 2.003281761855484
___Test Local_Simple poisoned: True, epoch: 7: Average loss: 1.4445, Accuracy: 5395/8991 (60.0044%)
___Train Local_Simple,  epoch   7, local model 6, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3723/4654 (79.9957%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 0.9342, Accuracy: 6874/10000 (68.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 7, internal_epoch   1,  Average loss: 0.0182, Accuracy: 2955/3839 (76.9732%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.0025, Accuracy: 7425/10000 (74.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 8, internal_epoch   1,  Average loss: 0.0146, Accuracy: 2341/2848 (82.1980%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.8172, Accuracy: 5352/10000 (53.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 9, internal_epoch   1,  Average loss: 0.0163, Accuracy: 2686/3226 (83.2610%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.3042, Accuracy: 6424/10000 (64.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 10, internal_epoch   1,  Average loss: 0.0153, Accuracy: 4408/5406 (81.5390%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.1197, Accuracy: 6672/10000 (66.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 11, internal_epoch   1,  Average loss: 0.0158, Accuracy: 3487/4481 (77.8175%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.1240, Accuracy: 6078/10000 (60.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 12, internal_epoch   1,  Average loss: 0.0172, Accuracy: 3255/4148 (78.4716%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.2621, Accuracy: 5827/10000 (58.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 13, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3623/4495 (80.6007%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 1.2154, Accuracy: 7034/10000 (70.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   7, local model 14, internal_epoch   1,  Average loss: 0.0125, Accuracy: 2879/3330 (86.4565%)
___Test Local_Simple poisoned: False, epoch: 7: Average loss: 2.2357, Accuracy: 4549/10000 (45.4900%), Attack Success Rate:0/10000(0.000)
time spent on training: 79.85284686088562
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.11609071
 0.         1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 7: Average loss: 1.6992, Accuracy: 5983/10000 (59.8300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 7: Average loss: 1.6651, Accuracy: 5966/8991 (66.3552%)
Done in 87.49528169631958 sec.
Server Epoch:8 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   8, local model 0, internal_epoch   1,  Average loss: 0.0183, Accuracy: 1429/1784 (80.1009%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.6169, Accuracy: 4977/10000 (49.7700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 1, internal_epoch   1,  Average loss: 0.0114, Accuracy: 5184/6000 (86.4000%), train_poison_data_count: 6000
Global model norm: 1.9541927013276146.
Norm before scaling: 3.691315568082597. Distance: 2.6648069890824178
Total norm for 5 adversaries is: 3.691315568082597. distance: 2.6648069890824178
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 1.7695, Accuracy: 5935/8991 (66.0105%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 2, internal_epoch   1,  Average loss: 0.0146, Accuracy: 2850/3457 (82.4414%), train_poison_data_count: 3457
Global model norm: 1.9541927013276146.
Norm before scaling: 3.3004476705978814. Distance: 2.2162935870381735
Total norm for 5 adversaries is: 3.3004476705978814. distance: 2.2162935870381735
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 1.6261, Accuracy: 5989/8991 (66.6111%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 3, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2693/3455 (77.9450%), train_poison_data_count: 3455
Global model norm: 1.9541927013276146.
Norm before scaling: 3.3384725689494483. Distance: 2.223583597837294
Total norm for 5 adversaries is: 3.3384725689494483. distance: 2.223583597837294
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.8512, Accuracy: 6823/8991 (75.8870%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 4, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3689/4644 (79.4358%), train_poison_data_count: 4644
Global model norm: 1.9541927013276146.
Norm before scaling: 3.5441090558324793. Distance: 2.5107249048291793
Total norm for 5 adversaries is: 3.5441090558324793. distance: 2.5107249048291793
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 0.8362, Accuracy: 6573/8991 (73.1064%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   8, local model 5, internal_epoch   1,  Average loss: 0.0176, Accuracy: 2179/2798 (77.8771%), train_poison_data_count: 2798
Global model norm: 1.9541927013276146.
Norm before scaling: 3.1178063564693095. Distance: 1.9917072988964868
Total norm for 5 adversaries is: 3.1178063564693095. distance: 1.9917072988964868
___Test Local_Simple poisoned: True, epoch: 8: Average loss: 1.5022, Accuracy: 5009/8991 (55.7113%)
___Train Local_Simple,  epoch   8, local model 6, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3707/4654 (79.6519%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.9291, Accuracy: 6791/10000 (67.9100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 7, internal_epoch   1,  Average loss: 0.0179, Accuracy: 2943/3839 (76.6606%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 0.9383, Accuracy: 7593/10000 (75.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 8, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2348/2848 (82.4438%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.7012, Accuracy: 5533/10000 (55.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 9, internal_epoch   1,  Average loss: 0.0159, Accuracy: 2684/3226 (83.1990%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.2724, Accuracy: 6322/10000 (63.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 10, internal_epoch   1,  Average loss: 0.0149, Accuracy: 4416/5406 (81.6870%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.1140, Accuracy: 6963/10000 (69.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 11, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3519/4481 (78.5316%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.1075, Accuracy: 6126/10000 (61.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 12, internal_epoch   1,  Average loss: 0.0169, Accuracy: 3271/4148 (78.8573%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.1872, Accuracy: 6068/10000 (60.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 13, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3621/4495 (80.5562%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 1.2401, Accuracy: 6900/10000 (69.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   8, local model 14, internal_epoch   1,  Average loss: 0.0124, Accuracy: 2867/3330 (86.0961%)
___Test Local_Simple poisoned: False, epoch: 8: Average loss: 2.1358, Accuracy: 4690/10000 (46.9000%), Attack Success Rate:0/10000(0.000)
time spent on training: 87.10917639732361
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.25930063
 0.12269157 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 8: Average loss: 1.6346, Accuracy: 6154/10000 (61.5400%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 8: Average loss: 1.5957, Accuracy: 6137/8991 (68.2571%)
Done in 94.90327525138855 sec.
Server Epoch:9 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch   9, local model 0, internal_epoch   1,  Average loss: 0.0175, Accuracy: 1442/1784 (80.8296%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.6058, Accuracy: 5254/10000 (52.5400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 1, internal_epoch   1,  Average loss: 0.0111, Accuracy: 5197/6000 (86.6167%), train_poison_data_count: 6000
Global model norm: 1.988049686639917.
Norm before scaling: 3.720189433042975. Distance: 2.6192176346690306
Total norm for 5 adversaries is: 3.720189433042975. distance: 2.6192176346690306
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 1.7415, Accuracy: 5941/8991 (66.0772%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 2, internal_epoch   1,  Average loss: 0.0141, Accuracy: 2863/3457 (82.8175%), train_poison_data_count: 3457
Global model norm: 1.988049686639917.
Norm before scaling: 3.3248951601408026. Distance: 2.171769942343019
Total norm for 5 adversaries is: 3.3248951601408026. distance: 2.171769942343019
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 1.6408, Accuracy: 5838/8991 (64.9316%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 3, internal_epoch   1,  Average loss: 0.0166, Accuracy: 2706/3455 (78.3213%), train_poison_data_count: 3455
Global model norm: 1.988049686639917.
Norm before scaling: 3.3511629733460864. Distance: 2.154060579069679
Total norm for 5 adversaries is: 3.3511629733460864. distance: 2.154060579069679
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.8113, Accuracy: 6998/8991 (77.8334%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 4, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3659/4644 (78.7898%), train_poison_data_count: 4644
Global model norm: 1.988049686639917.
Norm before scaling: 3.557724546100056. Distance: 2.445914392465729
Total norm for 5 adversaries is: 3.557724546100056. distance: 2.445914392465729
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 0.8107, Accuracy: 6739/8991 (74.9527%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch   9, local model 5, internal_epoch   1,  Average loss: 0.0172, Accuracy: 2190/2798 (78.2702%), train_poison_data_count: 2798
Global model norm: 1.988049686639917.
Norm before scaling: 3.123631750023267. Distance: 1.9255310267442678
Total norm for 5 adversaries is: 3.123631750023267. distance: 1.9255310267442678
___Test Local_Simple poisoned: True, epoch: 9: Average loss: 1.4393, Accuracy: 5335/8991 (59.3371%)
___Train Local_Simple,  epoch   9, local model 6, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3757/4654 (80.7263%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.8909, Accuracy: 6962/10000 (69.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 7, internal_epoch   1,  Average loss: 0.0175, Accuracy: 2996/3839 (78.0412%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 0.9168, Accuracy: 7640/10000 (76.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 8, internal_epoch   1,  Average loss: 0.0141, Accuracy: 2349/2848 (82.4789%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.6474, Accuracy: 5620/10000 (56.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 9, internal_epoch   1,  Average loss: 0.0154, Accuracy: 2688/3226 (83.3230%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.2729, Accuracy: 6351/10000 (63.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 10, internal_epoch   1,  Average loss: 0.0147, Accuracy: 4435/5406 (82.0385%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.0390, Accuracy: 6968/10000 (69.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 11, internal_epoch   1,  Average loss: 0.0153, Accuracy: 3530/4481 (78.7771%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.1187, Accuracy: 5918/10000 (59.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 12, internal_epoch   1,  Average loss: 0.0167, Accuracy: 3302/4148 (79.6046%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.1922, Accuracy: 5849/10000 (58.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 13, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3668/4495 (81.6018%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 1.1996, Accuracy: 7011/10000 (70.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch   9, local model 14, internal_epoch   1,  Average loss: 0.0119, Accuracy: 2887/3330 (86.6967%)
___Test Local_Simple poisoned: False, epoch: 9: Average loss: 2.1564, Accuracy: 4771/10000 (47.7100%), Attack Success Rate:0/10000(0.000)
time spent on training: 95.61002039909363
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [0.95542012 1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.25458741 0.95542012 1.        ]
___Test Target_Simple poisoned: False, epoch: 9: Average loss: 1.5779, Accuracy: 6243/10000 (62.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 9: Average loss: 1.5349, Accuracy: 6224/8991 (69.2248%)
Done in 103.48681831359863 sec.
Server Epoch:10 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  10, local model 0, internal_epoch   1,  Average loss: 0.0167, Accuracy: 1448/1784 (81.1659%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.5327, Accuracy: 5383/10000 (53.8300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 1, internal_epoch   1,  Average loss: 0.0110, Accuracy: 5210/6000 (86.8333%), train_poison_data_count: 6000
Global model norm: 2.0230157478915087.
Norm before scaling: 3.7120720664871842. Distance: 2.5350251479848334
Total norm for 5 adversaries is: 3.7120720664871842. distance: 2.5350251479848334
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 1.7134, Accuracy: 5988/8991 (66.5999%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 2, internal_epoch   1,  Average loss: 0.0138, Accuracy: 2896/3457 (83.7721%), train_poison_data_count: 3457
Global model norm: 2.0230157478915087.
Norm before scaling: 3.3418402521293493. Distance: 2.1175001976256294
Total norm for 5 adversaries is: 3.3418402521293493. distance: 2.1175001976256294
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 1.6208, Accuracy: 5803/8991 (64.5423%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 3, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2743/3455 (79.3922%), train_poison_data_count: 3455
Global model norm: 2.0230157478915087.
Norm before scaling: 3.3694477328327848. Distance: 2.098799126000692
Total norm for 5 adversaries is: 3.3694477328327848. distance: 2.098799126000692
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.8481, Accuracy: 6817/8991 (75.8203%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 4, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3698/4644 (79.6296%), train_poison_data_count: 4644
Global model norm: 2.0230157478915087.
Norm before scaling: 3.587281750144451. Distance: 2.4117604362362433
Total norm for 5 adversaries is: 3.587281750144451. distance: 2.4117604362362433
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 0.8285, Accuracy: 6611/8991 (73.5291%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  10, local model 5, internal_epoch   1,  Average loss: 0.0168, Accuracy: 2193/2798 (78.3774%), train_poison_data_count: 2798
Global model norm: 2.0230157478915087.
Norm before scaling: 3.1360463030861165. Distance: 1.8723329012662417
Total norm for 5 adversaries is: 3.1360463030861165. distance: 1.8723329012662417
___Test Local_Simple poisoned: True, epoch: 10: Average loss: 1.3680, Accuracy: 5498/8991 (61.1500%)
___Train Local_Simple,  epoch  10, local model 6, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3759/4654 (80.7692%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.8984, Accuracy: 6864/10000 (68.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 7, internal_epoch   1,  Average loss: 0.0173, Accuracy: 3026/3839 (78.8226%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 0.9172, Accuracy: 7609/10000 (76.0900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 8, internal_epoch   1,  Average loss: 0.0139, Accuracy: 2337/2848 (82.0576%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.6478, Accuracy: 5576/10000 (55.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 9, internal_epoch   1,  Average loss: 0.0153, Accuracy: 2699/3226 (83.6640%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.1833, Accuracy: 6411/10000 (64.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 10, internal_epoch   1,  Average loss: 0.0146, Accuracy: 4453/5406 (82.3714%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.0631, Accuracy: 6816/10000 (68.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 11, internal_epoch   1,  Average loss: 0.0150, Accuracy: 3544/4481 (79.0895%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.0160, Accuracy: 6428/10000 (64.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 12, internal_epoch   1,  Average loss: 0.0164, Accuracy: 3313/4148 (79.8698%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.2039, Accuracy: 5947/10000 (59.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 13, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3699/4495 (82.2914%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 1.1842, Accuracy: 7138/10000 (71.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  10, local model 14, internal_epoch   1,  Average loss: 0.0118, Accuracy: 2882/3330 (86.5465%)
___Test Local_Simple poisoned: False, epoch: 10: Average loss: 2.0575, Accuracy: 4761/10000 (47.6100%), Attack Success Rate:0/10000(0.000)
time spent on training: 103.30193066596985
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.18291435
 0.18469275 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 10: Average loss: 1.5231, Accuracy: 6327/10000 (63.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 10: Average loss: 1.4758, Accuracy: 6309/8991 (70.1702%)
Done in 111.13720846176147 sec.
Server Epoch:11 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  11, local model 0, internal_epoch   1,  Average loss: 0.0163, Accuracy: 1463/1784 (82.0067%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.5646, Accuracy: 5344/10000 (53.4400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 1, internal_epoch   1,  Average loss: 0.0108, Accuracy: 5243/6000 (87.3833%), train_poison_data_count: 6000
Global model norm: 2.0610136976753974.
Norm before scaling: 3.7230668857169973. Distance: 2.4723332150387987
Total norm for 5 adversaries is: 3.7230668857169973. distance: 2.4723332150387987
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 1.7185, Accuracy: 5885/8991 (65.4543%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 2, internal_epoch   1,  Average loss: 0.0136, Accuracy: 2885/3457 (83.4539%), train_poison_data_count: 3457
Global model norm: 2.0610136976753974.
Norm before scaling: 3.3573988669041483. Distance: 2.0640014038746517
Total norm for 5 adversaries is: 3.3573988669041483. distance: 2.0640014038746517
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 1.5366, Accuracy: 5991/8991 (66.6333%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 3, internal_epoch   1,  Average loss: 0.0158, Accuracy: 2761/3455 (79.9132%), train_poison_data_count: 3455
Global model norm: 2.0610136976753974.
Norm before scaling: 3.3775544566092255. Distance: 2.034365568124497
Total norm for 5 adversaries is: 3.3775544566092255. distance: 2.034365568124497
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.8083, Accuracy: 6984/8991 (77.6777%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 4, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3700/4644 (79.6727%), train_poison_data_count: 4644
Global model norm: 2.0610136976753974.
Norm before scaling: 3.6024227149398027. Distance: 2.354652782201963
Total norm for 5 adversaries is: 3.6024227149398027. distance: 2.354652782201963
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.7772, Accuracy: 6872/8991 (76.4320%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  11, local model 5, internal_epoch   1,  Average loss: 0.0167, Accuracy: 2200/2798 (78.6276%), train_poison_data_count: 2798
Global model norm: 2.0610136976753974.
Norm before scaling: 3.153239863773254. Distance: 1.8117605213582504
Total norm for 5 adversaries is: 3.153239863773254. distance: 1.8117605213582504
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 1.3289, Accuracy: 5467/8991 (60.8052%)
___Train Local_Simple,  epoch  11, local model 6, internal_epoch   1,  Average loss: 0.0145, Accuracy: 3809/4654 (81.8436%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.8623, Accuracy: 7036/10000 (70.3600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 7, internal_epoch   1,  Average loss: 0.0170, Accuracy: 3045/3839 (79.3175%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.9337, Accuracy: 7547/10000 (75.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 8, internal_epoch   1,  Average loss: 0.0133, Accuracy: 2388/2848 (83.8483%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.6656, Accuracy: 5417/10000 (54.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 9, internal_epoch   1,  Average loss: 0.0149, Accuracy: 2719/3226 (84.2839%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.2152, Accuracy: 6540/10000 (65.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 10, internal_epoch   1,  Average loss: 0.0143, Accuracy: 4499/5406 (83.2223%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0648, Accuracy: 6867/10000 (68.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3521/4481 (78.5762%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.0209, Accuracy: 6317/10000 (63.1700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 12, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3347/4148 (80.6895%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.2106, Accuracy: 5784/10000 (57.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 13, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3701/4495 (82.3359%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 1.1485, Accuracy: 7212/10000 (72.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  11, local model 14, internal_epoch   1,  Average loss: 0.0115, Accuracy: 2875/3330 (86.3363%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 2.0424, Accuracy: 4849/10000 (48.4900%), Attack Success Rate:0/10000(0.000)
time spent on training: 123.8173577785492
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.41190641
 0.12906289 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 11: Average loss: 1.4707, Accuracy: 6411/10000 (64.1100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 11: Average loss: 1.4188, Accuracy: 6395/8991 (71.1267%)
Done in 132.28388571739197 sec.
Server Epoch:12 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  12, local model 0, internal_epoch   1,  Average loss: 0.0160, Accuracy: 1460/1784 (81.8386%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.4920, Accuracy: 5416/10000 (54.1600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 1, internal_epoch   1,  Average loss: 0.0106, Accuracy: 5221/6000 (87.0167%), train_poison_data_count: 6000
Global model norm: 2.101776906247486.
Norm before scaling: 3.735282245067618. Distance: 2.412351131293257
Total norm for 5 adversaries is: 3.735282245067618. distance: 2.412351131293257
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.6424, Accuracy: 6115/8991 (68.0125%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 2, internal_epoch   1,  Average loss: 0.0133, Accuracy: 2909/3457 (84.1481%), train_poison_data_count: 3457
Global model norm: 2.101776906247486.
Norm before scaling: 3.380143661154648. Distance: 2.017071700078015
Total norm for 5 adversaries is: 3.380143661154648. distance: 2.017071700078015
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.5434, Accuracy: 5950/8991 (66.1773%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 3, internal_epoch   1,  Average loss: 0.0156, Accuracy: 2787/3455 (80.6657%), train_poison_data_count: 3455
Global model norm: 2.101776906247486.
Norm before scaling: 3.4082168360218477. Distance: 1.9904492742326936
Total norm for 5 adversaries is: 3.4082168360218477. distance: 1.9904492742326936
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.8044, Accuracy: 7009/8991 (77.9557%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 4, internal_epoch   1,  Average loss: 0.0145, Accuracy: 3696/4644 (79.5866%), train_poison_data_count: 4644
Global model norm: 2.101776906247486.
Norm before scaling: 3.621975261626921. Distance: 2.3026863332562764
Total norm for 5 adversaries is: 3.621975261626921. distance: 2.3026863332562764
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.8003, Accuracy: 6732/8991 (74.8749%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  12, local model 5, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2224/2798 (79.4853%), train_poison_data_count: 2798
Global model norm: 2.101776906247486.
Norm before scaling: 3.1719250604597145. Distance: 1.7685133003940496
Total norm for 5 adversaries is: 3.1719250604597145. distance: 1.7685133003940496
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.3418, Accuracy: 5483/8991 (60.9832%)
___Train Local_Simple,  epoch  12, local model 6, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3833/4654 (82.3593%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.8574, Accuracy: 7094/10000 (70.9400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 7, internal_epoch   1,  Average loss: 0.0165, Accuracy: 3086/3839 (80.3855%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9262, Accuracy: 7652/10000 (76.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 8, internal_epoch   1,  Average loss: 0.0131, Accuracy: 2371/2848 (83.2514%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.7037, Accuracy: 5343/10000 (53.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 9, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2716/3226 (84.1909%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.2047, Accuracy: 6539/10000 (65.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 10, internal_epoch   1,  Average loss: 0.0142, Accuracy: 4499/5406 (83.2223%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0236, Accuracy: 6899/10000 (68.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3566/4481 (79.5805%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.0546, Accuracy: 6144/10000 (61.4400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 12, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3351/4148 (80.7859%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1765, Accuracy: 5826/10000 (58.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 13, internal_epoch   1,  Average loss: 0.0133, Accuracy: 3731/4495 (83.0033%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.1404, Accuracy: 7253/10000 (72.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  12, local model 14, internal_epoch   1,  Average loss: 0.0112, Accuracy: 2909/3330 (87.3574%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 1.9324, Accuracy: 4956/10000 (49.5600%), Attack Success Rate:0/10000(0.000)
time spent on training: 131.43557500839233
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.07038934
 0.1331306  1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 12: Average loss: 1.4251, Accuracy: 6482/10000 (64.8200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 12: Average loss: 1.3706, Accuracy: 6467/8991 (71.9275%)
Done in 140.25581574440002 sec.
Server Epoch:13 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  13, local model 0, internal_epoch   1,  Average loss: 0.0155, Accuracy: 1472/1784 (82.5112%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.4380, Accuracy: 5506/10000 (55.0600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 1, internal_epoch   1,  Average loss: 0.0105, Accuracy: 5253/6000 (87.5500%), train_poison_data_count: 6000
Global model norm: 2.141369432635945.
Norm before scaling: 3.7467772304833074. Distance: 2.3586423633236953
Total norm for 5 adversaries is: 3.7467772304833074. distance: 2.3586423633236953
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.6816, Accuracy: 6023/8991 (66.9892%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 2, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2925/3457 (84.6109%), train_poison_data_count: 3457
Global model norm: 2.141369432635945.
Norm before scaling: 3.3841472573762115. Distance: 1.9563226387748602
Total norm for 5 adversaries is: 3.3841472573762115. distance: 1.9563226387748602
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.5054, Accuracy: 5946/8991 (66.1328%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 3, internal_epoch   1,  Average loss: 0.0152, Accuracy: 2807/3455 (81.2446%), train_poison_data_count: 3455
Global model norm: 2.141369432635945.
Norm before scaling: 3.423733559242041. Distance: 1.9401820293052374
Total norm for 5 adversaries is: 3.423733559242041. distance: 1.9401820293052374
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.8394, Accuracy: 6735/8991 (74.9082%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 4, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3769/4644 (81.1585%), train_poison_data_count: 4644
Global model norm: 2.141369432635945.
Norm before scaling: 3.6434974962427176. Distance: 2.260217883485762
Total norm for 5 adversaries is: 3.6434974962427176. distance: 2.260217883485762
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.7767, Accuracy: 6934/8991 (77.1216%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  13, local model 5, internal_epoch   1,  Average loss: 0.0161, Accuracy: 2233/2798 (79.8070%), train_poison_data_count: 2798
Global model norm: 2.141369432635945.
Norm before scaling: 3.186018805334001. Distance: 1.7154192469332457
Total norm for 5 adversaries is: 3.186018805334001. distance: 1.7154192469332457
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.2967, Accuracy: 5468/8991 (60.8164%)
___Train Local_Simple,  epoch  13, local model 6, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3833/4654 (82.3593%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.8324, Accuracy: 7228/10000 (72.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 7, internal_epoch   1,  Average loss: 0.0162, Accuracy: 3080/3839 (80.2292%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.9042, Accuracy: 7683/10000 (76.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 8, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2405/2848 (84.4452%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.6238, Accuracy: 5448/10000 (54.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 9, internal_epoch   1,  Average loss: 0.0141, Accuracy: 2741/3226 (84.9659%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1860, Accuracy: 6550/10000 (65.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 10, internal_epoch   1,  Average loss: 0.0138, Accuracy: 4483/5406 (82.9264%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.0436, Accuracy: 6880/10000 (68.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 11, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3558/4481 (79.4019%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.0365, Accuracy: 6261/10000 (62.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 12, internal_epoch   1,  Average loss: 0.0155, Accuracy: 3355/4148 (80.8824%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1108, Accuracy: 6152/10000 (61.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 13, internal_epoch   1,  Average loss: 0.0132, Accuracy: 3752/4495 (83.4705%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1603, Accuracy: 7184/10000 (71.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  13, local model 14, internal_epoch   1,  Average loss: 0.0110, Accuracy: 2895/3330 (86.9369%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.9506, Accuracy: 4962/10000 (49.6200%), Attack Success Rate:0/10000(0.000)
time spent on training: 141.02207708358765
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.28101122
 0.33820837 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 13: Average loss: 1.3809, Accuracy: 6530/10000 (65.3000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 13: Average loss: 1.3231, Accuracy: 6517/8991 (72.4836%)
Done in 149.74968910217285 sec.
Server Epoch:14 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  14, local model 0, internal_epoch   1,  Average loss: 0.0149, Accuracy: 1487/1784 (83.3520%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.4575, Accuracy: 5494/10000 (54.9400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 1, internal_epoch   1,  Average loss: 0.0103, Accuracy: 5274/6000 (87.9000%), train_poison_data_count: 6000
Global model norm: 2.1846795564227968.
Norm before scaling: 3.7560518387049804. Distance: 2.294671695139974
Total norm for 5 adversaries is: 3.7560518387049804. distance: 2.294671695139974
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.6005, Accuracy: 6050/8991 (67.2895%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 2, internal_epoch   1,  Average loss: 0.0126, Accuracy: 2928/3457 (84.6977%), train_poison_data_count: 3457
Global model norm: 2.1846795564227968.
Norm before scaling: 3.404437641641091. Distance: 1.906314786216576
Total norm for 5 adversaries is: 3.404437641641091. distance: 1.906314786216576
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.4666, Accuracy: 6045/8991 (67.2339%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 3, internal_epoch   1,  Average loss: 0.0150, Accuracy: 2826/3455 (81.7945%), train_poison_data_count: 3455
Global model norm: 2.1846795564227968.
Norm before scaling: 3.4447108152068195. Distance: 1.8838977139682893
Total norm for 5 adversaries is: 3.4447108152068195. distance: 1.8838977139682893
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.8123, Accuracy: 6891/8991 (76.6433%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 4, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3746/4644 (80.6632%), train_poison_data_count: 4644
Global model norm: 2.1846795564227968.
Norm before scaling: 3.655533940548621. Distance: 2.200359583858695
Total norm for 5 adversaries is: 3.655533940548621. distance: 2.200359583858695
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.7591, Accuracy: 6935/8991 (77.1327%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  14, local model 5, internal_epoch   1,  Average loss: 0.0154, Accuracy: 2237/2798 (79.9500%), train_poison_data_count: 2798
Global model norm: 2.1846795564227968.
Norm before scaling: 3.2157341615111417. Distance: 1.6847668873078827
Total norm for 5 adversaries is: 3.2157341615111417. distance: 1.6847668873078827
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.2658, Accuracy: 5687/8991 (63.2521%)
___Train Local_Simple,  epoch  14, local model 6, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3846/4654 (82.6386%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.8391, Accuracy: 7157/10000 (71.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 7, internal_epoch   1,  Average loss: 0.0161, Accuracy: 3092/3839 (80.5418%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.8927, Accuracy: 7688/10000 (76.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 8, internal_epoch   1,  Average loss: 0.0126, Accuracy: 2393/2848 (84.0239%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.5653, Accuracy: 5543/10000 (55.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 9, internal_epoch   1,  Average loss: 0.0140, Accuracy: 2718/3226 (84.2529%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1354, Accuracy: 6478/10000 (64.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 10, internal_epoch   1,  Average loss: 0.0138, Accuracy: 4483/5406 (82.9264%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9872, Accuracy: 6780/10000 (67.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 11, internal_epoch   1,  Average loss: 0.0141, Accuracy: 3596/4481 (80.2499%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.0648, Accuracy: 6097/10000 (60.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 12, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3347/4148 (80.6895%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1373, Accuracy: 5875/10000 (58.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 13, internal_epoch   1,  Average loss: 0.0130, Accuracy: 3730/4495 (82.9811%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.1242, Accuracy: 7273/10000 (72.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  14, local model 14, internal_epoch   1,  Average loss: 0.0109, Accuracy: 2899/3330 (87.0571%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 1.9241, Accuracy: 4915/10000 (49.1500%), Attack Success Rate:0/10000(0.000)
time spent on training: 146.7045521736145
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.19651853
 0.43130075 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 14: Average loss: 1.3390, Accuracy: 6583/10000 (65.8300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 14: Average loss: 1.2781, Accuracy: 6568/8991 (73.0508%)
Done in 155.5879681110382 sec.
Server Epoch:15 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  15, local model 0, internal_epoch   1,  Average loss: 0.0147, Accuracy: 1489/1784 (83.4641%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.4071, Accuracy: 5561/10000 (55.6100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 1, internal_epoch   1,  Average loss: 0.0101, Accuracy: 5287/6000 (88.1167%), train_poison_data_count: 6000
Global model norm: 2.2287483060427062.
Norm before scaling: 3.773558936524553. Distance: 2.249000115217763
Total norm for 5 adversaries is: 3.773558936524553. distance: 2.249000115217763
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.6441, Accuracy: 6019/8991 (66.9447%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 2, internal_epoch   1,  Average loss: 0.0123, Accuracy: 2953/3457 (85.4209%), train_poison_data_count: 3457
Global model norm: 2.2287483060427062.
Norm before scaling: 3.412451182704424. Distance: 1.8539714353268264
Total norm for 5 adversaries is: 3.412451182704424. distance: 1.8539714353268264
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.4550, Accuracy: 5991/8991 (66.6333%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 3, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2827/3455 (81.8234%), train_poison_data_count: 3455
Global model norm: 2.2287483060427062.
Norm before scaling: 3.4580556612493716. Distance: 1.8326348650381687
Total norm for 5 adversaries is: 3.4580556612493716. distance: 1.8326348650381687
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.7772, Accuracy: 7128/8991 (79.2793%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3791/4644 (81.6322%), train_poison_data_count: 4644
Global model norm: 2.2287483060427062.
Norm before scaling: 3.6786754212514365. Distance: 2.161349582617312
Total norm for 5 adversaries is: 3.6786754212514365. distance: 2.161349582617312
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.7476, Accuracy: 7000/8991 (77.8556%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  15, local model 5, internal_epoch   1,  Average loss: 0.0153, Accuracy: 2244/2798 (80.2001%), train_poison_data_count: 2798
Global model norm: 2.2287483060427062.
Norm before scaling: 3.2328431560819917. Distance: 1.640182435425484
Total norm for 5 adversaries is: 3.2328431560819917. distance: 1.640182435425484
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 1.2517, Accuracy: 5624/8991 (62.5514%)
___Train Local_Simple,  epoch  15, local model 6, internal_epoch   1,  Average loss: 0.0136, Accuracy: 3861/4654 (82.9609%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.8463, Accuracy: 7174/10000 (71.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 7, internal_epoch   1,  Average loss: 0.0157, Accuracy: 3141/3839 (81.8182%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.9468, Accuracy: 7276/10000 (72.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 8, internal_epoch   1,  Average loss: 0.0125, Accuracy: 2412/2848 (84.6910%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.5839, Accuracy: 5453/10000 (54.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 9, internal_epoch   1,  Average loss: 0.0137, Accuracy: 2749/3226 (85.2139%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1506, Accuracy: 6651/10000 (66.5100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 10, internal_epoch   1,  Average loss: 0.0134, Accuracy: 4524/5406 (83.6848%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0265, Accuracy: 6906/10000 (69.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 11, internal_epoch   1,  Average loss: 0.0138, Accuracy: 3603/4481 (80.4062%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.0214, Accuracy: 6233/10000 (62.3300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 12, internal_epoch   1,  Average loss: 0.0151, Accuracy: 3379/4148 (81.4609%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1275, Accuracy: 5970/10000 (59.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 13, internal_epoch   1,  Average loss: 0.0128, Accuracy: 3772/4495 (83.9155%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.1063, Accuracy: 7327/10000 (73.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0105, Accuracy: 2883/3330 (86.5766%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 1.8811, Accuracy: 4985/10000 (49.8500%), Attack Success Rate:0/10000(0.000)
time spent on training: 155.2208333015442
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.25393815 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 15: Average loss: 1.3031, Accuracy: 6625/10000 (66.2500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 15: Average loss: 1.2395, Accuracy: 6611/8991 (73.5291%)
Done in 163.7980179786682 sec.
Server Epoch:16 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  16, local model 0, internal_epoch   1,  Average loss: 0.0141, Accuracy: 1508/1784 (84.5291%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.4045, Accuracy: 5621/10000 (56.2100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 1, internal_epoch   1,  Average loss: 0.0100, Accuracy: 5287/6000 (88.1167%), train_poison_data_count: 6000
Global model norm: 2.2706820119666675.
Norm before scaling: 3.7840099508303884. Distance: 2.1960196119867574
Total norm for 5 adversaries is: 3.7840099508303884. distance: 2.1960196119867574
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.5906, Accuracy: 6112/8991 (67.9791%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 2, internal_epoch   1,  Average loss: 0.0122, Accuracy: 2957/3457 (85.5366%), train_poison_data_count: 3457
Global model norm: 2.2706820119666675.
Norm before scaling: 3.4405759054314085. Distance: 1.8222528029928056
Total norm for 5 adversaries is: 3.4405759054314085. distance: 1.8222528029928056
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.4501, Accuracy: 5877/8991 (65.3654%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 3, internal_epoch   1,  Average loss: 0.0145, Accuracy: 2853/3455 (82.5760%), train_poison_data_count: 3455
Global model norm: 2.2706820119666675.
Norm before scaling: 3.462957546149052. Distance: 1.769445286698526
Total norm for 5 adversaries is: 3.462957546149052. distance: 1.769445286698526
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.7472, Accuracy: 7247/8991 (80.6028%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0135, Accuracy: 3810/4644 (82.0413%), train_poison_data_count: 4644
Global model norm: 2.2706820119666675.
Norm before scaling: 3.6908855091115504. Distance: 2.107937584425299
Total norm for 5 adversaries is: 3.6908855091115504. distance: 2.107937584425299
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 0.7396, Accuracy: 7088/8991 (78.8344%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  16, local model 5, internal_epoch   1,  Average loss: 0.0150, Accuracy: 2243/2798 (80.1644%), train_poison_data_count: 2798
Global model norm: 2.2706820119666675.
Norm before scaling: 3.2784266359452654. Distance: 1.6253685900004298
Total norm for 5 adversaries is: 3.2784266359452654. distance: 1.6253685900004298
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.2280, Accuracy: 5609/8991 (62.3846%)
___Train Local_Simple,  epoch  16, local model 6, internal_epoch   1,  Average loss: 0.0134, Accuracy: 3870/4654 (83.1543%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8327, Accuracy: 7293/10000 (72.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 7, internal_epoch   1,  Average loss: 0.0156, Accuracy: 3109/3839 (80.9846%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8722, Accuracy: 7607/10000 (76.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0123, Accuracy: 2397/2848 (84.1643%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.5105, Accuracy: 5600/10000 (56.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 9, internal_epoch   1,  Average loss: 0.0134, Accuracy: 2727/3226 (84.5319%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.1285, Accuracy: 6503/10000 (65.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 10, internal_epoch   1,  Average loss: 0.0133, Accuracy: 4529/5406 (83.7773%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.9750, Accuracy: 6986/10000 (69.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 11, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3592/4481 (80.1607%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.9660, Accuracy: 6504/10000 (65.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 12, internal_epoch   1,  Average loss: 0.0148, Accuracy: 3387/4148 (81.6538%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.1529, Accuracy: 5812/10000 (58.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 13, internal_epoch   1,  Average loss: 0.0125, Accuracy: 3822/4495 (85.0278%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.1373, Accuracy: 7161/10000 (71.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  16, local model 14, internal_epoch   1,  Average loss: 0.0103, Accuracy: 2941/3330 (88.3183%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 1.7956, Accuracy: 5096/10000 (50.9600%), Attack Success Rate:0/10000(0.000)
time spent on training: 162.8694097995758
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.03657243
 0.05060588 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 16: Average loss: 1.2703, Accuracy: 6661/10000 (66.6100%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 16: Average loss: 1.2048, Accuracy: 6647/8991 (73.9295%)
Done in 171.7119562625885 sec.
Server Epoch:17 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  17, local model 0, internal_epoch   1,  Average loss: 0.0137, Accuracy: 1517/1784 (85.0336%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.3501, Accuracy: 5651/10000 (56.5100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 1, internal_epoch   1,  Average loss: 0.0099, Accuracy: 5294/6000 (88.2333%), train_poison_data_count: 6000
Global model norm: 2.311830784647367.
Norm before scaling: 3.799095226792338. Distance: 2.1543233252498513
Total norm for 5 adversaries is: 3.799095226792338. distance: 2.1543233252498513
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.6036, Accuracy: 6049/8991 (67.2784%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 2, internal_epoch   1,  Average loss: 0.0120, Accuracy: 2985/3457 (86.3465%), train_poison_data_count: 3457
Global model norm: 2.311830784647367.
Norm before scaling: 3.4435263780935346. Distance: 1.7626715069375885
Total norm for 5 adversaries is: 3.4435263780935346. distance: 1.7626715069375885
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.4635, Accuracy: 5955/8991 (66.2329%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 3, internal_epoch   1,  Average loss: 0.0142, Accuracy: 2867/3455 (82.9812%), train_poison_data_count: 3455
Global model norm: 2.311830784647367.
Norm before scaling: 3.4802500851975533. Distance: 1.7253882786616306
Total norm for 5 adversaries is: 3.4802500851975533. distance: 1.7253882786616306
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.7457, Accuracy: 7248/8991 (80.6139%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 4, internal_epoch   1,  Average loss: 0.0134, Accuracy: 3819/4644 (82.2351%), train_poison_data_count: 4644
Global model norm: 2.311830784647367.
Norm before scaling: 3.7129471326578445. Distance: 2.075013434125316
Total norm for 5 adversaries is: 3.7129471326578445. distance: 2.075013434125316
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.7322, Accuracy: 7097/8991 (78.9345%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  17, local model 5, internal_epoch   1,  Average loss: 0.0148, Accuracy: 2253/2798 (80.5218%), train_poison_data_count: 2798
Global model norm: 2.311830784647367.
Norm before scaling: 3.2942741946880494. Distance: 1.5875899251864722
Total norm for 5 adversaries is: 3.2942741946880494. distance: 1.5875899251864722
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.2232, Accuracy: 5650/8991 (62.8406%)
___Train Local_Simple,  epoch  17, local model 6, internal_epoch   1,  Average loss: 0.0133, Accuracy: 3879/4654 (83.3477%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8152, Accuracy: 7238/10000 (72.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 7, internal_epoch   1,  Average loss: 0.0154, Accuracy: 3159/3839 (82.2871%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.8759, Accuracy: 7563/10000 (75.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 8, internal_epoch   1,  Average loss: 0.0120, Accuracy: 2418/2848 (84.9017%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.4500, Accuracy: 5727/10000 (57.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 9, internal_epoch   1,  Average loss: 0.0132, Accuracy: 2759/3226 (85.5239%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.0850, Accuracy: 6646/10000 (66.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0131, Accuracy: 4548/5406 (84.1287%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9845, Accuracy: 6787/10000 (67.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 11, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3622/4481 (80.8302%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.9902, Accuracy: 6362/10000 (63.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 12, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3407/4148 (82.1360%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.0988, Accuracy: 6161/10000 (61.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 13, internal_epoch   1,  Average loss: 0.0123, Accuracy: 3818/4495 (84.9388%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.1279, Accuracy: 7241/10000 (72.4100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  17, local model 14, internal_epoch   1,  Average loss: 0.0102, Accuracy: 2924/3330 (87.8078%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.8139, Accuracy: 5140/10000 (51.4000%), Attack Success Rate:0/10000(0.000)
time spent on training: 169.75143957138062
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.05005281 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 17: Average loss: 1.2409, Accuracy: 6689/10000 (66.8900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 17: Average loss: 1.1728, Accuracy: 6676/8991 (74.2520%)
Done in 178.55865049362183 sec.
Server Epoch:18 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  18, local model 0, internal_epoch   1,  Average loss: 0.0136, Accuracy: 1501/1784 (84.1368%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.3226, Accuracy: 5753/10000 (57.5300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 1, internal_epoch   1,  Average loss: 0.0098, Accuracy: 5311/6000 (88.5167%), train_poison_data_count: 6000
Global model norm: 2.3527330292468758.
Norm before scaling: 3.8039036125382366. Distance: 2.1016306812897287
Total norm for 5 adversaries is: 3.8039036125382366. distance: 2.1016306812897287
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 1.5759, Accuracy: 6028/8991 (67.0448%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 2, internal_epoch   1,  Average loss: 0.0118, Accuracy: 2965/3457 (85.7680%), train_poison_data_count: 3457
Global model norm: 2.3527330292468758.
Norm before scaling: 3.4735787263852242. Distance: 1.7466437307822347
Total norm for 5 adversaries is: 3.4735787263852242. distance: 1.7466437307822347
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 1.4447, Accuracy: 5939/8991 (66.0549%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 3, internal_epoch   1,  Average loss: 0.0139, Accuracy: 2878/3455 (83.2996%), train_poison_data_count: 3455
Global model norm: 2.3527330292468758.
Norm before scaling: 3.5101892112748274. Distance: 1.6977817115119536
Total norm for 5 adversaries is: 3.5101892112748274. distance: 1.6977817115119536
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.7490, Accuracy: 7203/8991 (80.1134%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 4, internal_epoch   1,  Average loss: 0.0132, Accuracy: 3819/4644 (82.2351%), train_poison_data_count: 4644
Global model norm: 2.3527330292468758.
Norm before scaling: 3.7144120504042073. Distance: 2.020838537569981
Total norm for 5 adversaries is: 3.7144120504042073. distance: 2.020838537569981
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.7283, Accuracy: 7102/8991 (78.9901%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  18, local model 5, internal_epoch   1,  Average loss: 0.0147, Accuracy: 2271/2798 (81.1651%), train_poison_data_count: 2798
Global model norm: 2.3527330292468758.
Norm before scaling: 3.3107349803675756. Distance: 1.5472922484879303
Total norm for 5 adversaries is: 3.3107349803675756. distance: 1.5472922484879303
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 1.1810, Accuracy: 5713/8991 (63.5413%)
___Train Local_Simple,  epoch  18, local model 6, internal_epoch   1,  Average loss: 0.0131, Accuracy: 3887/4654 (83.5196%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7959, Accuracy: 7404/10000 (74.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 7, internal_epoch   1,  Average loss: 0.0152, Accuracy: 3155/3839 (82.1829%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9005, Accuracy: 7539/10000 (75.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 8, internal_epoch   1,  Average loss: 0.0119, Accuracy: 2405/2848 (84.4452%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.3882, Accuracy: 5842/10000 (58.4200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 9, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2761/3226 (85.5859%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.0465, Accuracy: 6754/10000 (67.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 10, internal_epoch   1,  Average loss: 0.0130, Accuracy: 4522/5406 (83.6478%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9564, Accuracy: 6967/10000 (69.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 11, internal_epoch   1,  Average loss: 0.0134, Accuracy: 3616/4481 (80.6963%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.9479, Accuracy: 6515/10000 (65.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0146, Accuracy: 3399/4148 (81.9431%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.0512, Accuracy: 6262/10000 (62.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 13, internal_epoch   1,  Average loss: 0.0122, Accuracy: 3797/4495 (84.4716%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.1505, Accuracy: 7085/10000 (70.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  18, local model 14, internal_epoch   1,  Average loss: 0.0100, Accuracy: 2928/3330 (87.9279%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 1.7663, Accuracy: 5132/10000 (51.3200%), Attack Success Rate:0/10000(0.000)
time spent on training: 179.01887845993042
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.08284262
 0.47603953 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 18: Average loss: 1.2099, Accuracy: 6740/10000 (67.4000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 18: Average loss: 1.1396, Accuracy: 6728/8991 (74.8304%)
Done in 188.0434284210205 sec.
Server Epoch:19 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  19, local model 0, internal_epoch   1,  Average loss: 0.0133, Accuracy: 1525/1784 (85.4821%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.3418, Accuracy: 5737/10000 (57.3700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 1, internal_epoch   1,  Average loss: 0.0097, Accuracy: 5323/6000 (88.7167%), train_poison_data_count: 6000
Global model norm: 2.3972288186385406.
Norm before scaling: 3.8213067818398274. Distance: 2.0558408103944004
Total norm for 5 adversaries is: 3.8213067818398274. distance: 2.0558408103944004
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.5486, Accuracy: 6093/8991 (67.7678%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 2, internal_epoch   1,  Average loss: 0.0117, Accuracy: 2967/3457 (85.8259%), train_poison_data_count: 3457
Global model norm: 2.3972288186385406.
Norm before scaling: 3.4816370586221637. Distance: 1.6875251485575438
Total norm for 5 adversaries is: 3.4816370586221637. distance: 1.6875251485575438
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.3624, Accuracy: 6056/8991 (67.3562%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 3, internal_epoch   1,  Average loss: 0.0137, Accuracy: 2876/3455 (83.2417%), train_poison_data_count: 3455
Global model norm: 2.3972288186385406.
Norm before scaling: 3.518965562413984. Distance: 1.650192989275942
Total norm for 5 adversaries is: 3.518965562413984. distance: 1.650192989275942
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.7561, Accuracy: 7173/8991 (79.7798%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 4, internal_epoch   1,  Average loss: 0.0130, Accuracy: 3840/4644 (82.6873%), train_poison_data_count: 4644
Global model norm: 2.3972288186385406.
Norm before scaling: 3.737426022208918. Distance: 1.9884250191682482
Total norm for 5 adversaries is: 3.737426022208918. distance: 1.9884250191682482
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.7488, Accuracy: 6967/8991 (77.4886%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  19, local model 5, internal_epoch   1,  Average loss: 0.0143, Accuracy: 2280/2798 (81.4868%), train_poison_data_count: 2798
Global model norm: 2.3972288186385406.
Norm before scaling: 3.3361380380572037. Distance: 1.5281153922373787
Total norm for 5 adversaries is: 3.3361380380572037. distance: 1.5281153922373787
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.2069, Accuracy: 5702/8991 (63.4190%)
___Train Local_Simple,  epoch  19, local model 6, internal_epoch   1,  Average loss: 0.0130, Accuracy: 3909/4654 (83.9923%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.7992, Accuracy: 7361/10000 (73.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 7, internal_epoch   1,  Average loss: 0.0149, Accuracy: 3188/3839 (83.0425%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.8505, Accuracy: 7789/10000 (77.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 8, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2425/2848 (85.1475%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.4795, Accuracy: 5514/10000 (55.1400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 9, internal_epoch   1,  Average loss: 0.0127, Accuracy: 2777/3226 (86.0818%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.0957, Accuracy: 6631/10000 (66.3100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 10, internal_epoch   1,  Average loss: 0.0128, Accuracy: 4565/5406 (84.4432%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.9648, Accuracy: 6935/10000 (69.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 11, internal_epoch   1,  Average loss: 0.0130, Accuracy: 3680/4481 (82.1245%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.9498, Accuracy: 6561/10000 (65.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 12, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3406/4148 (82.1119%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.0697, Accuracy: 6206/10000 (62.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 13, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3824/4495 (85.0723%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.0940, Accuracy: 7298/10000 (72.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  19, local model 14, internal_epoch   1,  Average loss: 0.0098, Accuracy: 2921/3330 (87.7177%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 1.7412, Accuracy: 5206/10000 (52.0600%), Attack Success Rate:0/10000(0.000)
time spent on training: 185.6329481601715
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.24943861 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 19: Average loss: 1.1833, Accuracy: 6762/10000 (67.6200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 19: Average loss: 1.1108, Accuracy: 6751/8991 (75.0862%)
Done in 194.26006937026978 sec.
Server Epoch:20 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  20, local model 0, internal_epoch   1,  Average loss: 0.0131, Accuracy: 1510/1784 (84.6413%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.2738, Accuracy: 5921/10000 (59.2100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 1, internal_epoch   1,  Average loss: 0.0095, Accuracy: 5326/6000 (88.7667%), train_poison_data_count: 6000
Global model norm: 2.4394827383548345.
Norm before scaling: 3.833591963847467. Distance: 2.014361199720207
Total norm for 5 adversaries is: 3.833591963847467. distance: 2.014361199720207
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.5171, Accuracy: 6110/8991 (67.9568%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 2, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2963/3457 (85.7102%), train_poison_data_count: 3457
Global model norm: 2.4394827383548345.
Norm before scaling: 3.5069016121408834. Distance: 1.6700810585222838
Total norm for 5 adversaries is: 3.5069016121408834. distance: 1.6700810585222838
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.3683, Accuracy: 6053/8991 (67.3229%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 3, internal_epoch   1,  Average loss: 0.0135, Accuracy: 2894/3455 (83.7627%), train_poison_data_count: 3455
Global model norm: 2.4394827383548345.
Norm before scaling: 3.532186333403757. Distance: 1.6023762938171873
Total norm for 5 adversaries is: 3.532186333403757. distance: 1.6023762938171873
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.7284, Accuracy: 7315/8991 (81.3591%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 4, internal_epoch   1,  Average loss: 0.0129, Accuracy: 3840/4644 (82.6873%), train_poison_data_count: 4644
Global model norm: 2.4394827383548345.
Norm before scaling: 3.7787999814659097. Distance: 1.97760332167973
Total norm for 5 adversaries is: 3.7787999814659097. distance: 1.97760332167973
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.7363, Accuracy: 7013/8991 (78.0002%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  20, local model 5, internal_epoch   1,  Average loss: 0.0141, Accuracy: 2278/2798 (81.4153%), train_poison_data_count: 2798
Global model norm: 2.4394827383548345.
Norm before scaling: 3.358952695340274. Distance: 1.4891837680107234
Total norm for 5 adversaries is: 3.358952695340274. distance: 1.4891837680107234
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 1.1483, Accuracy: 5782/8991 (64.3088%)
___Train Local_Simple,  epoch  20, local model 6, internal_epoch   1,  Average loss: 0.0128, Accuracy: 3912/4654 (84.0567%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.8092, Accuracy: 7297/10000 (72.9700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 7, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3193/3839 (83.1727%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.8997, Accuracy: 7574/10000 (75.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 8, internal_epoch   1,  Average loss: 0.0115, Accuracy: 2435/2848 (85.4986%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.4109, Accuracy: 5818/10000 (58.1800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 9, internal_epoch   1,  Average loss: 0.0126, Accuracy: 2766/3226 (85.7409%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0689, Accuracy: 6649/10000 (66.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 10, internal_epoch   1,  Average loss: 0.0128, Accuracy: 4562/5406 (84.3877%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.9396, Accuracy: 6920/10000 (69.2000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0130, Accuracy: 3684/4481 (82.2138%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.9145, Accuracy: 6658/10000 (66.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0142, Accuracy: 3425/4148 (82.5699%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0582, Accuracy: 6173/10000 (61.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0119, Accuracy: 3826/4495 (85.1168%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.0720, Accuracy: 7329/10000 (73.2900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  20, local model 14, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2922/3330 (87.7477%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 1.7495, Accuracy: 5137/10000 (51.3700%), Attack Success Rate:0/10000(0.000)
time spent on training: 193.1413791179657
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.23759638 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 20: Average loss: 1.1581, Accuracy: 6796/10000 (67.9600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 20: Average loss: 1.0842, Accuracy: 6783/8991 (75.4421%)
Done in 201.727037191391 sec.
Server Epoch:21 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  21, local model 0, internal_epoch   1,  Average loss: 0.0128, Accuracy: 1526/1784 (85.5381%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.2527, Accuracy: 5919/10000 (59.1900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 1, internal_epoch   1,  Average loss: 0.0094, Accuracy: 5331/6000 (88.8500%), train_poison_data_count: 6000
Global model norm: 2.4814317651083853.
Norm before scaling: 3.845816452193209. Distance: 1.974930100471573
Total norm for 5 adversaries is: 3.845816452193209. distance: 1.974930100471573
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 1.5062, Accuracy: 6111/8991 (67.9680%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 2, internal_epoch   1,  Average loss: 0.0114, Accuracy: 2983/3457 (86.2887%), train_poison_data_count: 3457
Global model norm: 2.4814317651083853.
Norm before scaling: 3.5160028551283213. Distance: 1.6152581394204801
Total norm for 5 adversaries is: 3.5160028551283213. distance: 1.6152581394204801
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 1.3353, Accuracy: 6100/8991 (67.8456%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 3, internal_epoch   1,  Average loss: 0.0133, Accuracy: 2910/3455 (84.2258%), train_poison_data_count: 3455
Global model norm: 2.4814317651083853.
Norm before scaling: 3.555990060112259. Distance: 1.573161108294426
Total norm for 5 adversaries is: 3.555990060112259. distance: 1.573161108294426
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.7630, Accuracy: 7094/8991 (78.9011%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 4, internal_epoch   1,  Average loss: 0.0129, Accuracy: 3816/4644 (82.1705%), train_poison_data_count: 4644
Global model norm: 2.4814317651083853.
Norm before scaling: 3.775300571020842. Distance: 1.9192929794986888
Total norm for 5 adversaries is: 3.775300571020842. distance: 1.9192929794986888
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.7117, Accuracy: 7183/8991 (79.8910%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  21, local model 5, internal_epoch   1,  Average loss: 0.0140, Accuracy: 2280/2798 (81.4868%), train_poison_data_count: 2798
Global model norm: 2.4814317651083853.
Norm before scaling: 3.3761165326150806. Distance: 1.4531053111065335
Total norm for 5 adversaries is: 3.3761165326150806. distance: 1.4531053111065335
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 1.1202, Accuracy: 5835/8991 (64.8982%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0127, Accuracy: 3920/4654 (84.2286%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.7972, Accuracy: 7324/10000 (73.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 7, internal_epoch   1,  Average loss: 0.0147, Accuracy: 3179/3839 (82.8080%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.8645, Accuracy: 7653/10000 (76.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 8, internal_epoch   1,  Average loss: 0.0114, Accuracy: 2427/2848 (85.2177%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.3799, Accuracy: 5788/10000 (57.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 9, internal_epoch   1,  Average loss: 0.0124, Accuracy: 2774/3226 (85.9888%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0357, Accuracy: 6757/10000 (67.5700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 10, internal_epoch   1,  Average loss: 0.0126, Accuracy: 4568/5406 (84.4987%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.9712, Accuracy: 6930/10000 (69.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 11, internal_epoch   1,  Average loss: 0.0128, Accuracy: 3683/4481 (82.1915%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.9571, Accuracy: 6412/10000 (64.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 12, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3437/4148 (82.8592%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0089, Accuracy: 6462/10000 (64.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 13, internal_epoch   1,  Average loss: 0.0118, Accuracy: 3823/4495 (85.0501%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.0510, Accuracy: 7481/10000 (74.8100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   1,  Average loss: 0.0096, Accuracy: 2954/3330 (88.7087%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 1.6533, Accuracy: 5337/10000 (53.3700%), Attack Success Rate:0/10000(0.000)
time spent on training: 201.37266993522644
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.        1.        1.        0.        0.        1.        0.
 0.        1.        0.        0.        0.        0.4506503 1.
 1.       ]
___Test Target_Simple poisoned: False, epoch: 21: Average loss: 1.1340, Accuracy: 6827/10000 (68.2700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 21: Average loss: 1.0581, Accuracy: 6814/8991 (75.7869%)
Done in 210.10100054740906 sec.
Server Epoch:22 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  22, local model 0, internal_epoch   1,  Average loss: 0.0124, Accuracy: 1533/1784 (85.9305%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.2265, Accuracy: 5974/10000 (59.7400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 1, internal_epoch   1,  Average loss: 0.0094, Accuracy: 5313/6000 (88.5500%), train_poison_data_count: 6000
Global model norm: 2.524666879416028.
Norm before scaling: 3.8686394942220814. Distance: 1.94595779685258
Total norm for 5 adversaries is: 3.8686394942220814. distance: 1.94595779685258
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.5352, Accuracy: 6019/8991 (66.9447%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 2, internal_epoch   1,  Average loss: 0.0114, Accuracy: 2997/3457 (86.6937%), train_poison_data_count: 3457
Global model norm: 2.524666879416028.
Norm before scaling: 3.5349288277158566. Distance: 1.5858273773295333
Total norm for 5 adversaries is: 3.5349288277158566. distance: 1.5858273773295333
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.3501, Accuracy: 6000/8991 (66.7334%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 3, internal_epoch   1,  Average loss: 0.0132, Accuracy: 2901/3455 (83.9653%), train_poison_data_count: 3455
Global model norm: 2.524666879416028.
Norm before scaling: 3.568030230997081. Distance: 1.531678120456468
Total norm for 5 adversaries is: 3.568030230997081. distance: 1.531678120456468
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.7188, Accuracy: 7309/8991 (81.2924%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3883/4644 (83.6133%), train_poison_data_count: 4644
Global model norm: 2.524666879416028.
Norm before scaling: 3.8068918974117327. Distance: 1.9023362929180396
Total norm for 5 adversaries is: 3.8068918974117327. distance: 1.9023362929180396
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.7440, Accuracy: 6990/8991 (77.7444%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  22, local model 5, internal_epoch   1,  Average loss: 0.0139, Accuracy: 2279/2798 (81.4510%), train_poison_data_count: 2798
Global model norm: 2.524666879416028.
Norm before scaling: 3.408361218127754. Distance: 1.4391528040150716
Total norm for 5 adversaries is: 3.408361218127754. distance: 1.4391528040150716
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.1480, Accuracy: 5726/8991 (63.6859%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0124, Accuracy: 3919/4654 (84.2071%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7769, Accuracy: 7572/10000 (75.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 7, internal_epoch   1,  Average loss: 0.0144, Accuracy: 3175/3839 (82.7038%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.8423, Accuracy: 7732/10000 (77.3200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 8, internal_epoch   1,  Average loss: 0.0113, Accuracy: 2438/2848 (85.6039%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.3431, Accuracy: 5806/10000 (58.0600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 9, internal_epoch   1,  Average loss: 0.0123, Accuracy: 2778/3226 (86.1128%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.0877, Accuracy: 6504/10000 (65.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 10, internal_epoch   1,  Average loss: 0.0124, Accuracy: 4598/5406 (85.0536%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.9754, Accuracy: 6934/10000 (69.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 11, internal_epoch   1,  Average loss: 0.0127, Accuracy: 3682/4481 (82.1692%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.8856, Accuracy: 6872/10000 (68.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 12, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3437/4148 (82.8592%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.0533, Accuracy: 6289/10000 (62.8900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 13, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3882/4495 (86.3626%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.0929, Accuracy: 7249/10000 (72.4900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  22, local model 14, internal_epoch   1,  Average loss: 0.0095, Accuracy: 2941/3330 (88.3183%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 1.7151, Accuracy: 5151/10000 (51.5100%), Attack Success Rate:0/10000(0.000)
time spent on training: 208.89419078826904
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.13852434 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 22: Average loss: 1.1135, Accuracy: 6837/10000 (68.3700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 22: Average loss: 1.0361, Accuracy: 6824/8991 (75.8981%)
Done in 217.58064460754395 sec.
Server Epoch:23 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  23, local model 0, internal_epoch   1,  Average loss: 0.0122, Accuracy: 1535/1784 (86.0426%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.2159, Accuracy: 6027/10000 (60.2700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 1, internal_epoch   1,  Average loss: 0.0094, Accuracy: 5341/6000 (89.0167%), train_poison_data_count: 6000
Global model norm: 2.565411843890172.
Norm before scaling: 3.874831903564823. Distance: 1.8955813928676564
Total norm for 5 adversaries is: 3.874831903564823. distance: 1.8955813928676564
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 1.5022, Accuracy: 5941/8991 (66.0772%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 2, internal_epoch   1,  Average loss: 0.0112, Accuracy: 3002/3457 (86.8383%), train_poison_data_count: 3457
Global model norm: 2.565411843890172.
Norm before scaling: 3.553434113247688. Distance: 1.5535181142870034
Total norm for 5 adversaries is: 3.553434113247688. distance: 1.5535181142870034
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 1.3126, Accuracy: 6030/8991 (67.0671%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 3, internal_epoch   1,  Average loss: 0.0130, Accuracy: 2927/3455 (84.7178%), train_poison_data_count: 3455
Global model norm: 2.565411843890172.
Norm before scaling: 3.597824440668497. Distance: 1.504623044100095
Total norm for 5 adversaries is: 3.597824440668497. distance: 1.504623044100095
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.7187, Accuracy: 7302/8991 (81.2145%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 4, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3867/4644 (83.2687%), train_poison_data_count: 4644
Global model norm: 2.565411843890172.
Norm before scaling: 3.827422533005049. Distance: 1.8744758509120532
Total norm for 5 adversaries is: 3.827422533005049. distance: 1.8744758509120532
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.7382, Accuracy: 7007/8991 (77.9335%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  23, local model 5, internal_epoch   1,  Average loss: 0.0134, Accuracy: 2317/2798 (82.8091%), train_poison_data_count: 2798
Global model norm: 2.565411843890172.
Norm before scaling: 3.4262811867965675. Distance: 1.4027728431077702
Total norm for 5 adversaries is: 3.4262811867965675. distance: 1.4027728431077702
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 1.1102, Accuracy: 5882/8991 (65.4210%)
___Train Local_Simple,  epoch  23, local model 6, internal_epoch   1,  Average loss: 0.0124, Accuracy: 3928/4654 (84.4005%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.7715, Accuracy: 7486/10000 (74.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 7, internal_epoch   1,  Average loss: 0.0143, Accuracy: 3206/3839 (83.5113%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.8613, Accuracy: 7655/10000 (76.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 8, internal_epoch   1,  Average loss: 0.0110, Accuracy: 2449/2848 (85.9902%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.3465, Accuracy: 5800/10000 (58.0000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 9, internal_epoch   1,  Average loss: 0.0120, Accuracy: 2791/3226 (86.5158%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.0311, Accuracy: 6828/10000 (68.2800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   1,  Average loss: 0.0124, Accuracy: 4591/5406 (84.9242%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.9900, Accuracy: 6927/10000 (69.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 11, internal_epoch   1,  Average loss: 0.0127, Accuracy: 3688/4481 (82.3031%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.8932, Accuracy: 6769/10000 (67.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 12, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3427/4148 (82.6181%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.0034, Accuracy: 6621/10000 (66.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 13, internal_epoch   1,  Average loss: 0.0114, Accuracy: 3863/4495 (85.9399%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.0330, Accuracy: 7543/10000 (75.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   1,  Average loss: 0.0091, Accuracy: 2960/3330 (88.8889%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 1.6892, Accuracy: 5305/10000 (53.0500%), Attack Success Rate:0/10000(0.000)
time spent on training: 216.8501193523407
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.4081313
 0.24281059 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 23: Average loss: 1.0916, Accuracy: 6867/10000 (68.6700%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 23: Average loss: 1.0126, Accuracy: 6853/8991 (76.2207%)
Done in 225.53859066963196 sec.
Server Epoch:24 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  24, local model 0, internal_epoch   1,  Average loss: 0.0119, Accuracy: 1535/1784 (86.0426%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.2447, Accuracy: 5931/10000 (59.3100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 1, internal_epoch   1,  Average loss: 0.0091, Accuracy: 5350/6000 (89.1667%), train_poison_data_count: 6000
Global model norm: 2.6095871525025465.
Norm before scaling: 3.892794697311935. Distance: 1.8637851377637782
Total norm for 5 adversaries is: 3.892794697311935. distance: 1.8637851377637782
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 1.4650, Accuracy: 6177/8991 (68.7020%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 2, internal_epoch   1,  Average loss: 0.0109, Accuracy: 3027/3457 (87.5615%), train_poison_data_count: 3457
Global model norm: 2.6095871525025465.
Norm before scaling: 3.572304868821482. Distance: 1.5209549458970606
Total norm for 5 adversaries is: 3.572304868821482. distance: 1.5209549458970606
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 1.2755, Accuracy: 6047/8991 (67.2561%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 3, internal_epoch   1,  Average loss: 0.0129, Accuracy: 2913/3455 (84.3126%), train_poison_data_count: 3455
Global model norm: 2.6095871525025465.
Norm before scaling: 3.6012248710542103. Distance: 1.457605652684914
Total norm for 5 adversaries is: 3.6012248710542103. distance: 1.457605652684914
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.7089, Accuracy: 7352/8991 (81.7707%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 4, internal_epoch   1,  Average loss: 0.0124, Accuracy: 3900/4644 (83.9793%), train_poison_data_count: 4644
Global model norm: 2.6095871525025465.
Norm before scaling: 3.8267537054825356. Distance: 1.8079136008278913
Total norm for 5 adversaries is: 3.8267537054825356. distance: 1.8079136008278913
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.6975, Accuracy: 7218/8991 (80.2803%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  24, local model 5, internal_epoch   1,  Average loss: 0.0134, Accuracy: 2310/2798 (82.5590%), train_poison_data_count: 2798
Global model norm: 2.6095871525025465.
Norm before scaling: 3.465591092025495. Distance: 1.404544898614103
Total norm for 5 adversaries is: 3.465591092025495. distance: 1.404544898614103
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 1.1510, Accuracy: 5628/8991 (62.5959%)
___Train Local_Simple,  epoch  24, local model 6, internal_epoch   1,  Average loss: 0.0123, Accuracy: 3935/4654 (84.5509%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.7681, Accuracy: 7516/10000 (75.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 7, internal_epoch   1,  Average loss: 0.0140, Accuracy: 3193/3839 (83.1727%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.8530, Accuracy: 7640/10000 (76.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 8, internal_epoch   1,  Average loss: 0.0109, Accuracy: 2458/2848 (86.3062%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.3623, Accuracy: 5684/10000 (56.8400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 9, internal_epoch   1,  Average loss: 0.0118, Accuracy: 2790/3226 (86.4848%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.9836, Accuracy: 6970/10000 (69.7000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 10, internal_epoch   1,  Average loss: 0.0123, Accuracy: 4598/5406 (85.0536%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.8923, Accuracy: 7073/10000 (70.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 11, internal_epoch   1,  Average loss: 0.0125, Accuracy: 3687/4481 (82.2807%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.8805, Accuracy: 6888/10000 (68.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   1,  Average loss: 0.0135, Accuracy: 3440/4148 (82.9315%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.0366, Accuracy: 6371/10000 (63.7100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 13, internal_epoch   1,  Average loss: 0.0113, Accuracy: 3890/4495 (86.5406%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.0646, Accuracy: 7346/10000 (73.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  24, local model 14, internal_epoch   1,  Average loss: 0.0090, Accuracy: 2956/3330 (88.7688%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.6958, Accuracy: 5285/10000 (52.8500%), Attack Success Rate:0/10000(0.000)
time spent on training: 204.11465430259705
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.13800611
 0.29857417 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 24: Average loss: 1.0721, Accuracy: 6886/10000 (68.8600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 24: Average loss: 0.9920, Accuracy: 6872/8991 (76.4320%)
Done in 212.07471227645874 sec.
Server Epoch:25 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   1,  Average loss: 0.0117, Accuracy: 1546/1784 (86.6592%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.1932, Accuracy: 6089/10000 (60.8900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 1, internal_epoch   1,  Average loss: 0.0091, Accuracy: 5346/6000 (89.1000%), train_poison_data_count: 6000
Global model norm: 2.651750590948221.
Norm before scaling: 3.9015651838838012. Distance: 1.8188376284329273
Total norm for 5 adversaries is: 3.9015651838838012. distance: 1.8188376284329273
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.4448, Accuracy: 6159/8991 (68.5018%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 2, internal_epoch   1,  Average loss: 0.0109, Accuracy: 3034/3457 (87.7640%), train_poison_data_count: 3457
Global model norm: 2.651750590948221.
Norm before scaling: 3.5995162479899236. Distance: 1.5054684142590926
Total norm for 5 adversaries is: 3.5995162479899236. distance: 1.5054684142590926
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.2562, Accuracy: 6092/8991 (67.7566%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 3, internal_epoch   1,  Average loss: 0.0128, Accuracy: 2940/3455 (85.0941%), train_poison_data_count: 3455
Global model norm: 2.651750590948221.
Norm before scaling: 3.6408200191278515. Distance: 1.4473100210116616
Total norm for 5 adversaries is: 3.6408200191278515. distance: 1.4473100210116616
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.7588, Accuracy: 7050/8991 (78.4117%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3927/4644 (84.5607%), train_poison_data_count: 4644
Global model norm: 2.651750590948221.
Norm before scaling: 3.8622328335604426. Distance: 1.8080134274355464
Total norm for 5 adversaries is: 3.8622328335604426. distance: 1.8080134274355464
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.7345, Accuracy: 6986/8991 (77.6999%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  25, local model 5, internal_epoch   1,  Average loss: 0.0132, Accuracy: 2326/2798 (83.1308%), train_poison_data_count: 2798
Global model norm: 2.651750590948221.
Norm before scaling: 3.470366230307824. Distance: 1.343597314720957
Total norm for 5 adversaries is: 3.470366230307824. distance: 1.343597314720957
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.0641, Accuracy: 5938/8991 (66.0438%)
___Train Local_Simple,  epoch  25, local model 6, internal_epoch   1,  Average loss: 0.0122, Accuracy: 3934/4654 (84.5294%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.7558, Accuracy: 7553/10000 (75.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 7, internal_epoch   1,  Average loss: 0.0139, Accuracy: 3206/3839 (83.5113%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.8491, Accuracy: 7699/10000 (76.9900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 8, internal_epoch   1,  Average loss: 0.0109, Accuracy: 2448/2848 (85.9551%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.2881, Accuracy: 5867/10000 (58.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 9, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2802/3226 (86.8568%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.9882, Accuracy: 6878/10000 (68.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 10, internal_epoch   1,  Average loss: 0.0121, Accuracy: 4601/5406 (85.1091%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.9437, Accuracy: 6937/10000 (69.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 11, internal_epoch   1,  Average loss: 0.0124, Accuracy: 3720/4481 (83.0172%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.8935, Accuracy: 6748/10000 (67.4800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 12, internal_epoch   1,  Average loss: 0.0134, Accuracy: 3448/4148 (83.1244%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.9799, Accuracy: 6646/10000 (66.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 13, internal_epoch   1,  Average loss: 0.0111, Accuracy: 3890/4495 (86.5406%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.0221, Accuracy: 7537/10000 (75.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  25, local model 14, internal_epoch   1,  Average loss: 0.0091, Accuracy: 2957/3330 (88.7988%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 1.6468, Accuracy: 5347/10000 (53.4700%), Attack Success Rate:0/10000(0.000)
time spent on training: 203.1363627910614
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.05131661 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 25: Average loss: 1.0548, Accuracy: 6916/10000 (69.1600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 25: Average loss: 0.9734, Accuracy: 6904/8991 (76.7879%)
Done in 210.96672654151917 sec.
Server Epoch:26 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  26, local model 0, internal_epoch   1,  Average loss: 0.0117, Accuracy: 1539/1784 (86.2668%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.1564, Accuracy: 6134/10000 (61.3400%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 1, internal_epoch   1,  Average loss: 0.0090, Accuracy: 5352/6000 (89.2000%), train_poison_data_count: 6000
Global model norm: 2.6907318554792523.
Norm before scaling: 3.9142695998416026. Distance: 1.7886493988857626
Total norm for 5 adversaries is: 3.9142695998416026. distance: 1.7886493988857626
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.4453, Accuracy: 6171/8991 (68.6353%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 2, internal_epoch   1,  Average loss: 0.0108, Accuracy: 3019/3457 (87.3301%), train_poison_data_count: 3457
Global model norm: 2.6907318554792523.
Norm before scaling: 3.60510119778922. Distance: 1.457401668313418
Total norm for 5 adversaries is: 3.60510119778922. distance: 1.457401668313418
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.2344, Accuracy: 6123/8991 (68.1014%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 3, internal_epoch   1,  Average loss: 0.0126, Accuracy: 2934/3455 (84.9204%), train_poison_data_count: 3455
Global model norm: 2.6907318554792523.
Norm before scaling: 3.6485185307851213. Distance: 1.4031904634357166
Total norm for 5 adversaries is: 3.6485185307851213. distance: 1.4031904634357166
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.7061, Accuracy: 7319/8991 (81.4036%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 4, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3918/4644 (84.3669%), train_poison_data_count: 4644
Global model norm: 2.6907318554792523.
Norm before scaling: 3.8681464345328576. Distance: 1.7616924275463899
Total norm for 5 adversaries is: 3.8681464345328576. distance: 1.7616924275463899
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.7236, Accuracy: 7032/8991 (78.2115%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  26, local model 5, internal_epoch   1,  Average loss: 0.0130, Accuracy: 2314/2798 (82.7019%), train_poison_data_count: 2798
Global model norm: 2.6907318554792523.
Norm before scaling: 3.499112016566486. Distance: 1.3387766333743705
Total norm for 5 adversaries is: 3.499112016566486. distance: 1.3387766333743705
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.1079, Accuracy: 5758/8991 (64.0418%)
___Train Local_Simple,  epoch  26, local model 6, internal_epoch   1,  Average loss: 0.0119, Accuracy: 3962/4654 (85.1311%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7573, Accuracy: 7575/10000 (75.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 7, internal_epoch   1,  Average loss: 0.0138, Accuracy: 3228/3839 (84.0844%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.8179, Accuracy: 7747/10000 (77.4700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   1,  Average loss: 0.0106, Accuracy: 2451/2848 (86.0604%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.3546, Accuracy: 5686/10000 (56.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 9, internal_epoch   1,  Average loss: 0.0115, Accuracy: 2808/3226 (87.0428%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.9885, Accuracy: 6882/10000 (68.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 10, internal_epoch   1,  Average loss: 0.0120, Accuracy: 4607/5406 (85.2201%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.9868, Accuracy: 6880/10000 (68.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 11, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3734/4481 (83.3296%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.9070, Accuracy: 6673/10000 (66.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   1,  Average loss: 0.0133, Accuracy: 3471/4148 (83.6789%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.0196, Accuracy: 6422/10000 (64.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 13, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3888/4495 (86.4961%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.0254, Accuracy: 7408/10000 (74.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  26, local model 14, internal_epoch   1,  Average loss: 0.0090, Accuracy: 2934/3330 (88.1081%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 1.5900, Accuracy: 5550/10000 (55.5000%), Attack Success Rate:0/10000(0.000)
time spent on training: 210.7261517047882
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.16203105 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 26: Average loss: 1.0381, Accuracy: 6943/10000 (69.4300%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 26: Average loss: 0.9559, Accuracy: 6931/8991 (77.0882%)
Done in 218.5063705444336 sec.
Server Epoch:27 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  27, local model 0, internal_epoch   1,  Average loss: 0.0113, Accuracy: 1554/1784 (87.1076%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.1590, Accuracy: 6223/10000 (62.2300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 1, internal_epoch   1,  Average loss: 0.0089, Accuracy: 5350/6000 (89.1667%), train_poison_data_count: 6000
Global model norm: 2.7300547448283012.
Norm before scaling: 3.9194855116877987. Distance: 1.7389656005624652
Total norm for 5 adversaries is: 3.9194855116877987. distance: 1.7389656005624652
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 1.3701, Accuracy: 6198/8991 (68.9356%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 2, internal_epoch   1,  Average loss: 0.0107, Accuracy: 3033/3457 (87.7350%), train_poison_data_count: 3457
Global model norm: 2.7300547448283012.
Norm before scaling: 3.636428968969737. Distance: 1.4500503827253786
Total norm for 5 adversaries is: 3.636428968969737. distance: 1.4500503827253786
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 1.2204, Accuracy: 6072/8991 (67.5342%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 3, internal_epoch   1,  Average loss: 0.0124, Accuracy: 2940/3455 (85.0941%), train_poison_data_count: 3455
Global model norm: 2.7300547448283012.
Norm before scaling: 3.6604333404236526. Distance: 1.3711208329962945
Total norm for 5 adversaries is: 3.6604333404236526. distance: 1.3711208329962945
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.7105, Accuracy: 7278/8991 (80.9476%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 4, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3923/4644 (84.4746%), train_poison_data_count: 4644
Global model norm: 2.7300547448283012.
Norm before scaling: 3.8912877510315433. Distance: 1.743959355519392
Total norm for 5 adversaries is: 3.8912877510315433. distance: 1.743959355519392
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.7039, Accuracy: 7137/8991 (79.3794%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  27, local model 5, internal_epoch   1,  Average loss: 0.0128, Accuracy: 2306/2798 (82.4160%), train_poison_data_count: 2798
Global model norm: 2.7300547448283012.
Norm before scaling: 3.507508670418233. Distance: 1.3067240552966717
Total norm for 5 adversaries is: 3.507508670418233. distance: 1.3067240552966717
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 1.0878, Accuracy: 5891/8991 (65.5211%)
___Train Local_Simple,  epoch  27, local model 6, internal_epoch   1,  Average loss: 0.0118, Accuracy: 3954/4654 (84.9592%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.7508, Accuracy: 7579/10000 (75.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 7, internal_epoch   1,  Average loss: 0.0137, Accuracy: 3196/3839 (83.2508%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.8355, Accuracy: 7711/10000 (77.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 8, internal_epoch   1,  Average loss: 0.0109, Accuracy: 2431/2848 (85.3581%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.2361, Accuracy: 5940/10000 (59.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 9, internal_epoch   1,  Average loss: 0.0114, Accuracy: 2788/3226 (86.4228%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.9516, Accuracy: 7111/10000 (71.1100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   1,  Average loss: 0.0120, Accuracy: 4611/5406 (85.2941%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.9129, Accuracy: 6979/10000 (69.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 11, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3723/4481 (83.0841%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.8341, Accuracy: 7186/10000 (71.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 12, internal_epoch   1,  Average loss: 0.0131, Accuracy: 3478/4148 (83.8476%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.9461, Accuracy: 6698/10000 (66.9800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 13, internal_epoch   1,  Average loss: 0.0109, Accuracy: 3897/4495 (86.6963%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.0221, Accuracy: 7461/10000 (74.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  27, local model 14, internal_epoch   1,  Average loss: 0.0088, Accuracy: 2964/3330 (89.0090%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 1.6148, Accuracy: 5485/10000 (54.8500%), Attack Success Rate:0/10000(0.000)
time spent on training: 215.83911037445068
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.38123311 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 27: Average loss: 1.0211, Accuracy: 6966/10000 (69.6600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 27: Average loss: 0.9377, Accuracy: 6950/8991 (77.2995%)
Done in 223.5750663280487 sec.
Server Epoch:28 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  28, local model 0, internal_epoch   1,  Average loss: 0.0111, Accuracy: 1557/1784 (87.2758%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.1704, Accuracy: 6129/10000 (61.2900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 1, internal_epoch   1,  Average loss: 0.0088, Accuracy: 5370/6000 (89.5000%), train_poison_data_count: 6000
Global model norm: 2.770237583754646.
Norm before scaling: 3.9408936181354157. Distance: 1.718954733012335
Total norm for 5 adversaries is: 3.9408936181354157. distance: 1.718954733012335
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.4168, Accuracy: 6155/8991 (68.4573%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 2, internal_epoch   1,  Average loss: 0.0107, Accuracy: 3023/3457 (87.4458%), train_poison_data_count: 3457
Global model norm: 2.770237583754646.
Norm before scaling: 3.644838440798369. Distance: 1.4119229648745835
Total norm for 5 adversaries is: 3.644838440798369. distance: 1.4119229648745835
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.2320, Accuracy: 6093/8991 (67.7678%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 3, internal_epoch   1,  Average loss: 0.0122, Accuracy: 2947/3455 (85.2967%), train_poison_data_count: 3455
Global model norm: 2.770237583754646.
Norm before scaling: 3.668855375112076. Distance: 1.3333163955725267
Total norm for 5 adversaries is: 3.668855375112076. distance: 1.3333163955725267
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.6866, Accuracy: 7428/8991 (82.6159%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 4, internal_epoch   1,  Average loss: 0.0118, Accuracy: 3933/4644 (84.6899%), train_poison_data_count: 4644
Global model norm: 2.770237583754646.
Norm before scaling: 3.9044993635742045. Distance: 1.7005911360302277
Total norm for 5 adversaries is: 3.9044993635742045. distance: 1.7005911360302277
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.6675, Accuracy: 7334/8991 (81.5705%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  28, local model 5, internal_epoch   1,  Average loss: 0.0128, Accuracy: 2327/2798 (83.1665%), train_poison_data_count: 2798
Global model norm: 2.770237583754646.
Norm before scaling: 3.538487671911895. Distance: 1.28665972946616
Total norm for 5 adversaries is: 3.538487671911895. distance: 1.28665972946616
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.0501, Accuracy: 6016/8991 (66.9114%)
___Train Local_Simple,  epoch  28, local model 6, internal_epoch   1,  Average loss: 0.0117, Accuracy: 3964/4654 (85.1740%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.7441, Accuracy: 7627/10000 (76.2700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 7, internal_epoch   1,  Average loss: 0.0134, Accuracy: 3234/3839 (84.2407%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.8242, Accuracy: 7703/10000 (77.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 8, internal_epoch   1,  Average loss: 0.0103, Accuracy: 2464/2848 (86.5169%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.2658, Accuracy: 5812/10000 (58.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 9, internal_epoch   1,  Average loss: 0.0112, Accuracy: 2795/3226 (86.6398%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.9604, Accuracy: 6995/10000 (69.9500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 10, internal_epoch   1,  Average loss: 0.0118, Accuracy: 4640/5406 (85.8306%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.9131, Accuracy: 6954/10000 (69.5400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 11, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3695/4481 (82.4593%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.8694, Accuracy: 6907/10000 (69.0700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 12, internal_epoch   1,  Average loss: 0.0131, Accuracy: 3466/4148 (83.5583%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.0179, Accuracy: 6361/10000 (63.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 13, internal_epoch   1,  Average loss: 0.0108, Accuracy: 3898/4495 (86.7186%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.0194, Accuracy: 7521/10000 (75.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  28, local model 14, internal_epoch   1,  Average loss: 0.0087, Accuracy: 2968/3330 (89.1291%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.5038, Accuracy: 5710/10000 (57.1000%), Attack Success Rate:0/10000(0.000)
time spent on training: 252.367901802063
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.46812023 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 28: Average loss: 1.0050, Accuracy: 7005/10000 (70.0500%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 28: Average loss: 0.9203, Accuracy: 6988/8991 (77.7222%)
Done in 261.35077357292175 sec.
Server Epoch:29 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  29, local model 0, internal_epoch   1,  Average loss: 0.0110, Accuracy: 1555/1784 (87.1637%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.1226, Accuracy: 6230/10000 (62.3000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 1, internal_epoch   1,  Average loss: 0.0088, Accuracy: 5377/6000 (89.6167%), train_poison_data_count: 6000
Global model norm: 2.810577243961621.
Norm before scaling: 3.9658240398360345. Distance: 1.7035286101415141
Total norm for 5 adversaries is: 3.9658240398360345. distance: 1.7035286101415141
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 1.3944, Accuracy: 6181/8991 (68.7465%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 2, internal_epoch   1,  Average loss: 0.0106, Accuracy: 3032/3457 (87.7061%), train_poison_data_count: 3457
Global model norm: 2.810577243961621.
Norm before scaling: 3.6725893015745106. Distance: 1.3951082291543109
Total norm for 5 adversaries is: 3.6725893015745106. distance: 1.3951082291543109
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 1.2044, Accuracy: 6182/8991 (68.7576%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 3, internal_epoch   1,  Average loss: 0.0121, Accuracy: 2963/3455 (85.7598%), train_poison_data_count: 3455
Global model norm: 2.810577243961621.
Norm before scaling: 3.69745082159655. Distance: 1.3130262319031916
Total norm for 5 adversaries is: 3.69745082159655. distance: 1.3130262319031916
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.6794, Accuracy: 7413/8991 (82.4491%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 4, internal_epoch   1,  Average loss: 0.0117, Accuracy: 3933/4644 (84.6899%), train_poison_data_count: 4644
Global model norm: 2.810577243961621.
Norm before scaling: 3.9174103267608937. Distance: 1.6772052965380324
Total norm for 5 adversaries is: 3.9174103267608937. distance: 1.6772052965380324
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.7200, Accuracy: 7024/8991 (78.1226%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  29, local model 5, internal_epoch   1,  Average loss: 0.0128, Accuracy: 2328/2798 (83.2023%), train_poison_data_count: 2798
Global model norm: 2.810577243961621.
Norm before scaling: 3.562242331304949. Distance: 1.2652933604572787
Total norm for 5 adversaries is: 3.562242331304949. distance: 1.2652933604572787
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 1.0350, Accuracy: 5979/8991 (66.4998%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3966/4654 (85.2170%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.7366, Accuracy: 7624/10000 (76.2400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 7, internal_epoch   1,  Average loss: 0.0133, Accuracy: 3237/3839 (84.3188%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.8026, Accuracy: 7763/10000 (77.6300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   1,  Average loss: 0.0103, Accuracy: 2460/2848 (86.3764%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.3028, Accuracy: 5750/10000 (57.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 9, internal_epoch   1,  Average loss: 0.0112, Accuracy: 2792/3226 (86.5468%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.9467, Accuracy: 7110/10000 (71.1000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 10, internal_epoch   1,  Average loss: 0.0118, Accuracy: 4615/5406 (85.3681%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.9405, Accuracy: 6893/10000 (68.9300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 11, internal_epoch   1,  Average loss: 0.0119, Accuracy: 3718/4481 (82.9726%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.8862, Accuracy: 6825/10000 (68.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 12, internal_epoch   1,  Average loss: 0.0129, Accuracy: 3469/4148 (83.6307%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.9397, Accuracy: 6774/10000 (67.7400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 13, internal_epoch   1,  Average loss: 0.0107, Accuracy: 3901/4495 (86.7853%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.0566, Accuracy: 7325/10000 (73.2500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  29, local model 14, internal_epoch   1,  Average loss: 0.0087, Accuracy: 2971/3330 (89.2192%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 1.5290, Accuracy: 5547/10000 (55.4700%), Attack Success Rate:0/10000(0.000)
time spent on training: 265.6044840812683
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [0.88372861 1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.33675386 0.88372861 1.        ]
___Test Target_Simple poisoned: False, epoch: 29: Average loss: 0.9907, Accuracy: 7020/10000 (70.2000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 29: Average loss: 0.9056, Accuracy: 7001/8991 (77.8668%)
Done in 274.4246287345886 sec.
Server Epoch:30 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  30, local model 0, internal_epoch   1,  Average loss: 0.0109, Accuracy: 1556/1784 (87.2197%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.0935, Accuracy: 6390/10000 (63.9000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 1, internal_epoch   1,  Average loss: 0.0087, Accuracy: 5388/6000 (89.8000%), train_poison_data_count: 6000
Global model norm: 2.848431433306588.
Norm before scaling: 3.9690755875767167. Distance: 1.663802578823963
Total norm for 5 adversaries is: 3.9690755875767167. distance: 1.663802578823963
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.3922, Accuracy: 6193/8991 (68.8800%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 2, internal_epoch   1,  Average loss: 0.0103, Accuracy: 3050/3457 (88.2268%), train_poison_data_count: 3457
Global model norm: 2.848431433306588.
Norm before scaling: 3.6811339173853224. Distance: 1.3618408288472021
Total norm for 5 adversaries is: 3.6811339173853224. distance: 1.3618408288472021
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.1783, Accuracy: 6151/8991 (68.4129%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 3, internal_epoch   1,  Average loss: 0.0120, Accuracy: 2960/3455 (85.6729%), train_poison_data_count: 3455
Global model norm: 2.848431433306588.
Norm before scaling: 3.7197115640695917. Distance: 1.3022900328287483
Total norm for 5 adversaries is: 3.7197115640695917. distance: 1.3022900328287483
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.6938, Accuracy: 7356/8991 (81.8151%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 4, internal_epoch   1,  Average loss: 0.0117, Accuracy: 3921/4644 (84.4315%), train_poison_data_count: 4644
Global model norm: 2.848431433306588.
Norm before scaling: 3.9341447855260037. Distance: 1.6438605238739976
Total norm for 5 adversaries is: 3.9341447855260037. distance: 1.6438605238739976
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.6665, Accuracy: 7313/8991 (81.3369%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  30, local model 5, internal_epoch   1,  Average loss: 0.0125, Accuracy: 2331/2798 (83.3095%), train_poison_data_count: 2798
Global model norm: 2.848431433306588.
Norm before scaling: 3.5803045439517303. Distance: 1.2461746333069426
Total norm for 5 adversaries is: 3.5803045439517303. distance: 1.2461746333069426
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.0275, Accuracy: 6012/8991 (66.8669%)
___Train Local_Simple,  epoch  30, local model 6, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3964/4654 (85.1740%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.7336, Accuracy: 7638/10000 (76.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 7, internal_epoch   1,  Average loss: 0.0132, Accuracy: 3223/3839 (83.9542%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.8051, Accuracy: 7830/10000 (78.3000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 8, internal_epoch   1,  Average loss: 0.0101, Accuracy: 2464/2848 (86.5169%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.2132, Accuracy: 5969/10000 (59.6900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 9, internal_epoch   1,  Average loss: 0.0108, Accuracy: 2821/3226 (87.4458%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.9421, Accuracy: 7277/10000 (72.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 10, internal_epoch   1,  Average loss: 0.0116, Accuracy: 4609/5406 (85.2571%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.8553, Accuracy: 7086/10000 (70.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0117, Accuracy: 3757/4481 (83.8429%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.8359, Accuracy: 7088/10000 (70.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 12, internal_epoch   1,  Average loss: 0.0128, Accuracy: 3472/4148 (83.7030%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.9066, Accuracy: 6855/10000 (68.5500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 13, internal_epoch   1,  Average loss: 0.0106, Accuracy: 3917/4495 (87.1413%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.9592, Accuracy: 7678/10000 (76.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  30, local model 14, internal_epoch   1,  Average loss: 0.0085, Accuracy: 2960/3330 (88.8889%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 1.5335, Accuracy: 5539/10000 (55.3900%), Attack Success Rate:0/10000(0.000)
time spent on training: 272.86543130874634
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.15839004
 0.49557818 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 30: Average loss: 0.9751, Accuracy: 7058/10000 (70.5800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 30: Average loss: 0.8896, Accuracy: 7037/8991 (78.2672%)
Done in 281.8409614562988 sec.
Server Epoch:31 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  31, local model 0, internal_epoch   1,  Average loss: 0.0105, Accuracy: 1560/1784 (87.4439%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.1314, Accuracy: 6259/10000 (62.5900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 1, internal_epoch   1,  Average loss: 0.0086, Accuracy: 5356/6000 (89.2667%), train_poison_data_count: 6000
Global model norm: 2.8888668177650025.
Norm before scaling: 3.9787857645616356. Distance: 1.6254690667045482
Total norm for 5 adversaries is: 3.9787857645616356. distance: 1.6254690667045482
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.3554, Accuracy: 6169/8991 (68.6131%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 2, internal_epoch   1,  Average loss: 0.0101, Accuracy: 3047/3457 (88.1400%), train_poison_data_count: 3457
Global model norm: 2.8888668177650025.
Norm before scaling: 3.702872223415479. Distance: 1.340614919913572
Total norm for 5 adversaries is: 3.702872223415479. distance: 1.340614919913572
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.1870, Accuracy: 6152/8991 (68.4240%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 3, internal_epoch   1,  Average loss: 0.0118, Accuracy: 2980/3455 (86.2518%), train_poison_data_count: 3455
Global model norm: 2.8888668177650025.
Norm before scaling: 3.7380865957190887. Distance: 1.2678861787414721
Total norm for 5 adversaries is: 3.7380865957190887. distance: 1.2678861787414721
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.6757, Accuracy: 7409/8991 (82.4046%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 4, internal_epoch   1,  Average loss: 0.0116, Accuracy: 3944/4644 (84.9268%), train_poison_data_count: 4644
Global model norm: 2.8888668177650025.
Norm before scaling: 3.9479624696085938. Distance: 1.6135323169782965
Total norm for 5 adversaries is: 3.9479624696085938. distance: 1.6135323169782965
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.6649, Accuracy: 7343/8991 (81.6706%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  31, local model 5, internal_epoch   1,  Average loss: 0.0121, Accuracy: 2345/2798 (83.8099%), train_poison_data_count: 2798
Global model norm: 2.8888668177650025.
Norm before scaling: 3.6148585820269927. Distance: 1.2564908304483293
Total norm for 5 adversaries is: 3.6148585820269927. distance: 1.2564908304483293
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.0919, Accuracy: 5829/8991 (64.8315%)
___Train Local_Simple,  epoch  31, local model 6, internal_epoch   1,  Average loss: 0.0113, Accuracy: 3980/4654 (85.5178%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.7137, Accuracy: 7737/10000 (77.3700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 7, internal_epoch   1,  Average loss: 0.0130, Accuracy: 3226/3839 (84.0323%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.8273, Accuracy: 7702/10000 (77.0200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 8, internal_epoch   1,  Average loss: 0.0100, Accuracy: 2473/2848 (86.8329%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.2319, Accuracy: 5787/10000 (57.8700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 9, internal_epoch   1,  Average loss: 0.0108, Accuracy: 2826/3226 (87.6007%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.9487, Accuracy: 7068/10000 (70.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 10, internal_epoch   1,  Average loss: 0.0116, Accuracy: 4624/5406 (85.5346%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.9292, Accuracy: 6905/10000 (69.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 11, internal_epoch   1,  Average loss: 0.0117, Accuracy: 3759/4481 (83.8875%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.8463, Accuracy: 7016/10000 (70.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0127, Accuracy: 3481/4148 (83.9200%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.9673, Accuracy: 6738/10000 (67.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 13, internal_epoch   1,  Average loss: 0.0105, Accuracy: 3915/4495 (87.0968%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.9756, Accuracy: 7596/10000 (75.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  31, local model 14, internal_epoch   1,  Average loss: 0.0083, Accuracy: 2983/3330 (89.5796%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 1.5071, Accuracy: 5583/10000 (55.8300%), Attack Success Rate:0/10000(0.000)
time spent on training: 265.826544046402
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.23017049 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 31: Average loss: 0.9619, Accuracy: 7076/10000 (70.7600%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 31: Average loss: 0.8763, Accuracy: 7054/8991 (78.4562%)
Done in 273.7806794643402 sec.
Server Epoch:32 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  32, local model 0, internal_epoch   1,  Average loss: 0.0104, Accuracy: 1574/1784 (88.2287%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.1138, Accuracy: 6249/10000 (62.4900%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 1, internal_epoch   1,  Average loss: 0.0085, Accuracy: 5387/6000 (89.7833%), train_poison_data_count: 6000
Global model norm: 2.9260271730445395.
Norm before scaling: 4.004715286021558. Distance: 1.6122089359864422
Total norm for 5 adversaries is: 4.004715286021558. distance: 1.6122089359864422
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 1.3619, Accuracy: 6179/8991 (68.7243%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 2, internal_epoch   1,  Average loss: 0.0100, Accuracy: 3052/3457 (88.2846%), train_poison_data_count: 3457
Global model norm: 2.9260271730445395.
Norm before scaling: 3.720307608981324. Distance: 1.320798615120682
Total norm for 5 adversaries is: 3.720307608981324. distance: 1.320798615120682
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 1.1528, Accuracy: 6167/8991 (68.5908%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 3, internal_epoch   1,  Average loss: 0.0118, Accuracy: 2977/3455 (86.1650%), train_poison_data_count: 3455
Global model norm: 2.9260271730445395.
Norm before scaling: 3.7548891620557496. Distance: 1.2411761695440313
Total norm for 5 adversaries is: 3.7548891620557496. distance: 1.2411761695440313
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.6477, Accuracy: 7531/8991 (83.7615%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 4, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3981/4644 (85.7235%), train_poison_data_count: 4644
Global model norm: 2.9260271730445395.
Norm before scaling: 3.9746968327678216. Distance: 1.5946858220406477
Total norm for 5 adversaries is: 3.9746968327678216. distance: 1.5946858220406477
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.6565, Accuracy: 7322/8991 (81.4370%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  32, local model 5, internal_epoch   1,  Average loss: 0.0122, Accuracy: 2332/2798 (83.3452%), train_poison_data_count: 2798
Global model norm: 2.9260271730445395.
Norm before scaling: 3.6256589619440485. Distance: 1.206757103857386
Total norm for 5 adversaries is: 3.6256589619440485. distance: 1.206757103857386
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.9859, Accuracy: 6229/8991 (69.2804%)
___Train Local_Simple,  epoch  32, local model 6, internal_epoch   1,  Average loss: 0.0113, Accuracy: 3990/4654 (85.7327%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.7083, Accuracy: 7753/10000 (77.5300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 7, internal_epoch   1,  Average loss: 0.0131, Accuracy: 3238/3839 (84.3449%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.7801, Accuracy: 7788/10000 (77.8800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   1,  Average loss: 0.0103, Accuracy: 2451/2848 (86.0604%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.1887, Accuracy: 5961/10000 (59.6100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 9, internal_epoch   1,  Average loss: 0.0107, Accuracy: 2811/3226 (87.1358%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9098, Accuracy: 7192/10000 (71.9200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 10, internal_epoch   1,  Average loss: 0.0114, Accuracy: 4646/5406 (85.9415%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.8724, Accuracy: 7068/10000 (70.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 11, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3773/4481 (84.2000%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.8182, Accuracy: 7250/10000 (72.5000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 12, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3480/4148 (83.8959%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9390, Accuracy: 6746/10000 (67.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 13, internal_epoch   1,  Average loss: 0.0105, Accuracy: 3899/4495 (86.7408%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.9892, Accuracy: 7486/10000 (74.8600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  32, local model 14, internal_epoch   1,  Average loss: 0.0083, Accuracy: 2972/3330 (89.2492%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 1.4573, Accuracy: 5811/10000 (58.1100%), Attack Success Rate:0/10000(0.000)
time spent on training: 251.15251326560974
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.05493329
 0.01938737 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 32: Average loss: 0.9501, Accuracy: 7090/10000 (70.9000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 32: Average loss: 0.8638, Accuracy: 7068/8991 (78.6119%)
Done in 259.0039703845978 sec.
Server Epoch:33 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  33, local model 0, internal_epoch   1,  Average loss: 0.0103, Accuracy: 1557/1784 (87.2758%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.1059, Accuracy: 6261/10000 (62.6100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 1, internal_epoch   1,  Average loss: 0.0085, Accuracy: 5402/6000 (90.0333%), train_poison_data_count: 6000
Global model norm: 2.961905691032515.
Norm before scaling: 4.029861565950207. Distance: 1.598564356210298
Total norm for 5 adversaries is: 4.029861565950207. distance: 1.598564356210298
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 1.3623, Accuracy: 6143/8991 (68.3239%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 2, internal_epoch   1,  Average loss: 0.0100, Accuracy: 3064/3457 (88.6318%), train_poison_data_count: 3457
Global model norm: 2.961905691032515.
Norm before scaling: 3.748153740659933. Distance: 1.3070755991505756
Total norm for 5 adversaries is: 3.748153740659933. distance: 1.3070755991505756
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 1.1629, Accuracy: 6146/8991 (68.3572%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 3, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2988/3455 (86.4834%), train_poison_data_count: 3455
Global model norm: 2.961905691032515.
Norm before scaling: 3.783232366304133. Distance: 1.2421287666686736
Total norm for 5 adversaries is: 3.783232366304133. distance: 1.2421287666686736
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.7154, Accuracy: 7180/8991 (79.8576%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 4, internal_epoch   1,  Average loss: 0.0113, Accuracy: 3980/4644 (85.7020%), train_poison_data_count: 4644
Global model norm: 2.961905691032515.
Norm before scaling: 3.9896296539140854. Distance: 1.5812335228344203
Total norm for 5 adversaries is: 3.9896296539140854. distance: 1.5812335228344203
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.6837, Accuracy: 7174/8991 (79.7909%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  33, local model 5, internal_epoch   1,  Average loss: 0.0120, Accuracy: 2343/2798 (83.7384%), train_poison_data_count: 2798
Global model norm: 2.961905691032515.
Norm before scaling: 3.648289940931645. Distance: 1.1953505965002347
Total norm for 5 adversaries is: 3.648289940931645. distance: 1.1953505965002347
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 1.0010, Accuracy: 6142/8991 (68.3128%)
___Train Local_Simple,  epoch  33, local model 6, internal_epoch   1,  Average loss: 0.0111, Accuracy: 3979/4654 (85.4963%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.7010, Accuracy: 7882/10000 (78.8200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 7, internal_epoch   1,  Average loss: 0.0129, Accuracy: 3218/3839 (83.8239%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.8165, Accuracy: 7656/10000 (76.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 8, internal_epoch   1,  Average loss: 0.0098, Accuracy: 2484/2848 (87.2191%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.1643, Accuracy: 6021/10000 (60.2100%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 9, internal_epoch   1,  Average loss: 0.0106, Accuracy: 2833/3226 (87.8177%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.9400, Accuracy: 7013/10000 (70.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 10, internal_epoch   1,  Average loss: 0.0113, Accuracy: 4648/5406 (85.9785%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.9230, Accuracy: 6977/10000 (69.7700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 11, internal_epoch   1,  Average loss: 0.0114, Accuracy: 3777/4481 (84.2892%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.8086, Accuracy: 7256/10000 (72.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 12, internal_epoch   1,  Average loss: 0.0125, Accuracy: 3496/4148 (84.2816%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.9323, Accuracy: 6746/10000 (67.4600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 13, internal_epoch   1,  Average loss: 0.0103, Accuracy: 3939/4495 (87.6307%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.9853, Accuracy: 7526/10000 (75.2600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  33, local model 14, internal_epoch   1,  Average loss: 0.0082, Accuracy: 2980/3330 (89.4895%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 1.4968, Accuracy: 5641/10000 (56.4100%), Attack Success Rate:0/10000(0.000)
time spent on training: 273.8595895767212
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.31501936 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 33: Average loss: 0.9386, Accuracy: 7099/10000 (70.9900%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 33: Average loss: 0.8519, Accuracy: 7076/8991 (78.7009%)
Done in 282.5940034389496 sec.
Server Epoch:34 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  34, local model 0, internal_epoch   1,  Average loss: 0.0101, Accuracy: 1573/1784 (88.1726%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.0698, Accuracy: 6421/10000 (64.2100%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 1, internal_epoch   1,  Average loss: 0.0084, Accuracy: 5378/6000 (89.6333%), train_poison_data_count: 6000
Global model norm: 2.998946004729366.
Norm before scaling: 4.036762106344967. Distance: 1.5630216872015805
Total norm for 5 adversaries is: 4.036762106344967. distance: 1.5630216872015805
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1.3279, Accuracy: 6226/8991 (69.2470%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 2, internal_epoch   1,  Average loss: 0.0098, Accuracy: 3051/3457 (88.2557%), train_poison_data_count: 3457
Global model norm: 2.998946004729366.
Norm before scaling: 3.7587805629206965. Distance: 1.2835037599247725
Total norm for 5 adversaries is: 3.7587805629206965. distance: 1.2835037599247725
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1.1713, Accuracy: 6106/8991 (67.9124%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 3, internal_epoch   1,  Average loss: 0.0115, Accuracy: 2990/3455 (86.5412%), train_poison_data_count: 3455
Global model norm: 2.998946004729366.
Norm before scaling: 3.790307035263743. Distance: 1.1956121530356114
Total norm for 5 adversaries is: 3.790307035263743. distance: 1.1956121530356114
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.6446, Accuracy: 7531/8991 (83.7615%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 4, internal_epoch   1,  Average loss: 0.0113, Accuracy: 3947/4644 (84.9914%), train_poison_data_count: 4644
Global model norm: 2.998946004729366.
Norm before scaling: 4.00895998703059. Distance: 1.5639098101463047
Total norm for 5 adversaries is: 4.00895998703059. distance: 1.5639098101463047
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 0.6811, Accuracy: 7179/8991 (79.8465%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  34, local model 5, internal_epoch   1,  Average loss: 0.0121, Accuracy: 2353/2798 (84.0958%), train_poison_data_count: 2798
Global model norm: 2.998946004729366.
Norm before scaling: 3.6792420848635063. Distance: 1.2100987144273612
Total norm for 5 adversaries is: 3.6792420848635063. distance: 1.2100987144273612
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1.0296, Accuracy: 6167/8991 (68.5908%)
___Train Local_Simple,  epoch  34, local model 6, internal_epoch   1,  Average loss: 0.0112, Accuracy: 4005/4654 (86.0550%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.7282, Accuracy: 7658/10000 (76.5800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 7, internal_epoch   1,  Average loss: 0.0127, Accuracy: 3260/3839 (84.9179%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.8278, Accuracy: 7579/10000 (75.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 8, internal_epoch   1,  Average loss: 0.0099, Accuracy: 2473/2848 (86.8329%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.1610, Accuracy: 5934/10000 (59.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 9, internal_epoch   1,  Average loss: 0.0105, Accuracy: 2809/3226 (87.0738%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.8986, Accuracy: 7252/10000 (72.5200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 10, internal_epoch   1,  Average loss: 0.0113, Accuracy: 4646/5406 (85.9415%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.8683, Accuracy: 7078/10000 (70.7800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 11, internal_epoch   1,  Average loss: 0.0115, Accuracy: 3737/4481 (83.3966%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.7662, Accuracy: 7508/10000 (75.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 12, internal_epoch   1,  Average loss: 0.0124, Accuracy: 3480/4148 (83.8959%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.9187, Accuracy: 6867/10000 (68.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 13, internal_epoch   1,  Average loss: 0.0101, Accuracy: 3946/4495 (87.7864%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.9950, Accuracy: 7496/10000 (74.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  34, local model 14, internal_epoch   1,  Average loss: 0.0082, Accuracy: 2972/3330 (89.2492%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 1.5141, Accuracy: 5640/10000 (56.4000%), Attack Success Rate:0/10000(0.000)
time spent on training: 280.3970832824707
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.17597021 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 34: Average loss: 0.9278, Accuracy: 7112/10000 (71.1200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 34: Average loss: 0.8404, Accuracy: 7088/8991 (78.8344%)
Done in 288.2321979999542 sec.
Server Epoch:35 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  35, local model 0, internal_epoch   1,  Average loss: 0.0099, Accuracy: 1572/1784 (88.1166%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.0711, Accuracy: 6347/10000 (63.4700%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 1, internal_epoch   1,  Average loss: 0.0084, Accuracy: 5396/6000 (89.9333%), train_poison_data_count: 6000
Global model norm: 3.034471196418666.
Norm before scaling: 4.037449763785647. Distance: 1.5367929988546718
Total norm for 5 adversaries is: 4.037449763785647. distance: 1.5367929988546718
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.3387, Accuracy: 6193/8991 (68.8800%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 2, internal_epoch   1,  Average loss: 0.0098, Accuracy: 3074/3457 (88.9210%), train_poison_data_count: 3457
Global model norm: 3.034471196418666.
Norm before scaling: 3.786190871806257. Distance: 1.2747474906554046
Total norm for 5 adversaries is: 3.786190871806257. distance: 1.2747474906554046
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.1269, Accuracy: 6115/8991 (68.0125%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 3, internal_epoch   1,  Average loss: 0.0114, Accuracy: 2985/3455 (86.3965%), train_poison_data_count: 3455
Global model norm: 3.034471196418666.
Norm before scaling: 3.8147437575291883. Distance: 1.1881472680715617
Total norm for 5 adversaries is: 3.8147437575291883. distance: 1.1881472680715617
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.6526, Accuracy: 7508/8991 (83.5057%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 4, internal_epoch   1,  Average loss: 0.0112, Accuracy: 3972/4644 (85.5297%), train_poison_data_count: 4644
Global model norm: 3.034471196418666.
Norm before scaling: 4.0277145614632435. Distance: 1.5496796892280458
Total norm for 5 adversaries is: 4.0277145614632435. distance: 1.5496796892280458
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.6951, Accuracy: 7153/8991 (79.5573%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  35, local model 5, internal_epoch   1,  Average loss: 0.0118, Accuracy: 2349/2798 (83.9528%), train_poison_data_count: 2798
Global model norm: 3.034471196418666.
Norm before scaling: 3.686993968316181. Distance: 1.1635462493032145
Total norm for 5 adversaries is: 3.686993968316181. distance: 1.1635462493032145
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.9741, Accuracy: 6176/8991 (68.6909%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3998/4654 (85.9046%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.7312, Accuracy: 7635/10000 (76.3500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 7, internal_epoch   1,  Average loss: 0.0126, Accuracy: 3250/3839 (84.6575%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8122, Accuracy: 7734/10000 (77.3400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2484/2848 (87.2191%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.1354, Accuracy: 6004/10000 (60.0400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 9, internal_epoch   1,  Average loss: 0.0104, Accuracy: 2816/3226 (87.2908%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8667, Accuracy: 7312/10000 (73.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 10, internal_epoch   1,  Average loss: 0.0111, Accuracy: 4662/5406 (86.2375%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8369, Accuracy: 7162/10000 (71.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 11, internal_epoch   1,  Average loss: 0.0113, Accuracy: 3766/4481 (84.0437%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.8390, Accuracy: 7056/10000 (70.5600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 12, internal_epoch   1,  Average loss: 0.0123, Accuracy: 3529/4148 (85.0771%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.9430, Accuracy: 6664/10000 (66.6400%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 13, internal_epoch   1,  Average loss: 0.0102, Accuracy: 3915/4495 (87.0968%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.9578, Accuracy: 7580/10000 (75.8000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  35, local model 14, internal_epoch   1,  Average loss: 0.0080, Accuracy: 2995/3330 (89.9399%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 1.4599, Accuracy: 5794/10000 (57.9400%), Attack Success Rate:0/10000(0.000)
time spent on training: 281.3984167575836
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.46932012 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 35: Average loss: 0.9156, Accuracy: 7132/10000 (71.3200%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 35: Average loss: 0.8279, Accuracy: 7108/8991 (79.0568%)
Done in 290.1372649669647 sec.
Server Epoch:36 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  36, local model 0, internal_epoch   1,  Average loss: 0.0100, Accuracy: 1564/1784 (87.6682%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.0569, Accuracy: 6363/10000 (63.6300%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 1, internal_epoch   1,  Average loss: 0.0083, Accuracy: 5400/6000 (90.0000%), train_poison_data_count: 6000
Global model norm: 3.071135665386262.
Norm before scaling: 4.059527909215938. Distance: 1.5127213970223186
Total norm for 5 adversaries is: 4.059527909215938. distance: 1.5127213970223186
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 1.3305, Accuracy: 6121/8991 (68.0792%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 2, internal_epoch   1,  Average loss: 0.0096, Accuracy: 3064/3457 (88.6318%), train_poison_data_count: 3457
Global model norm: 3.071135665386262.
Norm before scaling: 3.7937306386337317. Distance: 1.2411226710907486
Total norm for 5 adversaries is: 3.7937306386337317. distance: 1.2411226710907486
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 1.1093, Accuracy: 6159/8991 (68.5018%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.0114, Accuracy: 2966/3455 (85.8466%), train_poison_data_count: 3455
Global model norm: 3.071135665386262.
Norm before scaling: 3.82366459292515. Distance: 1.155997996318625
Total norm for 5 adversaries is: 3.82366459292515. distance: 1.155997996318625
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.6611, Accuracy: 7418/8991 (82.5047%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0111, Accuracy: 4002/4644 (86.1757%), train_poison_data_count: 4644
Global model norm: 3.071135665386262.
Norm before scaling: 4.049974587443179. Distance: 1.5211584797445192
Total norm for 5 adversaries is: 4.049974587443179. distance: 1.5211584797445192
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.6398, Accuracy: 7396/8991 (82.2600%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  36, local model 5, internal_epoch   1,  Average loss: 0.0118, Accuracy: 2341/2798 (83.6669%), train_poison_data_count: 2798
Global model norm: 3.071135665386262.
Norm before scaling: 3.7172640869152835. Distance: 1.1410493975652505
Total norm for 5 adversaries is: 3.7172640869152835. distance: 1.1410493975652505
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.9759, Accuracy: 6054/8991 (67.3340%)
___Train Local_Simple,  epoch  36, local model 6, internal_epoch   1,  Average loss: 0.0108, Accuracy: 4014/4654 (86.2484%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.7391, Accuracy: 7568/10000 (75.6800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 7, internal_epoch   1,  Average loss: 0.0125, Accuracy: 3258/3839 (84.8659%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.8062, Accuracy: 7676/10000 (76.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 8, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2480/2848 (87.0787%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.1456, Accuracy: 6072/10000 (60.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 9, internal_epoch   1,  Average loss: 0.0104, Accuracy: 2817/3226 (87.3218%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.8804, Accuracy: 7316/10000 (73.1600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 10, internal_epoch   1,  Average loss: 0.0111, Accuracy: 4668/5406 (86.3485%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9091, Accuracy: 6903/10000 (69.0300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 11, internal_epoch   1,  Average loss: 0.0112, Accuracy: 3788/4481 (84.5347%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.8080, Accuracy: 7238/10000 (72.3800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 12, internal_epoch   1,  Average loss: 0.0122, Accuracy: 3507/4148 (84.5468%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9191, Accuracy: 6772/10000 (67.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 13, internal_epoch   1,  Average loss: 0.0100, Accuracy: 3917/4495 (87.1413%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.9528, Accuracy: 7585/10000 (75.8500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   1,  Average loss: 0.0079, Accuracy: 3000/3330 (90.0901%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 1.4950, Accuracy: 5649/10000 (56.4900%), Attack Success Rate:0/10000(0.000)
time spent on training: 320.0714981555939
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.07687285
 0.51771445 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 36: Average loss: 0.9041, Accuracy: 7150/10000 (71.5000%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 36: Average loss: 0.8165, Accuracy: 7123/8991 (79.2237%)
Done in 328.79653310775757 sec.
Server Epoch:37 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.0098, Accuracy: 1578/1784 (88.4529%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.9993, Accuracy: 6648/10000 (66.4800%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 1, internal_epoch   1,  Average loss: 0.0083, Accuracy: 5393/6000 (89.8833%), train_poison_data_count: 6000
Global model norm: 3.108132732419326.
Norm before scaling: 4.069000677071677. Distance: 1.4769537674751891
Total norm for 5 adversaries is: 4.069000677071677. distance: 1.4769537674751891
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.3142, Accuracy: 6129/8991 (68.1682%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 2, internal_epoch   1,  Average loss: 0.0098, Accuracy: 3074/3457 (88.9210%), train_poison_data_count: 3457
Global model norm: 3.108132732419326.
Norm before scaling: 3.816512076122. Distance: 1.2323449741075467
Total norm for 5 adversaries is: 3.816512076122. distance: 1.2323449741075467
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.1141, Accuracy: 6121/8991 (68.0792%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 3, internal_epoch   1,  Average loss: 0.0112, Accuracy: 2999/3455 (86.8017%), train_poison_data_count: 3455
Global model norm: 3.108132732419326.
Norm before scaling: 3.855135299346773. Distance: 1.1510121038216414
Total norm for 5 adversaries is: 3.855135299346773. distance: 1.1510121038216414
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.7042, Accuracy: 7171/8991 (79.7575%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 4, internal_epoch   1,  Average loss: 0.0111, Accuracy: 3985/4644 (85.8096%), train_poison_data_count: 4644
Global model norm: 3.108132732419326.
Norm before scaling: 4.0708843861830495. Distance: 1.5023653930438154
Total norm for 5 adversaries is: 4.0708843861830495. distance: 1.5023653930438154
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.6438, Accuracy: 7367/8991 (81.9375%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  37, local model 5, internal_epoch   1,  Average loss: 0.0116, Accuracy: 2367/2798 (84.5961%), train_poison_data_count: 2798
Global model norm: 3.108132732419326.
Norm before scaling: 3.748609793783205. Distance: 1.1554905227147023
Total norm for 5 adversaries is: 3.748609793783205. distance: 1.1554905227147023
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.0012, Accuracy: 6084/8991 (67.6677%)
___Train Local_Simple,  epoch  37, local model 6, internal_epoch   1,  Average loss: 0.0108, Accuracy: 3999/4654 (85.9261%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.6955, Accuracy: 7839/10000 (78.3900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 7, internal_epoch   1,  Average loss: 0.0125, Accuracy: 3261/3839 (84.9440%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7588, Accuracy: 7772/10000 (77.7200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 8, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2474/2848 (86.8680%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.1123, Accuracy: 6022/10000 (60.2200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 9, internal_epoch   1,  Average loss: 0.0101, Accuracy: 2837/3226 (87.9417%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.8641, Accuracy: 7340/10000 (73.4000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 10, internal_epoch   1,  Average loss: 0.0110, Accuracy: 4641/5406 (85.8491%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.8001, Accuracy: 7273/10000 (72.7300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 11, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3796/4481 (84.7132%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.7940, Accuracy: 7312/10000 (73.1200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 12, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3504/4148 (84.4744%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.9033, Accuracy: 6908/10000 (69.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 13, internal_epoch   1,  Average loss: 0.0100, Accuracy: 3935/4495 (87.5417%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.9417, Accuracy: 7690/10000 (76.9000%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  37, local model 14, internal_epoch   1,  Average loss: 0.0080, Accuracy: 3000/3330 (90.0901%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 1.3806, Accuracy: 5918/10000 (59.1800%), Attack Success Rate:0/10000(0.000)
time spent on training: 327.5149118900299
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.
 0.46820912 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 37: Average loss: 0.8933, Accuracy: 7168/10000 (71.6800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 37: Average loss: 0.8054, Accuracy: 7134/8991 (79.3460%)
Done in 336.5543656349182 sec.
Server Epoch:38 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  38, local model 0, internal_epoch   1,  Average loss: 0.0096, Accuracy: 1570/1784 (88.0045%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.0240, Accuracy: 6510/10000 (65.1000%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 1, internal_epoch   1,  Average loss: 0.0082, Accuracy: 5413/6000 (90.2167%), train_poison_data_count: 6000
Global model norm: 3.143877613063659.
Norm before scaling: 4.093353718221232. Distance: 1.4682446685907267
Total norm for 5 adversaries is: 4.093353718221232. distance: 1.4682446685907267
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.3032, Accuracy: 6211/8991 (69.0802%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 2, internal_epoch   1,  Average loss: 0.0095, Accuracy: 3063/3457 (88.6028%), train_poison_data_count: 3457
Global model norm: 3.143877613063659.
Norm before scaling: 3.841262384575326. Distance: 1.2097803308949877
Total norm for 5 adversaries is: 3.841262384575326. distance: 1.2097803308949877
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.0716, Accuracy: 6249/8991 (69.5028%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 3, internal_epoch   1,  Average loss: 0.0112, Accuracy: 2987/3455 (86.4544%), train_poison_data_count: 3455
Global model norm: 3.143877613063659.
Norm before scaling: 3.8696387334752975. Distance: 1.1223732694524782
Total norm for 5 adversaries is: 3.8696387334752975. distance: 1.1223732694524782
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.6537, Accuracy: 7419/8991 (82.5158%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 4, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3979/4644 (85.6804%), train_poison_data_count: 4644
Global model norm: 3.143877613063659.
Norm before scaling: 4.078733669181675. Distance: 1.4703643530236647
Total norm for 5 adversaries is: 4.078733669181675. distance: 1.4703643530236647
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.6604, Accuracy: 7266/8991 (80.8141%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  38, local model 5, internal_epoch   1,  Average loss: 0.0117, Accuracy: 2378/2798 (84.9893%), train_poison_data_count: 2798
Global model norm: 3.143877613063659.
Norm before scaling: 3.76580240298695. Distance: 1.1245922833303617
Total norm for 5 adversaries is: 3.76580240298695. distance: 1.1245922833303617
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.9523, Accuracy: 6183/8991 (68.7688%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   1,  Average loss: 0.0107, Accuracy: 4015/4654 (86.2699%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6784, Accuracy: 8043/10000 (80.4300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 7, internal_epoch   1,  Average loss: 0.0124, Accuracy: 3245/3839 (84.5272%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.7646, Accuracy: 7779/10000 (77.7900%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 8, internal_epoch   1,  Average loss: 0.0093, Accuracy: 2483/2848 (87.1840%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.1513, Accuracy: 5975/10000 (59.7500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 9, internal_epoch   1,  Average loss: 0.0101, Accuracy: 2820/3226 (87.4148%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.8675, Accuracy: 7215/10000 (72.1500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 10, internal_epoch   1,  Average loss: 0.0109, Accuracy: 4672/5406 (86.4225%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.8159, Accuracy: 7262/10000 (72.6200%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 11, internal_epoch   1,  Average loss: 0.0110, Accuracy: 3788/4481 (84.5347%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.8030, Accuracy: 7196/10000 (71.9600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 12, internal_epoch   1,  Average loss: 0.0120, Accuracy: 3505/4148 (84.4986%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.8805, Accuracy: 6967/10000 (69.6700%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 13, internal_epoch   1,  Average loss: 0.0098, Accuracy: 3923/4495 (87.2747%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.9367, Accuracy: 7676/10000 (76.7600%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  38, local model 14, internal_epoch   1,  Average loss: 0.0079, Accuracy: 2998/3330 (90.0300%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 1.3870, Accuracy: 5884/10000 (58.8400%), Attack Success Rate:0/10000(0.000)
time spent on training: 332.86544275283813
[foolsgold agg] training data poison_ratio: 0.3475454623068386  data num: [1784, 6000, 3457, 3455, 4644, 2798, 4654, 3839, 2848, 3226, 5406, 4481, 4148, 4495, 3330]
[foolsgold agg] considering poison per batch poison_fraction: 0.3475454623068386
[foolsgold agg] wv: [1.         1.         1.         0.         0.         1.
 0.         0.         1.         0.         0.         0.31589408
 0.56049311 1.         1.        ]
___Test Target_Simple poisoned: False, epoch: 38: Average loss: 0.8823, Accuracy: 7188/10000 (71.8800%), Attack Success Rate:0/10000(0.000)
___Test Target_Simple poisoned: True, epoch: 38: Average loss: 0.7940, Accuracy: 7156/8991 (79.5907%)
Done in 342.05428862571716 sec.
Server Epoch:39 choose agents : [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14].
___Train Local_Simple,  epoch  39, local model 0, internal_epoch   1,  Average loss: 0.0096, Accuracy: 1575/1784 (88.2848%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.9784, Accuracy: 6726/10000 (67.2600%), Attack Success Rate:0/10000(0.000)
poison local model 1 index 0 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 1, internal_epoch   1,  Average loss: 0.0081, Accuracy: 5409/6000 (90.1500%), train_poison_data_count: 6000
Global model norm: 3.181595213620444.
Norm before scaling: 4.113310695155173. Distance: 1.4505502183039143
Total norm for 5 adversaries is: 4.113310695155173. distance: 1.4505502183039143
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.3105, Accuracy: 6129/8991 (68.1682%)
poison local model 2 index 1 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 2, internal_epoch   1,  Average loss: 0.0095, Accuracy: 3077/3457 (89.0078%), train_poison_data_count: 3457
Global model norm: 3.181595213620444.
Norm before scaling: 3.8642628717666527. Distance: 1.2021024743225004
Total norm for 5 adversaries is: 3.8642628717666527. distance: 1.2021024743225004
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.1005, Accuracy: 6054/8991 (67.3340%)
poison local model 3 index 2 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 3, internal_epoch   1,  Average loss: 0.0109, Accuracy: 3016/3455 (87.2938%), train_poison_data_count: 3455
Global model norm: 3.181595213620444.
Norm before scaling: 3.8973520484037336. Distance: 1.1140319969848673
Total norm for 5 adversaries is: 3.8973520484037336. distance: 1.1140319969848673
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.6649, Accuracy: 7392/8991 (82.2155%)
poison local model 4 index 3 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 4, internal_epoch   1,  Average loss: 0.0109, Accuracy: 3979/4644 (85.6804%), train_poison_data_count: 4644
Global model norm: 3.181595213620444.
Norm before scaling: 4.10065582426603. Distance: 1.46629395987328
Total norm for 5 adversaries is: 4.10065582426603. distance: 1.46629395987328
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.6689, Accuracy: 7264/8991 (80.7919%)
poison local model 5 index 4 
poison_now
___PoisonTrain Local_Simple ,  epoch  39, local model 5, internal_epoch   1,  Average loss: 0.0114, Accuracy: 2357/2798 (84.2387%), train_poison_data_count: 2798
Global model norm: 3.181595213620444.
Norm before scaling: 3.787924180654712. Distance: 1.1092887092664296
Total norm for 5 adversaries is: 3.787924180654712. distance: 1.1092887092664296
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.9507, Accuracy: 6292/8991 (69.9811%)
___Train Local_Simple,  epoch  39, local model 6, internal_epoch   1,  Average loss: 0.0106, Accuracy: 4027/4654 (86.5277%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.7093, Accuracy: 7708/10000 (77.0800%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 7, internal_epoch   1,  Average loss: 0.0121, Accuracy: 3287/3839 (85.6213%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.8078, Accuracy: 7705/10000 (77.0500%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 8, internal_epoch   1,  Average loss: 0.0097, Accuracy: 2480/2848 (87.0787%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.1102, Accuracy: 6013/10000 (60.1300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 9, internal_epoch   1,  Average loss: 0.0100, Accuracy: 2841/3226 (88.0657%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.8435, Accuracy: 7383/10000 (73.8300%), Attack Success Rate:0/10000(0.000)
___Train Local_Simple,  epoch  39, local model 10, internal_epoch   1,  Average loss: 0.0108, Accuracy: 4686/5406 (86.6815%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.8246, Accuracy: 7059/10000 (70.5900%), Attack Success Rate:0/10000(0.000)
